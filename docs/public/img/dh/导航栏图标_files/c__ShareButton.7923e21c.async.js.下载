/*! For license information please see c__ShareButton.7923e21c.async.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[1290,234,235,649,781,809,813],{1408:function(e,t,r){"use strict";r.r(t);var n=r(0);t.default=e=>n.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},e,{className:["larkui-icon","larkui-icon-avatar-upload",e.className].filter(Boolean).join(" ")}),n.createElement("g",{fill:"currentColor",fillRule:"evenodd"},n.createElement("rect",{x:28,y:209,width:200,height:20,rx:10}),n.createElement("path",{d:"M177.268 80.262c4.525 3.166 10.76 2.064 13.926-2.461 3.11-4.445 2.102-10.538-2.222-13.754l-.24-.173-43.535-30.457a30 30 0 0 0-34.01-.264l-.384.264-43.535 30.457c-4.526 3.166-5.628 9.401-2.462 13.927 3.11 4.444 9.18 5.587 13.682 2.627l.244-.166 43.536-30.457a10 10 0 0 1 11.197-.18l.267.18 43.536 30.457Z",fillRule:"nonzero"}),n.createElement("rect",{x:118,y:39,width:20,height:150,rx:10})))},1616:function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,r=[],n=0;n<e.rangeCount;n++)r.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||r.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},1618:function(e,t,r){"use strict";r.r(t);var n=r(0);t.default=e=>n.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},e,{className:["larkui-icon","larkui-icon-check",e.className].filter(Boolean).join(" ")}),n.createElement("g",{fill:"none",fillRule:"evenodd"},n.createElement("path",{d:"M210.827 55.428c3.906-3.905 10.237-3.905 14.143 0 3.834 3.834 3.904 10.007.209 13.927l-.21.215-124 124c-3.834 3.834-10.007 3.904-13.926.21l-.216-.21-55.708-55.708c-3.905-3.905-3.905-10.237 0-14.142 3.834-3.835 10.008-3.904 13.927-.21l.215.21 48.637 48.636 116.93-116.928Z",fill:"currentColor",fillRule:"nonzero"}),n.createElement("path",{d:"M0 0h256v256H0z"})))},1697:function(e,t,r){"use strict";r.r(t);var n=r(0);t.default=e=>n.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},e,{className:["larkui-icon","larkui-icon-change",e.className].filter(Boolean).join(" ")}),n.createElement("path",{d:"m66.77 130.998 25.42 6.812c5.334 1.429 8.5 6.912 7.07 12.247-1.429 5.335-6.912 8.5-12.247 7.071l-21.17-5.672C75.695 180.568 103.246 201 135 201c25.226 0 48.234-12.886 61.569-33.76 2.973-4.654 9.157-6.017 13.81-3.043 4.655 2.973 6.017 9.156 3.044 13.81C196.451 204.574 167.123 221 135 221c-39.108 0-73.2-24.314-86.77-59.453l-6.13 22.887c-1.43 5.335-6.914 8.5-12.248 7.071-5.335-1.43-8.5-6.913-7.071-12.247l7.247-27.046c4.288-16.004 20.738-25.502 36.742-21.214ZM122 35c38.662 0 72.359 23.75 86.25 58.135l5.501-20.538c1.43-5.335 6.913-8.5 12.248-7.071 5.334 1.43 8.5 6.913 7.07 12.247l-6.729 25.114c-4.288 16.004-20.738 25.502-36.742 21.213l-23.555-6.311c-5.335-1.43-8.5-6.913-7.071-12.248 1.429-5.334 6.912-8.5 12.247-7.07l19.66 5.266C180.809 75.094 153.499 55 122 55c-26.405 0-50.336 14.129-63.29 36.594-2.759 4.784-8.874 6.426-13.658 3.668-4.785-2.76-6.427-8.874-3.668-13.659C57.874 53.006 88.373 35 122 35Z",fill:"currentColor",fillRule:"nonzero"}))},1726:function(e,t,r){var n=r(214),o=r(268),a=r(483),i=r(364);e.exports=function(e,t){if(null==e)return{};var r=n(i(e),(function(e){return[e]}));return t=o(t),a(e,r,(function(e,r){return t(e,r[0])}))}},1863:function(e,t,r){"use strict";r.r(t);var n=r(0);t.default=e=>n.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},e,{className:["larkui-icon","larkui-icon-icon-public",e.className].filter(Boolean).join(" ")}),n.createElement("g",{fill:"none",fillRule:"evenodd"},n.createElement("path",{d:"M0 0h16v16H0z"}),n.createElement("path",{d:"M8 1.487a6.513 6.513 0 1 1 0 13.026A6.513 6.513 0 0 1 8 1.487Zm5.005 8.765-.029.003c-.223.042-.491.213-.875.54l-.53.465-.196.166-.082.066-.144.107c-.044.03-.086.056-.126.078l-.12.06-.13.049a1.162 1.162 0 0 1-.447.08c-.578-.011-.863-.24-1.08-.693l-.073-.163c-.075-.18-.091-.199-.169-.22-.359-.094-1.08.61-1.212 1.37-.054.315-.008.488.204.797l.155.216c.083.112.151.21.21.302a5.489 5.489 0 0 0 4.644-3.223ZM8.46 2.532l.022.046c.108.26.139.533.055.775-.062.181-.15.31-.293.462l-.266.261c-.068.07-.08.097-.08.122.002.058.09.132.35.234l.2.072.255.08.317.09c1.615.442 1.65 2.616-.231 3.395-1.288.534-2.074.239-2.707-.647L5.92 7.18l-.145-.221c-.222-.315-.835-.451-1.057-.3l-.005.009-.045.114-.051.152-.068.216-.1.348-.099.308c-.226.66-.454.9-1.005.865-.335-.022-.581-.148-.823-.39a5.486 5.486 0 0 0 4.543 5.126c-.289-.46-.382-.85-.283-1.422.221-1.283 1.432-2.465 2.484-2.187.408.108.617.316.79.672l.127.293c.032.069.05.075.117.076l.064-.001.062-.02.071-.03.079-.048.096-.07.124-.1.256-.22.231-.204c.819-.725 1.394-1.052 2.065-.914a5.488 5.488 0 0 0-4.889-6.701Zm-1.323.047c-2.224.355-4 2.04-4.49 4.211a.497.497 0 0 1 .025.028l.099.125.222.303c.132.181.229.291.304.349l.022.015.017-.033.051-.127.057-.172.132-.452.092-.296c.131-.391.242-.56.475-.719.7-.475 1.937-.2 2.471.558l.235.358c.402.61.705.744 1.547.395 1.007-.417.993-1.283.354-1.457l-.204-.057-.367-.113c-.913-.302-1.29-.622-1.306-1.27-.01-.377.11-.6.394-.889l.204-.199.07-.075a.157.157 0 0 0 .026-.042c.018-.053-.26-.413-.43-.441Z",fill:"currentColor",fillRule:"nonzero"})))},1864:function(e,t,r){"use strict";r.r(t);var n=r(0);t.default=e=>n.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e,{className:["larkui-icon","larkui-icon-icon-lock",e.className].filter(Boolean).join(" ")}),n.createElement("defs",null,n.createElement("path",{id:"2932495269a",d:"M0 0h20v20H0z"})),n.createElement("g",{fill:"none",fillRule:"evenodd"},n.createElement("mask",{id:"2932495269b",fill:"#fff"},n.createElement("use",{xlinkHref:"#2932495269a"})),n.createElement("g",{mask:"url(#2932495269b)",fill:"#FFF",fillRule:"nonzero"},n.createElement("path",{d:"M10 1.172a4.219 4.219 0 0 1 4.219 4.219l-.001 1.874h1.407c1.036 0 1.875.84 1.875 1.876v7.812c0 1.036-.84 1.875-1.875 1.875H4.375A1.875 1.875 0 0 1 2.5 16.953V9.141c0-1.036.84-1.875 1.875-1.875l1.406-.001V5.39A4.219 4.219 0 0 1 10 1.17Zm5.64 7.657H4.376a.313.313 0 0 0-.312.296v7.828c0 .167.131.304.296.312h11.266a.313.313 0 0 0 .312-.296V9.14a.313.313 0 0 0-.296-.312ZM10 10.78a1.406 1.406 0 0 1 .782 2.575v1.175a.781.781 0 1 1-1.563 0l-.001-1.175A1.405 1.405 0 0 1 10 10.781Zm.044-8.046H10a2.656 2.656 0 0 0-2.656 2.612v1.919h5.312V5.39a2.656 2.656 0 0 0-2.612-2.656Z"}))))},1865:function(e,t,r){"use strict";r.r(t);var n=r(0);t.default=e=>n.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},e,{className:["larkui-icon","larkui-icon-icon-qrcode2",e.className].filter(Boolean).join(" ")}),n.createElement("g",{fill:"none",fillRule:"evenodd"},n.createElement("path",{d:"M0 0h256v256H0z"}),n.createElement("path",{d:"M122.353 133.647v73.412c0 9.353-7.588 16.941-16.941 16.941h-56.47C39.587 224 32 216.412 32 207.059v-56.47c0-9.354 7.588-16.942 16.941-16.942h73.412Zm45.176-.224L167.52 160l22.56-.001v-26.576H224v33.92l-29.185-.016v20.672L224 188v33.92h-33.92v-29.921h-22.513v29.921h-33.92V188l29.168-.001.001-20.703-29.169.01v-33.883h33.882Zm-62.794 17.842H49.618v55.117h55.117v-55.117ZM105.412 32c9.353 0 16.94 7.588 16.94 16.941v73.412h-73.41c-9.354 0-16.942-7.588-16.942-16.941v-56.47C32 39.587 39.588 32 48.941 32h56.47Zm101.647 0C216.412 32 224 39.588 224 48.941v56.47c0 9.354-7.588 16.942-16.941 16.942h-73.412V48.94c0-9.353 7.588-16.941 16.941-16.941h56.47ZM104.735 49.618H49.618v55.117h55.117V49.618Zm101.647 0h-55.117v55.117h55.117V49.618Z",fill:"currentColor",fillRule:"nonzero"})))},3310:function(e,t,r){var n=r(180),o=r(96);e.exports=function(e){return o(e)&&n(e)}},3323:function(e,t,r){var n=r(427),o=r(268),a=r(632),i=r(506),c=r(3310),l=r(799),u=a((function(e){var t=l(e);return c(t)&&(t=void 0),i(n(e,1,c,!0),o(t,2))}));e.exports=u},3482:function(e,t,r){"use strict";r(3203);var n=r(1526);r(3180);t.a=n.a},3510:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return f})),r.d(t,"c",(function(){return d})),r.d(t,"b",(function(){return p})),r.d(t,"d",(function(){return s}));var n=r(500),o=(r(101),r(97),r(148));function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function i(e,t,r){return(t=c(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e){var t=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===a(t)?t:String(t)}function l(e){return n.ALL_PERMISSIONS.includes(e)}function u(e){return e===n.ROLE.noPermission?0-e:e}var s={gte:function(e,t){return!(!l(e)||!l(t))&&u(e)>=u(t)},gt:function(e,t){return!(!l(e)||!l(t))&&u(e)>u(t)},lt:function(e,t){return!(!l(e)||!l(t))&&u(e)<u(t)},lte:function(e,t){return!(!l(e)||!l(t))&&u(e)<=u(t)},eq:function(e,t){return!(!l(e)||!l(t))&&u(e)===u(t)},max:function(e,t){var r=[l(e),l(t)];if(r.every((function(e){return!!e})))return u(e)>u(t)?e:t;var n=r.indexOf(!0);return n<0?null:n>0?t:e}};function f(e,t,r){if(!e||!t)return null;var a=n.ALL_PERMISSIONS;if(null!=r&&(a=a.filter((function(e){return s.lte(e,r)}))),e.owner_type===n.OWNER_TYPE.User)return a=a.filter((function(e){return e!==n.ROLE.noPermission})),e.owner_id===t.user_id?{edit:!1,delete:!1}:{edit:!0,delete:!0,permissions:a};var i=o.PUBLIC_PRIVACY.includes(t.public),c=t.public===o.PUBLIC.public;return e.owner_type===n.OWNER_TYPE.GroupManager||e.owner_type===n.OWNER_TYPE.OrganizationOwner?{edit:!1,delete:!1}:e.owner_type===n.OWNER_TYPE.GroupMember?{edit:!0,delete:!1,permissions:a.filter((function(e){return i?e!==n.ROLE.noPermission:void 0!==e})),availableTargetPermission:i&&e.role===n.ROLE.noPermission?n.ROLE.readonly:e.role}:e.owner_type===n.OWNER_TYPE.OrganizationMember?{edit:i,delete:!1,permissions:a.filter((function(e){return i?e!==n.ROLE.noPermission:void 0!==e})),availableTargetPermission:i&&e.role===n.ROLE.noPermission?n.ROLE.readonly:i?e.role:n.ROLE.noPermission}:e.owner_type===n.OWNER_TYPE.GroupReadonlyMember?{edit:!i,delete:!1,permissions:i?[n.ROLE.readonly]:[n.ROLE.readonly,n.ROLE.noPermission],availableTargetPermission:i&&e.role===n.ROLE.noPermission?n.ROLE.readonly:e.role}:e.owner_type===n.OWNER_TYPE.OrganizationOutsourcer?{edit:!c&&i,delete:!1,permissions:c?[n.ROLE.readonly]:[n.ROLE.readonly,n.ROLE.noPermission].filter((function(e){return i?void 0!==e:e!==n.ROLE.readonly})),availableTargetPermission:c?n.ROLE.readonly:n.ROLE.noPermission}:{edit:!0,delete:!0,permissions:a}}function d(t,r){var o,a=function(e){return e};return void 0!==e.window&&"function"==typeof e.window.__&&(a=e.window.__),r&&(a=function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.__).call.apply(e,[r].concat(n))}),(i(o={},n.ROLE.readonly,a("可阅读")),i(o,n.ROLE.edit,a("可编辑")),i(o,n.ROLE.manage,a("可管理")),i(o,n.ROLE.noPermission,a("无权限")),o)[t]}function p(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=o.inOrganization,c=o.ctx,l=o.isYuque,u=void 0===l||l,s=function(e,t){return e};void 0!==e.window&&"function"==typeof e.window.__&&(s=e.window.__),c&&(s=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=c.__).call.apply(e,[c].concat(r))});var f=s(!u||a?"团队":"知识小组");return(i(r={},n.OWNER_TYPE.User,s("用户")),i(r,n.OWNER_TYPE.GroupManager,s("{groupTypeName}管理员",{groupTypeName:f})),i(r,n.OWNER_TYPE.GroupMember,s("{groupTypeName}成员",{groupTypeName:f})),i(r,n.OWNER_TYPE.GroupReadonlyMember,s("{groupTypeName}只读成员",{groupTypeName:f})),i(r,n.OWNER_TYPE.OrganizationOwner,s("空间管理员")),i(r,n.OWNER_TYPE.OrganizationMember,s("空间成员")),i(r,n.OWNER_TYPE.OrganizationOutsourcer,s("空间外部联系人")),r)[t]}}).call(this,r(92))},3537:function(e,t,r){"use strict";t.a={revertLink:"index-module_revertLink_csROb"}},3639:function(e,t,r){"use strict";r.d(t,"c",(function(){return d})),r.d(t,"e",(function(){return _})),r.d(t,"d",(function(){return j})),r.d(t,"b",(function(){return k})),r.d(t,"a",(function(){return L}));r(37);var n=r(10),o=r(0),a=r(82),i=r.n(a);function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var u=function(e,t){return t.book&&Object.values(i.a.TYPE).includes(e.type)},s=function(e,t){if(!e.joinToken)return"";var r=e.joinToken;if("Doc"===r.target_type){var n=e.slug,o=t.group,a=t.book,i=t.isEditing,c="".concat(window.location.origin,"/g/").concat(o.login,"/").concat(a.slug,"/").concat(n,"/collaborator/join?token=").concat(r.token);if(i){var l="/".concat(o.login,"/").concat(a.slug,"/").concat(n,"/edit");c="".concat(c,"&goto=").concat(encodeURIComponent(l))}return c+="# ".concat(__("邀你参与文档协作"),"《").concat(e.title,"》")}return""},f=function(e){return!e.joinToken||!!e.joinToken.approve},d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=c(Object(o.useState)(!1),2),a=r[0],i=r[1],l=c(Object(o.useState)(s(e,t)),2),d=l[0],p=l[1],h=c(Object(o.useState)(f(e)),2),m=h[0],y=h[1],v=t.dispatch,b=function(r){i(!0);var o="proxy.web/books.token",a="book/updateToken",c=e.id;u(e,t)&&(o="proxy.web/docs.token",a="doc/updateToken",c=e.id),v({type:o,payload:{data:{id:c,force:r},reducer:a}}).then((function(o){r&&n.a.success(__("重置链接成功")),e.joinToken=o;var a=s(e,t);p(a),y(f(e)),i(!1)}))};return Object(o.useEffect)((function(){e.abilities&&e.abilities.create_collaborator&&!d&&b()}),[e.id]),[d,function(){return b(!0)},a,m,function(r){var n="proxy.web/books.updateToken",o="book/updateToken",a=e.id;u(e,t)&&(n="proxy.web/docs.updateToken",o="doc/updateToken",a=e.id),v({type:n,payload:{data:{id:a,approve:!0===r?1:0},reducer:o}}).then((function(e){y(r)}))}]},p=r(454),h=r.n(p),m=r(3329),y=r(50);function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function b(){b=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var a=t&&t.prototype instanceof g?t:g,i=Object.create(a.prototype),c=new I(n||[]);return o(i,"_invoke",{value:L(e,r,c)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var d="suspendedStart",p="suspendedYield",h="executing",m="completed",y={};function g(){}function w(){}function E(){}var _={};u(_,i,(function(){return this}));var O=Object.getPrototypeOf,S=O&&O(O(P([])));S&&S!==r&&n.call(S,i)&&(_=S);var j=E.prototype=g.prototype=Object.create(_);function k(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(o,a,i,c){var l=f(e[o],e,a);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==v(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){r("next",e,i,c)}),(function(e){r("throw",e,i,c)})):t.resolve(s).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,c)}))}c(l.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function L(t,r,n){var o=d;return function(a,i){if(o===h)throw new Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var l=C(c,n);if(l){if(l===y)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?m:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function C(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var a=f(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,y;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(v(t)+" is not iterable")}return w.prototype=E,o(j,"constructor",{value:E,configurable:!0}),o(E,"constructor",{value:w,configurable:!0}),w.displayName=u(E,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,u(e,l,"GeneratorFunction")),e.prototype=Object.create(j),e},t.awrap=function(e){return{__await:e}},k(x.prototype),u(x.prototype,c,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new x(s(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(j),u(j,l,"Generator"),u(j,i,(function(){return this})),u(j,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(N),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var l=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),N(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;N(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}function g(e,t,r,n,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return E(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.organization,n=w(Object(o.useState)(!1),2),a=n[0],i=n[1],c=w(Object(o.useState)([]),2),l=c[0],u=c[1],s=Object(o.useCallback)(h()(function(){var e,n=(e=b().mark((function e(n){var o,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return i(!1),e.abrupt("return");case 3:return i(!0),o={q:n.trim(),include_unconfirmed_corp_account:!0,optional_properties:t.optional_properties},r&&r.id||(o.global=!0),e.prev=6,e.next=9,y.a.users.complete(o);case 9:a=e.sent,u(Object(m.format)(a));case 11:return e.prev=11,i(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[6,,11,14]])})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){g(a,n,o,i,c,"next",e)}function c(e){g(a,n,o,i,c,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}(),200),[]);return[l,s,a,function(){return u([])}]};function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var j=function(){var e=O(Object(o.useState)(!1),2),t=e[0],r=e[1];return[t,Object(o.useCallback)((function(){return r((function(e){return!e}))}),[])]},k=function(e){return[window.location.hash==="#".concat(e),function(){window.location.hash=""}]};function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}var L=function(e,t){return function(r,n){var o=e.id,a=e.settings.homepage,i=a?a.layout:{};Object.keys(i).map((function(e){return i[e]&&i[e].length>0&&(i[e]=i[e].map((function(e){return"string"==typeof e&&e===t||"object"===x(e)&&e.type===t?{name:r,type:t}:e}))),i[e]})),y.a.groups.settings({id:o,homepage:{layout:i}}).then((function(e){n&&"function"==typeof n&&n(e)}))}}},3722:function(e,t,r){"use strict";r.d(t,"a",(function(){return A}));r(999);var n=r(651),o=(r(60),r(14)),a=(r(41),r(9)),i=(r(37),r(10)),c=(r(143),r(67)),l=r(0),u=r(1618),s=r(1697),f=r(1210),d=r(59),p=r(5),h=r.n(p),m=r(956),y=r.n(m),v=r(238),b=r(455),g=r(3309),w=r(3406),E=r(1403),_=r(11),O=r(32),S=r(3337);function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function k(){k=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),c=new I(n||[]);return o(i,"_invoke",{value:L(e,r,c)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var d="suspendedStart",p="suspendedYield",h="executing",m="completed",y={};function v(){}function b(){}function g(){}var w={};u(w,i,(function(){return this}));var E=Object.getPrototypeOf,_=E&&E(E(P([])));_&&_!==r&&n.call(_,i)&&(w=_);var O=g.prototype=v.prototype=Object.create(w);function S(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(o,a,i,c){var l=f(e[o],e,a);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==j(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){r("next",e,i,c)}),(function(e){r("throw",e,i,c)})):t.resolve(s).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,c)}))}c(l.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function L(t,r,n){var o=d;return function(a,i){if(o===h)throw new Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var l=C(c,n);if(l){if(l===y)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?m:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function C(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var a=f(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,y;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(j(t)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=u(g,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,l,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},S(x.prototype),u(x.prototype,c,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new x(s(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S(O),u(O,l,"Generator"),u(O,i,(function(){return this})),u(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(N),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var l=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),N(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;N(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}function x(e,t,r,n,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function L(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){x(a,n,o,i,c,"next",e)}function c(e){x(a,n,o,i,c,"throw",e)}i(void 0)}))}}function C(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==j(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===j(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var A=function(e){var t,r,p=e.bookPublicSet,m=e.panelType,j=e.panelTitle,x=e.share,A=e.belongs,N=e.organization,I=e.group,P=e.book,T=e.me,R=e.shareViewType,D=e.handlePasswordChange,M=e.handleScopeChange,U=e.handleSearchChange,F=e.onBack,G=l.useMemo((function(){return Object(E.d)(x,R,I,P)}),[x,R,I,P]).privacy,B={scopeSet:function(){var e=g.q[A],t=e.desc,r=e.actions,n=A===b.a.ORG&&(0===(null==N?void 0:N.share_to_outside_enable)||!d.a.isPremium(N));return l.createElement(l.Fragment,null,l.createElement("p",{className:S.a.titleDesc},t),r.map((function(e){var t;return l.createElement(c.a,{key:e.value,title:e.value===_.PRIVACY.public&&n?null===(t=e.tip)||void 0===t?void 0:t.call(e,N):"",placement:"bottomLeft",overlayInnerStyle:{width:"200px"},autoAdjustOverflow:!0},function(e){return l.createElement("div",{className:h()(S.a.contentArea,S.a.selectorItem,C({},S.a.disabledItem,e.value===_.PRIVACY.public&&n)),onClick:function(){G===e.value||e.value===_.PRIVACY.public&&n||null==M||M(e.value)}},l.createElement("span",null,e.label),G===e.value&&l.createElement(u.default,{className:S.a.selectorIcon,width:16,height:16}))}(e))})))},passwordSet:function(){var e=Object(E.c)(x,R,I,P),t=e.currentPassword,r=e.isInheritBookPassword,n="";(R===b.b.DOC&&r||R===b.b.BOOK)&&(n=g.o[R]);var u=Object(v.a)()?"https://www.yuque.com/yuque/thyzgp/wgy2sb#ebmU2":"https://yuque.antfin.com/lark/bsgp0v/lrui64#ebmU2",f=__("所属知识库已开启密码，文档无法独立设置。{terms}",{terms:l.createElement("a",{href:u,target:"_blank"},__("查看帮助"))}),d=function(e,t){var r=Object(E.a)(e,R,I,P);if(null!=r&&r.url){y()((null==r?void 0:r.urlWithDesc)||r.url,{format:"text/plain"});var n=t?__("已重置并复制链接和密码"):__("已复制链接和密码"),o=null!=e&&e.password?n:__("已复制链接");i.a.success(o,2)}},m=function(){var e=L(k().mark((function e(){var r;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null==D?void 0:D(t?_.ENCRYPTED_PASSWORD_ACTIONS.disabled:_.ENCRYPTED_PASSWORD_ACTIONS.enabled);case 3:if(!(r=e.sent)){e.next=8;break}if(!t){e.next=7;break}return e.abrupt("return",i.a.success(__("设置成功"),1));case 7:return e.abrupt("return",d(r));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=L(k().mark((function e(){var t;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null==D?void 0:D(_.ENCRYPTED_PASSWORD_ACTIONS.enabled);case 3:(t=e.sent)&&d(t,!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),O=l.createElement("div",{className:S.a.contentArea},t?l.createElement("div",{className:h()(S.a.pwdBlock,C({},S.a.bookPublicSet,p))},l.createElement("span",{"data-testid":"password-text",className:S.a.passwordText},__("密码：{password}",{password:t})),l.createElement(a.a,{type:"text",disabled:r,onClick:w,className:S.a.resetBtn},l.createElement(s.default,{className:S.a.resetIcon,width:12,height:12}),__("重置"))):l.createElement(o.a,{className:h()(S.a.pwdLink,C({},S.a.bookPublicSet,p)),disabled:!0,placeholder:__("点击开启生成随机密码")}),l.createElement(a.a,{className:S.a.pwdBtn,size:"large",type:"primary",disabled:r,onClick:m},t?__("关闭"):__("开启")));return l.createElement(l.Fragment,null,l.createElement("p",{className:h()(S.a.titleDesc,C({},S.a.bookPublicSet,p))},n),l.createElement(c.a,{title:r?f:"",placement:"bottomRight",autoAdjustOverflow:!0},O))},searchSet:function(){var e=Object(E.b)(x,R,I,P),t=e.currentIndexedLevel,r=e.isInheritBookIndex,o=g.r[R][A],a=o.desc,i=o.action,u=o.tip,s=l.createElement("div",{className:S.a.contentArea},l.createElement("span",{className:S.a.switchTitle},i),l.createElement(n.a,{disabled:r,onChange:U,checked:1===t}));return l.createElement(l.Fragment,null,l.createElement("p",{className:h()(S.a.titleDesc,C({},S.a.bookPublicSet,p))},a),l.createElement(c.a,{title:r?u:"",placement:"bottomRight",autoAdjustOverflow:!0},s))},shareExpiredTimeSet:function(){var e=!(!N||null==N||!N.id),t=!e&&"User"===(null==I?void 0:I.type)&&I.id===T.id,r=Object(E.e)(x,R,e);if(r){var n=r.startTime,o=r.expiredTime,a=g.s[A].desc,i=[{label:__("半年（{startTime} - {expiredTime}）",{startTime:n,expiredTime:o}),value:o},{label:__("永久有效"),value:null}],c=function(e){return l.createElement(l.Fragment,null,l.createElement("div",{onClick:function(){return function(e){var r;null===e.value&&t&&(null===(r=window.__member_message_ref)||void 0===r||r.current.showMemberIntro(O.LIMIT_SCENE.share_public))}(e)},className:h()(S.a.contentArea,S.a.selectorItem,C({},S.a.notOwner,!t))},l.createElement("span",{className:S.a.shareTime},e.label,null===e.value&&l.createElement(w.a,{className:S.a.memberAbleIcon,noTooltip:!0,isYuque:Object(v.a)(),group:I,organization:N})),e.value===o&&l.createElement(u.default,{className:S.a.selectorIcon,width:16,height:16})),null===e.value&&!t&&l.createElement("span",{className:S.a.shareNotOwner},__("请联系知识库所有者购买会员")))};return l.createElement(l.Fragment,null,l.createElement("p",{className:S.a.titleDesc},a),i.map((function(e){return c(e)})))}}};return p?l.createElement("div",{className:h()(S.a.shareDetailSettingPanel,S.a.bookPublicSetting)},l.createElement("div",{className:S.a.bookPublicTitle},j),null===(r=B[m])||void 0===r?void 0:r.call(B)):l.createElement("div",{className:S.a.shareDetailSettingPanel},l.createElement("div",{className:S.a.title,onClick:F},l.createElement(f.default,{className:S.a.backIcon,width:20,height:20}),j),null===(t=B[m])||void 0===t?void 0:t.call(B))}},3724:function(e,t,r){"use strict";r.r(t),r.d(t,"ShareButton",(function(){return Er}));r(41);var n=r(9),o=r(0),a=r.n(o),i=r(228),c=(r(785),r(424)),l=(r(143),r(67)),u=r(455),s=r(238),f=r(22),d="styles-module_popover_v7CCF",p="styles-module_disable_OpJcF";function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}var m=["panel","CollaboratorChannel","InviteSelectorChannel","children"],y=["shareViewType","canCollaborator","canShare","isFileBook","onlyCollaborator","organization","group","book","me","targetResource","onChangeShare","beforeShareUpdate","getPopupContainer"];function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},v.apply(this,arguments)}function b(){b=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var a=t&&t.prototype instanceof g?t:g,i=Object.create(a.prototype),c=new I(n||[]);return o(i,"_invoke",{value:L(e,r,c)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var d="suspendedStart",p="suspendedYield",m="executing",y="completed",v={};function g(){}function w(){}function E(){}var _={};u(_,i,(function(){return this}));var O=Object.getPrototypeOf,S=O&&O(O(P([])));S&&S!==r&&n.call(S,i)&&(_=S);var j=E.prototype=g.prototype=Object.create(_);function k(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(o,a,i,c){var l=f(e[o],e,a);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==h(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){r("next",e,i,c)}),(function(e){r("throw",e,i,c)})):t.resolve(s).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,c)}))}c(l.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function L(t,r,n){var o=d;return function(a,i){if(o===m)throw new Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var l=C(c,n);if(l){if(l===v)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=m;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:p,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function C(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(h(t)+" is not iterable")}return w.prototype=E,o(j,"constructor",{value:E,configurable:!0}),o(E,"constructor",{value:w,configurable:!0}),w.displayName=u(E,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,u(e,l,"GeneratorFunction")),e.prototype=Object.create(j),e},t.awrap=function(e){return{__await:e}},k(x.prototype),u(x.prototype,c,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new x(s(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(j),u(j,l,"Generator"),u(j,i,(function(){return this})),u(j,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(N),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var l=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),N(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;N(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){E(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function E(e,t,r){return t=function(e){var t=function(e,t){if("object"!==h(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===h(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e,t,r,n,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var k=function(e){return e.parentNode||document.body},x=function(e){var t=e.panel,r=e.CollaboratorChannel,a=e.InviteSelectorChannel,i=e.children,h=j(e,m),g=h.shareViewType,E=h.canCollaborator,S=h.canShare,x=h.isFileBook,L=h.onlyCollaborator,C=h.organization,A=h.group,N=h.book,I=h.me,P=h.targetResource,T=h.onChangeShare,R=h.beforeShareUpdate,D=h.getPopupContainer,M=void 0===D?k:D,U=j(h,y),F=O(o.useState(!1),2),G=F[0],B=F[1],z=O(o.useState(!1),2),Y=z[0],V=z[1];o.useEffect((function(){var e="#collaborator"===window.location.hash||window.location.hash.startsWith("#collaborator?");L&&e&&E&&g===u.b.DOC&&(V(!0),B(!0))}),[]),o.useEffect((function(){L&&E&&g===u.b.DOC&&V(!0)}),[L]);var W=function(){var e,t=(e=b().mark((function e(t){var r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=w(w({},t),{},{id:P.id}),!L){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",null==T?void 0:T(r));case 4:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){_(a,n,o,i,c,"next",e)}function c(e){_(a,n,o,i,c,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),q=o.useMemo((function(){var e=null!=C&&C.id?u.a.ORG:u.a.PERSON;return Object(s.a)()?e:u.a.INTERNAL}),[C]);return null!=P&&P.id?o.createElement(c.a,{overlayClassName:d,content:o.createElement(t,{CollaboratorChannel:r,InviteSelectorChannel:a,onAttrsChange:W,beforeAttrsChange:R,share:P,shareViewType:g,canCollaborator:E,canShare:S,isFileBook:x,belongs:q,organization:C,group:A,book:N,me:I,showCollaborator:Y,onlyCollaborator:L}),trigger:G&&f.c?"hover":"click",placement:"bottomRight",destroyTooltipOnHide:!0,visible:G,onVisibleChange:function(e){B(e)},getPopupContainer:M,noArrow:!0},i||o.createElement(n.a,v({},U,{"data-aspm-click":"c36321.d326998"}),o.createElement("span",null,__("分享")))):o.createElement(l.a,{placement:"bottomRight",title:__("当前无法使用分享，请检查网络状态"),arrowPointAtCenter:!0},o.createElement(n.a,v({className:p},U),o.createElement("span",null,__("分享"))))},L=(r(37),r(10)),C=(r(73),r(31)),A=r(267),N=r(1403),I=r(3365),P=r(11),T=r(78),R=r.n(T),D=r(3722),M=(r(1397),r(1402)),U="ShareQrCodeLazyShow-module_skeletonPanel_OLLRv",F="ShareQrCodeLazyShow-module_skeletonTitle_-9VKp",G="ShareQrCodeLazyShow-module_skeletonImage_oIjcM",B="ShareQrCodeLazyShow-module_skeletonButton_VsITP",z=function(){return o.createElement("div",{className:U},o.createElement(M.a,{className:F,title:!0,paragraph:!1,active:!0}),o.createElement(M.a.Image,{className:G}),o.createElement(M.a,{className:B,title:!0,paragraph:!1,active:!0}))},Y=(r(1196),r(954)),V=(r(3180),r(3482)),W=r(5),q=r.n(W),Z=r(213),J=r.n(Z),H=r(46),Q=r(50),$=r(518),K=r(500),X=r(3309),ee=r(3355);function te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return re(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return re(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ne=function(e){var t=e.target_id,r=e.target_type,n=te(o.useState(0),2),a=n[0],i=n[1];return o.useEffect((function(){t&&["Book","Doc"].includes(r)&&Q.a.collaborations.count({target_type:r,target_id:t,status:K.STATUS.applying}).then((function(e){i((null==e?void 0:e.count)||0)}))}),[t,r]),o.createElement(V.a,{dot:a>0,offset:[-4,4],className:ee.a.dot},o.createElement(H.b,{className:ee.a.inviteIcon,name:"icon-collaboratorlist",width:30}))},oe=function(e){var t=e.share,r=e.shareViewType,n=e.group,a=e.book,i=e.handlePanelShow;return o.createElement(o.Fragment,null,o.createElement(Y.a.Item,{className:ee.a.firstItem,actions:[o.createElement(l.a,{title:__("链接添加协作者"),placement:"top",autoAdjustOverflow:!0,arrowPointAtCenter:!0},o.createElement("div",{key:"list-loadmore-edit",onClick:function(){return i(X.c.inviteSelectorChannel)},"data-aspm-click":"c36321.d326999"},o.createElement(H.b,{className:ee.a.inviteIcon,name:"addlink",width:30}))),o.createElement(l.a,{title:__("查看所有协作者"),placement:"top",autoAdjustOverflow:!0,arrowPointAtCenter:!0},o.createElement("div",{key:"list-loadmore-more",className:ee.a.inviteIconLi,onClick:function(){r===u.b.BOOK?Object($.b)("/r/".concat(null==n?void 0:n.login,"/").concat(null==a?void 0:a.slug,"/collaborators")):r===u.b.DOC&&i(X.c.collaboratorChannel)},"data-aspm-click":"c36321.d327000"},o.createElement(ne,{target_id:null==t?void 0:t.id,target_type:J()(r.toLowerCase())})))]},o.createElement(Y.a.Item.Meta,{avatar:o.createElement(H.b,{className:q()(ee.a.itemIcon,ee.a.appointIcon),name:"nav-invite",width:40}),title:o.createElement("span",null,__("添加协作者")),description:o.createElement("span",null,__("通过链接，邀请对方加入协作"))})))},ae=r(1407),ie=r(1863),ce=r(1864),le=r(3406),ue=r(32),se=r(52),fe=r(3744);function de(e){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},de(e)}function pe(e,t,r){return t=function(e){var t=function(e,t){if("object"!==de(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==de(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===de(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function he(){he=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),c=new A(n||[]);return o(i,"_invoke",{value:k(e,r,c)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var d="suspendedStart",p="suspendedYield",h="executing",m="completed",y={};function v(){}function b(){}function g(){}var w={};u(w,i,(function(){return this}));var E=Object.getPrototypeOf,_=E&&E(E(N([])));_&&_!==r&&n.call(_,i)&&(w=_);var O=g.prototype=v.prototype=Object.create(w);function S(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function r(o,a,i,c){var l=f(e[o],e,a);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==de(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){r("next",e,i,c)}),(function(e){r("throw",e,i,c)})):t.resolve(s).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,c)}))}c(l.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,r,n){var o=d;return function(a,i){if(o===h)throw new Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var l=x(c,n);if(l){if(l===y)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?m:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var a=f(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,y;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function N(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(de(t)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=u(g,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,l,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},S(j.prototype),u(j.prototype,c,(function(){return this})),t.AsyncIterator=j,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new j(s(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S(O),u(O,l,"Generator"),u(O,i,(function(){return this})),u(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var l=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:N(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}function me(e,t,r,n,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ve(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ve(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var be=function(e){var t,r,a,i,c=e.canCollaborator,l=e.isShareActive,f=e.belongs,d=e.shareViewType,p=e.organization,h=e.group,m=e.book,y=e.share,v=e.me,b=e.handleScopeChange,g=ye(o.useState(!1),2),w=g[0],E=g[1],_=!(!p||null==p||!p.id),O=Object(I.a)(),S=null===(t=window.appData)||void 0===t||null===(r=t.settings)||void 0===r?void 0:r.user_certifications_share_scale,j=null===(a=window.appData)||void 0===a||null===(i=a.settings)||void 0===i?void 0:i.user_certifications_share_whitelist,k=Object(fe.a)(S)||j.includes(String(v.id)),x=o.useMemo((function(){var e=O.interests[se.INTEREST_CODE.create_public_resource];return e||_||d!==u.b.DOC||!k||(e=!0),e}),[h]),L=function(){var e;null===(e=window.__member_message_ref)||void 0===e||e.current.showMemberIntro(ue.LIMIT_SCENE.share_public)},C=o.useMemo((function(){if(!l&&!x&&((null==p||!p.id)&&"User"===(null==h?void 0:h.type)))return h.id===v.id?__("会员可公开内容至互联网 {btn}",{btn:o.createElement("a",{onClick:L},__("购买会员"))}):__("联系知识库所有者购买会员可公开内容至互联网");return R()(X.v,[f,Object(X.k)(y,d,h,m)])}),[d,f,y,h,m]),A=o.useMemo((function(){return R()(X.t,[f,l?"public":"private"])}),[f,l]),N=function(){var e,t=(e=he().mark((function e(){return he().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,E(!0),e.next=4,b(f===u.a.PERSON?P.PRIVACY.public:P.PRIVACY.intranet);case 4:return e.prev=4,E(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[0,,4,7]])})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){me(a,n,o,i,c,"next",e)}function c(e){me(a,n,o,i,c,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}();return o.createElement(Y.a.Item,{className:q()(pe({},ee.a.firstItem,!c)),actions:[!l&&(x||_)&&o.createElement(o.Fragment,null,o.createElement(n.a,{className:q()(ee.a.shareButton,ee.a.sharePublic),disabled:w,onClick:N},w?o.createElement(ae.default,{width:14,height:14,className:ee.a.loadingIcon}):__("公开")))]},o.createElement(Y.a.Item.Meta,{avatar:l?o.createElement(ie.default,{width:40,height:40,className:q()(ee.a.itemIcon,ee.a.publicIcon)}):o.createElement(ce.default,{width:40,height:40,className:q()(ee.a.itemIcon,ee.a.publicIcon)}),title:o.createElement("span",{className:ee.a.itemTitle},A,!x&&o.createElement(le.a,{className:ee.a.memberAbleIcon,isYuque:Object(s.a)(),group:h,organization:p})),description:C}))},ge=(r(60),r(14)),we=r(1865),Ee=r(956),_e=r.n(Ee),Oe=r(3467),Se=r(230),je=function(e){var t,r=e.shareLink,a=e.isFileBook,i=e.privacy,c=e.belongs,l=e.shareViewType,s=e.organization,f=e.group,d=e.book,p=e.share,h=e.handleScopeChange,m=e.handlePanelShow,y=e.handlePanelType,v=e.handlePanelTitle,b=e.LazyShareQrCodeChannel,g=!(!s||null==s||!s.id),w=Object(N.c)(p,l,f,d).currentPassword,E=Object(N.b)(p,l,f,d).currentIndexedLevel,_=Object(N.e)(p,l,g),O=Object(Se.g)(f),S=[{type:"scopeSet",title:__("分享范围"),hidden:c===u.a.PERSON||c===u.a.ORG&&a,defaultValue:c!==u.a.PERSON?null===(t=X.q[c].actions.find((function(e){return e.value===i})))||void 0===t?void 0:t.label:null,icon:"icon-range"},{type:"passwordSet",title:__("密码访问"),defaultValue:w||__("无密码"),icon:"icon-key-2"},{type:"searchSet",title:X.r[l][c].action,hidden:a||O,defaultValue:1===E?__("已开启"):__("关闭"),icon:"help-search"},{type:"closeShareSet",title:__("关闭公开分享"),noDetail:!0,icon:"icon-cancellink"}];_&&S.unshift({type:"shareExpiredTimeSet",title:__("有效期"),defaultValue:_.expiredTime,icon:"nav-clock"});var j=o.useCallback((function(){if(null!=r&&r.url){_e()((null==r?void 0:r.urlWithDesc)||r.url,{format:"text/plain"});var e=w?__("已复制链接和密码"):__("已复制链接");L.a.success(e,1)}}),[r]);return o.createElement("div",{className:ee.a.moreConfigs},o.createElement("div",{className:ee.a.shareLinkSet},o.createElement(ge.a,{className:q()(ee.a.shareLinkShow,ee.a.qrCode),disabled:!0,placeholder:null==r?void 0:r.url}),o.createElement(n.a,{className:ee.a.shareButton,onClick:j},__("复制链接")),o.createElement(n.a,{className:ee.a.shareQrCode,onClick:function(){return m(X.c.shareQrCodeChannel)},onMouseOver:function(){b.preload()}},o.createElement(we.default,{className:ee.a.shareQrCodeIcon,width:18,height:18}))),o.createElement(Oe.a,{settings:S,onClick:function(e,t){"closeShareSet"===e?h(P.PRIVACY.private):function(e,t){m(X.c.shareChannels),y(e),v(t)}(e,t)}}))},ke=r(3743);function xe(e){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xe(e)}function Le(){Le=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),c=new A(n||[]);return o(i,"_invoke",{value:k(e,r,c)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var d="suspendedStart",p="suspendedYield",h="executing",m="completed",y={};function v(){}function b(){}function g(){}var w={};u(w,i,(function(){return this}));var E=Object.getPrototypeOf,_=E&&E(E(N([])));_&&_!==r&&n.call(_,i)&&(w=_);var O=g.prototype=v.prototype=Object.create(w);function S(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function r(o,a,i,c){var l=f(e[o],e,a);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==xe(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){r("next",e,i,c)}),(function(e){r("throw",e,i,c)})):t.resolve(s).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,c)}))}c(l.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,r,n){var o=d;return function(a,i){if(o===h)throw new Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var l=x(c,n);if(l){if(l===y)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?m:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var a=f(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,y;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function N(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(xe(t)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=u(g,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,l,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},S(j.prototype),u(j.prototype,c,(function(){return this})),t.AsyncIterator=j,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new j(s(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S(O),u(O,l,"Generator"),u(O,i,(function(){return this})),u(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var l=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:N(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}function Ce(e,t,r,n,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function Ae(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){Ce(a,n,o,i,c,"next",e)}function c(e){Ce(a,n,o,i,c,"throw",e)}i(void 0)}))}}function Ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ie(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ie(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Pe,Te=Object(A.b)((function(){return r.e(1291).then(r.bind(null,5639))})),Re=function(e){var t=e.share,r=e.shareViewType,n=e.canShare,a=e.canCollaborator,i=void 0!==a&&a,c=e.isFileBook,l=void 0!==c&&c,s=e.showCollaborator,f=e.onlyCollaborator,d=e.belongs,p=e.beforeAttrsChange,h=e.onAttrsChange,m=e.organization,y=e.group,v=e.book,b=e.me,g=e.CollaboratorChannel,w=e.InviteSelectorChannel,E=Ne(o.useState(s?X.c.collaboratorChannel:X.c.sharePanel),2),_=E[0],O=E[1],S=Ne(o.useState(""),2),j=S[0],k=S[1],x=Ne(o.useState(""),2),A=x[0],T=x[1],M=Object(I.a)(),U=Ne(C.a.useModal(),2),F=U[0],G=U[1],B=o.useMemo((function(){return Object(N.d)(t,r,y,v)}),[t,r,y,v]),Y=B.privacy,V=B.isShareActive,W=o.useMemo((function(){var e=Object(X.k)(t,r,y,v);return d===u.a.INTERNAL&&Y===P.PRIVACY.private&&(null==v?void 0:v.extend_private)===P.EXTEND_PRIVATE.BIND_DEPARTMENTS&&(e="extend_private"),R()(X.d,[r,d,e])}),[r,d,t,y,v]),q=o.useMemo((function(){return Object(N.a)(t,r,y,v)}),[t,r,y,v]),Z=function(){var e=Ae(Le().mark((function e(n){return Le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(ke.a)(n,r,t,M,F,p,h,Y);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),L.a.error((null===e.t0||void 0===e.t0?void 0:e.t0.message)||__("操作失败"));case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Ae(Le().mark((function e(t){return Le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==h?void 0:h({encrypted_password:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Ae(Le().mark((function e(t){var r;return Le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t?1:0,e.next=3,null==h?void 0:h({indexed_level:r});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o.createElement(o.Fragment,null,o.createElement("div",{className:ee.a.sharePanel},n&&_===X.c.shareChannels&&o.createElement(D.a,{panelType:j,panelTitle:A,share:t,belongs:d,organization:m,group:y,book:v,me:b,shareViewType:r,handlePasswordChange:J,handleScopeChange:Z,handleSearchChange:H,onBack:function(){return O(X.c.sharePanel)}}),_===X.c.sharePanel&&o.createElement("div",{className:ee.a.main},o.createElement("div",{className:ee.a.mainIntro},n&&o.createElement("div",{className:ee.a.shareDescText},W),i&&o.createElement(oe,{share:t,shareViewType:r,group:y,book:v,handlePanelShow:function(e){return O(e)}}),n&&o.createElement(be,{canCollaborator:i,isShareActive:V,belongs:d,shareViewType:r,organization:m,group:y,book:v,share:t,me:b,handleScopeChange:Z})),n&&V&&o.createElement(je,{shareLink:q,isFileBook:l,privacy:Y,belongs:d,shareViewType:r,organization:m,group:y,book:v,share:t,handleScopeChange:Z,handlePanelShow:function(e){return O(e)},handlePanelType:function(e){return k(e)},handlePanelTitle:function(e){return T(e)},LazyShareQrCodeChannel:Te})),i&&_===X.c.inviteSelectorChannel&&w&&o.createElement(w,{share:t,organization:m,group:y,book:v,shareViewType:r,onBack:function(){return O(X.c.sharePanel)},inviteContent:"inviteSharePanel"}),i&&_===X.c.collaboratorChannel&&g&&o.createElement(g,{onlyCollaborator:f,share:t,organization:m,group:y,book:v,inviteContent:"collaboratorPanel",onBack:function(){return O(X.c.sharePanel)}}),n&&V&&_===X.c.shareQrCodeChannel&&o.createElement(o.Suspense,{fallback:o.createElement(z,null)},o.createElement(Te,{share:t,shareViewType:r,link:null==q?void 0:q.url,onBack:function(){return O(X.c.sharePanel)}}))),G)},De=r(1210),Me=r(480),Ue=r(2),Fe=r.n(Ue),Ge=r(1450),Be=r(3370),ze=r(790),Ye=(r(229),r(34)),Ve=(r(279),r(138)),We=(r(498),r(100)),qe=r(1698),Ze=r(499),Je=r(116),He=(r(650),r(319)),Qe=r(1212),$e=r(3510),Ke={role:"RoleSelector-module_role_jDwZn",trigger:"RoleSelector-module_trigger_PbJ3K",active:"RoleSelector-module_active_lhpS5",icon:"RoleSelector-module_icon_YSGjG",up:"RoleSelector-module_up_BKR9i",menu:"RoleSelector-module_menu_MwfMA",label:"RoleSelector-module_label_JI2Gx",menuItem:"RoleSelector-module_menuItem_cwz56",desc:"RoleSelector-module_desc_lnp7h"};function Xe(e){return Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xe(e)}function et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return tt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rt(e,t,r){return t=function(e){var t=function(e,t){if("object"!==Xe(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Xe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Xe(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var nt=(rt(Pe={},K.ROLE.edit,{label:Object($e.c)(K.ROLE.edit),desc:__("拥有文档的编辑权限"),role:K.ROLE.edit}),rt(Pe,K.ROLE.readonly,{label:Object($e.c)(K.ROLE.readonly),desc:__("仅拥有只读和评论权限"),role:K.ROLE.readonly}),Pe),ot=function(e){var t=et(Object(o.useState)(!1),2),r=t[0],n=t[1],i=e.role,c=e.placement,l=e.canChange,u=e.disableItems,s=e.externalActions,f=nt[i];if(!l)return a.a.createElement("span",{className:Ke.status,"data-collaboration-role":i},null==f?void 0:f.label);return a.a.createElement("div",{className:"role-selector"},a.a.createElement(He.a,{trigger:["click"],placement:c,onVisibleChange:function(e){n(e)},overlay:a.a.createElement(We.a,{selectedKeys:["".concat(i)],className:Ke.menu,style:{border:"none"}},[K.ROLE.edit,K.ROLE.readonly].map((function(t){var r=nt[t],o=u.includes(r.role);return a.a.createElement(We.a.Item,{key:"".concat(r.role),disabled:o,onClick:function(){return t=r.role,e.onChange(t),void n(!1);var t}},a.a.createElement("a",{className:Ke.menuItem,href:"#"},a.a.createElement("span",null,a.a.createElement("span",{className:Ke.label},r.label),a.a.createElement("span",{className:Ke.desc},r.desc)),a.a.createElement(Qe.default,{style:{color:"#25B864"}})))})),s&&s())},a.a.createElement("span",{className:q()(Ke.trigger,rt({},Ke.active,r)),"data-collaboration-role":i},null==f?void 0:f.label," ",a.a.createElement(H.b,{name:"arrow-down",className:q()(Ke.icon,rt({},Ke.up,r)),width:16}))))};ot.propTypes={onChange:Fe.a.func,placement:Fe.a.string,canChange:Fe.a.bool,role:Fe.a.oneOf([K.ROLE.readonly,K.ROLE.edit]),externalActions:Fe.a.func,disableItems:Fe.a.array},ot.defaultProps={onChange:function(){},placement:"bottomRight",role:0,canChange:!0,disableItems:[]};var at=ot,it={joinUserItem:"Item-module_joinUserItem_0O6yw",userInfo:"Item-module_userInfo_F4pgj",showItem:"Item-module_showItem_sCn3R",avatar:"Item-module_avatar_JD1HW",userDesc:"Item-module_userDesc_q4mqR",name:"Item-module_name_ff-QM",selectorItem:"Item-module_selectorItem_UePAS",loginShow:"Item-module_loginShow_DePxA",login:"Item-module_login_bu7O2",department:"Item-module_department_y3daB",applyPending:"Item-module_applyPending_7Va+N",pending:"Item-module_pending_KikZW",pendingRole:"Item-module_pendingRole_mvO-A",topRightDesc:"Item-module_topRightDesc_dQW2s",actions:"Item-module_actions_Mfqej",actionItem:"Item-module_actionItem_piU3P",actionItemReject:"Item-module_actionItemReject_rSq40",actionItemLabel:"Item-module_actionItemLabel_kzYeZ",deleteActionItem:"Item-module_deleteActionItem_RJWcd",label:"Item-module_label_qLBXy",desc:"Item-module_desc_-+chL"};function ct(e){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ct(e)}function lt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,st(n.key),n)}}function ut(e,t,r){return(t=st(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function st(e){var t=function(e,t){if("object"!==ct(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==ct(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ct(t)?t:String(t)}function ft(){ft=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),c=new A(n||[]);return o(i,"_invoke",{value:k(e,r,c)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var d="suspendedStart",p="suspendedYield",h="executing",m="completed",y={};function v(){}function b(){}function g(){}var w={};u(w,i,(function(){return this}));var E=Object.getPrototypeOf,_=E&&E(E(N([])));_&&_!==r&&n.call(_,i)&&(w=_);var O=g.prototype=v.prototype=Object.create(w);function S(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function r(o,a,i,c){var l=f(e[o],e,a);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==ct(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){r("next",e,i,c)}),(function(e){r("throw",e,i,c)})):t.resolve(s).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,c)}))}c(l.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,r,n){var o=d;return function(a,i){if(o===h)throw new Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var l=x(c,n);if(l){if(l===y)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?m:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var a=f(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,y;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function N(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(ct(t)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=u(g,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,l,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},S(j.prototype),u(j.prototype,c,(function(){return this})),t.AsyncIterator=j,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new j(s(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S(O),u(O,l,"Generator"),u(O,i,(function(){return this})),u(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var l=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:N(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}function dt(e,t,r,n,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}function pt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ht(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ht(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mt(e){var t=e.data,r=e.renderActions;return a.a.createElement("div",{"data-testid":"join-user-item",key:t.uid,className:it.joinUserItem,onClick:function(){t.ableToAdd()&&e.onAdd(t)}},a.a.createElement("div",{className:q()(it.userInfo,ut({},it.showItem,!t.isNewUser()))},a.a.createElement("span",{className:it.avatar},a.a.createElement(Ze.a,{src:t.avatar,name:t.name,size:"sm"})),a.a.createElement("div",{className:it.userDesc},function(e){var t,r=window.appData.isYuque,n=e.login||e.uid;if(!r){var o,i=(null===(o=e.data)||void 0===o?void 0:o.lastName)||e.login;return a.a.createElement("div",{className:q()(it.name,ut({},it.selectorItem,e.isNewUser()))},a.a.createElement("p",{className:it.loginShow},e.name,a.a.createElement("span",{className:it.login},__("（")+i+__("）"))),a.a.createElement("p",{className:it.department},e.department))}return a.a.createElement("div",{className:it.name},e.name,1!==(null===(t=e.collaborator)||void 0===t?void 0:t.status)?null:a.a.createElement("span",{className:it.login},__("（")+n+__("）")))}(t),!t.isGroupMember()&&!t.isGroupReadonlyMember()&&t.isInvited()&&!t.isMine()&&a.a.createElement("span",{className:it.topRightDesc},__("尚未加入")),!t.isGroupMember()&&!t.isGroupReadonlyMember()&&t.isApplying()&&a.a.createElement("div",{className:it.applyPending},a.a.createElement("span",{className:it.pending},__("申请权限")),a.a.createElement("span",{className:q()(it.pending,it.pendingRole)},"0"===t.role?__("可阅读"):__("可编辑"))))),a.a.createElement("div",{className:it.actions},r(e)))}var yt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ut(this,"data",void 0),this.data=t}var t,r,n;return t=e,(r=[{key:"actionId",get:function(){throw new Error("需要实现这个对象")}},{key:"actionType",get:function(){throw new Error("需要实现这个对象")}},{key:"uid",get:function(){return this.data.uid}},{key:"id",get:function(){return this.data.id}},{key:"login",get:function(){return this.data.login}},{key:"name",get:function(){return this.data.name}},{key:"avatar",get:function(){return this.data.avatar_url}},{key:"role",get:function(){return this.data.role}},{key:"provider_type",get:function(){return this.data.provider_type}},{key:"provider_userid",get:function(){return this.data.provider_userid}}])&&lt(t.prototype,r),n&&lt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),vt=function(e){if(!(e.data instanceof yt))throw new Error("data should be extend ItemBase");return mt(e)};vt.propTypes={data:Fe.a.object.isRequired,renderActions:Fe.a.func,onAgree:Fe.a.func,onReject:Fe.a.func,onDelete:Fe.a.func,onRoleChange:Fe.a.func,onAdd:Fe.a.func,limited:Fe.a.bool},vt.defaultProps={renderActions:function(e){var t=e.data,r=e.limited,o=a.a.useRef(null),i=pt(C.a.useModal(),2),c=i[0],l=i[1];if(t.ableToAdd())return null;if(t.isMine())return a.a.createElement("span",{className:it.actionItemLabel},__("你自己"));var u=function(e){var t=__("确认拒绝 ".concat(e," 的访问申请？")),r=__("确认要拒绝 ".concat(e," 的访问申请吗？"));return new Promise((function(e){c.confirm({icon:a.a.createElement(qe.default,null),width:505,title:t,content:__("{desc}拒绝后该用户无法访问该文档。",{desc:r}),okText:__("拒绝"),cancelText:__("取消"),onOk:function(){e(!0)},onCancel:function(){e(!1)},getContainer:function(){return o.current||document.body}})}))},s=function(){var t,r=(t=ft().mark((function t(r){return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u(r.name);case 2:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:Object(Je.spmClick)("c330513",{source:window.location.href.includes("source=auto_apply")?"auto_apply":"default",action:"refuse",infoType:"Doc"}),e.onReject(r);case 7:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(e){dt(a,n,o,i,c,"next",e)}function c(e){dt(a,n,o,i,c,"throw",e)}i(void 0)}))});return function(e){return r.apply(this,arguments)}}();return a.a.createElement(a.a.Fragment,null,t.isUpdateAbility()&&t.isApplying()&&a.a.createElement(a.a.Fragment,null,a.a.createElement(n.a,{type:"text",size:"small",onClick:function(){e.onAgree(t),Object(Je.spmClick)("c330513",{source:window.location.href.includes("source=auto_apply")?"auto_apply":"default",action:"approve",infoType:"Doc"})},className:it.actionItem,"data-testid":"join-user-agree-button",disabled:r},__("同意")),a.a.createElement(n.a,{type:"text",size:"small",onClick:function(){s(t)},className:q()(it.actionItem,it.actionItemReject)},__("拒绝"))),t.isUpdateAbility()&&(t.isJoined()||t.isInvited())&&a.a.createElement(at,{role:parseInt(t.role,10),onChange:function(r){e.onRoleChange(t,r)},externalActions:function(){return a.a.createElement(We.a.Item,{key:"deleteItem-".concat(t.role)},a.a.createElement("a",{key:"deleteItem",className:it.deleteActionItem,"data-testid":"join-user-delete-button",onClick:function(){e.onDelete(t)}},a.a.createElement("span",null,a.a.createElement("span",{className:it.label},__("移除")),a.a.createElement("span",{className:it.desc},__("移除该协作者")))))},canChange:t.isUpdateAbility()}),l)}};var bt=vt;function gt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return wt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Et=function(e){var t=gt(Object(o.useState)(""),2),r=t[0],n=t[1],i=e.renderItem,c=e.dataSource,l="searchSelector-".concat(+new Date);return a.a.createElement("div",{className:"join-user-search-selector",id:l},a.a.createElement("div",{className:"selector"},a.a.createElement(Ye.a,{mode:"multiple",labelInValue:!0,listHeight:354,value:[],placeholder:e.placeholder,notFoundContent:e.loading?a.a.createElement(Ve.a,{justify:"block"}):r?e.renderNotFound():null,filterOption:!1,onSearch:function(t){n(t),e.onSearch(t)},onChange:e.onChange,onSelect:function(t,r){n("");var o=c.find((function(r){return r[e.key]===t.key}));o&&e.onSelect(o)},onBlur:function(){n(""),e.onBlur&&e.onBlur()},style:{width:"100%"},disabled:e.disableSearch,getPopupContainer:function(){return document.getElementById(l)}},c.map((function(t){return a.a.createElement(Ye.a.Option,{key:t[e.key],className:"selector-item",disabled:e.disableSelect(t)},a.a.createElement("div",{className:"full-item"},a.a.createElement(i,{data:t,onAgree:e.onAgree,onReject:e.onReject,onDelete:e.onDelete,onRoleChange:e.onRoleChange,onAdd:e.onAdd,renderActions:e.renderActions})),a.a.createElement("div",{className:"simple-item"},t[e.name]))})))))};Et.propTypes={dataSource:Fe.a.array,renderItem:Fe.a.func,renderNotFound:Fe.a.func,renderActions:Fe.a.func,key:Fe.a.string,name:Fe.a.string,disableSelect:Fe.a.func,onSearch:Fe.a.func,onChange:Fe.a.func,onSelect:Fe.a.func,onAgree:Fe.a.func,onReject:Fe.a.func,onDelete:Fe.a.func,onRoleChange:Fe.a.func,onAdd:Fe.a.func,onBlur:Fe.a.func,loading:Fe.a.bool,placeholder:Fe.a.string,disableSearch:Fe.a.bool},Et.defaultProps={key:"uid",name:"name",placeholder:__("搜索添加用户"),loading:!1,dataSource:[],renderItem:bt,renderNotFound:function(){return null},onSearch:function(){},onChange:function(){},onSelect:function(){},onAgree:function(){},onReject:function(){},onDelete:function(){},onRoleChange:function(){},onBlur:function(){},onAdd:function(){},disableSelect:function(){return!1},disableSearch:!1};var _t=Et,Ot="EmptyTip-module_emptyTip_aBtYt",St="EmptyTip-module_emptyImageWrapper_6BIQC",jt="EmptyTip-module_emptyImage_u42M6",kt="EmptyTip-module_emptyText_JUjEv",xt=function(){return a.a.createElement("div",{className:Ot},a.a.createElement("div",{className:St},a.a.createElement("img",{src:"https://gw.alipayobjects.com/mdn/prod_resou/afts/img/A*aSg9SJR6isIAAAAAAAAAAAAAARQnAQ",className:jt})),a.a.createElement("p",{className:kt},__("暂无文档协作者")))},Lt="List-module_item_Yt8gv",Ct=function(e){var t=e.dataSource,r=e.renderItem,n=e.limited,o=t.filter((function(e){return e.collaborator.status===K.STATUS.joined})),i=t.filter((function(e){return e.collaborator.status!==K.STATUS.joined}));return a.a.createElement(a.a.Fragment,null,!!i.length&&a.a.createElement(a.a.Fragment,null,null==i?void 0:i.map((function(t){return a.a.createElement("div",{key:t.id||t.login,className:Lt},a.a.createElement(r,{data:t,onAgree:e.onAgree,onReject:e.onReject,onDelete:e.onDelete,onRoleChange:e.onRoleChange,onAdd:e.onAdd,renderActions:e.renderActions,limited:n}))}))),!!o.length&&a.a.createElement(a.a.Fragment,null,null==o?void 0:o.map((function(t){return a.a.createElement("div",{key:t.id||t.login,className:Lt},a.a.createElement(r,{data:t,onAgree:e.onAgree,onReject:e.onReject,onDelete:e.onDelete,onRoleChange:e.onRoleChange,onAdd:e.onAdd,renderActions:e.renderActions}))}))))};Ct.propTypes={dataSource:Fe.a.array,onAgree:Fe.a.func,onReject:Fe.a.func,onDelete:Fe.a.func,onRoleChange:Fe.a.func,onAdd:Fe.a.func,renderItem:Fe.a.func,renderActions:Fe.a.func,limited:Fe.a.bool},Ct.defaultProps={dataSource:[],onAgree:function(){},onReject:function(){},onDelete:function(){},onRoleChange:function(){},onAdd:function(){},renderItem:bt};var At=Ct,Nt={title:"Modal-module_title_Fhe+q",menu:"Modal-module_menu_GTmMW",searchWrapper:"Modal-module_searchWrapper_G76nZ",searchSelector:"Modal-module_searchSelector_qZfrJ",searchAdd:"Modal-module_searchAdd_srKkd",btnLoadMore:"Modal-module_btnLoadMore_+NLxh",spinContainer:"Modal-module_spinContainer_6y18w",listWrapper:"Modal-module_listWrapper_YI-Wn"};function It(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Tt=function(e){var t=e.collaboratorCount,r=It(a.a.useState(!1),2),n=r[0],o=r[1],i=window.appData,c=i.isYuque,l=i.organization,u=i.group,f=t>=ze.a.getDocCollaboratorLimit(u),d=!(Object(s.a)()&&(null==l||!l.id));return e.onLoading?a.a.createElement("div",{className:Nt.spinContainer},a.a.createElement(M.a,{title:!0,paragraph:!1,active:!0}),a.a.createElement(M.a,{avatar:!0,title:!0,paragraph:!1,active:!0}),a.a.createElement(M.a,{avatar:!0,title:!0,paragraph:!1,active:!0}),a.a.createElement(M.a,{avatar:!0,title:!0,paragraph:!1,active:!0}),a.a.createElement(M.a,{avatar:!0,title:!0,paragraph:!1,active:!0})):a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:Nt.content},c&&e.memberDocCollaboratorTip&&a.a.createElement(Ge.e,{collaboratorCount:e.collaboratorCount,user:u}),a.a.createElement("div",{className:Nt.searchWrapper},e.showSearch&&a.a.createElement("div",{className:Nt.searchSelector},a.a.createElement(_t,{loading:e.searchLoading,dataSource:e.searchData,placeholder:e.placeholder,onSelect:e.onSelect,onSearch:e.onSearch,onChange:e.onChange,onAgree:e.onAgree,onReject:e.onReject,onDelete:e.onDelete,onRoleChange:e.onRoleChange,onAdd:e.onAdd,onBlur:e.onBlur,disableSelect:e.disableSelect,disableSearch:e.disableSearch,renderNotFound:e.renderSearchNotFound,renderItem:e.renderItem,renderActions:e.renderActions})),d&&a.a.createElement("div",{className:Nt.searchAdd,onClick:function(){return o(!0)}},__("批量添加"))),e.dataSource.length>0?a.a.createElement("div",{className:Nt.listWrapper},a.a.createElement(At,{dataSource:e.dataSource,onAgree:e.onAgree,onReject:e.onReject,onDelete:e.onDelete,onRoleChange:e.onRoleChange,onAdd:e.onAdd,renderItem:e.renderItem,renderActions:e.renderActions,limited:c&&f}),e.moreLoading?a.a.createElement("div",{className:Nt.btnLoadMore},__("加载中...")):e.shouldLoadMore?a.a.createElement("div",{className:Nt.btnLoadMore,onClick:e.onLoadMore},__("加载更多")):null):a.a.createElement(xt,null)),n&&a.a.createElement(Be.a,{type:"doc",visible:n,onCancel:function(){return o(!1)},afterSubmit:function(){var t;o(!1),null===(t=e.onAdd)||void 0===t||t.call(e)}}))};Tt.propTypes={dataSource:Fe.a.array,shouldLoadMore:Fe.a.bool,onLoadMore:Fe.a.func,onAgree:Fe.a.func,onReject:Fe.a.func,onDelete:Fe.a.func,onRoleChange:Fe.a.func,onAdd:Fe.a.func,moreLoading:Fe.a.bool,renderItem:Fe.a.func,renderActions:Fe.a.func,dispatch:Fe.a.func,memberDocCollaboratorTip:Fe.a.bool,collaboratorCount:Fe.a.number,searchData:Fe.a.array,placeholder:Fe.a.string,disableSearch:Fe.a.bool,disableSelect:Fe.a.func,onSearch:Fe.a.func,onChange:Fe.a.func,onSelect:Fe.a.func,onBlur:Fe.a.func,searchLoading:Fe.a.bool,renderSearchNotFound:Fe.a.func,showSearch:Fe.a.bool,onLoading:Fe.a.bool},Tt.defaultProps={collaboratorCount:0,dataSource:[],searchData:[],shouldLoadMore:!1,moreLoading:!1,onLoadMore:function(){},showSearch:!0,disableSearch:!1};var Rt=Tt,Dt=r(320),Mt=r(3639),Ut=r(3329),Ft=r(3537),Gt="SearchNotFound-module_notfound_MSXOw",Bt="SearchNotFound-module_notfoundTitle_Br7DA",zt=function(){return a.a.createElement("div",{className:Gt},a.a.createElement("p",{className:Bt},__("未在空间中找到该用户，请检查输入或联系管理员添加到空间成员")))},Yt=function(){return a.a.createElement("div",{className:Gt},a.a.createElement("p",{className:Bt},__("未搜索到相关用户")))},Vt=r(101);function Wt(e){return Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wt(e)}function qt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,a=void 0,a=function(e,t){if("object"!==Wt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Wt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Wt(a)?a:String(a)),n)}var o,a}function Jt(e,t,r){return t&&Zt(e.prototype,t),r&&Zt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ht(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qt(e,t)}function Qt(e,t){return Qt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Qt(e,t)}function $t(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Kt(e);if(t){var o=Kt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===Wt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function Kt(e){return Kt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Kt(e)}var Xt=function(e){Ht(r,e);var t=$t(r);function r(e,n,o,a,i){var c;return qt(this,r),(c=t.call(this,e)).collaborator=n,c.groupUser=o,c.target=a,c.book=i||a,c}return Jt(r,[{key:"department",get:function(){var e,t,r;return(null===(e=this.data)||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.department)||(null===(r=this.data)||void 0===r?void 0:r.dep)||null}},{key:"actionId",get:function(){return this.collaborator.id}},{key:"actionType",get:function(){return this.collaborator.type}},{key:"uid",get:function(){return this.data.uid||Object(Ut.format)([this.data]),this.data.uid}},{key:"userId",get:function(){return this.data.id}},{key:"role",get:function(){return this.collaborator&&String(this.collaborator.role)}},{key:"workId",get:function(){return this.data.workid}},{key:"isUpdateAbility",value:function(){return this.target.abilities.create_collaborator}},{key:"isInvited",value:function(){return this.collaborator&&this.collaborator.status===K.STATUS.invited}},{key:"isJoined",value:function(){return this.collaborator&&this.collaborator.status===K.STATUS.joined}},{key:"isApplying",value:function(){return this.collaborator&&this.collaborator.status===K.STATUS.applying}},{key:"isGroupMember",value:function(){return this.groupUser&&this.groupUser.role!==Vt.ROLE.readonly}},{key:"isGroupReadonlyMember",value:function(){return this.groupUser&&this.groupUser.role===Vt.ROLE.readonly}},{key:"isMine",value:function(){return window.appData.me.login===this.login}},{key:"isNewUser",value:function(){return this.isUpdateAbility()&&!this.isMine()&&!this.isApplying()&&!this.isJoined()&&!this.isInvited()}},{key:"ableToAdd",value:function(){return this.isNewUser()}}]),r}(yt),er=function(e){Ht(r,e);var t=$t(r);function r(e,n,o,a){var i,c;return qt(this,r),(c=t.call(this,e)).collaborator=e,c.user=e.owner,c.collaborator.owner_id=null===(i=c.user)||void 0===i?void 0:i.id,c.groupUser=n,c.target=o,c.book=a||o,c.departments=e.departments,c}return Jt(r,[{key:"department",get:function(){var e;return null!==(e=this.departments)&&void 0!==e&&e.length?this.departments.map((function(e){return e.name})).join("-"):null}},{key:"ownerType",get:function(){return this.collaborator.owner_type}},{key:"actionId",get:function(){return this.collaborator.id}},{key:"actionType",get:function(){return this.collaborator.type}},{key:"uid",get:function(){return this.user.uid||Object(Ut.format)([this.user]),this.user.uid}},{key:"userId",get:function(){return this.user.id}},{key:"role",get:function(){return String(this.collaborator.role)}},{key:"login",get:function(){return this.user.login}},{key:"name",get:function(){return this.user.name}},{key:"avatar",get:function(){return this.user.avatar_url}},{key:"workId",get:function(){return this.user.workid}},{key:"isUpdateAbility",value:function(){return this.target.abilities.create_collaborator}},{key:"isInvited",value:function(){return this.collaborator.status===K.STATUS.invited}},{key:"isJoined",value:function(){return this.collaborator.status===K.STATUS.joined}},{key:"isApplying",value:function(){return this.collaborator.status===K.STATUS.applying}},{key:"isGroupMember",value:function(){return this.groupUser&&this.groupUser.role!==Vt.ROLE.readonly}},{key:"isGroupReadonlyMember",value:function(){return this.groupUser&&this.groupUser.role===Vt.ROLE.readonly}},{key:"isMine",value:function(){return window.appData.me.login===this.login&&this.isUser()}},{key:"isNewUser",value:function(){return this.isUpdateAbility()&&!this.isMine()&&!this.isApplying()&&!this.isJoined()&&!this.isInvited()}},{key:"ableToAdd",value:function(){return this.isNewUser()}},{key:"isUser",value:function(){return this.ownerType===K.OWNER_TYPE.User}}]),r}(yt);function tr(e){return tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tr(e)}function rr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function nr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rr(Object(r),!0).forEach((function(t){or(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function or(e,t,r){return t=function(e){var t=function(e,t){if("object"!==tr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==tr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===tr(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ar(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ir(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ir(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ir(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var cr=function(e){var t=e.group,r=e.book,n=e.doc,i=e.organization,c=e.dispatch,l=e.isEditing,u=e.onReverting,s=window.appData.isYuque,f=ar(Object(o.useState)(0),2),d=f[0],p=f[1],h=ar(Object(o.useState)(0),2),m=h[0],y=h[1],v=ar(Object(o.useState)(!1),2),b=v[0],g=v[1],w=ar(Object(o.useState)(!1),2),E=w[0],_=w[1],O=ar(Object(Mt.c)(n,{dispatch:c,book:r,group:t,isEditing:l}),5),S=O[0],j=O[1],k=O[2],x=O[3],C=O[4],A=ar(Object(Mt.e)(n,{dispatch:c,organization:i,optional_properties:"profile"}),4),N=A[0],I=A[1],P=A[2],T=A[3],R=function(e){Q.a.collaborations.count({target_type:"Doc",target_id:e.id}).then((function(e){y((null==e?void 0:e.count)||0)}))},D=function(e){return c({type:"proxy.web/collaborations.find",payload:{data:{target_type:"Doc",target_id:e.id,offset:d,optional_properties:"departments"},reducer:0===d?"doc/updateCollaborations":"doc/addCollaborations"}}).then((function(e){200===e.length&&_(!0)}))};Object(o.useEffect)((function(){var e;e=n,g(!0),D(e).then((function(){g(!1)})).catch((function(e){g(!1)})),c({type:"proxy.web/groups.users",payload:{data:{id:t.id},reducer:"group/updateMembers"}}),R(n)}),[n.id,t.id]);var M=function(e){c({type:"proxy.web/collaborations.destroy",payload:{data:{id:e.actionId,type:e.actionType},reducer:"doc/removeCollaboration"}}).then((function(){var t=!e.isMine()&&!e.isApplying();L.a.success(a.a.createElement("span",null,__("操作成功"),t&&a.a.createElement("a",{className:Ft.a.revertLink,onClick:function(){u&&u(),L.a.destroy(),c({type:"doc/addCollaborator",payload:{data:e.collaborator}}).then((function(){L.a.success(__("撤销成功!")),D(n),R(n)}))}},__("撤销"))),3),R(n)}))},U=s&&m>=ze.a.getDocCollaboratorLimit(t);Object(Ut.format)(t.members.map((function(e){return e.user}))),Object(Ut.format)(n.collaborations.map((function(e){return e.owner})));var F=N.map((function(e){var o=t.members.find((function(t){var r;return(null===(r=t.user)||void 0===r?void 0:r.uid)===e.uid})),a=n.collaborations.find((function(t){var r;return(null===(r=t.owner)||void 0===r?void 0:r.uid)===e.uid}));return new Xt(e,a,o,n,r)})),G=n.collaborations.map((function(e){var o=t.members.find((function(t){var r,n;return(null===(r=t.user)||void 0===r?void 0:r.uid)===(null===(n=e.owner)||void 0===n?void 0:n.uid)}));return new er(e,o,n,r)}));return a.a.createElement(Rt,{memberDocCollaboratorTip:s&&!!n,collaboratorCount:m,placeholder:__("输入用户名邀请协作"),dataSource:G,link:S,onRefreshLink:j,linkLoading:k,checked:x,onCheckChange:C,searchData:F,onSearch:I,onSelect:function(e){e.ableToAdd()&&function(e){var t={target_type:"Doc",target_id:n.id,role:K.ROLE.edit};e.userId?t.user_id=e.userId:t=nr(nr({},t),{},{login:e.login,workid:e.workId,name:e.name,provider_type:e.provider_type,provider_userid:e.provider_userid}),c({type:"proxy.web/collaborations.create",payload:{data:t,reducer:"doc/addOneCollaboration"}}).then((function(){L.a.success(__("添加成功")),setTimeout((function(){R(n),D(n)}),100)}))}(e),T(e)},onBlur:T,disableSelect:function(e){return U||e&&!e.ableToAdd()},disableSearch:U,searchLoading:P,onAgree:function(e){c({type:"proxy.web/collaborations.approve",payload:{data:{id:e.actionId},reducer:"doc/updateOneCollaboration"}}).then((function(e){var t=__("已同意用户 {member} 加入",{member:e.owner.name});L.a.success(t),R(n)}))},onReject:M,onDelete:M,onRoleChange:function(e,t){c({type:"proxy.web/collaborations.update",payload:{data:{id:e.actionId,role:t},reducer:"doc/updateOneCollaboration"}}).then((function(){L.a.success(__("更新成功")),R(n)}))},onAdd:function(){D(n),R(n)},disableInvite:U,onLoadMore:function(){p(d+200),D(n)},shouldLoadMore:E,onLoading:b,showSearch:n.abilities.create_collaborator,showJoinLink:n.abilities.create_collaborator,renderSearchNotFound:i&&i.id?zt:Yt})};cr.propTypes={dispatch:Fe.a.func.isRequired,organization:Fe.a.object.isRequired,group:Fe.a.object.isRequired,book:Fe.a.object.isRequired,doc:Fe.a.object.isRequired,isEditing:Fe.a.bool,onReverting:Fe.a.func};var lr=Object(Me.d)((function(e){return e}))(Object(Dt.b)(cr)),ur=r(3475),sr=r(3472);function fr(e){return fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fr(e)}function dr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?dr(Object(r),!0).forEach((function(t){hr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function hr(e,t,r){return t=function(e){var t=function(e,t){if("object"!==fr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==fr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===fr(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var mr=function(e){var t,r=e.share,n=e.shareViewType,a=e.isEditing,i=e.inviteContent,c=e.organization,l=e.group,s=e.book,f=e.onBack,d=e.onToggleCollaboratorShow,p={type:n.toLowerCase(),book:s,group:l,organization:c};n===u.b.DOC&&(t=pr(pr({},p),{},{doc:r}));var h,m=o.useMemo((function(){return sr.a.create(t||p)}),[t,p]);return m&&m.enable&&(h={id:sr.a.id,title:sr.a.title,inviteSelectorType:n.toLowerCase(),getJoinUrl:m.getUrl,getToken:m.getToken,updateToken:m.updateToken,deleteTokens:m.deleteTokens,getCopyText:m.getCopyText,inviteModalContent:i,onBackShare:f,moreSettingOptions:m.getMoreSettingOptions(),organization:c,isEditing:a,inviteTarget:r,toggleCollaboratorList:function(e){null==d||d(e)}}),o.createElement(o.Fragment,null,o.createElement(ur.a,h))},yr=r(3337);function vr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return br(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return br(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function br(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var gr=function(e){var t=e.onlyCollaborator,r=e.share,n=e.inviteContent,a=e.organization,i=e.group,c=e.book,l=e.onBack,u=vr(o.useState(!0),2),s=u[0],f=u[1];return o.createElement(o.Fragment,null,s&&o.createElement("div",{className:q()(yr.a.shareDetailSettingPanel,yr.a.collaborator)},t?o.createElement("div",{className:yr.a.title},__("文档协作者")):o.createElement("div",{className:yr.a.title,onClick:l},o.createElement(De.default,{className:yr.a.backIcon,width:20,height:20}),__("文档协作者"))),s&&o.createElement("div",{className:yr.a.collaboratorContent},o.createElement(lr,null)),o.createElement(mr,{share:r,organization:a,group:i,book:c,shareViewType:"DOC",isEditing:!0,inviteContent:n,onToggleCollaboratorShow:function(e){return f(e)}}))};function wr(){return wr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wr.apply(this,arguments)}var Er=function(e){return o.createElement(i.a,{withFallbackUI:!0,noMessage:!0,fallbackUI:function(){return o.createElement(n.a,null,__("分享"))}},o.createElement(x,wr({panel:Re,CollaboratorChannel:gr,InviteSelectorChannel:mr},e)))}},651:function(e,t,r){"use strict";r(2890);var n=r(1232);r(999);t.a=n.a},954:function(e,t,r){"use strict";r(2899);var n=r(801),o=r(83),a=r.n(o),i=r(58),c=r.n(i),l=r(1206),u=r.n(l),s=r(86),f=r.n(s),d=r(137),p=r.n(d),h=r(0),m=r.n(h),y=r(2),v=r.n(y),b=r(5),g=r.n(b),w=r(84),E=r.n(w),_=r(175),O=r.n(_);var S=r(64),j=r.n(S)()("useInifiniteScroll"),k=function(e,t){var r,n,o,a,i,c,l=(r=!1,n=Object(h.useState)(r),o=O()(n,2),a=o[0],i=o[1],(c=Object(h.useRef)(a)).current=a,[a,i,Object(h.useCallback)((function(){return c.current}),[])]),s=O()(l,3),f=s[0],d=s[1],m=s[2],y=Object(h.useRef)(null);y.current=e;var v=Object(h.useCallback)(function(){var e=u()(p.a.mark((function e(t){var r,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=O()(t,1),n=r[0],!m()){e.next=3;break}return e.abrupt("return");case 3:if(null==n||!n.isIntersecting){e.next=12;break}return j("entry?.isIntersecting",null==n?void 0:n.isIntersecting),e.prev=5,d(!0),e.next=9,y.current();case 9:return e.prev=9,d(!1),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[5,,9,12]])})));return function(t){return e.apply(this,arguments)}}(),[y]);return{loading:f,refCallback:Object(h.useCallback)((function(e){j("ref",e);var r,n=null;if(e&&!n&&window.IntersectionObserver)return j("enter"),n=new IntersectionObserver(v,{threshold:(null==t?void 0:t.threshold)||.1,root:(null===(r=t.root)||void 0===r?void 0:r.current)||null}),j("observe",e),n.observe(e),function(){return n.unobserve(e)}}),[t.threshold])}},x=r(704),L=r(138),C=(r(1196),["className","emptyView","onLoadMore","dataSource","renderItem","loading","showLoadingMore","pagination","children","justify","customItem","loadOnScroll","listContainer"]);function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var I=m.a.forwardRef((function(e,t){var r=e.className,o=e.emptyView,a=e.onLoadMore,i=e.dataSource,l=e.renderItem,s=e.loading,d=e.showLoadingMore,h=e.pagination,y=e.children,v=e.justify,b=e.customItem,w=e.loadOnScroll,E=e.listContainer,_=f()(e,C),O=e.loadMoreText,S=void 0===O?Object(x.a)("查看更多"):O,j=s;"boolean"==typeof j&&(j={spinning:j});var A=j&&j.spinning,I=k(u()(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!w||!a){e.next=3;break}return e.next=3,a();case 3:case"end":return e.stop()}}),e)}))),{root:E}),P=I.loading,T=I.refCallback;w&&(S=Object(x.a)("到底了"));var R=i.length&&d?m.a.createElement("div",{className:"larkui-list-block-more"},A&&m.a.createElement(L.a,c()({justify:"block"},j)),!A&&m.a.createElement("a",{className:"larkui-list-block-more-btn",ref:T,onClick:function(e){e.preventDefault(),a&&a()}},P?Object(x.a)("加载中"):S)):null;if(A&&!R)return m.a.createElement("div",{className:g()("larkui-list","larkui-list-loading")},m.a.createElement(L.a,c()({justify:"block"},j)));var D=h;return D&&(D=h.total<=h.pageSize?null:N({showSizeChanger:!1},D)),m.a.createElement(n.b,c()({ref:t,className:g()(r,"larkui-list",{"larkui-list-justify-block":"block"===v}),loading:!1,loadMore:R,pagination:D,dataSource:i.length>0?i:e.emptyView?["empty"]:[],renderItem:function(e,t){if("empty"===e)return m.a.createElement("div",{className:"blankslate"},o);var r=l(e,t);return r?b?r:m.a.createElement(n.b.Item,{key:e.id},r):m.a.createElement("div",null)}},_),y)}));I.defaultProps={dataSource:[],loading:!1,showLoadingMore:!1,justify:"flex"},I.propTypes=N(N({},n.b.ListProps),{},{className:v.a.string,emptyView:v.a.node,onLoadMore:v.a.func,dataSource:v.a.array,renderItem:v.a.func,loading:v.a.oneOfType([v.a.bool,v.a.object]),showLoadingMore:v.a.bool,pagination:v.a.object,children:v.a.node,justify:v.a.oneOf(["block","flex"]),customItem:v.a.bool,loadOnScroll:v.a.bool,listContainer:v.a.node}),E()(I,n.b);t.a=I},956:function(e,t,r){"use strict";var n=r(1616),o={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var r,a,i,c,l,u,s=!1;t||(t={}),r=t.debug||!1;try{if(i=n(),c=document.createRange(),l=document.getSelection(),(u=document.createElement("span")).textContent=e,u.ariaHidden="true",u.style.all="unset",u.style.position="fixed",u.style.top=0,u.style.clip="rect(0, 0, 0, 0)",u.style.whiteSpace="pre",u.style.webkitUserSelect="text",u.style.MozUserSelect="text",u.style.msUserSelect="text",u.style.userSelect="text",u.addEventListener("copy",(function(n){if(n.stopPropagation(),t.format)if(n.preventDefault(),void 0===n.clipboardData){r&&console.warn("unable to use e.clipboardData"),r&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var a=o[t.format]||o.default;window.clipboardData.setData(a,e)}else n.clipboardData.clearData(),n.clipboardData.setData(t.format,e);t.onCopy&&(n.preventDefault(),t.onCopy(n.clipboardData))})),document.body.appendChild(u),c.selectNodeContents(u),l.addRange(c),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");s=!0}catch(n){r&&console.error("unable to copy using execCommand: ",n),r&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),s=!0}catch(n){r&&console.error("unable to copy using clipboardData: ",n),r&&console.error("falling back to prompt"),a=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(a,e)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(c):l.removeAllRanges()),u&&document.body.removeChild(u),i()}return s}}}]);