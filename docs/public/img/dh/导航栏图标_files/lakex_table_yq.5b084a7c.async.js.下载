/*! For license information please see lakex_table_yq.5b084a7c.async.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{4134:function(e,t,r){},4135:function(e,t,r){"use strict";r.r(t),function(e,n){r.d(t,"ActiveTableServiceToken",(function(){return Lj})),r.d(t,"CommandService",(function(){return Pb})),r.d(t,"CommentContribution",(function(){return Zxe})),r.d(t,"ContentEditorContribution",(function(){return Nxe})),r.d(t,"ContentViewerContribution",(function(){return Mxe})),r.d(t,"FULL_SCREEN_STATUS",(function(){return Lxe})),r.d(t,"FullScreenService",(function(){return Uxe})),r.d(t,"FullWidthService",(function(){return Yxe})),r.d(t,"IActiveTableService",(function(){return $j})),r.d(t,"IEditor",(function(){return GQ})),r.d(t,"ILogData",(function(){return Xxe})),r.d(t,"IRenderContextService",(function(){return jj})),r.d(t,"ModalServiceToken",(function(){return tQ})),r.d(t,"ReadService",(function(){return Dy})),r.d(t,"RenderContextService",(function(){return Uj})),r.d(t,"SelectionService",(function(){return e3})),r.d(t,"createDocCardEditor",(function(){return zLe})),r.d(t,"createDocCardEditorH5",(function(){return JLe})),r.d(t,"createForm",(function(){return NLe})),r.d(t,"createStandardEditor",(function(){return qVe})),r.d(t,"createStandardEditorH5",(function(){return dLe})),r.d(t,"createStandardReader",(function(){return tLe}));r(4134);var i,o,a=r(0),s=r.n(a),l=r(57),c=r.n(l),u=r(14),d=r(100),f=r(424),p=r(200),h=r(67),m=r(40),v=r(10),g=r(138),y=r(203),b=r(9),w=r(319),_=r(23),C=r(31),E=r(631),x=r(34),S=r(651),k=r(95),O=r(711),I=r(296),R=r(659),T=r(262),A=r(2976),N=r(910),M=r(1733),P=r(1731),j=r(1699),D=r(1730),F=r(1736),V=r(1210),L=r(1432),$=r(1624),B=r(1617),z=r(1737),U=r(1857),H=r(1618),W=r(1700),G=r(1414),K=r(1734),q=r(1738),Y=r(1430),X=r(1739),Z=r(1740),J=r(1741),Q=r(1742),ee=r(1743),te=r(1744),re=r(1745),ne=r(1746),ie=r(1747),oe=r(1748),ae=r(1749),se=r(1750),le=r(1751),ce=r(1752),ue=r(1753),de=r(1754),fe=r(1755),pe=r(1756),he=r(1757),me=r(1758),ve=r(1625),ge=r(1759),ye=r(1760),be=r(1411),we=r(1732),_e=r(1761),Ce=r(1762),Ee=r(1763),xe=r(1764),Se=r(1765),ke=r(1766),Oe=r(1767),Ie=r(1735),Re=r(1768),Te=r(1769),Ae=r(1770),Ne=r(1723),Me=r(1729),Pe=r(1771),je=r(1772),De=r(1773),Fe=r(1774),Ve=r(1435),Le=r(1775),$e=r(1776),Be=r(1777),ze=r(1778),Ue=r(1779),He=r(1780),We=r(1781),Ge=r(1782),Ke=r(1783),qe=r(1784),Ye=r(1785),Xe=r(1786),Ze=r(1787),Je=r(1788),Qe=r(1789),et=r(1790),tt=r(1791),rt=r(1792),nt=r(1793),it=r(1794),ot=r(1795),at=r(1796),st=r(1797),lt=r(1798),ct=r(1799),ut=r(1800),dt=r(1801),ft=r(1802),pt=r(1803),ht=r(1804),mt=r(1805),vt=r(1806),gt=r(1807),yt=r(1808),bt=r(1809),wt=r(1810),_t=r(1811),Ct=r(1812),Et=r(1813),xt=r(1814),St=r(1815),kt=r(1816),Ot=r(1817),It=r(1818),Rt=r(1819),Tt=r(1820),At=r(1407),Nt=r(1821),Mt=r(1822),Pt=r(1727),jt=r(1728),Dt=r(1697),Ft=r(1823),Vt=r(1824),Lt=r(1825),$t=r(1826),Bt=r(1212),zt=(r(635),r(78)),Ut=r.n(zt),Ht=r(454),Wt=r.n(Ht),Gt=r(3881),Kt=r(3184),qt=r.n(Kt),Yt=r(3702),Xt=r.n(Yt),Zt=r(222),Jt=r.n(Zt),Qt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof e<"u"?e:typeof self<"u"?self:{},er={exports:{}},tr=er.exports={};function rr(){throw new Error("setTimeout has not been defined")}function nr(){throw new Error("clearTimeout has not been defined")}function ir(e){if(i===setTimeout)return setTimeout(e,0);if((i===rr||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch{try{return i.call(null,e,0)}catch{return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:rr}catch{i=rr}try{o="function"==typeof clearTimeout?clearTimeout:nr}catch{o=nr}}();var or,ar=[],sr=!1,lr=-1;function cr(){!sr||!or||(sr=!1,or.length?ar=or.concat(ar):lr=-1,ar.length&&ur())}function ur(){if(!sr){var e=ir(cr);sr=!0;for(var t=ar.length;t;){for(or=ar,ar=[];++lr<t;)or&&or[lr].run();lr=-1,t=ar.length}or=null,sr=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===nr||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{return o(e)}catch{try{return o.call(null,e)}catch{return o.call(this,e)}}}(e)}}function dr(e,t){this.fun=e,this.array=t}function fr(){}tr.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];ar.push(new dr(e,t)),1===ar.length&&!sr&&ir(ur)},dr.prototype.run=function(){this.fun.apply(null,this.array)},tr.title="browser",tr.browser=!0,tr.env={},tr.argv=[],tr.version="",tr.versions={},tr.on=fr,tr.addListener=fr,tr.once=fr,tr.off=fr,tr.removeListener=fr,tr.removeAllListeners=fr,tr.emit=fr,tr.prependListener=fr,tr.prependOnceListener=fr,tr.listeners=function(e){return[]},tr.binding=function(e){throw new Error("process.binding is not supported")},tr.cwd=function(){return"/"},tr.chdir=function(e){throw new Error("process.chdir is not supported")},tr.umask=function(){return 0};const pr=typeof e<"u"?e:typeof self<"u"?self:typeof window<"u"?window:{};var hr="named",mr="name",vr="unmanaged",gr="optional",yr="inject",br="multi_inject",wr="inversify:tagged",_r="inversify:tagged_props",Cr="inversify:paramtypes",Er="design:paramtypes",xr="post_construct",Sr="pre_destroy";var kr=[yr,br,mr,vr,hr,gr],Or={Request:"Request",Singleton:"Singleton",Transient:"Transient"},Ir={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},Rr={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},Tr=0;function Ar(){return Tr++}var Nr=function(){function e(e,t){this.id=Ar(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=Ir.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===Or.Singleton&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.onDeactivation=this.onDeactivation,t.cache=this.cache,t},e}(),Mr="Cannot apply @injectable decorator multiple times.",Pr="Metadata key was used more than once in a parameter:",jr="NULL argument",Dr="Key Not Found",Fr="Ambiguous match found for serviceIdentifier:",Vr="No matching bindings found for serviceIdentifier:",Lr="Missing required @injectable annotation in:",$r="Missing required @inject or @multiInject annotation in:",Br="Circular dependency found:",zr="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",Ur=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},Hr=function(e,t){return"@postConstruct error in class "+e+": "+t},Wr=function(e,t){return"@preDestroy error in class "+e+": "+t},Gr=function(e,t){return"onDeactivation() error in class "+e+": "+t},Kr="Maximum call stack size exceeded",qr=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(Cr,e),userGeneratedMetadata:Reflect.getMetadata(wr,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(_r,e)||[]},e}(),Yr={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function Xr(e){return e instanceof RangeError||e.message===Kr}function Zr(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function Jr(e,t,r){var n="",i=r(e,t);return 0!==i.length&&(n="\nRegistered bindings:",i.forEach((function(e){var t="Object";null!==e.implementationType&&(t=tn(e.implementationType)),n=n+"\n "+t,e.constraint.metaData&&(n=n+" - "+e.constraint.metaData)}))),n}function Qr(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||Qr(e.parentRequest,t))}function en(e){e.childRequests.forEach((function(e){if(Qr(e,e.serviceIdentifier)){var t=function(e){var t=function e(t,r){void 0===r&&(r=[]);var n=Zr(t.serviceIdentifier);return r.push(n),null!==t.parentRequest?e(t.parentRequest,r):r}(e);return t.reverse().join(" --\x3e ")}(e);throw new Error(Br+" "+t)}en(e)}))}function tn(e){if(e.name)return e.name;var t=e.toString(),r=t.match(/^function\s*([^\s(]+)/);return r?r[1]:"Anonymous function: "+t}var rn=function(){function e(e){this.id=Ar(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}(),nn=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===hr?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},e}(),on=function(e,t){this.parentContext=e,this.rootRequest=t},an=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}(),sn=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,r=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},r)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}(),ln=function(){function e(e,t,r,n){this.id=Ar(),this.type=e,this.serviceIdentifier=r;var i="symbol"==typeof t?function(e){return e.toString().slice(7,-1)}(t):t;this.name=new sn(i||""),this.identifier=t,this.metadata=new Array;var o=null;"string"==typeof n?o=new nn(hr,n):n instanceof nn&&(o=n),null!==o&&this.metadata.push(o)}return e.prototype.hasTag=function(e){for(var t=0,r=this.metadata;t<r.length;t++){if(r[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(br)},e.prototype.matchesArray=function(e){return this.matchesTag(br)(e)},e.prototype.isNamed=function(){return this.hasTag(hr)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return kr.every((function(t){return e.key!==t}))}))},e.prototype.isOptional=function(){return this.matchesTag(gr)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===hr}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return kr.every((function(t){return e.key!==t}))})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(hr)(e)},e.prototype.matchesTag=function(e){var t=this;return function(r){for(var n=0,i=t.metadata;n<i.length;n++){var o=i[n];if(o.key===e&&o.value===r)return!0}return!1}},e}(),cn=globalThis&&globalThis.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)(n||!(i in t))&&(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};function un(e,t,r,n){var i=e.getConstructorMetadata(r),o=i.compilerGeneratedMetadata;if(void 0===o)throw new Error(Lr+" "+t+".");var a=i.userGeneratedMetadata,s=Object.keys(a),l=0===r.length&&s.length>0,c=s.length>r.length,u=function(e,t,r,n,i){for(var o=[],a=0;a<i;a++){var s=dn(a,e,t,r,n);null!==s&&o.push(s)}return o}(n,t,o,a,l||c?s.length:r.length),d=pn(e,r,t);return cn(cn([],u,!0),d,!0)}function dn(e,t,r,n,i){var o=i[e.toString()]||[],a=mn(o),s=!0!==a.unmanaged,l=n[e];if((l=a.inject||a.multiInject||l)instanceof an&&(l=l.unwrap()),s){if(!t&&(l===Object||l===Function||void 0===l))throw new Error($r+" argument "+e+" in class "+r+".");var c=new ln(Rr.ConstructorArgument,a.targetName,l);return c.metadata=o,c}return null}function fn(e,t,r,n){var i=e||t;if(void 0===i){var o=Lr+" for property "+String(r)+" in class "+n+".";throw new Error(o)}return i}function pn(e,t,r){for(var n=e.getPropertiesMetadata(t),i=[],o=Object.getOwnPropertySymbols(n),a=0,s=Object.keys(n).concat(o);a<s.length;a++){var l=s[a],c=n[l],u=mn(c),d=u.targetName||l,f=fn(u.inject,u.multiInject,l,r),p=new ln(Rr.ClassProperty,d,f);p.metadata=c,i.push(p)}var h=Object.getPrototypeOf(t.prototype).constructor;if(h!==Object){var m=pn(e,h,r);i=cn(cn([],i,!0),m,!0)}return i}function hn(e,t){var r=Object.getPrototypeOf(t.prototype).constructor;if(r!==Object){var n=un(e,tn(r),r,!0),i=n.map((function(e){return e.metadata.filter((function(e){return e.key===vr}))})),o=[].concat.apply([],i).length,a=n.length-o;return a>0?a:hn(e,r)}return 0}function mn(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[yr],multiInject:t[br],targetName:t[mr],unmanaged:t[vr]}}var vn=function(){function e(e,t,r,n,i){this.id=Ar(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=r,this.target=i,this.childRequests=[],this.bindings=Array.isArray(n)?n:[n],this.requestScope=null===r?new Map:null}return e.prototype.addChildRequest=function(t,r,n){var i=new e(t,this.parentContext,this,r,n);return this.childRequests.push(i),i},e}();function gn(e){return e._bindingDictionary}function yn(e,t,r,n,i){var o=wn(r.container,i.serviceIdentifier),a=[];return o.length===Yr.NoBindingsAvailable&&r.container.options.autoBindInjectable&&"function"==typeof i.serviceIdentifier&&e.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(r.container.bind(i.serviceIdentifier).toSelf(),o=wn(r.container,i.serviceIdentifier)),a=t?o:o.filter((function(e){var t=new vn(e.serviceIdentifier,r,n,e,i);return e.constraint(t)})),function(e,t,r,n){switch(t.length){case Yr.NoBindingsAvailable:if(r.isOptional())return t;var i=Zr(e),o=Vr;throw o+=function(e,t){if(t.isTagged()||t.isNamed()){var r="",n=t.getNamedTag(),i=t.getCustomTags();return null!==n&&(r+=n.toString()+"\n"),null!==i&&i.forEach((function(e){r+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+r}return" "+e}(i,r),o+=Jr(n,i,wn),new Error(o);case Yr.OnlyOneBindingAvailable:return t;case Yr.MultipleBindingsAvailable:default:if(r.isArray())return t;i=Zr(e),o=Fr+" "+i;throw o+=Jr(n,i,wn),new Error(o)}}(i.serviceIdentifier,a,i,r.container),a}function bn(e,t,r,n,i,o){var a,s;if(null===i){a=yn(e,t,n,null,o),s=new vn(r,n,null,a,o);var l=new on(n,s);n.addPlan(l)}else a=yn(e,t,n,i,o),s=i.addChildRequest(o.serviceIdentifier,a,o);a.forEach((function(t){var r=null;if(o.isArray())r=s.addChildRequest(t.serviceIdentifier,t,o);else{if(t.cache)return;r=s}if(t.type===Ir.Instance&&null!==t.implementationType){var i=function(e,t){return un(e,tn(t),t,!1)}(e,t.implementationType);if(!n.container.options.skipBaseClassChecks){var a=hn(e,t.implementationType);if(i.length<a){var l=Ur(tn(t.implementationType));throw new Error(l)}}i.forEach((function(t){bn(e,!1,t.serviceIdentifier,n,r,t)}))}}))}function wn(e,t){var r=[],n=gn(e);return n.hasKey(t)?r=n.get(t):null!==e.parent&&(r=wn(e.parent,t)),r}function _n(e,t,r,n,i,o,a,s){void 0===s&&(s=!1);var l=new rn(t),c=function(e,t,r,n,i,o){var a=new nn(e?br:yr,r),s=new ln(t,n,r,a);if(void 0!==i){var l=new nn(i,o);s.metadata.push(l)}return s}(r,n,i,"",o,a);try{return bn(e,s,i,l,null,c),l}catch(e){throw Xr(e)&&en(l.plan.rootRequest),e}}function Cn(e){return("object"==typeof e&&null!==e||"function"==typeof e)&&"function"==typeof e.then}function En(e){return!!Cn(e)||Array.isArray(e)&&e.some(Cn)}var xn,Sn,kn=globalThis&&globalThis.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(a,s)}l((n=n.apply(e,t||[])).next())}))},On=globalThis&&globalThis.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},In=function(e,t,r){e.has(t.id)||e.set(t.id,r)},Rn=function(e,t){e.cache=t,e.activated=!0,Cn(t)&&Tn(e,t)},Tn=function(e,t){return kn(void 0,void 0,void 0,(function(){var r,n;return On(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t];case 1:return r=i.sent(),e.cache=r,[3,3];case 2:throw n=i.sent(),e.cache=null,e.activated=!1,n;case 3:return[2]}}))}))};(Sn=xn||(xn={})).DynamicValue="toDynamicValue",Sn.Factory="toFactory",Sn.Provider="toProvider";var An=globalThis&&globalThis.__assign||function(){return An=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},An.apply(this,arguments)},Nn=globalThis&&globalThis.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(a,s)}l((n=n.apply(e,t||[])).next())}))},Mn=globalThis&&globalThis.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Pn=globalThis&&globalThis.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)(n||!(i in t))&&(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};function jn(e,t,r){var n;if(t.length>0){var i=function(e,t){return e.reduce((function(e,r){var n=t(r);return r.target.type===Rr.ConstructorArgument?e.constructorInjections.push(n):(e.propertyRequests.push(r),e.propertyInjections.push(n)),e.isAsync||(e.isAsync=En(n)),e}),{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}(t,r),o=An(An({},i),{constr:e});n=i.isAsync?function(e){return Nn(this,void 0,void 0,(function(){var t,r;return Mn(this,(function(n){switch(n.label){case 0:return[4,Fn(e.constructorInjections)];case 1:return t=n.sent(),[4,Fn(e.propertyInjections)];case 2:return r=n.sent(),[2,Dn(An(An({},e),{constructorInjections:t,propertyInjections:r}))]}}))}))}(o):Dn(o)}else n=new e;return n}function Dn(e){var t,r=new((t=e.constr).bind.apply(t,Pn([void 0],e.constructorInjections,!1)));return e.propertyRequests.forEach((function(t,n){var i=t.target.identifier,o=e.propertyInjections[n];r[i]=o})),r}function Fn(e){return Nn(this,void 0,void 0,(function(){var t,r,n,i;return Mn(this,(function(o){for(t=[],r=0,n=e;r<n.length;r++)i=n[r],Array.isArray(i)?t.push(Promise.all(i)):t.push(i);return[2,Promise.all(t)]}))}))}function Vn(e,t){var r=function(e,t){var r,n;if(Reflect.hasMetadata(xr,e)){var i=Reflect.getMetadata(xr,e);try{return null===(n=(r=t)[i.value])||void 0===n?void 0:n.call(r)}catch(t){throw new Error(Hr(e.name,t.message))}}}(e,t);return Cn(r)?r.then((function(){return t})):t}function Ln(e,t){e.scope!==Or.Singleton&&function(e,t){var r="Class cannot be instantiated in "+(e.scope===Or.Request?"request":"transient")+" scope.";if("function"==typeof e.onDeactivation)throw new Error(Gr(t.name,r));if(Reflect.hasMetadata(Sr,t))throw new Error(Wr(t.name,r))}(e,t)}var $n=globalThis&&globalThis.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(a,s)}l((n=n.apply(e,t||[])).next())}))},Bn=globalThis&&globalThis.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},zn=function(e){return function(t){t.parentContext.setCurrentRequest(t);var r=t.bindings,n=t.childRequests,i=t.target&&t.target.isArray(),o=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(i&&o)return n.map((function(t){return zn(e)(t)}));if(!t.target.isOptional()||0!==r.length){var a=r[0];return Gn(e,t,a)}}},Un=function(e,t){var r=function(e){switch(e.type){case Ir.Factory:return{factory:e.factory,factoryType:xn.Factory};case Ir.Provider:return{factory:e.provider,factoryType:xn.Provider};case Ir.DynamicValue:return{factory:e.dynamicValue,factoryType:xn.DynamicValue};default:throw new Error("Unexpected factory type "+e.type)}}(e);return function(e,t){try{return e()}catch(e){throw Xr(e)&&(e=t()),e}}((function(){return r.factory.bind(e)(t)}),(function(){return new Error(function(e,t){return"It looks like there is a circular dependency in one of the '"+e+"' bindings. Please investigate bindings withservice identifier '"+t+"'."}(r.factoryType,t.currentRequest.serviceIdentifier.toString()))}))},Hn=function(e,t,r){var n,i=t.childRequests;switch(function(e){var t=null;switch(e.type){case Ir.ConstantValue:case Ir.Function:t=e.cache;break;case Ir.Constructor:case Ir.Instance:t=e.implementationType;break;case Ir.DynamicValue:t=e.dynamicValue;break;case Ir.Provider:t=e.provider;break;case Ir.Factory:t=e.factory}if(null===t){var r=Zr(e.serviceIdentifier);throw new Error("Invalid binding type: "+r)}}(r),r.type){case Ir.ConstantValue:case Ir.Function:n=r.cache;break;case Ir.Constructor:n=r.implementationType;break;case Ir.Instance:n=function(e,t,r,n){Ln(e,t);var i=jn(t,r,n);return Cn(i)?i.then((function(e){return Vn(t,e)})):Vn(t,i)}(r,r.implementationType,i,zn(e));break;default:n=Un(r,t.parentContext)}return n},Wn=function(e,t,r){var n=function(e,t){return t.scope===Or.Singleton&&t.activated?t.cache:t.scope===Or.Request&&e.has(t.id)?e.get(t.id):null}(e,t);return null!==n||function(e,t,r){t.scope===Or.Singleton&&Rn(t,r),t.scope===Or.Request&&In(e,t,r)}(e,t,n=r()),n},Gn=function(e,t,r){return Wn(e,r,(function(){var n=Hn(e,t,r);return n=Cn(n)?n.then((function(e){return Kn(t,r,e)})):Kn(t,r,n)}))};function Kn(e,t,r){var n,i=qn(e.parentContext,t,r),o=Jn(e.parentContext.container),a=o.next();do{n=a.value;var s=e.parentContext,l=e.serviceIdentifier,c=Zn(n,l);i=Cn(i)?Xn(c,s,i):Yn(c,s,i),a=o.next()}while(!0!==a.done&&!gn(n).hasKey(e.serviceIdentifier));return i}var qn=function(e,t,r){return"function"==typeof t.onActivation?t.onActivation(e,r):r},Yn=function(e,t,r){for(var n=e.next();!n.done;){if(Cn(r=n.value(t,r)))return Xn(e,t,r);n=e.next()}return r},Xn=function(e,t,r){return $n(void 0,void 0,void 0,(function(){var n,i;return Bn(this,(function(o){switch(o.label){case 0:return[4,r];case 1:n=o.sent(),i=e.next(),o.label=2;case 2:return i.done?[3,4]:[4,i.value(t,n)];case 3:return n=o.sent(),i=e.next(),[3,2];case 4:return[2,n]}}))}))},Zn=function(e,t){var r=e._activations;return r.hasKey(t)?r.get(t).values():[].values()},Jn=function(e){for(var t=[e],r=e.parent;null!==r;)t.push(r),r=r.parent;return{next:function(){var e=t.pop();return void 0!==e?{done:!1,value:e}:{done:!0,value:void 0}}}};var Qn=function(e,t){var r=e.parentRequest;return null!==r&&(!!t(r)||Qn(r,t))},ei=function(e){return function(t){var r=function(r){return null!==r&&null!==r.target&&r.target.matchesTag(e)(t)};return r.metaData=new nn(e,t),r}},ti=ei(hr),ri=function(e){return function(t){var r=null;if(null!==t){if(r=t.bindings[0],"string"==typeof e)return r.serviceIdentifier===e;var n=t.bindings[0].implementationType;return e===n}return!1}},ni=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new ii(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=ti(e),new ii(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e&&(null!==e.target&&!e.target.isNamed()&&!e.target.isTagged())},new ii(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=ei(e)(t),new ii(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return null!==t&&ri(e)(t.parentRequest)},new ii(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return null!==t&&ti(e)(t.parentRequest)},new ii(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(r){return null!==r&&ei(e)(t)(r.parentRequest)},new ii(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&Qn(t,ri(e))},new ii(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&!Qn(t,ri(e))},new ii(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&Qn(t,ti(e))},new ii(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&!Qn(t,ti(e))},new ii(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(r){return null!==r&&Qn(r,ei(e)(t))},new ii(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(r){return null!==r&&!Qn(r,ei(e)(t))},new ii(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&Qn(t,e)},new ii(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&!Qn(t,e)},new ii(this._binding)},e}(),ii=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new ni(this._binding)},e.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new ni(this._binding)},e}(),oi=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new ni(this._binding),this._bindingOnSyntax=new ii(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),ai=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=Or.Request,new oi(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=Or.Singleton,new oi(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=Or.Transient,new oi(this._binding)},e}(),si=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new ni(this._binding),this._bindingOnSyntax=new ii(this._binding),this._bindingInSyntax=new ai(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),li=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=Ir.Instance,this._binding.implementationType=e,new si(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error("The toSelf function can only be applied when a constructor is used as service identifier");var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=Ir.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=Or.Singleton,new oi(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=Ir.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new si(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=Ir.Constructor,this._binding.implementationType=e,this._binding.scope=Or.Singleton,new oi(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=Ir.Factory,this._binding.factory=e,this._binding.scope=Or.Singleton,new oi(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error("Value provided to function binding must be a function!");var t=this.toConstantValue(e);return this._binding.type=Ir.Function,this._binding.scope=Or.Singleton,t},e.prototype.toAutoFactory=function(e){return this._binding.type=Ir.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},this._binding.scope=Or.Singleton,new oi(this._binding)},e.prototype.toAutoNamedFactory=function(e){return this._binding.type=Ir.Factory,this._binding.factory=function(t){return function(r){return t.container.getNamed(e,r)}},new oi(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=Ir.Provider,this._binding.provider=e,this._binding.scope=Or.Singleton,new oi(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}(),ci=function(){function e(){}return e.of=function(t,r,n,i,o){var a=new e;return a.bindings=t,a.middleware=r,a.deactivations=i,a.activations=n,a.moduleActivationStore=o,a},e}();var ui=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(jr);if(null==t)throw new Error(jr);var r=this._map.get(e);void 0!==r?r.push(t):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(jr);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(Dr)},e.prototype.remove=function(e){if(null==e)throw new Error(jr);if(!this._map.delete(e))throw new Error(Dr)},e.prototype.removeIntersection=function(e){var t=this;this.traverse((function(r,n){var i=e.hasKey(r)?e.get(r):void 0;if(void 0!==i){var o=n.filter((function(e){return!i.some((function(t){return e===t}))}));t._setValue(r,o)}}))},e.prototype.removeByCondition=function(e){var t=this,r=[];return this._map.forEach((function(n,i){for(var o=[],a=0,s=n;a<s.length;a++){var l=s[a];e(l)?r.push(l):o.push(l)}t._setValue(i,o)})),r},e.prototype.hasKey=function(e){if(null==e)throw new Error(jr);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,r){e.forEach((function(e){return t.add(r,function(e){return"object"==typeof e&&null!==e&&"clone"in e&&"function"==typeof e.clone}(e)?e.clone():e)}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,r){e(r,t)}))},e.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},e}(),di=function(){function e(){this._map=new Map}return e.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},e.prototype.addDeactivation=function(e,t,r){this._getModuleActivationHandlers(e).onDeactivations.add(t,r)},e.prototype.addActivation=function(e,t,r){this._getModuleActivationHandlers(e).onActivations.add(t,r)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,r){t._map.set(r,{onActivations:e.onActivations.clone(),onDeactivations:e.onDeactivations.clone()})})),t},e.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return void 0===t&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},e.prototype._getEmptyHandlersStore=function(){return{onActivations:new ui,onDeactivations:new ui}},e}(),fi=globalThis&&globalThis.__assign||function(){return fi=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},fi.apply(this,arguments)},pi=globalThis&&globalThis.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(a,s)}l((n=n.apply(e,t||[])).next())}))},hi=globalThis&&globalThis.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},mi=globalThis&&globalThis.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)(n||!(i in t))&&(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},vi=function(){function e(e){var t=e||{};if("object"!=typeof t)throw new Error("Invalid Container constructor argument. Container options must be an object.");if(void 0===t.defaultScope)t.defaultScope=Or.Transient;else if(t.defaultScope!==Or.Singleton&&t.defaultScope!==Or.Transient&&t.defaultScope!==Or.Request)throw new Error("Invalid Container option. Default scope must be a string ('singleton' or 'transient').");if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error("Invalid Container option. Auto bind injectable must be a boolean");if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error("Invalid Container option. Skip base check must be a boolean");this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=Ar(),this._bindingDictionary=new ui,this._snapshots=[],this._middleware=null,this._activations=new ui,this._deactivations=new ui,this.parent=null,this._metadataReader=new qr,this._moduleActivationStore=new di}return e.merge=function(t,r){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=new e,a=mi([t,r],n,!0).map((function(e){return gn(e)})),s=gn(o);return a.forEach((function(e){!function(e,t){e.traverse((function(e,r){r.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))}(e,s)})),o},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=this._getContainerModuleHelpersFactory(),n=0,i=e;n<i.length;n++){var o=i[n],a=r(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return pi(this,void 0,void 0,(function(){var t,r,n,i,o;return hi(this,(function(a){switch(a.label){case 0:t=this._getContainerModuleHelpersFactory(),r=0,n=e,a.label=1;case 1:return r<n.length?(i=n[r],o=t(i.id),[4,i.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction,o.unbindAsyncFunction,o.onActivationFunction,o.onDeactivationFunction)]):[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.forEach((function(t){var r=e._removeModuleBindings(t.id);e._deactivateSingletons(r),e._removeModuleHandlers(t.id)}))},e.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return pi(this,void 0,void 0,(function(){var t,r,n,i;return hi(this,(function(o){switch(o.label){case 0:t=0,r=e,o.label=1;case 1:return t<r.length?(n=r[t],i=this._removeModuleBindings(n.id),[4,this._deactivateSingletonsAsync(i)]):[3,4];case 2:o.sent(),this._removeModuleHandlers(n.id),o.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e.prototype.bind=function(e){var t=this.options.defaultScope||Or.Transient,r=new Nr(e,t);return this._bindingDictionary.add(e,r),new li(r)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.rebindAsync=function(e){return pi(this,void 0,void 0,(function(){return hi(this,(function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}}))}))},e.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},e.prototype.unbindAsync=function(e){return pi(this,void 0,void 0,(function(){var t;return hi(this,(function(r){switch(r.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:r.sent(),r.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}}))}))},e.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse((function(t,r){e._deactivateSingletons(r)})),this._bindingDictionary=new ui},e.prototype.unbindAllAsync=function(){return pi(this,void 0,void 0,(function(){var e,t=this;return hi(this,(function(r){switch(r.label){case 0:return e=[],this._bindingDictionary.traverse((function(r,n){e.push(t._deactivateSingletonsAsync(n))})),[4,Promise.all(e)];case 1:return r.sent(),this._bindingDictionary=new ui,[2]}}))}))},e.prototype.onActivation=function(e,t){this._activations.add(e,t)},e.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,hr,t)},e.prototype.isBoundTagged=function(e,t,r){var n=!1;if(this._bindingDictionary.hasKey(e)){var i=this._bindingDictionary.get(e),o=function(e,t,r,n){var i=new ln(Rr.Variable,"",t,new nn(r,n)),o=new rn(e);return new vn(t,o,null,[],i)}(this,e,t,r);n=i.some((function(e){return e.constraint(o)}))}return!n&&this.parent&&(n=this.parent.isBoundTagged(e,t,r)),n},e.prototype.snapshot=function(){this._snapshots.push(ci.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error("No snapshot available to restore.");this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},e.prototype.createChild=function(t){var r=new e(t||this.options);return r.parent=this,r},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),r)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},e.prototype.getAsync=function(e){return pi(this,void 0,void 0,(function(){var t;return hi(this,(function(r){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]}))}))},e.prototype.getTagged=function(e,t,r){var n=this._getNotAllArgs(e,!1,t,r);return this._getButThrowIfAsync(n)},e.prototype.getTaggedAsync=function(e,t,r){return pi(this,void 0,void 0,(function(){var n;return hi(this,(function(i){return n=this._getNotAllArgs(e,!1,t,r),[2,this._get(n)]}))}))},e.prototype.getNamed=function(e,t){return this.getTagged(e,hr,t)},e.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,hr,t)},e.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},e.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},e.prototype.getAllTagged=function(e,t,r){var n=this._getNotAllArgs(e,!0,t,r);return this._getButThrowIfAsync(n)},e.prototype.getAllTaggedAsync=function(e,t,r){var n=this._getNotAllArgs(e,!0,t,r);return this._getAll(n)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,hr,t)},e.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,hr,t)},e.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var r=this.get(e);return t||this.unbind(e),r},e.prototype._preDestroy=function(e,t){if(Reflect.hasMetadata(Sr,e))return t[Reflect.getMetadata(Sr,e).value]()},e.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},e.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition((function(t){return t.moduleId===e}))},e.prototype._deactivate=function(e,t){var r=this,n=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var i=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if(Cn(i))return this._handleDeactivationError(i.then((function(){return r._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,n)})),n)}var o=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,n);if(Cn(o))return this._handleDeactivationError(o,n)}catch(e){throw new Error(Gr(n.name,e.message))}},e.prototype._handleDeactivationError=function(e,t){return pi(this,void 0,void 0,(function(){var r;return hi(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e];case 1:return n.sent(),[3,3];case 2:throw r=n.sent(),new Error(Gr(t.name,r.message));case 3:return[2]}}))}))},e.prototype._deactivateContainer=function(e,t){for(var r=this,n=t.next();n.value;){var i=n.value(e);if(Cn(i))return i.then((function(){return r._deactivateContainerAsync(e,t)}));n=t.next()}},e.prototype._deactivateContainerAsync=function(e,t){return pi(this,void 0,void 0,(function(){var r;return hi(this,(function(n){switch(n.label){case 0:r=t.next(),n.label=1;case 1:return r.value?[4,r.value(e)]:[3,3];case 2:return n.sent(),r=t.next(),[3,1];case 3:return[2]}}))}))},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},r=function(r){return function(n){var i=e.bind(n);return t(i,r),i}},n=function(r){return function(n){var i=e.rebind(n);return t(i,r),i}},i=function(t){return function(r,n){e._moduleActivationStore.addActivation(t,r,n),e.onActivation(r,n)}},o=function(t){return function(r,n){e._moduleActivationStore.addDeactivation(t,r,n),e.onDeactivation(r,n)}};return function(t){return{bindFunction:r(t),isboundFunction:function(t){return e.isBound(t)},onActivationFunction:i(t),onDeactivationFunction:o(t),rebindFunction:n(t),unbindFunction:function(t){return e.unbind(t)},unbindAsyncFunction:function(t){return e.unbindAsync(t)}}}},e.prototype._getAll=function(e){return Promise.all(this._get(e))},e.prototype._get=function(e){var t=fi(fi({},e),{contextInterceptor:function(e){return e},targetType:Rr.Variable});if(this._middleware){var r=this._middleware(t);if(null==r)throw new Error("Invalid return type in middleware. Middleware must return!");return r}return this._planAndResolve()(t)},e.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if(En(t))throw new Error(function(e){return"You are attempting to construct '"+e+"' in a synchronous way\n but it has asynchronous dependencies."}(e.serviceIdentifier));return t},e.prototype._getAllArgs=function(e){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e}},e.prototype._getNotAllArgs=function(e,t,r,n){return{avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:r,value:n}},e.prototype._planAndResolve=function(){var e=this;return function(t){var r=_n(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints),n=function(e){return zn(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}(r=t.contextInterceptor(r));return n}},e.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return Cn(e.cache)?e.cache.then((function(r){return t._deactivate(e,r)})):this._deactivate(e,e.cache)},e.prototype._deactivateSingletons=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];if(Cn(this._deactivateIfSingleton(n)))throw new Error("Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)")}},e.prototype._deactivateSingletonsAsync=function(e){return pi(this,void 0,void 0,(function(){var t=this;return hi(this,(function(r){switch(r.label){case 0:return[4,Promise.all(e.map((function(e){return t._deactivateIfSingleton(e)})))];case 1:return r.sent(),[2]}}))}))},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,r){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,r)},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,r){return pi(this,void 0,void 0,(function(){return hi(this,(function(n){switch(n.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,r)];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},e.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch{throw new Error("Could not unbind serviceIdentifier: "+Zr(e))}},e.prototype._bindingDeactivationAndPreDestroy=function(e,t,r){var n=this;if("function"==typeof e.onDeactivation){var i=e.onDeactivation(t);if(Cn(i))return i.then((function(){return n._preDestroy(r,t)}))}return this._preDestroy(r,t)},e.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,r){return pi(this,void 0,void 0,(function(){return hi(this,(function(n){switch(n.label){case 0:return"function"!=typeof e.onDeactivation?[3,2]:[4,e.onDeactivation(t)];case 1:n.sent(),n.label=2;case 2:return[4,this._preDestroy(r,t)];case 3:return n.sent(),[2]}}))}))},e}(),gi=function(e){this.id=Ar(),this.registry=e};function yi(e,t,r,n){(function(e){if(void 0!==e)throw new Error(zr)})(t),wi(wr,e,r.toString(),n)}function bi(e){var t=[];if(Array.isArray(e)){var r=function(e){for(var t=new Set,r=0,n=e;r<n.length;r++){var i=n[r];if(t.has(i))return i;t.add(i)}}((t=e).map((function(e){return e.key})));if(void 0!==r)throw new Error(Pr+" "+r.toString())}else t=[e];return t}function wi(e,t,r,n){var i=bi(n),o={};Reflect.hasOwnMetadata(e,t)&&(o=Reflect.getMetadata(e,t));var a=o[r];if(void 0===a)a=[];else for(var s=function(e){if(i.some((function(t){return t.key===e.key})))throw new Error(Pr+" "+e.key.toString())},l=0,c=a;l<c.length;l++){s(c[l])}a.push.apply(a,i),o[r]=a,Reflect.defineMetadata(e,o,t)}function _i(e){return function(t,r,n){"number"==typeof n?yi(t,r,n,e):function(e,t,r){if(function(e){return void 0!==e.prototype}(e))throw new Error(zr);wi(_r,e.constructor,t,r)}(t,r,e)}}var Ci=function(e){return function(t){return function(r,n,i){if(void 0===t){var o="function"==typeof r?r.name:r.constructor.name;throw new Error(function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."}(o))}return _i(new nn(e,t))(r,n,i)}}}(yr);function Ei(e,t){return function(){return function(r,n){var i=new nn(e,n);if(Reflect.hasOwnMetadata(e,r.constructor))throw new Error(t);Reflect.defineMetadata(e,i,r.constructor)}}}var xi=Ei(xr,"Cannot apply @postConstruct decorator multiple times in the same class"),Si=Ei(Sr,"Cannot apply @preDestroy decorator multiple times in the same class"),ki=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof pr<"u"?pr:typeof self<"u"?self:{};function Oi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ii,Ri,Ti={exports:{}},Ai=Ti.exports={};function Ni(){throw new Error("setTimeout has not been defined")}function Mi(){throw new Error("clearTimeout has not been defined")}function Pi(e){if(Ii===setTimeout)return setTimeout(e,0);if((Ii===Ni||!Ii)&&setTimeout)return Ii=setTimeout,setTimeout(e,0);try{return Ii(e,0)}catch{try{return Ii.call(null,e,0)}catch{return Ii.call(this,e,0)}}}!function(){try{Ii="function"==typeof setTimeout?setTimeout:Ni}catch{Ii=Ni}try{Ri="function"==typeof clearTimeout?clearTimeout:Mi}catch{Ri=Mi}}();var ji,Di,Fi,Vi,Li=[],$i=!1,Bi=-1;function zi(){!$i||!ji||($i=!1,ji.length?Li=ji.concat(Li):Bi=-1,Li.length&&Ui())}function Ui(){if(!$i){var e=Pi(zi);$i=!0;for(var t=Li.length;t;){for(ji=Li,Li=[];++Bi<t;)ji&&ji[Bi].run();Bi=-1,t=Li.length}ji=null,$i=!1,function(e){if(Ri===clearTimeout)return clearTimeout(e);if((Ri===Mi||!Ri)&&clearTimeout)return Ri=clearTimeout,clearTimeout(e);try{return Ri(e)}catch{try{return Ri.call(null,e)}catch{return Ri.call(this,e)}}}(e)}}function Hi(e,t){this.fun=e,this.array=t}function Wi(){}function Gi(e,t){return t.lifecycle===Fi.Lifecycle.singleton?function(e){return e.inSingletonScope()}(e):function(e){return e.inTransientScope()}(e)}function Ki(e,t){e.whenTargetNamed(Xi(t))}function qi(e,t){return t.bind(Zi(e))}function Yi(e,t){if(t.isBound(Zi(e)))try{return t.rebind(Zi(e))}catch{return t.bind(Zi(e))}return t.bind(Zi(e))}function Xi(e){return Vi.isDefinedToken(e)?e.symbol:e}function Zi(e){return Vi.isDefinedToken(e)?e.symbol:e}Ai.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];Li.push(new Hi(e,t)),1===Li.length&&!$i&&Pi(Ui)},Hi.prototype.run=function(){this.fun.apply(null,this.array)},Ai.title="browser",Ai.browser=!0,Ai.env={},Ai.argv=[],Ai.version="",Ai.versions={},Ai.on=Wi,Ai.addListener=Wi,Ai.once=Wi,Ai.off=Wi,Ai.removeListener=Wi,Ai.removeAllListeners=Wi,Ai.emit=Wi,Ai.prependListener=Wi,Ai.prependOnceListener=Wi,Ai.listeners=function(e){return[]},Ai.binding=function(e){throw new Error("process.binding is not supported")},Ai.cwd=function(){return"/"},Ai.chdir=function(e){throw new Error("process.chdir is not supported")},Ai.umask=function(){return 0},function(e){!function(t){var r="object"==typeof ki?ki:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=i(e);function i(e,t){return function(r,n){"function"!=typeof e[r]&&Object.defineProperty(e,r,{configurable:!0,writable:!0,value:n}),t&&t(r,n)}}typeof r.Reflect>"u"?r.Reflect=e:n=i(r.Reflect,n),function(e){var t=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,n=r&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",i=r&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,a={__proto__:[]}instanceof Array,s=!o&&!a,l={create:o?function(){return ne(Object.create(null))}:a?function(){return ne({__proto__:null})}:function(){return ne({})},has:s?function(e,r){return t.call(e,r)}:function(e,t){return t in e},get:s?function(e,r){return t.call(e,r)?e[r]:void 0}:function(e,t){return e[t]}},c=Object.getPrototypeOf(Function),u="object"==typeof Ti.exports&&Ti.exports.env&&"true"===Ti.exports.env.REFLECT_METADATA_USE_MAP_POLYFILL,d=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,f=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,p=new(u||"function"!=typeof WeakMap?re():WeakMap);function h(e,t,r,n){if(j(r)){if(!H(e))throw new TypeError;if(!G(t))throw new TypeError;return x(e,t)}if(!H(e))throw new TypeError;if(!V(t))throw new TypeError;if(!V(n)&&!j(n)&&!D(n))throw new TypeError;return D(n)&&(n=void 0),S(e,t,r=U(r),n)}function m(e,t){function r(r,n){if(!V(r))throw new TypeError;if(!j(n)&&!K(n))throw new TypeError;A(e,t,r,n)}return r}function v(e,t,r,n){if(!V(r))throw new TypeError;return j(n)||(n=U(n)),A(e,t,r,n)}function g(e,t,r){if(!V(t))throw new TypeError;return j(r)||(r=U(r)),O(e,t,r)}function y(e,t,r){if(!V(t))throw new TypeError;return j(r)||(r=U(r)),I(e,t,r)}function b(e,t,r){if(!V(t))throw new TypeError;return j(r)||(r=U(r)),R(e,t,r)}function w(e,t,r){if(!V(t))throw new TypeError;return j(r)||(r=U(r)),T(e,t,r)}function _(e,t){if(!V(e))throw new TypeError;return j(t)||(t=U(t)),N(e,t)}function C(e,t){if(!V(e))throw new TypeError;return j(t)||(t=U(t)),M(e,t)}function E(e,t,r){if(!V(t))throw new TypeError;j(r)||(r=U(r));var n=k(t,r,!1);if(j(n)||!n.delete(e))return!1;if(n.size>0)return!0;var i=p.get(t);return i.delete(r),i.size>0||p.delete(t),!0}function x(e,t){for(var r=e.length-1;r>=0;--r){var n=(0,e[r])(t);if(!j(n)&&!D(n)){if(!G(n))throw new TypeError;t=n}}return t}function S(e,t,r,n){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,r,n);if(!j(o)&&!D(o)){if(!V(o))throw new TypeError;n=o}}return n}function k(e,t,r){var n=p.get(e);if(j(n)){if(!r)return;n=new d,p.set(e,n)}var i=n.get(t);if(j(i)){if(!r)return;i=new d,n.set(t,i)}return i}function O(e,t,r){if(I(e,t,r))return!0;var n=Q(t);return!D(n)&&O(e,n,r)}function I(e,t,r){var n=k(t,r,!1);return!j(n)&&B(n.has(e))}function R(e,t,r){if(I(e,t,r))return T(e,t,r);var n=Q(t);return D(n)?void 0:R(e,n,r)}function T(e,t,r){var n=k(t,r,!1);if(!j(n))return n.get(e)}function A(e,t,r,n){k(r,n,!0).set(e,t)}function N(e,t){var r=M(e,t),n=Q(e);if(null===n)return r;var i=N(n,t);if(i.length<=0)return r;if(r.length<=0)return i;for(var o=new f,a=[],s=0,l=r;s<l.length;s++){var c=l[s];o.has(c)||(o.add(c),a.push(c))}for(var u=0,d=i;u<d.length;u++){c=d[u];o.has(c)||(o.add(c),a.push(c))}return a}function M(e,t){var r=[],n=k(e,t,!1);if(j(n))return r;for(var i=Y(n.keys()),o=0;;){var a=Z(i);if(!a)return r.length=o,r;var s=X(a);try{r[o]=s}catch(e){try{J(i)}finally{throw e}}o++}}function P(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function j(e){return void 0===e}function D(e){return null===e}function F(e){return"symbol"==typeof e}function V(e){return"object"==typeof e?null!==e:"function"==typeof e}function L(e,t){switch(P(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",i=q(e,n);if(void 0!==i){var o=i.call(e,r);if(V(o))throw new TypeError;return o}return $(e,"default"===r?"number":r)}function $(e,t){if("string"===t){var r=e.toString;if(W(r))if(!V(i=r.call(e)))return i;if(W(n=e.valueOf))if(!V(i=n.call(e)))return i}else{var n;if(W(n=e.valueOf))if(!V(i=n.call(e)))return i;var i,o=e.toString;if(W(o))if(!V(i=o.call(e)))return i}throw new TypeError}function B(e){return!!e}function z(e){return""+e}function U(e){var t=L(e,3);return F(t)?t:z(t)}function H(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function W(e){return"function"==typeof e}function G(e){return"function"==typeof e}function K(e){switch(P(e)){case 3:case 4:return!0;default:return!1}}function q(e,t){var r=e[t];if(null!=r){if(!W(r))throw new TypeError;return r}}function Y(e){var t=q(e,i);if(!W(t))throw new TypeError;var r=t.call(e);if(!V(r))throw new TypeError;return r}function X(e){return e.value}function Z(e){var t=e.next();return!t.done&&t}function J(e){var t=e.return;t&&t.call(e)}function Q(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===c||t!==c)return t;var r=e.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return t;var i=n.constructor;return"function"!=typeof i||i===e?t:i}function ee(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var n=this._keys.length,i=r+1;i<n;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,n)},t.prototype.values=function(){return new r(this._keys,this._values,o)},t.prototype.entries=function(){return new r(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function n(e,t){return e}function o(e,t){return t}function a(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new d}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}()}function re(){var e=16,r=l.create(),n=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&l.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?l.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+c()}while(l.has(r,e));return r[e]=!0,e}function o(e,r){if(!t.call(e,n)){if(!r)return;Object.defineProperty(e,n,{value:l.create()})}return e[n]}function a(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function s(e){return"function"==typeof Uint8Array?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(e)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(e)):a(new Uint8Array(e),e):a(new Array(e),e)}function c(){var t=s(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",n=0;n<e;++n){var i=t[n];(4===n||6===n||8===n)&&(r+="-"),i<16&&(r+="0"),r+=i.toString(16).toLowerCase()}return r}}function ne(e){return e.__=void 0,delete e.__,e}e("decorate",h),e("metadata",m),e("defineMetadata",v),e("hasMetadata",g),e("hasOwnMetadata",y),e("getMetadata",b),e("getOwnMetadata",w),e("getMetadataKeys",_),e("getOwnMetadataKeys",C),e("deleteMetadata",E)}(n)}()}(Di||(Di={})),(e=>{e.defineToken=(t,r={multiple:!0,global:!1})=>new e.DefinedToken(t,r);var t;e.DefinedToken=class{constructor(e,t={}){this.prototype={};const{multiple:r=!1,global:n}=t;this.name=e,this.symbol=n?Symbol.for(this.name):Symbol(this.name),this.multiple=r}},e.isModule=function(e){return!!e&&"object"==typeof e&&"id"in e},(t=e.Lifecycle||(e.Lifecycle={})).singleton="singleton",t.transient="transient",e.ClassOptionSymbol=Symbol.for("SyringeClassOption"),e.DefaultOption={lifecycle:"transient"}})(Fi||(Fi={})),(e=>{e.toArray=function(e){return Array.isArray(e)?e:void 0===e?[]:[e]},e.isClass=function(e){return!(!e||"function"!=typeof e||!("prototype"in e))},e.isDefinedToken=function(e){return!!(e&&"object"==typeof e&&"symbol"in e&&"multiple"in e)},e.isInjectOption=function(e){return!(!e||"object"!=typeof e||!("token"in e))},e.isNamedToken=function(e){return!!(e&&"object"==typeof e&&"token"in e&&"named"in e)},e.isMultipleEnabled=function(t){return e.isDefinedToken(t)&&t.multiple}})(Vi||(Vi={}));const Ji=new vi;function Qi(e={}){const t=function(e){if(Reflect.hasOwnMetadata(Cr,e))throw new Error(Mr);var t=Reflect.getMetadata(Er,e)||[];return Reflect.defineMetadata(Cr,t,e),e};return r=>{Reflect.defineMetadata(Fi.ClassOptionSymbol,{...e,target:r},r),t(r)}}function eo(e={}){return(t,...r)=>(Qi({...e,lifecycle:Fi.Lifecycle.singleton})(t,...r),t)}function to(e){return Ci(e instanceof an?e:Zi(e))}function ro(e){return function(e){return _i(new nn(hr,e))}(Xi(e))}const no=Symbol.for("SyringeSideOption");const io=class{static resolveTarget(e,t,r={}){try{try{const r=Reflect.getMetadata(no,t);r&&io.resolveOption(e,r)}catch{}if(Vi.isClass(t))if(r.useClass){const e=Vi.toArray(r.useClass);e.unshift(t),r.useClass=e}else r.useClass=[t];let n;try{n=Reflect.getMetadata(Fi.ClassOptionSymbol,t)}catch{}if(n={...n||{},...r},n.token){const e=Vi.toArray(n.token);e.unshift(t),n.token=e}else n.token=[t];io.resolveOption(e,n)}catch{}}static resolveOption(e,t){const r=function(e){const t=Vi.toArray(e.token),r=Vi.toArray(e.useClass),n=Vi.toArray(e.useDynamic),i=Vi.toArray(e.useFactory),o=Vi.toArray(e.contrib),a=e.lifecycle||Fi.Lifecycle.transient,s={token:t,useClass:r,lifecycle:o.length>0?Fi.Lifecycle.singleton:a,contrib:o,useDynamic:n,useFactory:i};return"useValue"in e&&(s.useValue=e.useValue),s}({...io.globalConfig,...t});0===r.useClass.length&&0===r.useDynamic.length&&0===r.useFactory.length&&!("useValue"in r)||r.token.forEach((t=>{new io(e,t,{...r}).resolve()}))}constructor(e,t,r){this.register=e,this.token=t,this.option=r,this.rawToken=Vi.isNamedToken(t)?t.token:t,this.named=Vi.isNamedToken(t)?t.named:void 0,this.mutiple=!!this.named||Vi.isMultipleEnabled(this.rawToken),this.generalToken=this.rawToken}resolve(){const{register:e}=this;!function(e){return e&&"object"==typeof e&&"bind"in e&&"unbind"in e&&"rebind"in e&&"isBound"in e}(e)||(this.mutiple?this.resolveMutilple(e):(this.resolveMono(e),!this.named&&this.option.contrib.length>0&&this.option.contrib.forEach((t=>{Vi.isMultipleEnabled(t)?qi(t,e).toService(this.generalToken):Yi(t,e).toService(this.generalToken)}))))}resolveMono(e){if("useValue"in this.option)return Yi(this.generalToken,e).toConstantValue(this.option.useValue);if(this.option.useDynamic.length>0){const t=this.option.useDynamic[this.option.useDynamic.length-1];return Gi(Yi(this.generalToken,e).toDynamicValue((e=>{const r=_o.getContainer(e.container);return t({container:r})})),this.option)}if(this.option.useFactory.length>0){const t=this.option.useFactory[this.option.useFactory.length-1];return Yi(this.generalToken,e).toFactory((e=>{const r=_o.getContainer(e.container);return t({container:r})}))}if(this.option.useClass.length>0){const t=this.option.useClass[this.option.useClass.length-1];return Gi(Yi(this.generalToken,e).to(t),this.option)}}resolveMutilple(e){const t=this.option.useClass.map((t=>Gi(qi(this.generalToken,e).to(t),this.option))),r=this.option.useDynamic.map((t=>Gi(qi(this.generalToken,e).toDynamicValue((e=>{const r=_o.getContainer(e.container);return t({container:r})})),this.option))),n=this.option.useFactory.map((t=>qi(this.generalToken,e).toFactory((e=>{const r=_o.getContainer(e.container);return t({container:r})})))),i="useValue"in this.option?qi(this.generalToken,e).toConstantValue(this.option.useValue):void 0;this.named&&(t.forEach((e=>this.named&&Ki(e,this.named))),r.forEach((e=>this.named&&Ki(e,this.named))),n.forEach((e=>this.named&&Ki(e,this.named))),i&&Ki(i,this.named))}};let oo=io;oo.globalConfig=Fi.DefaultOption;const ao=Fi.defineToken("SyringeContributionProvider",{global:!0});var so,lo,co;(e=>{function t(e){return{dispose:e}}e.is=function(e){return!!e&&"object"==typeof e&&"dispose"in e&&"function"==typeof e.dispose},e.create=t,e.NONE=t((()=>{}))})(so||(so={})),(e=>{e.is=function(e){return!!e&&"object"==typeof e&&"disposed"in e&&"boolean"==typeof e.disposed}})(lo||(lo={})),(e=>{e.None=()=>so.NONE,e.map=function(e,t){return(r,n)=>e((e=>r.call(n,t(e))),void 0)}})(co||(co={}));class uo{constructor(e=!1){this.mono=!1,this.mono=e}get length(){return this._callbacks&&this._callbacks.length||0}add(e,t=void 0){this._callbacks||(this._callbacks=[]),this._callbacks.push([e,t])}remove(e,t=void 0){if(!this._callbacks)return;let r=!1;for(let n=0;n<this._callbacks.length;n+=1)if(this._callbacks[n][0]===e){if(this._callbacks[n][1]===t)return void this._callbacks.splice(n,1);r=!0}if(r)throw new Error("You should remove it with the same context you add it")}[Symbol.iterator](){return this._callbacks?this._callbacks.slice(0).map((e=>(...t)=>e[0].apply(e[1],t)))[Symbol.iterator]():[][Symbol.iterator]()}invoke(...e){const t=[];for(const r of this)try{t.push(r(...e))}catch(e){console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0}}const fo=class{constructor(e){this._disposed=!1,this._options=e}get event(){return this._event||(this._event=(e,t,r)=>{this._callbacks||(this._callbacks=new uo),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const n={dispose:()=>{n.dispose=fo._noop,this._disposed||(this._callbacks.remove(e,t),n.dispose=fo._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(n),n}),this._event}fire(e){this._callbacks&&this._callbacks.invoke(e)}async sequence(e){if(this._callbacks)for(const t of this._callbacks)if(!await e(t))break}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0),this._disposed=!0}};let po=fo;po._noop=()=>{};class ho{constructor(...e){this.disposables=[],this.onDisposeEmitter=new po,this.disposingElements=!1,e.forEach((e=>this.push(e)))}get onDispose(){return this.onDisposeEmitter.event}checkDisposed(){this.disposed&&!this.disposingElements&&(this.onDisposeEmitter.fire(void 0),this.onDisposeEmitter.dispose())}get disposed(){return 0===this.disposables.length}dispose(){if(!this.disposed&&!this.disposingElements){for(this.disposingElements=!0;!this.disposed;)try{this.disposables.pop().dispose()}catch(e){console.error(e)}this.disposingElements=!1,this.checkDisposed()}}push(e){const{disposables:t}=this;t.push(e);const r=e.dispose.bind(e),n=so.create((()=>{const r=t.indexOf(e);-1!==r&&t.splice(r,1),this.checkDisposed()}));return e.dispose=()=>{n.dispose(),r()},n}pushAll(e){return e.map((e=>this.push(e)))}}class mo{constructor(e,t,r){this.onChangedEmitter=new po,this.option={recursive:!1,cache:!0},this.toDispose=new ho,this.onCtxChanged=()=>{this.services=void 0,this.onChangedEmitter.fire()},this.container=t,this.serviceIdentifier=e,r&&(this.option={...this.option,...r}),this.toDispose.push(this.onChangedEmitter),this.toDispose.push(this.container.onModuleChanged(this.onCtxChanged)),this.toDispose.push(this.container.onRegistered(this.onCtxChanged))}get onChanged(){return this.onChangedEmitter.event}dispose(){this.toDispose.dispose(),this.disposed=!0}getServices(e){const t=[];let r=this.container;for(;r;){if(r.isBound(this.serviceIdentifier)){const e=r.getAll(this.serviceIdentifier);t.push(...e)}r=e?r.parent:void 0}return t}getContributions(e={}){const{cache:t,recursive:r=!0}={...this.option,...e};return(!t||void 0===this.services)&&(this.services=this.getServices(!!r)),this.services}}function vo(e,t,r){e({token:{token:ao,named:t},useDynamic:e=>new mo(t,e.container,r),lifecycle:Fi.Lifecycle.singleton})}class go{constructor(e){this.inversifyRegister=(e,t,r,n)=>{const i={bind:e,unbind:t,isBound:r,rebind:n},o=(e,t={})=>{Vi.isInjectOption(e)?oo.resolveOption(i,e):oo.resolveTarget(i,e,t)};this.baseRegistry&&this.baseRegistry(o),this.optionCollection&&this.optionCollection.forEach((e=>o(e)))},this.baseRegistry=e,this.inversifyModule=new gi(this.inversifyRegister),this.id=this.inversifyModule.id}get options(){return this.optionCollection||(this.optionCollection=[]),this.optionCollection}register(...e){return e.forEach((e=>this.options.push(e))),this}contribution(...e){return e.forEach((e=>this.options.push(function(e,t){return{token:{token:ao,named:e},useDynamic:r=>new mo(e,r.container,t),lifecycle:Fi.Lifecycle.singleton}}(e)))),this}}function yo(e){return e&&"inversifyModule"in e}function bo(e){return new go(e)}const wo=new Map;class _o{constructor(e){this.toDisposeOnParentChange=new ho,this.onModuleChangedEmitter=new po,this.onRegisteredEmitter=new po,this.loadedModules=[],this.inversify=!0,this.container=e||new vi,_o.setContainer(this.container,this)}get onModuleChanged(){return this.onModuleChangedEmitter.event}get onRegistered(){return this.onRegisteredEmitter.event}get parent(){return this._parent}set parent(e){this._parent=e,this.toDisposeOnParentChange&&(this.toDisposeOnParentChange.dispose(),this.toDisposeOnParentChange=new ho),e&&(this.toDisposeOnParentChange.push(e.onModuleChanged((()=>{this.onModuleChangedEmitter.fire()}))),this.toDisposeOnParentChange.push(e.onRegistered((()=>{this.onRegisteredEmitter.fire()}))))}static setContainer(e,t){return wo.set(e.id,t)}static getContainer(e){const t=wo.get(e.id);if(!t){const t=new _o(e);return _o.setContainer(e,t),t}return t}static config(e){oo.globalConfig=e}dispose(){this.toDisposeOnParentChange.dispose(),this.onModuleChangedEmitter.dispose(),this.onRegisteredEmitter.dispose(),this.disposed=!0}load(e,t){return t||!this.loadedModules.includes(e.id)?(yo(e)?(this.container.load(e.inversifyModule),this.onModuleChangedEmitter.fire()):console.warn("Unsupported module.",e),this.loadedModules.push(e.id),{dispose:()=>{this.unload(e)}}):{dispose:()=>{}}}unload(e){yo(e)&&(this.container.unload(e.inversifyModule),this.onModuleChangedEmitter.fire(),this.loadedModules=this.loadedModules.filter((t=>t!==e.id)))}remove(e){return this.container.unbind(Zi(e))}get(e){let t;const r=Zi(e);try{t=this.container.get(r)}catch(e){if(null!=e&&e.message.includes("No matching bindings found")&&this.parent)return this.parent.get(r);throw e}return t}getNamed(e,t){return this.container.getNamed(Zi(e),Xi(t))}getAll(e){return this.container.getAll(Zi(e))}getAllNamed(e,t){return this.container.getAllNamed(Zi(e),Xi(t))}isBound(e){return this.container.isBound(Zi(e))}isBoundNamed(e,t){return this.container.isBoundNamed(Zi(e),Xi(t))}createChild(){const e=this.container.createChild(),t=new _o(e);return t.parent=this,t}register(e,t={}){Vi.isInjectOption(e)?oo.resolveOption(this.container,e):oo.resolveTarget(this.container,e,t),this.onRegisteredEmitter.fire()}}const Co=new _o(Ji);Co.register.bind(Co);const Eo=e=>(t,r,n)=>{ro(e)(t,r,n),to(ao)(t,r,n)};var xo;(e=>{e.Provider=ao,e.register=vo})(xo||(xo={}));const So=e=>setTimeout((()=>{e()}),16.666666666666668),ko="abcdefghigklmnopqrstuvwxyz",Oo=ko+"0123456789"+ko.toUpperCase();function Io(e){if((e=e||6)<2)throw new RangeError("n 不能小于 2");let t="";for(let r=0;r<e;r++)t+=Oo.charAt(Math.floor(Math.random()*Oo.length));return t}const Ro={}.toString,To=(e,t)=>Ro.call(e)==="[object "+t+"]";function Ao(e){return"function"==typeof e}const No=function(e){return To(e,"RegExp")},Mo=function(e){return To(e,"String")},Po=function(e){return To(e,"Object")},jo=function(e){return null==e};var Do,Fo,Vo={exports:{}};function Lo(){if(Fo)return Do;Fo=1;var e=1e3,t=60*e,r=60*t,n=24*r,i=7*n,o=365.25*n;function a(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}return Do=function(s,l){l=l||{};var c=typeof s;if("string"===c&&s.length>0)return function(a){if(a=String(a),!(a.length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(a);if(s){var l=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return l*o;case"weeks":case"week":case"w":return l*i;case"days":case"day":case"d":return l*n;case"hours":case"hour":case"hrs":case"hr":case"h":return l*r;case"minutes":case"minute":case"mins":case"min":case"m":return l*t;case"seconds":case"second":case"secs":case"sec":case"s":return l*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return}}}}(s);if("number"===c&&isFinite(s))return l.long?function(i){var o=Math.abs(i);return o>=n?a(i,o,n,"day"):o>=r?a(i,o,r,"hour"):o>=t?a(i,o,t,"minute"):o>=e?a(i,o,e,"second"):i+" ms"}(s):function(i){var o=Math.abs(i);return o>=n?Math.round(i/n)+"d":o>=r?Math.round(i/r)+"h":o>=t?Math.round(i/t)+"m":o>=e?Math.round(i/e)+"s":i+"ms"}(s);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(s))}}var $o=function(e){function t(e){let n,i,o,a=null;function s(...e){if(!s.enabled)return;const r=s,i=Number(new Date),o=i-(n||i);r.diff=o,r.prev=n,r.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,i)=>{if("%%"===n)return"%";a++;const o=t.formatters[i];if("function"==typeof o){const t=e[a];n=o.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e),(r.log||t.log).apply(r,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,r){const n=t(this.namespace+(typeof r>"u"?":":r)+e);return n.log=this.log,n}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(n),...t.skips.map(n).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)!n[r]||("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=Lo(),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t};!function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch{}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch{}return!e&&typeof Ti.exports<"u"&&"env"in Ti.exports&&(e=Ti.exports.env.DEBUG),e},t.useColors=function(){return!(!(typeof window<"u"&&window.process)||"renderer"!==window.process.type&&!window.process.__nwjs)||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch{}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=$o(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}(Vo,Vo.exports);const Bo=Vo.exports,zo="lakex-table",Uo=(e,t)=>zo+":"+e+":"+t,Ho=e=>{const t=localStorage.debug;return"*"===t||t===`${zo}:*`||t===`${zo}:${e}:*`};class Wo{static enable(e,t){const r=Uo(e,t);Ho(e)||Bo.enable(r)}static Infra(e){const t=Uo("infra",e);return Bo(t)}static Framework(e){return Bo(Uo("framework",e))}static App(e){return Bo(Uo("app",e))}static Plugin(e){return Bo(Uo("plugin",e))}static isInfraDebug(){return Ho("infra")}static isFrameworkDebug(){return Ho("framework")}static isAppDebug(){return Ho("app")}static isPluginDebug(){return Ho("plugin")}}Wo.Infra("performanceLog");const Go=jo(navigator)?"":navigator.userAgent,Ko=!jo(window)&&window.h5,qo=typeof er.exports<"u"&&"string"==typeof er.exports.platform&&"number"==typeof er.exports.pid?er.exports:null,Yo=/edge/i.test(Go),Xo=!Yo&&/chrome/i.test(Go),Zo=/firefox/i.test(Go),Jo=!Yo&&!Xo&&/safari/i.test(Go),Qo=/dingtalk/i.test(Go),ea=/mobile/i.test(Go),ta=/os [\.\_\d]+ like mac os/i.test(Go),ra=/android/i.test(Go),na=qo?"darwin"===qo.platform:!ta&&/mac os x/i.test(Go),ia=qo?"win32"===qo.platform:/windows\s*(?:nt)?\s*[\.\_\d]+/i.test(Go);var oa,aa;(e=>{e.isAndroid=ra,e.isIOS=ta,e.isMac=na,e.isWin=ia,e.isMobile=Ko||ea})(oa||(oa={})),(e=>{e.isChrome=Xo,e.isEdge=Yo,e.isFirefox=Zo,e.isSafari=Jo,e.isDingtalk=Qo})(aa||(aa={}));class sa{static onBeforeUnLoad(e){return window.addEventListener("beforeunload",e),{destroy(){window.removeEventListener("beforeunload",e)}}}}const la=class{constructor(e){this.element=e,this.next=la.Undefined,this.prev=la.Undefined}};let ca=la;ca.Undefined=new la(void 0);class ua{constructor(){this._first=ca.Undefined,this._last=ca.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===ca.Undefined}clear(){let e=this._first;for(;e!==ca.Undefined;){const t=e.next;e.prev=ca.Undefined,e.next=ca.Undefined,e=t}this._first=ca.Undefined,this._last=ca.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const r=new ca(e);if(this._first===ca.Undefined)this._first=r,this._last=r;else if(t){const e=this._last;this._last=r,r.prev=e,e.next=r}else{const e=this._first;this._first=r,r.next=e,e.prev=r}this._size+=1;let n=!1;return()=>{n||(n=!0,this._remove(r))}}shift(){if(this._first===ca.Undefined)return;const e=this._first.element;return this._remove(this._first),e}pop(){if(this._last===ca.Undefined)return;const e=this._last.element;return this._remove(this._last),e}_remove(e){if(e.prev!==ca.Undefined&&e.next!==ca.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===ca.Undefined&&e.next===ca.Undefined?(this._first=ca.Undefined,this._last=ca.Undefined):e.next===ca.Undefined?(this._last=this._last.prev,this._last.next=ca.Undefined):e.prev===ca.Undefined&&(this._first=this._first.next,this._first.prev=ca.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==ca.Undefined;)yield e.element,e=e.next}}class da{constructor(e){this._maxSize=e,this.cache=new Map}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,t),t}return null}put(e,t){if(this.cache.size>=this._maxSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}}const fa=typeof pr<"u"?pr:typeof self<"u"?self:typeof window<"u"?window:{};const pa="object"==typeof fa&&fa&&fa.Object===Object&&fa;var ha="object"==typeof self&&self&&self.Object===Object&&self;const ma=pa||ha||Function("return this")();const va=ma.Symbol;var ga=Object.prototype,ya=ga.hasOwnProperty,ba=ga.toString,wa=va?va.toStringTag:void 0;var _a=Object.prototype.toString;var Ca="[object Null]",Ea="[object Undefined]",xa=va?va.toStringTag:void 0;function Sa(e){return null==e?void 0===e?Ea:Ca:xa&&xa in Object(e)?function(e){var t=ya.call(e,wa),r=e[wa];try{e[wa]=void 0;var n=!0}catch{}var i=ba.call(e);return n&&(t?e[wa]=r:delete e[wa]),i}(e):function(e){return _a.call(e)}(e)}function ka(e){return null!=e&&"object"==typeof e}var Oa="[object Symbol]";function Ia(e){return"symbol"==typeof e||ka(e)&&Sa(e)==Oa}function Ra(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}const Ta=Array.isArray;var Aa=1/0,Na=va?va.prototype:void 0,Ma=Na?Na.toString:void 0;function Pa(e){if("string"==typeof e)return e;if(Ta(e))return Ra(e,Pa)+"";if(Ia(e))return Ma?Ma.call(e):"";var t=e+"";return"0"==t&&1/e==-Aa?"-0":t}var ja=/\s/;var Da=/^\s+/;function Fa(e){return e&&e.slice(0,function(e){for(var t=e.length;t--&&ja.test(e.charAt(t)););return t}(e)+1).replace(Da,"")}function Va(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var La=NaN,$a=/^[-+]0x[0-9a-f]+$/i,Ba=/^0b[01]+$/i,za=/^0o[0-7]+$/i,Ua=parseInt;function Ha(e){if("number"==typeof e)return e;if(Ia(e))return La;if(Va(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Va(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Fa(e);var r=Ba.test(e);return r||za.test(e)?Ua(e.slice(2),r?2:8):$a.test(e)?La:+e}var Wa=1/0,Ga=17976931348623157e292;function Ka(e){return e?(e=Ha(e))===Wa||e===-Wa?(e<0?-1:1)*Ga:e==e?e:0:0===e?e:0}function qa(e){var t=Ka(e),r=t%1;return t==t?r?t-r:t:0}function Ya(e){return e}var Xa="[object AsyncFunction]",Za="[object Function]",Ja="[object GeneratorFunction]",Qa="[object Proxy]";function es(e){if(!Va(e))return!1;var t=Sa(e);return t==Za||t==Ja||t==Xa||t==Qa}const ts=ma["__core-js_shared__"];var rs=function(){var e=/[^.]+$/.exec(ts&&ts.keys&&ts.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var ns=Function.prototype.toString;function is(e){if(null!=e){try{return ns.call(e)}catch{}try{return e+""}catch{}}return""}var os=/^\[object .+?Constructor\]$/,as=Function.prototype,ss=Object.prototype,ls=as.toString,cs=ss.hasOwnProperty,us=RegExp("^"+ls.call(cs).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ds(e){return!(!Va(e)||function(e){return!!rs&&rs in e}(e))&&(es(e)?us:os).test(is(e))}function fs(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return ds(r)?r:void 0}const ps=fs(ma,"WeakMap");var hs=Object.create,ms=function(){function e(){}return function(t){if(!Va(t))return{};if(hs)return hs(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();const vs=ms;function gs(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var ys=Date.now;function bs(e){return function(){return e}}var ws=function(){try{var e=fs(Object,"defineProperty");return e({},"",{}),e}catch{}}();const _s=ws;var Cs=_s?function(e,t){return _s(e,"toString",{configurable:!0,enumerable:!1,value:bs(t),writable:!0})}:Ya;var Es=function(e){var t=0,r=0;return function(){var n=ys(),i=16-(n-r);if(r=n,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Cs);const xs=Es;function Ss(e){return e!=e}function ks(e,t){return!!(null==e?0:e.length)&&function(e,t,r){return t==t?function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(e,t,r):function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}(e,Ss,r)}(e,t,0)>-1}var Os=9007199254740991,Is=/^(?:0|[1-9]\d*)$/;function Rs(e,t){var r=typeof e;return!!(t=null==t?Os:t)&&("number"==r||"symbol"!=r&&Is.test(e))&&e>-1&&e%1==0&&e<t}function Ts(e,t,r){"__proto__"==t&&_s?_s(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function As(e,t){return e===t||e!=e&&t!=t}var Ns=Object.prototype.hasOwnProperty;function Ms(e,t,r){var n=e[t];(!Ns.call(e,t)||!As(n,r)||void 0===r&&!(t in e))&&Ts(e,t,r)}var Ps=Math.max;function js(e,t,r){return t=Ps(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=Ps(n.length-t,0),a=Array(o);++i<o;)a[i]=n[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=n[i];return s[t]=r(a),function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}(e,this,s)}}function Ds(e,t){return xs(js(e,t,Ya),e+"")}var Fs=9007199254740991;function Vs(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Fs}function Ls(e){return null!=e&&Vs(e.length)&&!es(e)}function $s(e,t,r){if(!Va(r))return!1;var n=typeof t;return!!("number"==n?Ls(r)&&Rs(t,r.length):"string"==n&&t in r)&&As(r[t],e)}var Bs=Object.prototype;function zs(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Bs)}function Us(e){return ka(e)&&"[object Arguments]"==Sa(e)}var Hs=Object.prototype,Ws=Hs.hasOwnProperty,Gs=Hs.propertyIsEnumerable,Ks=Us(function(){return arguments}())?Us:function(e){return ka(e)&&Ws.call(e,"callee")&&!Gs.call(e,"callee")};const qs=Ks;var Ys="object"==typeof exports&&exports&&!exports.nodeType&&exports,Xs=Ys&&"object"==typeof n&&n&&!n.nodeType&&n,Zs=Xs&&Xs.exports===Ys?ma.Buffer:void 0;const Js=(Zs?Zs.isBuffer:void 0)||function(){return!1};var Qs={};function el(e){return function(t){return e(t)}}Qs["[object Float32Array]"]=Qs["[object Float64Array]"]=Qs["[object Int8Array]"]=Qs["[object Int16Array]"]=Qs["[object Int32Array]"]=Qs["[object Uint8Array]"]=Qs["[object Uint8ClampedArray]"]=Qs["[object Uint16Array]"]=Qs["[object Uint32Array]"]=!0,Qs["[object Arguments]"]=Qs["[object Array]"]=Qs["[object ArrayBuffer]"]=Qs["[object Boolean]"]=Qs["[object DataView]"]=Qs["[object Date]"]=Qs["[object Error]"]=Qs["[object Function]"]=Qs["[object Map]"]=Qs["[object Number]"]=Qs["[object Object]"]=Qs["[object RegExp]"]=Qs["[object Set]"]=Qs["[object String]"]=Qs["[object WeakMap]"]=!1;var tl="object"==typeof exports&&exports&&!exports.nodeType&&exports,rl=tl&&"object"==typeof n&&n&&!n.nodeType&&n,nl=rl&&rl.exports===tl&&pa.process,il=function(){try{return rl&&rl.require&&rl.require("util").types||nl&&nl.binding&&nl.binding("util")}catch{}}();var ol=il&&il.isTypedArray,al=ol?el(ol):function(e){return ka(e)&&Vs(e.length)&&!!Qs[Sa(e)]};const sl=al;var ll=Object.prototype.hasOwnProperty;function cl(e,t){var r=Ta(e),n=!r&&qs(e),i=!r&&!n&&Js(e),o=!r&&!n&&!i&&sl(e),a=r||n||i||o,s=a?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],l=s.length;for(var c in e)(t||ll.call(e,c))&&(!a||!("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Rs(c,l)))&&s.push(c);return s}function ul(e,t){return function(r){return e(t(r))}}const dl=ul(Object.keys,Object);var fl=Object.prototype.hasOwnProperty;function pl(e){return Ls(e)?cl(e):function(e){if(!zs(e))return dl(e);var t=[];for(var r in Object(e))fl.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}var hl=Object.prototype.hasOwnProperty;function ml(e){if(!Va(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=zs(e),r=[];for(var n in e)"constructor"==n&&(t||!hl.call(e,n))||r.push(n);return r}function vl(e){return Ls(e)?cl(e,!0):ml(e)}var gl=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,yl=/^\w*$/;function bl(e,t){if(Ta(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Ia(e))||(yl.test(e)||!gl.test(e)||null!=t&&e in Object(t))}const wl=fs(Object,"create");var _l=Object.prototype.hasOwnProperty;var Cl=Object.prototype.hasOwnProperty;function El(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function xl(e,t){for(var r=e.length;r--;)if(As(e[r][0],t))return r;return-1}El.prototype.clear=function(){this.__data__=wl?wl(null):{},this.size=0},El.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},El.prototype.get=function(e){var t=this.__data__;if(wl){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return _l.call(t,e)?t[e]:void 0},El.prototype.has=function(e){var t=this.__data__;return wl?void 0!==t[e]:Cl.call(t,e)},El.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=wl&&void 0===t?"__lodash_hash_undefined__":t,this};var Sl=Array.prototype.splice;function kl(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}kl.prototype.clear=function(){this.__data__=[],this.size=0},kl.prototype.delete=function(e){var t=this.__data__,r=xl(t,e);return!(r<0)&&(r==t.length-1?t.pop():Sl.call(t,r,1),--this.size,!0)},kl.prototype.get=function(e){var t=this.__data__,r=xl(t,e);return r<0?void 0:t[r][1]},kl.prototype.has=function(e){return xl(this.__data__,e)>-1},kl.prototype.set=function(e,t){var r=this.__data__,n=xl(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};const Ol=fs(ma,"Map");function Il(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function Rl(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Rl.prototype.clear=function(){this.size=0,this.__data__={hash:new El,map:new(Ol||kl),string:new El}},Rl.prototype.delete=function(e){var t=Il(this,e).delete(e);return this.size-=t?1:0,t},Rl.prototype.get=function(e){return Il(this,e).get(e)},Rl.prototype.has=function(e){return Il(this,e).has(e)},Rl.prototype.set=function(e,t){var r=Il(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};var Tl="Expected a function";function Al(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(Tl);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(Al.Cache||Rl),r}Al.Cache=Rl;var Nl=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ml=/\\(\\)?/g,Pl=function(e){var t=Al(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Nl,(function(e,r,n,i){t.push(n?i.replace(Ml,"$1"):r||e)})),t}));const jl=Pl;function Dl(e){return null==e?"":Pa(e)}function Fl(e,t){return Ta(e)?e:bl(e,t)?[e]:jl(Dl(e))}var Vl=1/0;function Ll(e){if("string"==typeof e||Ia(e))return e;var t=e+"";return"0"==t&&1/e==-Vl?"-0":t}function $l(e,t){for(var r=0,n=(t=Fl(t,e)).length;null!=e&&r<n;)e=e[Ll(t[r++])];return r&&r==n?e:void 0}function Bl(e,t,r){var n=null==e?void 0:$l(e,t);return void 0===n?r:n}function zl(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}var Ul=va?va.isConcatSpreadable:void 0;function Hl(e){return Ta(e)||qs(e)||!!(Ul&&e&&e[Ul])}function Wl(e,t,r,n,i){var o=-1,a=e.length;for(r||(r=Hl),i||(i=[]);++o<a;){var s=e[o];t>0&&r(s)?t>1?Wl(s,t-1,r,n,i):zl(i,s):n||(i[i.length]=s)}return i}function Gl(e){return(null==e?0:e.length)?Wl(e,1):[]}const Kl=ul(Object.getPrototypeOf,Object);var ql="[object Object]",Yl=Function.prototype,Xl=Object.prototype,Zl=Yl.toString,Jl=Xl.hasOwnProperty,Ql=Zl.call(Object);function ec(e){if(!ka(e)||Sa(e)!=ql)return!1;var t=Kl(e);if(null===t)return!0;var r=Jl.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Zl.call(r)==Ql}function tc(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o}var rc=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function nc(e){return rc.test(e)}var ic="\\ud800-\\udfff",oc="["+ic+"]",ac="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",sc="\\ud83c[\\udffb-\\udfff]",lc="[^"+ic+"]",cc="(?:\\ud83c[\\udde6-\\uddff]){2}",uc="[\\ud800-\\udbff][\\udc00-\\udfff]",dc="(?:"+ac+"|"+sc+")"+"?",fc="[\\ufe0e\\ufe0f]?",pc=fc+dc+("(?:\\u200d(?:"+[lc,cc,uc].join("|")+")"+fc+dc+")*"),hc="(?:"+[lc+ac+"?",ac,cc,uc,oc].join("|")+")",mc=RegExp(sc+"(?="+sc+")|"+hc+pc,"g");function vc(e){return nc(e)?function(e){return e.match(mc)||[]}(e):function(e){return e.split("")}(e)}function gc(e){var t=this.__data__=new kl(e);this.size=t.size}gc.prototype.clear=function(){this.__data__=new kl,this.size=0},gc.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},gc.prototype.get=function(e){return this.__data__.get(e)},gc.prototype.has=function(e){return this.__data__.has(e)},gc.prototype.set=function(e,t){var r=this.__data__;if(r instanceof kl){var n=r.__data__;if(!Ol||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Rl(n)}return r.set(e,t),this.size=r.size,this};var yc="object"==typeof exports&&exports&&!exports.nodeType&&exports,bc=yc&&"object"==typeof n&&n&&!n.nodeType&&n,wc=bc&&bc.exports===yc?ma.Buffer:void 0,_c=wc?wc.allocUnsafe:void 0;var Cc=Object.prototype.propertyIsEnumerable,Ec=Object.getOwnPropertySymbols,xc=Ec?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o}(Ec(e),(function(t){return Cc.call(e,t)})))}:function(){return[]};const Sc=xc;function kc(e){return function(e,t,r){var n=t(e);return Ta(e)?n:zl(n,r(e))}(e,pl,Sc)}const Oc=fs(ma,"DataView");const Ic=fs(ma,"Promise");const Rc=fs(ma,"Set");var Tc="[object Map]",Ac="[object Promise]",Nc="[object Set]",Mc="[object WeakMap]",Pc="[object DataView]",jc=is(Oc),Dc=is(Ol),Fc=is(Ic),Vc=is(Rc),Lc=is(ps),$c=Sa;(Oc&&$c(new Oc(new ArrayBuffer(1)))!=Pc||Ol&&$c(new Ol)!=Tc||Ic&&$c(Ic.resolve())!=Ac||Rc&&$c(new Rc)!=Nc||ps&&$c(new ps)!=Mc)&&($c=function(e){var t=Sa(e),r="[object Object]"==t?e.constructor:void 0,n=r?is(r):"";if(n)switch(n){case jc:return Pc;case Dc:return Tc;case Fc:return Ac;case Vc:return Nc;case Lc:return Mc}return t});const Bc=$c;const zc=ma.Uint8Array;function Uc(e,t){var r=t?function(e){var t=new e.constructor(e.byteLength);return new zc(t).set(new zc(e)),t}(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function Hc(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Rl;++t<r;)this.add(e[t])}function Wc(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function Gc(e,t){return e.has(t)}Hc.prototype.add=Hc.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Hc.prototype.has=function(e){return this.__data__.has(e)};var Kc=1,qc=2;function Yc(e,t,r,n,i,o){var a=r&Kc,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=o.get(e),u=o.get(t);if(c&&u)return c==t&&u==e;var d=-1,f=!0,p=r&qc?new Hc:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var h=e[d],m=t[d];if(n)var v=a?n(m,h,d,t,e,o):n(h,m,d,e,t,o);if(void 0!==v){if(v)continue;f=!1;break}if(p){if(!Wc(t,(function(e,t){if(!Gc(p,t)&&(h===e||i(h,e,r,n,o)))return p.push(t)}))){f=!1;break}}else if(h!==m&&!i(h,m,r,n,o)){f=!1;break}}return o.delete(e),o.delete(t),f}function Xc(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function Zc(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var Jc=1,Qc=2,eu="[object Boolean]",tu="[object Date]",ru="[object Error]",nu="[object Map]",iu="[object Number]",ou="[object RegExp]",au="[object Set]",su="[object String]",lu="[object Symbol]",cu="[object ArrayBuffer]",uu="[object DataView]",du=va?va.prototype:void 0,fu=du?du.valueOf:void 0;var pu=1,hu=Object.prototype.hasOwnProperty;var mu=1,vu="[object Arguments]",gu="[object Array]",yu="[object Object]",bu=Object.prototype.hasOwnProperty;function wu(e,t,r,n,i,o){var a=Ta(e),s=Ta(t),l=a?gu:Bc(e),c=s?gu:Bc(t),u=(l=l==vu?yu:l)==yu,d=(c=c==vu?yu:c)==yu,f=l==c;if(f&&Js(e)){if(!Js(t))return!1;a=!0,u=!1}if(f&&!u)return o||(o=new gc),a||sl(e)?Yc(e,t,r,n,i,o):function(e,t,r,n,i,o,a){switch(r){case uu:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case cu:return!(e.byteLength!=t.byteLength||!o(new zc(e),new zc(t)));case eu:case tu:case iu:return As(+e,+t);case ru:return e.name==t.name&&e.message==t.message;case ou:case su:return e==t+"";case nu:var s=Xc;case au:var l=n&Jc;if(s||(s=Zc),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;n|=Qc,a.set(e,t);var u=Yc(s(e),s(t),n,i,o,a);return a.delete(e),u;case lu:if(fu)return fu.call(e)==fu.call(t)}return!1}(e,t,l,r,n,i,o);if(!(r&mu)){var p=u&&bu.call(e,"__wrapped__"),h=d&&bu.call(t,"__wrapped__");if(p||h){var m=p?e.value():e,v=h?t.value():t;return o||(o=new gc),i(m,v,r,n,o)}}return!!f&&(o||(o=new gc),function(e,t,r,n,i,o){var a=r&pu,s=kc(e),l=s.length;if(l!=kc(t).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in t:hu.call(t,u)))return!1}var d=o.get(e),f=o.get(t);if(d&&f)return d==t&&f==e;var p=!0;o.set(e,t),o.set(t,e);for(var h=a;++c<l;){var m=e[u=s[c]],v=t[u];if(n)var g=a?n(v,m,u,t,e,o):n(m,v,u,e,t,o);if(!(void 0===g?m===v||i(m,v,r,n,o):g)){p=!1;break}h||(h="constructor"==u)}if(p&&!h){var y=e.constructor,b=t.constructor;y!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(p=!1)}return o.delete(e),o.delete(t),p}(e,t,r,n,i,o))}function _u(e,t,r,n,i){return e===t||(null==e||null==t||!ka(e)&&!ka(t)?e!=e&&t!=t:wu(e,t,r,n,_u,i))}var Cu=1,Eu=2;function xu(e){return e==e&&!Va(e)}function Su(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}function ku(e){var t=function(e){for(var t=pl(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,xu(i)]}return t}(e);return 1==t.length&&t[0][2]?Su(t[0][0],t[0][1]):function(r){return r===e||function(e,t,r,n){var i=r.length,o=i,a=!n;if(null==e)return!o;for(e=Object(e);i--;){var s=r[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var l=(s=r[i])[0],c=e[l],u=s[1];if(a&&s[2]){if(void 0===c&&!(l in e))return!1}else{var d=new gc;if(n)var f=n(c,u,l,e,t,d);if(!(void 0===f?_u(u,c,Cu|Eu,n,d):f))return!1}}return!0}(r,e,t)}}function Ou(e,t){return null!=e&&t in Object(e)}function Iu(e,t){return null!=e&&function(e,t,r){for(var n=-1,i=(t=Fl(t,e)).length,o=!1;++n<i;){var a=Ll(t[n]);if(!(o=null!=e&&r(e,a)))break;e=e[a]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&Vs(i)&&Rs(a,i)&&(Ta(e)||qs(e))}(e,t,Ou)}var Ru=1,Tu=2;function Au(e){return bl(e)?function(e){return function(t){return null==t?void 0:t[e]}}(Ll(e)):function(e){return function(t){return $l(t,e)}}(e)}function Nu(e){return"function"==typeof e?e:null==e?Ya:"object"==typeof e?Ta(e)?function(e,t){return bl(e)&&xu(t)?Su(Ll(e),t):function(r){var n=Bl(r,e);return void 0===n&&n===t?Iu(r,e):_u(t,n,Ru|Tu)}}(e[0],e[1]):ku(e):Au(e)}function Mu(e,t,r,n){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(n,a,r(a),e)}return n}var Pu=function(e){return function(t,r,n){for(var i=-1,o=Object(t),a=n(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===r(o[l],l,o))break}return t}}();const ju=Pu;var Du=function(e,t){return function(r,n){if(null==r)return r;if(!Ls(r))return e(r,n);for(var i=r.length,o=t?i:-1,a=Object(r);(t?o--:++o<i)&&!1!==n(a[o],o,a););return r}}((function(e,t){return e&&ju(e,t,pl)}));const Fu=Du;function Vu(e,t,r,n){return Fu(e,(function(e,i,o){t(n,e,r(e),o)})),n}function Lu(e,t){return function(r,n){var i=Ta(r)?Mu:Vu,o=t?t():{};return i(r,e,Nu(n),o)}}function $u(e,t,r){(void 0!==r&&!As(e[t],r)||void 0===r&&!(t in e))&&Ts(e,t,r)}function Bu(e){return ka(e)&&Ls(e)}function zu(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function Uu(e){return function(e,t,r,n){var i=!r;r||(r={});for(var o=-1,a=t.length;++o<a;){var s=t[o],l=n?n(r[s],e[s],s,r,e):void 0;void 0===l&&(l=e[s]),i?Ts(r,s,l):Ms(r,s,l)}return r}(e,vl(e))}function Hu(e,t,r,n,i,o,a){var s=zu(e,r),l=zu(t,r),c=a.get(l);if(c)$u(e,r,c);else{var u=o?o(s,l,r+"",e,t,a):void 0,d=void 0===u;if(d){var f=Ta(l),p=!f&&Js(l),h=!f&&!p&&sl(l);u=l,f||p||h?Ta(s)?u=s:Bu(s)?u=gs(s):p?(d=!1,u=function(e,t){if(t)return e.slice();var r=e.length,n=_c?_c(r):new e.constructor(r);return e.copy(n),n}(l,!0)):h?(d=!1,u=Uc(l,!0)):u=[]:ec(l)||qs(l)?(u=s,qs(s)?u=Uu(s):(!Va(s)||es(s))&&(u=function(e){return"function"!=typeof e.constructor||zs(e)?{}:vs(Kl(e))}(l))):d=!1}d&&(a.set(l,u),i(u,l,n,o,a),a.delete(l)),$u(e,r,u)}}function Wu(e,t,r,n,i){e!==t&&ju(t,(function(o,a){if(i||(i=new gc),Va(o))Hu(e,t,a,r,Wu,n,i);else{var s=n?n(zu(e,a),o,a+"",e,t,i):void 0;void 0===s&&(s=o),$u(e,a,s)}}),vl)}function Gu(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}var Ku=Ds((function(e,t){return Bu(e)?function(e,t,r,n){var i=-1,o=ks,a=!0,s=e.length,l=[],c=t.length;if(!s)return l;r&&(t=Ra(t,el(r))),n?(o=Gu,a=!1):t.length>=200&&(o=Gc,a=!1,t=new Hc(t));e:for(;++i<s;){var u=e[i],d=null==r?u:r(u);if(u=n||0!==u?u:0,a&&d==d){for(var f=c;f--;)if(t[f]===d)continue e;l.push(u)}else o(t,d,n)||l.push(u)}return l}(e,Wl(t,1,Bu,!0)):[]}));const qu=Ku;function Yu(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var Xu=Object.prototype.hasOwnProperty,Zu=Lu((function(e,t,r){Xu.call(e,r)?e[r].push(t):Ts(e,r,[t])}));const Ju=Zu;var Qu=Math.max,ed=Math.min;function td(e,t,r){return t=Ka(t),void 0===r?(r=t,t=0):r=Ka(r),function(e,t,r){return e>=ed(t,r)&&e<Qu(t,r)}(e=Ha(e),t,r)}var rd="[object String]";function nd(e){return"string"==typeof e||!Ta(e)&&ka(e)&&Sa(e)==rd}function id(e){return null==e?[]:function(e,t){return Ra(t,(function(t){return e[t]}))}(e,pl(e))}function od(e,t){return _u(e,t)}function ad(e){return null==e}var sd=Lu((function(e,t,r){Ts(e,r,t)}));const ld=sd;var cd=function(e){return Ds((function(t,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,a=i>2?r[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&$s(r[0],r[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++n<i;){var s=r[n];s&&e(t,s,n,o)}return t}))}((function(e,t,r){Wu(e,t,r)}));const ud=cd;var dd=va?va.iterator:void 0;function fd(e,t){return null==(e=function(e,t){return t.length<2?e:$l(e,tc(t,0,-1))}(e,t=Fl(t,e)))||delete e[Ll(Yu(t))]}function pd(e,t,r,n){if(!Va(e))return e;for(var i=-1,o=(t=Fl(t,e)).length,a=o-1,s=e;null!=s&&++i<o;){var l=Ll(t[i]),c=r;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(i!=a){var u=s[l];void 0===(c=n?n(u,l,s):void 0)&&(c=Va(u)?u:Rs(t[i+1])?[]:{})}Ms(s,l,c),s=s[l]}return e}function hd(e,t){return function(e,t,r){for(var n=-1,i=t.length,o={};++n<i;){var a=t[n],s=$l(e,a);r(s,a)&&pd(o,Fl(a,e),s)}return o}(e,t,(function(t,r){return Iu(e,r)}))}var md=function(e){return xs(js(e,void 0,Gl),e+"")}((function(e,t){return null==e?{}:hd(e,t)}));const vd=md;var gd=Array.prototype.splice;function yd(e,t){var r=[];if(!e||!e.length)return r;var n=-1,i=[],o=e.length;for(t=Nu(t);++n<o;){var a=e[n];t(a,n,e)&&(r.push(a),i.push(n))}return function(e,t){for(var r=e?t.length:0,n=r-1;r--;){var i=t[r];if(r==n||i!==o){var o=i;Rs(i)?gd.call(e,i,1):fd(e,i)}}}(e,i),r}function bd(e,t,r){return null==e?e:pd(e,t,r)}var wd=Rc&&1/Zc(new Rc([,-0]))[1]==1/0?function(e){return new Rc(e)}:function(){};const _d=wd;var Cd=200;function Ed(e,t,r){var n=-1,i=ks,o=e.length,a=!0,s=[],l=s;if(r)a=!1,i=Gu;else if(o>=Cd){var c=t?null:_d(e);if(c)return Zc(c);a=!1,i=Gc,l=new Hc}else l=t?[]:s;e:for(;++n<o;){var u=e[n],d=t?t(u):u;if(u=r||0!==u?u:0,a&&d==d){for(var f=l.length;f--;)if(l[f]===d)continue e;t&&l.push(d),s.push(u)}else i(l,d,r)||(l!==s&&l.push(d),s.push(u))}return s}function xd(e,t){return e&&e.length?Ed(e,Nu(t)):[]}const Sd=class extends da{constructor(e){super(e||Sd.defaultMaxSize),this._canvasCtx=null}_getOrCreateCanvasCtx(){if(this._canvasCtx)return this._canvasCtx;const e=document.createElement("canvas").getContext("2d");return this._canvasCtx=e,this._canvasCtx}calc(e,t){if(!e)return{width:0,height:0};const r=function(e){if(!e)return[];if(Ls(e))return nd(e)?vc(e):gs(e);if(dd&&e[dd])return function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}(e[dd]());var t=Bc(e);return("[object Map]"==t?Xc:"[object Set]"==t?Zc:id)(e)}(e);let n=0,i=0;return r.forEach((e=>{const r=this._getWordSize(e,t);n+=r.width,r.height>i&&(i=r.height)})),{width:n,height:i}}getRenderText(e,t,r){if(!Mo(e))return e;const n=r||Sd.defaultFontStyle,i=n.fontSize,o=3*n.fontSize,a=Math.ceil(t.height/n.lineHeight),s=t.width*a;if(this._getWordSize(e,n.font).width+i<s)return e;let l=0,c=e.length-1;const u=this._getEllipsisWidth(n.font);let d=10;for(;l<=c&&d>0;){d--;const t=Math.floor((l+c)/2),r=e.slice(0,t+1),i=this._getWordSize(r,n.font).width;if(td(i+u,s-o,s))return r+"...";i>s?c=t-1:l=t+1}return e.slice(0,l-3)+"..."}_getEllipsisWidth(e){return Math.ceil(this._getWordSize("...",e).width)}_getWordSize(e,t){const r=`${e}-${t}`,n=this.get(r);if(n)return n;this._canvasCtx=this._getOrCreateCanvasCtx(),this._canvasCtx.font=t;const i=this._canvasCtx.measureText(e),o={width:i.width,height:i.actualBoundingBoxAscent+i.actualBoundingBoxDescent};return this.put(r,o),o}};let kd=Sd;kd.defaultMaxSize=1e4,kd.maxFindTime=500,kd.defaultFontStyle={lineHeight:14,font:"14px PingFang SC",fontSize:14};const Od=new kd;function Id(e){return!/\s/gi.test(e)&&/.+\@.+\..+/gi.test(e)}var Rd={exports:{}};!function(e,t){e.exports=function(){var e=1e3,t=6e4,r=36e5,n="millisecond",i="second",o="minute",a="hour",s="day",l="week",c="month",u="quarter",d="year",f="date",p="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||t[0])+"]"}},g=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},y={s:g,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),i=r%60;return(t<=0?"+":"-")+g(n,2,"0")+":"+g(i,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),i=t.clone().add(n,c),o=r-i<0,a=t.clone().add(n+(o?-1:1),c);return+(-(n+(r-i)/(o?i-a:a-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:d,w:l,d:s,D:f,h:a,m:o,s:i,ms:n,Q:u}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},b="en",w={};w[b]=v;var _=function(e){return e instanceof S},C=function e(t,r,n){var i;if(!t)return b;if("string"==typeof t){var o=t.toLowerCase();w[o]&&(i=o),r&&(w[o]=r,i=o);var a=t.split("-");if(!i&&a.length>1)return e(a[0])}else{var s=t.name;w[s]=t,i=s}return!n&&i&&(b=i),i||!n&&b},E=function(e,t){if(_(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new S(r)},x=y;x.l=C,x.i=_,x.w=function(e,t){return E(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var S=function(){function v(e){this.$L=C(e.locale,null,!0),this.parse(e)}var g=v.prototype;return g.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(x.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(h);if(n){var i=n[2]-1||0,o=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},g.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},g.$utils=function(){return x},g.isValid=function(){return this.$d.toString()!==p},g.isSame=function(e,t){var r=E(e);return this.startOf(t)<=r&&r<=this.endOf(t)},g.isAfter=function(e,t){return E(e)<this.startOf(t)},g.isBefore=function(e,t){return this.endOf(t)<E(e)},g.$g=function(e,t,r){return x.u(e)?this[t]:this.set(r,e)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(e,t){var r=this,n=!!x.u(t)||t,u=x.p(e),p=function(e,t){var i=x.w(r.$u?Date.UTC(r.$y,t,e):new Date(r.$y,t,e),r);return n?i:i.endOf(s)},h=function(e,t){return x.w(r.toDate()[e].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),r)},m=this.$W,v=this.$M,g=this.$D,y="set"+(this.$u?"UTC":"");switch(u){case d:return n?p(1,0):p(31,11);case c:return n?p(1,v):p(0,v+1);case l:var b=this.$locale().weekStart||0,w=(m<b?m+7:m)-b;return p(n?g-w:g+(6-w),v);case s:case f:return h(y+"Hours",0);case a:return h(y+"Minutes",1);case o:return h(y+"Seconds",2);case i:return h(y+"Milliseconds",3);default:return this.clone()}},g.endOf=function(e){return this.startOf(e,!1)},g.$set=function(e,t){var r,l=x.p(e),u="set"+(this.$u?"UTC":""),p=(r={},r[s]=u+"Date",r[f]=u+"Date",r[c]=u+"Month",r[d]=u+"FullYear",r[a]=u+"Hours",r[o]=u+"Minutes",r[i]=u+"Seconds",r[n]=u+"Milliseconds",r)[l],h=l===s?this.$D+(t-this.$W):t;if(l===c||l===d){var m=this.clone().set(f,1);m.$d[p](h),m.init(),this.$d=m.set(f,Math.min(this.$D,m.daysInMonth())).$d}else p&&this.$d[p](h);return this.init(),this},g.set=function(e,t){return this.clone().$set(e,t)},g.get=function(e){return this[x.p(e)]()},g.add=function(n,u){var f,p=this;n=Number(n);var h=x.p(u),m=function(e){var t=E(p);return x.w(t.date(t.date()+Math.round(e*n)),p)};if(h===c)return this.set(c,this.$M+n);if(h===d)return this.set(d,this.$y+n);if(h===s)return m(1);if(h===l)return m(7);var v=(f={},f[o]=t,f[a]=r,f[i]=e,f)[h]||1,g=this.$d.getTime()+n*v;return x.w(g,this)},g.subtract=function(e,t){return this.add(-1*e,t)},g.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||p;var n=e||"YYYY-MM-DDTHH:mm:ssZ",i=x.z(this),o=this.$H,a=this.$m,s=this.$M,l=r.weekdays,c=r.months,u=r.meridiem,d=function(e,r,i,o){return e&&(e[r]||e(t,n))||i[r].slice(0,o)},f=function(e){return x.s(o%12||12,e,"0")},h=u||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(m,(function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return x.s(t.$y,4,"0");case"M":return s+1;case"MM":return x.s(s+1,2,"0");case"MMM":return d(r.monthsShort,s,c,3);case"MMMM":return d(c,s);case"D":return t.$D;case"DD":return x.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return d(r.weekdaysMin,t.$W,l,2);case"ddd":return d(r.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(o);case"HH":return x.s(o,2,"0");case"h":return f(1);case"hh":return f(2);case"a":return h(o,a,!0);case"A":return h(o,a,!1);case"m":return String(a);case"mm":return x.s(a,2,"0");case"s":return String(t.$s);case"ss":return x.s(t.$s,2,"0");case"SSS":return x.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")}))},g.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},g.diff=function(n,f,p){var h,m=this,v=x.p(f),g=E(n),y=(g.utcOffset()-this.utcOffset())*t,b=this-g,w=function(){return x.m(m,g)};switch(v){case d:h=w()/12;break;case c:h=w();break;case u:h=w()/3;break;case l:h=(b-y)/6048e5;break;case s:h=(b-y)/864e5;break;case a:h=b/r;break;case o:h=b/t;break;case i:h=b/e;break;default:h=b}return p?h:x.a(h)},g.daysInMonth=function(){return this.endOf(c).$D},g.$locale=function(){return w[this.$L]},g.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=C(e,t,!0);return n&&(r.$L=n),r},g.clone=function(){return x.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},v}(),k=S.prototype;return E.prototype=k,[["$ms",n],["$s",i],["$m",o],["$H",a],["$W",s],["$M",c],["$y",d],["$D",f]].forEach((function(e){k[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),E.extend=function(e,t){return e.$i||(e(t,S,E),e.$i=!0),E},E.locale=C,E.isDayjs=_,E.unix=function(e){return E(1e3*e)},E.en=w[b],E.Ls=w,E.p={},E}()}(Rd);const Td=Rd.exports;function Ad(e){if(ad(e))return null;if(e>=31708800){e+=Td("1901-01-01").diff("1900-12-31 23:59:59","seconds")-1}return Td("1899-12-30").add(e,"seconds").format("YYYY-MM-DDTHH:mm:ssZ")}const Nd=/^(?:\w+:)?\/\//,Md=/^(javascript:)?\/\//,Pd=/^(?:\w+:)?\/\/(\S+)$/,jd=/^localhost[\:?\d]*(?:[^\:?\d]\S*)?$/,Dd=/^[^\s\.]+\.\S{2,}$/;function Fd(e){return function(e){if("string"!=typeof e||e.match(Md))return!1;const t=e.match(Pd);if(!t)return!1;const r=t[1];return!(!r||!jd.test(r)&&!Dd.test(r))}(e)?e:function(e){return(e=String(e).trim()).match(Nd)&&!e.match(Md)?e:"http://"+e}(e)}function Vd(e){return/^-?\d*[.,]?\d*$/.test(e)||/^[-+]?\d{1,3}(,\d{3})*(\.(\d*))?$/.test(e)?e+"":""}const Ld=e=>!(""!==e&&!ad(e))||""!==Vd(e);function $d(e){return($d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bd(e){if(!("string"==typeof e||e instanceof String)){var t=$d(e);throw null===e?t="null":"object"===t&&(t=e.constructor.name),new TypeError("Expected a string but received a ".concat(t))}}function zd(e){return(zd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ud(e,t){var r,n;Bd(e),"object"===zd(t)?(r=t.min||0,n=t.max):(r=arguments[1],n=arguments[2]);var i=encodeURI(e).split(/%..|./).length-1;return i>=r&&(typeof n>"u"||i<=n)}function Hd(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;for(var r in t)typeof e[r]>"u"&&(e[r]=t[r]);return e}var Wd={require_tld:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_numeric_tld:!1,allow_wildcard:!1,ignore_max_length:!1};function Gd(e,t){Bd(e),(t=Hd(t,Wd)).allow_trailing_dot&&"."===e[e.length-1]&&(e=e.substring(0,e.length-1)),!0===t.allow_wildcard&&0===e.indexOf("*.")&&(e=e.substring(2));var r=e.split("."),n=r[r.length-1];return!(t.require_tld&&(r.length<2||!t.allow_numeric_tld&&!/^([a-z\u00A1-\u00A8\u00AA-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}|xn[a-z0-9-]{2,})$/i.test(n)||/\s/.test(n))||!t.allow_numeric_tld&&/^\d+$/.test(n))&&r.every((function(e){return!(e.length>63&&!t.ignore_max_length||!/^[a-z_\u00a1-\uffff0-9-]+$/i.test(e)||/[\uff01-\uff5e]/.test(e)||/^-|-$/.test(e)||!t.allow_underscores&&/_/.test(e))}))}var Kd="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",qd="(".concat(Kd,"[.]){3}").concat(Kd),Yd=new RegExp("^".concat(qd,"$")),Xd="(?:[0-9a-fA-F]{1,4})",Zd=new RegExp("^("+"(?:".concat(Xd,":){7}(?:").concat(Xd,"|:)|")+"(?:".concat(Xd,":){6}(?:").concat(qd,"|:").concat(Xd,"|:)|")+"(?:".concat(Xd,":){5}(?::").concat(qd,"|(:").concat(Xd,"){1,2}|:)|")+"(?:".concat(Xd,":){4}(?:(:").concat(Xd,"){0,1}:").concat(qd,"|(:").concat(Xd,"){1,3}|:)|")+"(?:".concat(Xd,":){3}(?:(:").concat(Xd,"){0,2}:").concat(qd,"|(:").concat(Xd,"){1,4}|:)|")+"(?:".concat(Xd,":){2}(?:(:").concat(Xd,"){0,3}:").concat(qd,"|(:").concat(Xd,"){1,5}|:)|")+"(?:".concat(Xd,":){1}(?:(:").concat(Xd,"){0,4}:").concat(qd,"|(:").concat(Xd,"){1,6}|:)|")+"(?::((?::".concat(Xd,"){0,5}:").concat(qd,"|(?::").concat(Xd,"){1,7}|:))")+")(%[0-9a-zA-Z-.:]{1,})?$");function Jd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Bd(e),(t=String(t))?"4"===t?Yd.test(e):"6"===t&&Zd.test(e):Jd(e,4)||Jd(e,6)}var Qd={allow_display_name:!1,allow_underscores:!1,require_display_name:!1,allow_utf8_local_part:!0,require_tld:!0,blacklisted_chars:"",ignore_max_length:!1,host_blacklist:[],host_whitelist:[]},ef=/^([^\x00-\x1F\x7F-\x9F\cX]+)</i,tf=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~]+$/i,rf=/^[a-z\d]+$/,nf=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f]))*$/i,of=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\u00A1-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+$/i,af=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*$/i;function sf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(typeof Symbol>"u")&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&null!=s.return&&s.return()}finally{if(i)throw o}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return lf(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lf(e,t)}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var cf={protocols:["http","https","ftp"],require_tld:!0,require_protocol:!1,require_host:!0,require_port:!1,require_valid_protocol:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_protocol_relative_urls:!1,allow_fragments:!0,allow_query_components:!0,validate_length:!0},uf=/^\[([^\]]+)\](?::([0-9]+))?$/;function df(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function ff(e,t){for(var r=0;r<t.length;r++){var n=t[r];if(e===n||df(n)&&n.test(e))return!0}return!1}const pf=(e,t={})=>function(e,t){if(Bd(e),!e||/[\s<>]/.test(e)||0===e.indexOf("mailto:")||(t=Hd(t,cf)).validate_length&&e.length>=2083||!t.allow_fragments&&e.includes("#")||!t.allow_query_components&&(e.includes("?")||e.includes("&")))return!1;var r,n,i,o,a,s,l,c;if(l=e.split("#"),e=l.shift(),l=e.split("?"),e=l.shift(),(l=e.split("://")).length>1){if(r=l.shift().toLowerCase(),t.require_valid_protocol&&-1===t.protocols.indexOf(r))return!1}else{if(t.require_protocol)return!1;if("//"===e.slice(0,2)){if(!t.allow_protocol_relative_urls)return!1;l[0]=e.slice(2)}}if(""===(e=l.join("://")))return!1;if(l=e.split("/"),""===(e=l.shift())&&!t.require_host)return!0;if((l=e.split("@")).length>1){if(t.disallow_auth||""===l[0]||(n=l.shift()).indexOf(":")>=0&&n.split(":").length>2)return!1;var u=sf(n.split(":"),2),d=u[0],f=u[1];if(""===d&&""===f)return!1}s=null,c=null;var p=(o=l.join("@")).match(uf);if(p?(i="",c=p[1],s=p[2]||null):(i=(l=o.split(":")).shift(),l.length&&(s=l.join(":"))),null!==s&&s.length>0){if(a=parseInt(s,10),!/^[0-9]+$/.test(s)||a<=0||a>65535)return!1}else if(t.require_port)return!1;return t.host_whitelist?ff(i,t.host_whitelist):""===i&&!t.require_host||!(!Jd(i)&&!Gd(i,t)&&(!c||!Jd(c,6))||(i=i||c,t.host_blacklist&&ff(i,t.host_blacklist)))}(e,{require_protocol:!0,...t}),hf=(e,t={})=>{if(!e)return!1;const r=t.precision||18,n=t.scale||2,i=t.forceDecimal||!1;return!(e.replace(/[-+.]/gi,"").length>r)&&new RegExp(`^[-+]?([0-9]+)?(\\.[0-9]{0,${n}})${i?"":"?"}$`).test(e)},mf=Wo.Infra("di");function vf(e){const t=function(e){return e.name||e.toString()}(e.serviceIdentifier);mf(`依赖 ${t} 耗时：${e.time} ms`,e)}var gf=(e=>(e[e.Waiting=-1]="Waiting",e[e.Init=0]="Init",e[e.Configed=1]="Configed",e[e.Inited=2]="Inited",e[e.WorkbenchInited=3]="WorkbenchInited",e[e.Starting=4]="Starting",e[e.Ready=5]="Ready",e[e.RecordInit=6]="RecordInit",e[e.RecordReady=7]="RecordReady",e[e.Rendered=8]="Rendered",e[e.beforeDestroy=9]="beforeDestroy",e[e.Destroyed=10]="Destroyed",e))(gf||{});const yf=Fi.defineToken("LifecycleService");var bf=Object.defineProperty,wf=Object.getOwnPropertyDescriptor;const _f={[gf.Waiting]:"Waiting",[gf.Init]:"Init",[gf.Configed]:"Configed",[gf.Inited]:"Inited",[gf.Starting]:"Starting",[gf.Ready]:"Ready",[gf.RecordInit]:"RecordInit",[gf.RecordReady]:"RecordReady",[gf.Rendered]:"Rendered",[gf.WorkbenchInited]:"WorkbenchInited",[gf.beforeDestroy]:"beforeDestroy",[gf.Destroyed]:"Destroyed"};let Cf=class{constructor(){this._status=gf.Waiting,this.statusWhen=new Map,this._statusChangedAt=new Map}get statusStr(){return _f[this.status]}get status(){return this._status}set status(e){if(e<this.status){const t=JSON.stringify({current:this.status,setStatus:e});throw new Error("Lifecycle cannot go backwards"+t)}this.status!==e&&(this._status=e,this._statusChangedAt.set(e,+new Date),this._runCallback())}when(e,t){if(e<=this.status)return;const r=this.statusWhen.get(e);if(Array.isArray(r)){const n=[...r,t];this.statusWhen.set(e,n)}else this.statusWhen.set(e,[t])}_runCallback(){const e=this.statusWhen.get(this.status);!e||e.length&&e.forEach((e=>{e()}))}getStatusChangedAt(e){return this._statusChangedAt.get(e)}};Cf=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?wf(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&bf(t,r,o),o})([eo({token:yf})],Cf);const Ef=/\$(\d+)/g;const xf=class{static setLanguage(e){xf._lang="enUS"===e||"en-US"===e||"en"===e||"en-us"===e?"enUS":"zhCN"}static setData(e={}){xf._data={...xf._data,...e}}static get(e,...t){return t.length?(e="zhCN"===xf._lang?e:xf._data[e]||e)?((t=t.map((e=>"zhCN"===xf._lang?e:xf._data[e]||t))).unshift(""),e.replace(Ef,((e,r)=>t[r]||""))):"":"zhCN"===xf._lang?e:xf._data[e]||e}};let Sf=xf;function kf(e,...t){return Sf.get(e,...t)}Sf._lang="zhCN",Sf._data={},Sf.setLanguage(function(){var e;const t="zh-cn";if(typeof window<"u"&&typeof document<"u"){if(null!=(e=window.appData)&&e.locale)return window.appData.locale;const r=window.location.search,n=new URLSearchParams(r).get("language");if(n)return n;const i=document.cookie.match(/(?:^|; ?)lang=([^;]+)(?:;|$)/);return i?i[1]:t}return t}()||"zhCN");const Of=Fi.defineToken("DriverToken");var If=(e=>(e.Pending="pending",e.Runing="Runing",e))(If||{});const Rf=Fi.defineToken("ModelEventToken"),Tf=Fi.defineToken("ModelInitialToken");var Af=(e=>(e.SELECT="select",e.INSERT="insert",e.UPDATE="update",e.DELETE="delete",e.UPSERT="upsert",e.BULK_INSERT="bulkInsert",e.MOVE_BEFORE="moveBefore",e.MOVE_AFTER="moveAfter",e.INSERT_AFTER="insertAfter",e.INSERT_BEFORE="insertBefore",e))(Af||{});const Nf=Fi.defineToken("StorageToken");var Mf=Object.defineProperty,Pf=Object.getOwnPropertyDescriptor,jf=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Pf(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Mf(t,r,o),o};let Df=class{read(e){return this._storage.getData(e.table,e.where)}};jf([to(Nf)],Df.prototype,"_storage",2),Df=jf([eo()],Df);var Ff=Object.defineProperty,Vf=Object.getOwnPropertyDescriptor;let Lf=class{where(e,t,r){if(r&&(e=this.getDataByIndexes(e,t,r)),t){const e=Object.keys(t);for(const r of e)if(Array.isArray(t[r])){const e={};for(let n=0;n<t[r].length;n++)e[t[r][n]]=!0;t[`$__${r}`]=e}}return e?e.filter((e=>this._matchRow(e,t))):[]}findIndex(e,t,r){if(r&&(e=this.getDataByIndexes(e,t,r)),t){const e=Object.keys(t);for(const r of e)if(Array.isArray(t[r])){const e={};for(let n=0;n<t[r].length;n++)e[t[r][n]]=!0;t[`$__${r}`]=e}}return e?e.findIndex((e=>this._matchRow(e,t))):-1}getDataByIndexes(e,t,r){e||(e={});let n=[];if(2===r.length){let i=[],o=null==t?void 0:t[r[0]];o?Array.isArray(o)||(o=[o]):o=Object.keys(e);for(const t of o)e[t]&&(i=i.concat(e[t]));let a=null==t?void 0:t[r[1]];a?Array.isArray(a)||(a=[a]):a=i.reduce(((e,t)=>(t&&(e=e.concat(Object.keys(t))),e)),[]);for(const e of a)for(const t of i)t[e]&&(n=n.concat(t[e]))}else{let i=null==t?void 0:t[r[0]];i?Array.isArray(i)||(i=[i]):i=Object.keys(e);for(const t of i)e[t]&&(n=n.concat(e[t]))}return n||[]}_matchRow(e,t){let r=!1;if(!t)return!0;const n=Object.keys(t);if(0===n.length||!t)return!0;for(const i of n)if(!i.startsWith("$__")&&(r=this._match(e,i,t),!r))return!1;return r}_match(e,t,r){var n;let i=r[t];return null!=i&&i.$not?(i=i.$not,Array.isArray(i)?!i.find((r=>r==e[t])):e[t]!=i):Array.isArray(i)?!(null==(n=r[`$__${t}`])||!n[e[t]]):e[t]==i}};Lf=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Vf(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ff(t,r,o),o})([eo()],Lf);var $f=Object.defineProperty,Bf=Object.getOwnPropertyDescriptor,zf=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Bf(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&$f(t,r,o),o};let Uf=class{write(e){var t,r,n,i,o,a,s,l;const c=e.table,u=e.sets,d=this._storage.getOriginData(c)||[],f=this._storage.getIndexes(c);if(e.command===Af.UPSERT){const t=this._dataHelper.where(d,e.where,f);return t&&0!==t.length?(this._storage.update(c,t,u),u):(u.uuid||(u.uuid=Io(32)),this._storage.append(c,u),u)}if(e.command===Af.UPDATE){const t=this._dataHelper.where(d,e.where,f);return this._storage.update(c,t,u),u}if(e.command===Af.INSERT)return u.uuid||(u.uuid=Io(32)),this._storage.append(c,u),u;if(e.command===Af.INSERT_AFTER){const n=Array.isArray(u)?u[0]:u;if(null!=(t=this._dataHelper.where(d,n,f))&&t[0])return;let i;return e.where&&(i=null==(r=this._dataHelper.where(d,e.where,f))?void 0:r[0]),this._storage.append(c,n,i),n}if(e.command===Af.INSERT_BEFORE){const t=Array.isArray(u)?u[0]:u;if(null!=(n=this._dataHelper.where(d,t,f))&&n[0])return;let r;return e.where&&(r=null==(i=this._dataHelper.where(d,e.where,f))?void 0:i[0]),this._storage.before(c,t,r),t}if(e.command===Af.DELETE){const t=this._dataHelper.where(d,e.where,f);return this._storage.remove(c,t),u}if(e.command===Af.BULK_INSERT){for(const e of u)e.uuid||(e.uuid=Io(32));for(const e of u)this._storage.append(c,e);return u}if(e.command===Af.MOVE_AFTER){const t=Array.isArray(u)?u[0]:u,r=null==(o=this._dataHelper.where(d,t,f))?void 0:o[0];if(!r)return;let n;return e.where&&(n=null==(a=this._dataHelper.where(d,e.where,f))?void 0:a[0]),n?(this._storage.remove(c,[r]),this._storage.append(c,r,n),[n,r]):(this._storage.remove(c,[r]),this._storage.append(c,r),[r])}if(e.command===Af.MOVE_BEFORE){const t=Array.isArray(u)?u[0]:u,r=null==(s=this._dataHelper.where(d,t,f))?void 0:s[0];if(!r)return;let n;return e.where&&(n=null==(l=this._dataHelper.where(d,e.where,f))?void 0:l[0]),n?(this._storage.remove(c,[r]),this._storage.before(c,r,n),[r,n]):(this._storage.remove(c,[r]),this._storage.before(c,r),[r])}return null}};zf([to(Nf)],Uf.prototype,"_storage",2),zf([to(Lf)],Uf.prototype,"_dataHelper",2),Uf=zf([eo()],Uf);var Hf=Object.defineProperty,Wf=Object.getOwnPropertyDescriptor,Gf=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Wf(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Hf(t,r,o),o};let Kf=class{constructor(){this._status=If.Pending,this._tableMap={}}initTable(e){this._tableMap[e.name]=e,this._storage.setTable(e.name,e.columns,e.indexes)}get tables(){return Object.values(this._tableMap)}get status(){return this._status}set status(e){this._status=e}execute(e,t={}){if(e.command===Af.SELECT)return this._read(e);if(e.command===Af.INSERT||e.command===Af.UPDATE||e.command===Af.UPSERT||e.command===Af.DELETE||e.command===Af.BULK_INSERT||e.command===Af.MOVE_AFTER||e.command===Af.MOVE_BEFORE||e.command===Af.INSERT_AFTER||e.command===Af.INSERT_BEFORE)return t.slient?this._modelEvent.emitChangeWithSilent({spell:e}):this._modelEvent.emitChange({spell:e}),this._write(e);throw new Error(`${e.command} 指令没有实现驱动`)}_read(e){const t=this._driverRead.read(e);return this._parseRes(t)}_write(e){const t=this._driverWrite.write(e);return this._parseRes(t)}_parseRes(e){let t=0;return e?(t=Array.isArray(e)?e.length:1,{rows:e,rowCount:t}):{rows:[],rowCount:t}}};Gf([to(Nf)],Kf.prototype,"_storage",2),Gf([to(Df)],Kf.prototype,"_driverRead",2),Gf([to(Uf)],Kf.prototype,"_driverWrite",2),Gf([to(Rf)],Kf.prototype,"_modelEvent",2),Kf=Gf([eo({token:Of})],Kf);const qf=Fi.defineToken("ConfigurationToken");var Yf=Object.defineProperty,Xf=Object.getOwnPropertyDescriptor;let Zf=class{constructor(){this._store=new Set,this._isDestroyed=!1}_register(e){return this._store.add(e),e}destroy(){if(this._isDestroyed)return;const e=this._store.values();for(const t of e)!t||t.destroy();this._store.clear(),this._isDestroyed=!0}};Zf=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Xf(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Yf(t,r,o),o})([Qi()],Zf);class Jf{constructor(){this.destroy=()=>{},this.unset=()=>{},this.isset=()=>!1}set(e){let t=e;return this.unset=()=>t=void 0,this.isset=()=>void 0!==t,this.destroy=()=>{t&&(t(),t=void 0,this.unset=void 0,this.isset=void 0)},this}}var Qf;(e=>{function t(e){return{destroy:e}}e.is=function(e){return!!e&&"object"==typeof e&&"destroy"in e&&"function"==typeof e.destroy},e.create=t,e.NONE=t((()=>{}))})(Qf||(Qf={}));class ep{constructor(){this.destroyableList=[],this._isDisposing=!1}get destroyed(){return 0===this.destroyableList.length}destroy(){if(!this.destroyed&&!this._isDisposing){for(this._isDisposing=!0;!this.destroyed;)try{this.destroyableList.pop().destroy()}catch(e){console.error(e)}this._isDisposing=!1}}push(e){const{destroyableList:t}=this;t.push(e);const r=e.destroy.bind(e),n=Qf.create((()=>{const r=t.indexOf(e);-1!==r&&t.splice(r,1)}));return e.destroy=()=>{n.destroy(),r()},n}}class tp{constructor(e,t,r){this.callback=e,this.callbackThis=t,this.stack=r,this.subscription=new Jf}invoke(e){this.callback.call(this.callbackThis,e)}}class rp{constructor(e,t,r){this.emitter=e,this.listener=t,this.event=r}}class np{constructor(){this._queue=new ua}get size(){return this._queue.size}push(e,t,r){this._queue.push(new rp(e,t,r))}clear(e){const t=new ua;for(const r of this._queue)r.emitter!==e&&t.push(r);this._queue=t}deliver(){for(;this._queue.size>0;){const e=this._queue.shift();try{e.listener.invoke(e.event)}catch{}}}}class ip extends np{clear(e){this._queue.clear()}}class op extends Zf{constructor(){super(...arguments),this._disposed=!1}get event(){return this._event||(this._event=(e,t,r)=>{this._listeners||(this._listeners=new ua);const n=new tp(e,t,undefined),i=this._listeners.push(n),o=n.subscription.set((()=>{this._disposed||i()}));return Array.isArray(r)&&r.push(o),o}),this._event}get listeners(){return this._listeners?this._listeners:null}destroy(){var e;this._disposed||(this._disposed=!0,this._listeners&&this._listeners.clear(),null==(e=this._deliveryQueue)||e.clear(this))}emit(e){if(this._listeners){this._deliveryQueue||(this._deliveryQueue=new ip);for(const t of this._listeners)this._deliveryQueue.push(this,t,e);this._deliveryQueue.deliver()}}hasListeners(){return!!this._listeners&&!this._listeners.isEmpty()}}const ap=/\\(\\)?/g,sp=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var lp=Object.defineProperty,cp=Object.getOwnPropertyDescriptor;let up=class{constructor(){this._configurationProperties={}}getSchema(){return{title:"数据表配置列表",type:"object",properties:this._configurationProperties}}register(e){this._doRegister(e)}_doRegister(e){const t=e.id;if(!t)throw new Error(`配置不合法: ${JSON.stringify(e)}, configuration.id 是必填`);const r=t.split(".");if(1===r.length)this._configurationProperties[r[0]]=e;else{this._configurationProperties[r[0]]?this._configurationProperties[r[0]].properties||(this._configurationProperties[r[0]].properties={}):this._configurationProperties[r[0]]={id:r[0],type:"object",properties:{}};let t=this._configurationProperties[r[0]].properties;r.forEach(((n,i)=>{if(0!==i)if(t[n])t[n].properties||(t[n].properties={}),t=t[n].properties;else if(i===r.length-1)t[n]=e;else{const e=r.slice(i+1);t[n]={id:e.join("."),type:"object",properties:{}}}}))}}getProperty(e){const t=(e=>{const t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(sp,(function(e,r,n,i){t.push(n?i.replace(ap,"$1"):r||e)})),t})(e),[r,...n]=t;let i=this._configurationProperties[r],o=r;for(let e=0;e<n.length;e++){const t=n[e];if(o+="."+t,!i)return null;if(/^\d+$/g.test(t))i=null==i?void 0:i.items;else if(i.properties){const e=Object.keys(i.properties);let n=!1;for(let t=0;t<e.length;t++){const a=e[t],s=r+"."+a;if(s===o){i=i.properties[a],n=!0;break}if(s.startsWith(o)){n=!0;break}}if(n)continue;i=i.properties[t]}}return i}validate(e,t){return!!this.getProperty(e)}};up=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?cp(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&lp(t,r,o),o})([eo()],up);var dp=Object.defineProperty,fp=Object.getOwnPropertyDescriptor,pp=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?fp(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&dp(t,r,o),o};let hp=class extends Zf{constructor(){super(...arguments),this._defaultModel={},this._overrideModel={},this._onDidChange=this._register(new op),this.onDidChange=this._onDidChange.event}registerDefaultValue(e){const t=Object.keys(e);for(const r of t)this._configurationRegistry.validate(r,e[r]);for(const r of t)bd(this._defaultModel,r,e[r])}setValue(e,t){this._configurationRegistry.validate(e,t);const r=this.getValue(e);return So((()=>{this._onDidChange.emit({type:"valueChanged",path:e,pre:r,cur:t})})),bd(this._overrideModel,e,t)}getValue(e){if(!e)return this.getValues();this._configurationRegistry.validate(e);const t=Bl(this._overrideModel,e);return void 0!==t?t:Bl(this._defaultModel,e)}getValues(){return ud({},this._defaultModel,this._overrideModel)}destroy(){super.destroy()}};pp([to(up)],hp.prototype,"_configurationRegistry",2),pp([Si()],hp.prototype,"destroy",1),hp=pp([eo()],hp);var mp=Object.defineProperty,vp=Object.getOwnPropertyDescriptor,gp=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?vp(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&mp(t,r,o),o};let yp=class extends Zf{constructor(){super(...arguments),this._onConfigurationChange=this._register(new op),this.onConfigurationChange=this._onConfigurationChange.event}registerConfiguration(e){this._configurationRegistry.register(e)}registerDefaultValue(e){this._configurationModel.registerDefaultValue(e)}setValue(e,t){if("object"==typeof e){const t=Object.keys(e);for(const r of t)this._configurationModel.setValue(r,e[r])}else"string"==typeof e&&this._configurationModel.setValue(e,t);this._onConfigurationChange.emit({key:e,value:t})}getValue(e){return this._configurationModel.getValue(e)}getAllValues(){return this._configurationModel.getValues()}getSchema(){return this._configurationRegistry.getSchema()}onValueChange(e){this._configurationModel.onDidChange((t=>{"valueChanged"===t.type&&e(t)}))}destroy(){super.destroy()}};gp([to(up)],yp.prototype,"_configurationRegistry",2),gp([to(hp)],yp.prototype,"_configurationModel",2),gp([Si()],yp.prototype,"destroy",1),yp=gp([eo({token:qf})],yp);const bp=bo().register(up).register(hp).register(yp);var wp=Object.defineProperty,_p=Object.getOwnPropertyDescriptor,Cp=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?_p(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&wp(t,r,o),o};let Ep=class{constructor(){this._data={}}getIndexes(e){return this._data[e].indexes}setTable(e,t,r){this._data[e]||(this._data[e]={});const n=[];for(const e of t)e.uuid||(e.uuid=Io(32)),n.push(e);this._data[e].columns=n,this._data[e].indexes=r}dropTable(e){delete this._data[e]}setData(e,t){const r=this.getIndexes(e);for(const e of t){e.uuid||(e.uuid=Io(32));const t=new Date;e.created_at||(e.created_at=t),e.updated_at||(e.updated_at=t)}if(r){const n={};for(const e of t)if(2===r.length){const t=e[r[0]],i=e[r[1]];if(n[t]||(n[t]={[i]:[]}),n[t][i]||(n[t][i]=[]),n[t][i].find((t=>t.uuid===e.uuid)))continue;n[t][i].push(e)}else{const t=e[r[0]];n[t]||(n[t]=[]),n[t].push(e)}this._data[e].data=n}else this._data[e].data=t;return t}update(e,t,r){const n=this.getIndexes(e);let i=this._data[e].data;for(const o of t)if(n)if(i||(this._data[e].data={},i=this._data[e].data),2===n.length){const e=o[n[0]],t=o[n[1]],a=i[e][t].findIndex((e=>e.uuid===o.uuid));for(const e in r)o[e]=r[e];i[e][t].splice(a,1,o)}else{const e=o[n[0]],t=i[e].findIndex((e=>e.uuid===o.uuid));for(const e in r)o[e]=r[e];i[e].splice(t,1,o)}else{const e=i.findIndex((e=>e.uuid===o.uuid));for(const e in r)o[e]=r[e];i.splice(e,1,o)}}append(e,t,r){const n=this.getIndexes(e);let i=this._data[e].data;t.uuid||(t.uuid=Io(32));const o=new Date;if(t.created_at||(t.created_at=o),t.updated_at||(t.updated_at=o),n)if(i||(this._data[e].data={},i=this._data[e].data),2===n.length){const e=t[n[0]],o=t[n[1]];if(i[e]||(i[e]={[o]:[]}),i[e][o]||(i[e][o]=[]),r){const n=i[e][o].findIndex((e=>e.uuid===r.uuid));if(n>-1)return void i[e][o].splice(n+1,0,t)}if(i[e][o].find((e=>e.uuid===t.uuid)))return;i[e][o].push(t)}else{const e=t[n[0]];if(i[e]||(i[e]=[]),r){const o=i[r[n[0]]].findIndex((e=>e.uuid===r.uuid));if(o>-1)return void i[e].splice(o+1,0,t)}if(i[e].find((e=>e.uuid===t.uuid)))return;i[e].push(t)}else{if(i||(this._data[e].data=[],i=this._data[e].data),r){const e=i.findIndex((e=>e.uuid===r.uuid));if(e>-1)return void i.splice(e+1,0,t)}if(i.find((e=>e.uuid===t.uuid)))return;i.push(t)}}before(e,t,r){const n=this.getIndexes(e);let i=this._data[e].data;t.uuid||(t.uuid=Io(32));const o=new Date;if(t.created_at||(t.created_at=o),t.updated_at||(t.updated_at=o),n)if(i||(this._data[e].data={},i=this._data[e].data),2===n.length){const e=t[n[0]],o=t[n[1]];if(i[e]||(i[e]={[o]:[]}),i[e][o]||(i[e][o]=[]),r){const n=i[e][o].findIndex((e=>e.uuid===r.uuid));if(n>-1)return void i[e][o].splice(n,0,t)}if(i[e][o].find((e=>e.uuid===t.uuid)))return;i[e][o].unshift(t)}else{const e=t[n[0]];if(i[e]||(i[e]=[]),r){const o=i[r[n[0]]].findIndex((e=>e.uuid===r.uuid));if(o>-1)return void i[e].splice(o,0,t)}if(i[e].find((e=>e.uuid===t.uuid)))return;i[e].unshift(t)}else{if(i||(this._data[e].data=[],i=this._data[e].data),r){const e=i.findIndex((e=>e.uuid===r.uuid));if(e>-1)return void i.splice(e,0,t)}if(i.find((e=>e.uuid===t.uuid)))return;i.unshift(t)}}remove(e,t){const r=this.getIndexes(e);let n=this._data[e].data;for(const i of t)if(r)if(n||(this._data[e].data={},n=this._data[e].data),2===r.length){const e=i[r[0]],t=i[r[1]],o=n[e][t].findIndex((e=>e.uuid===i.uuid));n[e][t].splice(o,1)}else{const e=i[r[0]],t=n[e].findIndex((e=>e.uuid===i.uuid));n[e].splice(t,1)}else{const e=n.findIndex((e=>e.uuid===i.uuid));n.splice(e,1)}}getData(e,t){var r;let n=null==(r=this._data[e])?void 0:r.data;const i=this.getIndexes(e);return t?n=this._dataHelper.where(n,t,i):i&&(n=this._dataHelper.getDataByIndexes(n,t,i)),n||[]}getOriginData(e){var t;return null==(t=this._data[e])?void 0:t.data}getAll(){return this._data}clear(e){const t=this._configuration.getValue("model.frozenTable");return(e||Object.keys(this._data)).forEach((e=>{null!=t&&t.includes(e)||(this._data[e].data=null)})),this}};Cp([to(qf)],Ep.prototype,"_configuration",2),Cp([to(Lf)],Ep.prototype,"_dataHelper",2),Ep=Cp([eo({token:Nf})],Ep);const xp=Fi.defineToken("ModelContribution");var Sp=Object.defineProperty,kp=Object.getOwnPropertyDescriptor,Op=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?kp(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Sp(t,r,o),o};let Ip=class extends Zf{constructor(){super(...arguments),this._onChange=this._register(new op),this.onChange=this._onChange.event,this.emitChange=e=>{So((()=>{this._onChange.emit(e)}))},this._onChangeWithSlient=this._register(new op),this.onChangeWithSlient=this._onChange.event,this.emitChangeWithSilent=e=>{So((()=>{this._onChangeWithSlient.emit(e)}))}}destroy(){super.destroy()}};Op([Si()],Ip.prototype,"destroy",1),Ip=Op([eo({token:Rf})],Ip);var Rp=Object.defineProperty,Tp=Object.getOwnPropertyDescriptor,Ap=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Tp(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Rp(t,r,o),o};let Np=class{constructor(){this._modelMap=new Map}init(e=[]){const t=this._modelProvider.getContributions();for(const r of t)try{r.registerModel&&e.push(r.registerModel()),r.registerModels&&(e=e.concat(r.registerModels()))}catch(e){console.error(e)}for(const t of e)this._initTable(t),this._modelMap.set(t.table,t)}getModel(e){return this._modelMap.get(e)}_initTable(e){if(!e.table)throw new Error("Model must have a name");const t=e.columns||{};return t.uuid={name:"uuid"},t.created_at={name:"created_at"},t.updated_at={name:"updated_at"},this._driver.initTable({name:e.table,indexes:e.indexes,columns:t?Object.keys(t).map((e=>t[e])):[]}),this}};Ap([Eo(xp)],Np.prototype,"_modelProvider",2),Ap([to(Of)],Np.prototype,"_driver",2),Np=Ap([eo()],Np);var Mp=Object.defineProperty,Pp=Object.getOwnPropertyDescriptor,jp=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Pp(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Mp(t,r,o),o};let Dp=class{init(e){this._configuration.registerConfiguration({id:"model",type:"object",title:"数据模型",properties:{frozenTable:{type:"array",description:"固化表，普通刷新不清空内容"}}}),this._modelRegistry.init(null==e?void 0:e.models)}};function Fp(e,t){const{Model:r}=e,n={};for(const e in t){const i=r.columns[e],o=t[e];!i||(i.type?n[e]=i.type.toValue(o):n[e]=o)}return n}function Vp(e,t){let r;if(Array.isArray(t)){r=[];for(const n of t)r.push(Fp(e,n))}else r=Fp(e,t);return r}jp([to(qf)],Dp.prototype,"_configuration",2),jp([to(Np)],Dp.prototype,"_modelRegistry",2),Dp=jp([eo({token:Tf})],Dp);class Lp{constructor(e,t,r){this.sets=[],this.groups=[],this.orders=[],this.offset=0,this.Model=e,this.table=e.table,this.command=Af.SELECT,this._driver=t,this._executeOpts=r}execute(){if(!this._driver)return;let e=this._driver.execute(this.toObject(),this._executeOpts);return e={...e,spell:this},e}$insert(e){return this.command=Af.INSERT,this.sets=Vp(this,e),this}$update(e){return this.command=Af.UPDATE,this.sets=Vp(this,e),this}$upsert(e){return this.command=Af.UPSERT,this.sets=Vp(this,e),this}$delete(){return this.command=Af.DELETE,this}$bulkInsert(e){return this.command=Af.BULK_INSERT,this.sets=Vp(this,e),this}$insertAfter(e){return this.command=Af.INSERT_AFTER,this.sets=Vp(this,e),this}$insertBefore(e){return this.command=Af.INSERT_BEFORE,this.sets=Vp(this,e),this}$moveAfter(e){return this.command=Af.MOVE_AFTER,this.sets=Vp(this,e),this}$moveBefore(e){return this.command=Af.MOVE_BEFORE,this.sets=Vp(this,e),this}$where(e){return this.where=e,this}$offset(e){if(Number.isNaN(e))throw new Error(`invalid offset ${e}`);return this.offset=e,this}$limit(e){if(Number.isNaN(e))throw new Error(`invalid limit ${e}`);return this.limit=e,this}toObject(){return{table:this.table,command:this.command,where:this.where,sets:this.sets,offset:this.offset,limit:this.limit}}}function $p(e,t){if(null!=e&&null!=t){for(const r in t){const n=e[r],{defaultValue:i}=t[r];void 0===n&&null!=i&&(e[r]=i)}return e}}class Bp{constructor(e,t){this.timestamps={updatedAt:"updated_at",createdAt:"created_at"},this.Model=e,this.driver=t}count(...e){return this.find(...e).length}find(e,t){const r=new Lp(this.Model,this.driver);if(r.$where(e),t)for(const e of["order","limit","offset","select"]){const n=t[e];null!=n&&r[`$${e}`](n)}const n=r.execute();return null!=n&&n.rows&&0!==n.rows.length?n.rows.map((e=>e)):[]}findOne(e){const t=this.find(e);return t[0]?t[0]:null}findById(e){const t={uuid:e},r=this.find(t);return r[0]?r[0]:null}remove(e){return new Lp(this.Model,this.driver).$where(e).$delete().execute().affectedRows}update(e,t={},r={}){var n;const{updatedAt:i}=this.timestamps,o=Object.assign({},t);return(null==(n=this.Model.columns)?void 0:n[i])&&!o[i]&&!r.silent&&(o[i]=new Date),new Lp(this.Model,this.driver,r).$where(e).$update(o).execute().rows}upsert(e,t,r){var n;const{updatedAt:i}=this.timestamps,o=Object.assign({},t);(null==(n=this.Model.columns)?void 0:n[i])&&!o[i]&&(o[i]=new Date);const a=new Lp(this.Model,this.driver,r).$where(e).$upsert(o).execute();return null==a?void 0:a.rows}bulkCreate(e,t={}){if(!e||!e.length)return e;const{columns:r}=this,{createdAt:n,updatedAt:i}=this.timestamps,o=new Date;for(const t of e)n&&(t[n]=o),i&&(t[i]=o),$p(t,r);return t={...t,columns:r},new Lp(this.Model,this.driver).$bulkInsert(e).execute(),e}moveAfter(e,t){const r=Object.assign({},t);return new Lp(this.Model,this.driver).$where(e).$moveAfter(r).execute().rows}moveBefore(e,t){const r=Object.assign({},t);return new Lp(this.Model,this.driver).$where(e).$moveBefore(r).execute().rows}create(e){const t=new Lp(this.Model,this.driver).$insert(this._getCreateValue(e)).execute();return null==t?void 0:t.rows}createAfter(e,t={}){const r=Object.assign({},t);return new Lp(this.Model,this.driver).$where(e).$insertAfter(this._getCreateValue(r)).execute().rows}createBefore(e,t={}){const r=Object.assign({},t);return new Lp(this.Model,this.driver).$where(e).$insertBefore(this._getCreateValue(r)).execute().rows}_getCreateValue(e){const{columns:t}=this.Model,{createdAt:r,updatedAt:n}=this.timestamps,i={},o=new Date;null!=t&&t[r]&&(this[r]=o),null!=t&&t[n]&&(this[n]=o);for(const r in t){const n=e[r],{defaultValue:o}=t[r];null!=n?i[r]=n:void 0===n&&null!=o&&(i[r]=o)}return i}}var zp=Object.defineProperty,Up=Object.getOwnPropertyDescriptor,Hp=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Up(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&zp(t,r,o),o};let Wp=class{getModel(e){const t=this._modelRegistry.getModel(e);return new Bp(t,this._driver)}};Hp([to(Np)],Wp.prototype,"_modelRegistry",2),Hp([to(Of)],Wp.prototype,"_driver",2),Wp=Hp([eo()],Wp);const Gp=bo().contribution(xp).register(Kf).register(Df).register(Uf).register(Lf).register(Ep).register(Ip).register(Dp).register(Wp).register(Np);function Kp(e={}){return function(t,r){const n=t.constructor;n.columns||(n.columns={}),n.columns[r]={...e,name:r}}}class qp{}var Yp={};Yp.deprecate=(e,t)=>{let r=!0;return function(){return r&&(console.warn("DeprecationWarning: "+t),r=!1),e.apply(this,arguments)}};const Xp=Yp.deprecate((()=>{}),"Hook.context is deprecated and will be removed"),Zp=function(...e){return this.call=this._createCall("sync"),this.call(...e)},Jp=function(...e){return this.callAsync=this._createCall("async"),this.callAsync(...e)},Qp=function(...e){return this.promise=this._createCall("promise"),this.promise(...e)};class eh{constructor(e=[],t=void 0){this._args=e,this.name=t,this.taps=[],this.interceptors=[],this._call=Zp,this.call=Zp,this._callAsync=Jp,this.callAsync=Jp,this._promise=Qp,this.promise=Qp,this._x=void 0,this.compile=this.compile,this.tap=this.tap,this.tapAsync=this.tapAsync,this.tapPromise=this.tapPromise}compile(e){throw new Error("Abstract: should be overridden")}_createCall(e){return this.compile({taps:this.taps,interceptors:this.interceptors,args:this._args,type:e})}_tap(e,t,r){if("string"==typeof t)t={name:t.trim()};else if("object"!=typeof t||null===t)throw new Error("Invalid tap options");if("string"!=typeof t.name||""===t.name)throw new Error("Missing name for tap");typeof t.context<"u"&&Xp(),t=Object.assign({type:e,fn:r},t),t=this._runRegisterInterceptors(t),this._insert(t)}tap(e,t){this._tap("sync",e,t)}tapAsync(e,t){this._tap("async",e,t)}tapPromise(e,t){this._tap("promise",e,t)}_runRegisterInterceptors(e){for(const t of this.interceptors)if(t.register){const r=t.register(e);void 0!==r&&(e=r)}return e}withOptions(e){const t=t=>Object.assign({},e,"string"==typeof t?{name:t}:t);return{name:this.name,tap:(e,r)=>this.tap(t(e),r),tapAsync:(e,r)=>this.tapAsync(t(e),r),tapPromise:(e,r)=>this.tapPromise(t(e),r),intercept:e=>this.intercept(e),isUsed:()=>this.isUsed(),withOptions:e=>this.withOptions(t(e))}}isUsed(){return this.taps.length>0||this.interceptors.length>0}intercept(e){if(this._resetCompilation(),this.interceptors.push(Object.assign({},e)),e.register)for(let t=0;t<this.taps.length;t++)this.taps[t]=e.register(this.taps[t])}_resetCompilation(){this.call=this._call,this.callAsync=this._callAsync,this.promise=this._promise}_insert(e){let t;this._resetCompilation(),"string"==typeof e.before?t=new Set([e.before]):Array.isArray(e.before)&&(t=new Set(e.before));let r=0;"number"==typeof e.stage&&(r=e.stage);let n=this.taps.length;for(;n>0;){n--;const e=this.taps[n];this.taps[n+1]=e;const i=e.stage||0;if(t){if(t.has(e.name)){t.delete(e.name);continue}if(t.size>0)continue}if(!(i>r)){n++;break}}this.taps[n]=e}}Object.setPrototypeOf(eh.prototype,null);var th=eh;var rh=class{constructor(e){this.config=e,this.options=void 0,this._args=void 0}create(e){let t;switch(this.init(e),this.options.type){case"sync":t=new Function(this.args(),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:e=>`throw ${e};\n`,onResult:e=>`return ${e};\n`,resultReturns:!0,onDone:()=>"",rethrowIfPossible:!0}));break;case"async":t=new Function(this.args({after:"_callback"}),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:e=>`_callback(${e});\n`,onResult:e=>`_callback(null, ${e});\n`,onDone:()=>"_callback();\n"}));break;case"promise":let e=!1;const r=this.contentWithInterceptors({onError:t=>(e=!0,`_error(${t});\n`),onResult:e=>`_resolve(${e});\n`,onDone:()=>"_resolve();\n"});let n="";n+='"use strict";\n',n+=this.header(),n+="return new Promise((function(_resolve, _reject) {\n",e&&(n+="var _sync = true;\n",n+="function _error(_err) {\n",n+="if(_sync)\n",n+="_resolve(Promise.resolve().then((function() { throw _err; })));\n",n+="else\n",n+="_reject(_err);\n",n+="};\n"),n+=r,e&&(n+="_sync = false;\n"),n+="}));\n",t=new Function(this.args(),n)}return this.deinit(),t}setup(e,t){e._x=t.taps.map((e=>e.fn))}init(e){this.options=e,this._args=e.args.slice()}deinit(){this.options=void 0,this._args=void 0}contentWithInterceptors(e){if(this.options.interceptors.length>0){const t=e.onError,r=e.onResult,n=e.onDone;let i="";for(let e=0;e<this.options.interceptors.length;e++){const t=this.options.interceptors[e];t.call&&(i+=`${this.getInterceptor(e)}.call(${this.args({before:t.context?"_context":void 0})});\n`)}return i+=this.content(Object.assign(e,{onError:t&&(e=>{let r="";for(let t=0;t<this.options.interceptors.length;t++)this.options.interceptors[t].error&&(r+=`${this.getInterceptor(t)}.error(${e});\n`);return r+=t(e),r}),onResult:r&&(e=>{let t="";for(let r=0;r<this.options.interceptors.length;r++)this.options.interceptors[r].result&&(t+=`${this.getInterceptor(r)}.result(${e});\n`);return t+=r(e),t}),onDone:n&&(()=>{let e="";for(let t=0;t<this.options.interceptors.length;t++)this.options.interceptors[t].done&&(e+=`${this.getInterceptor(t)}.done();\n`);return e+=n(),e})})),i}return this.content(e)}header(){let e="";return this.needContext()?e+="var _context = {};\n":e+="var _context;\n",e+="var _x = this._x;\n",this.options.interceptors.length>0&&(e+="var _taps = this.taps;\n",e+="var _interceptors = this.interceptors;\n"),e}needContext(){for(const e of this.options.taps)if(e.context)return!0;return!1}callTap(e,{onError:t,onResult:r,onDone:n,rethrowIfPossible:i}){let o="",a=!1;for(let t=0;t<this.options.interceptors.length;t++){const r=this.options.interceptors[t];r.tap&&(a||(o+=`var _tap${e} = ${this.getTap(e)};\n`,a=!0),o+=`${this.getInterceptor(t)}.tap(${r.context?"_context, ":""}_tap${e});\n`)}o+=`var _fn${e} = ${this.getTapFn(e)};\n`;const s=this.options.taps[e];switch(s.type){case"sync":i||(o+=`var _hasError${e} = false;\n`,o+="try {\n"),o+=r?`var _result${e} = _fn${e}(${this.args({before:s.context?"_context":void 0})});\n`:`_fn${e}(${this.args({before:s.context?"_context":void 0})});\n`,i||(o+="} catch(_err) {\n",o+=`_hasError${e} = true;\n`,o+=t("_err"),o+="}\n",o+=`if(!_hasError${e}) {\n`),r&&(o+=r(`_result${e}`)),n&&(o+=n()),i||(o+="}\n");break;case"async":let a="";a+=r?`(function(_err${e}, _result${e}) {\n`:`(function(_err${e}) {\n`,a+=`if(_err${e}) {\n`,a+=t(`_err${e}`),a+="} else {\n",r&&(a+=r(`_result${e}`)),n&&(a+=n()),a+="}\n",a+="})",o+=`_fn${e}(${this.args({before:s.context?"_context":void 0,after:a})});\n`;break;case"promise":o+=`var _hasResult${e} = false;\n`,o+=`var _promise${e} = _fn${e}(${this.args({before:s.context?"_context":void 0})});\n`,o+=`if (!_promise${e} || !_promise${e}.then)\n`,o+=`  throw new Error('Tap function (tapPromise) did not return promise (returned ' + _promise${e} + ')');\n`,o+=`_promise${e}.then((function(_result${e}) {\n`,o+=`_hasResult${e} = true;\n`,r&&(o+=r(`_result${e}`)),n&&(o+=n()),o+=`}), function(_err${e}) {\n`,o+=`if(_hasResult${e}) throw _err${e};\n`,o+=t(`_err${e}`),o+="});\n"}return o}callTapsSeries({onError:e,onResult:t,resultReturns:r,onDone:n,doneReturns:i,rethrowIfPossible:o}){if(0===this.options.taps.length)return n();const a=this.options.taps.findIndex((e=>"sync"!==e.type)),s=r||i;let l="",c=n,u=0;for(let r=this.options.taps.length-1;r>=0;r--){const i=r;c!==n&&("sync"!==this.options.taps[i].type||u++>20)&&(u=0,l+=`function _next${i}() {\n`,l+=c(),l+="}\n",c=()=>`${s?"return ":""}_next${i}();\n`);const d=c,f=e=>e?"":n(),p=this.callTap(i,{onError:t=>e(i,t,d,f),onResult:t&&(e=>t(i,e,d,f)),onDone:!t&&d,rethrowIfPossible:o&&(a<0||i<a)});c=()=>p}return l+=c(),l}callTapsLooping({onError:e,onDone:t,rethrowIfPossible:r}){if(0===this.options.taps.length)return t();const n=this.options.taps.every((e=>"sync"===e.type));let i="";n||(i+="var _looper = (function() {\n",i+="var _loopAsync = false;\n"),i+="var _loop;\n",i+="do {\n",i+="_loop = false;\n";for(let e=0;e<this.options.interceptors.length;e++){const t=this.options.interceptors[e];t.loop&&(i+=`${this.getInterceptor(e)}.loop(${this.args({before:t.context?"_context":void 0})});\n`)}return i+=this.callTapsSeries({onError:e,onResult:(e,t,r,i)=>{let o="";return o+=`if(${t} !== undefined) {\n`,o+="_loop = true;\n",n||(o+="if(_loopAsync) _looper();\n"),o+=i(!0),o+="} else {\n",o+=r(),o+="}\n",o},onDone:t&&(()=>{let e="";return e+="if(!_loop) {\n",e+=t(),e+="}\n",e}),rethrowIfPossible:r&&n}),i+="} while(_loop);\n",n||(i+="_loopAsync = true;\n",i+="});\n",i+="_looper();\n"),i}callTapsParallel({onError:e,onResult:t,onDone:r,rethrowIfPossible:n,onTap:i=((e,t)=>t())}){if(this.options.taps.length<=1)return this.callTapsSeries({onError:e,onResult:t,onDone:r,rethrowIfPossible:n});let o="";o+="do {\n",o+=`var _counter = ${this.options.taps.length};\n`,r&&(o+="var _done = (function() {\n",o+=r(),o+="});\n");for(let a=0;a<this.options.taps.length;a++){const s=()=>r?"if(--_counter === 0) _done();\n":"--_counter;",l=e=>e||!r?"_counter = 0;\n":"_counter = 0;\n_done();\n";o+="if(_counter <= 0) break;\n",o+=i(a,(()=>this.callTap(a,{onError:t=>{let r="";return r+="if(_counter > 0) {\n",r+=e(a,t,s,l),r+="}\n",r},onResult:t&&(e=>{let r="";return r+="if(_counter > 0) {\n",r+=t(a,e,s,l),r+="}\n",r}),onDone:!t&&(()=>s()),rethrowIfPossible:n})),s,l)}return o+="} while(false);\n",o}args({before:e,after:t}={}){let r=this._args;return e&&(r=[e].concat(r)),t&&(r=r.concat(t)),0===r.length?"":r.join(", ")}getTapFn(e){return`_x[${e}]`}getTap(e){return`_taps[${e}]`}getInterceptor(e){return`_interceptors[${e}]`}};const nh=th,ih=rh;const oh=new class extends ih{content({onError:e,onDone:t,rethrowIfPossible:r}){return this.callTapsSeries({onError:(t,r)=>e(r),onDone:t,rethrowIfPossible:r})}},ah=()=>{throw new Error("tapAsync is not supported on a SyncHook")},sh=()=>{throw new Error("tapPromise is not supported on a SyncHook")},lh=function(e){return oh.setup(this,e),oh.create(e)};function ch(e=[],t=void 0){const r=new nh(e,t);return r.constructor=ch,r.tapAsync=ah,r.tapPromise=sh,r.compile=lh,r}ch.prototype=null;var uh=ch;const dh=rh;new class extends dh{content({onError:e,onResult:t,resultReturns:r,onDone:n,rethrowIfPossible:i}){return this.callTapsSeries({onError:(t,r)=>e(r),onResult:(e,r,n)=>`if(${r} !== undefined) {\n${t(r)};\n} else {\n${n()}}\n`,resultReturns:r,onDone:n,rethrowIfPossible:i})}};const fh=rh;new class extends fh{content({onError:e,onResult:t,resultReturns:r,rethrowIfPossible:n}){return this.callTapsSeries({onError:(t,r)=>e(r),onResult:(e,t,r)=>{let n="";return n+=`if(${t} !== undefined) {\n`,n+=`${this._args[0]} = ${t};\n`,n+="}\n",n+=r(),n},onDone:()=>t(this._args[0]),doneReturns:r,rethrowIfPossible:n})}};const ph=rh;new class extends ph{content({onError:e,onDone:t,rethrowIfPossible:r}){return this.callTapsLooping({onError:(t,r)=>e(r),onDone:t,rethrowIfPossible:r})}};const hh=th,mh=rh;const vh=new class extends mh{content({onError:e,onDone:t}){return this.callTapsParallel({onError:(t,r,n,i)=>e(r)+i(!0),onDone:t})}},gh=function(e){return vh.setup(this,e),vh.create(e)};function yh(e=[],t=void 0){const r=new hh(e,t);return r.constructor=yh,r.compile=gh,r._call=void 0,r.call=void 0,r}yh.prototype=null;var bh=yh;const wh=rh;new class extends wh{content({onError:e,onResult:t,onDone:r}){let n="";return n+=`var _results = new Array(${this.options.taps.length});\n`,n+="var _checkDone = function() {\n",n+="for(var i = 0; i < _results.length; i++) {\n",n+="var item = _results[i];\n",n+="if(item === undefined) return false;\n",n+="if(item.result !== undefined) {\n",n+=t("item.result"),n+="return true;\n",n+="}\n",n+="if(item.error) {\n",n+=e("item.error"),n+="return true;\n",n+="}\n",n+="}\n",n+="return false;\n",n+="}\n",n+=this.callTapsParallel({onError:(e,t,r,n)=>{let i="";return i+=`if(${e} < _results.length && ((_results.length = ${e+1}), (_results[${e}] = { error: ${t} }), _checkDone())) {\n`,i+=n(!0),i+="} else {\n",i+=r(),i+="}\n",i},onResult:(e,t,r,n)=>{let i="";return i+=`if(${e} < _results.length && (${t} !== undefined && (_results.length = ${e+1}), (_results[${e}] = { result: ${t} }), _checkDone())) {\n`,i+=n(!0),i+="} else {\n",i+=r(),i+="}\n",i},onTap:(e,t,r,n)=>{let i="";return e>0&&(i+=`if(${e} >= _results.length) {\n`,i+=r(),i+="} else {\n"),i+=t(),e>0&&(i+="}\n"),i},onDone:r}),n}};const _h=rh;new class extends _h{content({onError:e,onDone:t}){return this.callTapsSeries({onError:(t,r,n,i)=>e(r)+i(!0),onDone:t})}};const Ch=rh;new class extends Ch{content({onError:e,onResult:t,resultReturns:r,onDone:n}){return this.callTapsSeries({onError:(t,r,n,i)=>e(r)+i(!0),onResult:(e,r,n)=>`if(${r} !== undefined) {\n${t(r)}\n} else {\n${n()}}\n`,resultReturns:r,onDone:n})}};const Eh=rh;new class extends Eh{content({onError:e,onDone:t}){return this.callTapsLooping({onError:(t,r,n,i)=>e(r)+i(!0),onDone:t})}};const xh=rh;new class extends xh{content({onError:e,onResult:t,onDone:r}){return this.callTapsSeries({onError:(t,r,n,i)=>e(r)+i(!0),onResult:(e,t,r)=>{let n="";return n+=`if(${t} !== undefined) {\n`,n+=`${this._args[0]} = ${t};\n`,n+="}\n",n+=r(),n},onDone:()=>t(this._args[0])})}};const Sh=Yp;Sh.deprecate((function(e,t,r){return this.for(e).tap(t,r)}),"HookMap#tap(key,…) is deprecated. Use HookMap#for(key).tap(…) instead."),Sh.deprecate((function(e,t,r){return this.for(e).tapAsync(t,r)}),"HookMap#tapAsync(key,…) is deprecated. Use HookMap#for(key).tapAsync(…) instead."),Sh.deprecate((function(e,t,r){return this.for(e).tapPromise(t,r)}),"HookMap#tapPromise(key,…) is deprecated. Use HookMap#for(key).tapPromise(…) instead.");const kh=bh,Oh=uh;class Ih extends Zf{constructor(){super(...arguments),this._Plugin=new Map,this._unregisterToDestroy=new ep}registerPlugins(e,t){!Array.isArray(e)||e.forEach((e=>{const r=e.pluginName;if(!r)throw new Error('static property "pluginName" in Plugin is required!'+e);if(this._Plugin.get(r))throw Error(`Plugin "${r}" has been registered`);if(!e.pluginModule)throw Error('static property "pluginModule" in Plugin is required!'+e);const n=e.pluginModule(),i=t.container.load(n);this._unregisterToDestroy.push({destroy:i.dispose}),this._Plugin.set(r,e)}))}unregisterPlugins(e){!this._Plugin.size||(this._unregisterToDestroy.destroy(),this._Plugin.clear())}}var Rh=(e=>(e.TEXT="text",e.NUMBER="number",e.SELECT="select",e.MULTI_SELECT="multiSelect",e.DATE="date",e.MENTION="mention",e.IMAGE="image",e.FILE="file",e.CHECKBOX="checkbox",e.LINK="link",e.EMAIL="email",e.PHONE="phone",e.CREATED_AT="createdAt",e.UPDATED_AT="updatedAt",e.USER_ID="userId",e.MODIFIER_ID="modifierId",e.TITLE="title",e))(Rh||{}),Th=(e=>(e.STRING="string",e.NUMBER="number",e.SELECT="select",e.URI="uri",e.BOOLEAN="boolean",e.DATE="date",e.SYSTEM="system",e))(Th||{});const Ah={text:"string",email:"string",phone:"string",title:"string",select:"select",multiSelect:"select",number:"number",date:"date",mention:"uri",image:"uri",file:"uri",link:"uri",checkbox:"boolean",createdAt:"system",updatedAt:"system",userId:"system",modifierId:"system"};Object.values(Rh);const Nh=[{name:"文本",type:Rh.TEXT},{name:"单选",type:Rh.SELECT,color:!0,options:[{name:"待开始",color:"#FBD3D0"},{name:"进行中",color:"#E4F7D2"},{name:"已完成",color:"#F7E9BC"}]},{name:"日期",type:Rh.DATE}],Mh=[{type:Rh.TITLE,name:kf("标题")},{type:Rh.TEXT,name:kf("文本")},{type:Rh.NUMBER,name:kf("数字")},{type:Rh.SELECT,name:kf("单选")},{type:Rh.MULTI_SELECT,name:kf("多选")},{type:Rh.DATE,name:kf("日期")},{type:Rh.MENTION,name:kf("人员")},{type:Rh.IMAGE,name:kf("图片"),disableGroup:!0,disableSort:!0},{type:Rh.FILE,name:kf("附件"),disableGroup:!0,disableSort:!0},{type:Rh.CHECKBOX,name:kf("复选框")},{type:Rh.LINK,name:kf("链接")},{type:Rh.EMAIL,name:kf("邮箱")},{type:Rh.PHONE,name:kf("手机号码")},{type:Rh.USER_ID,name:kf("创建人"),isAdvanced:!0,disableForm:!0},{type:Rh.CREATED_AT,name:kf("创建时间"),isAdvanced:!0,disableGroup:!0,disableForm:!0},{type:Rh.MODIFIER_ID,name:kf("修改人"),isAdvanced:!0,disableForm:!0},{type:Rh.UPDATED_AT,name:kf("修改时间"),isAdvanced:!0,disableGroup:!0,disableForm:!0}];function Ph(e,t){const r={};Mh.forEach((e=>{r[e.type]=e.name}));const n=r[e],i=t.map((e=>e.name));let o=1,a=n;for(;i.includes(a);)a=`${n} ${o}`,o+=1;return a}function jh(e){const t=Mh.find((t=>t.type===e));return(null==t?void 0:t.name)||""}Fi.defineToken("KernelModelToken");var Dh=(e=>(e[e.ACTIVE=0]="ACTIVE",e[e.INACTIVE=1]="INACTIVE",e))(Dh||{}),Fh=(e=>(e.equalTo="equalTo",e.notEqualTo="notEqualTo",e.greaterThan="greaterThan",e.greaterThanOrEqualTo="greaterThanOrEqualTo",e.lessThan="lessThan",e.lessThanOrEqualTo="lessThanOrEqualTo",e.isEmpty="isEmpty",e.isNotEmpty="isNotEmpty",e.startsWith="startsWith",e.notStartsWith="notStartsWith",e.endsWith="endsWith",e.notEndsWith="notEndsWith",e.contains="contains",e.notContains="notContains",e.yesterday="yesterday",e.today="today",e.tomorrow="tomorrow",e.last7days="last7days",e.lastWeek="lastWeek",e.thisWeek="thisWeek",e.nextWeek="nextWeek",e.lastMonth="lastMonth",e.thisMonth="thisMonth",e.nextMonth="nextMonth",e.is="is",e.isNot="isNot",e.isEmptySelect="isEmptySelect",e.isNotEmptySelect="isNotEmptySelect",e.isExactly="isExactly",e.hasAnyOf="hasAnyOf",e.hasAllOf="hasAllOf",e.hasNoneOf="hasNoneOf",e))(Fh||{}),Vh=(e=>(e.And="and",e.Or="or",e))(Vh||{}),Lh=(e=>(e.Clip="clip",e.Fit="fit",e))(Lh||{}),$h=(e=>(e.LOW="low",e.MIDDLE="middle",e.HIGH="high",e))($h||{}),Bh=(e=>(e.COUNT="count",e.SUM="sum",e.AVERAGE="average",e.MAX="max",e.MIN="mix",e.FILLED="filled",e.EMPTY="empty",e.UNIQUE="unique",e.PERCENT_EMPTY="percentEmpty",e.PERCENT_FILLED="percentFilled",e.PERCENT_UNIQUE="percentUnique",e.EARLIEST_DATE="earliestDate",e.LATEST_DATE="latestDate",e.DATE_RANGE="dateRange",e.MONTH_RANGE="monthRange",e.CHECKED="checked",e.UNCHECKED="unchecked",e.PERCENT_CHECKED="percentChecked",e.PERCENT_UNCHECKED="percentUnchecked",e))(Bh||{});const zh=[{type:"number",func:Fh.equalTo,text:kf("等于")},{type:"number",func:Fh.notEqualTo,text:kf("不等于")},{type:"number",func:Fh.greaterThan,text:kf("大于")},{type:"number",func:Fh.greaterThanOrEqualTo,text:kf("大于等于")},{type:"number",func:Fh.lessThan,text:kf("小于")},{type:"number",func:Fh.lessThanOrEqualTo,text:kf("小于等于")},{type:"number",func:Fh.isEmpty,text:kf("为空")},{type:"number",func:Fh.isNotEmpty,text:kf("非空")},{type:"text",func:Fh.startsWith,text:kf("开头是")},{type:"text",func:Fh.notStartsWith,text:kf("开头不是")},{type:"text",func:Fh.endsWith,text:kf("结尾是")},{type:"text",func:Fh.notEndsWith,text:kf("结尾不是")},{type:"text",func:Fh.contains,text:kf("包含")},{type:"text",func:Fh.notContains,text:kf("不包含")},{type:"text",func:Fh.isEmpty,text:kf("为空")},{type:"text",func:Fh.isNotEmpty,text:kf("非空")},{type:"timePeriod",func:Fh.yesterday,text:kf("昨天")},{type:"timePeriod",func:Fh.today,text:kf("今天")},{type:"timePeriod",func:Fh.tomorrow,text:kf("明天")},{type:"timePeriod",func:Fh.last7days,text:kf("过去7天")},{type:"timePeriod",func:Fh.lastWeek,text:kf("上周")},{type:"timePeriod",func:Fh.thisWeek,text:kf("本周")},{type:"timePeriod",func:Fh.nextWeek,text:kf("下周")},{type:"timePeriod",func:Fh.lastMonth,text:kf("上月")},{type:"timePeriod",func:Fh.thisMonth,text:kf("本月")},{type:"timePeriod",func:Fh.nextMonth,text:kf("下月")},{type:"timePeriod",func:Fh.isEmpty,text:kf("为空")},{type:"timePeriod",func:Fh.isNotEmpty,text:kf("非空")},{type:"select",func:Fh.is,text:kf("是")},{type:"select",func:Fh.isNot,text:kf("不是")},{type:"select",func:Fh.isEmptySelect,text:kf("为空")},{type:"select",func:Fh.isNotEmptySelect,text:kf("非空")},{type:"multiSelect",func:Fh.isExactly,text:kf("是")},{type:"multiSelect",func:Fh.isNot,text:kf("不是")},{type:"multiSelect",func:Fh.hasAnyOf,text:kf("包含一个")},{type:"multiSelect",func:Fh.hasAllOf,text:kf("包含所有")},{type:"multiSelect",func:Fh.hasNoneOf,text:kf("不包含")},{type:"multiSelect",func:Fh.isEmptySelect,text:kf("为空")},{type:"multiSelect",func:Fh.isNotEmptySelect,text:kf("非空")},{type:"checkbox",func:Fh.equalTo,text:kf("等于")},{type:"file",func:Fh.isEmpty,text:kf("为空")},{type:"file",func:Fh.isNotEmpty,text:kf("非空")}],Uh={[Rh.TITLE]:"text",[Rh.TEXT]:"text",[Rh.LINK]:"text",[Rh.EMAIL]:"text",[Rh.PHONE]:"text",[Rh.DATE]:"timePeriod",[Rh.CREATED_AT]:"timePeriod",[Rh.UPDATED_AT]:"timePeriod",[Rh.NUMBER]:"number",[Rh.SELECT]:"select",[Rh.MULTI_SELECT]:"multiSelect",[Rh.MENTION]:"multiSelect",[Rh.USER_ID]:"select",[Rh.MODIFIER_ID]:"select",[Rh.CHECKBOX]:"checkbox",[Rh.IMAGE]:"file",[Rh.FILE]:"file"},Hh=["isEmpty","isNotEmpty","yesterday","today","tomorrow","last7days","lastWeek","thisWeek","nextWeek","lastMonth","thisMonth","nextMonth","duplicate","unique","isEmptySelect","isNotEmptySelect"];var Wh=(e=>(e.GRID="GRID",e.CARD="CARD",e.KANBAN="KANBAN",e.FORM="FORM",e))(Wh||{});Object.values(Wh);const Gh={GRID:{type:"GRID",name:kf("表格视图")},CARD:{type:"CARD",name:kf("画册视图"),showFiledName:!1,cover:!0,coverDisplay:Lh.Clip},KANBAN:{type:"KANBAN",name:kf("看板视图"),showFiledName:!1},FORM:{type:"FORM",name:kf("表单")}};Lh.Clip,Lh.Fit;class Kh{static isBoolean(e){return e===Rh.CHECKBOX}static isDate(e){return e===Rh.DATE}static isSystemDate(e){return e===Rh.CREATED_AT||e===Rh.UPDATED_AT}static isNumber(e){return e===Rh.NUMBER}static isSelectLike(e){return e===Rh.SELECT||e===Rh.MULTI_SELECT}static isSelect(e){return e===Rh.SELECT}static isMultiSelect(e){return e===Rh.MULTI_SELECT}static isSystemType(e){return e===Rh.CREATED_AT||e===Rh.UPDATED_AT||e===Rh.USER_ID||e===Rh.MODIFIER_ID}static isCreateDisable(e){return e===Rh.TITLE}static isTransformDisable(e){return e===Rh.TITLE}static isDeleteDisable(e){return e===Rh.TITLE}static isSystemUser(e){return e===Rh.USER_ID||e===Rh.MODIFIER_ID}static isString(e){return e===Rh.TITLE||e===Rh.TEXT||e===Rh.EMAIL||e===Rh.PHONE}static isUri(e){return e===Rh.IMAGE||e===Rh.FILE||e===Rh.MENTION||e===Rh.LINK}static isLink(e){return e===Rh.LINK}static isMultiple(e){return e===Rh.MULTI_SELECT||e===Rh.IMAGE||e===Rh.FILE||e===Rh.MENTION}static isMention(e){return e===Rh.MENTION}static isMentionLike(e){return e===Rh.MENTION||e===Rh.USER_ID||e===Rh.MODIFIER_ID}static isImage(e){return e===Rh.IMAGE}static isCheckbox(e){return e===Rh.CHECKBOX}static isGroup(e){return e===Rh.TITLE||e===Rh.TEXT||e===Rh.NUMBER||e===Rh.SELECT||e===Rh.MULTI_SELECT||e===Rh.DATE||e===Rh.MENTION||e===Rh.CHECKBOX||e===Rh.LINK||e===Rh.EMAIL||e===Rh.PHONE||e===Rh.USER_ID||e===Rh.MODIFIER_ID}static isSort(e){return e===Rh.TITLE||e===Rh.TEXT||e===Rh.NUMBER||e===Rh.SELECT||e===Rh.MULTI_SELECT||e===Rh.DATE||e===Rh.MENTION||e===Rh.CHECKBOX||e===Rh.LINK||e===Rh.EMAIL||e===Rh.PHONE||e===Rh.USER_ID||e===Rh.CREATED_AT||e===Rh.MODIFIER_ID||e===Rh.UPDATED_AT}static isFilter(e){return e===Rh.TITLE||e===Rh.TEXT||e===Rh.NUMBER||e===Rh.SELECT||e===Rh.MULTI_SELECT||e===Rh.DATE||e===Rh.MENTION||e===Rh.IMAGE||e===Rh.FILE||e===Rh.CHECKBOX||e===Rh.LINK||e===Rh.EMAIL||e===Rh.PHONE||e===Rh.USER_ID||e===Rh.CREATED_AT||e===Rh.MODIFIER_ID||e===Rh.UPDATED_AT}static getBaseType(e){return Ah[e]}}var qh=Object.defineProperty,Yh=Object.getOwnPropertyDescriptor,Xh=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Yh(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&qh(t,r,o),o};class Zh extends qp{}Zh.table="field_boolean",Zh.indexes=["field_uuid","record_uuid"],Xh([Kp()],Zh.prototype,"field_uuid",2),Xh([Kp()],Zh.prototype,"record_uuid",2),Xh([Kp()],Zh.prototype,"value",2);var Jh=Object.defineProperty,Qh=Object.getOwnPropertyDescriptor,em=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Qh(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Jh(t,r,o),o};class tm extends qp{}tm.table="field_date",tm.indexes=["field_uuid","record_uuid"],em([Kp()],tm.prototype,"field_uuid",2),em([Kp()],tm.prototype,"record_uuid",2),em([Kp()],tm.prototype,"value",2);var rm=Object.defineProperty,nm=Object.getOwnPropertyDescriptor,im=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?nm(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&rm(t,r,o),o};class om extends qp{}om.table="field",im([Kp()],om.prototype,"name",2),im([Kp()],om.prototype,"type",2),im([Kp()],om.prototype,"sub_type",2),im([Kp()],om.prototype,"format",2),im([Kp()],om.prototype,"color",2),im([Kp()],om.prototype,"multiple",2);var am=Object.defineProperty,sm=Object.getOwnPropertyDescriptor,lm=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?sm(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&am(t,r,o),o};class cm extends qp{}cm.table="field_number",cm.indexes=["field_uuid","record_uuid"],lm([Kp()],cm.prototype,"field_uuid",2),lm([Kp()],cm.prototype,"record_uuid",2),lm([Kp()],cm.prototype,"value",2),lm([Kp()],cm.prototype,"format",2);var um=Object.defineProperty,dm=Object.getOwnPropertyDescriptor,fm=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?dm(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&um(t,r,o),o};class pm extends qp{}pm.table="field_option",pm.indexes=["field_uuid"],pm.MAX_LENGTH=128,fm([Kp()],pm.prototype,"field_uuid",2),fm([Kp()],pm.prototype,"name",2),fm([Kp()],pm.prototype,"color",2),fm([Kp()],pm.prototype,"temp",2);var hm=Object.defineProperty,mm=Object.getOwnPropertyDescriptor,vm=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?mm(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&hm(t,r,o),o};class gm extends qp{}gm.table="field_select",gm.indexes=["field_uuid","record_uuid"],vm([Kp()],gm.prototype,"field_uuid",2),vm([Kp()],gm.prototype,"record_uuid",2),vm([Kp()],gm.prototype,"value",2);var ym=Object.defineProperty,bm=Object.getOwnPropertyDescriptor,wm=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?bm(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ym(t,r,o),o};class _m extends qp{}_m.table="field_string",_m.indexes=["field_uuid","record_uuid"],wm([Kp()],_m.prototype,"field_uuid",2),wm([Kp()],_m.prototype,"record_uuid",2),wm([Kp()],_m.prototype,"value",2),wm([Kp()],_m.prototype,"updated_at",2),wm([Kp()],_m.prototype,"created_at",2);var Cm=Object.defineProperty,Em=Object.getOwnPropertyDescriptor,xm=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Em(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Cm(t,r,o),o};class Sm extends qp{}Sm.table="field_uri",Sm.indexes=["field_uuid","record_uuid"],xm([Kp()],Sm.prototype,"field_uuid",2),xm([Kp()],Sm.prototype,"record_uuid",2),xm([Kp()],Sm.prototype,"uid",2),xm([Kp()],Sm.prototype,"name",2),xm([Kp()],Sm.prototype,"src",2),xm([Kp()],Sm.prototype,"size",2),xm([Kp()],Sm.prototype,"mime",2),xm([Kp()],Sm.prototype,"icon",2),xm([Kp()],Sm.prototype,"width",2),xm([Kp()],Sm.prototype,"height",2);var km=Object.defineProperty,Om=Object.getOwnPropertyDescriptor,Im=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Om(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&km(t,r,o),o};class Rm extends qp{}Rm.table="filter",Rm.indexes=["view_uuid"],Im([Kp()],Rm.prototype,"view_uuid",2),Im([Kp()],Rm.prototype,"field_uuid",2),Im([Kp()],Rm.prototype,"operator",2),Im([Kp()],Rm.prototype,"func",2),Im([Kp()],Rm.prototype,"expected",2);var Tm=Object.defineProperty,Am=Object.getOwnPropertyDescriptor,Nm=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Am(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Tm(t,r,o),o};class Mm extends qp{}Mm.table="group",Mm.indexes=["view_uuid"],Nm([Kp()],Mm.prototype,"view_uuid",2),Nm([Kp()],Mm.prototype,"field_uuid",2),Nm([Kp()],Mm.prototype,"type",2);var Pm=Object.defineProperty,jm=Object.getOwnPropertyDescriptor,Dm=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?jm(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Pm(t,r,o),o};class Fm extends qp{}Fm.table="field_group",Fm.indexes=["view_uuid"],Dm([Kp()],Fm.prototype,"view_uuid",2),Dm([Kp()],Fm.prototype,"name",2);var Vm=Object.defineProperty,Lm=Object.getOwnPropertyDescriptor,$m=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Lm(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Vm(t,r,o),o};class Bm extends qp{}Bm.table="record",$m([Kp()],Bm.prototype,"id",2),$m([Kp()],Bm.prototype,"desc",2),$m([Kp()],Bm.prototype,"creator_id",2),$m([Kp()],Bm.prototype,"modifier_id",2);var zm=Object.defineProperty,Um=Object.getOwnPropertyDescriptor,Hm=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Um(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&zm(t,r,o),o};class Wm extends qp{}Wm.table="sort",Wm.indexes=["view_uuid"],Hm([Kp()],Wm.prototype,"view_uuid",2),Hm([Kp()],Wm.prototype,"field_uuid",2),Hm([Kp()],Wm.prototype,"type",2);var Gm=Object.defineProperty,Km=Object.getOwnPropertyDescriptor,qm=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Km(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Gm(t,r,o),o};class Ym extends qp{}Ym.table="stat",Ym.indexes=["view_uuid","field_uuid"],qm([Kp()],Ym.prototype,"view_uuid",2),qm([Kp()],Ym.prototype,"field_uuid",2),qm([Kp()],Ym.prototype,"type",2);var Xm=Object.defineProperty,Zm=Object.getOwnPropertyDescriptor,Jm=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Zm(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Xm(t,r,o),o};class Qm extends qp{}Qm.table="table",Jm([Kp()],Qm.prototype,"version",2),Jm([Kp()],Qm.prototype,"active_view_uuid",2);var ev=Object.defineProperty,tv=Object.getOwnPropertyDescriptor,rv=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?tv(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ev(t,r,o),o};class nv extends qp{}nv.table="user",nv.indexes=["uid"],rv([Kp()],nv.prototype,"uid",2),rv([Kp()],nv.prototype,"login",2),rv([Kp()],nv.prototype,"work_id",2),rv([Kp()],nv.prototype,"name",2),rv([Kp()],nv.prototype,"icon",2);var iv=Object.defineProperty,ov=Object.getOwnPropertyDescriptor,av=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ov(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&iv(t,r,o),o};class sv extends qp{}sv.table="view_config",sv.indexes=["view_uuid"],av([Kp()],sv.prototype,"view_uuid",2),av([Kp()],sv.prototype,"cover_field_uuid",2),av([Kp()],sv.prototype,"cover_display",2),av([Kp()],sv.prototype,"show_field_name",2),av([Kp()],sv.prototype,"keep_sort",2),av([Kp()],sv.prototype,"frozen_field",2),av([Kp()],sv.prototype,"record_height",2);var lv=Object.defineProperty,cv=Object.getOwnPropertyDescriptor,uv=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?cv(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&lv(t,r,o),o};class dv extends qp{}dv.table="view_field",dv.indexes=["view_uuid"],uv([Kp()],dv.prototype,"view_uuid",2),uv([Kp()],dv.prototype,"field_uuid",2),uv([Kp()],dv.prototype,"group_uuid",2),uv([Kp()],dv.prototype,"name",2),uv([Kp()],dv.prototype,"size",2),uv([Kp()],dv.prototype,"display_type",2),uv([Kp()],dv.prototype,"required",2),uv([Kp()],dv.prototype,"hidden",2);var fv=Object.defineProperty,pv=Object.getOwnPropertyDescriptor,hv=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?pv(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&fv(t,r,o),o};class mv extends qp{}mv.table="view",hv([Kp()],mv.prototype,"id",2),hv([Kp()],mv.prototype,"type",2),hv([Kp()],mv.prototype,"name",2),hv([Kp()],mv.prototype,"desc",2);var vv=Object.defineProperty,gv=Object.getOwnPropertyDescriptor,yv=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?gv(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&vv(t,r,o),o};class bv extends qp{}bv.table="view_record",bv.indexes=["view_uuid"],yv([Kp()],bv.prototype,"view_uuid",2),yv([Kp()],bv.prototype,"record_uuid",2),yv([Kp()],bv.prototype,"group_item_key",2),yv([Kp()],bv.prototype,"hidden",2);var wv=Object.defineProperty,_v=Object.getOwnPropertyDescriptor,Cv=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?_v(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&wv(t,r,o),o};class Ev extends qp{}Ev.table="view_share",Ev.indexes=["view_uuid"],Cv([Kp()],Ev.prototype,"view_uuid",2),Cv([Kp()],Ev.prototype,"src",2),Cv([Kp()],Ev.prototype,"status",2);var xv=Object.defineProperty,Sv=Object.getOwnPropertyDescriptor,kv=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Sv(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&xv(t,r,o),o};let Ov=class{get fieldBooleanModel(){return this._modelService.getModel(Zh.table)}get fieldDateModel(){return this._modelService.getModel(tm.table)}get fieldModel(){return this._modelService.getModel(om.table)}get fieldNumberModel(){return this._modelService.getModel(cm.table)}get fieldOptionModel(){return this._modelService.getModel(pm.table)}get fieldSelectModel(){return this._modelService.getModel(gm.table)}get fieldStringModel(){return this._modelService.getModel(_m.table)}get fieldUriModel(){return this._modelService.getModel(Sm.table)}get filterModel(){return this._modelService.getModel(Rm.table)}get groupModel(){return this._modelService.getModel(Mm.table)}get fieldGroupModel(){return this._modelService.getModel(Fm.table)}get recordModel(){return this._modelService.getModel(Bm.table)}get sortModel(){return this._modelService.getModel(Wm.table)}get statModel(){return this._modelService.getModel(Ym.table)}get tableModel(){return this._modelService.getModel(Qm.table)}get userModel(){return this._modelService.getModel(nv.table)}get viewConfigModel(){return this._modelService.getModel(sv.table)}get viewFieldModel(){return this._modelService.getModel(dv.table)}get viewModel(){return this._modelService.getModel(mv.table)}get viewRecordModel(){return this._modelService.getModel(bv.table)}get viewShareModel(){return this._modelService.getModel(Ev.table)}};kv([to(Wp)],Ov.prototype,"_modelService",2),Ov=kv([eo()],Ov);var Iv=Object.defineProperty,Rv=Object.getOwnPropertyDescriptor;let Tv=class{get currentUser(){return this._user}setCurrentUser(e){this._user=e}};Tv=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Rv(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Iv(t,r,o),o})([eo()],Tv);var Av=Object.defineProperty,Nv=Object.getOwnPropertyDescriptor;let Mv=class{constructor(){this._fieldMap=new Map}registerField(e){this._fieldMap.set(e.type,e)}getValueModel(e){var t;return null==(t=this.getValueField(e))?void 0:t.model}getValueField(e){return this._fieldMap.get(e)}};Mv=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Nv(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Av(t,r,o),o})([eo()],Mv);var Pv=Object.defineProperty,jv=Object.getOwnPropertyDescriptor,Dv=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?jv(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Pv(t,r,o),o};let Fv=class extends Zf{constructor(){super(...arguments),this._onCellChange=this._register(new op),this.onCellChange=this._onCellChange.event}destroy(){super.destroy()}};Dv([Si()],Fv.prototype,"destroy",1),Fv=Dv([eo()],Fv);var Vv=Object.defineProperty,Lv=Object.getOwnPropertyDescriptor,$v=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Lv(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Vv(t,r,o),o};let Bv=class{_notifyCellChange(e,t){this._eventService._onCellChange.emit({fieldId:e,recordId:t,cellValue:this.getCell(e,t)})}setCell(e,t,r){var n,i;let o=r.fieldType;if(!o){const t=this._model.fieldModel.findById(e);o=null==t?void 0:t.type}null==(i=null==(n=this._fieldRegistry.getValueField(o))?void 0:n.setCell)||i.call(n,e,t,r),this.updateRecord(t),this._notifyCellChange(e,t)}bulkSetCell(e){var t,r;if(0===e.length)return;let n=e[0].fieldType;const i=e[0].fieldId;if(!n){const e=this._model.fieldModel.findById(i);n=null==e?void 0:e.type}null==(r=null==(t=this._fieldRegistry.getValueField(n))?void 0:t.bulkSetCell)||r.call(t,e),e.forEach((e=>{this.updateRecord(e.recordId),this._notifyCellChange(e.fieldId,e.recordId)}))}updateRecord(e){const t=this._model.fieldModel.find({type:Rh.UPDATED_AT});if(t.length>0)for(const r of t)this.updateRecordUpdatedAt(r.uuid,e);const r=this._model.fieldModel.find({type:Rh.MODIFIER_ID});if(r.length>0)for(const t of r)this.updateRecordModifierId(t.uuid,e)}updateRecordUpdatedAt(e,t){this._model.recordModel.update({uuid:t},{updated_at:new Date}),this._notifyCellChange(e,t)}updateRecordModifierId(e,t){var r;this._model.recordModel.update({uuid:t},{modifier_id:null==(r=this._contextService.currentUser)?void 0:r.uid}),this._notifyCellChange(e,t)}removeByRecordId(e,t){const r=this._model.fieldModel.findById(e);if(!r)return;const n=r.type,i=this._fieldRegistry.getValueModel(n);if(!i)return;const o={field_uuid:e,record_uuid:t};i.remove(o)}getFieldCells(e){if(!this._model.fieldModel.findById(e))return[];const t=this._model.recordModel.find(),r=[];for(const n of t){const t=this.getCell(e,n.uuid);t&&r.push(t)}return r}getRecordCells(e){if(!this._model.recordModel.findById(e))return[];const t=this._model.fieldModel.find(),r=[];for(const n of t){const t=this.getCell(n.uuid,e);t&&r.push(t)}return r}getCell(e,t){const r=this._model.fieldModel.findById(e),n=null==r?void 0:r.type;if(!n)return null;const i=this._fieldRegistry.getValueField(n);return null==i?void 0:i.getCell(e,t)}getCellFormattedValue(e,t){const r=this._model.fieldModel.findById(e);if(!r)return"";const n=this._fieldRegistry.getValueField(r.type);return n?n.getCellFormattedValue(e,t):""}getCellKeyValue(e,t){const r=this._model.fieldModel.findById(e);if(!r)return null;const n=this._fieldRegistry.getValueField(r.type);return n?n.getCellKeyValue(e,t):null}keyValue(e){if(!e||null==e||!e.value)return"";const t=this._model.fieldModel.findById(e.fieldId);if(!t)return"";const r=this._fieldRegistry.getValueField(t.type);return null==r?void 0:r.keyValue(e.value)}copy(e,t,r,n){const i=this.getCell(e,t);!i||this.setCell(r,n,i)}updateOrder(e){const{fieldId:t,fieldType:r,recordId:n,sourceValueId:i,targetValueId:o}=e,a=this._fieldRegistry.getValueModel(r);if(!a)return;const s=a.find({field_uuid:t,record_uuid:n}),l=s.findIndex((e=>e.uuid===i)),c=s.findIndex((e=>e.uuid===o));let u={};const d=s[l],f=s[c];f&&(u={field_uuid:f.field_uuid,record_uuid:f.record_uuid}),l<c?a.moveAfter(u,{field_uuid:d.field_uuid,record_uuid:d.record_uuid}):a.moveBefore(u,{field_uuid:d.field_uuid,record_uuid:d.record_uuid}),this._notifyCellChange(t,n)}};$v([to(Ov)],Bv.prototype,"_model",2),$v([to(Mv)],Bv.prototype,"_fieldRegistry",2),$v([to(Fv)],Bv.prototype,"_eventService",2),$v([to(Tv)],Bv.prototype,"_contextService",2),Bv=$v([eo()],Bv);const zv=Fi.defineToken("CellEditContribution");var Uv=Object.defineProperty,Hv=Object.getOwnPropertyDescriptor,Wv=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Hv(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Uv(t,r,o),o};let Gv=class{getProvider(){var e;const t=this.userProvider.getContributions(),r=t[t.length-1];return null==(e=null==r?void 0:r.registerCellEdit)?void 0:e.call(r)}};Wv([Eo(zv)],Gv.prototype,"userProvider",2),Gv=Wv([eo()],Gv);var Kv=Object.defineProperty,qv=Object.getOwnPropertyDescriptor,Yv=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?qv(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Kv(t,r,o),o};let Xv=class{get provider(){return this._cellEditRegistry.getProvider()}setCell(e){var t;return null==(t=this.provider)?void 0:t.setCell(e)}};Yv([to(Gv)],Xv.prototype,"_cellEditRegistry",2),Xv=Yv([eo()],Xv);const Zv=bo().contribution(zv).register(Gv).register(Xv);var Jv=Object.defineProperty,Qv=Object.getOwnPropertyDescriptor,eg=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Qv(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Jv(t,r,o),o};let tg=class{async changeCellType(e,t,r,n,i){var o,a,s;const l=this._fieldRegistry.getValueField(t),c=this._fieldRegistry.getValueField(r);if(!l||!c)return;let u=null;if(l.baseType!==c.baseType||l.type===Rh.TEXT){const t=l.formatted(e.value,n);u=Kh.isSelectLike(c.type)&&!i?c.transform(t,n):c.transform(t,i)}else if(Kh.isUri(c.type)){let t=e.value;Kh.isMultiple(l.type)&&!Kh.isMultiple(c.type)&&(t=(null==e?void 0:e.value)[0]),u=c.transform(t)}else if(Kh.isSelectLike(c.type)){let t=e.value;if(Kh.isMultiple(l.type)&&!Kh.isMultiple(c.type)&&(t=null==(o=null==e?void 0:e.value)?void 0:o[0]),Kh.isMultiple(l.type)&&Kh.isMultiple(c.type)&&n&&i){const e=(null==c?void 0:c.getFieldOptionName(t,n))||[];u=c.transform(e,i)}else if(n&&i&&n!==i){const e=l.formatted(t,n);u=c.transform(e,i)}else{const e=jo(n)?i:void 0;u=c.transform(t,e)}}else u=c.transform(null==e?void 0:e.value);if(null!==u){if(c.validate(u.value)){const t={...e,value:u.value};if(null!=(a=this._cellEditService)&&a.provider&&!await this._cellEditService.setCell({cells:[t]}))return;e.fieldId&&e.recordId&&(null==(s=c.setCell)||s.call(c,e.fieldId,e.recordId,t),this._eventService._onCellChange.emit({fieldId:e.fieldId,recordId:e.recordId,cellValue:t}))}}else l.model&&l.model.remove({field_uuid:e.fieldId,record_uuid:e.recordId})}};eg([to(Mv)],tg.prototype,"_fieldRegistry",2),eg([to(Xv)],tg.prototype,"_cellEditService",2),eg([to(Fv)],tg.prototype,"_eventService",2),tg=eg([eo()],tg);class rg{static order(e,t,r){const n=[...e],[i]=n.splice(t,1);return n.splice(r,0,i),n}}var ng=Object.defineProperty,ig=Object.getOwnPropertyDescriptor,og=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ig(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ng(t,r,o),o};let ag=class{_notifyCellChange(e,t){this._eventService._onCellChange.emit({fieldId:e,recordId:t,cellValue:this._cellService.getCell(t,e)})}getFields(){const e=this._model.fieldModel.find();for(const t of e)Kh.isSelectLike(t.type)&&(t.options=this._model.fieldOptionModel.find({field_uuid:t.uuid}));return e}getField(e){const t=this._model.fieldModel.findOne({uuid:e});return t?(Kh.isSelectLike(t.type)&&(t.options=this._model.fieldOptionModel.find({field_uuid:t.uuid})),t):null}getFieldOption(e){return this._model.fieldOptionModel.findOne({uuid:e})}getFieldOptions(e){return this._model.fieldOptionModel.find({field_uuid:e})}getFieldOptionName(e){const t=e.split(",");if(Array.isArray(t)){const e=[];return t.forEach((t=>{const r=this._model.fieldOptionModel.findOne({uuid:t});r&&e.push(r.name)})),e.join(",")}const r=this._model.fieldOptionModel.findOne({uuid:e});return r?r.name:""}create(e){const t=this._model.fieldModel.create({name:e.name,type:e.type,color:e.color,uuid:e.uuid,multiple:!!e.multiple});if(e.options)for(const r of e.options)this._model.fieldOptionModel.create({uuid:r.uuid,field_uuid:t.uuid,name:r.name.slice(0,pm.MAX_LENGTH),color:r.color});return t}remove(e){const t=this._model.fieldModel.remove({uuid:e});return this._model.fieldOptionModel.remove({field_uuid:e}),t}update(e){const t=e.uuid;return this._model.fieldModel.update({uuid:t},e)}createFieldOption(e,t,r){if(!this._model.fieldModel.findOne({uuid:e}))throw new Error(kf("不存在对应字段"));if(!t.name)throw new Error(kf("选项名不能为空"));if(t.name.length>pm.MAX_LENGTH)throw new Error(kf("选项名不能超过最大长度限制"));const n=this._model.fieldOptionModel.find({field_uuid:e}),i=n.findIndex((e=>e.uuid===r));if(n.some((e=>e.name===t.name)))throw new Error(kf("已存在该选项，不可重复创建！"));const o=this._model.fieldOptionModel.create({uuid:t.uuid,field_uuid:e,name:t.name,color:t.color});if(t.users)for(const e of t.users)this._model.userModel.upsert({uid:e.uid},{uid:e.uid,login:e.login,work_id:e.work_id,name:e.name,icon:e.icon});if(i!==n.length-1){const t=this._model.fieldOptionModel.find({field_uuid:e}),r=rg.order(t,t.length-1,i+1);this._model.fieldOptionModel.remove({field_uuid:e}),this._model.fieldOptionModel.bulkCreate(r)}return o}updateFieldOption(e,t){const r=this._model.fieldOptionModel.findOne({uuid:e});if(!r)throw new Error(kf("不存在对应选项"));if(!t.name)throw new Error(kf("选项名不能为空"));if(t.name.length>pm.MAX_LENGTH)throw new Error(kf("选项名不能超过最大长度限制"));if(this._model.fieldOptionModel.find({field_uuid:r.field_uuid,uuid:{$not:e}}).some((e=>e.name===t.name)))throw new Error(kf("已存在该选项，不可重复创建！"));const n={name:t.name,color:t.color};this._model.fieldOptionModel.update({uuid:r.uuid,field_uuid:r.field_uuid},n)}updateMentionFieldOptionId(e,t){this._model.fieldOptionModel.update({uuid:e},{uuid:t})}updateFieldOptions(e,t,r){if(r.length>0){const t=this._model.fieldSelectModel.find({value:r,field_uuid:e});t.forEach((e=>{this._model.fieldSelectModel.remove({uuid:e.uuid})}));for(const r of t)this._notifyCellChange(e,r.record_uuid);this._model.fieldOptionModel.remove({uuid:r,field_uuid:e})}t.map((t=>{var r;return{uuid:t.uuid,field_uuid:e,name:(null==(r=t.name)?void 0:r.slice(0,pm.MAX_LENGTH))||"",color:t.color}})).forEach(((t,r)=>{const n=this._model.fieldOptionModel.find({field_uuid:e}),i=n.findIndex((e=>e.uuid===t.uuid));if(r===i){const e=n[i];(null!=t.name&&t.name!==e.name||null!=t.color&&t.color!==e.color)&&this._model.fieldOptionModel.update({uuid:t.uuid},t)}else if(-1===i)if(0===r)this._model.fieldOptionModel.createBefore(null,t);else{const e=n[r-1];this._model.fieldOptionModel.createAfter({uuid:e.uuid},t)}else if(0===r)this._model.fieldOptionModel.moveBefore(null,t);else{const e=n[r-1];this._model.fieldOptionModel.moveAfter(e,t)}}))}updateFieldOptionOrder(e,t,r){const n=this._model.fieldOptionModel.find({field_uuid:e}),i=n.findIndex((e=>e.uuid===t)),o=n.findIndex((e=>e.uuid===r)),a=n[o];let s={};a&&(s={field_uuid:e,uuid:a.uuid}),i<o?this._model.fieldOptionModel.moveAfter(s,{uuid:t,field_uuid:e}):this._model.fieldOptionModel.moveBefore(s,{uuid:t,field_uuid:e})}removeFieldOption(e){const t=this._model.fieldOptionModel.findOne({uuid:e});this._model.fieldOptionModel.remove({uuid:e,field_uuid:t.field_uuid}),this._model.fieldSelectModel.remove({field_uuid:t.field_uuid,value:e})}changeFieldType(e,t,r,n){if(this._model.fieldModel.update({uuid:e},{type:r}),(null==n?void 0:n[0].fieldType)===r)this._cellService.bulkSetCell(n);else for(const i of n)this._processService.changeCellType(i,t,r,e)}clone(e,t){const r=this._model.fieldModel.findOne({uuid:e});if(!r)return;const n=this._model.fieldOptionModel.find({field_uuid:r.uuid}),i=this._model.fieldModel.create({uuid:t,name:this.getFieldName(r.type,r.name),type:r.type,sub_type:r.sub_type,format:r.format,color:r.color,multiple:r.multiple});return n.length>0&&this._model.fieldOptionModel.bulkCreate(n.map((e=>({field_uuid:i.uuid,name:e.name,color:e.color})))),i}getFieldName(e,t){const r=this._model.fieldModel.find({type:e}),n=r.length,i=n=>{var o;const a=(t||(null==(o=Mh.find((t=>t.type===e)))?void 0:o.name))+" "+n;return r.find((e=>e.name===a))?i(n+1):a};return i(n)}};og([to(Bv)],ag.prototype,"_cellService",2),og([to(tg)],ag.prototype,"_processService",2),og([to(Fv)],ag.prototype,"_eventService",2),og([to(Ov)],ag.prototype,"_model",2),ag=og([eo()],ag);var sg=Object.defineProperty,lg=Object.getOwnPropertyDescriptor;let cg=class{equalTo(e,t){return null===t||e===t}notEqualTo(e,t){return null===t||e!==t}greaterThan(e,t){return null===t||e>t}greaterThanOrEqualTo(e,t){return null===t||e>=t}lessThan(e,t){return null===t||e<t}lessThanOrEqualTo(e,t){return null===t||e<=t}startsWith(e,t){return null===t||"string"==typeof e&&e.startsWith(t)}notStartsWith(e,t){return null===t||"string"==typeof e&&!e.startsWith(t)}endsWith(e,t){return null===t||"string"==typeof e&&e.endsWith(t)}notEndsWith(e,t){return null===t||"string"==typeof e&&!e.endsWith(t)}contains(e,t){return null===t||-1!==e.indexOf(t)}notContains(e,t){return null===t||-1===e.indexOf(t)}yesterday(e){if(!e)return!1;const t=Td().add(-1,"days").startOf("day");return 0===e.startOf("day").diff(t,"days")}today(e){if(!e)return!1;const t=Td().startOf("day");return 0===e.startOf("day").diff(t,"days")}tomorrow(e){if(!e)return!1;const t=Td().add(1,"days").startOf("day");return 0===e.startOf("day").diff(t,"days")}last7days(e){if(!e)return!1;const t=Td().add(-7,"days"),r=e.diff(t,"days",!0);return r>=0&&r<7}lastWeek(e){if(!e)return!1;const t=Td().startOf("week").add(-7,"days").valueOf(),r=e.diff(t,"days",!0);return r>=0&&r<7}thisWeek(e){if(!e)return!1;const t=Td().endOf("week").add(-7,"days").valueOf(),r=e.diff(t,"days",!0);return r>=0&&r<7}nextWeek(e){if(!e)return!1;const t=Td().endOf("week").valueOf(),r=e.diff(t,"days",!0);return r>=0&&r<7}lastMonth(e){if(!e)return!1;const t=Td().startOf("month"),r=t.valueOf(),n=t.add(-1,"months").valueOf();return e.valueOf()>=n&&e.valueOf()<r}thisMonth(e){if(!e)return!1;const t=Td().endOf("month").valueOf(),r=Td().startOf("month");return e.valueOf()>=r&&e.valueOf()<=t}nextMonth(e){if(!e)return!1;const t=Td().endOf("month"),r=t.valueOf(),n=t.add(1,"months").valueOf();return e.valueOf()>r&&e.valueOf()<=n}is(e,t){return null===t||(Array.isArray(e)?e[0]===t:e===t)}isNot(e,t){if(null===t)return!0;if(!Array.isArray(t))return!e||(Array.isArray(e)?e[0]!==t:e!==t);if(!e||Array.isArray(e)&&e.length!==t.length)return!0;for(let r=0;r<e.length;r++)if(!t.includes(e[r]))return!0;return!1}isEmpty(e){return null==e||""===e}isNotEmpty(e){return!this.isEmpty(e)}isEmptySelect(e){return!e||!!Array.isArray(e)&&0===e.length}isNotEmptySelect(e){return!!e&&(!Array.isArray(e)||e.length>0)}hasAnyOf(e,t){if(null===t)return!0;t=Array.isArray(t)?t:[t];for(let r=0;r<t.length;r++)if(Array.isArray(e)){if(e.includes(t[r]))return!0}else if(od(e,t[r]))return!0;return!1}hasAllOf(e,t){if(null===t)return!0;t=Array.isArray(t)?t:[t];for(let r=0;r<t.length;r++)if(Array.isArray(e)){if(!e.includes(t[r]))return!1}else if(!od(e,t[r]))return!1;return!0}isExactly(e,t){return null===t||od(e,t=Array.isArray(t)?t:[t])}hasNoneOf(e,t){if(null===t)return!0;t=Array.isArray(t)?t:[t];for(let r=0;r<t.length;r++)if(Array.isArray(e)){if(e.includes(t[r]))return!1}else if(od(e,t[r]))return!1;return!0}};cg=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?lg(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&sg(t,r,o),o})([eo()],cg);var ug=Object.defineProperty,dg=Object.getOwnPropertyDescriptor,fg=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?dg(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ug(t,r,o),o};let pg=class{getRecords(){return this._model.recordModel.find()}getRecordById(e){const t=this._model.recordModel.findById(e);if(!t)return;t.cells=[];const r=this._fieldService.getFields();for(const e of r){if(!e)continue;const r=this._cellService.getCell(e.uuid,t.uuid);t.cells.push(r)}return t}getRecordDesc(e){const t=this._model.recordModel.findById(e);if(t)return t.desc}create(e){var t;const r=null==(t=this._contextService.currentUser)?void 0:t.uid,n={uuid:e.uuid,creator_id:(null==e?void 0:e.modifier_id)||r,modifier_id:(null==e?void 0:e.modifier_id)||r};return Array.isArray(e.uuid)?this._model.recordModel.bulkCreate(e.uuid.map((t=>({uuid:t,creator_id:r,modifier_id:(null==e?void 0:e.modifier_id)||r})))):this._model.recordModel.create(n)}update(e,t){if(this._model.recordModel.findById(e))return this._model.recordModel.update({uuid:e},t)}bulkCreate(e){var t;const r=null==(t=this._contextService.currentUser)?void 0:t.uid;return this._model.recordModel.bulkCreate(e.map((e=>({uuid:e.uuid,creator_id:e.creator_id||r,modifier_id:e.modifier_id||r}))))}remove(e){return this._model.recordModel.remove({uuid:e})}removeAll(){const e=this._model.recordModel.find();return this._model.recordModel.remove({uuid:e.map((e=>e.uuid))})}};fg([to(Bv)],pg.prototype,"_cellService",2),fg([to(ag)],pg.prototype,"_fieldService",2),fg([to(Tv)],pg.prototype,"_contextService",2),fg([to(Ov)],pg.prototype,"_model",2),pg=fg([eo()],pg);var hg=Object.defineProperty,mg=Object.getOwnPropertyDescriptor;let vg=class{sort(e="asc",t,r){return t=Kh.isSelectLike(r.type)?"asc"===e?this.ascSortSelect(t,r):this.descSortSelect(t,r):[Rh.NUMBER,Rh.CHECKBOX].includes(r.type)?"asc"===e?this.ascSortNumber(t):this.descSortNumber(t):Kh.isDate(r.type)||Kh.isSystemDate(r.type)?"asc"===e?this.ascSortDate(t):this.descSortDate(t):Kh.isUri(r.type)||Kh.isMentionLike(r.type)?"asc"===e?this.ascSortUri(t):this.descSortUri(t):"asc"===e?this.ascSortText(t):this.descSortText(t)}ascSortText(e){return e.sort(((e,t)=>{const r=e.groupOption.value||"",n=t.groupOption.value||"";return r.localeCompare(n)}))}descSortText(e){return e.sort(((e,t)=>{const r=e.groupOption.value||"";return(t.groupOption.value||"").localeCompare(r)}))}ascSortNumber(e){return e.sort(((e,t)=>Number(e.groupOption.value)-Number(t.groupOption.value)))}descSortNumber(e){return e.sort(((e,t)=>Number(t.groupOption.value)-Number(e.groupOption.value)))}ascSortDate(e){return e.sort(((e,t)=>Td(e.groupOption.value).unix()-Td(t.groupOption.value).unix()))}descSortDate(e){return e.sort(((e,t)=>Td(t.groupOption.value).unix()-Td(e.groupOption.value).unix()))}ascSortUri(e){return e.sort(((e,t)=>{var r,n;const i=(Array.isArray(e.groupOption.value)?null==(r=e.groupOption.value)?void 0:r[0].name:e.groupOption.value.name)||"",o=(Array.isArray(t.groupOption.value)?null==(n=t.groupOption.value)?void 0:n[0].name:t.groupOption.value.name)||"";return i.localeCompare(o)}))}descSortUri(e){return e.sort(((e,t)=>{var r,n;const i=(Array.isArray(e.groupOption.value)?null==(r=e.groupOption.value)?void 0:r[0].name:e.groupOption.value.name)||"";return((Array.isArray(t.groupOption.value)?null==(n=t.groupOption.value)?void 0:n[0].name:t.groupOption.value.name)||"").localeCompare(i)}))}ascSortSelect(e,t){var r;const n=null==(r=t.options)?void 0:r.map((e=>e.uuid));return this._getlistOrderByOptions(e,n)}descSortSelect(e,t){var r;const n=null==(r=t.options)?void 0:r.map((e=>e.uuid)).reverse();return this._getlistOrderByOptions(e,n)}_getlistOrderByOptions(e,t){const r=t.reduce(((e,t)=>(e[t]=[],e)),{}),n=[];for(const t of e){const e=t.groupOption.value;if(e){const n=Array.isArray(e)?e[0]:e;r[n].push(t)}else n.push(t)}let i=[];return t.forEach((e=>{i=i.concat(r[e])})),i=i.concat(n),i}};vg=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?mg(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&hg(t,r,o),o})([eo()],vg);var gg=Object.defineProperty,yg=Object.getOwnPropertyDescriptor,bg=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?yg(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&gg(t,r,o),o};let wg=class{getViewGroup(e){const t=this._model.groupModel.findOne({view_uuid:e});if(t)return t.field=this._model.fieldModel.findOne({uuid:t.field_uuid}),t.field?(t.options=this._model.fieldOptionModel.find({field_uuid:t.field_uuid}),t):void this._model.groupModel.remove({uuid:t.uuid,view_uuid:e})}isGroup(e){return!!this.getViewGroup(e)}groupViewRecords(e,t){var r,n;const i={},o=this._model.viewModel.findOne({uuid:t.view_uuid});for(const t of e)t.group_item_key?(i[t.group_item_key]=i[t.group_item_key]||[],i[t.group_item_key].push(t)):(i[""]=i[""]||[],i[""].push(t));let a;const s=this._fieldService.getField(t.field_uuid);if(!s)return e;if(a=Kh.isSelect(s.type)||Kh.isMention(s.type)?null==(r=t.options)?void 0:r.map((e=>{if(!e||!e.uuid)return null;const t={...e,fieldId:e.field_uuid,value:e.uuid};if(Kh.isMention(s.type)){const r=this._model.userModel.find({uid:e.uuid.split(",").map((e=>Number(e)))});if(0===r.length)return null;t.value=[...r]}return{groupOption:t,groupField:s,records:i[e.uuid]||[]}})).filter((e=>!!e)):Object.keys(i).map((e=>{if(""===e)return;const r=i[e][0].record_uuid;return{groupOption:this._cellService.getCell(t.field_uuid,r),groupField:s,records:i[e]||[]}})).filter((e=>!!e)),(null==s?void 0:s.type)===Rh.CHECKBOX&&a.push({groupField:s,groupOption:{value:!1},records:i[""]}),o.type!==Wh.KANBAN&&(a=this._groupSortService.sort(t.type,a,s)),(null==s?void 0:s.type)!==Rh.CHECKBOX&&a.push({groupField:s,groupOption:null,records:i[""]}),o.type===Wh.KANBAN){const e=a.findIndex((e=>!e.groupOption));if(e>-1){const t=a.splice(e,1)[0];t.records&&t.records.length>0&&a.unshift(t)}for(const e of a)null==(n=e.records)||n.reverse()}return a}create(e,t){this._model.groupModel.create({view_uuid:e,field_uuid:t.field_uuid,type:t.type}),this.refreshViewRecordGroupKey(e,t)}remove(e){this._model.groupModel.remove({view_uuid:e})}update(e,t){const r=this._model.groupModel.update({view_uuid:e},{field_uuid:t.field_uuid,view_uuid:e,type:t.type});return this.refreshViewRecordGroupKey(e,t),r}refreshViewRecordGroupKey(e,t){const r=this._model.viewRecordModel.find({view_uuid:e}),n=this.refreshViewRecords(r,t),i=this._fieldService.getField(t.field_uuid);i&&i.type===Rh.MENTION&&this._removeMentionFieldOption(n,i)}refreshViewRecords(e,t){const r=[];for(const n of e){const e=this.refreshViewRecord(n,t);e&&r.push(e)}return r}refreshViewRecord(e,t,r={}){const n=this._cellService.getCellKeyValue(t.field_uuid,e.record_uuid)||"",i=this._model.viewRecordModel.findOne({view_uuid:e.view_uuid,record_uuid:e.record_uuid});i.group_item_key||(i.group_item_key=""),i.group_item_key!=n&&this._model.viewRecordModel.update({view_uuid:e.view_uuid,record_uuid:e.record_uuid},{group_item_key:n},r);const o=this._fieldService.getField(t.field_uuid);return o&&o.type===Rh.MENTION&&this._refreshMentionFieldOption(e.view_uuid,o,t,n),n}_refreshMentionFieldOption(e,t,r,n){if(n&&!this._model.fieldOptionModel.find({field_uuid:t.uuid}).some((e=>e.uuid===n))){const t=this._model.viewModel.findOne({uuid:e});this._model.fieldOptionModel.create({field_uuid:r.field_uuid,uuid:n,name:n,temp:(null==t?void 0:t.type)!==Wh.KANBAN})}}_removeMentionFieldOption(e,t){this._model.fieldOptionModel.find({field_uuid:t.uuid}).forEach((t=>{e.indexOf(t.uuid)<0&&this._model.fieldOptionModel.remove({uuid:t.uuid,temp:!0})}))}copy(e,t){const r=this._model.groupModel.find({view_uuid:e});if(r&&0!==r.length){for(const e of r)delete e.uuid,e.view_uuid=t;this._model.groupModel.bulkCreate(r.map((e=>({view_uuid:e.view_uuid,field_uuid:e.field_uuid,type:e.type}))))}}createDefaultKanbanViewGroup(e){const t=this._fieldService.getFields();let r=t.find((e=>Rh.SELECT===e.type));return r||(r=t.find((e=>Rh.MENTION===e.type))),this.create(e,{field_uuid:null==r?void 0:r.uuid,view_uuid:e}),this.getViewGroup(e)}};bg([to(Nf)],wg.prototype,"_storage",2),bg([to(Ov)],wg.prototype,"_model",2),bg([to(ag)],wg.prototype,"_fieldService",2),bg([to(Bv)],wg.prototype,"_cellService",2),bg([to(vg)],wg.prototype,"_groupSortService",2),wg=bg([eo()],wg);var _g=Object.defineProperty,Cg=Object.getOwnPropertyDescriptor,Eg=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Cg(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&_g(t,r,o),o};let xg=class{getOriginViewRecords(e){return this._model.viewRecordModel.find({view_uuid:e})}getViewRecords(e,t=!0){const r={view_uuid:e};t&&(r.hidden={$not:!0});let n=this._model.viewRecordModel.find(r);const i=this._model.viewFieldModel.find({view_uuid:e,hidden:{$not:!0}}),o=this._recordService.getRecords(),a=ld(o,"uuid"),s=this._groupService.getViewGroup(e);for(const[e,t]of n.entries()){const r=a[t.record_uuid];if(!t.record_uuid||!r){delete n[e];continue}const o=[];t.cellMap=new Map;for(const[e,n]of i.entries()){const i=this._fieldService.getField(n.field_uuid);if(!i||!r)continue;const a=this._cellService.getCell(i.uuid,r.uuid);o.push(a),t.cellMap.set(i.uuid,e)}t.cells=o,t.record=r}return n=n.filter((e=>!!e)),s?this._groupService.groupViewRecords(n,s):n}getViewRecordsCount(e,t=!0){const r={view_uuid:e};return t&&(r.hidden={$not:!0}),(this._model.viewRecordModel.find(r)||[]).length}getFlatViewRecords(e){const t=this._groupService.getViewGroup(e);let r=this._model.viewRecordModel.find({view_uuid:e,hidden:{$not:!0}});return t&&(r=this._groupService.groupViewRecords(r,t).map((e=>e.records||[])).reduce(((e,t)=>e.concat(t)),[])),r}getRecordById(e,t){const r=this._model.viewRecordModel.findOne({view_uuid:e,record_uuid:t});if(!r)return null;const n=this._model.viewFieldModel.find({view_uuid:e}),i=[];for(const e of n){const r=this._fieldService.getField(e.field_uuid);if(!r)continue;const n=this._cellService.getCell(r.uuid,t);!n||i.push(n)}return{...r,cells:i}}getVisibleRecordIds(e){return this._model.viewRecordModel.find({view_uuid:e}).map((e=>e.record_uuid))||[]}getFieldRecords(e,t,r){const n={view_uuid:e,hidden:{$not:!0}};null!=r&&(n.group_item_key=r);const i=this._model.viewRecordModel.find(n),o=this._recordService.getRecords(),a=ld(o,"uuid");for(const e of i){if(!e.record_uuid)continue;const r=a[e.record_uuid];if(!r)continue;const n=this._cellService.getCell(t,r.uuid);!n||(e.cells=[n])}return i}createEmpty({uuid:e,viewId:t,viewRecord:r,sourceRecordId:n,direction:i,groupOption:o,modifierId:a}){let s=this._recordService.create({uuid:e,modifier_id:a});Array.isArray(s)||(s=[s]);let l=this._model.viewRecordModel.find({view_uuid:t});const c=l.findIndex((e=>e.record_uuid===n));for(const e of s)null!=o&&this._cellService.setCell(o.fieldId,e.uuid,{fieldId:o.fieldId,recordId:e.uuid,value:o.value});const u=s.map((e=>{const n={uuid:null==r?void 0:r.uuid,created_at:null==r?void 0:r.created_at,updated_at:null==r?void 0:r.updated_at,view_uuid:t,record_uuid:e.uuid};return null!=o&&(n.group_item_key=this._cellService.keyValue(o)),n}));if(this._model.viewRecordModel.bulkCreate(u),l=this._model.viewRecordModel.find({view_uuid:t}),c!==l.length-1){const e=rg.order(l,l.length-1,"after"===i?c+1:c);this._model.viewRecordModel.remove({view_uuid:t}),this._model.viewRecordModel.bulkCreate(e.map((e=>({uuid:e.uuid,view_uuid:e.view_uuid,record_uuid:e.record_uuid,group_item_key:e.group_item_key,hidden:e.hidden}))),{validate:!1})}return s}createRecord(e,t,r){const n=this.createEmpty({uuid:r.uuid,viewId:e,direction:"after",sourceRecordId:t}),i=Object.keys(r);for(const e of i){const t=this._fieldService.getField(e);if(!t)continue;let i=r[e];Array.isArray(i)||(i=[i]);for(const e of i)this._cellService.setCell(t.uuid,n[0].uuid,e)}return n}createRecords(e,t){this._recordService.bulkCreate(t),this._model.viewRecordModel.bulkCreate(t.map((t=>({view_uuid:e,record_uuid:t.uuid}))),{validate:!1})}copy(e,t){const r=this._model.viewRecordModel.find({view_uuid:e}),n=[];for(const e of r)!e||n.push({uuid:Io(32),view_uuid:t,record_uuid:e.record_uuid,hidden:e.hidden,group_item_key:e.group_item_key});this._model.viewRecordModel.bulkCreate(n)}copyRecord({uuid:e,viewId:t,sourceRecordId:r,modifierId:n}){const i=this._recordService.create({uuid:e,modifier_id:n});let o=this._model.viewRecordModel.find({view_uuid:t});const a=o.findIndex((e=>e.record_uuid===r)),s=o[a];if(!s)return;const l=this._model.viewFieldModel.find({view_uuid:t});for(const e of l)this._cellService.copy(e.field_uuid,s.record_uuid,e.field_uuid,i.uuid);if(this._model.viewRecordModel.create({uuid:Io(32),view_uuid:s.view_uuid,record_uuid:i.uuid,hidden:s.hidden,group_item_key:s.group_item_key}),o=this._model.viewRecordModel.find({view_uuid:t}),a!==o.length-1){const e=rg.order(o,o.length-1,a+1);this._model.viewRecordModel.remove({view_uuid:t}),this._model.viewRecordModel.bulkCreate(e.map((e=>({uuid:e.uuid,view_uuid:e.view_uuid,record_uuid:e.record_uuid,group_item_key:e.group_item_key,hidden:e.hidden}))),{validate:!1})}}remove(e,t){return this._model.viewRecordModel.remove({view_uuid:e,record_uuid:t}),this._recordService.remove(t)}removeAll(e){return this._model.viewRecordModel.remove({view_uuid:e}),this._recordService.removeAll()}updateOrder(e,t,r,n){if(null!=n){const r=this._model.viewRecordModel.findOne({view_uuid:e,record_uuid:t});this.updateGroupByViewRecord(r,n)}const i=this.getOriginViewRecords(e),o=i.findIndex((e=>e.record_uuid===t)),a=i.findIndex((e=>e.record_uuid===r)),s=i[a];let l={};s&&(l={view_uuid:e,record_uuid:s.record_uuid}),o<a?this._model.viewRecordModel.moveAfter(l,{view_uuid:e,record_uuid:t}):this._model.viewRecordModel.moveBefore(l,{view_uuid:e,record_uuid:t})}updateGroupByViewRecord(e,t){var r,n;if(e.group_item_key===(null==(r=null==t?void 0:t.groupOption)?void 0:r.value))return;const i=t.groupField.type,o=this._fieldRegistry.getValueField(i),a=t.groupField.uuid,s=e.record_uuid;this._cellService.removeByRecordId(a,s);const l=null==(n=null==t?void 0:t.groupOption)?void 0:n.value;if(o){const t=o.keyValue(l);this._model.viewRecordModel.update({view_uuid:e.view_uuid,record_uuid:e.record_uuid},{group_item_key:t}),this._cellService.setCell(a,s,{uuid:Io(32),fieldId:a,recordId:s,value:l||""})}else this._model.viewRecordModel.update({view_uuid:e.view_uuid,record_uuid:e.record_uuid},{group_item_key:""})}};Eg([to(Ov)],xg.prototype,"_model",2),Eg([to(pg)],xg.prototype,"_recordService",2),Eg([to(ag)],xg.prototype,"_fieldService",2),Eg([to(Bv)],xg.prototype,"_cellService",2),Eg([to(wg)],xg.prototype,"_groupService",2),Eg([to(Mv)],xg.prototype,"_fieldRegistry",2),xg=Eg([eo()],xg);var Sg=Object.defineProperty,kg=Object.getOwnPropertyDescriptor,Og=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?kg(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Sg(t,r,o),o};let Ig=class{getViewFilters(e,t=[]){const r=this._model.filterModel.find({view_uuid:e}),n=[];for(const e of r){const r=this._fieldService.getField(e.field_uuid);if(r){for(const n of t)"field"===n&&(e.field=r);n.push(e)}}return n}refresh(e){const t=this.getViewFilters(e);if(0===t.length)this._model.viewRecordModel.update({view_uuid:e},{hidden:!1});else{if(t.every((e=>(null==e.expected||""===e.expected)&&!Hh.includes(e.func))))return;const r=this._viewRecordService.getViewRecords(e,!1);if(this._groupService.isGroup(e))for(const n of r)this.refreshViewRecord(e,n.records||[],t);else this.refreshViewRecord(e,r,t)}}refreshViewRecord(e,t,r){t=t||this._model.viewRecordModel.find({view_uuid:e}),r=r||this.getViewFilters(e);const n={false:[],true:[]};for(const e of t){const t=this.checkIsFilterMatch(e.record_uuid,r);!0===t&&!1===e.hidden||!1===t&&e.hidden||(t?n.false.push(e):n.true.push(e))}n.true.length>0&&this._model.viewRecordModel.update({view_uuid:e,record_uuid:n.true.map((e=>e.record_uuid))},{hidden:!0}),n.false.length>0&&this._model.viewRecordModel.update({view_uuid:e,record_uuid:n.false.map((e=>e.record_uuid))},{hidden:!1})}checkIsFilterMatch(e,t,r){let n=!1;return n="and"===(t[0].operator||"and")?t.every((t=>this._checkFilter(t,e,r))):t.some((t=>this._checkFilter(t,e,r))),n}_checkFilter(e,t,r){if((null==e.expected||""===e.expected)&&!Hh.includes(e.func))return!0;r||(r=this._cellService.getCellKeyValue(e.field_uuid,t));const n=this._fieldService.getField(e.field_uuid);if(!n)return!1;const i=Uh[n.type];let o=e.expected;return Kh.isMultiple(n.type)&&"string"==typeof o&&(o&&(o=o.split(",")),r&&(r=r.split(","))),this._matchCondition(r,i,e.func,o)}_matchCondition(e,t,r,n){if("text"===t||"file"===t||"select"===t){const t=null==e?"":e+"";return this._filterFuncService[r](t,n)}return"number"===t?(null==e||!isNaN(e))&&this._filterFuncService[r](""===e||null==e?"":parseFloat(e),parseFloat(n)):"timePeriod"===t?""===e||null==e?this._filterFuncService[r](""):this._filterFuncService[r](Td(e)):("checkbox"===t&&(e=e?"true":"false",n=!0===n||"true"===n?"true":"false"),"multiSelect"===t&&(e?"string"==typeof e&&(e=e.split(",")):e=[]),("multiSelect"===t||"checkbox"===t)&&this._filterFuncService[r](e,n))}create(e,t){const r=this._model.filterModel.create({uuid:t.uuid,view_uuid:e,field_uuid:t.field_uuid,func:t.func,expected:t.expected,operator:t.operator});return this.refresh(e),r}remove(e){const t=this._model.filterModel.findOne({uuid:e});return t?(this._model.filterModel.remove({view_uuid:t.view_uuid,uuid:e}),this.refresh(t.view_uuid),t):null}removeByViewId(e){const t=this._model.filterModel.findOne({view_uuid:e});if(t)return this.remove(t.uuid)}update(e,t){let r=[];for(t of(r=Array.isArray(t)?t:[t],r))this._model.filterModel.update({uuid:t.uuid},{field_uuid:t.field_uuid,view_uuid:e,func:t.func,expected:t.expected,operator:t.operator});this.refresh(e)}copy(e,t){const r=this._model.filterModel.find({view_uuid:e});!r||0===r.length||this._model.filterModel.bulkCreate(r.map((e=>({view_uuid:t,field_uuid:e.field_uuid,operator:e.operator,func:e.func,expected:e.expected}))))}};Og([to(Ov)],Ig.prototype,"_model",2),Og([to(ag)],Ig.prototype,"_fieldService",2),Og([to(Bv)],Ig.prototype,"_cellService",2),Og([to(cg)],Ig.prototype,"_filterFuncService",2),Og([to(wg)],Ig.prototype,"_groupService",2),Og([to(xg)],Ig.prototype,"_viewRecordService",2),Ig=Og([eo()],Ig);var Rg=Object.defineProperty,Tg=Object.getOwnPropertyDescriptor,Ag=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Tg(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Rg(t,r,o),o};let Ng=class{getViewFieldGroups(e){return this._model.fieldGroupModel.find({view_uuid:e})||[]}hasFieldGroup(e){return this.getViewFieldGroups(e).length>0}getFieldGroupById(e,t){return this._model.fieldGroupModel.findOne({view_uuid:e,uuid:t})}create(e,t){return this._model.fieldGroupModel.create({view_uuid:e,name:t.name})}remove(e,t){this._model.fieldGroupModel.remove({view_uuid:e,uuid:t}),this._model.viewFieldModel.update({view_uuid:e,group_uuid:t},{group_uuid:""})}update(e,t){return this._model.fieldGroupModel.update({view_uuid:e,uuid:t.uuid},{name:t.name})}};Ag([to(Ov)],Ng.prototype,"_model",2),Ng=Ag([eo()],Ng);var Mg=1e6,Pg=1e6,jg="[big.js] ",Dg=jg+"Invalid ",Fg=Dg+"decimal places",Vg=Dg+"rounding mode",Lg=jg+"Division by zero",$g={},Bg=void 0,zg=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function Ug(e,t,r,n){var i=e.c;if(r===Bg&&(r=e.constructor.RM),0!==r&&1!==r&&2!==r&&3!==r)throw Error(Vg);if(t<1)n=3===r&&(n||!!i[0])||0===t&&(1===r&&i[0]>=5||2===r&&(i[0]>5||5===i[0]&&(n||i[1]!==Bg))),i.length=1,n?(e.e=e.e-t+1,i[0]=1):i[0]=e.e=0;else if(t<i.length){if(n=1===r&&i[t]>=5||2===r&&(i[t]>5||5===i[t]&&(n||i[t+1]!==Bg||1&i[t-1]))||3===r&&(n||!!i[0]),i.length=t,n)for(;++i[--t]>9;)if(i[t]=0,0===t){++e.e,i.unshift(1);break}for(t=i.length;!i[--t];)i.pop()}return e}function Hg(e,t,r){var n=e.e,i=e.c.join(""),o=i.length;if(t)i=i.charAt(0)+(o>1?"."+i.slice(1):"")+(n<0?"e":"e+")+n;else if(n<0){for(;++n;)i="0"+i;i="0."+i}else if(n>0)if(++n>o)for(n-=o;n--;)i+="0";else n<o&&(i=i.slice(0,n)+"."+i.slice(n));else o>1&&(i=i.charAt(0)+"."+i.slice(1));return e.s<0&&r?"-"+i:i}$g.abs=function(){var e=new this.constructor(this);return e.s=1,e},$g.cmp=function(e){var t,r=this,n=r.c,i=(e=new r.constructor(e)).c,o=r.s,a=e.s,s=r.e,l=e.e;if(!n[0]||!i[0])return n[0]?o:i[0]?-a:0;if(o!=a)return o;if(t=o<0,s!=l)return s>l^t?1:-1;for(a=(s=n.length)<(l=i.length)?s:l,o=-1;++o<a;)if(n[o]!=i[o])return n[o]>i[o]^t?1:-1;return s==l?0:s>l^t?1:-1},$g.div=function(e){var t=this,r=t.constructor,n=t.c,i=(e=new r(e)).c,o=t.s==e.s?1:-1,a=r.DP;if(a!==~~a||a<0||a>Mg)throw Error(Fg);if(!i[0])throw Error(Lg);if(!n[0])return e.s=o,e.c=[e.e=0],e;var s,l,c,u,d,f=i.slice(),p=s=i.length,h=n.length,m=n.slice(0,s),v=m.length,g=e,y=g.c=[],b=0,w=a+(g.e=t.e-e.e)+1;for(g.s=o,o=w<0?0:w,f.unshift(0);v++<s;)m.push(0);do{for(c=0;c<10;c++){if(s!=(v=m.length))u=s>v?1:-1;else for(d=-1,u=0;++d<s;)if(i[d]!=m[d]){u=i[d]>m[d]?1:-1;break}if(!(u<0))break;for(l=v==s?i:f;v;){if(m[--v]<l[v]){for(d=v;d&&!m[--d];)m[d]=9;--m[d],m[v]+=10}m[v]-=l[v]}for(;!m[0];)m.shift()}y[b++]=u?c:++c,m[0]&&u?m[v]=n[p]||0:m=[n[p]]}while((p++<h||m[0]!==Bg)&&o--);return!y[0]&&1!=b&&(y.shift(),g.e--,w--),b>w&&Ug(g,w,r.RM,m[0]!==Bg),g},$g.eq=function(e){return 0===this.cmp(e)},$g.gt=function(e){return this.cmp(e)>0},$g.gte=function(e){return this.cmp(e)>-1},$g.lt=function(e){return this.cmp(e)<0},$g.lte=function(e){return this.cmp(e)<1},$g.minus=$g.sub=function(e){var t,r,n,i,o=this,a=o.constructor,s=o.s,l=(e=new a(e)).s;if(s!=l)return e.s=-l,o.plus(e);var c=o.c.slice(),u=o.e,d=e.c,f=e.e;if(!c[0]||!d[0])return d[0]?e.s=-l:c[0]?e=new a(o):e.s=1,e;if(s=u-f){for((i=s<0)?(s=-s,n=c):(f=u,n=d),n.reverse(),l=s;l--;)n.push(0);n.reverse()}else for(r=((i=c.length<d.length)?c:d).length,s=l=0;l<r;l++)if(c[l]!=d[l]){i=c[l]<d[l];break}if(i&&(n=c,c=d,d=n,e.s=-e.s),(l=(r=d.length)-(t=c.length))>0)for(;l--;)c[t++]=0;for(l=t;r>s;){if(c[--r]<d[r]){for(t=r;t&&!c[--t];)c[t]=9;--c[t],c[r]+=10}c[r]-=d[r]}for(;0===c[--l];)c.pop();for(;0===c[0];)c.shift(),--f;return c[0]||(e.s=1,c=[f=0]),e.c=c,e.e=f,e},$g.mod=function(e){var t,r=this,n=r.constructor,i=r.s,o=(e=new n(e)).s;if(!e.c[0])throw Error(Lg);return r.s=e.s=1,t=1==e.cmp(r),r.s=i,e.s=o,t?new n(r):(i=n.DP,o=n.RM,n.DP=n.RM=0,r=r.div(e),n.DP=i,n.RM=o,this.minus(r.times(e)))},$g.neg=function(){var e=new this.constructor(this);return e.s=-e.s,e},$g.plus=$g.add=function(e){var t,r,n,i=this,o=i.constructor;if(e=new o(e),i.s!=e.s)return e.s=-e.s,i.minus(e);var a=i.e,s=i.c,l=e.e,c=e.c;if(!s[0]||!c[0])return c[0]||(s[0]?e=new o(i):e.s=i.s),e;if(s=s.slice(),t=a-l){for(t>0?(l=a,n=c):(t=-t,n=s),n.reverse();t--;)n.push(0);n.reverse()}for(s.length-c.length<0&&(n=c,c=s,s=n),t=c.length,r=0;t;s[t]%=10)r=(s[--t]=s[t]+c[t]+r)/10|0;for(r&&(s.unshift(r),++l),t=s.length;0===s[--t];)s.pop();return e.c=s,e.e=l,e},$g.pow=function(e){var t=this,r=new t.constructor("1"),n=r,i=e<0;if(e!==~~e||e<-Pg||e>Pg)throw Error(Dg+"exponent");for(i&&(e=-e);1&e&&(n=n.times(t)),e>>=1;)t=t.times(t);return i?r.div(n):n},$g.prec=function(e,t){if(e!==~~e||e<1||e>Mg)throw Error(Dg+"precision");return Ug(new this.constructor(this),e,t)},$g.round=function(e,t){if(e===Bg)e=0;else if(e!==~~e||e<-Mg||e>Mg)throw Error(Fg);return Ug(new this.constructor(this),e+this.e+1,t)},$g.sqrt=function(){var e,t,r,n=this,i=n.constructor,o=n.s,a=n.e,s=new i("0.5");if(!n.c[0])return new i(n);if(o<0)throw Error(jg+"No square root");0===(o=Math.sqrt(n+""))||o===1/0?((t=n.c.join("")).length+a&1||(t+="0"),a=((a+1)/2|0)-(a<0||1&a),e=new i(((o=Math.sqrt(t))==1/0?"5e":(o=o.toExponential()).slice(0,o.indexOf("e")+1))+a)):e=new i(o+""),a=e.e+(i.DP+=4);do{r=e,e=s.times(r.plus(n.div(r)))}while(r.c.slice(0,a).join("")!==e.c.slice(0,a).join(""));return Ug(e,(i.DP-=4)+e.e+1,i.RM)},$g.times=$g.mul=function(e){var t,r=this,n=r.constructor,i=r.c,o=(e=new n(e)).c,a=i.length,s=o.length,l=r.e,c=e.e;if(e.s=r.s==e.s?1:-1,!i[0]||!o[0])return e.c=[e.e=0],e;for(e.e=l+c,a<s&&(t=i,i=o,o=t,c=a,a=s,s=c),t=new Array(c=a+s);c--;)t[c]=0;for(l=s;l--;){for(s=0,c=a+l;c>l;)s=t[c]+o[l]*i[c-l-1]+s,t[c--]=s%10,s=s/10|0;t[c]=s}for(s?++e.e:t.shift(),l=t.length;!t[--l];)t.pop();return e.c=t,e},$g.toExponential=function(e,t){var r=this,n=r.c[0];if(e!==Bg){if(e!==~~e||e<0||e>Mg)throw Error(Fg);for(r=Ug(new r.constructor(r),++e,t);r.c.length<e;)r.c.push(0)}return Hg(r,!0,!!n)},$g.toFixed=function(e,t){var r=this,n=r.c[0];if(e!==Bg){if(e!==~~e||e<0||e>Mg)throw Error(Fg);for(e=e+(r=Ug(new r.constructor(r),e+r.e+1,t)).e+1;r.c.length<e;)r.c.push(0)}return Hg(r,!1,!!n)},$g[Symbol.for("nodejs.util.inspect.custom")]=$g.toJSON=$g.toString=function(){var e=this,t=e.constructor;return Hg(e,e.e<=t.NE||e.e>=t.PE,!!e.c[0])},$g.toNumber=function(){var e=Number(Hg(this,!0,!0));if(!0===this.constructor.strict&&!this.eq(e.toString()))throw Error(jg+"Imprecise conversion");return e},$g.toPrecision=function(e,t){var r=this,n=r.constructor,i=r.c[0];if(e!==Bg){if(e!==~~e||e<1||e>Mg)throw Error(Dg+"precision");for(r=Ug(new n(r),e,t);r.c.length<e;)r.c.push(0)}return Hg(r,e<=r.e||r.e<=n.NE||r.e>=n.PE,!!i)},$g.valueOf=function(){var e=this,t=e.constructor;if(!0===t.strict)throw Error(jg+"valueOf disallowed");return Hg(e,e.e<=t.NE||e.e>=t.PE,!0)};var Wg=function e(){function t(r){var n=this;if(!(n instanceof t))return r===Bg?e():new t(r);if(r instanceof t)n.s=r.s,n.e=r.e,n.c=r.c.slice();else{if("string"!=typeof r){if(!0===t.strict&&"bigint"!=typeof r)throw TypeError(Dg+"value");r=0===r&&1/r<0?"-0":String(r)}!function(e,t){var r,n,i;if(!zg.test(t))throw Error(Dg+"number");for(e.s="-"==t.charAt(0)?(t=t.slice(1),-1):1,(r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),i=t.length,n=0;n<i&&"0"==t.charAt(n);)++n;if(n==i)e.c=[e.e=0];else{for(;i>0&&"0"==t.charAt(--i););for(e.e=r-n-1,e.c=[],r=0;n<=i;)e.c[r++]=+t.charAt(n++)}}(n,r)}n.constructor=t}return t.prototype=$g,t.DP=20,t.RM=1,t.NE=-7,t.PE=21,t.strict=false,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}();function Gg(e,t,r){let n;e=""===e||null===e?0:e,t=""===t||null===t?0:t;try{n=(e=new Wg(e))[r](t).valueOf()}catch{n=NaN}return n}const Kg=(e,t)=>Gg(e,t,"plus"),qg=(e,t)=>Gg(e,t,"times"),Yg=(e,t)=>isNaN(e)?NaN:""===t||0===parseFloat(t)?1/0:Gg(e,t,"div"),Xg=(e,t)=>Gg(e,t,"lt");var Zg=Object.defineProperty,Jg=Object.getOwnPropertyDescriptor;let Qg=class{sort(e,t,r){return t=this.ascSortCreatedAt(t),t=Kh.isSelectLike(r.type)?"asc"===e?this.ascSortSelect(t,r):this.descSortSelect(t,r):[Rh.NUMBER,Rh.CHECKBOX].includes(r.type)?"asc"===e?this.ascSortNumber(t):this.descSortNumber(t):Kh.isDate(r.type)?"asc"===e?this.ascSortDate(t):this.descSortDate(t):"asc"===e?this.ascSortText(t):this.descSortText(t)}ascSortCreatedAt(e){return e.sort(((e,t)=>+new Date(e.record.created_at)-+new Date(t.record.created_at)))}ascSortText(e){return e.sort(((e,t)=>{const r=e.sortValue||"",n=t.sortValue||"";return r.localeCompare(n)}))}descSortText(e){return e.sort(((e,t)=>{const r=e.sortValue||"";return(t.sortValue||"").localeCompare(r)}))}ascSortNumber(e){return e.sort(((e,t)=>{const r=e.sortValue||"",n=t.sortValue||"";return r===n?0:Xg(r,n)?-1:1}))}descSortNumber(e){return e.sort(((e,t)=>{const r=e.sortValue||"",n=t.sortValue||"";return r===n?0:Xg(n,r)?-1:1}))}ascSortDate(e){return e.sort(((e,t)=>{const r=e.sortValue||"",n=t.sortValue||"";return Td(r).unix()-Td(n).unix()}))}descSortDate(e){return e.sort(((e,t)=>{const r=e.sortValue||"",n=t.sortValue||"";return Td(n).unix()-Td(r).unix()}))}ascSortSelect(e,t){var r;const n=null==(r=t.options)?void 0:r.map((e=>e.uuid));return this._getViewRecordsOrderByOptions(e,n,t)}descSortSelect(e,t){var r;const n=null==(r=t.options)?void 0:r.map((e=>e.uuid)).reverse();return this._getViewRecordsOrderByOptions(e,n,t)}_getViewRecordsOrderByOptions(e,t,r){const n=t.reduce(((e,t)=>(e[t]=[],e)),{}),i=[];for(const t of e){const e=t.cells[t.cellMap.get(r.uuid)];if(e&&(Kh.isSelect(r.type)&&null!=e.value||Kh.isMultiSelect(r.type)&&0!==e.value.length)){const r=Array.isArray(e.value)?e.value[0]:e.value;n[r].push(t)}else i.push(t)}let o=[];return t.forEach((e=>{o=o.concat(n[e])})),o=o.concat(i),o}};Qg=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Jg(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Zg(t,r,o),o})([eo()],Qg);var ey=Object.defineProperty,ty=Object.getOwnPropertyDescriptor,ry=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ty(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ey(t,r,o),o};let ny=class{getViewSort(e){return this._model.sortModel.findOne({view_uuid:e})}isKeepSort(e){const t=this._model.viewConfigModel.findOne({view_uuid:e});return!(null==t||!t.keep_sort)}create(e,t,r){if(!this._fieldService.getField(t.field_uuid))return;const n=this._model.sortModel.create({view_uuid:e,field_uuid:t.field_uuid,type:t.type});return this._model.viewConfigModel.update({view_uuid:e},{keep_sort:r}),this.refresh(e),r||this.remove(e),n}remove(e){const t=this._model.sortModel.remove({view_uuid:e});return this._model.viewConfigModel.update({view_uuid:e},{keep_sort:!1}),this.refresh(e),t}update(e,t,r){const n=this._model.sortModel.upsert({view_uuid:e},{view_uuid:e,field_uuid:t.field_uuid,type:t.type});return this._model.viewConfigModel.update({view_uuid:e},{keep_sort:r}),this.refresh(e),r||this.remove(e),n}copy(e,t){const r=this._model.sortModel.find({view_uuid:e});if(r&&0!==r.length){for(const e of r)delete e.uuid,e.view_uuid=t;this._model.sortModel.bulkCreate(r.map((e=>({view_uuid:e.view_uuid,field_uuid:e.field_uuid,type:e.type}))))}}refresh(e){const t=this._model.viewModel.findOne({uuid:e}),r=this.getViewSort(e);if(!r)return;let n=this._viewRecordService.getViewRecords(e);const i=this._fieldService.getField(r.field_uuid);if(this._groupService.getViewGroup(e))for(const o of n){if(!o.records)continue;const n={...r};t.type===Wh.KANBAN&&(r.type&&"asc"!==r.type?"desc"===r.type&&(n.type="asc"):n.type="desc");const a=this._sortViewRecords(o.records,n,i);this._model.viewRecordModel.remove({view_uuid:e,record_uuid:a.map((e=>e.record_uuid))}),this._model.viewRecordModel.bulkCreate(a.map((e=>({uuid:e.uuid,view_uuid:e.view_uuid,record_uuid:e.record_uuid,group_item_key:e.group_item_key}))))}else n=this._sortViewRecords(n,r,i),this._model.viewRecordModel.remove({view_uuid:e,record_uuid:n.map((e=>e.record_uuid))}),this._model.viewRecordModel.bulkCreate(n.map((e=>({uuid:e.uuid,view_uuid:e.view_uuid,record_uuid:e.record_uuid,group_item_key:e.group_item_key}))))}_sortViewRecords(e,t,r){let n=[];const i=[];return e.forEach((e=>{e.sortValue=this._cellService.getCellFormattedValue(t.field_uuid,e.record_uuid),Kh.isCheckbox(null==r?void 0:r.type)&&("是"===e.sortValue||"true"===e.sortValue?e.sortValue=1:e.sortValue=0),""===e.sortValue||null==e.sortValue?i.push(e):n.push(e)})),n=this._sortFuncService.sort(t.type,n,r),n=[...n,...i],n}};ry([to(Ov)],ny.prototype,"_model",2),ry([to(Qg)],ny.prototype,"_sortFuncService",2),ry([to(xg)],ny.prototype,"_viewRecordService",2),ry([to(ag)],ny.prototype,"_fieldService",2),ry([to(Bv)],ny.prototype,"_cellService",2),ry([to(wg)],ny.prototype,"_groupService",2),ny=ry([eo()],ny);const iy=Object.values(Bh);var oy=Object.defineProperty,ay=Object.getOwnPropertyDescriptor;function sy(e,t){if(0===t)return"";const r=qg(Yg(e,t),100);return-1===r.indexOf(".")?r+"%":parseFloat(r).toFixed(2)+"%"}let ly=class{count(e){return e.length}sum(e){return e.reduce(((e,t)=>Kg(e,t)),0)}average(e){const t=this.sum(e),r=Yg(t,e.length);return isNaN(r)?0:parseFloat(r).toFixed(2)}max(e){return 0===(e=e.filter((e=>""!==e))).length?"":Math.max(...e)}min(e){return 0===(e=e.filter((e=>""!==e))).length?"":Math.min(...e)}filled(e){return e.filter((e=>""!==e)).length}empty(e){return e.filter((e=>""===e)).length}unique(e){const t={};return e.forEach((e=>{""!==e&&(t[e]=!0)})),Object.keys(t).length}percentFilled(e){return sy(this.filled(e),e.length)}percentEmpty(e){return sy(this.empty(e),e.length)}percentUnique(e){return sy(this.unique(e),e.length)}earliestDate(e){let t=e[0];for(let r=1;r<e.length;r++)""!==e[r]&&(e[r]<t||""===t)&&(t=e[r]);return t}latestDate(e){let t=e[0];for(let r=1;r<e.length;r++)""!==e[r]&&e[r]>t&&(t=e[r]);return t}dateRange(e){let t=e[0],r=e[0];for(let n=1;n<e.length;n++)""!==e[n]&&e[n]>r?r=e[n]:""!==e[n]&&(e[n]<t||""===t)&&(t=e[n]);return r===t||""===t?0:Td(r).diff(Td(t),"days")}monthRange(e){let t=e[0],r=e[0];for(let n=1;n<e.length;n++)""!==e[n]&&e[n]>r?r=e[n]:""!==e[n]&&(e[n]<t||""===t)&&(t=e[n]);return r===t||""===t?0:Td(r).diff(Td(t),"months")}checked(e){return e.reduce(((e,t)=>"是"===t||"true"===t||!0===t?e+1:e),0)}unchecked(e){return e.reduce(((e,t)=>"是"!==t&&"true"!==t&&!0!==t?e+1:e),0)}percentChecked(e){return sy(this.checked(e),e.length)}percentUnchecked(e){return sy(this.unchecked(e),e.length)}};ly=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?ay(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&oy(t,r,o),o})([eo()],ly);var cy=Object.defineProperty,uy=Object.getOwnPropertyDescriptor,dy=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?uy(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&cy(t,r,o),o};let fy=class{getViewStats(e){const t=this._model.statModel.find({view_uuid:e});if(0!==t.length){for(const e of t)iy.includes(e.type);return t}}getStatValue(e,t,r=[]){const n=this._model.statModel.findOne({view_uuid:e,field_uuid:t});if(n&&0!==r.length)return n.value=this._calc(n,r),n}_calc(e,t){const r=[];for(const n of t){const t=this._cellService.getCellFormattedValue(e.field_uuid,n);t?r.push(t):r.push("")}return this._statFuncService[e.type]?this._statFuncService[e.type](r):null}upsert(e,t,r){this._model.statModel.upsert({view_uuid:e,field_uuid:t},{view_uuid:e,field_uuid:t,type:r})}remove(e,t){this._model.statModel.remove({view_uuid:e,field_uuid:t})}copy(e,t){const r=this._model.statModel.find({view_uuid:e});!r||0===r.length||this._model.statModel.bulkCreate(r.map((e=>({view_uuid:t,field_uuid:e.field_uuid,type:e.type}))))}};dy([to(Ov)],fy.prototype,"_model",2),dy([to(ly)],fy.prototype,"_statFuncService",2),dy([to(Bv)],fy.prototype,"_cellService",2),fy=dy([eo()],fy);var py=Object.defineProperty,hy=Object.getOwnPropertyDescriptor,my=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?hy(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&py(t,r,o),o};let vy=class{getViewConfig(e){return this._model.viewConfigModel.findOne({view_uuid:e})}create(e){const t=this._model.viewModel.findById(e);if(!t)return;const r=Gh[t.type];if(t.type===Wh.CARD){const e=this._model.fieldModel.findOne({type:Rh.IMAGE});return this._model.viewConfigModel.create({view_uuid:t.uuid,show_field_name:r.showFiledName,cover_field_uuid:(null==e?void 0:e.uuid)||null,cover_display:r.coverDisplay})}return t.type===Wh.KANBAN?this._model.viewConfigModel.create({view_uuid:t.uuid,show_field_name:r.showFiledName}):this._model.viewConfigModel.create({view_uuid:t.uuid})}update(e,t={}){if(e)return this._model.viewConfigModel.upsert({view_uuid:e},{view_uuid:e,...t})}copy(e,t){const r=this.getViewConfig(e);!r||(delete r.uuid,r.view_uuid=t,this._model.viewConfigModel.create(r))}refresh(e){const t=this.getViewConfig(e);if(!t)return this.create(e);t.cover_field_uuid&&(this._model.fieldModel.findOne({uuid:t.cover_field_uuid})||this.update(e,{cover_field_uuid:null}))}};my([to(Ov)],vy.prototype,"_model",2),vy=my([eo()],vy);var gy=Object.defineProperty,yy=Object.getOwnPropertyDescriptor,by=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?yy(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&gy(t,r,o),o};let wy=class{getViewFields(e,t=!0){const r={view_uuid:e};t&&(r.hidden={$not:!0});const n=this._model.viewFieldModel.find(r);for(const e of n){const t=this._fieldService.getField(e.field_uuid);e.field=t}return n}getViewFieldsCount(e,t=!0){const r={view_uuid:e};return t&&(r.hidden={$not:!0}),(this._model.viewFieldModel.find(r)||[]).length}getAllViewFields(e){return this.getViewFields(e,!1)}getViewField(e,t){const r=this._model.viewFieldModel.findOne({view_uuid:e,field_uuid:t});if(!r)return null;const n=this._fieldService.getField(t);return r.field=n,r}create({viewId:e,field:t,viewField:r,sourceFieldId:n,direction:i}){const o=this._model.viewModel.findOne({uuid:e});if(!o)return;const a=Kh.isMultiple(t.type),s=this._fieldService.create({...t,multiple:a});let l=this._model.viewFieldModel.find({view_uuid:e});const c=l.findIndex((e=>e.field_uuid===n)),u={uuid:null==r?void 0:r.uuid,size:null==r?void 0:r.size,created_at:null==r?void 0:r.created_at,updated_at:null==r?void 0:r.updated_at,view_uuid:e,field_uuid:s.uuid};if(o.type===Wh.FORM&&(u.required=!0),this._model.viewFieldModel.create(u),l=this._model.viewFieldModel.find({view_uuid:e}),c!==l.length-1){const t=this._model.viewFieldModel.find({view_uuid:e}),r=rg.order(t,t.length-1,"after"===i?c+1:c);this._model.viewFieldModel.remove({view_uuid:e}),this._model.viewFieldModel.bulkCreate(r)}return s}copy(e,t,r=(e=>!1)){const n=this.getAllViewFields(e),i=[];for(const e of n)r(e)||i.push({field_uuid:e.field_uuid,view_uuid:t,name:e.name,size:e.size,display_type:e.display_type,required:e.required,hidden:e.hidden});this._model.viewFieldModel.bulkCreate(i)}insert(e,t){const r=this._model.viewModel.findOne({uuid:t}),n=this._model.fieldModel.findOne({uuid:e});if(r&&n)return this._model.viewFieldModel.upsert({view_uuid:r.uuid,field_uuid:n.uuid},{view_uuid:r.uuid,field_uuid:n.uuid})}remove(e,t,r){const n={field_uuid:e,view_uuid:t};if(this._model.viewFieldModel.remove(n),!r)return this._fieldService.remove(e)}update(e,t,r,n){return this._model.viewFieldModel.update({view_uuid:e,field_uuid:t},{[r]:n})}updateOrder(e,t,r){const n=this._model.viewFieldModel.find({view_uuid:e}),i=n.findIndex((e=>e.field_uuid===t)),o=r?n.findIndex((e=>e.field_uuid===r)):0,a=n[o];i<o?this._model.viewFieldModel.moveAfter({view_uuid:e,field_uuid:null==a?void 0:a.field_uuid},{view_uuid:e,field_uuid:t}):this._model.viewFieldModel.moveBefore({view_uuid:e,field_uuid:null==a?void 0:a.field_uuid},{view_uuid:e,field_uuid:t})}refresh(e){const t=this.getViewFields(e,!1),r=this._model.fieldModel.find({}),n=r.reduce(((e,t)=>(e[t.uuid]=!0,e)),{}),i=this._viewConfigService.getViewConfig(e);if(i.cover_field_uuid&&!n[i.cover_field_uuid]){const t=r.find((e=>e.type===Rh.IMAGE));t&&this._viewConfigService.update(e,{cover_field_uuid:t.uuid})}for(const e of t)n[e.field_uuid]?delete n[e.field_uuid]:this._model.viewFieldModel.remove({field_uuid:e.field_uuid,view_uuid:e.view_uuid});const o=Object.keys(n);if(o.length>0)for(const t of o)this._model.viewFieldModel.create({view_uuid:e,field_uuid:t})}clone(e,t,r){var n;const i=this._model.viewFieldModel.findOne({view_uuid:e,field_uuid:t});if(!i)return;const o=this._model.fieldModel.findOne({uuid:i.field_uuid}),a=this.getViewFieldName(i.view_uuid,o.type,null==i?void 0:i.name);this._fieldService.clone(i.field_uuid,r);const s=this._model.viewFieldModel.create({view_uuid:i.view_uuid,field_uuid:r,size:null==i?void 0:i.size,name:a,display_type:i.display_type,required:i.required}),l=this._model.viewFieldModel.find(),c=l.findIndex((e=>e.field_uuid===t));return this.updateOrder(i.view_uuid,r,null==(n=l[c+1])?void 0:n.field_uuid),s}getViewFieldName(e,t,r){const n=this._model.fieldModel.find({type:t}),i=this._model.viewFieldModel.find({view_uuid:e}),o=n.length,a=e=>{var n;const o=(r||(null==(n=Mh.find((e=>e.type===t)))?void 0:n.name))+" "+e;return i.find((e=>e.name===o))?a(e+1):o};return a(o)}updateGroup(e,t,r){this._model.viewFieldModel.update({view_uuid:e,field_uuid:t},{group_uuid:r?r.uuid:""})}};by([to(Ov)],wy.prototype,"_model",2),by([to(ag)],wy.prototype,"_fieldService",2),by([to(vy)],wy.prototype,"_viewConfigService",2),wy=by([eo()],wy);var _y=Object.defineProperty,Cy=Object.getOwnPropertyDescriptor,Ey=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Cy(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&_y(t,r,o),o};let xy=class{getView(e){return this._model.viewModel.findById(e)}getViews(e){const t={};return null!=e&&e.skipType&&(t.type={$not:e.skipType}),null!=e&&e.type&&(t.type=e.type),this._model.viewModel.find(t)}getActiveView(){var e;const t=null==(e=this._model.tableModel.find()[0])?void 0:e.active_view_uuid,r=this._model.viewModel.find();if(!t)return r[0];let n=this.getView(t);return n||(n=r[0]),n}create(e){var t;const r=null==(t=this.getActiveView())?void 0:t.uuid,n=this._model.viewModel.create({uuid:e.uuid,name:e.name,type:e.type});return e.name&&(n.name=e.name),e.type&&(n.type=e.type),this._viewConfigServivce.create(n.uuid),r&&(this._viewFieldService.copy(r,n.uuid,(e=>n.type===Wh.FORM&&Kh.isSystemType(e.field.type))),this._viewRecordService.copy(r,n.uuid)),e.type===Wh.CARD?this._createCard(n.uuid):e.type===Wh.KANBAN?this._createKanban(n.uuid):e.type===Wh.FORM&&this._createForm(n.uuid),this.refresh(n.uuid),n}_createCard(e){const t=this._viewFieldService.getViewFields(e);let r;let n=0;for(const e of t)e.field.type===Rh.IMAGE&&(r||(r=e.field.id)),this._model.viewFieldModel.update({view_uuid:e.view_uuid,field_uuid:e.field_uuid},{hidden:n>=3}),n++;r&&this._model.viewConfigModel.update({view_uuid:e},{cover_field_uuid:r})}_createKanban(e){const t=this._fieldService.getFields(),r=this._getKanbanGroupField(t);r&&this._groupService.create(e,{field_uuid:r.uuid})}_createForm(e){const t=this._viewFieldService.getViewFields(e);for(const e of t)Kh.isSystemType(e.field.type)?this._model.viewFieldModel.remove({view_uuid:e.view_uuid,field_uuid:e.field_uuid}):this._model.viewFieldModel.update({view_uuid:e.view_uuid,field_uuid:e.field_uuid},{required:!0})}_getKanbanGroupField(e){const t=[Rh.SELECT,Rh.MENTION],r=[];for(const n of t)for(const t of e)n===(null==t?void 0:t.type)&&r.push(t);for(const e of r)if((null==e?void 0:e.type)===Rh.SELECT&&e.color)return e;if(0===r.length){const e=Nh.find((e=>e.type===Rh.SELECT)),t=this._fieldService.create({name:e.name,type:e.type,color:e.color,multiple:!!e.multiple,options:e.options});return this._fieldService.getField(t.uuid)}return r[0]}createByType(e,t){const r=this._model.viewModel.find({type:t});let n=Gh[t].name;return r.length>0&&(n+=r.length),this.create({uuid:e,name:n,type:t})}update(e,t){if(!this.getView(e))throw new Error(`视图 ${e} 没有找到`);return this._model.viewModel.update({uuid:e},{...t})}remove(e){if(!this.getView(e))throw new Error(`view not found. id: ${e}`);return this._model.viewRecordModel.remove({view_uuid:e}),this._groupService.remove(e),this._sortService.remove(e),this._filterService.removeByViewId(e),this._model.viewModel.remove({uuid:e})}copy(e,t){if(!e||!t)return;const r=this.getView(t);if(!r)throw new Error(`view not found. id: ${t}`);const n=r.name+` (${kf("副本")})`,i=r.type,o=this._model.viewModel.create({uuid:e,name:n,type:i});return this._viewConfigServivce.copy(t,e),this._viewFieldService.copy(t,e),this._viewRecordService.copy(t,e),this._groupService.copy(t,e),this._sortService.copy(t,e),this._filterService.copy(t,e),this._statService.copy(t,e),o}updateOrder(e,t){const r=this._model.viewModel.find(),n=r.findIndex((t=>t.uuid===e));let i=r.findIndex((e=>e.uuid===t));n<i&&(i=Math.min(i,r.length-1));const o=r[i];let a={};o&&(a={uuid:o.uuid}),n<i?this._model.viewModel.moveAfter(a,{uuid:e}):this._model.viewModel.moveBefore(a,{uuid:e})}refresh(e){const t=this.getView(e);if(t.type===Wh.FORM)return;let r=this._groupService.getViewGroup(e);t.type===Wh.KANBAN&&(r||(r=this._groupService.createDefaultKanbanViewGroup(e))),this._viewConfigServivce.refresh(e),this._viewFieldService.refresh(e);const n={};this._model.recordModel.find().forEach((e=>{n[e.uuid]=!0}));let i=this._model.viewRecordModel.find({view_uuid:e});const o=[];for(const e of i)if(n[e.record_uuid]){if(r&&null==e.group_item_key){o.push(e.record_uuid);continue}delete n[e.record_uuid]}else o.push(e.record_uuid);o.length>0&&this._model.viewRecordModel.remove({view_uuid:e,record_uuid:o});const a=this._filterService.getViewFilters(e),s=Object.keys(n);if(s.length>0){const t=s.map((t=>({uuid:Io(32),view_uuid:e,record_uuid:t})));this._model.viewRecordModel.bulkCreate(t)}i=this._model.viewRecordModel.find({view_uuid:e}),r&&this._groupService.refreshViewRecordGroupKey(e,r),a.length>0&&this._filterService.refreshViewRecord(e,i),this._sortService.isKeepSort(e)&&this._sortService.refresh(e)}};Ey([to(Ov)],xy.prototype,"_model",2),Ey([to(ag)],xy.prototype,"_fieldService",2),Ey([to(vy)],xy.prototype,"_viewConfigServivce",2),Ey([to(xg)],xy.prototype,"_viewRecordService",2),Ey([to(wy)],xy.prototype,"_viewFieldService",2),Ey([to(wg)],xy.prototype,"_groupService",2),Ey([to(ny)],xy.prototype,"_sortService",2),Ey([to(Ig)],xy.prototype,"_filterService",2),Ey([to(fy)],xy.prototype,"_statService",2),xy=Ey([eo()],xy);var Sy=Object.defineProperty,ky=Object.getOwnPropertyDescriptor,Oy=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ky(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Sy(t,r,o),o};let Iy=class{getTable(){return this._model.tableModel.find()[0]}getVersion(){return this._model.tableModel.find()[0].version}getViewList(){return this._model.viewModel.find()}createTable(){this._model.tableModel.create({version:"2.0.0"})}create(){this.createTable();for(const e of Nh)this._fieldService.create(e);const e=Gh.GRID,t=Io(32);this._viewService.create({uuid:t,name:e.name,type:e.type});for(const e of new Array(3)){const e=Io(32);this._model.recordModel.create({uuid:e}),this._model.viewRecordModel.create({view_uuid:t,record_uuid:e})}}setActiveView(e){let t=this._model.viewModel.findById(e);if(!t&&(t=this._model.viewModel.find()[0],!t))return;this._viewService.refresh(t.uuid);const r=this._model.tableModel.find()[0].uuid;return this._model.tableModel.update({uuid:r},{active_view_uuid:t.uuid})}};Oy([to(Ov)],Iy.prototype,"_model",2),Oy([to(ag)],Iy.prototype,"_fieldService",2),Oy([to(xy)],Iy.prototype,"_viewService",2),Iy=Oy([eo()],Iy);var Ry=Object.defineProperty,Ty=Object.getOwnPropertyDescriptor,Ay=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Ty(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ry(t,r,o),o};let Ny=class{getViewShare(e){return this._model.viewShareModel.findOne({view_uuid:e})}upsertViewShare(e,t){this._model.viewShareModel.upsert({view_uuid:e},{view_uuid:e,src:null==t?void 0:t.src,status:null==t?void 0:t.status})}};Ay([to(Ov)],Ny.prototype,"_model",2),Ny=Ay([eo()],Ny);var My=Object.defineProperty,Py=Object.getOwnPropertyDescriptor,jy=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Py(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&My(t,r,o),o};let Dy=class{get currentUser(){return this._contextService.currentUser}get maxRecordCount(){return this._configuration.getValue("record.maxCount")}getTable(){return this._tableService.getTable()}isEmptyTable(){var e,t,r;const n=this.getAllFields();if(3!==n.length||n[0].type!==Nh[0].type||n[1].type!==Nh[1].type||n[2].type!==Nh[2].type||this.getViews().length>1)return!1;const i=this.getFieldOptions(n[1].uuid);if(3!==i.length||i[0].name!==(null==(e=Nh[1].options)?void 0:e[0].name)||i[1].name!==(null==(t=Nh[1].options)?void 0:t[1].name)||i[2].name!==(null==(r=Nh[1].options)?void 0:r[2].name))return!1;const o=this.getRecords();for(const e of o)for(const t of n)if(""!==this.getCellFormattedValue(t.uuid,e.uuid))return!1;return!0}getActiveView(){return this._viewService.getActiveView()}getActiveViewData(e){const t=this.getActiveView();if(t)return this.getViewData(t.uuid,e)}getViewData(e,t=["view","viewConfig","viewFields","viewRecords","fields","group","fieldGroups","sort","filters","stats"]){if(!e)return;let r,n,i,o,a,s,l,c,u,d;for(const f of t)"view"===f?r=this.getView(e):"viewConfig"===f?n=this.getViewConfig(e):"viewFields"===f?i=this.getViewFields(e):"viewRecords"===f?o=this.getViewRecords(e):"group"===f?s=this.getViewGroup(e):"fieldGroups"===f?l=this.getViewFieldGroups(e):"fields"===f?a=this.getAllFields():"sort"===f?c=this.getViewSort(e):"filters"===f?u=this.getViewFilters(e):"stats"===f&&(d=this.getViewStats(e));return vd({view:r,viewConfig:n,viewFields:i,viewRecords:o,fields:a,group:s,fieldGroups:l,sort:c,filters:u,stats:d},t)}getView(e){return this._viewService.getView(e)}getViews(e){return this._viewService.getViews(e)}getViewConfig(e){return e=e||this.getActiveViewId(),this._viewConfigService.getViewConfig(e)}getViewFilters(e,t){return this._filterService.getViewFilters(e,t)}getViewGroup(e){return this._groupService.getViewGroup(e||this.getActiveViewId())}getViewFieldGroups(e){return this._fieldGroupService.getViewFieldGroups(e||this.getActiveViewId())}getViewSort(e){return this._sortService.getViewSort(e)}getViewStats(e){return this._statService.getViewStats(e)}getViewShare(e){return this._viewShareService.getViewShare(e)}getStatValue(e,t,r){return this._statService.getStatValue(e,t,r)}getCell(e,t){return this._cellService.getCell(e,t)}getFieldCells(e){return this._cellService.getFieldCells(e)}getRecordCells(e){return this._cellService.getRecordCells(e)}getOriginRecord(e){return this._recordService.getRecordById(e)}getRecordById(e){const t=this._viewService.getActiveView().uuid;return this._viewRecordService.getRecordById(t,e)}getRecordDesc(e){return this._recordService.getRecordDesc(e)}getRecordByIndex(e){return(this.getFlatViewRecords()||[])[e]}getFieldByIndex(e){var t;return null==(t=(this.getViewFields()||[])[e])?void 0:t.field}getCellByIndexes(e,t){const r=this.getFieldByIndex(t),n=this.getRecordByIndex(e);return r&&n?this.getCell(null==r?void 0:r.uuid,n.record_uuid):null}getVisibleRecordIdsInActiveView(){const e=this.getActiveViewId();return this._viewRecordService.getVisibleRecordIds(e)}getPrimaryCellInRecord(e){if(this.getRecordById(e)){const t=this.getViewFields(),r=(null==t?void 0:t.find((e=>{var t;return(null==(t=e.field)?void 0:t.type)===Rh.TITLE})))||(null==t?void 0:t[0]),n=null==r?void 0:r.field_uuid;return n?{formattedValue:this._cellService.getCellFormattedValue(n,e),recordId:e,fieldId:n}:null}return null}getAllFields(){return this._fieldService.getFields()}getRecords(){return this._recordService.getRecords()}getViewRecords(e){const t=e||this.getActiveViewId();return this._viewRecordService.getViewRecords(t)||[]}getOriginViewRecords(e){return e=e||this.getActiveViewId(),this._viewRecordService.getOriginViewRecords(e)}getFlatViewRecords(e){return e=e||this.getActiveViewId(),this._viewRecordService.getFlatViewRecords(e)}getViewRecordsCount(e){return e=e||this.getActiveViewId(),this._viewRecordService.getViewRecordsCount(e)}getFieldOptionCells(e,t){const r=this.getField(t.field_uuid);let n=[];if((null==r?void 0:r.type)===Rh.MENTION){const r=this.getUsers(t.uuid.split(",").map((e=>Number(e))));n=(this.getFieldRecords(e,t.field_uuid,this.keyValue({fieldId:t.field_uuid,value:[...r]}))||[]).map((e=>e.cells)).reduce(((e,t)=>e.concat(t)),[])}else n=(this.getFieldRecords(e,t.field_uuid,t.uuid)||[]).map((e=>e.cells)).reduce(((e,t)=>e.concat(t)),[]);return n}getFieldRecords(e,t,r){return this._viewRecordService.getFieldRecords(e,t,r)}getField(e){return this._fieldService.getField(e)}getFieldOption(e){return this._fieldService.getFieldOption(e)}getFieldOptions(e){return this._fieldService.getFieldOptions(e)}getViewField(e,t){return this._viewFieldService.getViewField(e,t)}isGroup(e){return e=e||this.getActiveViewId(),this._groupService.isGroup(e)}getViewFields(e,t){return e=e||this.getActiveViewId(),this._viewFieldService.getViewFields(e,t)||[]}getViewFieldsCount(e){return e=e||this.getActiveViewId(),this._viewFieldService.getViewFieldsCount(e)}getAllViewFields(e){return e=e||this.getActiveViewId(),this._viewFieldService.getViewFields(e,!1)}getCellFormattedValue(e,t){return this._cellService.getCellFormattedValue(e,t)||""}getActiveViewId(){var e;return null==(e=this._viewService.getActiveView())?void 0:e.uuid}getActiveViewType(){return this._viewService.getActiveView().type}getUser(e){return this._model.userModel.findOne({uid:e})}getUsers(e){return this._model.userModel.find({uid:e})}getValueField(e){return this._fieldRegistry.getValueField(e)}keyValue(e){return this._cellService.keyValue(e)}};jy([to(Iy)],Dy.prototype,"_tableService",2),jy([to(ag)],Dy.prototype,"_fieldService",2),jy([to(pg)],Dy.prototype,"_recordService",2),jy([to(xy)],Dy.prototype,"_viewService",2),jy([to(vy)],Dy.prototype,"_viewConfigService",2),jy([to(wy)],Dy.prototype,"_viewFieldService",2),jy([to(xg)],Dy.prototype,"_viewRecordService",2),jy([to(Ny)],Dy.prototype,"_viewShareService",2),jy([to(fy)],Dy.prototype,"_statService",2),jy([to(wg)],Dy.prototype,"_groupService",2),jy([to(Ng)],Dy.prototype,"_fieldGroupService",2),jy([to(ny)],Dy.prototype,"_sortService",2),jy([to(Ig)],Dy.prototype,"_filterService",2),jy([to(Bv)],Dy.prototype,"_cellService",2),jy([to(Mv)],Dy.prototype,"_fieldRegistry",2),jy([to(qf)],Dy.prototype,"_configuration",2),jy([to(Tv)],Dy.prototype,"_contextService",2),jy([to(Ov)],Dy.prototype,"_model",2),Dy=jy([eo()],Dy);var Fy=Object.defineProperty,Vy=Object.getOwnPropertyDescriptor,Ly=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Vy(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Fy(t,r,o),o},$y=(e=>(e.GROUP="group",e.SORT="sort",e.FILTER="filter",e))($y||{});let By=class extends Zf{constructor(){super(...arguments),this._onBeforeRefresh=this._register(new op),this.onBeforeRefresh=this._onBeforeRefresh.event,this._onAfterRefresh=this._register(new op),this.onAfterRefresh=this._onAfterRefresh.event}isNeedRefreshGroup(e,t){const r=this._groupService.getViewGroup(e);if(!r)return!1;let n=[];return n="string"==typeof t?[t]:t,n.includes(null==r?void 0:r.field_uuid)}isNeedRefreshSort(e,t){const r=this._sortService.getViewSort(e);let n=[];return n="string"==typeof t?[t]:t,this._sortService.isKeepSort(e)&&n.includes(null==r?void 0:r.field_uuid)}isNeedRefreshFilter(e,t,r,n){const i=this._model.filterModel.find({view_uuid:e}).map((e=>e.field_uuid));let o=[],a=!1;o="string"==typeof t?[t]:t;for(const t of i)if(o.includes(t)){const t=this._filterService.getViewFilters(e);a=!this._filterService.checkIsFilterMatch(r,t,n);break}return a}getRefreshType(e,t,r,n){return this.isNeedRefreshGroup(e,t)?"group":this.isNeedRefreshSort(e,t)?"sort":r&&this.isNeedRefreshFilter(e,t,r,n)?"filter":""}emitBeforeRefresh(e,t,r,n){this._onBeforeRefresh.emit({type:e,commandName:t,params:r,action:n})}emitAfterRefresh(e){this._onAfterRefresh.emit({type:e})}destroy(){super.destroy()}};Ly([to(wg)],By.prototype,"_groupService",2),Ly([to(ny)],By.prototype,"_sortService",2),Ly([to(Ig)],By.prototype,"_filterService",2),Ly([to(Ov)],By.prototype,"_model",2),Ly([Si()],By.prototype,"destroy",1),By=Ly([eo()],By);var zy=Object.defineProperty,Uy=Object.getOwnPropertyDescriptor,Hy=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Uy(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&zy(t,r,o),o};let Wy=class{setActiveView(e){return this._tableService.setActiveView(e)}createView(e){return this._viewService.create(e)}createViewByType(e,t){return this._viewService.createByType(e,t)}updateView(e,t){return this._viewService.update(e,t)}removeView(e){return this._viewService.remove(e)}copyView(e,t){return this._viewService.copy(e,t)}updateViewConfig(e,t){return this._viewConfigService.update(e,t)}updateViewOrder(e,t){this._viewService.updateOrder(e,t)}updateRecordOrder(e,t,r,n){this._viewRecordService.updateOrder(e,t,r,n),this._sortService.isKeepSort(e)&&this._sortService.refresh(e)}updateRecord(e,t){this._recordService.update(e,t)}updateFieldOrder(e,t,r){this._viewFieldService.updateOrder(e,t,r)}updateFieldOptionOrder(e,t,r){this._fieldService.updateFieldOptionOrder(e,t,r)}createFieldOption(e,t,r){return this._fieldService.createFieldOption(e,t,r)}updateFieldOption(e,t){this._fieldService.updateFieldOption(e,t)}updateMentionFieldOptionId(e,t){this._fieldService.updateMentionFieldOptionId(e,t)}createSort(e,t,r){return this._sortService.create(e,t,r)}removeSort(e){return this._sortService.remove(e)}updateSort(e,t,r){return this._sortService.update(e,t,r)}createGroup(e,t){this._groupService.create(e,t)}removeGroup(e){this._groupService.remove(e)}updateGroup(e,t){return this._groupService.update(e,t)}createFilter(e,t){return this._filterService.create(e,t)}removeFilter(e){return this._filterService.remove(e)}updateFilter(e,t){this._filterService.update(e,t)}createField({viewId:e,field:t,viewField:r,sourceFieldId:n,direction:i}){const o=this._viewFieldService.create({viewId:e,field:t,viewField:r,sourceFieldId:n,direction:i});return this.refreshView(),o}changeFieldType(e,t,r,n){this._fieldService.changeFieldType(e,t,r,n)}removeField(e){const t=this._viewService.getActiveView(),r=this._viewFieldService.remove(e,t.uuid);return this._viewService.refresh(t.uuid),r}removeFieldOption(e){this._fieldService.removeFieldOption(e)}createRecord(e,t,r){return this._viewRecordService.createRecord(e,t,r)}createEmptyRecord({viewId:e,uuid:t,viewRecord:r,sourceRecordId:n,direction:i,groupOption:o,modifierId:a}){return this._viewRecordService.createEmpty({uuid:t,viewId:e,viewRecord:r,sourceRecordId:n,direction:i,groupOption:o,modifierId:a})}createRecords(e,t){return this._viewRecordService.createRecords(e,t)}copyRecord({viewId:e,uuid:t,sourceRecordId:r,modifierId:n}){return this._viewRecordService.copyRecord({viewId:e,uuid:t,sourceRecordId:r,modifierId:n})}removeRecord(e){const t=this._viewService.getActiveView();return this._viewRecordService.remove(t.uuid,e)}removeAllRecords(e){return this._viewRecordService.removeAll(e)}upsertStat(e,t,r){this._statService.upsert(e,t,r)}removeStat(e,t){this._statService.remove(e,t)}async setCell(e){var t;const r=this._viewService.getActiveView(),n=this._groupService.getViewGroup(r.uuid);null!=(t=this._cellEditService)&&t.provider&&!await this._cellEditService.setCell({cells:[e]})||(this._cellService.setCell(e.fieldId,e.recordId,e),this._refreshEventService.isNeedRefreshSort(r.uuid,e.fieldId)&&this._sortService.refresh(r.uuid),this._refreshEventService.isNeedRefreshGroup(r.uuid,e.fieldId)&&this._groupService.refreshViewRecordGroupKey(r.uuid,n),this._refreshEventService.isNeedRefreshFilter(r.uuid,e.fieldId,e.recordId,e.value)&&this._filterService.refresh(r.uuid))}async bulkSetCell(e){var t;const r=this._viewService.getActiveView(),n=this._groupService.getViewGroup(r.uuid),i=e.map((e=>e.fieldId));null!=(t=this._cellEditService)&&t.provider&&!await this._cellEditService.setCell({cells:e})||(this._cellService.bulkSetCell(e),this._refreshEventService.isNeedRefreshSort(r.uuid,i)&&this._sortService.refresh(r.uuid),this._refreshEventService.isNeedRefreshGroup(r.uuid,i)&&this._groupService.refreshViewRecordGroupKey(r.uuid,n))}async safeSetCell(e,t,r,n,i){await this._valueProcessService.changeCellType(e,t,r,n,i)}updateValueOrder(e){this._cellService.updateOrder(e)}updateFieldSize(e,t,r){this._viewFieldService.update(e,t,"size",r)}updateFieldName(e,t){this._fieldService.update({uuid:e,name:t})}updateFieldHidden(e,t,r){this._viewFieldService.update(e,t,"hidden",r)}updateFieldProperty(e){const{uuid:t,color:r,options:n}=e;jo(r)||this._fieldService.update({uuid:t,color:r});const i=this._viewService.getActiveView(),o=this._groupService.getViewGroup(i.uuid),a=this._fieldService.getFieldOptions(t).map((e=>e.uuid)),s=(n||[]).map((e=>e.uuid)),l=qu(a,s);this._fieldService.updateFieldOptions(t,n,l),(null==o?void 0:o.field_uuid)===t&&l.length>0&&this._groupService.refreshViewRecordGroupKey(i.uuid,o)}refreshView(e){var t;!e&&!(e=null==(t=this._viewService.getActiveView())?void 0:t.uuid)||this._viewService.refresh(e)}upsertViewShare(e,t){this._viewShareService.upsertViewShare(e,t)}removeViewField(e,t){this._viewFieldService.remove(t,e,!0),this.refreshView()}insertViewField(e,t){this._viewFieldService.insert(t,e),this.refreshView()}updateViewField(e,t,r){Object.keys(r).forEach((n=>{this._viewFieldService.update(e,t,n,r[n])})),this.refreshView()}cloneViewField(e,t,r){this._viewFieldService.clone(e,t,r),this.refreshView()}createFieldGroup(e,t){return this._fieldGroupService.create(e,{name:t})}removeFieldGroup(e,t){this._fieldGroupService.remove(e,t)}changeFieldGroupName(e,t){this._fieldGroupService.update(e,t)}};Hy([to(Iy)],Wy.prototype,"_tableService",2),Hy([to(ag)],Wy.prototype,"_fieldService",2),Hy([to(pg)],Wy.prototype,"_recordService",2),Hy([to(xy)],Wy.prototype,"_viewService",2),Hy([to(vy)],Wy.prototype,"_viewConfigService",2),Hy([to(xg)],Wy.prototype,"_viewRecordService",2),Hy([to(fy)],Wy.prototype,"_statService",2),Hy([to(wg)],Wy.prototype,"_groupService",2),Hy([to(Ng)],Wy.prototype,"_fieldGroupService",2),Hy([to(ny)],Wy.prototype,"_sortService",2),Hy([to(Ig)],Wy.prototype,"_filterService",2),Hy([to(Bv)],Wy.prototype,"_cellService",2),Hy([to(wy)],Wy.prototype,"_viewFieldService",2),Hy([to(tg)],Wy.prototype,"_valueProcessService",2),Hy([to(Ny)],Wy.prototype,"_viewShareService",2),Hy([to(By)],Wy.prototype,"_refreshEventService",2),Hy([to(Xv)],Wy.prototype,"_cellEditService",2),Wy=Hy([eo()],Wy);var Gy=Object.defineProperty,Ky=Object.getOwnPropertyDescriptor,qy=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Ky(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Gy(t,r,o),o};let Yy=class{setProcessor(e){this._processor=e}setContent(e){this._storage.clear(),this._processor.toModel(e,this._storage)}setRecords(e){this._storage.clear([Zh.table,tm.table,cm.table,gm.table,_m.table,Sm.table,Bm.table]),this._processor.toRecordModel(e,this._storage),this._writeService.refreshView()}setUsers(e){this._storage.clear([nv.table]),this._processor.toUserModel(e,this._storage)}getContent(){return this._processor.toData(this._readService,this._storage)}};qy([to(Nf)],Yy.prototype,"_storage",2),qy([to(Dy)],Yy.prototype,"_readService",2),qy([to(Wy)],Yy.prototype,"_writeService",2),Yy=qy([eo()],Yy);var Xy=Object.defineProperty,Zy=Object.getOwnPropertyDescriptor,Jy=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Zy(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Xy(t,r,o),o};let Qy=class{init(e={}){const{processor:t}=e;this._modelInitial.init({models:[Qm,mv,sv,dv,bv,Ev,nv,Ym,Wm,Bm,Mm,Fm,Rm,om,pm,Sm,_m,gm,cm,tm,Zh]}),t&&this._contentService.setProcessor(t)}start(){}initData(e){this._contentService.setContent(e);const t=this._contextService.currentUser;t&&this._modelService.getModel("user").upsert({uid:t.uid},{uid:String(t.uid),work_id:t.work_id,name:t.name,login:t.login,icon:t.icon})}initRecords(e){this._contentService.setRecords(e)}initUsers(e){this._contentService.setUsers(e)}};Jy([to(Tf)],Qy.prototype,"_modelInitial",2),Jy([to(Wp)],Qy.prototype,"_modelService",2),Jy([to(Yy)],Qy.prototype,"_contentService",2),Jy([to(Tv)],Qy.prototype,"_contextService",2),Qy=Jy([eo()],Qy);const eb=bo().register(Ov).register(Qy).register(Iy).register(Fv).register(By).register(xy).register(Bv).register(tg).register(ag).register(Mv).register(pg).register(vy).register(xg).register(wy).register(Ny).register(fy).register(wg).register(Ng).register(vg).register(ny).register(Qg).register(Ig).register(cg).register(ly).register(Yy).register(Tv).register(Dy).register(Wy);var tb=Object.defineProperty,rb=Object.getOwnPropertyDescriptor;let nb=class{get rules(){return[]}getCellId(e,t,r){return`${e}-${t}-${r}`}getCellKey(e,t,r,n){const i=this.getCellId(e,t,r);return n?Array.isArray(n)?i+"-"+n.map((e=>+new Date(e))).join("-"):i+"-"+ +new Date(n):i}getVerify(e){if(!e)return{};if(!this.rules||0===this.rules.length)return{};const t=this.rules.reduce(((t,r)=>{var n;return t+(null!=(n=r.validator)&&n.call(r,"",e)?"":r.errorMsg)}),"");return t?{verify:!1,errorMessage:t}:{verify:!0}}bulkSetCell(e){}};nb=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?rb(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&tb(t,r,o),o})([Qi()],nb);const ib=Fi.defineToken("LoggerToken");var ob=Object.defineProperty,ab=Object.getOwnPropertyDescriptor,sb=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ab(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ob(t,r,o),o};let lb=class{constructor(){this._logs=[]}_init(){this.configuration.registerConfiguration({id:"logger",type:"object",title:"日志",properties:{maxLen:{type:"number",description:"最大日志长度"}}}),this.configuration.registerDefaultValue({"logger.maxLen":1e3})}log(e){const t=this.configuration.getValue("logger.maxLen");this._logs.length>=t&&this._logs.shift(),this._logs.push(e)}getLogs(){return this._logs}};sb([to(qf)],lb.prototype,"configuration",2),sb([xi()],lb.prototype,"_init",1),lb=sb([eo({token:ib})],lb);const cb=bo().register(lb);var ub=(e=>(e.PENDING="pending",e.RUNNING="running",e.SUCCESS="success",e.ERROR="error",e.ABORTED="aborted",e.TIMEOUT="timeout",e.WAITING="waiting",e))(ub||{});class db extends Zf{constructor(e={}){super(),this._retryCount=0,this._isRuning=!1,this._isStop=!1,this._onDidStatusChange=this._register(new op),this.onDidStatusChange=this._onDidStatusChange.event,this.name=e.name,this._interval=e.interval||1e3,this._maxRetries=e.maxRetries||3}destroy(){super.destroy(),this._job=null,this._retryCount=null,this._isRuning=null,this._lastRunAt=null,this._isStop=null,clearTimeout(this._timer),this._timer=null}addJob(e){this._job=e}hasRuningJob(){return!this._isStop}async run(){if(this._isStop||!this._job||this._retryCount>=this._maxRetries||this._isRuning)return;const e=+new Date;if(!(this._lastRunAt&&e-this._lastRunAt<this._interval)){this._isRuning=!0,this._onDidStatusChange.emit(ub.RUNNING);try{await this._job()}catch(e){return console.error(e),this._retryCount++,void await this.run()}this._isRuning=!1,this._retryCount=0,this._lastRunAt=+new Date}}start(){this.run().then((()=>{this._timer=setTimeout((async()=>{this.start()}),this._interval)}))}stop(){this._isStop=!0,clearTimeout(this._timer),this._onDidStatusChange.emit(ub.ABORTED)}resume(){this._isStop=!1,this.start()}}class fb extends Zf{constructor(e={}){super(),this._jobs=[],this._penddingJobs=[],this._runingJobs=[],this._successJobs=[],this._errorJobs=[],this._isRuning=!1,this._isStop=!1,this._onDidStatusChange=this._register(new op),this.onDidStatusChange=this._onDidStatusChange.event,this.stop=()=>{this._isStop=!0,this._onDidStatusChange.emit({status:ub.ABORTED})},this.resume=()=>{!this._isStop||(this._isStop=!1,this.start())},this.name=e.name,this._parallel=e.parallel||5}destroy(){super.destroy(),this._jobs=[],this._penddingJobs=[],this._runingJobs=[],this._successJobs=[],this._errorJobs=[],this._isRuning=!1,this._isStop=!1}getJob(e){return this._jobs.find((t=>t.id===e))}getSuccessJobs(){return this._successJobs.map((e=>this._jobs.find((t=>t.id===e)))).filter((e=>!!e))}getRunningJobs(){return this._runingJobs.map((e=>this._jobs.find((t=>t.id===e)))).filter((e=>!!e))}hasRuningJob(){return!this._isStop&&!!this._runingJobs.length}hasPenddingJob(){return!!this._penddingJobs.length}runJob(e){const t=this._jobs.find((t=>t.id===e));if(!t||this._runingJobs.find((t=>t===e))||this._successJobs.find((t=>t===e)))return;this._errorJobs.find((t=>t===e))&&yd(this._errorJobs,(t=>t===e)),yd(this._penddingJobs,(t=>t===e)),this._runingJobs.push(e),t.runAt=new Date;const r=()=>{t.endAt=new Date,t.spend=Number(t.endAt)-Number(t.runAt),t.runCount=t.runCount?t.runCount+1:1,yd(this._runingJobs,(t=>t===e)),this._run()};try{t.handler({jobId:e,onSuccess:()=>{t.status=ub.SUCCESS,this._onDidStatusChange.emit({status:ub.SUCCESS,jobId:t.id}),this._successJobs.push(t.id),r()},onError:()=>{t.status=ub.ERROR,this._errorJobs.push(t.id),r()},onProcess:e=>{t.percent=e,this._onDidStatusChange.emit({status:ub.RUNNING,jobId:t.id,percent:e})}})}catch(e){console.error(e)}}_run(){if(this._isStop)return;const e=this._runingJobs.length;if(e<this._parallel){const t=function(e,t,r){var n=null==e?0:e.length;return n?(r&&"number"!=typeof r&&$s(e,t,r)?(t=0,r=n):(t=null==t?0:qa(t),r=void 0===r?n:qa(r)),tc(e,t,r)):[]}(this._penddingJobs,0,this._parallel-e);if(0===t.length)return this._isRuning=!1,void this._onDidStatusChange.emit({status:ub.WAITING});for(const e of t)this._isRuning=!0,this.runJob(e)}else 0===e&&(this._isRuning=!1,this._onDidStatusChange.emit({status:ub.WAITING}))}start(){this._onDidStatusChange.emit({status:ub.PENDING}),this._run()}addJob(e,t){1===arguments.length?(t=e,e=Io(16)):"string"==typeof e&&(yd(this._jobs,(t=>t===e)),yd(this._penddingJobs,(t=>t===e)));const r={id:e,status:ub.PENDING,handler:t};return this._jobs.push(r),this._penddingJobs.push(r.id),!this._isRuning&&!this._isStop&&this.start(),r}removeSuccessJob(e){yd(this._successJobs,(t=>t===e))}}var pb=Object.defineProperty,hb=Object.getOwnPropertyDescriptor,mb=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?hb(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&pb(t,r,o),o};let vb=class{constructor(){this._queueTasks=[]}init(){sa.onBeforeUnLoad((e=>{for(const t of this._queueTasks)if(t.hasRuningJob())return e.preventDefault(),e.returnValue="",kf(`还有 ${t.name} 正在运行中，确认要离开页面吗.`)}))}createRepeatTask(e){return new db(e)}createQueueTask(e){const t=new fb(e);return this._queueTasks.push(t),t}};mb([xi()],vb.prototype,"init",1),vb=mb([eo()],vb);const gb=bo().register(vb),yb=Fi.defineToken("UserContribution");var bb=Object.defineProperty,wb=Object.getOwnPropertyDescriptor,_b=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?wb(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&bb(t,r,o),o};let Cb=class{getProvider(){const e=this.userProvider.getContributions(),t=e[e.length-1];return null==t?void 0:t.registerUser()}};_b([Eo(yb)],Cb.prototype,"userProvider",2),Cb=_b([eo()],Cb);var Eb=Object.defineProperty,xb=Object.getOwnPropertyDescriptor,Sb=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?xb(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Eb(t,r,o),o};let kb=class{get provider(){return this._userRegistry.getProvider()}async searchUser(e){var t;return await(null==(t=this.provider)?void 0:t.searchUser(e))||[]}async contextUsers(){var e;return await(null==(e=this.provider)?void 0:e.contextUsers())||[]}getCurrentUser(){var e;return null==(e=this.provider)?void 0:e.getCurrentUser()}};Sb([to(Cb)],kb.prototype,"_userRegistry",2),kb=Sb([eo()],kb);const Ob=bo().contribution(yb).register(Cb).register(kb);class Ib{constructor(e,t,r){this.kernel=e,this.plugin=t,this.readService=r}init(){}destroy(){}}const Rb=Fi.defineToken("CommandRegistry"),Tb=Fi.defineToken("CommandExecutor");var Ab=Object.defineProperty,Nb=Object.getOwnPropertyDescriptor,Mb=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Nb(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ab(t,r,o),o};let Pb=class extends Zf{constructor(){super(...arguments),this._onViewChanged=this._register(new op),this.onViewChanged=this._onViewChanged.event}get onWillExecuteCommand(){return this._commandExecutor.onWillExecuteCommand}get onDidExecuteCommand(){return this._commandExecutor.onDidExecuteCommand}get onCancelExecuteCommand(){return this._commandExecutor.onCancelExecuteCommand}get onFinishExecuteCommand(){return this._commandExecutor.onFinishExecuteCommand}destroy(){this._commandRegistry.destroy(),this._commandExecutor.destroy()}seal(){this._commandRegistry.seal()}registerCommand(e,t,r){this._commandRegistry.register(e,t,r)}registerCommandHook(e,t){this._commandRegistry.registerCommandHook(e,t)}getCommand(e,t=!1,r=!1){return this._commandRegistry.getByName(e,t,r)}getCommandHook(e){return this._commandRegistry.getCommandHooks(e)}async execCommand(e,t,r){var n;const i=this.getCommand(e,r);if(!i)return null;i.beforeExecute&&(t=await i.beforeExecute.call(i,t));const o=this._commandRegistry.getCommandHooks(e);if(o.length>0)for(const e of o)e.beforeExecute&&(t=e.beforeExecute(t,this._readService));const a=await(null==i?void 0:i.execute.call(i,t));if(o.length>0)for(const e of o)e.afterExecute&&e.afterExecute(a.result,t,this._readService);return i.afterExecute?t=await i.afterExecute.call(i,t,a.result,this._refreshEventService):(null==(n=i.context)||n.destroy(),i.context=null),this._logger.log({type:"command",action:e,data:t}),a}async execRemoteCommand(e,t,r,n){const i=this.getCommand(e,n,!0);return i?(r&&(r.modifierId=null==t?void 0:t.uid),this._contentService.setUsers([t]),await(null==i?void 0:i.execute.call(i,r))):null}async execDeferCommand(e,t,r){var n;if(!this.getCommand(e))return null;null==(n=this._refreshEventService)||n.emitBeforeRefresh(r,e,t,(async()=>{await this.execCommand(e,t)}))}};Mb([to(Dy)],Pb.prototype,"_readService",2),Mb([to(Yy)],Pb.prototype,"_contentService",2),Mb([to(Rb)],Pb.prototype,"_commandRegistry",2),Mb([to(Tb)],Pb.prototype,"_commandExecutor",2),Mb([to(By)],Pb.prototype,"_refreshEventService",2),Mb([to(ib)],Pb.prototype,"_logger",2),Mb([Si()],Pb.prototype,"destroy",1),Pb=Mb([eo()],Pb);var jb=(e=>(e.User="user",e.Init="init",e.History="history",e.Auto="auto",e.Silent="silent",e.OT="ot",e.ROLLBACK="rollback",e))(jb||{}),Db=Object.defineProperty,Fb=Object.getOwnPropertyDescriptor,Vb=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Fb(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Db(t,r,o),o};let Lb=class{constructor(){this._pool={},this._commands={},this._commandHooks={},this._isSealed=!1}destroy(){Object.keys(this._commands).forEach((e=>{this._commands[e].destroy()})),this._pool={},this._commands={},this._commandHooks={},this._isSealed=!1}seal(){this._isSealed||(this._isSealed=!0,this.initCommand())}getByName(e,t,r){let n=this._commands[e];return n?(n=this.trap(e,n,t,r),n):(console.warn(`This command "${e}" is not registered`),null)}getCommandHooks(e){return this._commands[e]?this._commandHooks[e]||[]:(console.warn(`This command "${e}" is not registered`),[])}register(e,t,r){if(this._pool[e])throw new Error("The command has been registered");if(this._isSealed)throw new Error("No command can be registered at this stage");this._pool[e]={clazz:t,plugin:r}}registerCommandHook(e,t){!this._pool[e]||(this._commandHooks[e]||(this._commandHooks[e]=[]),this._commandHooks[e].push(t))}trap(e,t,r,n){const i=t._rawExec||t.execute;return t._rawExec=i,t.execute=new Proxy(t.execute,{apply:(o,a,s)=>this._commandExecutor.exec(e,t,r,n,i,a,s)}),t}initCommand(){Object.keys(this._pool).forEach((e=>{const{clazz:t,plugin:r}=this._pool[e],n=this.trap(e,new t(this._kernel,r,this._readService),!1,!1);n.init(),this._commands[e]=n}))}};Vb([to(Tb)],Lb.prototype,"_commandExecutor",2),Vb([to(Dy)],Lb.prototype,"_readService",2),Lb=Vb([eo({token:Rb})],Lb);class $b{constructor(e,t,r,n){this.commandExecutor=e,this.commandName=t,this.Job=r,this.argArray=n}destroy(){delete this._job,delete this._remote,delete this._user}get job(){return this._job}get isRemote(){return this._remote}get user(){return this._user}setJob(e){this._job=e}setRemote(e){this._remote=e}setUser(e){this._user=e}cancel(){}}class Bb{constructor(e,t,r,n,i,o,a){this._operations=[],this.commandExecutor=e,this.notify=a,this._readService=n,this._writeService=i,this._modelService=o,this.Job=r,this.job=new r(t,n,i,o,this)}destroy(){this._operations.forEach((e=>{e.destroy()})),this.job.destroy();const e=this;delete e.notify,delete e._operations,delete e.notify}get type(){return this.job.type}get operations(){return this._operations.slice()}async execute(e){var t,r,n,i,o,a,s,l;let c;null==(r=null==(t=this.notify)?void 0:t.beforeExecute)||r.call(t,this);try{c=await e(this.job),null==(i=null==(n=this.notify)?void 0:n.afterExecute)||i.call(n,this)}catch(e){return console.error(e),this.rollback(),null==(a=null==(o=this.notify)?void 0:o.completed)||a.call(o,this,!1),{isSuccess:!1,error:e}}return null==(l=null==(s=this.notify)?void 0:s.completed)||l.call(s,this,!0,this._operations.slice()),{isSuccess:!0,result:c}}addOperation(e){this._operations.push(e)}rollback(){const e=new Bb(this.commandExecutor,jb.ROLLBACK,this.Job,this._readService,this._writeService,this._modelService);this._operations.slice().reverse().forEach((t=>{t.undo(e.job)})),this._operations.length=0,e.destroy()}}class zb{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{fieldId:t,fromType:r,toType:n}=this._detail,i=e.readService.getFieldCells(t);await e.writeService.changeFieldType(t,r,n,i)}async undo(e){const{fieldId:t,fromType:r,toType:n,oldCells:i}=this._detail;await e.writeService.changeFieldType(t,n,r,i)}}class Ub{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t,field:r,viewField:n,sourceFieldId:i,direction:o}=this._detail;await e.writeService.createField({viewId:t,field:r,viewField:n,sourceFieldId:i,direction:o})}async undo(e){const{field:t}=this._detail;await e.writeService.removeField(t.uuid)}}class Hb{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t,filter:r}=this._detail;await e.createFilter(t,r)}async undo(e){const{filter:t}=this._detail;await e.removeFilter(t.uuid)}}class Wb{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t,viewRecord:r,records:n,sourceRecordId:i,direction:o,groupOption:a,modifierId:s}=this._detail;await e.writeService.createEmptyRecord({viewId:t,uuid:n.map((e=>e.uuid)),viewRecord:r,sourceRecordId:i,direction:o,groupOption:a,modifierId:s})}async undo(e){const{records:t}=this._detail;await e.writeService.removeRecord(t.map((e=>e.uuid)))}}class Gb{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t,sort:r,auto:n}=this._detail;await e.writeService.createSort(t,r,n)}async undo(e){const{viewId:t}=this._detail;await e.writeService.removeSort(t)}}class Kb{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{view:t}=this._detail;await e.createView(t)}async undo(e){const{view:t}=this._detail;await e.removeView(t.uuid)}}class qb{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{field:t}=this._detail;await e.writeService.removeField(t.uuid)}async undo(e){const{viewId:t,field:r,viewField:n,sourceFieldId:i,direction:o}=this._detail;await e.writeService.createField({viewId:t,field:r,viewField:n,sourceFieldId:i,direction:o})}}class Yb{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{filter:t}=this._detail;await e.removeFilter(t.uuid)}async undo(e){const{viewId:t,filter:r}=this._detail;await e.createFilter(t,r)}}class Xb{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{record:t}=this._detail;await e.writeService.removeRecord(t.uuid)}async undo(e){const{viewId:t,record:r,viewRecord:n,direction:i,sourceRecordId:o,groupOption:a}=this._detail;await e.writeService.createEmptyRecord({viewId:t,uuid:r.uuid,direction:i,viewRecord:n,sourceRecordId:o,groupOption:a,modifierId:void 0})}}class Zb{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t}=this._detail;await e.writeService.removeSort(t)}async undo(e){const{viewId:t,sort:r,auto:n}=this._detail;await e.writeService.createSort(t,r,n)}}class Jb{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{view:t}=this._detail;await e.removeView(t.uuid)}async undo(e){const{view:t}=this._detail;await e.createView(t)}}class Qb{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t,newViewName:r}=this._detail;await e.updateViewName(t,r)}async undo(e){const{viewId:t,oldViewName:r}=this._detail;await e.updateViewName(t,r)}}class ew{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t,newViewDesc:r}=this._detail;await e.updateViewName(t,r)}async undo(e){const{viewId:t,oldViewDesc:r}=this._detail;await e.updateViewName(t,r)}}class tw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{targetViewId:t,sourceViewId:r}=this._detail;await e.copyView(t,r)}async undo(e){const{targetViewId:t}=this._detail;await e.removeView(t)}}class rw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t,newConfig:r}=this._detail;await e.updateViewConfig(t,r)}async undo(e){const{viewId:t,oldConfig:r}=this._detail;await e.updateViewConfig(t,r)}}class nw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t}=this._detail;await e.switchView(t)}async undo(e){const{oldViewId:t}=this._detail;await e.switchView(t)}}class iw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{fieldId:t,newName:r}=this._detail;await e.updateFieldName(t,r)}async undo(e){const{fieldId:t,oldName:r}=this._detail;await e.updateFieldName(t,r)}}class ow{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t,sourceFieldId:r,targetFieldId:n}=this._detail;await e.updateFieldOrder(t,r,n)}async undo(e){const{viewId:t,sourceFieldId:r,sourcePrevFieldId:n}=this._detail;await e.updateFieldOrder(t,r,n)}}class aw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t,fieldId:r,newSize:n}=this._detail;await e.updateFieldSize(t,r,n)}async undo(e){const{viewId:t,fieldId:r,oldSize:n}=this._detail;await e.updateFieldSize(t,r,n)}}class sw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t,newFilters:r}=this._detail;await e.writeService.updateFilter(t,r)}async undo(e){const{viewId:t,oldFilters:r}=this._detail;await e.writeService.updateFilter(t,r)}}class lw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t,sourceRecordId:r,targetRecordId:n,sourceGroupItem:i,targetGroupItem:o}=this._detail;await e.updateRecordOrder(t,r,n,i,o)}async undo(e){const{viewId:t,sourceRecordId:r,targetPrevRecordId:n,sourceGroupItem:i,targetGroupItem:o}=this._detail;await e.updateRecordOrder(t,r,n,o,i)}}class cw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t,newSort:r,newAuto:n}=this._detail;await e.updateSort(t,r,n)}async undo(e){const{viewId:t,oldSort:r,oldAuto:n}=this._detail;await e.updateSort(t,r,n)}}class uw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{targetViewId:t,sourceViewId:r}=this._detail;await e.updateViewOrder(t,r)}async undo(e){const{sourcePrevViewId:t,sourceViewId:r}=this._detail;await e.updateViewOrder(r,t)}}class dw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t,group:r}=this._detail;await e.createGroup(t,r)}async undo(e){const{viewId:t}=this._detail;await e.removeGroup(t)}}class fw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t}=this._detail;await e.removeGroup(t)}async undo(e){const{viewId:t,group:r}=this._detail;await e.createGroup(t,r)}}class pw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t,newGroup:r}=this._detail;await e.updateGroup(t,r)}async undo(e){const{viewId:t,oldGroup:r}=this._detail;await e.updateGroup(t,r)}}class hw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){await e.removeRecords([],!0)}async undo(e){const{viewId:t,records:r}=this._detail;await e.createRecords(t,r)}}class mw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{fieldId:t,fieldOption:r,sourceOptionId:n}=this._detail;await e.createFieldOption(t,r,n)}async undo(e){const{fieldOption:t}=this._detail;await e.removeFieldOption(t.uuid)}}class vw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{fieldOption:t}=this._detail;await e.removeFieldOption(t.uuid)}async undo(e){const{fieldId:t,fieldOption:r,sourceOptionId:n}=this._detail;await e.createFieldOption(t,r,n)}}class gw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{optionId:t,newOption:r}=this._detail;await e.writeService.updateFieldOption(t,r)}async undo(e){const{optionId:t,oldOption:r}=this._detail;await e.writeService.updateFieldOption(t,r)}}class yw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{fieldId:t,newOptions:r,newColor:n}=this._detail;await e.writeService.updateFieldProperty({uuid:t,color:n,options:r})}async undo(e){const{fieldId:t,oldOptions:r,oldColor:n}=this._detail;await e.writeService.updateFieldProperty({uuid:t,color:n,options:r})}}class bw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{fieldId:t,sourceFieldOptionId:r,targetFieldOptionId:n}=this._detail;await e.updateFieldOptionOrder(t,r,n)}async undo(e){const{fieldId:t,sourceFieldOptionId:r,targetFieldOptionId:n}=this._detail;await e.updateFieldOptionOrder(t,r,n)}}class ww{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t,fieldId:r,hidden:n}=this._detail;await e.updateFieldHidden(t,r,n)}async undo(e){const{viewId:t,fieldId:r,hidden:n}=this._detail;await e.updateFieldHidden(t,r,!n)}}class _w{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{newCell:t}=this._detail;await e.writeService.setCell(t)}async undo(e){const{oldCell:t}=this._detail;await e.writeService.setCell(t)}}class Cw{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{viewId:t,recordId:r,sourceRecordId:n,modifierId:i}=this._detail;await e.writeService.copyRecord({viewId:t,uuid:r,sourceRecordId:n,modifierId:i})}async undo(e){const{recordId:t}=this._detail;await e.writeService.removeRecord(t)}}class Ew{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{optionId:t,targetOptionId:r}=this._detail;await e.writeService.updateMentionFieldOptionId(t,r)}async undo(e){const{optionId:t,targetOptionId:r}=this._detail;await e.writeService.updateMentionFieldOptionId(r,t)}}class xw{constructor(e,t,r,n,i){this.type=e,this.readService=t,this.writeService=r,this.modelService=n,this.transaction=i}destroy(){delete this.type,delete this.transaction}refreshView(e){this.writeService.refreshView(e)}createView(e){this.writeService.createView(e)}createViewByType(e,t){const r=this.writeService.createViewByType(e,t);return r&&this.transaction.addOperation(new Kb({view:r})),r}removeView(e){const t=this.readService.getView(e);this.writeService.removeView(e),this.transaction.addOperation(new Jb({view:t}))}switchView(e){if(this.type===jb.OT)return;const t=this.readService.getActiveView(),{active_view_uuid:r}=this.writeService.setActiveView(e)||{};this.transaction.addOperation(new nw({viewId:r,oldViewId:(null==t?void 0:t.uuid)||""}))}updateViewName(e,t){const r=this.readService.getView(e),{name:n}=this.writeService.updateView(e,{name:t});this.transaction.addOperation(new Qb({viewId:e,oldViewName:null==r?void 0:r.name,newViewName:n}))}updateViewDesc(e,t){const r=this.readService.getView(e),{desc:n}=this.writeService.updateView(e,{desc:t});this.transaction.addOperation(new ew({viewId:e,oldViewDesc:(null==r?void 0:r.desc)||"",newViewDesc:n}))}copyView(e,t){const r=this.writeService.copyView(e,t);return this.transaction.addOperation(new tw({targetViewId:e,sourceViewId:t})),r}updateViewConfig(e,t){const r=this.readService.getViewConfig(e),n=this.writeService.updateViewConfig(e,t);this.transaction.addOperation(new rw({viewId:e,oldConfig:r,newConfig:Object.assign({},r,n)}))}updateViewOrder(e,t){var r;const n=this.readService.getViews(),i=n.findIndex((t=>t.uuid===e)),o=null==(r=n[i-1])?void 0:r.uuid;this.writeService.updateViewOrder(e,t),this.transaction.addOperation(new uw({sourceViewId:e,sourcePrevViewId:o,targetViewId:t}))}createSort(e,t,r=!1){this.writeService.createSort(e,t,r),this.transaction.addOperation(new Gb({viewId:e,sort:t,auto:r}))}removeSort(e){const t=this.readService.getViewSort(e),r=this.readService.getViewConfig(e);this.writeService.removeSort(e),t&&this.transaction.addOperation(new Zb({viewId:e,sort:t,auto:!(null==r||!r.keep_sort)}))}updateSort(e,t,r){const n=this.readService.getViewConfig(e),i=this.readService.getViewSort(e),o=this.writeService.updateSort(e,t,r);!i||this.transaction.addOperation(new cw({viewId:e,newSort:Object.assign({},i,o),oldSort:i,newAuto:r,oldAuto:!(null==n||!n.keep_sort)}))}createGroup(e,t){this.writeService.createGroup(e,t),this.transaction.addOperation(new dw({viewId:e,group:t}))}removeGroup(e){const t=this.readService.getViewGroup(e);!t||(this.writeService.removeGroup(e),this.transaction.addOperation(new fw({viewId:e,group:t})))}updateGroup(e,t){const r=this.readService.getViewGroup(e);if(!r)return;const n=this.writeService.updateGroup(e,t);this.transaction.addOperation(new pw({viewId:e,newGroup:Object.assign({},r,n),oldGroup:r}))}createRecord(e){const t=this.readService.getActiveView(),r=this.readService.getOriginViewRecords(),n=r[r.length-1].record_uuid;this.writeService.createRecord(null==t?void 0:t.uuid,n,e)}createEmptyRecord(e){var t;const{uuid:r,direction:n="after",groupItemKey:i}=e||{};let o=null==e?void 0:e.sourceRecordId;const a=this.readService.getActiveView();if(!a)return[];if(!o){const e=this.readService.getOriginViewRecords();o=null==(t=e[e.length-1])?void 0:t.record_uuid}let s;if(i){const e=this.readService.getViewRecords(a.uuid);for(const t of e)if(this.readService.keyValue(t.groupOption)===i){s=t.groupOption;break}}const l=this.writeService.createEmptyRecord({viewId:null==a?void 0:a.uuid,uuid:r,viewRecord:void 0,sourceRecordId:o,direction:n,groupOption:s,modifierId:null==e?void 0:e.modifierId});return this.transaction.addOperation(new Wb({viewId:null==a?void 0:a.uuid,records:l,viewRecord:void 0,sourceRecordId:o,direction:n,groupOption:s,modifierId:null==e?void 0:e.modifierId})),l}copyRecord(e){const{uuid:t,sourceRecordId:r,modifierId:n}=e,i=this.readService.getActiveView();!i||(this.writeService.copyRecord({uuid:t,viewId:null==i?void 0:i.uuid,sourceRecordId:r,modifierId:n}),this.transaction.addOperation(new Cw({viewId:i.uuid,recordId:t,sourceRecordId:r,modifierId:n})))}createRecords(e,t){this.writeService.createRecords(e,t)}async removeRecord(e){var t;const r=this.readService.getActiveView(),n=this.readService.getOriginRecord(e),i=this.readService.getOriginViewRecords(),o=i.findIndex((t=>t.record_uuid===e));let a="",s="after";if(!n||o<0||!r)return;const l=i[o].group_item_key;let c;if(l){const e=this.readService.getViewRecords(r.uuid);for(const t of e)if(this.readService.keyValue(t.groupOption)===l){c=t.groupOption;break}}o>0?a=i[o-1].record_uuid:0===o&&(a=null==(t=i[o+1])?void 0:t.record_uuid,s="before");const u=this.readService.getRecordCells(e);await this.removeCells(u),this.writeService.removeRecord(e),this.transaction.addOperation(new Xb({viewId:r.uuid,record:n,viewRecord:i[o],sourceRecordId:a,direction:s,groupOption:c}))}async removeRecords(e,t){const r=this.readService.getActiveView();if(r)if(t){const e=this.readService.getOriginViewRecords(null==r?void 0:r.uuid),t=[];for(const r of e){const e=this.readService.getOriginRecord(r.record_uuid);e&&t.push(e)}this.writeService.removeAllRecords(r.uuid),this.transaction.addOperation(new hw({viewId:null==r?void 0:r.uuid,records:t}))}else for(const t of e)await this.removeRecord(t)}updateRecordOrder(e,t,r,n,i){var o;const a=this.readService.getOriginViewRecords(e),s=a.findIndex((e=>e.record_uuid===t));this.writeService.updateRecordOrder(e,t,r,i),this.transaction.addOperation(new lw({viewId:e,sourceRecordId:t,targetRecordId:r,targetPrevRecordId:null==(o=a[s-1])?void 0:o.record_uuid,sourceGroupItem:n,targetGroupItem:i}))}createField({viewId:e,field:t,viewField:r,sourceFieldId:n,direction:i}){var o;if(!n){const e=this.readService.getViewFields()||[];n=null==(o=e[e.length-1])?void 0:o.field_uuid}const a=this.writeService.createField({viewId:e,field:t,viewField:r,sourceFieldId:n,direction:i});!a||this.transaction.addOperation(new Ub({viewId:e,field:{...t,uuid:a.uuid},viewField:r,sourceFieldId:n,direction:i}))}async removeField(e){const t=this.readService.getActiveView(),r=t&&this.readService.getAllViewFields(t.uuid);if(!r)return;const n=null==r?void 0:r.findIndex((t=>t.field_uuid===e));if(!r||-1===n||!r[n].field)return;const i=this.readService.getViewFilters(t.uuid),o=this.readService.getViewSort(t.uuid);for(const t of i){t.field_uuid===e&&this.removeFilter(t.uuid);break}(null==o?void 0:o.field_uuid)===e&&this.removeSort(t.uuid);const a=this.readService.getFieldCells(e);await this.removeCells(a),this.writeService.removeField(e);let s="";n>0?s=r[n-1].field_uuid:0===n&&(s=r[n].field_uuid),this.transaction.addOperation(new qb({viewId:t.uuid,field:r[n].field,viewField:r[n],sourceFieldId:s,direction:"after"}))}createFieldOption(e,t,r){var n;if(!r){const t=this.readService.getFieldOptions(e)||[];r=null==(n=t[t.length-1])?void 0:n.uuid}const i=this.writeService.createFieldOption(e,t,r);this.transaction.addOperation(new mw({fieldId:e,fieldOption:Object.assign({},t,i),sourceOptionId:r}))}updateFieldOption(e,t){const r=this.readService.getFieldOption(e);if(t.users){if(0===t.users.length)return void this.removeFieldOption(e);const n=this.readService.getActiveView();if(!n)return;const i=this.readService.getFieldOptionCells(n.uuid,r),o=null==i?void 0:i.map((e=>({recordId:e.recordId,fieldId:e.fieldId,value:t.users||[],cellId:e.cellId,fieldType:e.fieldType,uuid:e.uuid}))),a=this.readService.keyValue({fieldId:t.field_uuid,value:[...t.users]});this.writeService.updateMentionFieldOptionId(e,a),this.bulkSetCell(o),this.transaction.addOperation(new Ew({optionId:e,targetOptionId:a}))}else this.writeService.updateFieldOption(e,t),this.transaction.addOperation(new gw({optionId:e,oldOption:r,newOption:this.readService.getFieldOption(e)}))}updateFieldProperty(e){const t=e.uuid,r=this.readService.getField(t);if(!r)return;this.writeService.updateFieldProperty(e);const n=this.readService.getField(t);!n||this.transaction.addOperation(new yw({fieldId:e.uuid,oldColor:r.color,newColor:n.color,oldOptions:r.options||[],newOptions:n.options||[]}))}removeFieldOption(e){const t=this.readService.getFieldOption(e),r=this.readService.getFieldOptions(t.field_uuid)||[],n=r.findIndex((t=>t.uuid===e));let i="";const o=this.readService.getActiveView();if(!o)return;n>0?i=r[n-1].uuid:0===n&&(i=r[n].uuid);const a=this.readService.getFieldOptionCells(o.uuid,t),s=null==a?void 0:a.map((e=>({recordId:e.recordId,fieldId:e.fieldId,value:null,cellId:e.cellId,fieldType:e.fieldType,uuid:e.uuid})));this.bulkSetCell(s),this.writeService.removeFieldOption(e),this.transaction.addOperation(new vw({fieldId:t.field_uuid,fieldOption:t,sourceOptionId:i}))}updateFieldOptionOrder(e,t,r){this.writeService.updateFieldOptionOrder(e,t,r),this.transaction.addOperation(new bw({fieldId:e,sourceFieldOptionId:t,targetFieldOptionId:r}))}changeFieldType(e,t,r){const n=this.readService.getFieldCells(e);if(this.writeService.changeFieldType(e,t,r,n),r!==Rh.SELECT||r!==Rh.MENTION){const t=this.readService.getViews(),r=this.readService.getAllFields().find((e=>e.type===Rh.SELECT||e.type===Rh.MENTION));t.forEach((t=>{const n=this.readService.getViewGroup(t.uuid);n&&n.field_uuid===e&&t.type===Wh.KANBAN&&(r?this.updateGroup(t.uuid,{field_uuid:r.uuid,type:r.type}):this.removeGroup(t.uuid))}))}this.transaction.addOperation(new zb({fieldId:e,fromType:t,toType:r,oldCells:n}))}updateFieldName(e,t){const r=this.readService.getField(e);this.writeService.updateFieldName(e,t),r&&this.transaction.addOperation(new iw({fieldId:e,newName:t,oldName:r.name}))}updateFieldSize(e,t,r){const n=this.readService.getViewField(e,t);this.writeService.updateFieldSize(e,t,r),n&&this.transaction.addOperation(new aw({viewId:e,fieldId:t,newSize:r,oldSize:n.size||180}))}updateFieldOrder(e,t,r){var n;const i=this.readService.getViewFields(),o=null==i?void 0:i.findIndex((e=>e.field_uuid===t)),a=null==(n=i[o-1])?void 0:n.field_uuid;this.writeService.updateFieldOrder(e,t,r),this.transaction.addOperation(new ow({viewId:e,sourceFieldId:t,sourcePrevFieldId:a,targetFieldId:r}))}updateFieldHidden(e,t,r){this.writeService.updateFieldHidden(e,t,r),this.transaction.addOperation(new ww({viewId:e,fieldId:t,hidden:r}))}upsertStat(e,t,r){this.writeService.upsertStat(e,t,r)}removeStat(e,t){this.writeService.removeStat(e,t)}createFilter(e,t){this.writeService.createFilter(e,t),this.transaction.addOperation(new Hb({viewId:e,filter:t}))}removeFilter(e){const t=this.readService.getActiveView(),r=this.writeService.removeFilter(e);!t||this.transaction.addOperation(new Yb({viewId:null==t?void 0:t.uuid,filter:r}))}updateFilter(e,t){const r=this.readService.getViewFilters(e);this.writeService.updateFilter(e,t);const n=this.readService.getViewFilters(e);this.transaction.addOperation(new sw({viewId:e,oldFilters:r,newFilters:n}))}async setCell(e){const t=this.readService.getCell(e.fieldId,e.recordId);await this.writeService.setCell(e);const r=this.readService.getCell(e.fieldId,e.recordId);!t||!r||this.transaction.addOperation(new _w({oldCell:t,newCell:r}))}async bulkSetCell(e){const t=[];for(const r of e){if(!r.fieldId||!r.recordId)continue;const e=this.readService.getCell(r.fieldId,r.recordId);!e||t.push({old:e,new:r})}await this.writeService.bulkSetCell(e);for(const e of t)this.transaction.addOperation(new _w({oldCell:e.old,newCell:Object.assign({},e.old,e.new)}))}async safeSetCell(e,t,r,n,i){const o=this.readService.getCell(e.fieldId,e.recordId);await this.writeService.safeSetCell(e,t,r,n,i);const a=this.readService.getCell(e.fieldId,e.recordId);!o||!a||this.transaction.addOperation(new _w({oldCell:o,newCell:a}))}async removeCells(e){const t=e.map((e=>({...e,value:""}))),r=Ju(t,"fieldId"),n=Object.values(r);for(const e of Object.values(n))await this.bulkSetCell(e)}updateValueOrder({fieldId:e,fieldType:t,recordId:r,sourceValueId:n,targetValueId:i}){this.writeService.updateValueOrder({fieldId:e,fieldType:t,recordId:r,sourceValueId:n,targetValueId:i})}upsertShareView(e,t){this.writeService.upsertViewShare(e,t)}removeViewField(e,t){this.writeService.removeViewField(e,t)}insertViewField(e,t){this.writeService.insertViewField(e,t)}updateViewFieldDisplayType(e,t,r){this.writeService.updateViewField(e,t,{display_type:r})}updateViewFieldRequired(e,t,r){this.writeService.updateViewField(e,t,{required:r})}updateViewFieldName(e,t,r){this.writeService.updateViewField(e,t,{name:r})}updateViewFieldGroup(e,t,r){this.writeService.updateViewField(e,t,{group_uuid:r})}cloneViewField(e,t,r){this.writeService.cloneViewField(e,t,r)}createFieldGroup(e,t){return this.writeService.createFieldGroup(e,t)}removeFieldGroup(e,t){this.writeService.removeFieldGroup(e,t)}changeFieldGroupName(e,t){this.writeService.changeFieldGroupName(e,t)}}var Sw=Object.defineProperty,kw=Object.getOwnPropertyDescriptor,Ow=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?kw(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Sw(t,r,o),o};let Iw=class extends Zf{constructor(){super(...arguments),this._commandList=[],this.isInProcess=!1,this._onWillExecuteCommand=this._register(new op),this.onWillExecuteCommand=this._onWillExecuteCommand.event,this._onDidExecuteCommand=this._register(new op),this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._onCancelExecuteCommand=this._register(new op),this.onCancelExecuteCommand=this._onCancelExecuteCommand.event,this._onFinishExecuteCommand=this._register(new op),this.onFinishExecuteCommand=this._onFinishExecuteCommand.event}destroy(){this._commandList=[],this.isInProcess=!1}_addQueue(e,t,r){return this._commandList.push({jobType:e,commandContext:t,func:r}),this._commandList.length>0&&!this.isInProcess?(this.isInProcess=!0,this._process()):Promise.resolve({isSuccess:!1,error:new Error("The command is in process")})}_process(){const e=this._commandList.shift();if(e){const{jobType:t,commandContext:r,func:n}=e,i=new Bb(this,t,r.Job,this.readService,this.writeService,this.modelService,{beforeExecute:e=>{this._onWillExecuteCommand.emit({job:e.job,context:r})},afterExecute:async e=>{this._onDidExecuteCommand.emit({job:e.job,context:r})},completed:(e,t,n)=>{if(!t)return this._onCancelExecuteCommand.emit({changed:!0});const i={changed:!0};this._onFinishExecuteCommand.emit({operations:n,type:e.job.type,change:i,context:r})}});return i.execute(n).then((e=>(i.destroy(),this._process(),e)))}return this.isInProcess=!1,Promise.resolve({isSuccess:!0})}async execCommand(e,t,r){return this._addQueue(e,t,r)}async exec(e,t,r,n,i,o,a){const s=new $b(this,e,t.customJob||xw,a);let l=t.jobType;return r?l=jb.Auto:l===jb.Auto&&(l=jb.User),await this.execCommand(l,s,(async e=>(s.setJob(e),s.setRemote(n),s.setUser(this.readService.currentUser),t.context=s,await i.call(o,...a))))}};Ow([to(Dy)],Iw.prototype,"readService",2),Ow([to(Wy)],Iw.prototype,"writeService",2),Ow([to(Wp)],Iw.prototype,"modelService",2),Ow([Si()],Iw.prototype,"destroy",1),Iw=Ow([eo({token:Tb})],Iw);const Rw=bo().register(Iw).register(Lb).register(Pb);Fi.defineToken("KernelService");const Tw=Fi.defineToken("KernelPluginContribution");var Aw=(e=>(e.CREATE="create",e.DELETE="delete",e.READ="read",e.UPDATE="update",e.EDIT="edit",e.TRANSFORM="transform",e))(Aw||{}),Nw=(e=>(e.TABLE="table",e.FIELD="field",e.RECORD="record",e))(Nw||{}),Mw=Object.defineProperty,Pw=Object.getOwnPropertyDescriptor,jw=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Pw(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Mw(t,r,o),o};let Dw=class{constructor(){this._abilityMap=new Map}registerConfiguration(){this._configuration.registerConfiguration({id:"ability",type:"object",title:"权限"})}getAbilities(){return Array.from(this._abilityMap.values())}getAbility(e){return this._abilityMap.get(e)}registerAbility(e){this._abilityMap.set(e.id,e)}};jw([to(qf)],Dw.prototype,"_configuration",2),jw([xi()],Dw.prototype,"registerConfiguration",1),Dw=jw([eo()],Dw);var Fw=Object.defineProperty,Vw=Object.getOwnPropertyDescriptor,Lw=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Vw(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Fw(t,r,o),o};let $w=class{init(){var e;const t=this._abilityRegistry.getAbilities();for(const r of t)null==(e=r.init)||e.call(r)}};Lw([to(Dw)],$w.prototype,"_abilityRegistry",2),$w=Lw([eo()],$w);var Bw=Object.defineProperty,zw=Object.getOwnPropertyDescriptor,Uw=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?zw(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Bw(t,r,o),o};let Hw=class{isReadonly(e,...t){const r=this._abilityRegistry.getAbility(Nw.TABLE);if(!r.read()||r.update())return!1;const n=this._abilityRegistry.getAbility(e);return!!n&&(!!n.read(...t)&&!n.update(...t))}can(e,t,...r){var n;if(e===Aw.CREATE)return this.canCreate(t,...r);if(e===Aw.DELETE)return this.canDelete(t,...r);if(e===Aw.READ)return this.canRead(t,...r);if(e===Aw.UPDATE)return this.canUpdate(t,...r);if(!t)return!1;const i=this._abilityRegistry.getAbility(t);return!!i&&!(null==(n=i[e])||!n.call(i,...r))}canCreate(e,...t){const r=this._abilityRegistry.getAbility(Nw.TABLE);if(!r.create())return!1;if(!e||e===Nw.TABLE)return r.create();const n=this._abilityRegistry.getAbility(e);return!!n&&!!n.create(...t)}canDelete(e,...t){const r=this._abilityRegistry.getAbility(Nw.TABLE);if(!r.delete())return!1;if(!e||e===Nw.TABLE)return r.delete();const n=this._abilityRegistry.getAbility(e);return!!n&&!!n.delete(...t)}canRead(e,...t){const r=this._abilityRegistry.getAbility(Nw.TABLE);if(!r.read())return!1;if(!e||e===Nw.TABLE)return r.read();const n=this._abilityRegistry.getAbility(e);return!!n&&!!n.read(...t)}canUpdate(e,...t){const r=this._abilityRegistry.getAbility(Nw.TABLE);if(!r.update())return!1;if(!e||e===Nw.TABLE)return r.update();const n=this._abilityRegistry.getAbility(e);return!!n&&!!n.update(...t)}};Uw([to(Dw)],Hw.prototype,"_abilityRegistry",2),Hw=Uw([eo()],Hw);var Ww=Object.defineProperty,Gw=Object.getOwnPropertyDescriptor,Kw=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Gw(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ww(t,r,o),o};let qw=class{constructor(){this.id=Nw.TABLE}registerConfiguration(){this._configuration.registerConfiguration({id:"ability.table",type:"object",title:"table表权限",properties:{create:{type:"boolean",description:"新增权限，控制能否新增字段或记录"},delete:{type:"boolean",description:"删除权限，控制能否删除字段或记录"},read:{type:"boolean",description:"可读权限，控制字段或记录是否可读"},update:{type:"boolean",description:"更新权限，控制能否更新字段或记录，能否新增、删除、复制、拖拽视图，能否拖拽记录、字段"}}}),this._configuration.registerDefaultValue({"ability.table.create":!0,"ability.table.delete":!0,"ability.table.read":!0,"ability.table.update":!0})}init(){}getAbilities(){return this._configuration.getValue("ability.table")}create(){return this._configuration.getValue("ability.table.create")}delete(){return this._configuration.getValue("ability.table.delete")}read(){return this._configuration.getValue("ability.table.read")}update(){return this._configuration.getValue("ability.table.update")}};Kw([to(qf)],qw.prototype,"_configuration",2),Kw([xi()],qw.prototype,"registerConfiguration",1),qw=Kw([eo()],qw);var Yw=Object.defineProperty,Xw=Object.getOwnPropertyDescriptor,Zw=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Xw(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Yw(t,r,o),o};let Jw=class{constructor(){this.id=Nw.FIELD}registerConfiguration(){this._configuration.registerConfiguration({id:"ability.field",type:"object",title:"field表权限",properties:{create:{type:"boolean",description:"字段新增权限"},delete:{type:"boolean",description:"字段删除权限"},deleteAllowList:{type:"array",items:{type:"string"},description:"可删除字段列表"},read:{type:"boolean",description:"字段可读权限"},readAllowList:{type:"array",items:{type:"string"},description:"可读字段列表"},update:{type:"boolean",description:"字段更新权限，控制能否修改字段名称、新增字段选项"},updateAllowList:{type:"array",items:{type:"string"},description:"可更新字段列表"},transform:{type:"boolean",description:"字段类型转换权限"},transformAllowList:{type:"array",items:{type:"string"},description:"可类型转换字段列表"},edit:{type:"boolean",description:"字段内容编辑权限"},editAllowList:{type:"boolean",description:"可编辑字段列表"}}}),this._configuration.registerDefaultValue({"ability.field.create":!0,"ability.field.delete":!0,"ability.field.read":!0,"ability.field.update":!0,"ability.field.transform":!0,"ability.field.edit":!0,"ability.field.readAllowList":["*"],"ability.field.editAllowList":["*"],"ability.field.updateAllowList":["*"],"ability.field.deleteAllowList":["*"],"ability.field.transformAllowList":["*"]})}isAllow(e,t=["*"]){return"*"===t[0]||t.indexOf(e)>=0}init(){}create(e){return(!e||!this._fieldRegistry.getValueField(e.type).createDisable)&&this._configuration.getValue("ability.field.create")}delete(e){if(this._fieldRegistry.getValueField(e.type).deleteDisable)return!1;const t=this._configuration.getValue("ability.field.delete"),r=this._configuration.getValue("ability.field.deleteAllowList");return!0===t?this.isAllow(e.uuid,r):t}read(e){const t=this._configuration.getValue("ability.field.read"),r=this._configuration.getValue("ability.field.readAllowList");return!0===t?this.isAllow(e.uuid,r):t}update(e){const t=this._configuration.getValue("ability.field.update"),r=this._configuration.getValue("ability.field.updateAllowList");return!0===t?this.isAllow(e.uuid,r):t}transform(e){if(this._fieldRegistry.getValueField(e.type).transformDisable)return!1;const t=this._configuration.getValue("ability.field.transform"),r=this._configuration.getValue("ability.field.transformAllowList");return!0===t?this.isAllow(e.uuid,r):t}edit(e){if(this._fieldRegistry.getValueField(e.type).editDisable)return!1;const t=this._configuration.getValue("ability.field.edit"),r=this._configuration.getValue("ability.field.editAllowList");return!0===t?this.isAllow(e.uuid,r):t}};Zw([to(Mv)],Jw.prototype,"_fieldRegistry",2),Zw([to(qf)],Jw.prototype,"_configuration",2),Zw([xi()],Jw.prototype,"registerConfiguration",1),Jw=Zw([eo()],Jw);var Qw=Object.defineProperty,e_=Object.getOwnPropertyDescriptor,t_=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?e_(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Qw(t,r,o),o};let r_=class{constructor(){this.id=Nw.RECORD}registerConfiguration(){this._configuration.registerConfiguration({id:"ability.record",type:"object",title:"record表权限",properties:{create:{type:"boolean",description:"记录新增权限"},delete:{type:"boolean",description:"记录删除权限"},deleteAllowList:{type:"array",items:{type:"string"},description:"可删除记录列表"},read:{type:"boolean",description:"记录可读权限"},readAllowList:{type:"array",items:{type:"string"},description:"可读记录列表"},update:{type:"boolean",description:"记录更新权限，控制能否修改记录描述"},updateAllowList:{type:"array",items:{type:"string"},description:"可更新记录列表"},edit:{type:"boolean",description:"记录内容编辑权限"},editAllowList:{type:"array",items:{type:"string"},description:"可编辑记录列表"}}}),this._configuration.registerDefaultValue({"ability.record.create":!0,"ability.record.delete":!0,"ability.record.read":!0,"ability.record.update":!0,"ability.record.edit":!0,"ability.record.readAllowList":["*"],"ability.record.editAllowList":["*"],"ability.record.updateAllowList":["*"],"ability.record.deleteAllowList":["*"]})}isAllow(e,t=["*"]){return"*"===t[0]||t.indexOf(e)>=0}init(){}create(){return this._configuration.getValue("ability.record.create")}delete(e){const t=this._configuration.getValue("ability.record.delete"),r=this._configuration.getValue("ability.record.deleteAllowList");return!0===t?this.isAllow(e.uuid,r):t}read(e){const t=this._configuration.getValue("ability.record.read"),r=this._configuration.getValue("ability.record.readAllowList");return!0===t?this.isAllow(e.uuid,r):t}update(e){const t=this._configuration.getValue("ability.record.update"),r=this._configuration.getValue("ability.record.updateAllowList");return!0===t?this.isAllow(e.uuid,r):t}edit(e){const t=this._configuration.getValue("ability.record.edit"),r=this._configuration.getValue("ability.record.editAllowList");return!0===t?this.isAllow(e.uuid,r):t}};t_([to(qf)],r_.prototype,"_configuration",2),t_([xi()],r_.prototype,"registerConfiguration",1),r_=t_([eo()],r_);const n_=bo().register($w).register(qw).register(Jw).register(r_).register(Dw).register(Hw);var i_=Object.defineProperty,o_=Object.getOwnPropertyDescriptor,a_=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?o_(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&i_(t,r,o),o};let s_=class extends Zf{constructor(){super(...arguments),this._onDataLoaded=this._register(new op),this.onDataLoaded=this._onDataLoaded.event,this._onDataChanged=this._register(new op),this.onDataChanged=this._onDataChanged.event,this._isFirstLoad=!0,this._isRecordFirstLoad=!0,this.hooks={init:new kh,destroy:new Oh}}async init({container:e}){this.registerAbility(this._tableAbility),this.registerAbility(this._fieldAbility),this.registerAbility(this._recordAbility),e.get($w).init(),this._listenEvent(),this._initPlugins(),await this.hooks.init.promise()}initCommandHooks(e){for(const t of e)this._commandService.registerCommandHook(t.commandName,t)}_initPlugins(){this.kernelPluginProvider.getContributions({cache:!1}).forEach((e=>{e.init(this)})),this._commandService.seal()}_listenEvent(){this._commandService.onDidExecuteCommand((()=>{this._onDataChanged.emit("command-execute")})),this._refreshEventService.onAfterRefresh((()=>{this._onDataChanged.emit("refresh-event")}))}registerField(e){this._fieldRegistry.registerField(e)}registerAbility(e){this._abilityRegistry.registerAbility(e)}setContent(e){!e||(this._lifeService.status<gf.WorkbenchInited?this._lifeService.when(gf.WorkbenchInited,(()=>{this._loadData(e)})):this._loadData(e))}_loadData(e){this._isFirstLoad&&(this._lifeService.status=gf.Starting);const t=(e="string"==typeof e?JSON.parse(e):Object.assign({},e)).records;delete e.records,this._kernelModel.initData(e),this._isFirstLoad&&(this._lifeService.status=gf.Ready,this._logger.log({type:"kernel",action:"dataReady",data:e})),this._onDataLoaded.emit("loadedData"),t&&this.setRecords(t),this._isFirstLoad=!1}setRecords(e){!e||(this._lifeService.status<gf.Ready?this._lifeService.when(gf.Ready,(()=>{this._loadRecords(e)})):this._loadRecords(e))}_loadRecords(e){this._isRecordFirstLoad?(this._lifeService.status=gf.RecordInit,this._kernelModel.initRecords(e),this._lifeService.status=gf.RecordReady,this._isRecordFirstLoad=!1,this._logger.log({type:"kernel",action:"recordReady",data:e})):this._kernelModel.initRecords(e),this._onDataLoaded.emit("loadedRecords")}setUsers(e){!e||this._kernelModel.initUsers(e)}destroy(){super.destroy(),this.kernelPluginProvider.getContributions({cache:!1}).forEach((e=>{var t;null==(t=e.destroy)||t.call(e)})),this.hooks.destroy.call()}};a_([Eo(Tw)],s_.prototype,"kernelPluginProvider",2),a_([to(Pb)],s_.prototype,"_commandService",2),a_([to(Qy)],s_.prototype,"_kernelModel",2),a_([to(By)],s_.prototype,"_refreshEventService",2),a_([to(yf)],s_.prototype,"_lifeService",2),a_([to(Mv)],s_.prototype,"_fieldRegistry",2),a_([to(Dw)],s_.prototype,"_abilityRegistry",2),a_([to(qw)],s_.prototype,"_tableAbility",2),a_([to(Jw)],s_.prototype,"_fieldAbility",2),a_([to(r_)],s_.prototype,"_recordAbility",2),a_([to(ib)],s_.prototype,"_logger",2),a_([Si()],s_.prototype,"destroy",1),s_=a_([eo()],s_),_o.config({lifecycle:Fi.Lifecycle.singleton});class l_ extends Ih{constructor(e){super(),this._onFinishExecuteCommand=this._register(new op),this.onFinishExecuteCommand=this._onFinishExecuteCommand.event,this._options=e,this.container=e.container||new _o,this._loadCoreServices(),this.registerPlugins(e.plugins,{container:this.container}),this._registerContribs(e.contribs),this.init(),this._logger.log({type:"kernel",action:"kernelInited",data:e})}get onDataLoaded(){return this.kernelService.onDataLoaded}start(){this._options.data&&this.kernelService.setContent(this._options.data)}init(){this.container.get(Qy).init();const e=this.container.get(kb).getCurrentUser();e&&this.container.get(Tv).setCurrentUser(e),this.kernelService.init({container:this.container}),this._options.commandHooks&&this.kernelService.initCommandHooks(this._options.commandHooks),this.container.get(Pb).onFinishExecuteCommand((e=>{this._onFinishExecuteCommand.emit(e)})),this._lifeService.status=gf.Inited}destroy(){super.destroy(),this.kernelService.destroy(),this.unregisterPlugins(this.container)}get _logger(){return this.container.get(ib)}_loadCoreServices(){this._lifeService=this.container.get(yf),this.container.get(Of),this.container.get(xy),this.kernelService=this.container.get(s_)}getContent(){return this.container.get(Yy).getContent()}setContent(e){this.kernelService.setContent(e)}setRecords(e){this.kernelService.setRecords(e)}setUsers(e){this.kernelService.setUsers(e)}_registerContribs(e){if(e)for(const t of e)this.container.register(t)}}const c_=bo().contribution(Tw).register(s_);var u_=Object.defineProperty,d_=Object.getOwnPropertyDescriptor,f_=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?d_(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&u_(t,r,o),o};let p_=class{toValue(e){const t=this._readService.getField(e.fieldId);let r=e.value||"";if(Array.isArray(r))(null==t?void 0:t.type)===Rh.MENTION&&(r=null==r?void 0:r.map((e=>{const t=this._readService.getUser(e.uid);return{id:(null==t?void 0:t.uid)||e.uid,name:(null==t?void 0:t.name)||e.name,login:(null==t?void 0:t.login)||e.login,avatar_url:(null==t?void 0:t.icon)||e.icon,work_id:(null==t?void 0:t.work_id)||e.work_id}})));else if((null==t?void 0:t.type)===Rh.LINK)return null!=r&&r.src?{value:{src:(null==r?void 0:r.src)||"",name:(null==r?void 0:r.name)||""}}:{value:null};return(null==t?void 0:t.type)===Rh.DATE?{value:{time:r}}:{value:r}}toColumn(e){var t;const r={id:e.uuid,name:e.name,type:e.type,color:e.color};return e.options&&(r.options=null==(t=e.options)?void 0:t.map((e=>({id:e.uuid,color:e.color,value:e.name})))),r}toRecord(e,t){var r;const n={userId:e.creator_id,modifierId:e.modifier_id},i=e.cells;for(const e of i)!e||t&&e.fieldId!==t||null==e.value&&null===(null==(r=e.value)?void 0:r.name)||Array.isArray(e.value)&&0===e.value.length||(n[e.fieldId]=this.toValue(e));return n}toView(e){const{view:t,sort:r,stats:n,group:i,fieldGroups:o,filters:a,viewRecords:s,viewConfig:l}=e,c=this._readService.getAllViewFields(t.uuid),u=this._readService.getOriginViewRecords(t.uuid),d={id:t.uuid,type:t.type,name:t.name,colCount:(null==c?void 0:c.length)||0,columns:null==c?void 0:c.map((e=>({id:e.field_uuid,size:e.size,hidden:e.hidden}))),data:{},filter:this.toFilter(a),sort:this.toSort(r,l),stats:this.toStats(n),...this.toGroup(i,s),frozenCol:0,index:0,rowCount:u.length,rows:u.map((e=>({id:e.record_uuid}))),rowHeight:this.toRowHeight(l),scrollX:0,scrollY:0,selections:{},tableId:"",columnGroups:this.toColumnGroup(o||[],c||[])};return t.type===Wh.CARD&&(d.cover={show:!!l.cover_field_uuid,id:l.cover_field_uuid,display:l.cover_display}),(t.type===Wh.KANBAN||t.type===Wh.CARD)&&(d.showField=l.show_field_name),t.type===Wh.FORM?{id:t.uuid,type:t.type,name:t.name,desc:t.desc,fields:null==c?void 0:c.filter((e=>{var t;return!Kh.isSystemType(null==(t=e.field)?void 0:t.type)})).map((e=>{var t,r,n,i;const o={columnId:e.field_uuid,columnName:null==(t=e.field)?void 0:t.name,type:null==(r=e.field)?void 0:r.type,title:e.name||(null==(n=e.field)?void 0:n.name),display:e.display_type};if(Kh.isSelectLike(null==(i=e.field)?void 0:i.type)){const t=this.toColumn(e.field);o.options=t.options}return e.required?o.validations=[{required:!0}]:o.validations=[{required:!1}],o})),viewId:t.uuid,createdAt:t.created_at}:d}toFilter(e){const t={};return e&&e.length>0&&(t.operator=e[0].operator,t.options=e.map((e=>({id:e.field_uuid,func:e.func,expected:e.expected}))),0===t.options.length)?null:t}toSort(e,t){if(!e)return null;const r={};return null!=t&&t.keep_sort&&(r.auto=!0),r.options=[{id:e.field_uuid,type:e.type}],r}toStats(e){const t={};return e&&e.length>0&&e.forEach((e=>{t[e.field_uuid]=e.type})),t}toGroup(e,t){const r={};if(!e)return r;const n={id:e.field_uuid,type:e.type};return r.groupData=t.map((e=>{var t,r,i,o;const a={value:(null==(t=e.groupOption)?void 0:t.name)||"",titleValue:null!=(r=e.groupOption)&&r.value?[null==(i=e.groupOption)?void 0:i.value]:""};return a.rows=(null==(o=e.records)?void 0:o.map((e=>e.record_uuid)))||[],a.groupBy=n.id,a})),r.group=[n],r}toColumnGroup(e,t){const r={};return t.forEach((e=>{e.group_uuid&&(r[e.group_uuid]?r[e.group_uuid].push({id:e.field_uuid}):r[e.group_uuid]=[{id:e.field_uuid}])})),e.map((e=>({name:e.name,columns:r[e.uuid]||[]})))}toRowHeight(e){return null!=e&&e.record_height?{low:{type:$h.LOW,name:"低",value:36},middle:{type:$h.MIDDLE,name:"中",value:58},high:{type:$h.HIGH,name:"高",value:146}}[e.record_height]:{type:$h.LOW,name:"低",value:36}}toTable(){const e=this._readService.getTable(),t=this._readService.getOriginViewRecords(),r=this._readService.getAllFields(),n=this._readService.getViews(),i={format:"laketable",type:"Table"};i.version=e.version,i.larkJson=!0;const o={};o.rowIds=t.map((e=>e.record_uuid)),o.rowCount=t.length,o.columns=r.map((e=>{const t={id:e.uuid,name:e.name,type:e.type};e.color&&(t.color=e.color);const r=this._readService.getFieldOptions(e.uuid);return r&&r.length>0&&(t.options=r.map((e=>{const t={id:e.uuid,value:e.name};return e.color&&(t.color=e.color),t}))),t})),o.colCount=r.length,o.activeView=e.active_view_uuid,o.id=e.uuid,o.views={};for(const e of n){const t=this._readService.getViewData(e.uuid),r=this.toView(t);o.views[r.id]=r}return i.sheet=[o],i}};f_([to(Dy)],p_.prototype,"_readService",2),p_=f_([eo()],p_);var h_={};!function(e){var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)r(n,i)&&(e[i]=n[i])}}return e},e.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){var t,r,n,i,o,a;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),i=0,t=0,r=e.length;t<r;t++)o=e[t],a.set(o,i),i+=o.length;return a}},i={arraySet:function(e,t,r,n,i){for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,n)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,i))},e.setTyped(t)}(h_);var m_={},v_={},g_={},y_=h_,b_=0,w_=1;function __(e){for(var t=e.length;--t>=0;)e[t]=0}var C_=0,E_=29,x_=256,S_=x_+1+E_,k_=30,O_=19,I_=2*S_+1,R_=15,T_=16,A_=7,N_=256,M_=16,P_=17,j_=18,D_=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],F_=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],V_=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],L_=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],$_=new Array(2*(S_+2));__($_);var B_=new Array(2*k_);__(B_);var z_=new Array(512);__(z_);var U_=new Array(256);__(U_);var H_=new Array(E_);__(H_);var W_,G_,K_,q_=new Array(k_);function Y_(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function X_(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function Z_(e){return e<256?z_[e]:z_[256+(e>>>7)]}function J_(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function Q_(e,t,r){e.bi_valid>T_-r?(e.bi_buf|=t<<e.bi_valid&65535,J_(e,e.bi_buf),e.bi_buf=t>>T_-e.bi_valid,e.bi_valid+=r-T_):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function eC(e,t,r){Q_(e,r[2*t],r[2*t+1])}function tC(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function rC(e,t,r){var n,i,o=new Array(R_+1),a=0;for(n=1;n<=R_;n++)o[n]=a=a+r[n-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=tC(o[s]++,s))}}function nC(e){var t;for(t=0;t<S_;t++)e.dyn_ltree[2*t]=0;for(t=0;t<k_;t++)e.dyn_dtree[2*t]=0;for(t=0;t<O_;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*N_]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function iC(e){e.bi_valid>8?J_(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function oC(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function aC(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&oC(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!oC(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function sC(e,t,r){var n,i,o,a,s=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],i=e.pending_buf[e.l_buf+s],s++,0===n?eC(e,i,t):(eC(e,(o=U_[i])+x_+1,t),0!==(a=D_[o])&&Q_(e,i-=H_[o],a),eC(e,o=Z_(--n),r),0!==(a=F_[o])&&Q_(e,n-=q_[o],a))}while(s<e.last_lit);eC(e,N_,t)}function lC(e,t){var r,n,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=I_,r=0;r<l;r++)0!==o[2*r]?(e.heap[++e.heap_len]=c=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=c,r=e.heap_len>>1;r>=1;r--)aC(e,o,r);i=l;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],aC(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,o[2*i]=o[2*r]+o[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,o[2*r+1]=o[2*n+1]=i,e.heap[1]=i++,aC(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,o,a,s,l=t.dyn_tree,c=t.max_code,u=t.stat_desc.static_tree,d=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,h=t.stat_desc.max_length,m=0;for(o=0;o<=R_;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<I_;r++)(o=l[2*l[2*(n=e.heap[r])+1]+1]+1)>h&&(o=h,m++),l[2*n+1]=o,!(n>c)&&(e.bl_count[o]++,a=0,n>=p&&(a=f[n-p]),s=l[2*n],e.opt_len+=s*(o+a),d&&(e.static_len+=s*(u[2*n+1]+a)));if(0!==m){do{for(o=h-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[h]--,m-=2}while(m>0);for(o=h;0!==o;o--)for(n=e.bl_count[o];0!==n;)!((i=e.heap[--r])>c)&&(l[2*i+1]!==o&&(e.opt_len+=(o-l[2*i+1])*l[2*i],l[2*i+1]=o),n--)}}(e,t),rC(o,c,e.bl_count)}function cC(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],!(++s<l&&i===a)&&(s<c?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[2*M_]++):s<=10?e.bl_tree[2*P_]++:e.bl_tree[2*j_]++,s=0,o=i,0===a?(l=138,c=3):i===a?(l=6,c=3):(l=7,c=4))}function uC(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++s<l&&i===a)){if(s<c)do{eC(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(eC(e,i,e.bl_tree),s--),eC(e,M_,e.bl_tree),Q_(e,s-3,2)):s<=10?(eC(e,P_,e.bl_tree),Q_(e,s-3,3)):(eC(e,j_,e.bl_tree),Q_(e,s-11,7));s=0,o=i,0===a?(l=138,c=3):i===a?(l=6,c=3):(l=7,c=4)}}__(q_);var dC=!1;function fC(e,t,r,n){Q_(e,(C_<<1)+(n?1:0),3),function(e,t,r,n){iC(e),n&&(J_(e,r),J_(e,~r)),y_.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r,!0)}g_._tr_init=function(e){dC||(function(){var e,t,r,n,i,o=new Array(R_+1);for(r=0,n=0;n<E_-1;n++)for(H_[n]=r,e=0;e<1<<D_[n];e++)U_[r++]=n;for(U_[r-1]=n,i=0,n=0;n<16;n++)for(q_[n]=i,e=0;e<1<<F_[n];e++)z_[i++]=n;for(i>>=7;n<k_;n++)for(q_[n]=i<<7,e=0;e<1<<F_[n]-7;e++)z_[256+i++]=n;for(t=0;t<=R_;t++)o[t]=0;for(e=0;e<=143;)$_[2*e+1]=8,e++,o[8]++;for(;e<=255;)$_[2*e+1]=9,e++,o[9]++;for(;e<=279;)$_[2*e+1]=7,e++,o[7]++;for(;e<=287;)$_[2*e+1]=8,e++,o[8]++;for(rC($_,S_+1,o),e=0;e<k_;e++)B_[2*e+1]=5,B_[2*e]=tC(e,5);W_=new Y_($_,D_,x_+1,S_,R_),G_=new Y_(B_,F_,0,k_,R_),K_=new Y_(new Array(0),V_,0,O_,A_)}(),dC=!0),e.l_desc=new X_(e.dyn_ltree,W_),e.d_desc=new X_(e.dyn_dtree,G_),e.bl_desc=new X_(e.bl_tree,K_),e.bi_buf=0,e.bi_valid=0,nC(e)},g_._tr_stored_block=fC,g_._tr_flush_block=function(e,t,r,n){var i,o,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return b_;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return w_;for(t=32;t<x_;t++)if(0!==e.dyn_ltree[2*t])return w_;return b_}(e)),lC(e,e.l_desc),lC(e,e.d_desc),a=function(e){var t;for(cC(e,e.dyn_ltree,e.l_desc.max_code),cC(e,e.dyn_dtree,e.d_desc.max_code),lC(e,e.bl_desc),t=O_-1;t>=3&&0===e.bl_tree[2*L_[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==t?fC(e,t,r,n):4===e.strategy||o===i?(Q_(e,2+(n?1:0),3),sC(e,$_,B_)):(Q_(e,4+(n?1:0),3),function(e,t,r,n){var i;for(Q_(e,t-257,5),Q_(e,r-1,5),Q_(e,n-4,4),i=0;i<n;i++)Q_(e,e.bl_tree[2*L_[i]+1],3);uC(e,e.dyn_ltree,t-1),uC(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),sC(e,e.dyn_ltree,e.dyn_dtree)),nC(e),n&&iC(e)},g_._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(U_[r]+x_+1)]++,e.dyn_dtree[2*Z_(t)]++),e.last_lit===e.lit_bufsize-1},g_._tr_align=function(e){Q_(e,2,3),eC(e,N_,$_),function(e){16===e.bi_valid?(J_(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)};var pC=function(e,t,r,n){for(var i=65535&e|0,o=e>>>16&65535|0,a=0;0!==r;){r-=a=r>2e3?2e3:r;do{o=o+(i=i+t[n++]|0)|0}while(--a);i%=65521,o%=65521}return i|o<<16|0};var hC=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();var mC,vC=function(e,t,r,n){var i=hC,o=n+r;e^=-1;for(var a=n;a<o;a++)e=e>>>8^i[255&(e^t[a])];return-1^e},gC={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},yC=h_,bC=g_,wC=pC,_C=vC,CC=gC,EC=0,xC=4,SC=0,kC=-2,OC=-1,IC=4,RC=2,TC=8,AC=9,NC=286,MC=30,PC=19,jC=2*NC+1,DC=15,FC=3,VC=258,LC=VC+FC+1,$C=42,BC=103,zC=113,UC=666,HC=1,WC=2,GC=3,KC=4;function qC(e,t){return e.msg=CC[t],t}function YC(e){return(e<<1)-(e>4?9:0)}function XC(e){for(var t=e.length;--t>=0;)e[t]=0}function ZC(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(yC.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function JC(e,t){bC._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ZC(e.strm)}function QC(e,t){e.pending_buf[e.pending++]=t}function eE(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function tE(e,t,r,n){var i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,yC.arraySet(t,e.input,e.next_in,i,r),1===e.state.wrap?e.adler=wC(e.adler,t,i,r):2===e.state.wrap&&(e.adler=_C(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)}function rE(e,t){var r,n,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-LC?e.strstart-(e.w_size-LC):0,c=e.window,u=e.w_mask,d=e.prev,f=e.strstart+VC,p=c[o+a-1],h=c[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(r=t)+a]===h&&c[r+a-1]===p&&c[r]===c[o]&&c[++r]===c[o+1]){o+=2,r++;do{}while(c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&o<f);if(n=VC-(f-o),o=f-VC,n>a){if(e.match_start=t,a=n,n>=s)break;p=c[o+a-1],h=c[o+a]}}}while((t=d[t&u])>l&&0!=--i);return a<=e.lookahead?a:e.lookahead}function nE(e){var t,r,n,i,o,a=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=a+(a-LC)){yC.arraySet(e.window,e.window,a,a,0),e.match_start-=a,e.strstart-=a,e.block_start-=a,t=r=e.hash_size;do{n=e.head[--t],e.head[t]=n>=a?n-a:0}while(--r);t=r=a;do{n=e.prev[--t],e.prev[t]=n>=a?n-a:0}while(--r);i+=a}if(0===e.strm.avail_in)break;if(r=tE(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=r,e.lookahead+e.insert>=FC)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+FC-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<FC)););}while(e.lookahead<LC&&0!==e.strm.avail_in)}function iE(e,t){for(var r,n;;){if(e.lookahead<LC){if(nE(e),e.lookahead<LC&&t===EC)return HC;if(0===e.lookahead)break}if(r=0,e.lookahead>=FC&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+FC-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-LC&&(e.match_length=rE(e,r)),e.match_length>=FC)if(n=bC._tr_tally(e,e.strstart-e.match_start,e.match_length-FC),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=FC){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+FC-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=bC._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(JC(e,!1),0===e.strm.avail_out))return HC}return e.insert=e.strstart<FC-1?e.strstart:FC-1,t===xC?(JC(e,!0),0===e.strm.avail_out?GC:KC):e.last_lit&&(JC(e,!1),0===e.strm.avail_out)?HC:WC}function oE(e,t){for(var r,n,i;;){if(e.lookahead<LC){if(nE(e),e.lookahead<LC&&t===EC)return HC;if(0===e.lookahead)break}if(r=0,e.lookahead>=FC&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+FC-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=FC-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-LC&&(e.match_length=rE(e,r),e.match_length<=5&&(1===e.strategy||e.match_length===FC&&e.strstart-e.match_start>4096)&&(e.match_length=FC-1)),e.prev_length>=FC&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-FC,n=bC._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-FC),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+FC-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=FC-1,e.strstart++,n&&(JC(e,!1),0===e.strm.avail_out))return HC}else if(e.match_available){if((n=bC._tr_tally(e,0,e.window[e.strstart-1]))&&JC(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return HC}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=bC._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<FC-1?e.strstart:FC-1,t===xC?(JC(e,!0),0===e.strm.avail_out?GC:KC):e.last_lit&&(JC(e,!1),0===e.strm.avail_out)?HC:WC}function aE(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function sE(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=TC,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new yC.Buf16(2*jC),this.dyn_dtree=new yC.Buf16(2*(2*MC+1)),this.bl_tree=new yC.Buf16(2*(2*PC+1)),XC(this.dyn_ltree),XC(this.dyn_dtree),XC(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new yC.Buf16(DC+1),this.heap=new yC.Buf16(2*NC+1),XC(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new yC.Buf16(2*NC+1),XC(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function lE(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=RC,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?$C:zC,e.adler=2===t.wrap?0:1,t.last_flush=EC,bC._tr_init(t),SC):qC(e,kC)}function cE(e){var t=lE(e);return t===SC&&function(e){e.window_size=2*e.w_size,XC(e.head),e.max_lazy_match=mC[e.level].max_lazy,e.good_match=mC[e.level].good_length,e.nice_match=mC[e.level].nice_length,e.max_chain_length=mC[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=FC-1,e.match_available=0,e.ins_h=0}(e.state),t}function uE(e,t,r,n,i,o){if(!e)return kC;var a=1;if(t===OC&&(t=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>AC||r!==TC||n<8||n>15||t<0||t>9||o<0||o>IC)return qC(e,kC);8===n&&(n=9);var s=new sE;return e.state=s,s.strm=e,s.wrap=a,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+FC-1)/FC),s.window=new yC.Buf8(2*s.w_size),s.head=new yC.Buf16(s.hash_size),s.prev=new yC.Buf16(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new yC.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=o,s.method=r,cE(e)}mC=[new aE(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(nE(e),0===e.lookahead&&t===EC)return HC;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,JC(e,!1),0===e.strm.avail_out)||e.strstart-e.block_start>=e.w_size-LC&&(JC(e,!1),0===e.strm.avail_out))return HC}return e.insert=0,t===xC?(JC(e,!0),0===e.strm.avail_out?GC:KC):(e.strstart>e.block_start&&(JC(e,!1),e.strm.avail_out),HC)})),new aE(4,4,8,4,iE),new aE(4,5,16,8,iE),new aE(4,6,32,32,iE),new aE(4,4,16,16,oE),new aE(8,16,32,32,oE),new aE(8,16,128,128,oE),new aE(8,32,128,256,oE),new aE(32,128,258,1024,oE),new aE(32,258,258,4096,oE)],v_.deflateInit=function(e,t){return uE(e,t,TC,15,8,0)},v_.deflateInit2=uE,v_.deflateReset=cE,v_.deflateResetKeep=lE,v_.deflateSetHeader=function(e,t){return e&&e.state&&2===e.state.wrap?(e.state.gzhead=t,SC):kC},v_.deflate=function(e,t){var r,n,i,o;if(!e||!e.state||t>5||t<0)return e?qC(e,kC):kC;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||n.status===UC&&t!==xC)return qC(e,0===e.avail_out?-5:kC);if(n.strm=e,r=n.last_flush,n.last_flush=t,n.status===$C)if(2===n.wrap)e.adler=0,QC(n,31),QC(n,139),QC(n,8),n.gzhead?(QC(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),QC(n,255&n.gzhead.time),QC(n,n.gzhead.time>>8&255),QC(n,n.gzhead.time>>16&255),QC(n,n.gzhead.time>>24&255),QC(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),QC(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(QC(n,255&n.gzhead.extra.length),QC(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=_C(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(QC(n,0),QC(n,0),QC(n,0),QC(n,0),QC(n,0),QC(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),QC(n,3),n.status=zC);else{var a=TC+(n.w_bits-8<<4)<<8;a|=(n.strategy>=2||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(a|=32),a+=31-a%31,n.status=zC,eE(n,a),0!==n.strstart&&(eE(n,e.adler>>>16),eE(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(e.adler=_C(e.adler,n.pending_buf,n.pending-i,i)),ZC(e),i=n.pending,n.pending!==n.pending_buf_size));)QC(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(e.adler=_C(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=_C(e.adler,n.pending_buf,n.pending-i,i)),ZC(e),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,QC(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>i&&(e.adler=_C(e.adler,n.pending_buf,n.pending-i,i)),0===o&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=_C(e.adler,n.pending_buf,n.pending-i,i)),ZC(e),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,QC(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>i&&(e.adler=_C(e.adler,n.pending_buf,n.pending-i,i)),0===o&&(n.status=BC)}else n.status=BC;if(n.status===BC&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&ZC(e),n.pending+2<=n.pending_buf_size&&(QC(n,255&e.adler),QC(n,e.adler>>8&255),e.adler=0,n.status=zC)):n.status=zC),0!==n.pending){if(ZC(e),0===e.avail_out)return n.last_flush=-1,SC}else if(0===e.avail_in&&YC(t)<=YC(r)&&t!==xC)return qC(e,-5);if(n.status===UC&&0!==e.avail_in)return qC(e,-5);if(0!==e.avail_in||0!==n.lookahead||t!==EC&&n.status!==UC){var s=2===n.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(nE(e),0===e.lookahead)){if(t===EC)return HC;break}if(e.match_length=0,r=bC._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(JC(e,!1),0===e.strm.avail_out))return HC}return e.insert=0,t===xC?(JC(e,!0),0===e.strm.avail_out?GC:KC):e.last_lit&&(JC(e,!1),0===e.strm.avail_out)?HC:WC}(n,t):3===n.strategy?function(e,t){for(var r,n,i,o,a=e.window;;){if(e.lookahead<=VC){if(nE(e),e.lookahead<=VC&&t===EC)return HC;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=FC&&e.strstart>0&&(n=a[i=e.strstart-1])===a[++i]&&n===a[++i]&&n===a[++i]){o=e.strstart+VC;do{}while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);e.match_length=VC-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=FC?(r=bC._tr_tally(e,1,e.match_length-FC),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=bC._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(JC(e,!1),0===e.strm.avail_out))return HC}return e.insert=0,t===xC?(JC(e,!0),0===e.strm.avail_out?GC:KC):e.last_lit&&(JC(e,!1),0===e.strm.avail_out)?HC:WC}(n,t):mC[n.level].func(n,t);if((s===GC||s===KC)&&(n.status=UC),s===HC||s===GC)return 0===e.avail_out&&(n.last_flush=-1),SC;if(s===WC&&(1===t?bC._tr_align(n):5!==t&&(bC._tr_stored_block(n,0,0,!1),3===t&&(XC(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),ZC(e),0===e.avail_out))return n.last_flush=-1,SC}return t!==xC?SC:n.wrap<=0?1:(2===n.wrap?(QC(n,255&e.adler),QC(n,e.adler>>8&255),QC(n,e.adler>>16&255),QC(n,e.adler>>24&255),QC(n,255&e.total_in),QC(n,e.total_in>>8&255),QC(n,e.total_in>>16&255),QC(n,e.total_in>>24&255)):(eE(n,e.adler>>>16),eE(n,65535&e.adler)),ZC(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?SC:1)},v_.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==$C&&69!==t&&73!==t&&91!==t&&t!==BC&&t!==zC&&t!==UC?qC(e,kC):(e.state=null,t===zC?qC(e,-3):SC):kC},v_.deflateSetDictionary=function(e,t){var r,n,i,o,a,s,l,c,u=t.length;if(!e||!e.state||(2===(o=(r=e.state).wrap)||1===o&&r.status!==$C||r.lookahead))return kC;for(1===o&&(e.adler=wC(e.adler,t,u,0)),r.wrap=0,u>=r.w_size&&(0===o&&(XC(r.head),r.strstart=0,r.block_start=0,r.insert=0),c=new yC.Buf8(r.w_size),yC.arraySet(c,t,u-r.w_size,r.w_size,0),t=c,u=r.w_size),a=e.avail_in,s=e.next_in,l=e.input,e.avail_in=u,e.next_in=0,e.input=t,nE(r);r.lookahead>=FC;){n=r.strstart,i=r.lookahead-(FC-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+FC-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--i);r.strstart=n,r.lookahead=FC-1,nE(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=FC-1,r.match_available=0,e.next_in=s,e.input=l,e.avail_in=a,r.wrap=o,SC},v_.deflateInfo="pako deflate (from Nodeca project)";var dE={},fE=h_,pE=!0,hE=!0;try{String.fromCharCode.apply(null,[0])}catch{pE=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{hE=!1}for(var mE=new fE.Buf8(256),vE=0;vE<256;vE++)mE[vE]=vE>=252?6:vE>=248?5:vE>=240?4:vE>=224?3:vE>=192?2:1;function gE(e,t){if(t<65534&&(e.subarray&&hE||!e.subarray&&pE))return String.fromCharCode.apply(null,fE.shrinkBuf(e,t));for(var r="",n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r}mE[254]=mE[254]=1,dE.string2buf=function(e){var t,r,n,i,o,a=e.length,s=0;for(i=0;i<a;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&(56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++)),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new fE.Buf8(s),o=0,i=0;o<s;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&(56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|63&r):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|63&r):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|63&r);return t},dE.buf2binstring=function(e){return gE(e,e.length)},dE.binstring2buf=function(e){for(var t=new fE.Buf8(e.length),r=0,n=t.length;r<n;r++)t[r]=e.charCodeAt(r);return t},dE.buf2string=function(e,t){var r,n,i,o,a=t||e.length,s=new Array(2*a);for(n=0,r=0;r<a;)if((i=e[r++])<128)s[n++]=i;else if((o=mE[i])>4)s[n++]=65533,r+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&r<a;)i=i<<6|63&e[r++],o--;o>1?s[n++]=65533:i<65536?s[n++]=i:(i-=65536,s[n++]=55296|i>>10&1023,s[n++]=56320|1023&i)}return gE(s,n)},dE.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+mE[e[r]]>t?r:t};var yE=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},bE=v_,wE=h_,_E=dE,CE=gC,EE=yE,xE=Object.prototype.toString,SE=0,kE=-1,OE=0,IE=8;function RE(e){if(!(this instanceof RE))return new RE(e);this.options=wE.assign({level:kE,method:IE,chunkSize:16384,windowBits:15,memLevel:8,strategy:OE,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new EE,this.strm.avail_out=0;var r=bE.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==SE)throw new Error(CE[r]);if(t.header&&bE.deflateSetHeader(this.strm,t.header),t.dictionary){var n;if(n="string"==typeof t.dictionary?_E.string2buf(t.dictionary):"[object ArrayBuffer]"===xE.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=bE.deflateSetDictionary(this.strm,n))!==SE)throw new Error(CE[r]);this._dict_set=!0}}function TE(e,t){var r=new RE(t);if(r.push(e,!0),r.err)throw r.msg||CE[r.err];return r.result}RE.prototype.push=function(e,t){var r,n,i=this.strm,o=this.options.chunkSize;if(this.ended)return!1;n=t===~~t?t:!0===t?4:0,"string"==typeof e?i.input=_E.string2buf(e):"[object ArrayBuffer]"===xE.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new wE.Buf8(o),i.next_out=0,i.avail_out=o),1!==(r=bE.deflate(i,n))&&r!==SE)return this.onEnd(r),this.ended=!0,!1;(0===i.avail_out||0===i.avail_in&&(4===n||2===n))&&("string"===this.options.to?this.onData(_E.buf2binstring(wE.shrinkBuf(i.output,i.next_out))):this.onData(wE.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||0===i.avail_out)&&1!==r);return 4===n?(r=bE.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===SE):(2===n&&(this.onEnd(SE),i.avail_out=0),!0)},RE.prototype.onData=function(e){this.chunks.push(e)},RE.prototype.onEnd=function(e){e===SE&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=wE.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},m_.Deflate=RE,m_.deflate=TE,m_.deflateRaw=function(e,t){return(t=t||{}).raw=!0,TE(e,t)},m_.gzip=function(e,t){return(t=t||{}).gzip=!0,TE(e,t)};var AE={},NE={},ME=h_,PE=15,jE=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],DE=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],FE=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],VE=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],LE=h_,$E=pC,BE=vC,zE=function(e,t){var r,n,i,o,a,s,l,c,u,d,f,p,h,m,v,g,y,b,w,_,C,E,x,S,k;r=e.state,n=e.next_in,S=e.input,i=n+(e.avail_in-5),o=e.next_out,k=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=r.dmax,c=r.wsize,u=r.whave,d=r.wnext,f=r.window,p=r.hold,h=r.bits,m=r.lencode,v=r.distcode,g=(1<<r.lenbits)-1,y=(1<<r.distbits)-1;e:do{h<15&&(p+=S[n++]<<h,h+=8,p+=S[n++]<<h,h+=8),b=m[p&g];t:for(;;){if(p>>>=w=b>>>24,h-=w,0===(w=b>>>16&255))k[o++]=65535&b;else{if(!(16&w)){if(0==(64&w)){b=m[(65535&b)+(p&(1<<w)-1)];continue t}if(32&w){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}_=65535&b,(w&=15)&&(h<w&&(p+=S[n++]<<h,h+=8),_+=p&(1<<w)-1,p>>>=w,h-=w),h<15&&(p+=S[n++]<<h,h+=8,p+=S[n++]<<h,h+=8),b=v[p&y];r:for(;;){if(p>>>=w=b>>>24,h-=w,!(16&(w=b>>>16&255))){if(0==(64&w)){b=v[(65535&b)+(p&(1<<w)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(C=65535&b,h<(w&=15)&&(p+=S[n++]<<h,(h+=8)<w&&(p+=S[n++]<<h,h+=8)),(C+=p&(1<<w)-1)>l){e.msg="invalid distance too far back",r.mode=30;break e}if(p>>>=w,h-=w,C>(w=o-a)){if((w=C-w)>u&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(E=0,x=f,0===d){if(E+=c-w,w<_){_-=w;do{k[o++]=f[E++]}while(--w);E=o-C,x=k}}else if(d<w){if(E+=c+d-w,(w-=d)<_){_-=w;do{k[o++]=f[E++]}while(--w);if(E=0,d<_){_-=w=d;do{k[o++]=f[E++]}while(--w);E=o-C,x=k}}}else if(E+=d-w,w<_){_-=w;do{k[o++]=f[E++]}while(--w);E=o-C,x=k}for(;_>2;)k[o++]=x[E++],k[o++]=x[E++],k[o++]=x[E++],_-=3;_&&(k[o++]=x[E++],_>1&&(k[o++]=x[E++]))}else{E=o-C;do{k[o++]=k[E++],k[o++]=k[E++],k[o++]=k[E++],_-=3}while(_>2);_&&(k[o++]=k[E++],_>1&&(k[o++]=k[E++]))}break}}break}}while(n<i&&o<s);n-=_=h>>3,p&=(1<<(h-=_<<3))-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=o<s?s-o+257:257-(o-s),r.hold=p,r.bits=h},UE=function(e,t,r,n,i,o,a,s){var l,c,u,d,f,p,h,m,v,g=s.bits,y=0,b=0,w=0,_=0,C=0,E=0,x=0,S=0,k=0,O=0,I=null,R=0,T=new ME.Buf16(16),A=new ME.Buf16(16),N=null,M=0;for(y=0;y<=PE;y++)T[y]=0;for(b=0;b<n;b++)T[t[r+b]]++;for(C=g,_=PE;_>=1&&0===T[_];_--);if(C>_&&(C=_),0===_)return i[o++]=20971520,i[o++]=20971520,s.bits=1,0;for(w=1;w<_&&0===T[w];w++);for(C<w&&(C=w),S=1,y=1;y<=PE;y++)if(S<<=1,(S-=T[y])<0)return-1;if(S>0&&(0===e||1!==_))return-1;for(A[1]=0,y=1;y<PE;y++)A[y+1]=A[y]+T[y];for(b=0;b<n;b++)0!==t[r+b]&&(a[A[t[r+b]]++]=b);if(0===e?(I=N=a,p=19):1===e?(I=jE,R-=257,N=DE,M-=257,p=256):(I=FE,N=VE,p=-1),O=0,b=0,y=w,f=o,E=C,x=0,u=-1,d=(k=1<<C)-1,1===e&&k>852||2===e&&k>592)return 1;for(;;){h=y-x,a[b]<p?(m=0,v=a[b]):a[b]>p?(m=N[M+a[b]],v=I[R+a[b]]):(m=96,v=0),l=1<<y-x,w=c=1<<E;do{i[f+(O>>x)+(c-=l)]=h<<24|m<<16|v|0}while(0!==c);for(l=1<<y-1;O&l;)l>>=1;if(0!==l?(O&=l-1,O+=l):O=0,b++,0==--T[y]){if(y===_)break;y=t[r+a[b]]}if(y>C&&(O&d)!==u){for(0===x&&(x=C),f+=w,S=1<<(E=y-x);E+x<_&&!((S-=T[E+x])<=0);)E++,S<<=1;if(k+=1<<E,1===e&&k>852||2===e&&k>592)return 1;i[u=O&d]=C<<24|E<<16|f-o|0}}return 0!==O&&(i[f+O]=y-x<<24|64<<16|0),s.bits=C,0},HE=1,WE=2,GE=0,KE=-2,qE=1,YE=12,XE=30,ZE=852,JE=592;function QE(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function ex(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new LE.Buf16(320),this.work=new LE.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function tx(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=qE,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new LE.Buf32(ZE),t.distcode=t.distdyn=new LE.Buf32(JE),t.sane=1,t.back=-1,GE):KE}function rx(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,tx(e)):KE}function nx(e,t){var r,n;return!e||!e.state||(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15))?KE:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,rx(e))}function ix(e,t){var r,n;return e?(n=new ex,e.state=n,n.window=null,(r=nx(e,t))!==GE&&(e.state=null),r):KE}var ox,ax,sx=!0;function lx(e){if(sx){var t;for(ox=new LE.Buf32(512),ax=new LE.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(UE(HE,e.lens,0,288,ox,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;UE(WE,e.lens,0,32,ax,0,e.work,{bits:5}),sx=!1}e.lencode=ox,e.lenbits=9,e.distcode=ax,e.distbits=5}function cx(e,t,r,n){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new LE.Buf8(o.wsize)),n>=o.wsize?(LE.arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((i=o.wsize-o.wnext)>n&&(i=n),LE.arraySet(o.window,t,r-n,i,o.wnext),(n-=i)?(LE.arraySet(o.window,t,r-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}NE.inflateReset=rx,NE.inflateReset2=nx,NE.inflateResetKeep=tx,NE.inflateInit=function(e){return ix(e,15)},NE.inflateInit2=ix,NE.inflate=function(e,t){var r,n,i,o,a,s,l,c,u,d,f,p,h,m,v,g,y,b,w,_,C,E,x,S,k=0,O=new LE.Buf8(4),I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return KE;(r=e.state).mode===YE&&(r.mode=13),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,d=s,f=l,E=GE;e:for(;;)switch(r.mode){case qE:if(0===r.wrap){r.mode=13;break}for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(2&r.wrap&&35615===c){r.check=0,O[0]=255&c,O[1]=c>>>8&255,r.check=BE(r.check,O,2,0),c=0,u=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=XE;break}if(8!=(15&c)){e.msg="unknown compression method",r.mode=XE;break}if(u-=4,C=8+(15&(c>>>=4)),0===r.wbits)r.wbits=C;else if(C>r.wbits){e.msg="invalid window size",r.mode=XE;break}r.dmax=1<<C,e.adler=r.check=1,r.mode=512&c?10:YE,c=0,u=0;break;case 2:for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(r.flags=c,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=XE;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=XE;break}r.head&&(r.head.text=c>>8&1),512&r.flags&&(O[0]=255&c,O[1]=c>>>8&255,r.check=BE(r.check,O,2,0)),c=0,u=0,r.mode=3;case 3:for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.head&&(r.head.time=c),512&r.flags&&(O[0]=255&c,O[1]=c>>>8&255,O[2]=c>>>16&255,O[3]=c>>>24&255,r.check=BE(r.check,O,4,0)),c=0,u=0,r.mode=4;case 4:for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.head&&(r.head.xflags=255&c,r.head.os=c>>8),512&r.flags&&(O[0]=255&c,O[1]=c>>>8&255,r.check=BE(r.check,O,2,0)),c=0,u=0,r.mode=5;case 5:if(1024&r.flags){for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.length=c,r.head&&(r.head.extra_len=c),512&r.flags&&(O[0]=255&c,O[1]=c>>>8&255,r.check=BE(r.check,O,2,0)),c=0,u=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((p=r.length)>s&&(p=s),p&&(r.head&&(C=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),LE.arraySet(r.head.extra,n,o,p,C)),512&r.flags&&(r.check=BE(r.check,n,p,o)),s-=p,o+=p,r.length-=p),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===s)break e;p=0;do{C=n[o+p++],r.head&&C&&r.length<65536&&(r.head.name+=String.fromCharCode(C))}while(C&&p<s);if(512&r.flags&&(r.check=BE(r.check,n,p,o)),s-=p,o+=p,C)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===s)break e;p=0;do{C=n[o+p++],r.head&&C&&r.length<65536&&(r.head.comment+=String.fromCharCode(C))}while(C&&p<s);if(512&r.flags&&(r.check=BE(r.check,n,p,o)),s-=p,o+=p,C)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(c!==(65535&r.check)){e.msg="header crc mismatch",r.mode=XE;break}c=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=YE;break;case 10:for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}e.adler=r.check=QE(c),c=0,u=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,2;e.adler=r.check=1,r.mode=YE;case YE:if(5===t||6===t)break e;case 13:if(r.last){c>>>=7&u,u-=7&u,r.mode=27;break}for(;u<3;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}switch(r.last=1&c,u-=1,3&(c>>>=1)){case 0:r.mode=14;break;case 1:if(lx(r),r.mode=20,6===t){c>>>=2,u-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=XE}c>>>=2,u-=2;break;case 14:for(c>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=XE;break}if(r.length=65535&c,c=0,u=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(p=r.length){if(p>s&&(p=s),p>l&&(p=l),0===p)break e;LE.arraySet(i,n,o,p,a),s-=p,o+=p,l-=p,a+=p,r.length-=p;break}r.mode=YE;break;case 17:for(;u<14;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(r.nlen=257+(31&c),c>>>=5,u-=5,r.ndist=1+(31&c),c>>>=5,u-=5,r.ncode=4+(15&c),c>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=XE;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;u<3;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.lens[I[r.have++]]=7&c,c>>>=3,u-=3}for(;r.have<19;)r.lens[I[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,x={bits:r.lenbits},E=UE(0,r.lens,0,19,r.lencode,0,r.work,x),r.lenbits=x.bits,E){e.msg="invalid code lengths set",r.mode=XE;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;g=(k=r.lencode[c&(1<<r.lenbits)-1])>>>16&255,y=65535&k,!((v=k>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(y<16)c>>>=v,u-=v,r.lens[r.have++]=y;else{if(16===y){for(S=v+2;u<S;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(c>>>=v,u-=v,0===r.have){e.msg="invalid bit length repeat",r.mode=XE;break}C=r.lens[r.have-1],p=3+(3&c),c>>>=2,u-=2}else if(17===y){for(S=v+3;u<S;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}u-=v,C=0,p=3+(7&(c>>>=v)),c>>>=3,u-=3}else{for(S=v+7;u<S;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}u-=v,C=0,p=11+(127&(c>>>=v)),c>>>=7,u-=7}if(r.have+p>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=XE;break}for(;p--;)r.lens[r.have++]=C}}if(r.mode===XE)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=XE;break}if(r.lenbits=9,x={bits:r.lenbits},E=UE(HE,r.lens,0,r.nlen,r.lencode,0,r.work,x),r.lenbits=x.bits,E){e.msg="invalid literal/lengths set",r.mode=XE;break}if(r.distbits=6,r.distcode=r.distdyn,x={bits:r.distbits},E=UE(WE,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,x),r.distbits=x.bits,E){e.msg="invalid distances set",r.mode=XE;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(s>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,zE(e,f),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,r.mode===YE&&(r.back=-1);break}for(r.back=0;g=(k=r.lencode[c&(1<<r.lenbits)-1])>>>16&255,y=65535&k,!((v=k>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(g&&0==(240&g)){for(b=v,w=g,_=y;g=(k=r.lencode[_+((c&(1<<b+w)-1)>>b)])>>>16&255,y=65535&k,!(b+(v=k>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}c>>>=b,u-=b,r.back+=b}if(c>>>=v,u-=v,r.back+=v,r.length=y,0===g){r.mode=26;break}if(32&g){r.back=-1,r.mode=YE;break}if(64&g){e.msg="invalid literal/length code",r.mode=XE;break}r.extra=15&g,r.mode=22;case 22:if(r.extra){for(S=r.extra;u<S;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;g=(k=r.distcode[c&(1<<r.distbits)-1])>>>16&255,y=65535&k,!((v=k>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(0==(240&g)){for(b=v,w=g,_=y;g=(k=r.distcode[_+((c&(1<<b+w)-1)>>b)])>>>16&255,y=65535&k,!(b+(v=k>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}c>>>=b,u-=b,r.back+=b}if(c>>>=v,u-=v,r.back+=v,64&g){e.msg="invalid distance code",r.mode=XE;break}r.offset=y,r.extra=15&g,r.mode=24;case 24:if(r.extra){for(S=r.extra;u<S;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=XE;break}r.mode=25;case 25:if(0===l)break e;if(p=f-l,r.offset>p){if((p=r.offset-p)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=XE;break}p>r.wnext?(p-=r.wnext,h=r.wsize-p):h=r.wnext-p,p>r.length&&(p=r.length),m=r.window}else m=i,h=a-r.offset,p=r.length;p>l&&(p=l),l-=p,r.length-=p;do{i[a++]=m[h++]}while(--p);0===r.length&&(r.mode=21);break;case 26:if(0===l)break e;i[a++]=r.length,l--,r.mode=21;break;case 27:if(r.wrap){for(;u<32;){if(0===s)break e;s--,c|=n[o++]<<u,u+=8}if(f-=l,e.total_out+=f,r.total+=f,f&&(e.adler=r.check=r.flags?BE(r.check,i,f,a-f):$E(r.check,i,f,a-f)),f=l,(r.flags?c:QE(c))!==r.check){e.msg="incorrect data check",r.mode=XE;break}c=0,u=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(c!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=XE;break}c=0,u=0}r.mode=29;case 29:E=1;break e;case XE:E=-3;break e;case 31:return-4;default:return KE}return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,(r.wsize||f!==e.avail_out&&r.mode<XE&&(r.mode<27||4!==t))&&cx(e,e.output,e.next_out,f-e.avail_out),d-=e.avail_in,f-=e.avail_out,e.total_in+=d,e.total_out+=f,r.total+=f,r.wrap&&f&&(e.adler=r.check=r.flags?BE(r.check,i,f,e.next_out-f):$E(r.check,i,f,e.next_out-f)),e.data_type=r.bits+(r.last?64:0)+(r.mode===YE?128:0)+(20===r.mode||15===r.mode?256:0),(0===d&&0===f||4===t)&&E===GE&&(E=-5),E},NE.inflateEnd=function(e){if(!e||!e.state)return KE;var t=e.state;return t.window&&(t.window=null),e.state=null,GE},NE.inflateGetHeader=function(e,t){var r;return e&&e.state&&0!=(2&(r=e.state).wrap)?(r.head=t,t.done=!1,GE):KE},NE.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state&&(0===(r=e.state).wrap||11===r.mode)?11===r.mode&&$E(1,t,n,0)!==r.check?-3:cx(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,GE):KE},NE.inflateInfo="pako inflate (from Nodeca project)";var ux={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};var dx=NE,fx=h_,px=dE,hx=ux,mx=gC,vx=yE,gx=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},yx=Object.prototype.toString;function bx(e){if(!(this instanceof bx))return new bx(e);this.options=fx.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new vx,this.strm.avail_out=0;var r=dx.inflateInit2(this.strm,t.windowBits);if(r!==hx.Z_OK)throw new Error(mx[r]);if(this.header=new gx,dx.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=px.string2buf(t.dictionary):"[object ArrayBuffer]"===yx.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=dx.inflateSetDictionary(this.strm,t.dictionary))!==hx.Z_OK))throw new Error(mx[r])}function wx(e,t){var r=new bx(t);if(r.push(e,!0),r.err)throw r.msg||mx[r.err];return r.result}bx.prototype.push=function(e,t){var r,n,i,o,a,s=this.strm,l=this.options.chunkSize,c=this.options.dictionary,u=!1;if(this.ended)return!1;n=t===~~t?t:!0===t?hx.Z_FINISH:hx.Z_NO_FLUSH,"string"==typeof e?s.input=px.binstring2buf(e):"[object ArrayBuffer]"===yx.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new fx.Buf8(l),s.next_out=0,s.avail_out=l),(r=dx.inflate(s,hx.Z_NO_FLUSH))===hx.Z_NEED_DICT&&c&&(r=dx.inflateSetDictionary(this.strm,c)),r===hx.Z_BUF_ERROR&&!0===u&&(r=hx.Z_OK,u=!1),r!==hx.Z_STREAM_END&&r!==hx.Z_OK)return this.onEnd(r),this.ended=!0,!1;s.next_out&&(0===s.avail_out||r===hx.Z_STREAM_END||0===s.avail_in&&(n===hx.Z_FINISH||n===hx.Z_SYNC_FLUSH))&&("string"===this.options.to?(i=px.utf8border(s.output,s.next_out),o=s.next_out-i,a=px.buf2string(s.output,i),s.next_out=o,s.avail_out=l-o,o&&fx.arraySet(s.output,s.output,i,o,0),this.onData(a)):this.onData(fx.shrinkBuf(s.output,s.next_out))),0===s.avail_in&&0===s.avail_out&&(u=!0)}while((s.avail_in>0||0===s.avail_out)&&r!==hx.Z_STREAM_END);return r===hx.Z_STREAM_END&&(n=hx.Z_FINISH),n===hx.Z_FINISH?(r=dx.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===hx.Z_OK):(n===hx.Z_SYNC_FLUSH&&(this.onEnd(hx.Z_OK),s.avail_out=0),!0)},bx.prototype.onData=function(e){this.chunks.push(e)},bx.prototype.onEnd=function(e){e===hx.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=fx.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},AE.Inflate=bx,AE.inflate=wx,AE.inflateRaw=function(e,t){return(t=t||{}).raw=!0,wx(e,t)},AE.ungzip=wx;var _x={};(0,h_.assign)(_x,m_,AE,ux);var Cx=_x;const Ex=Fi.defineToken("ProcessKernelPluginContribution");var xx=Object.defineProperty,Sx=Object.getOwnPropertyDescriptor,kx=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Sx(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&xx(t,r,o),o};let Ox=class{getProvider(){var e;const t=this.processProvider.getContributions()||[],r=t[t.length-1];return null==(e=null==r?void 0:r.registerProcess)?void 0:e.call(r)}getTableMiddlewares(){return(this.processProvider.getContributions()||[]).map((e=>{var t;return null==(t=e.registerProcessTableMiddleware)?void 0:t.call(e)})).filter((e=>!!e))}getUsersMiddlewares(){return(this.processProvider.getContributions()||[]).map((e=>{var t;return null==(t=e.registerProcessUsersMiddleware)?void 0:t.call(e)})).filter((e=>!!e))}getRecordsMiddlewares(){return(this.processProvider.getContributions()||[]).map((e=>{var t;return null==(t=e.registerProcessRecordsMiddleware)?void 0:t.call(e)})).filter((e=>!!e))}};kx([Eo(Ex)],Ox.prototype,"processProvider",2),Ox=kx([eo()],Ox);var Ix=Object.defineProperty,Rx=Object.getOwnPropertyDescriptor,Tx=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Rx(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ix(t,r,o),o};const Ax=Wo.Plugin("process");let Nx=class{toModel(e,t){var r,n;let i;if(i="string"==typeof e?JSON.parse(e):e,Ax("服务端数据",i),i.version){if("string"==typeof i.sheet?i.sheet=JSON.parse(Cx.inflate(i.sheet,{to:"string"}))[0]:i.sheet=null==(r=i.sheet)?void 0:r[0],!i.sheet)return;try{const e=this._processRegistry.getTableMiddlewares();if(e&&e.length>0)for(const r of e)i=r?r(i,t):i}catch(e){Ax("process table error:",e)}const e=i.sheet;Ax("处理前数据",e);let o=e.activeView||e.defaultView;const a=e.views[o];(!a||!(null!=(n=this._configuration.getValue("viewerManage.viewTypes"))&&n.includes(a.type)))&&(o=Object.keys(e.views)[0]),t.setData("table",[{uuid:e.id,version:"1.4",active_view_uuid:o}]),this._columnToModel(t,e.columns),i.records&&("string"==typeof i.records&&(i.records=JSON.parse(Cx.inflate(i.records,{to:"string"}))),this._recordToModel(t,i.records)),i.users&&("string"==typeof i.users&&(i.users=JSON.parse(Cx.inflate(i.users,{to:"string"}))),this._userToModel(t,i.users)),this._viewsToModel(t,e.views,e.columns),Ax("处理后数据",t.getAll())}}toRecordModel(e,t){"string"==typeof e.records&&(e=JSON.parse(Cx.inflate(e,{to:"string"})));try{const r=this._processRegistry.getRecordsMiddlewares();if(r&&r.length>0)for(const n of r)e=n?n({records:e},t).records:e}catch(e){Ax("process records error:",e)}this._recordToModel(t,e)}toUserModel(e,t){try{const r=this._processRegistry.getUsersMiddlewares();if(r&&r.length>0)for(const n of r)e=n?n({users:e},t).users:e}catch(e){Ax("process users error:",e)}this._userToModel(t,e)}_columnToModel(e,t){for(const e of t){if(("input"===e.type||"textarea"===e.type)&&(e.type="text"),e.uuid=e.uuid||e.id,e.options)for(const t of e.options)t.name=t.name||t.value,t.uuid=t.uuid||t.id;Kh.isMultiple(e.type)&&(e.multiple=!0)}t=e.setData("field",t);const r=[];for(const e of t)if(e.options)for(const t of e.options)r.push({uuid:t.uuid,field_uuid:e.uuid,name:t.name,color:t.color});e.setData("field_option",r)}_getField(e,t){const r=e.getData("field").find((e=>e.uuid===t));if(r){if("select"===r.type||"multiSelect"===r.type){const t=e.getData("field_option");r.options=t.filter((e=>e.field_uuid===r.uuid))}return r}}_userToModel(e,t){const r=e.getData("user")||[];for(const e of t){const t=String(e.id||e.uid);r.some((e=>e.uid===t))||r.push({uuid:Io(32),uid:t,login:e.login,name:e.name,icon:e.avatar_url||e.icon,work_id:e.work_id,created_at:new Date,updated_at:new Date})}e.setData("user",r)}_recordToModel(e,t){var r;const n=e.getData("record")||[],i=[];for(const o of t){if(n.push({id:o.id,uuid:o.uuid,creator_id:o.user_id,modifier_id:o.modifier_id,created_at:o.created_at,updated_at:o.updated_at}),!o.data)continue;const t=JSON.parse(o.data);for(const n of Object.keys(t)){const a=this._getField(e,n);if(!a)continue;const s=a.type,l=t[n],c=null==(r=this._processRegistry.getProvider())?void 0:r.processFieldModel;let u;if(u=c?c(a,l.value):null==l?void 0:l.value,null!=u){if(Kh.isUri(s)){if(!u)continue;u&&"string"==typeof u&&(u={src:u,name:u})}if(Array.isArray(u)){for(const e of u)Kh.isMention(s)&&(e.uid=e.id,e.icon=e.avatar_url),i.push({fieldType:s,field_uuid:n,record_uuid:o.uuid,value:e});continue}Kh.isDate(s)&&(null!=u.time?u=u.time:null!=u.seconds&&(u=Ad(u.seconds))),i.push({fieldType:s,field_uuid:n,record_uuid:o.uuid,value:u})}}}e.setData("record",n),this._createValues(e,i)}_createValues(e,t){const r={field_boolean:[],field_date:[],field_number:[],field_select:[],field_string:[],field_uri:[],user:{}};t.forEach((e=>{var t,n,i,o,a,s,l;const c=e.fieldType;if(delete e.fieldType,Kh.isBoolean(c))r.field_boolean.push(e);else if(Kh.isDate(c))r.field_date.push(e);else if(Kh.isNumber(c))r.field_number.push(e);else if(Kh.isSelectLike(c))r.field_select.push(e);else if(Kh.isString(c))r.field_string.push(e);else if(Kh.isUri(c)){if(r.field_uri.push({field_uuid:e.field_uuid,record_uuid:e.record_uuid,uid:null==(t=e.value)?void 0:t.uid,src:null==(n=e.value)?void 0:n.src,icon:null==(i=e.value)?void 0:i.icon,name:null==(o=e.value)?void 0:o.name,size:null==(a=e.value)?void 0:a.size,width:null==(s=e.value)?void 0:s.width,height:null==(l=e.value)?void 0:l.height}),Kh.isMention(c)){if(!e.value)return;r.user[e.value.uid]={uid:String(e.value.uid),name:e.value.name,icon:e.value.icon,login:e.value.login,work_id:e.value.work_id}}}else if(Kh.isSystemUser(c)){if(!e.value)return;r.user[e.value.id]={uid:String(e.value.id),name:e.value.name,icon:e.value.avatar_url,login:e.value.login,work_id:e.value.work_id}}})),r.user=Object.values(r.user);const n=Object.keys(r);for(const t of n){if("user"===t){const n=xd([...e.getData("user"),...Object.values(r[t])],"uid");return void e.setData("user",n)}e.setData(t,r[t])}}_viewsToModel(e,t,r){const n=Object.values(t),i=[];for(const t of n)i.push({id:t.iid,uuid:t.id,name:t.name,type:t.type,desc:t.desc}),this._viewToModel(e,t,r);e.setData("view",i)}_viewToModel(e,t,r){var n,i,o,a,s,l,c;const u=e.getData("view_config")||[],d=e.getData("view_field")||[],f=e.getData("view_record")||[],p=e.getData("group")||[],h=e.getData("field_group")||[],m=e.getData("filter")||[],v=e.getData("sort")||[],g=e.getData("stat")||[],y=r.reduce(((e,t)=>(e[t.id]=t,e)),{}),b={};if(u.push({view_uuid:t.id,cover_field_uuid:null!=(n=t.cover)&&n.show?null==(i=t.cover)?void 0:i.id:"",cover_display:null==(o=t.cover)?void 0:o.display,show_field_name:t.showField,keep_sort:null==(a=t.sort)?void 0:a.auto,frozen_field:t.frozenCol,record_height:null==(s=t.rowHeight)?void 0:s.type}),t.columnGroups&&t.columnGroups.length>0)for(const e of t.columnGroups){const r=Io(32);e.columns.forEach((e=>{b[e.id]=r})),h.push({uuid:r,view_uuid:t.id,name:e.name})}if(t.type===Wh.FORM){if(t.fields)for(const e of t.fields)y[e.columnId]&&d.push({view_uuid:t.id,field_uuid:e.columnId,group_uuid:b[e.id],name:e.title||e.columnName,display_type:e.display,required:(null==(c=null==(l=e.validations)?void 0:l[0])?void 0:c.required)||!1})}else for(const e of t.columns)y[e.id]&&d.push({view_uuid:t.id,field_uuid:e.id,group_uuid:b[e.id],size:e.size,hidden:e.hidden});if(t.rows){const e={};t.group&&t.groupData&&t.groupData.forEach((t=>{t.rows.forEach((r=>{Array.isArray(t.titleValue)?"string"==typeof t.titleValue[0]?e[r]=t.titleValue[0]:e[r]=t.titleValue.map((e=>e.uid)).join(","):e[r]=t.titleValue}))}));for(const r of t.rows){const n={view_uuid:t.id,record_uuid:r.id};if(t.group){const t=e[r.id];n.group_item_key=null!=t&&t.id?String(null==t?void 0:t.id):t}f.push(n)}}if(t.filter&&t.filter.options)for(const e of t.filter.options)!d.some((t=>t.field_uuid===e.id))||m.push({view_uuid:t.id,field_uuid:e.id,operator:t.filter.operator||Vh.And,func:e.func,expected:Array.isArray(e.expected)?e.expected.join(","):e.expected});if(t.group&&t.group.length>0){const e=t.group[0],n=r.find((t=>t.id===e.id));n&&d.some((e=>e.field_uuid===n.id))&&p.push({view_uuid:t.id,field_uuid:n.id,type:e.type})}if(t.sort&&t.sort.options)for(const e of t.sort.options)!d.some((t=>t.field_uuid===e.id))||v.push({view_uuid:t.id,field_uuid:e.id,type:e.type});if(t.stats){const e=Object.keys(t.stats);for(const r of e)g.push({view_uuid:t.id,field_uuid:r,type:t.stats[r]})}e.setData("view_config",u),e.setData("view_field",d),e.setData("view_record",f),e.setData("group",p),e.setData("field_group",h),e.setData("filter",m),e.setData("sort",v),e.setData("stat",g)}toData(e,t){const r=t.getData("record"),n=this._toProcess.toTable();return n.records=r.map((t=>{const r=e.getOriginRecord(t.uuid);return{id:t.id,uuid:t.uuid,user_id:t.creator_id,modifier_id:t.modifier_id,sheet_id:n.sheet[0].id,data:JSON.stringify(this._toProcess.toRecord(r)),updated_at:t.updated_at,created_at:t.created_at}})).filter((e=>!!e)),n}};function Mx(){return _i(new nn(gr,!0))}Tx([to(p_)],Nx.prototype,"_toProcess",2),Tx([to(Ox)],Nx.prototype,"_processRegistry",2),Tx([to(qf)],Nx.prototype,"_configuration",2),Nx=Tx([eo()],Nx);const Px={ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,ENTER:13,TAB:9,BACKSPACE:8,DELETE:46,DEL:46,END:35,SPACE:32};var jx=(e=>(e.ESC="Escape",e.LEFT="ArrowLeft",e.UP="ArrowUp",e.RIGHT="ArrowRight",e.DOWN="ArrowDown",e.ENTER="Enter",e.TAB="Tab",e.SPACE=" ",e.DEL="Backspace",e.BACKSPACE="Backspace",e))(jx||{});function Dx(e,t,r){let n=0;const i=t>0?1:-1;for(;Math.abs(n)<Math.abs(t)&&!1!==r(e+n);)n+=i}const Fx=globalThis;const Vx=function(e,t,r){return()=>null!=e?e.performance.now():null!=t?t.hrtime()[1]/1e6:(new r).getTime()}(Fx.window,Fx.process,Date),Lx=(e,t)=>{const r=(t-e).toFixed(2);return Number(r)},$x={request:{bindings:{activated:!1,cache:!1,constraint:!1,dynamicValue:!1,factory:!1,implementationType:!0,onActivation:!1,provider:!1,scope:!0,serviceIdentifier:!1,type:!0},serviceIdentifier:!0,target:{metadata:!0,name:!0,serviceIdentifier:!0}},time:!0};function Bx(e,t,r){const n={},i=t,o=Vx();if(!0===i.serviceIdentifier&&(n.serviceIdentifier=e.serviceIdentifier),void 0!==i.bindings){const r=e.bindings.map((e=>function(e,t){const r={},n=t,i=e;return["type","serviceIdentifier","implementationType","activated","cache","constraint","dynamicValue","factory","onActivation","provider","scope"].forEach((e=>{n[e]&&(r[e]=i[e])})),r}(e,t.bindings)));n.bindings=r}void 0!==i.target&&null!==e.target&&(n.target=function(e,t){const r={},n=t,i=e;if(n.name&&(r.name=i.name),n.serviceIdentifier&&(r.serviceIdentifier=i.serviceIdentifier),n.metadata&&Array.isArray(e.metadata)){const t=e.metadata.map(((e,t)=>({key:e.key,value:e.value})));r.metadata=t}return r}(e.target,t.target));const a=e.childRequests.map((e=>Bx(e,t,r)));return n.childRequests=a,n.time=Lx(o,Vx()),null!=r&&r(n)&&vf(n),n}function zx(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}var Ux=(e=>(e.ASC="asc",e.DESC="desc",e))(Ux||{}),Hx=(e=>(e.ASC="asc",e.DESC="desc",e))(Hx||{});function Wx(e){return!0===e||!1===e||ka(e)&&"[object Boolean]"==Sa(e)}var Gx=Ds((function(e){var t=Yu(e);return Bu(t)&&(t=void 0),Ed(Wl(e,1,Bu,!0),Nu(t))}));const Kx=Gx;function qx(e){return(qx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Yx=/^\s+/,Xx=/\s+$/;function Zx(e,t){if(t=t||{},(e=e||"")instanceof Zx)return e;if(!(this instanceof Zx))return new Zx(e,t);var r=function(e){var t={r:0,g:0,b:0},r=1,n=null,i=null,o=null,a=!1,s=!1;return"string"==typeof e&&(e=function(e){e=e.replace(Yx,"").replace(Xx,"").toLowerCase();var t,r=!1;if(hS[e])e=hS[e],r=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};return(t=OS.rgb.exec(e))?{r:t[1],g:t[2],b:t[3]}:(t=OS.rgba.exec(e))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=OS.hsl.exec(e))?{h:t[1],s:t[2],l:t[3]}:(t=OS.hsla.exec(e))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=OS.hsv.exec(e))?{h:t[1],s:t[2],v:t[3]}:(t=OS.hsva.exec(e))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=OS.hex8.exec(e))?{r:bS(t[1]),g:bS(t[2]),b:bS(t[3]),a:ES(t[4]),format:r?"name":"hex8"}:(t=OS.hex6.exec(e))?{r:bS(t[1]),g:bS(t[2]),b:bS(t[3]),format:r?"name":"hex"}:(t=OS.hex4.exec(e))?{r:bS(t[1]+""+t[1]),g:bS(t[2]+""+t[2]),b:bS(t[3]+""+t[3]),a:ES(t[4]+""+t[4]),format:r?"name":"hex8"}:!!(t=OS.hex3.exec(e))&&{r:bS(t[1]+""+t[1]),g:bS(t[2]+""+t[2]),b:bS(t[3]+""+t[3]),format:r?"name":"hex"}}(e)),"object"==qx(e)&&(IS(e.r)&&IS(e.g)&&IS(e.b)?(t=function(e,t,r){return{r:255*gS(e,255),g:255*gS(t,255),b:255*gS(r,255)}}(e.r,e.g,e.b),a=!0,s="%"===String(e.r).substr(-1)?"prgb":"rgb"):IS(e.h)&&IS(e.s)&&IS(e.v)?(n=_S(e.s),i=_S(e.v),t=function(e,t,r){e=6*gS(e,360),t=gS(t,100),r=gS(r,100);var n=Math.floor(e),i=e-n,o=r*(1-t),a=r*(1-i*t),s=r*(1-(1-i)*t),l=n%6,c=[r,a,o,o,s,r][l],u=[s,r,r,a,o,o][l],d=[o,o,s,r,r,a][l];return{r:255*c,g:255*u,b:255*d}}(e.h,n,i),a=!0,s="hsv"):IS(e.h)&&IS(e.s)&&IS(e.l)&&(n=_S(e.s),o=_S(e.l),t=function(e,t,r){var n,i,o;function a(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}if(e=gS(e,360),t=gS(t,100),r=gS(r,100),0===t)n=i=o=r;else{var s=r<.5?r*(1+t):r+t-r*t,l=2*r-s;n=a(l,s,e+1/3),i=a(l,s,e),o=a(l,s,e-1/3)}return{r:255*n,g:255*i,b:255*o}}(e.h,n,o),a=!0,s="hsl"),e.hasOwnProperty("a")&&(r=e.a)),r=vS(r),{ok:a,format:e.format||s,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:r}}(e);this._originalInput=e,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=t.format||r.format,this._gradientType=t.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=r.ok}function Jx(e,t,r){e=gS(e,255),t=gS(t,255),r=gS(r,255);var n,i,o=Math.max(e,t,r),a=Math.min(e,t,r),s=(o+a)/2;if(o==a)n=i=0;else{var l=o-a;switch(i=s>.5?l/(2-o-a):l/(o+a),o){case e:n=(t-r)/l+(t<r?6:0);break;case t:n=(r-e)/l+2;break;case r:n=(e-t)/l+4}n/=6}return{h:n,s:i,l:s}}function Qx(e,t,r){e=gS(e,255),t=gS(t,255),r=gS(r,255);var n,i,o=Math.max(e,t,r),a=Math.min(e,t,r),s=o,l=o-a;if(i=0===o?0:l/o,o==a)n=0;else{switch(o){case e:n=(t-r)/l+(t<r?6:0);break;case t:n=(r-e)/l+2;break;case r:n=(e-t)/l+4}n/=6}return{h:n,s:i,v:s}}function eS(e,t,r,n){var i=[wS(Math.round(e).toString(16)),wS(Math.round(t).toString(16)),wS(Math.round(r).toString(16))];return n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function tS(e,t,r,n){return[wS(CS(n)),wS(Math.round(e).toString(16)),wS(Math.round(t).toString(16)),wS(Math.round(r).toString(16))].join("")}function rS(e,t){t=0===t?0:t||10;var r=Zx(e).toHsl();return r.s-=t/100,r.s=yS(r.s),Zx(r)}function nS(e,t){t=0===t?0:t||10;var r=Zx(e).toHsl();return r.s+=t/100,r.s=yS(r.s),Zx(r)}function iS(e){return Zx(e).desaturate(100)}function oS(e,t){t=0===t?0:t||10;var r=Zx(e).toHsl();return r.l+=t/100,r.l=yS(r.l),Zx(r)}function aS(e,t){t=0===t?0:t||10;var r=Zx(e).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(-t/100*255))),r.g=Math.max(0,Math.min(255,r.g-Math.round(-t/100*255))),r.b=Math.max(0,Math.min(255,r.b-Math.round(-t/100*255))),Zx(r)}function sS(e,t){t=0===t?0:t||10;var r=Zx(e).toHsl();return r.l-=t/100,r.l=yS(r.l),Zx(r)}function lS(e,t){var r=Zx(e).toHsl(),n=(r.h+t)%360;return r.h=n<0?360+n:n,Zx(r)}function cS(e){var t=Zx(e).toHsl();return t.h=(t.h+180)%360,Zx(t)}function uS(e,t){if(isNaN(t)||t<=0)throw new Error("Argument to polyad must be a positive number");for(var r=Zx(e).toHsl(),n=[Zx(e)],i=360/t,o=1;o<t;o++)n.push(Zx({h:(r.h+o*i)%360,s:r.s,l:r.l}));return n}function dS(e){var t=Zx(e).toHsl(),r=t.h;return[Zx(e),Zx({h:(r+72)%360,s:t.s,l:t.l}),Zx({h:(r+216)%360,s:t.s,l:t.l})]}function fS(e,t,r){t=t||6,r=r||30;var n=Zx(e).toHsl(),i=360/r,o=[Zx(e)];for(n.h=(n.h-(i*t>>1)+720)%360;--t;)n.h=(n.h+i)%360,o.push(Zx(n));return o}function pS(e,t){t=t||6;for(var r=Zx(e).toHsv(),n=r.h,i=r.s,o=r.v,a=[],s=1/t;t--;)a.push(Zx({h:n,s:i,v:o})),o=(o+s)%1;return a}Zx.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,t,r,n=this.toRgb();return e=n.r/255,t=n.g/255,r=n.b/255,.2126*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.7152*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))},setAlpha:function(e){return this._a=vS(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=Qx(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=Qx(this._r,this._g,this._b),t=Math.round(360*e.h),r=Math.round(100*e.s),n=Math.round(100*e.v);return 1==this._a?"hsv("+t+", "+r+"%, "+n+"%)":"hsva("+t+", "+r+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var e=Jx(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=Jx(this._r,this._g,this._b),t=Math.round(360*e.h),r=Math.round(100*e.s),n=Math.round(100*e.l);return 1==this._a?"hsl("+t+", "+r+"%, "+n+"%)":"hsla("+t+", "+r+"%, "+n+"%, "+this._roundA+")"},toHex:function(e){return eS(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return function(e,t,r,n,i){var o=[wS(Math.round(e).toString(16)),wS(Math.round(t).toString(16)),wS(Math.round(r).toString(16)),wS(CS(n))];return i&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)&&o[3].charAt(0)==o[3].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*gS(this._r,255))+"%",g:Math.round(100*gS(this._g,255))+"%",b:Math.round(100*gS(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Math.round(100*gS(this._r,255))+"%, "+Math.round(100*gS(this._g,255))+"%, "+Math.round(100*gS(this._b,255))+"%)":"rgba("+Math.round(100*gS(this._r,255))+"%, "+Math.round(100*gS(this._g,255))+"%, "+Math.round(100*gS(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(mS[eS(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+tS(this._r,this._g,this._b,this._a),r=t,n=this._gradientType?"GradientType = 1, ":"";if(e){var i=Zx(e);r="#"+tS(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+t+",endColorstr="+r+")"},toString:function(e){var t=!!e;e=e||this._format;var r=!1,n=this._a<1&&this._a>=0;return!t&&n&&("hex"===e||"hex6"===e||"hex3"===e||"hex4"===e||"hex8"===e||"name"===e)?"name"===e&&0===this._a?this.toName():this.toRgbString():("rgb"===e&&(r=this.toRgbString()),"prgb"===e&&(r=this.toPercentageRgbString()),("hex"===e||"hex6"===e)&&(r=this.toHexString()),"hex3"===e&&(r=this.toHexString(!0)),"hex4"===e&&(r=this.toHex8String(!0)),"hex8"===e&&(r=this.toHex8String()),"name"===e&&(r=this.toName()),"hsl"===e&&(r=this.toHslString()),"hsv"===e&&(r=this.toHsvString()),r||this.toHexString())},clone:function(){return Zx(this.toString())},_applyModification:function(e,t){var r=e.apply(null,[this].concat([].slice.call(t)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(oS,arguments)},brighten:function(){return this._applyModification(aS,arguments)},darken:function(){return this._applyModification(sS,arguments)},desaturate:function(){return this._applyModification(rS,arguments)},saturate:function(){return this._applyModification(nS,arguments)},greyscale:function(){return this._applyModification(iS,arguments)},spin:function(){return this._applyModification(lS,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(fS,arguments)},complement:function(){return this._applyCombination(cS,arguments)},monochromatic:function(){return this._applyCombination(pS,arguments)},splitcomplement:function(){return this._applyCombination(dS,arguments)},triad:function(){return this._applyCombination(uS,[3])},tetrad:function(){return this._applyCombination(uS,[4])}},Zx.fromRatio=function(e,t){if("object"==qx(e)){var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]="a"===n?e[n]:_S(e[n]));e=r}return Zx(e,t)},Zx.equals=function(e,t){return!(!e||!t)&&Zx(e).toRgbString()==Zx(t).toRgbString()},Zx.random=function(){return Zx.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},Zx.mix=function(e,t,r){r=0===r?0:r||50;var n=Zx(e).toRgb(),i=Zx(t).toRgb(),o=r/100;return Zx({r:(i.r-n.r)*o+n.r,g:(i.g-n.g)*o+n.g,b:(i.b-n.b)*o+n.b,a:(i.a-n.a)*o+n.a})},Zx.readability=function(e,t){var r=Zx(e),n=Zx(t);return(Math.max(r.getLuminance(),n.getLuminance())+.05)/(Math.min(r.getLuminance(),n.getLuminance())+.05)},Zx.isReadable=function(e,t,r){var n,i,o=Zx.readability(e,t);switch(i=!1,n=function(e){var t,r;return e=e||{level:"AA",size:"small"},t=(e.level||"AA").toUpperCase(),r=(e.size||"small").toLowerCase(),"AA"!==t&&"AAA"!==t&&(t="AA"),"small"!==r&&"large"!==r&&(r="small"),{level:t,size:r}}(r),n.level+n.size){case"AAsmall":case"AAAlarge":i=o>=4.5;break;case"AAlarge":i=o>=3;break;case"AAAsmall":i=o>=7}return i},Zx.mostReadable=function(e,t,r){var n,i,o,a,s=null,l=0;i=(r=r||{}).includeFallbackColors,o=r.level,a=r.size;for(var c=0;c<t.length;c++)(n=Zx.readability(e,t[c]))>l&&(l=n,s=Zx(t[c]));return Zx.isReadable(e,s,{level:o,size:a})||!i?s:(r.includeFallbackColors=!1,Zx.mostReadable(e,["#fff","#000"],r))};var hS=Zx.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},mS=Zx.hexNames=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t}(hS);function vS(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function gS(e,t){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var r=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=Math.min(t,Math.max(0,parseFloat(e))),r&&(e=parseInt(e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function yS(e){return Math.min(1,Math.max(0,e))}function bS(e){return parseInt(e,16)}function wS(e){return 1==e.length?"0"+e:""+e}function _S(e){return e<=1&&(e=100*e+"%"),e}function CS(e){return Math.round(255*parseFloat(e)).toString(16)}function ES(e){return bS(e)/255}var xS,SS,kS,OS=(SS="[\\s|\\(]+("+(xS="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+xS+")[,|\\s]+("+xS+")\\s*\\)?",kS="[\\s|\\(]+("+xS+")[,|\\s]+("+xS+")[,|\\s]+("+xS+")[,|\\s]+("+xS+")\\s*\\)?",{CSS_UNIT:new RegExp(xS),rgb:new RegExp("rgb"+SS),rgba:new RegExp("rgba"+kS),hsl:new RegExp("hsl"+SS),hsla:new RegExp("hsla"+kS),hsv:new RegExp("hsv"+SS),hsva:new RegExp("hsva"+kS),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function IS(e){return!!OS.CSS_UNIT.exec(e)}const RS={...R.themeToken,"@yuque-color-table-bg":"#FAFAFA","@yuque-color-table-darg":"#D8DAD9","@yuque-color-table-temp":"#F9EFCD","@yuque-color-table-header-border":"#E7E9E8"},TS={...R.themeDarkToken,"@yuque-color-table-bg":"#141414","@yuque-color-table-darg":"#404040","@yuque-color-table-header-border":"#373838"};var AS=(e=>(e.default="default",e.dark="dark",e))(AS||{});const NS=Fi.defineToken("ThemeContribution");var MS=Object.defineProperty,PS=Object.getOwnPropertyDescriptor,jS=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?PS(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&MS(t,r,o),o};let DS=class{getProvider(){const e=this.themeProvider.getContributions(),t=e[e.length-1];return null==t?void 0:t.registerTheme()}getThemeManager(){var e;return this._themeManager?this._themeManager:(this._themeManager=null==(e=this.getProvider())?void 0:e.getThemeManager(),this._themeManager||new T.DefaultThemeManager)}};jS([Eo(NS)],DS.prototype,"themeProvider",2),DS=jS([eo()],DS);var FS=Object.defineProperty,VS=Object.getOwnPropertyDescriptor,LS=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?VS(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&FS(t,r,o),o};let $S=class{isCurrentInDarkTheme(){const e=this._themeRegistry.getThemeManager();return(null==e?void 0:e.current)===N.Theme.dark}getCurrentTheme(){const e=this._themeRegistry.getThemeManager();return null==e?void 0:e.current}toThemeColor(e){const t=this._themeRegistry.getThemeManager();if(!e)return e;if(e.toLowerCase().startsWith("@"))return"dark"===(null==t?void 0:t.current)?TS[e]:RS[e];if(e.toLowerCase().startsWith("fade")){const[,t,r]=e.match(/^fade\((.*),(.*)\)$/);return Object(A.fade)(this.toThemeColor(t.trim()),function(e){return e.endsWith("%")?parseFloat(e.replace("%",""))/100:parseFloat(e)}(r.trim()))}return(null==t?void 0:t.transformColor(AS.default,null==t?void 0:t.current,e))||e}transToThemeColor(e){const t=this._themeRegistry.getThemeManager();return e&&t&&t?this.isCurrentInDarkTheme()?t.transformColor(N.Theme.default,N.Theme.dark,e):t.getColor(e,AS.default):e}toNormalColor(e){const t=this._themeRegistry.getThemeManager();return e&&((null==t?void 0:t.transformColor(null==t?void 0:t.current,AS.default,e))||e)}addThemeChangeListener(e){const t=this._themeRegistry.getThemeManager();return null==t?void 0:t.onChange(e)}};LS([to(DS)],$S.prototype,"_themeRegistry",2),$S=LS([eo()],$S);var BS=Object.defineProperty,zS=Object.getOwnPropertyDescriptor,US=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?zS(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&BS(t,r,o),o};const HS={};let WS=class{constructor(){this._themeCache={},this._isColor=e=>e.toLowerCase().startsWith("@")||e.toLowerCase().startsWith("#")||e.toLowerCase().startsWith("rgb(")||e.toLowerCase().startsWith("rgba(")||e.toLowerCase().startsWith("fade(")}_getThemeValue(e){if(this._isColor(e))return this._themeHelper.toThemeColor(e);const t=e.split(".").reduce(((e,t)=>e?e[t]:null),HS);if(null==t)return null;const r=e=>null==e?e:"string"==typeof e&&this._isColor(e)?this._themeHelper.toThemeColor(e):("object"==typeof e&&!Array.isArray(e)&&Object.keys(e).forEach((t=>{e[t]=r(e[t])})),e);return r(t)}getThemeValue(e){let t=e;const r=this._themeRegistry.getThemeManager();if(!t)return null;const n=(null==r?void 0:r.current)||"light";n&&(t=n+"$"+t);const i=this._themeCache[t];if(i)return i;const o=this._getThemeValue(e);return this._themeCache[t]=o,o}getCurrent(){return this._themeHelper.getCurrentTheme()}onChange(e){this._themeRegistry.getThemeManager().onChange(e)}};US([to(DS)],WS.prototype,"_themeRegistry",2),US([to($S)],WS.prototype,"_themeHelper",2),WS=US([eo()],WS);const GS=bo().contribution(NS).register(WS).register(DS).register($S),KS={"#FFA39E":"#FBD3D0","#FFEC3D":"#F7E9BC","#91D5FF":"#C4E4F5","#FFADD2":"#E4F7D2","#FFD591":"#E8D5CB","#87E8DE":"#C0EBE5","#D3ADF7":"#DBCEF5","#FFBB96":"#E8E8E8","#B7EB8F":"#E5EDCA","#ADC6FF":"#C2CDF0"},qS=["#F1A2AB","#F5D480","#C1E77E","#82EDC0","#81DFE4","#81BBF8","#96A7FD","#BA9BF2","#DBC39A","#BEC0BF"],YS=[["$label-back-color:0-0","$label-back-color:0-1","$label-back-color:0-2","$label-back-color:0-3","$label-back-color:0-4"],["$label-back-color:1-0","$label-back-color:1-1","$label-back-color:1-2","$label-back-color:1-3","$label-back-color:1-4"],["$label-back-color:2-0","$label-back-color:2-1","$label-back-color:2-2","$label-back-color:2-3","$label-back-color:2-4"],["$label-back-color:3-0","$label-back-color:3-1","$label-back-color:3-2","$label-back-color:3-3","$label-back-color:3-4"]],XS={labelColor:[["@yuque-green-1","@yellow-1","@blue-1","@yuque-grey-3","@red-1"],["@brown-1","@cyan-1","@purple-1","@pea-green-1","@sea-blue-1"],["@red-3","@yellow-3","@pea-green-3","@yuque-green-3","@cyan-3"],["@blue-3","@sea-blue-3","@purple-3","@brown-3","@yuque-grey-6"]],labelTextColor:[["@yuque-green-9","@yellow-9","@blue-9","@yuque-grey-9","@red-9"],["@brown-9","@cyan-9","@purple-9","@pea-green-9","@sea-blue-9"],["@red-9","@yellow-9","@pea-green-9","@yuque-green-9","@cyan-9"],["@blue-9","@sea-blue-9","@purple-9","@brown-9","@yuque-grey-9"]]},ZS="$label-back-color:";var JS=Object.defineProperty,QS=Object.getOwnPropertyDescriptor,ek=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?QS(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&JS(t,r,o),o};const tk=new Map;let rk=class{static isLabelColorId(e){return Mo(e)&&e.startsWith(ZS)}static getColor(e){return Mo(e)?rk.isLabelColorId(e)?e:KS[e.toUpperCase()]||e:""}static getNextColor(e=""){const t=rk.getColor(e),r=Gl(YS),n=r.indexOf(t);return n>=0?r[(n+1)%r.length]:r[0]}static getIndexesByBackColorId(e){if(e.startsWith(ZS)){const[t,r]=e.split(ZS),[n,i]=r.split("-"),[o,a]=[Number(n),Number(i)];return[o,a]}return[0,0]}getColorByBackColorId(e){const t="@yuque-color-bg-primary";if(!e.startsWith(ZS))return this._themeHelper.transToThemeColor(t);const[r,n]=rk.getIndexesByBackColorId(e),i=XS.labelColor[r][n]||t;return this._themeHelper.transToThemeColor(i)}getTextColorByBackColorId(e){const t="@yuque-color-text-primary";if(!e.startsWith(ZS))return this._themeHelper.transToThemeColor(t);const[r,n]=rk.getIndexesByBackColorId(e),i=XS.labelTextColor[r][n]||t;return this._themeHelper.transToThemeColor(i)}getByIndex(e){const t=Gl(YS);return t[e%t.length]}getRenderColor(e){const t=`labelColor:${this._themeHelper.getCurrentTheme()}:${e}`,r=tk.get(t);if(r)return r;const n=rk.getColor(e);let i="";return i=rk.isLabelColorId(n)?this.getColorByBackColorId(n):this._themeHelper.transToThemeColor(n),tk.set(t,i),i}getRenderTextColor(e){const t=`labelTextColor:${this._themeHelper.getCurrentTheme()}:${e}`,r=tk.get(t);if(r)return r;let n="";return n=e?rk.isLabelColorId(e)?this.getTextColorByBackColorId(e):this._themeHelper.isCurrentInDarkTheme()||(e=>Zx(e).getBrightness()<200)(e)&&!qS.includes(e)?"#fff":"rgba(0,0,0,0.65)":this._themeHelper.transToThemeColor("@yuque-color-text-primary"),tk.set(t,n),n}};ek([to($S)],rk.prototype,"_themeHelper",2),rk=ek([eo()],rk);const nk=bo().register(rk),ik=bo().register(Cf);var ok=Object.defineProperty,ak=Object.getOwnPropertyDescriptor,sk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ak(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ok(t,r,o),o};let lk=class extends nb{get model(){return this._model.fieldSelectModel}get type(){return lk.type}get baseType(){return lk.baseType}_getNewOptionColor(e){return e?e.color?rk.getNextColor(e.color):"":rk.getNextColor()}validate(e){return!!e}transform(e,t){if(t){const r=this._model.fieldOptionModel.find({field_uuid:t});for(const t of r)if(t.name===e||t.uuid===e)return{value:t.uuid};const n=Io(6),i=r[r.length-1],o={uuid:n,field_uuid:t,name:e.slice(0,pm.MAX_LENGTH),color:this._getNewOptionColor(i)};return this._model.fieldOptionModel.create(o),{value:n}}return{value:e}}formatted(e,t){if(!e)return"";if(!t)return nd(e)?e:"";const r=this._getOptionValue(t,e);return(null==r?void 0:r.name)||""}keyValue(e){return e||null}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(r.value,e)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(r.value)}getCell(e,t){const r=this.model.findOne({field_uuid:e,record_uuid:t});let n=null;return r&&(n=r.value),{uuid:null==r?void 0:r.uuid,cellKey:this._getCellKey(e,t,n,null==r?void 0:r.updated_at),cellId:this.getCellId(lk.type,e,t),fieldId:e,recordId:t,fieldType:this.type,value:n,formatValue:this.formatted(null==r?void 0:r.value,e)}}_getCellKey(e,t,r,n){const i=this.getCellKey(lk.type,e,t,n),o=this._getOptionValue(e,r);return i+"-"+(null==o?void 0:o.name)+(null==o?void 0:o.color)}_getOptionValue(e,t){const r=this._model.fieldOptionModel.find({field_uuid:e});for(const e of r)if(e.uuid===t)return e}setCell(e,t,r){if(r){if(!r.value)return void this.model.remove({field_uuid:e,record_uuid:t});this.model.upsert({field_uuid:e,record_uuid:t},{uuid:r.uuid,field_uuid:e,record_uuid:t,value:r.value})}}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r}),this.model.bulkCreate(e.map((e=>({uuid:e.uuid,field_uuid:t,record_uuid:e.recordId,value:e.value}))))}};lk.type=Rh.SELECT,lk.baseType=Th.SELECT,sk([to(Ov)],lk.prototype,"_model",2),lk=sk([eo()],lk);var ck=Object.defineProperty,uk=Object.getOwnPropertyDescriptor,dk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?uk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ck(t,r,o),o};let fk=class{static pluginModule(){return bo().register(lk).register(this)}init(e){e.registerField(this._selectField)}};fk.pluginName="kernel-field-select",dk([to(lk)],fk.prototype,"_selectField",2),fk=dk([eo({contrib:Tw})],fk);var pk=Object.defineProperty,hk=Object.getOwnPropertyDescriptor,mk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?hk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&pk(t,r,o),o};let vk=class extends nb{get model(){return this._model.fieldSelectModel}get type(){return vk.type}get baseType(){return vk.baseType}_getNewOptionColor(e){return e?e.color?rk.getNextColor(e.color):"":rk.getNextColor()}validate(e){return!0}transform(e,t){if(t){const r=this._model.fieldOptionModel.find({field_uuid:t});if(Array.isArray(e)){const n=[];for(const i of e){const e=r.findIndex((e=>e.name===i));if(e>=0)n.push({value:r[e].uuid});else{const e=Io(6),o=r[r.length-1],a={uuid:e,field_uuid:t,name:(null==i?void 0:i.slice(0,pm.MAX_LENGTH))||"",color:this._getNewOptionColor(o)};this._model.fieldOptionModel.create(a),n.push({value:a.uuid})}}return{value:n}}for(const t of r)if(t.name===e||t.uuid===e)return{value:[t.uuid]};const n=Io(6),i=r[r.length-1],o={uuid:n,field_uuid:t,name:(null==e?void 0:e.slice(0,pm.MAX_LENGTH))||"",color:this._getNewOptionColor(i)};return this._model.fieldOptionModel.create(o),{value:[n]}}return{value:[e]}}formatted(e,t){return null==e?"":t?this._model.fieldOptionModel.find({field_uuid:t,uuid:e}).map((e=>e.name)).join(","):Array.isArray(e)?e.join(","):""}getFieldOptionName(e,t){return null==e?[]:t?this._model.fieldOptionModel.find({field_uuid:t,uuid:e}).map((e=>e.name)):[]}keyValue(e){return Array.isArray(e)?e.join(","):e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value,e)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(null==r?void 0:r.value)}getCell(e,t){const r=this.model.find({field_uuid:e,record_uuid:t});let n=null;if(r.length>0){n=[];for(const e of r)e.value&&n.push(e.value)}return{cellKey:this._getCellKey(e,t,n,r.map((e=>e.updated_at))),cellId:this.getCellId(vk.type,e,t),fieldId:e,recordId:t,fieldType:this.type,value:n,formatValue:this.formatted(n,e)}}_getCellKey(e,t,r,n){const i=this.getCellKey(vk.type,e,t,n);let o="";if(r)for(const t of r){const r=this._getOptionValue(e,t);!r||(o=o+"-"+r.name+"-"+(null==r?void 0:r.color))}return i+"-"+o}_getOptionValue(e,t){const r=this._model.fieldOptionModel.find({field_uuid:e});for(const e of r)if(e.uuid===t)return e;return null}setCell(e,t,r){if(!r)return;const n=r.value;if(this.model.remove({field_uuid:e,record_uuid:t}),!n)return;const i=n.map((r=>{const n=jo(r)?null:"string"==typeof r?r:r.value;return{field_uuid:e,record_uuid:t,value:n}}));this.model.bulkCreate(i)}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r});let n=[];e.forEach((e=>{const r=e.value||[];n=n.concat(r.map((r=>{const n=jo(r)?null:"string"==typeof r?r:r.value;return{field_uuid:t,record_uuid:e.recordId,value:n}})))})),this.model.bulkCreate(n)}};vk.type=Rh.MULTI_SELECT,vk.baseType=Th.SELECT,mk([to(Ov)],vk.prototype,"_model",2),vk=mk([eo()],vk);var gk=Object.defineProperty,yk=Object.getOwnPropertyDescriptor,bk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?yk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&gk(t,r,o),o};let wk=class{static pluginModule(){return bo().register(vk).register(this)}init(e){e.registerField(this._multiSelectField)}};wk.pluginName="kernel-field-multi-select",bk([to(vk)],wk.prototype,"_multiSelectField",2),wk=bk([eo({contrib:Tw})],wk);var _k=Object.defineProperty,Ck=Object.getOwnPropertyDescriptor,Ek=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Ck(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&_k(t,r,o),o};let xk=class extends nb{constructor(){super(...arguments),this.strict=!0}get model(){return this._model.fieldNumberModel}get type(){return xk.type}get baseType(){return xk.baseType}get rules(){return[{validator:(e,t)=>""===t||null==t||Ld(t),errorMsg:kf("数字类型只能输入数字")}]}validate(e){return null==e||hf(String(e),{precision:xk.DECIMAL_PRECISION,scale:xk.DECIMAL_SCALE})}transform(e){return hf(e,{precision:xk.DECIMAL_PRECISION,scale:xk.DECIMAL_SCALE})?{value:e}:null}formatted(e){return null==e?"":String(e)}keyValue(e){return e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(r.value)}getCell(e,t){const r=this.model.findOne({field_uuid:e,record_uuid:t});return{uuid:null==r?void 0:r.uuid,cellKey:this.getCellKey(xk.type,e,t,null==r?void 0:r.updated_at),cellId:this.getCellId(xk.type,e,t),fieldId:e,recordId:t,fieldType:this.type,value:null==r?void 0:r.value,formatValue:this.formatted(null==r?void 0:r.value),...this.getVerify(null==r?void 0:r.value)}}setCell(e,t,r){if(r){if(!r.value)return void this.model.remove({field_uuid:e,record_uuid:t});this.strict&&!this.getVerify(r.value).verify||this.model.upsert({field_uuid:e,record_uuid:r.recordId},{uuid:r.uuid,field_uuid:e,record_uuid:t,value:r.value})}}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r}),this.model.bulkCreate(e.map((e=>({uuid:e.uuid,field_uuid:e.fieldId,record_uuid:e.recordId,value:e.value}))))}};xk.type=Rh.NUMBER,xk.baseType=Th.NUMBER,xk.DECIMAL_PRECISION=27,xk.DECIMAL_SCALE=9,Ek([to(Ov)],xk.prototype,"_model",2),xk=Ek([eo()],xk);var Sk=Object.defineProperty,kk=Object.getOwnPropertyDescriptor,Ok=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?kk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Sk(t,r,o),o};let Ik=class{static pluginModule(){return bo().register(xk).register(this)}init(e){e.registerField(this._numberField)}};Ik.pluginName="kernel-field-number",Ok([to(xk)],Ik.prototype,"_numberField",2),Ik=Ok([eo({contrib:Tw})],Ik);var Rk=Object.defineProperty,Tk=Object.getOwnPropertyDescriptor,Ak=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Tk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Rk(t,r,o),o};let Nk=class extends nb{get model(){return this._model.fieldUriModel}get type(){return Nk.type}get baseType(){return Nk.baseType}validate(e){return!(!e||null!=e&&e.some((e=>null==(null==e?void 0:e.uid)||null==(null==e?void 0:e.name)||null==(null==e?void 0:e.login))))}transform(e){if("string"==typeof e)return null;const t=[];if(Array.isArray(e))for(const r of e)r.uid&&r.name&&r.login&&r.icon&&t.push({uid:r.uid,name:r.name,icon:r.icon,login:r.login});return 0===t.length?null:{value:t}}formatted(e){return null==e?"":null==e?void 0:e.map((e=>e.name)).join(",")}keyValue(e){return e?e.map((e=>`${e.uid}`)).join(","):null}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(null==r?void 0:r.value)}getCell(e,t){const r=this.model.find({field_uuid:e,record_uuid:t}),n={cellKey:this.getCellKey(Nk.type,e,t,r.map((e=>e.updated_at))),cellId:this.getCellId(Nk.type,e,t),fieldId:e,recordId:t,fieldType:this.type,value:null,formatValue:""};if(r.length>0){n.value=[];for(const e of r){const t=this._model.userModel.findOne({uid:e.uid});!t||n.value.push({uuid:e.uuid,uid:e.uid,name:t.name||e.name,login:t.login,icon:t.icon||e.icon})}n.formatValue=this.formatted(n.value)}return n}setCell(e,t,r){if(!r)return;const n=r.value;if(this.model.remove({field_uuid:e,record_uuid:t}),!n||0===n.length)return;let i=n.map((r=>(this._model.userModel.findOne({uid:r.uid})||this._model.userModel.create({uid:r.uid,name:r.name,icon:r.icon,login:r.login}),{uuid:r.uuid,field_uuid:e,record_uuid:t,uid:r.uid,name:r.name,icon:r.icon})));i=xd(i,(e=>`${null==e?void 0:e.uid}-${null==e?void 0:e.field_uuid}-${e.record_uuid}`)),this.model.bulkCreate(i)}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r});let n=[];e.forEach((e=>{n=n.concat(e.value?e.value.map((r=>(this._model.userModel.findOne({uid:r.uid})||this._model.userModel.create({uid:r.uid,name:r.name,icon:r.icon,login:r.login}),{uuid:r.uuid,field_uuid:t,record_uuid:e.recordId,uid:r.uid,name:r.name,icon:r.icon}))):[])})),n=xd(n,(e=>`${null==e?void 0:e.uid}-${null==e?void 0:e.field_uuid}-${e.record_uuid}`)),this.model.bulkCreate(n)}};Nk.type=Rh.MENTION,Nk.baseType=Th.URI,Nk.MAX_LENGTH=128,Ak([to(Ov)],Nk.prototype,"_model",2),Nk=Ak([eo()],Nk);var Mk=Object.defineProperty,Pk=Object.getOwnPropertyDescriptor,jk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Pk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Mk(t,r,o),o};let Dk=class{static pluginModule(){return bo().register(Nk).register(this)}init(e){e.registerField(this._mentionField)}};Dk.pluginName="kernel-field-mention",jk([to(Nk)],Dk.prototype,"_mentionField",2),Dk=jk([eo({contrib:Tw})],Dk);var Fk=Object.defineProperty,Vk=Object.getOwnPropertyDescriptor,Lk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Vk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Fk(t,r,o),o};let $k=class extends nb{get model(){return this._model.fieldDateModel}get type(){return $k.type}get baseType(){return $k.baseType}validate(e){return!!e&&!!(e=>"Invalid Date"!==Td(e).toString())(e)}transform(e){try{return{value:Td(e).toString()}}catch{return null}}formatted(e){return null==e||""===e?"":Ld(e)?Td.unix(Number(e)).format($k.format):Td(e).format($k.format)}keyValue(e){return e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(r.value)}getCell(e,t){const r=this.model.findOne({field_uuid:e,record_uuid:t});return{uuid:null==r?void 0:r.uuid,cellKey:this.getCellKey($k.type,e,t,null==r?void 0:r.updated_at),cellId:this.getCellId($k.type,e,t),fieldId:e,recordId:t,fieldType:this.type,value:null==r?void 0:r.value,formatValue:this.formatted(null==r?void 0:r.value)}}setCell(e,t,r){if(r){if(!r.value)return void this.model.remove({field_uuid:e,record_uuid:t});!this.validate(r.value)||!r||this.model.upsert({field_uuid:e,record_uuid:r.recordId},{uuid:r.uuid,field_uuid:e,record_uuid:t,value:r.value})}}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r}),this.model.bulkCreate(e.map((e=>this.validate(e.value||"")?{uuid:e.uuid,field_uuid:e.fieldId,record_uuid:e.recordId,value:e.value}:null)).filter((e=>!!e)))}};$k.type=Rh.DATE,$k.baseType=Th.DATE,$k.format="YYYY-MM-DD",Lk([to(Ov)],$k.prototype,"_model",2),$k=Lk([eo()],$k);var Bk=Object.defineProperty,zk=Object.getOwnPropertyDescriptor,Uk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?zk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Bk(t,r,o),o};let Hk=class{static pluginModule(){return bo().register($k).register(this)}init(e){e.registerField(this._dateField)}};Hk.pluginName="kernel-field-date",Uk([to($k)],Hk.prototype,"_dateField",2),Hk=Uk([eo({contrib:Tw})],Hk);var Wk=Object.defineProperty,Gk=Object.getOwnPropertyDescriptor,Kk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Gk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Wk(t,r,o),o};let qk=class extends nb{get model(){return this._model.fieldBooleanModel}get type(){return qk.type}get baseType(){return qk.baseType}validate(e){return Wx(e)}transform(e){return!e||"1"!==e&&"是"!==e&&"true"!==e&&"yes"!==e.toLowerCase()&&"✅"!==e?null:{value:!0}}formatted(e){return null==e?"false":e?"true":"false"}keyValue(e){return e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(r.value)}getCell(e,t){const r=this.model.findOne({field_uuid:e,record_uuid:t}),n=(null==r?void 0:r.value)||!1;return{uuid:null==r?void 0:r.uuid,cellKey:this.getCellKey(qk.type,e,t,null==r?void 0:r.updated_at),cellId:this.getCellId(qk.type,e,t),fieldId:e,recordId:t,fieldType:this.type,value:n,formatValue:this.formatted(n)}}setCell(e,t,r){!r||this.model.upsert({field_uuid:e,record_uuid:t},{uuid:r.uuid,field_uuid:e,record_uuid:t,value:r.value})}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r}),this.model.bulkCreate(e.map((e=>({uuid:e.uuid,field_uuid:e.fieldId,record_uuid:e.recordId,value:e.value}))))}};qk.type=Rh.CHECKBOX,qk.baseType=Th.BOOLEAN,Kk([to(Ov)],qk.prototype,"_model",2),qk=Kk([eo()],qk);var Yk=Object.defineProperty,Xk=Object.getOwnPropertyDescriptor,Zk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Xk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Yk(t,r,o),o};let Jk=class{static pluginModule(){return bo().register(qk).register(this)}init(e){e.registerField(this._checkboxField)}};Jk.pluginName="kernel-field-checkbox",Zk([to(qk)],Jk.prototype,"_checkboxField",2),Jk=Zk([eo({contrib:Tw})],Jk);var Qk=Object.defineProperty,eO=Object.getOwnPropertyDescriptor,tO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?eO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Qk(t,r,o),o};let rO=class extends nb{constructor(){super(...arguments),this.editDisable=!0}get model(){return null}get type(){return rO.type}get baseType(){return rO.baseType}validate(){return!0}transform(){return null}formatted(e){return null==e?"":e.name||""}keyValue(e){return null==e?void 0:e.uid}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(null==r?void 0:r.value)}getCell(e,t){const r=this._model.recordModel.findOne({uuid:t}),n=this._model.userModel.findOne({uid:null==r?void 0:r.creator_id}),i={uuid:null==r?void 0:r.uuid,cellKey:this.getCellKey(rO.type,e,t,null==r?void 0:r.updated_at),cellId:this.getCellId(rO.type,e,t),fieldId:e,recordId:t,fieldType:this.type,value:null,formatValue:""};return n&&(i.value={name:n.name,icon:n.icon,uuid:n.uuid,uid:n.uid,login:n.login},i.formatValue=this.formatted(i.value)),i}};rO.type=Rh.USER_ID,rO.baseType=Th.SYSTEM,tO([to(Ov)],rO.prototype,"_model",2),rO=tO([eo()],rO);var nO=Object.defineProperty,iO=Object.getOwnPropertyDescriptor,oO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?iO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&nO(t,r,o),o};let aO=class{static pluginModule(){return bo().register(rO).register(this)}init(e){e.registerField(this._userIdField)}};aO.pluginName="kernel-field-user-id",oO([to(rO)],aO.prototype,"_userIdField",2),aO=oO([eo({contrib:Tw})],aO);var sO=Object.defineProperty,lO=Object.getOwnPropertyDescriptor,cO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?lO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&sO(t,r,o),o};let uO=class extends nb{constructor(){super(...arguments),this.editDisable=!0}get model(){return null}get type(){return uO.type}get baseType(){return uO.baseType}validate(){return!0}transform(){return null}formatted(e){return null==e?"":(Ld(e)&&(e=new Date(Number(e))),Td(e).format(uO.format))}keyValue(e){return e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(r.value)}getCell(e,t){const r=this._model.recordModel.findOne({uuid:t});return{uuid:null==r?void 0:r.uuid,cellKey:this.getCellKey(uO.type,e,t,null==r?void 0:r.updated_at),cellId:this.getCellId(uO.type,e,t),fieldId:e,recordId:t,fieldType:this.type,value:null==r?void 0:r.created_at,formatValue:this.formatted(null==r?void 0:r.created_at)}}};uO.type=Rh.CREATED_AT,uO.baseType=Th.SYSTEM,uO.format="YYYY-MM-DD HH:mm:ss",cO([to(Ov)],uO.prototype,"_model",2),uO=cO([eo()],uO);var dO=Object.defineProperty,fO=Object.getOwnPropertyDescriptor,pO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?fO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&dO(t,r,o),o};let hO=class{static pluginModule(){return bo().register(uO).register(this)}init(e){e.registerField(this._createdAtField)}};hO.pluginName="kernel-field-created-at",pO([to(uO)],hO.prototype,"_createdAtField",2),hO=pO([eo({contrib:Tw})],hO);var mO=Object.defineProperty,vO=Object.getOwnPropertyDescriptor,gO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?vO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&mO(t,r,o),o};let yO=class extends nb{constructor(){super(...arguments),this.editDisable=!0}get model(){return null}get type(){return yO.type}get baseType(){return yO.baseType}validate(){return!0}transform(){return null}formatted(e){return null==e?"":e.name||""}keyValue(e){return null==e?void 0:e.uid}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(null==r?void 0:r.value)}getCell(e,t){const r=this._model.recordModel.findOne({uuid:t}),n=this._model.userModel.findOne({uid:null==r?void 0:r.modifier_id}),i={uuid:null==r?void 0:r.uuid,cellKey:this.getCellKey(yO.type,e,t,null==r?void 0:r.updated_at),cellId:this.getCellId(yO.type,e,t),fieldId:e,recordId:t,fieldType:this.type,value:null,formatValue:""};return n&&(i.value={name:n.name,icon:n.icon,uuid:n.uuid,login:n.login,uid:n.uid},i.formatValue=this.formatted(i.value)),i}};yO.type=Rh.MODIFIER_ID,yO.baseType=Th.SYSTEM,gO([to(Ov)],yO.prototype,"_model",2),yO=gO([eo()],yO);var bO=Object.defineProperty,wO=Object.getOwnPropertyDescriptor,_O=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?wO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&bO(t,r,o),o};let CO=class{static pluginModule(){return bo().register(yO).register(this)}init(e){e.registerField(this._modifierIdField)}};CO.pluginName="kernel-field-modifier-id",_O([to(yO)],CO.prototype,"_modifierIdField",2),CO=_O([eo({contrib:Tw})],CO);var EO=Object.defineProperty,xO=Object.getOwnPropertyDescriptor,SO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?xO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&EO(t,r,o),o};let kO=class extends nb{constructor(){super(...arguments),this.editDisable=!0}get model(){return null}get type(){return kO.type}get baseType(){return kO.baseType}validate(){return!0}transform(){return null}formatted(e){return null==e?"":(Ld(e)&&(e=new Date(Number(e))),Td(e).format(kO.format))}keyValue(e){return e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(r.value)}getCell(e,t){const r=this._model.recordModel.findOne({uuid:t});return{uuid:null==r?void 0:r.uuid,cellKey:this.getCellKey(kO.type,e,t,null==r?void 0:r.updated_at),cellId:this.getCellId(kO.type,e,t),fieldId:e,recordId:t,fieldType:this.type,value:null==r?void 0:r.updated_at,formatValue:this.formatted(null==r?void 0:r.updated_at)}}};kO.type=Rh.UPDATED_AT,kO.baseType=Th.SYSTEM,kO.format="YYYY-MM-DD HH:mm:ss",SO([to(Ov)],kO.prototype,"_model",2),kO=SO([eo()],kO);var OO=Object.defineProperty,IO=Object.getOwnPropertyDescriptor,RO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?IO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&OO(t,r,o),o};let TO=class{static pluginModule(){return bo().register(kO).register(this)}init(e){e.registerField(this._updatedAtField)}};TO.pluginName="kernel-field-updated-at",RO([to(kO)],TO.prototype,"_updatedAtField",2),TO=RO([eo({contrib:Tw})],TO);var AO=Object.defineProperty,NO=Object.getOwnPropertyDescriptor,MO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?NO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&AO(t,r,o),o};let PO=class extends nb{get model(){return this._model.fieldStringModel}get type(){return PO.type}get baseType(){return PO.baseType}validate(e){return null==e||(!((null==e?void 0:e.length)>PO.MAX_LENGTH)||(e=e.substring(0,PO.MAX_LENGTH),!1))}transform(e){return{value:e}}formatted(e){return null==e?"":e.replace(/[\n\t\r]/gi,"").trim()}keyValue(e){return e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(r.value)}getCell(e,t){const r=this.model.findOne({field_uuid:e,record_uuid:t});return{uuid:null==r?void 0:r.uuid,cellKey:this.getCellKey(PO.type,e,t,null==r?void 0:r.updated_at),cellId:this.getCellId(PO.type,e,t),fieldId:e,recordId:t,fieldType:this.type,value:null==r?void 0:r.value,formatValue:this.formatted(null==r?void 0:r.value)}}setCell(e,t,r){if(r){if(!r.value)return void this.model.remove({field_uuid:e,record_uuid:t});this.model.upsert({field_uuid:e,record_uuid:t},{uuid:r.uuid,field_uuid:e,record_uuid:t,value:r.value})}}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r}),this.model.bulkCreate(e.map((e=>({uuid:e.uuid,field_uuid:e.fieldId,record_uuid:e.recordId,value:e.value}))))}};PO.type=Rh.TEXT,PO.baseType=Th.STRING,PO.MAX_LENGTH=5e3,MO([to(Ov)],PO.prototype,"_model",2),PO=MO([eo()],PO);var jO=Object.defineProperty,DO=Object.getOwnPropertyDescriptor,FO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?DO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&jO(t,r,o),o};let VO=class{static pluginModule(){return bo().register(PO).register(this)}init(e){e.registerField(this._textField)}};VO.pluginName="kernel-field-text",FO([to(PO)],VO.prototype,"_textField",2),VO=FO([eo({contrib:Tw})],VO);var LO=Object.defineProperty,$O=Object.getOwnPropertyDescriptor,BO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?$O(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&LO(t,r,o),o};let zO=class extends nb{get model(){return this._model.fieldUriModel}get type(){return zO.type}get baseType(){return zO.baseType}validate(e){if(null==e)return!0;if(!Array.isArray(e))return!1;for(const t of e){if(null==t.name||null==t.src||null==t.size||null==t.width||null==t.height)return!1;const e=t.name;if(e.length>zO.MAX_LENGTH&&(t.name=e.substring(0,zO.MAX_LENGTH)),!pf(t.src))return!1}return!0}transform(e){if(!e||"string"==typeof e)return null;let t=[];if(Array.isArray(e)){if(t=e.map((e=>this._transformItem(e))),!Array.isArray(t))return null}else if(Po(e)){if(t=this._transformItem(e),!t)return null;t=[t]}return t=t.filter(Boolean),0===t.length?null:{value:t}}_transformItem(e){return e&&"string"!=typeof e&&null!=e.name&&null!=e.src&&null!=e.size&&null!=e.width&&null!=e.height?{name:e.name,src:e.src,mime:e.mime,size:e.size,width:e.width,height:e.height}:null}formatted(e){return null==e?"":null==e?void 0:e.map((e=>e.name)).join(",")}keyValue(e){return null==e?null:e.map((e=>`${e.name}|${e.src}`)).join(",")}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(null==r?void 0:r.value)}getCell(e,t){const r=this.model.find({field_uuid:e,record_uuid:t}),n={cellKey:this.getCellKey(zO.type,e,t,r.map((e=>e.updated_at))),cellId:this.getCellId(zO.type,e,t),fieldId:e,recordId:t,fieldType:this.type,value:null,formatValue:""};return r.length>0&&(n.value=r,n.formatValue=this.formatted(n.value)),n}setCell(e,t,r){if(!r)return;const n=r.value;if(this.model.remove({field_uuid:e,record_uuid:t}),!n)return;const i=n.map((r=>({uuid:r.uuid,field_uuid:e,record_uuid:t,uid:r.uid,name:r.name,src:r.src,size:r.size,mime:r.mime,width:r.width,height:r.height})));this.model.bulkCreate(i)}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r});let n=[];e.forEach((e=>{n=n.concat(e.value?e.value.map((r=>({uuid:r.uuid,field_uuid:t,record_uuid:e.recordId,uid:r.uid,name:r.name,src:r.src,size:r.size,mime:r.mime,width:r.width,height:r.height}))):[])})),this.model.bulkCreate(n)}};zO.type=Rh.IMAGE,zO.baseType=Th.URI,zO.MAX_LENGTH=128,BO([to(Ov)],zO.prototype,"_model",2),zO=BO([eo()],zO);var UO=Object.defineProperty,HO=Object.getOwnPropertyDescriptor,WO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?HO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&UO(t,r,o),o};let GO=class{static pluginModule(){return bo().register(zO).register(this)}init(e){e.registerField(this._imageField)}};GO.pluginName="kernel-field-image",WO([to(zO)],GO.prototype,"_imageField",2),GO=WO([eo({contrib:Tw})],GO);var KO=Object.defineProperty,qO=Object.getOwnPropertyDescriptor,YO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?qO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&KO(t,r,o),o};let XO=class extends nb{get model(){return this._model.fieldUriModel}get type(){return XO.type}get baseType(){return XO.baseType}validate(e){if(null==e)return!0;if(!Array.isArray(e))return!1;for(const t of e){if(null==t.name||null==t.src||null==t.size)return!1;const e=t.name;if(e.length>XO.MAX_LENGTH&&(t.name=e.substring(0,XO.MAX_LENGTH)),!pf(t.src))return!1}return!0}transform(e){if(!e||"string"==typeof e)return null;let t=[];if(Array.isArray(e)){if(t=e.map((e=>this._transformItem(e))),!Array.isArray(t)||0===t.length)return null}else if(Po(e)){if(t=this._transformItem(e),!t)return null;t=[t]}return t=t.filter(Boolean),0===t.length?null:{value:t}}_transformItem(e){return"string"==typeof e||null==e.name||null==e.src||null==e.size?null:{name:e.name,src:e.src,mime:e.mime,size:e.size,width:e.width,height:e.height}}formatted(e){return null==e?"":null==e?void 0:e.map((e=>e.name)).join(",")}keyValue(e){return e?e.map((e=>`${e.name}|${e.src}`)).join(","):null}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(null==r?void 0:r.value)}getCell(e,t){const r=this.model.find({field_uuid:e,record_uuid:t}),n=r.length>0?r:null;return{cellKey:this.getCellKey(XO.type,e,t,r.map((e=>e.updated_at))),cellId:this.getCellId(XO.type,e,t),fieldId:e,recordId:t,fieldType:this.type,value:n,formatValue:this.formatted(n)}}setCell(e,t,r){if(!r)return;const n=r.value;if(this.model.remove({field_uuid:e,record_uuid:t}),!n)return;const i=n.map((r=>({uuid:r.uuid,field_uuid:e,record_uuid:t,uid:r.uid,name:r.name,src:r.src,size:r.size,mime:r.mime,width:r.width,height:r.height})));this.model.bulkCreate(i)}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r});let n=[];e.forEach((e=>{n=n.concat(e.value?e.value.map((r=>({uuid:r.uuid,field_uuid:t,record_uuid:e.recordId,uid:r.uid,name:r.name,src:r.src,size:r.size,mime:r.mime,width:r.width,height:r.height}))):[])})),this.model.bulkCreate(n)}};XO.type=Rh.FILE,XO.baseType=Th.URI,XO.MAX_LENGTH=128,YO([to(Ov)],XO.prototype,"_model",2),XO=YO([eo()],XO);var ZO=Object.defineProperty,JO=Object.getOwnPropertyDescriptor,QO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?JO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ZO(t,r,o),o};let eI=class{static pluginModule(){return bo().register(XO).register(this)}init(e){e.registerField(this._fileField)}};eI.pluginName="kernel-field-file",QO([to(XO)],eI.prototype,"_fileField",2),eI=QO([eo({contrib:Tw})],eI);var tI=Object.defineProperty,rI=Object.getOwnPropertyDescriptor,nI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?rI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&tI(t,r,o),o};let iI=class extends nb{get model(){return this._model.fieldUriModel}get type(){return iI.type}get baseType(){return iI.baseType}get rules(){return[{validator:(e,t)=>!(!jo(t)&&null!=t)||Fd(t.src||t),errorMsg:kf("输入格式有误")}]}validate(e){if(!e)return!0;const t=e.name,r=e.src;return!(!t||!r)&&((null==t?void 0:t.length)>iI.MAX_LENGTH&&(e.name=t.substring(0,iI.MAX_LENGTH)),!!pf(r))}transform(e){var t;if(!e)return null;let r=null;if("string"==typeof e){if(pf(e))return r={name:e,src:e},{value:r};let n;try{n=new URL(e)}catch{try{n=new URL("http://"+e)}catch{return{value:{name:e,src:(null==(t=globalThis.location)?void 0:t.href)||"https://www.yuque.com"}}}}const i=n.host.split(".");return 1===i.length&&(n.host=i[0]+".com"),r={name:e,src:n.toString().replace(/\/$/gi,"")},{value:r}}return r={name:e.name||"",src:e.src||""},{value:r}}formatted(e){return null==e?"":e.name||""}keyValue(e){return e&&e.name&&e.src?`${e.name}|${e.src}`:""}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(null==r?void 0:r.value)}getCell(e,t){const r=this.model.findOne({field_uuid:e,record_uuid:t}),n={uuid:null==r?void 0:r.uuid,cellKey:this.getCellKey(iI.type,e,t,null==r?void 0:r.updated_at),cellId:this.getCellId(iI.type,e,t),fieldId:e,recordId:t,fieldType:this.type,value:null,formatValue:""};if(r){n.value={name:r.name||"",src:r.src||""};const e=this.getVerify(n.value);n.verify=e.verify,n.errorMessage=e.errorMessage,n.formatValue=this.formatted(n.value)}return n}setCell(e,t,r){if(r){if(!r.value)return void this.model.remove({field_uuid:e,record_uuid:t});this.model.upsert({field_uuid:e,record_uuid:t},{uuid:r.uuid,field_uuid:e,record_uuid:t,name:r.value.name,src:r.value.src})}}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r}),this.model.bulkCreate(e.map((e=>{var r,n;return{uuid:e.uuid,field_uuid:t,record_uuid:e.recordId,name:null==(r=e.value)?void 0:r.name,src:null==(n=e.value)?void 0:n.src}})))}};iI.type=Rh.LINK,iI.baseType=Th.URI,iI.MAX_LENGTH=128,nI([to(Ov)],iI.prototype,"_model",2),iI=nI([eo()],iI);var oI=Object.defineProperty,aI=Object.getOwnPropertyDescriptor,sI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?aI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&oI(t,r,o),o};let lI=class{static pluginModule(){return bo().register(iI).register(this)}init(e){e.registerField(this._linkField)}};lI.pluginName="kernel-field-link",sI([to(iI)],lI.prototype,"_linkField",2),lI=sI([eo({contrib:Tw})],lI);var cI=Object.defineProperty,uI=Object.getOwnPropertyDescriptor,dI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?uI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&cI(t,r,o),o};let fI=class extends nb{get model(){return this._model.fieldStringModel}get type(){return fI.type}get baseType(){return fI.baseType}get rules(){return[{validator:(e,t)=>""===t||null==t||Id(t),errorMsg:kf("请输入有效邮箱")}]}validate(e){if(null!=e)return!((null==e?void 0:e.length)>fI.MAX_LENGTH||"string"==typeof e&&!function(e,t){if(Bd(e),(t=Hd(t,Qd)).require_display_name||t.allow_display_name){var r=e.match(ef);if(r){var n=r[1];if(e=e.replace(n,"").replace(/(^<|>$)/g,""),n.endsWith(" ")&&(n=n.slice(0,-1)),!function(e){var t=e.replace(/^"(.+)"$/,"$1");if(!t.trim())return!1;if(/[\.";<>]/.test(t)){if(t===e)return!1;if(t.split('"').length!==t.split('\\"').length)return!1}return!0}(n))return!1}else if(t.require_display_name)return!1}if(!t.ignore_max_length&&e.length>254)return!1;var i=e.split("@"),o=i.pop(),a=o.toLowerCase();if(t.host_blacklist.includes(a)||t.host_whitelist.length>0&&!t.host_whitelist.includes(a))return!1;var s=i.join("@");if(t.domain_specific_validation&&("gmail.com"===a||"googlemail.com"===a)){var l=(s=s.toLowerCase()).split("+")[0];if(!Ud(l.replace(/\./g,""),{min:6,max:30}))return!1;for(var c=l.split("."),u=0;u<c.length;u++)if(!rf.test(c[u]))return!1}if(!(!1!==t.ignore_max_length||Ud(s,{max:64})&&Ud(o,{max:254})))return!1;if(!Gd(o,{require_tld:t.require_tld,ignore_max_length:t.ignore_max_length,allow_underscores:t.allow_underscores})){if(!t.allow_ip_domain)return!1;if(!Jd(o)){if(!o.startsWith("[")||!o.endsWith("]"))return!1;var d=o.slice(1,-1);if(0===d.length||!Jd(d))return!1}}if('"'===s[0])return s=s.slice(1,s.length-1),t.allow_utf8_local_part?af.test(s):nf.test(s);for(var f=t.allow_utf8_local_part?of:tf,p=s.split("."),h=0;h<p.length;h++)if(!f.test(p[h]))return!1;return!(t.blacklisted_chars&&-1!==s.search(new RegExp("[".concat(t.blacklisted_chars,"]+"),"g")))}(e))}transform(e){return{value:e}}formatted(e){return null==e?"":e}keyValue(e){return e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(r.value)}getCell(e,t){const r=this.model.findOne({field_uuid:e,record_uuid:t});return{uuid:null==r?void 0:r.uuid,cellKey:this.getCellKey(fI.type,e,t,null==r?void 0:r.updated_at),cellId:this.getCellId(fI.type,e,t),fieldId:e,recordId:t,fieldType:this.type,value:null==r?void 0:r.value,formatValue:this.formatted(null==r?void 0:r.value),...this.getVerify(null==r?void 0:r.value)}}setCell(e,t,r){if(r){if(!r.value)return void this.model.remove({field_uuid:e,record_uuid:t});this.model.upsert({field_uuid:e,record_uuid:t},{uuid:r.uuid,field_uuid:e,record_uuid:t,value:r.value})}}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r}),this.model.bulkCreate(e.map((e=>({uuid:e.uuid,field_uuid:e.fieldId,record_uuid:e.recordId,value:e.value}))))}};fI.type=Rh.EMAIL,fI.baseType=Th.STRING,fI.MAX_LENGTH=128,dI([to(Ov)],fI.prototype,"_model",2),fI=dI([eo()],fI);var pI=Object.defineProperty,hI=Object.getOwnPropertyDescriptor,mI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?hI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&pI(t,r,o),o};let vI=class{static pluginModule(){return bo().register(fI).register(this)}init(e){e.registerField(this._emailField)}};vI.pluginName="kernel-field-email",mI([to(fI)],vI.prototype,"_emailField",2),vI=mI([eo({contrib:Tw})],vI);var gI=Object.defineProperty,yI=Object.getOwnPropertyDescriptor,bI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?yI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&gI(t,r,o),o};let wI=class extends nb{get model(){return this._model.fieldStringModel}get type(){return wI.type}get baseType(){return wI.baseType}get rules(){return[{validator:(e,t)=>""===t||null==t||function(e){return/^([0-9]|\+|\-)+$/gi.test(e)}(t),errorMsg:kf("请输入有效手机号")}]}validate(e){return null==e||!(e.length>wI.MAX_LENGTH)}transform(e){return{value:e}}formatted(e){return null==e?"":e}keyValue(e){return e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(null==r?void 0:r.value)}getCell(e,t){const r=this.model.findOne({field_uuid:e,record_uuid:t});return{uuid:null==r?void 0:r.uuid,cellKey:this.getCellKey(wI.type,e,t,null==r?void 0:r.updated_at),cellId:this.getCellId(wI.type,e,t),fieldId:e,recordId:t,fieldType:this.type,value:null==r?void 0:r.value,formatValue:this.formatted(null==r?void 0:r.value),...this.getVerify(null==r?void 0:r.value)}}setCell(e,t,r){if(r){if(!r.value)return void this.model.remove({field_uuid:e,record_uuid:t});this.model.upsert({field_uuid:e,record_uuid:t},{uuid:r.uuid,field_uuid:e,record_uuid:t,value:r.value})}}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r}),this.model.bulkCreate(e.map((e=>({uuid:e.uuid,field_uuid:e.fieldId,record_uuid:e.recordId,value:e.value}))))}};wI.type=Rh.PHONE,wI.baseType=Th.STRING,wI.MAX_LENGTH=128,bI([to(Ov)],wI.prototype,"_model",2),wI=bI([eo()],wI);var _I=Object.defineProperty,CI=Object.getOwnPropertyDescriptor,EI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?CI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&_I(t,r,o),o};let xI=class{static pluginModule(){return bo().register(wI).register(this)}init(e){e.registerField(this._phoneField)}};xI.pluginName="kernel-field-phone",EI([to(wI)],xI.prototype,"_phoneField",2),xI=EI([eo({contrib:Tw})],xI);var SI=Object.defineProperty,kI=Object.getOwnPropertyDescriptor,OI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?kI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&SI(t,r,o),o};let II=class extends nb{constructor(){super(...arguments),this.transformDisable=!0,this.createDisable=!0,this.deleteDisable=!0}get model(){return this._model.fieldStringModel}get type(){return II.type}get baseType(){return II.baseType}validate(e){return null==e||(!((null==e?void 0:e.length)>II.MAX_LENGTH)||(e=e.substring(0,II.MAX_LENGTH),!1))}transform(e){return{value:e}}formatted(e){return null==e?"":e.replace(/[\n\t\r]/gi,"").trim()}keyValue(e){return e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(r.value)}getCell(e,t){const r=this.model.findOne({field_uuid:e,record_uuid:t});return{uuid:null==r?void 0:r.uuid,cellKey:this.getCellKey(II.type,e,t,null==r?void 0:r.updated_at),cellId:this.getCellId(II.type,e,t),fieldId:e,recordId:t,fieldType:this.type,value:null==r?void 0:r.value,formatValue:this.formatted(null==r?void 0:r.value)}}setCell(e,t,r){!r||this.model.upsert({field_uuid:e,record_uuid:t},{uuid:r.uuid,field_uuid:e,record_uuid:t,value:r.value})}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r}),this.model.bulkCreate(e.map((e=>({uuid:e.uuid,field_uuid:e.fieldId,record_uuid:e.recordId,value:e.value}))))}};II.type=Rh.TITLE,II.baseType=Th.STRING,II.MAX_LENGTH=5e3,OI([to(Ov)],II.prototype,"_model",2),II=OI([eo()],II);var RI=Object.defineProperty,TI=Object.getOwnPropertyDescriptor,AI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?TI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&RI(t,r,o),o};let NI=class{static pluginModule(){return bo().register(II).register(this)}init(e){e.registerField(this._titleField)}};NI.pluginName="kernel-field-title",AI([to(II)],NI.prototype,"_titleField",2),NI=AI([eo({contrib:Tw})],NI);class MI extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.createFilter(e.viewId,e.filter),Promise.resolve(!0)}}MI.commandName="createFilter";class PI extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}beforeExecute(e){return e.viewId||(e.viewId=this.readService.getActiveView().uuid),e}async execute(e){return await this.context.job.removeFilter(e.filterId),Promise.resolve(!0)}}PI.commandName="removeFilter";class jI extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.updateFilter(e.viewId,e.filter),Promise.resolve(!0)}}jI.commandName="updateFilter";var DI=Object.defineProperty,FI=Object.getOwnPropertyDescriptor,VI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?FI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&DI(t,r,o),o};let LI=class{static pluginModule(){return bo().register(this)}init(){this.commandService.registerCommand(MI.commandName,MI),this.commandService.registerCommand(PI.commandName,PI),this.commandService.registerCommand(jI.commandName,jI)}};LI.pluginName="kernel-filter",VI([to(Pb)],LI.prototype,"commandService",2),LI=VI([eo({contrib:Tw})],LI);class $I extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}beforeExecute(e){const t=e.optionId,r=this.readService.getFieldOption(t);return e.fieldId=r.field_uuid,e}async execute(e){return await this.context.job.removeFieldOption(e.optionId),Promise.resolve(!0)}}$I.commandName="removeFieldOption";class BI extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.createFieldOption(e.fieldId,e.fieldOption),Promise.resolve(!0)}}BI.commandName="createFieldOption";class zI extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}beforeExecute(e){const t=e.optionId,r=this.readService.getFieldOption(t);return e.fieldId=r.field_uuid,e}async execute(e){return await this.context.job.updateFieldOption(e.optionId,e.fieldOption),Promise.resolve(!0)}}zI.commandName="updateFieldOption";var UI=Object.defineProperty,HI=Object.getOwnPropertyDescriptor,WI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?HI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&UI(t,r,o),o};let GI=class{static pluginModule(){return bo().register(this)}init(){this.commandService.registerCommand(BI.commandName,BI),this.commandService.registerCommand(zI.commandName,zI),this.commandService.registerCommand($I.commandName,$I)}};GI.pluginName="kernel-group",WI([to(Pb)],GI.prototype,"commandService",2),GI=WI([eo({contrib:Tw})],GI);class KI extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.createSort(e.viewId,e.sort),Promise.resolve(!0)}}KI.commandName="createSort";class qI extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.removeSort(e.viewId),Promise.resolve(!0)}}qI.commandName="removeSort";class YI extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.updateSort(e.viewId,e.sort,e.auto),Promise.resolve(!0)}}YI.commandName="updateSort";var XI=Object.defineProperty,ZI=Object.getOwnPropertyDescriptor,JI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ZI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&XI(t,r,o),o};let QI=class{static pluginModule(){return bo().register(this)}init(){this.commandService.registerCommand(KI.commandName,KI),this.commandService.registerCommand(qI.commandName,qI),this.commandService.registerCommand(YI.commandName,YI)}};QI.pluginName="kernel-sort",JI([to(Pb)],QI.prototype,"commandService",2),QI=JI([eo({contrib:Tw})],QI);var eR=Object.defineProperty,tR=Object.getOwnPropertyDescriptor,rR=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?tR(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&eR(t,r,o),o};let nR=class{static pluginModule(){return bo().contribution(Ex).register(Ox).register(p_).register(Nx).register(this)}init(){this._contentService.setProcessor(this._processor)}};nR.pluginName="kernel-process",rR([to(Yy)],nR.prototype,"_contentService",2),rR([to(Nx)],nR.prototype,"_processor",2),nR=rR([eo({contrib:Tw})],nR);class iR extends Ib{constructor(){super(...arguments),this.jobType=jb.User,this._bulkSetCellMap=new Map,this._targetRecordIndexCache=new Map,this._targetFieldIndexCache=new Map}destroy(){}beforeExecute(e){var t;return e.viewId||(e.viewId=null==(t=this.readService.getActiveView())?void 0:t.uuid),e}async execute(e){var t;const{pasteData:r,selection:n}=e,{cells:i}=r,{startRowIndex:o,startColIndex:a,rowCount:s,colCount:l}=n,c=s*l,u=i.length,d=i[0].length,f=u*d,p=1===f,h=p&&c>1,m=h?s:u,v=h?l:d,g=[],y=[];try{if(p&&!h){const e=i[0][0],t=this.readService.getCellByIndexes(o,a);if(y.push(null==t?void 0:t.recordId),!e||!t)return{code:-1,message:"fromCell, targetCell不存在 never"};if(Kh.isSystemType(t.fieldType))return{code:1,message:kf("系统字段不支持粘贴修改")};const r=this._getPasteCellDataToUpdate(e,t.fieldType,t.fieldId,t.recordId,o);await this._setCell(t.recordId,t.fieldId,r,!1)}else{let r=0;for(let e=0;e<m;e++){const t=e+o,n=this._getRecordByIndex(t),i=null==n?void 0:n.record_uuid;i?y.push(i):r+=1}if(r>0){for(let e=0;e<r;e++)g.push(Io(32));await this.context.job.createEmptyRecord({uuid:g,viewId:e.viewId})}let n=0;for(let e=0;e<m;e++){const r=e+o,s=this._getRecordByIndex(r),l=null==s?void 0:s.record_uuid;for(let o=0;o<v;o++){const s=o+a,c=h?i[0][0]:null==(t=null==i?void 0:i[e])?void 0:t[o],u=this._getFieldByIndex(s);if(!c)continue;if(!u)throw new Error("targetField不存在 never");if(Kh.isSystemType(u.type)){n++;continue}const d=u.uuid,f=this._getPasteCellDataToUpdate(c,u.type,d,l,r);await this._setCell(l,d,f,!0)}}const s=[...this._bulkSetCellMap.keys()];if(s.length>0)for(const e of s){const t=this._bulkSetCellMap.get(e);t&&this.context.job.bulkSetCell(t)}if(n===f)return{code:1,message:kf("系统字段不支持粘贴修改")}}}catch(e){let t="";return e instanceof Error?(t=e.message,console.error(e.stack)):t="string"==typeof e?e:"Unknown error",{code:-1,message:t}}finally{this._bulkSetCellMap.clear(),this._targetRecordIndexCache.clear(),this._targetFieldIndexCache.clear()}return{code:0,message:kf("粘贴成功"),data:{createRecordIds:g,updateRecordIds:y}}}async _setCell(e,t,r,n){const i=this.readService.getCell(t,e);if(!i)throw new Error("oldCell 不存在 never");const o={...i,value:r.cellValue};if(r.fromFieldId===r.toFieldId)if(n){let e=this._bulkSetCellMap.get(r.toFieldId)||[];e=e.concat(o),this._bulkSetCellMap.set(r.toFieldId,e)}else await this.context.job.setCell(o);else r.fromFieldType&&await this.context.job.safeSetCell(o,r.fromFieldType,r.toFieldType,r.fromFieldId,r.toFieldId)}_getPasteCellDataToUpdate(e,t,r,n,i){return{cellValue:e.value,toFieldType:t,toFieldId:r,toRecordId:n,toRecordIndex:i,fromFieldType:e.fieldType,fromFieldId:e.fieldId}}_getRecordByIndex(e){const t=this._targetRecordIndexCache.get(e);if(t)return t;const r=this.readService.getRecordByIndex(e);return this._targetRecordIndexCache.set(e,r),r}_getFieldByIndex(e){const t=this._targetFieldIndexCache.get(e);if(t)return t;const r=this.readService.getFieldByIndex(e);return this._targetFieldIndexCache.set(e,r),r}}iR.commandName="pasteUpdateRecords";var oR=Object.defineProperty,aR=Object.getOwnPropertyDescriptor,sR=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?aR(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&oR(t,r,o),o};let lR=class{static pluginModule(){return bo().register(this)}init(e){this._commandService.registerCommand(iR.commandName,iR)}};lR.pluginName="kernel-clipboard",sR([to(Pb)],lR.prototype,"_commandService",2),lR=sR([eo({contrib:Tw})],lR);const cR=Fi.defineToken("SelectionKernelPluginContribution");var uR=(e=>(e.NONE="none",e.CARET="caret",e.RANGE="range",e))(uR||{});class dR{constructor(e,t,r,n){this._row=e,this._column=t,this._rowCount=r,this._columnCount=n}static equal(e,t){return e===t||e._row===t._row&&e._column===t._column}get row(){return this._row}get column(){return this._column}get rowCount(){return this._rowCount}get columnCount(){return this._columnCount}get isAtRowStart(){return 0===this._row}get isAtRowEnd(){return this._row===this._rowCount-1}get isAtColumnStart(){return 0===this._column}get isAtColumnEnd(){return this._column===this._columnCount-1}get isAtStart(){return this.isAtRowStart&&this.isAtColumnStart}get isAtEnd(){return this.isAtRowEnd&&this.isAtColumnEnd}clone(){return new dR(this._row,this._column,this._rowCount,this._columnCount)}}var fR=Object.defineProperty,pR=Object.getOwnPropertyDescriptor,hR=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?pR(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&fR(t,r,o),o};let mR=class{static pluginModule(){return bo().contribution(cR).register(this).register(dR)}init(e){}};mR.pluginName="kernel-selection",hR([to(Pb)],mR.prototype,"commandService",2),mR=hR([eo({contrib:Tw})],mR);var vR=Object.defineProperty,gR=Object.getOwnPropertyDescriptor,yR=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?gR(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&vR(t,r,o),o};let bR=class{static pluginModule(){return bo().register(this)}init(){}};bR.pluginName="kernel-expand-record",yR([to(Pb)],bR.prototype,"commandService",2),bR=yR([eo({contrib:Tw})],bR);class wR extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.upsertStat(e.viewId,e.fieldId,e.type),!0}}wR.commandName="updateStat";class _R extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.removeStat(e.viewId,e.fieldId),!0}}_R.commandName="removeStat";var CR=Object.defineProperty,ER=Object.getOwnPropertyDescriptor,xR=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ER(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&CR(t,r,o),o};let SR=class{static pluginModule(){return bo().register(this)}init(){this.commandService.registerCommand(wR.commandName,wR),this.commandService.registerCommand(_R.commandName,_R)}};SR.pluginName="kernel-statistics",xR([to(Pb)],SR.prototype,"commandService",2),SR=xR([eo({contrib:Tw})],SR);class kR extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}beforeExecute(e){var t;return e||(e={direction:"after"}),e.uuid||(e.uuid=Io(32)),e.viewId||(e.viewId=null==(t=this.readService.getActiveView())?void 0:t.uuid),e}async execute(e){return await this.context.job.createEmptyRecord(e)}afterExecute(e,t,r){const n=e.viewId;this.readService.getViewFilters(n).length>0&&setTimeout((()=>{null==r||r.emitBeforeRefresh($y.FILTER,"addEmptyRecord",{uuid:e.uuid},(async()=>{var e;this.context.job.refreshView(n),r.emitAfterRefresh($y.FILTER),null==(e=this.context)||e.destroy()}))}),300)}}kR.commandName="addEmptyRecord";class OR extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}beforeExecute(e){return e.uuid||(e.uuid=Io(32)),e}async execute(e){return await this.context.job.copyRecord(e),Promise.resolve(!0)}}OR.commandName="copyRecord";class IR extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.removeRecords(e.recordIds||[],e.all||!1),Promise.resolve(!0)}}IR.commandName="removeRecords";var RR=Object.defineProperty,TR=Object.getOwnPropertyDescriptor,AR=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?TR(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&RR(t,r,o),o};const NR=100;let MR=class{static pluginModule(){return bo().register(this)}static registerConfiguration(e){e.registerConfiguration({id:"record",type:"object",title:"记录",properties:{maxCount:{type:"number",description:"最大记录数量"}}}),e.registerDefaultValue({"record.maxCount":NR})}init(){this.commandService.registerCommand(kR.commandName,kR),this.commandService.registerCommand(OR.commandName,OR),this.commandService.registerCommand(IR.commandName,IR)}};MR.pluginName="kernel-add-record",AR([to(Pb)],MR.prototype,"commandService",2),MR=AR([eo({contrib:Tw})],MR);var PR=Object.defineProperty,jR=Object.getOwnPropertyDescriptor;let DR=class{constructor(){this._index=-1,this._lockIndex=-1,this._preventForward=!1,this._capacity=0,this._stack=[],this._frameClosed=!1}lock(){this._preventForward=!0,this._lockIndex=this._index}unlock(){this._preventForward=!1,this._lockIndex=-1}clear(){this._index=-1,this._lockIndex=-1,this._capacity=0,this._stack=[],this._frameClosed=!1}canForward(){return this._index+1<this._capacity&&!this._preventForward}canBackward(){return this._index>-1&&this._index>this._lockIndex}add(e){this._addFrame(e),this._frameClosed=!0}append(e){if(this._frameClosed||-1===this._index)return this._addFrame(e),void(this._frameClosed=!1);const t=this._stack[this._index];t.operations=t.operations.concat(e.operations)}closeFrame(){this._frameClosed=!0}_addFrame(e){this._index++,this._preventForward=!1,this._stack[this._index]=e,this._capacity=this._index+1}forward(){return this.canForward()?(this._frameClosed=!0,this._index++,this._stack[this._index]):null}backward(){if(!this.canBackward())return null;this._frameClosed=!0;const e=this._stack[this._index];return this._index--,e}rollback(e=1){if(-1===this._index)return null;this._frameClosed=!0;const t=[];for(let r=0;r<e;r++)t.push(this._stack.pop()),this._index--;return this._capacity=this._index+1,t}};DR=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?jR(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&PR(t,r,o),o})([eo()],DR);class FR extends Ib{constructor(e,t,r){super(e,t,r),this.kernel=e,this.plugin=t,this.jobType=jb.History,this._stackService=null,this._stackService=t._stackService}destroy(){}async execute(){var e;if(null==(e=this._stackService)||!e.canBackward())return!1;const t=this._stackService.backward(),r=new Bb(this.context.commandExecutor,jb.History,this.context.Job,this.context.commandExecutor.readService,this.context.commandExecutor.writeService,this.context.commandExecutor.modelService),n=t.operations.slice().reverse();for(const e of n)await e.undo(r.job);return!0}}FR.commandName="undo";class VR extends Ib{constructor(e,t,r){super(e,t,r),this.kernel=e,this.plugin=t,this.readService=r,this.jobType=jb.History,this._stackService=null,this._stackService=t._stackService}destroy(){}async execute(){var e;if(null==(e=this._stackService)||!e.canForward())return!1;const t=this._stackService.forward(),r=new Bb(this.context.commandExecutor,jb.History,this.context.Job,this.context.commandExecutor.readService,this.context.commandExecutor.writeService,this.context.commandExecutor.modelService);for(const e of t.operations)await e.redo(r.job);return!0}}VR.commandName="redo";var LR=Object.defineProperty,$R=Object.getOwnPropertyDescriptor,BR=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?$R(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&LR(t,r,o),o};let zR=class{static pluginModule(){return bo().register(this).register(DR)}init(){this.commandService.registerCommand(FR.commandName,FR,this),this.commandService.registerCommand(VR.commandName,VR,this),this.commandService.onFinishExecuteCommand((({operations:e,type:t,context:r})=>{t===jb.User&&e&&this._stackService.add({operations:e})}))}destroy(){this._stackService.clear()}};zR.pluginName="kernel-history",BR([to(Pb)],zR.prototype,"commandService",2),BR([to(DR)],zR.prototype,"_stackService",2),zR=BR([eo({contrib:Tw})],zR);class UR extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){const{viewId:t,sourceRecordId:r,targetRecordId:n,sourceGroupItem:i,targetGroupItem:o}=e;return await this.context.job.updateRecordOrder(t,r,n,i,o),!0}}UR.commandName="changeRecordOrder";class HR extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){const{viewId:t,sourceFieldId:r,targetFieldId:n}=e;return await this.context.job.updateFieldOrder(t,r,n),!0}}HR.commandName="changeFieldOrder";class WR extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){const{fieldId:t,sourceFieldOptionId:r,targetFieldOptionId:n}=e;return await this.context.job.updateFieldOptionOrder(t,r,n),!0}}WR.commandName="changeFieldOptionOrder";class GR extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){const{sourceViewId:t,targetViewId:r}=e;return await this.context.job.updateViewOrder(t,r),!0}}GR.commandName="changeViewOrder";class KR extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.updateValueOrder(e),!0}}KR.commandName="updateValueOrder";var qR=Object.defineProperty,YR=Object.getOwnPropertyDescriptor,XR=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?YR(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&qR(t,r,o),o};let ZR=class{static pluginModule(){return bo().register(this)}init(){this.commandService.registerCommand(UR.commandName,UR),this.commandService.registerCommand(HR.commandName,HR),this.commandService.registerCommand(WR.commandName,WR),this.commandService.registerCommand(GR.commandName,GR),this.commandService.registerCommand(KR.commandName,KR)}};ZR.pluginName="kernel-order",XR([to(Pb)],ZR.prototype,"commandService",2),ZR=XR([eo({contrib:Tw})],ZR);class JR extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){const t=await this.context.job.createViewByType(e.uuid,e.type||Wh.GRID);return!e.noSwitchView&&!this.context.isRemote&&await this.context.job.switchView(null==t?void 0:t.uuid),Promise.resolve(!0)}}JR.commandName="addView";class QR extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.switchView(e.viewId),!0}}QR.commandName="switchView";class eT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.removeView(e.viewId),!0}}eT.commandName="removeView";class tT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}beforeExecute(e){return e.targetViewId=Io(32),e}async execute(e){const t=await this.context.job.copyView(e.targetViewId,e.viewId);return t&&await this.context.job.switchView(null==t?void 0:t.uuid),!0}}tT.commandName="copyView";class rT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.updateViewName(e.viewId,e.name),Promise.resolve(!0)}}rT.commandName="updateViewName";var nT=Object.defineProperty,iT=Object.getOwnPropertyDescriptor,oT=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?iT(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&nT(t,r,o),o};let aT=class{static pluginModule(){return bo().register(this)}static registerConfiguration(e){e.registerConfiguration({id:"view",type:"object",title:"视图",properties:{maxCount:{type:"number",description:"最大视图数量"}}})}init(){this.commandService.registerCommand(JR.commandName,JR),this.commandService.registerCommand(QR.commandName,QR),this.commandService.registerCommand(eT.commandName,eT),this.commandService.registerCommand(tT.commandName,tT),this.commandService.registerCommand(rT.commandName,rT)}};aT.pluginName="kernel-viewer-manage",oT([to(Pb)],aT.prototype,"commandService",2),aT=oT([eo({contrib:Tw})],aT);class sT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}beforeExecute(e){var t;return e.viewId||(e.viewId=null==(t=this.readService.getActiveView())?void 0:t.uuid),e}async execute(e){const{viewId:t,sourceFieldId:r,direction:n="after",field:i}=e;return await this.context.job.createField({viewId:t,field:i,sourceFieldId:r,direction:n}),Promise.resolve(!0)}}sT.commandName="addField";class lT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.changeFieldType(e.fieldId,e.fromType,e.toType),Promise.resolve(!0)}}lT.commandName="changeFieldType";class cT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.updateFieldProperty(e),Promise.resolve(!0)}}cT.commandName="updateFieldProperty";class uT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.updateFieldName(e.uuid,e.name),Promise.resolve(!0)}}uT.commandName="updateFieldName";class dT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute({field:e,newFieldProperty:t}){const r=null==e?void 0:e.type,n=null==e?void 0:e.name,i=e.uuid,o=!jo(t.type)&&r!==t.type,a=!jo(t.name)&&n!==t.name;if(o&&await this.context.job.changeFieldType(i,r,t.type),a&&await this.context.job.updateFieldName(i,t.name),!o&&Kh.isSelectLike(r)||Kh.isSelectLike(t.type)){const r=!jo(t.color)&&t.color!==(null==e?void 0:e.color),n=!jo(t.options)&&t.options!==(null==e?void 0:e.options),a={uuid:i};if(r&&(a.color=!!t.color),n){const e=Kx(t.options,"name");a.options=e}if(r||n){const e=o?this.readService.getFieldCells(i).filter((e=>!!e.value)):[];if(await this.context.job.updateFieldProperty(a),o){const t=e.map((e=>{var t,r;const n=e.fieldType,i=null==(r=null==(t=a.options)?void 0:t.find((t=>(null==t?void 0:t.name.slice(0,pm.MAX_LENGTH))===e.formatValue)))?void 0:r.uuid,o=jo(i)?null:n===Rh.MULTI_SELECT?[i]:i;return{recordId:e.recordId,fieldId:e.fieldId,value:o,cellId:e.cellId,fieldType:n,uuid:e.uuid}}));this.context.job.bulkSetCell(t)}}}return Promise.resolve(!0)}}dT.commandName="updateField";class fT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.removeField(e.fieldId),Promise.resolve(!0)}}fT.commandName="removeField";var pT=Object.defineProperty,hT=Object.getOwnPropertyDescriptor,mT=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?hT(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&pT(t,r,o),o};let vT=class{static pluginModule(){return bo().register(this)}init(){this.commandService.registerCommand(sT.commandName,sT),this.commandService.registerCommand(lT.commandName,lT),this.commandService.registerCommand(cT.commandName,cT),this.commandService.registerCommand(uT.commandName,uT),this.commandService.registerCommand(dT.commandName,dT),this.commandService.registerCommand(fT.commandName,fT)}};vT.pluginName="kernel-add-field",mT([to(Pb)],vT.prototype,"commandService",2),vT=mT([eo({contrib:Tw})],vT);class gT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.updateViewConfig(e.viewId,{cover_display:e.coverDisplay}),Promise.resolve(!0)}}class yT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.updateViewConfig(e.viewId,{show_field_name:e.showFieldName}),Promise.resolve(!0)}}class bT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.updateViewConfig(e.viewId,{cover_field_uuid:e.coverFieldId}),Promise.resolve(!0)}}class wT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.updateFieldHidden(e.viewId,e.fieldId,e.hidden),Promise.resolve(!0)}}var _T=Object.defineProperty,CT=Object.getOwnPropertyDescriptor,ET=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?CT(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&_T(t,r,o),o};let xT=class{static pluginModule(){return bo().register(this)}init(){this.commandService.registerCommand("updateCoverDisplay",gT),this.commandService.registerCommand("updateShowFieldName",yT),this.commandService.registerCommand("updateCoverSource",bT),this.commandService.registerCommand("updateFieldHidden",wT)}};xT.pluginName="kernel-viewer-field-setting",ET([to(Pb)],xT.prototype,"commandService",2),xT=ET([eo({contrib:Tw})],xT);class ST extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}beforeExecute(e){var t;return e.name||(e.name="分组"),e.viewId||(e.viewId=null==(t=this.readService.getActiveView())?void 0:t.uuid),e}async execute(e){const t=await this.context.job.createFieldGroup(e.viewId,e.name);if(!t)return!1;for(const r of e.fieldIds)await this.context.job.updateViewFieldGroup(e.viewId,r,t.uuid);return!0}}ST.commandName="addFieldGroup";class kT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}beforeExecute(e){var t;return e.viewId||(e.viewId=null==(t=this.readService.getActiveView())?void 0:t.uuid),e}async execute(e){return this.context.job.removeFieldGroup(null==e?void 0:e.viewId,e.fieldGroupId),!0}}kT.commandName="removeFieldGroup";class OT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}beforeExecute(e){var t;return e.viewId||(e.viewId=null==(t=this.readService.getActiveView())?void 0:t.uuid),e}async execute(e){return this.context.job.changeFieldGroupName(e.viewId,{uuid:e.fieldGroupId,name:e.name}),!0}}OT.commandName="changeFieldGroupName";var IT=Object.defineProperty,RT=Object.getOwnPropertyDescriptor,TT=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?RT(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&IT(t,r,o),o};let AT=class{static pluginModule(){return bo().register(this)}init(){this.commandService.registerCommand(ST.commandName,ST),this.commandService.registerCommand(kT.commandName,kT),this.commandService.registerCommand(OT.commandName,OT)}};AT.pluginName="kernel-field-group",TT([to(Pb)],AT.prototype,"commandService",2),AT=TT([eo({contrib:Tw})],AT);class NT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){const{viewId:t,fieldId:r,size:n}=e;return await this.context.job.updateFieldSize(t,r,n),Promise.resolve(!0)}}NT.commandName="changeColWidth";var MT=Object.defineProperty,PT=Object.getOwnPropertyDescriptor,jT=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?PT(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&MT(t,r,o),o};let DT=class{static pluginModule(){return bo().register(this)}init(){this.commandService.registerCommand(NT.commandName,NT)}};DT.pluginName="kernel-viewer-grid",jT([to(Pb)],DT.prototype,"commandService",2),DT=jT([eo({contrib:Tw})],DT);class FT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.createGroup(e.viewId,e.group),Promise.resolve(!0)}}FT.commandName="createGridGroup";class VT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.removeGroup(e.viewId),Promise.resolve(!0)}}VT.commandName="removeGridGroup";class LT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.updateGroup(e.viewId,e.group),Promise.resolve(!0)}}LT.commandName="updateGridGroup";var $T=Object.defineProperty,BT=Object.getOwnPropertyDescriptor,zT=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?BT(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&$T(t,r,o),o};let UT=class{static pluginModule(){return bo().register(this)}init(){this.commandService.registerCommand(FT.commandName,FT),this.commandService.registerCommand(VT.commandName,VT),this.commandService.registerCommand(LT.commandName,LT)}};UT.pluginName="kernel-viewer-grid-group",zT([to(Pb)],UT.prototype,"commandService",2),UT=zT([eo({contrib:Tw})],UT);class HT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.updateViewConfig(e.viewId,{record_height:e.recordHeight}),Promise.resolve(!0)}}var WT=Object.defineProperty,GT=Object.getOwnPropertyDescriptor,KT=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?GT(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&WT(t,r,o),o};let qT=class{static pluginModule(){return bo().register(this)}init(){this.commandService.registerCommand("updateGridRecordHeight",HT)}};qT.pluginName="kernel-viewer-grid-record-height",KT([to(Pb)],qT.prototype,"commandService",2),qT=KT([eo({contrib:Tw})],qT);class YT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.removeCells(e.cells),!0}}YT.commandName="removeCells";class XT extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.setCell(e),!0}}XT.commandName="setCell";var ZT=Object.defineProperty,JT=Object.getOwnPropertyDescriptor,QT=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?JT(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ZT(t,r,o),o};let eA=class{static pluginModule(){return bo().register(this)}init(){this.commandService.registerCommand(YT.commandName,YT),this.commandService.registerCommand(XT.commandName,XT)}};eA.pluginName="kernel-viewer-grid-cell-editor",QT([to(Pb)],eA.prototype,"commandService",2),eA=QT([eo({contrib:Tw})],eA);var tA=Object.defineProperty,rA=Object.getOwnPropertyDescriptor,nA=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?rA(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&tA(t,r,o),o};let iA=class{constructor(){this.viewType=Wh.CARD}static pluginModule(){return bo().register(this)}init(){}};iA.pluginName="kernel-viewer-card",nA([to(Pb)],iA.prototype,"commandService",2),iA=nA([eo({contrib:Tw})],iA);class oA extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.updateGroup(e.viewId,e.group),Promise.resolve(!0)}}var aA=Object.defineProperty,sA=Object.getOwnPropertyDescriptor,lA=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?sA(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&aA(t,r,o),o};let cA=class{static pluginModule(){return bo().register(this)}init(){this.commandService.registerCommand("updateKanbanGroup",oA)}};cA.pluginName="kernel-viewer-kanban",lA([to(Pb)],cA.prototype,"commandService",2),cA=lA([eo({contrib:Tw})],cA);class uA{constructor(e,t,r,n){this._node=e,this._type=t,this._handler=r,this._options=n||!1,this._node.addEventListener(this._type,this._handler,this._options)}destroy(){!this._handler||(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function dA(e,t,r,n){return new uA(e,t,r,n)}let fA=!1,pA=!1;function hA(e,t,r){if((null==e?void 0:e.nodeType)===Node.TEXT_NODE&&(e=e.parentNode),null==e||!e.closest)return null;const n=e.closest(t);return!n||r&&!r.contains(n)?null:n}function mA(e){var t,r;e.stopPropagation(),null==(r=null==(t=e.nativeEvent)?void 0:t.stopImmediatePropagation)||r.call(t)}function vA(e){e.preventDefault()}const gA=["input","textarea","select"];class yA{constructor(){this._dataStore=[],this._top=0,this._dataStore=[],this._top=0}push(e){this._dataStore[this._top++]=e}pop(){const e=this._dataStore[this._top-1];return this._top--,e}peek(){return this._dataStore[this._top-1]}clear(){this._dataStore=[],this._top=0}length(){return this._top}isEmpty(){return 0===this._top}toString(){return this._dataStore.toString()}}const bA=["+","-","/","*","(",")"],wA={"+":100,"-":100,"*":200,"/":200,"(":1e3,")":0},_A=(e,t)=>t.includes(e);function CA(e){const t=e.split(" "),r=new yA,n=[];for(;0!==t.length;)if(""!==t[0]){if(_A(t[0],bA))if("("===t[0])r.push(t[0]);else if(")"===t[0]){for(;"("!==r.peek();)n.push(r.pop());r.pop()}else if(r.isEmpty())r.push(t[0]);else if(wA[t[0]]>wA[r.peek()])r.push(t[0]);else{for(;!r.isEmpty()&&wA[r.peek()]>=wA[t[0]]&&"("!==r.peek();)n.push(r.pop());r.push(t[0])}else n.push(t[0]);t.shift()}else t.shift();for(;!r.isEmpty();)n.push(r.pop());return function(e){const t=new yA;for(;0!==e.length;){if(_A(e[0],bA)){const r=t.pop(),n=t.peek();let i=0;switch(e[0]){case"+":i=Number(n)+Number(r);break;case"-":i=Number(n)-Number(r);break;case"*":i=Number(n)*Number(r);break;case"/":i=Number(n)/Number(r)}t.pop(),t.push(i)}else t.push(e[0]);e.shift()}const r=t.pop();if(isNaN(r))throw new Error("Oops, result is not a number");if(r===1/0)throw new Error("Oops, result is Infinity");return r}(n)}var EA=function(e){return function(t){var r=nc(t=Dl(t))?vc(t):void 0,n=r?r[0]:t.charAt(0),i=r?function(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&r>=n?e:tc(e,t,r)}(r,1).join(""):t.slice(1);return n[e]()+i}}("toUpperCase");const xA=EA;const SA=function(){return ma.Date.now()};var kA="Expected a function",OA=Math.max,IA=Math.min;function RA(e,t,r){var n,i,o,a,s,l,c=0,u=!1,d=!1,f=!0;if("function"!=typeof e)throw new TypeError(kA);function p(t){var r=n,o=i;return n=i=void 0,c=t,a=e.apply(o,r)}function h(e){var r=e-l;return void 0===l||r>=t||r<0||d&&e-c>=o}function m(){var e=SA();if(h(e))return v(e);s=setTimeout(m,function(e){var r=t-(e-l);return d?IA(r,o-(e-c)):r}(e))}function v(e){return s=void 0,f&&n?p(e):(n=i=void 0,a)}function g(){var e=SA(),r=h(e);if(n=arguments,i=this,l=e,r){if(void 0===s)return function(e){return c=e,s=setTimeout(m,t),u?p(e):a}(l);if(d)return clearTimeout(s),s=setTimeout(m,t),p(l)}return void 0===s&&(s=setTimeout(m,t)),a}return t=Ha(t)||0,Va(r)&&(u=!!r.leading,o=(d="maxWait"in r)?OA(Ha(r.maxWait)||0,t):o,f="trailing"in r?!!r.trailing:f),g.cancel=function(){void 0!==s&&clearTimeout(s),c=0,n=l=i=s=void 0},g.flush=function(){return void 0===s?a:v(SA())},g}var TA="[object Number]";function AA(e){return function(e){return"number"==typeof e||ka(e)&&Sa(e)==TA}(e)&&e!=+e}function NA(e){return void 0===e}class MA{static get isTraceReact(){return!(!globalThis.process||!globalThis.process.env)&&"true"===er.exports.env.TRACE_REACT}static get isTraceDi(){if(!globalThis.process||!globalThis.process.env)return!1;const e="true"===er.exports.env.TRACE_DI;return e&&Wo.enable("infra","di"),e}static get isTrace(){return!(!globalThis.process||!globalThis.process.env)&&"true"===er.exports.env.TRACE}static get isDev(){return!(!globalThis.process||!globalThis.process.env)&&"development"===er.exports.env.NODE_ENV}static get isMobile(){return oa.isMobile}}Fi.defineToken("WorkbenchContextToken");const PA=Fi.defineToken("WorkbenchPluginContribution");var jA=Object.defineProperty,DA=Object.getOwnPropertyDescriptor,FA=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?DA(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&jA(t,r,o),o};let VA=class{constructor(){this._plugins=[]}init(){this._plugins=this._workbenchPluginProvider.getContributions(),this._initPlugins()}destroy(){this._plugins.forEach((e=>{var t;return null==(t=e.destroy)?void 0:t.call(e)}))}_initPlugins(){this._plugins.forEach((e=>{e.init()}))}};FA([Eo(PA)],VA.prototype,"_workbenchPluginProvider",2),VA=FA([eo()],VA);const LA=Fi.defineToken("WorkbenchContextService",{multiple:!1}),$A=s.a.createContext({container:null});$A.displayName="TableDiContext";const BA=$A.Provider;function zA(e,t){var r;const n=s.a.useContext($A),i=n.container;if(!i)throw new Error('"useContainer" is being used outside of the TableDiContext');try{return i.get(e)}catch(e){return null!=t&&t.optional||(console.warn(e),null==(r=n.onError)||r.call(n,e)),null}}$A.Consumer;const UA=({activeColor:e,onSelect:t,colorSource:r})=>{const n=zA(rk),i=zA(WS);return s.a.createElement("div",{className:"lakex-table-colorpicker"},r.map(((r,o)=>s.a.createElement("div",{className:"lakex-table-colorpicker-group",key:o},r.map(((r,o)=>{const a=(null==r?void 0:r.toLowerCase())===(null==e?void 0:e.toLowerCase());return s.a.createElement("span",{key:o,className:"lakex-table-colorpicker-item",onClick:t.bind(void 0,r)},s.a.createElement("span",{style:{backgroundColor:null==n?void 0:n.getRenderColor(r)}},a&&s.a.createElement("svg",{style:{fill:null==i?void 0:i.getThemeValue("@yuque-color-icon-primary")},viewBox:"0 0 18 18"},s.a.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))))}))))))},HA=({onChange:e,...t})=>{const r=Object(a.useRef)();return s.a.createElement(u.a,{...t,autoComplete:"off",onChange:t=>{r.current||e(t)},onCompositionStart:()=>{r.current=!0},onCompositionEnd:t=>{r.current=!1,e(t)}})};var WA={exports:{}};!function(e){!function(){var t={}.hasOwnProperty;function r(){for(var e=[],n=0;n<arguments.length;n++){var i=arguments[n];if(i){var o=typeof i;if("string"===o||"number"===o)e.push(i);else if(Array.isArray(i)){if(i.length){var a=r.apply(null,i);a&&e.push(a)}}else if("object"===o){if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]")){e.push(i.toString());continue}for(var s in i)t.call(i,s)&&i[s]&&e.push(s)}}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):window.classNames=r}()}(WA);const GA=WA.exports,{TextArea:KA}=u.a,qA="lakex-editor-for-keyboard-input",YA=s.a.forwardRef(((e,t)=>{const{allowEnter:r=!1,onSave:n,maxRows:i,rows:o=1,...l}=e,c=Object(a.useRef)(null),[d,f]=Object(a.useState)(e.value||"");Object(a.useLayoutEffect)((()=>{jo(e.value)||f(e.value)}),[e.value]),Object(a.useImperativeHandle)(t,(()=>({focus:e=>{var t;null==(t=c.current)||t.focus(e)},blur:()=>{var e;null==(e=c.current)||e.blur()},setCursorToEnd:()=>{p()},setValue:e=>{f(e)},getValue:()=>d,clearValue:()=>{f("")}})));const p=Object(a.useCallback)((()=>{setTimeout((()=>{const e=document.activeElement;!e||!e.classList.contains(qA)||(r?e.scrollTop=e.scrollHeight:e.scrollLeft=e.scrollWidth)}),100)}),[r]),h=Object(a.useMemo)((()=>i?{minRows:o,maxRows:i}:{minRows:o}),[]),m=Object(a.useCallback)((t=>{var r;const n=t.target.value;f(n),null==(r=e.onChange)||r.call(e,t)}),[e.onChange]);return r?s.a.createElement(KA,{autoSize:h,ref:c,...l,value:d,onChange:m,className:GA(qA,e.className),autoComplete:"off",onMouseDown:mA,onMouseMove:mA,onMouseUp:mA,onFocus:e.onFocus,onBlur:e.onBlur}):s.a.createElement(u.a,{ref:c,...l,value:d,onChange:m,className:GA(qA,e.className),autoComplete:"off",onMouseDown:mA,onMouseMove:mA,onMouseUp:mA,onFocus:e.onFocus,onBlur:e.onBlur})}));const XA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function ZA(e){const t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function JA(e){return"nodeType"in e}function QA(e){var t,r;return e?ZA(e)?e:JA(e)&&null!=(t=null==(r=e.ownerDocument)?void 0:r.defaultView)?t:window:window}function eN(e){const{Document:t}=QA(e);return e instanceof t}function tN(e){return!ZA(e)&&e instanceof QA(e).HTMLElement}function rN(e){return e?ZA(e)?e.document:JA(e)?eN(e)?e:tN(e)?e.ownerDocument:document:document:document}const nN=XA?a.useLayoutEffect:a.useEffect;function iN(e){const t=Object(a.useRef)(e);return nN((()=>{t.current=e})),Object(a.useCallback)((function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return null==t.current?void 0:t.current(...r)}),[])}function oN(e,t){void 0===t&&(t=[e]);const r=Object(a.useRef)(e);return nN((()=>{r.current!==e&&(r.current=e)}),t),r}function aN(e,t){const r=Object(a.useRef)();return Object(a.useMemo)((()=>{const t=e(r.current);return r.current=t,t}),[...t])}function sN(e){const t=iN(e),r=Object(a.useRef)(null),n=Object(a.useCallback)((e=>{e!==r.current&&(null==t||t(e,r.current)),r.current=e}),[]);return[r,n]}function lN(e){const t=Object(a.useRef)();return Object(a.useEffect)((()=>{t.current=e}),[e]),t.current}let cN={};function uN(e,t){return Object(a.useMemo)((()=>{if(t)return t;const r=null==cN[e]?0:cN[e]+1;return cN[e]=r,e+"-"+r}),[e,t])}function dN(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce(((t,r)=>{const n=Object.entries(r);for(const[r,i]of n){const n=t[r];null!=n&&(t[r]=n+e*i)}return t}),{...t})}}const fN=dN(1),pN=dN(-1);function hN(e){if(!e)return!1;const{KeyboardEvent:t}=QA(e.target);return t&&e instanceof t}function mN(e){if(function(e){if(!e)return!1;const{TouchEvent:t}=QA(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return function(e){return"clientX"in e&&"clientY"in e}(e)?{x:e.clientX,y:e.clientY}:null}const vN=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[vN.Translate.toString(e),vN.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),gN="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function yN(e){return e.matches(gN)?e:e.querySelector(gN)}const bN={display:"none"};function wN(e){let{id:t,value:r}=e;return s.a.createElement("div",{id:t,style:bN},r)}const _N={position:"fixed",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};function CN(e){let{id:t,announcement:r}=e;return s.a.createElement("div",{id:t,style:_N,role:"status","aria-live":"assertive","aria-atomic":!0},r)}const EN=Object(a.createContext)(null);const xN={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},SN={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function kN(e){let{announcements:t=SN,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=xN}=e;const{announce:o,announcement:c}=function(){const[e,t]=Object(a.useState)("");return{announce:Object(a.useCallback)((e=>{null!=e&&t(e)}),[]),announcement:e}}(),u=uN("DndLiveRegion"),[d,f]=Object(a.useState)(!1);if(Object(a.useEffect)((()=>{f(!0)}),[]),function(e){const t=Object(a.useContext)(EN);Object(a.useEffect)((()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)}),[e,t])}(Object(a.useMemo)((()=>({onDragStart(e){let{active:r}=e;o(t.onDragStart({active:r}))},onDragMove(e){let{active:r,over:n}=e;t.onDragMove&&o(t.onDragMove({active:r,over:n}))},onDragOver(e){let{active:r,over:n}=e;o(t.onDragOver({active:r,over:n}))},onDragEnd(e){let{active:r,over:n}=e;o(t.onDragEnd({active:r,over:n}))},onDragCancel(e){let{active:r,over:n}=e;o(t.onDragCancel({active:r,over:n}))}})),[o,t])),!d)return null;const p=s.a.createElement(s.a.Fragment,null,s.a.createElement(wN,{id:n,value:i.draggable}),s.a.createElement(CN,{id:u,announcement:c}));return r?Object(l.createPortal)(p,r):p}var ON;function IN(){}function RN(e,t){return Object(a.useMemo)((()=>({sensor:e,options:null!=t?t:{}})),[e,t])}function TN(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Object(a.useMemo)((()=>[...t].filter((e=>null!=e))),[...t])}!function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"}(ON||(ON={}));const AN=Object.freeze({x:0,y:0});function NN(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function MN(e,t){const r=mN(e);if(!r)return"0 0";return(r.x-t.left)/t.width*100+"% "+(r.y-t.top)/t.height*100+"%"}function PN(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function jN(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function DN(e){let{left:t,top:r,height:n,width:i}=e;return[{x:t,y:r},{x:t+i,y:r},{x:t,y:r+n},{x:t+i,y:r+n}]}function FN(e,t){if(!e||0===e.length)return null;const[r]=e;return t?r[t]:r}function VN(e,t,r){return void 0===t&&(t=e.left),void 0===r&&(r=e.top),{x:t+.5*e.width,y:r+.5*e.height}}const LN=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=VN(t,t.left,t.top),o=[];for(const e of n){const{id:t}=e,n=r.get(t);if(n){const r=NN(VN(n),i);o.push({id:t,data:{droppableContainer:e,value:r}})}}return o.sort(PN)};function $N(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),a=i-n,s=o-r;if(n<i&&r<o){const r=t.width*t.height,n=e.width*e.height,i=a*s;return Number((i/(r+n-i)).toFixed(4))}return 0}const BN=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=[];for(const e of n){const{id:n}=e,o=r.get(n);if(o){const r=$N(o,t);r>0&&i.push({id:n,data:{droppableContainer:e,value:r}})}}return i.sort(jN)};function zN(e,t){const{top:r,left:n,bottom:i,right:o}=t;return r<=e.y&&e.y<=i&&n<=e.x&&e.x<=o}function UN(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:AN}function HN(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce(((t,r)=>({...t,top:t.top+e*r.y,bottom:t.bottom+e*r.y,left:t.left+e*r.x,right:t.right+e*r.x})),{...t})}}const WN=HN(1);function GN(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}const KN={ignoreTransform:!1};function qN(e,t){void 0===t&&(t=KN);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:t,transformOrigin:n}=QA(e).getComputedStyle(e);t&&(r=function(e,t,r){const n=GN(t);if(!n)return e;const{scaleX:i,scaleY:o,x:a,y:s}=n,l=e.left-a-(1-i)*parseFloat(r),c=e.top-s-(1-o)*parseFloat(r.slice(r.indexOf(" ")+1)),u=i?e.width/i:e.width,d=o?e.height/o:e.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}(r,t,n))}const{top:n,left:i,width:o,height:a,bottom:s,right:l}=r;return{top:n,left:i,width:o,height:a,bottom:s,right:l}}function YN(e){return qN(e,{ignoreTransform:!0})}function XN(e,t){const r=[];return e?function n(i){if(null!=t&&r.length>=t||!i)return r;if(eN(i)&&null!=i.scrollingElement&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!tN(i)||function(e){return e instanceof QA(e).SVGElement}(i)||r.includes(i))return r;const o=QA(e).getComputedStyle(i);return i!==e&&function(e,t){void 0===t&&(t=QA(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some((e=>{const n=t[e];return"string"==typeof n&&r.test(n)}))}(i,o)&&r.push(i),function(e,t){return void 0===t&&(t=QA(e).getComputedStyle(e)),"fixed"===t.position}(i,o)?r:n(i.parentNode)}(e):r}function ZN(e){const[t]=XN(e,1);return null!=t?t:null}function JN(e){return XA&&e?ZA(e)?e:JA(e)?eN(e)||e===rN(e).scrollingElement?window:tN(e)?e:null:null:null}function QN(e){return ZA(e)?e.scrollX:e.scrollLeft}function eM(e){return ZA(e)?e.scrollY:e.scrollTop}function tM(e){return{x:QN(e),y:eM(e)}}var rM;function nM(e){return!(!XA||!e)&&e===document.scrollingElement}function iM(e){const t={x:0,y:0},r=nM(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height};return{isTop:e.scrollTop<=t.y,isLeft:e.scrollLeft<=t.x,isBottom:e.scrollTop>=n.y,isRight:e.scrollLeft>=n.x,maxScroll:n,minScroll:t}}!function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"}(rM||(rM={}));const oM={x:.2,y:.2};function aM(e,t,r,n,i){let{top:o,left:a,right:s,bottom:l}=r;void 0===n&&(n=10),void 0===i&&(i=oM);const{isTop:c,isBottom:u,isLeft:d,isRight:f}=iM(e),p={x:0,y:0},h={x:0,y:0},m=t.height*i.y,v=t.width*i.x;return!c&&o<=t.top+m?(p.y=rM.Backward,h.y=n*Math.abs((t.top+m-o)/m)):!u&&l>=t.bottom-m&&(p.y=rM.Forward,h.y=n*Math.abs((t.bottom-m-l)/m)),!f&&s>=t.right-v?(p.x=rM.Forward,h.x=n*Math.abs((t.right-v-s)/v)):!d&&a<=t.left+v&&(p.x=rM.Backward,h.x=n*Math.abs((t.left+v-a)/v)),{direction:p,speed:h}}function sM(e){if(e===document.scrollingElement){const{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}const{top:t,left:r,right:n,bottom:i}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:i,width:e.clientWidth,height:e.clientHeight}}function lM(e){return e.reduce(((e,t)=>fN(e,tM(t))),AN)}function cM(e,t){if(void 0===t&&(t=qN),!e)return;const{top:r,left:n,bottom:i,right:o}=t(e);!ZN(e)||(i<=0||o<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const uM=[["x",["left","right"],function(e){return e.reduce(((e,t)=>e+QN(t)),0)}],["y",["top","bottom"],function(e){return e.reduce(((e,t)=>e+eM(t)),0)}]];class dM{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=XN(t),n=lM(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[e,t,i]of uM)for(const o of t)Object.defineProperty(this,o,{get:()=>{const t=i(r),a=n[e]-t;return this.rect[o]+a},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class fM{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach((e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)}))},this.target=e}add(e,t,r){var n;null==(n=this.target)||n.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function pM(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return"number"==typeof t?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t&&n>t.y}var hM,mM;function vM(e){e.preventDefault()}function gM(e){e.stopPropagation()}!function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"}(hM||(hM={})),function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter"}(mM||(mM={}));const yM={start:[mM.Space,mM.Enter],cancel:[mM.Esc],end:[mM.Space,mM.Enter]},bM=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case mM.Right:return{...r,x:r.x+25};case mM.Left:return{...r,x:r.x-25};case mM.Down:return{...r,y:r.y+25};case mM.Up:return{...r,y:r.y-25}}};class wM{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new fM(rN(t)),this.windowListeners=new fM(QA(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(hM.Resize,this.handleCancel),this.windowListeners.add(hM.VisibilityChange,this.handleCancel),setTimeout((()=>this.listeners.add(hM.Keydown,this.handleKeyDown)))}handleStart(){const{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&cM(r),t(AN)}handleKeyDown(e){if(hN(e)){const{active:t,context:r,options:n}=this.props,{keyboardCodes:i=yM,coordinateGetter:o=bM,scrollBehavior:a="smooth"}=n,{code:s}=e;if(i.end.includes(s))return void this.handleEnd(e);if(i.cancel.includes(s))return void this.handleCancel(e);const{collisionRect:l}=r.current,c=l?{x:l.left,y:l.top}:AN;this.referenceCoordinates||(this.referenceCoordinates=c);const u=o(e,{active:t,context:r.current,currentCoordinates:c});if(u){const t=pN(u,c),n={x:0,y:0},{scrollableAncestors:i}=r.current;for(const r of i){const i=e.code,{isTop:o,isRight:s,isLeft:l,isBottom:c,maxScroll:d,minScroll:f}=iM(r),p=sM(r),h={x:Math.min(i===mM.Right?p.right-p.width/2:p.right,Math.max(i===mM.Right?p.left:p.left+p.width/2,u.x)),y:Math.min(i===mM.Down?p.bottom-p.height/2:p.bottom,Math.max(i===mM.Down?p.top:p.top+p.height/2,u.y))},m=i===mM.Right&&!s||i===mM.Left&&!l,v=i===mM.Down&&!c||i===mM.Up&&!o;if(m&&h.x!==u.x){const e=r.scrollLeft+t.x,o=i===mM.Right&&e<=d.x||i===mM.Left&&e>=f.x;if(o&&!t.y)return void r.scrollTo({left:e,behavior:a});n.x=o?r.scrollLeft-e:i===mM.Right?r.scrollLeft-d.x:r.scrollLeft-f.x,n.x&&r.scrollBy({left:-n.x,behavior:a});break}if(v&&h.y!==u.y){const e=r.scrollTop+t.y,o=i===mM.Down&&e<=d.y||i===mM.Up&&e>=f.y;if(o&&!t.x)return void r.scrollTo({top:e,behavior:a});n.y=o?r.scrollTop-e:i===mM.Down?r.scrollTop-d.y:r.scrollTop-f.y,n.y&&r.scrollBy({top:-n.y,behavior:a});break}}this.handleMove(e,fN(pN(u,this.referenceCoordinates),n))}}}handleMove(e,t){const{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function _M(e){return Boolean(e&&"distance"in e)}function CM(e){return Boolean(e&&"delay"in e)}wM.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=yM,onActivation:i}=t,{active:o}=r;const{code:a}=e.nativeEvent;if(n.start.includes(a)){const t=o.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==i||i({event:e.nativeEvent}),!0)}return!1}}];class EM{constructor(e,t,r){var n;void 0===r&&(r=function(e){const{EventTarget:t}=QA(e);return e instanceof t?e:rN(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:i}=e,{target:o}=i;this.props=e,this.events=t,this.document=rN(o),this.documentListeners=new fM(this.document),this.listeners=new fM(r),this.windowListeners=new fM(QA(o)),this.initialCoordinates=null!=(n=mN(i))?n:AN,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),this.windowListeners.add(hM.Resize,this.handleCancel),this.windowListeners.add(hM.DragStart,vM),this.windowListeners.add(hM.VisibilityChange,this.handleCancel),this.windowListeners.add(hM.ContextMenu,vM),this.documentListeners.add(hM.Keydown,this.handleKeydown),t){if(_M(t))return;if(CM(t))return void(this.timeoutId=setTimeout(this.handleStart,t.delay))}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(hM.Click,gM,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(hM.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:r,initialCoordinates:n,props:i}=this,{onMove:o,options:{activationConstraint:a}}=i;if(!n)return;const s=null!=(t=mN(e))?t:AN,l=pN(n,s);if(!r&&a){if(CM(a))return pM(l,a.tolerance)?this.handleCancel():void 0;if(_M(a))return null!=a.tolerance&&pM(l,a.tolerance)?this.handleCancel():pM(l,a.distance)?this.handleStart():void 0}e.cancelable&&e.preventDefault(),o(s)}handleEnd(){const{onEnd:e}=this.props;this.detach(),e()}handleCancel(){const{onCancel:e}=this.props;this.detach(),e()}handleKeydown(e){e.code===mM.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}const xM={move:{name:"pointermove"},end:{name:"pointerup"}};class SM extends EM{constructor(e){const{event:t}=e,r=rN(t.target);super(e,xM,r)}}SM.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!(!r.isPrimary||0!==r.button)&&(null==n||n({event:r}),!0)}}];const kM={move:{name:"mousemove"},end:{name:"mouseup"}};var OM;!function(e){e[e.RightClick=2]="RightClick"}(OM||(OM={}));class IM extends EM{constructor(e){super(e,kM,rN(e.event.target))}}IM.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button!==OM.RightClick&&(null==n||n({event:r}),!0)}}];const RM={move:{name:"touchmove"},end:{name:"touchend"}};var TM,AM;function NM(e){let{acceleration:t,activator:r=TM.Pointer,canScroll:n,draggingRect:i,enabled:o,interval:s=5,order:l=AM.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:f,threshold:p}=e;const h=function(e){let{delta:t,disabled:r}=e;const n=lN(t);return aN((e=>{if(r||!n||!e)return MM;const i={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[rM.Backward]:e.x[rM.Backward]||-1===i.x,[rM.Forward]:e.x[rM.Forward]||1===i.x},y:{[rM.Backward]:e.y[rM.Backward]||-1===i.y,[rM.Forward]:e.y[rM.Forward]||1===i.y}}}),[r,t,n])}({delta:f,disabled:!o}),[m,v]=function(){const e=Object(a.useRef)(null),t=Object(a.useCallback)(((t,r)=>{e.current=setInterval(t,r)}),[]);return[t,Object(a.useCallback)((()=>{null!==e.current&&(clearInterval(e.current),e.current=null)}),[])]}(),g=Object(a.useRef)({x:0,y:0}),y=Object(a.useRef)({x:0,y:0}),b=Object(a.useMemo)((()=>{switch(r){case TM.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case TM.DraggableRect:return i}}),[r,i,c]),w=Object(a.useRef)(null),_=Object(a.useCallback)((()=>{const e=w.current;if(!e)return;const t=g.current.x*y.current.x,r=g.current.y*y.current.y;e.scrollBy(t,r)}),[]),C=Object(a.useMemo)((()=>l===AM.TreeOrder?[...u].reverse():u),[l,u]);Object(a.useEffect)((()=>{if(o&&u.length&&b){for(const e of C){if(!1===(null==n?void 0:n(e)))continue;const r=u.indexOf(e),i=d[r];if(!i)continue;const{direction:o,speed:a}=aM(e,i,b,t,p);for(const e of["x","y"])h[e][o[e]]||(a[e]=0,o[e]=0);if(a.x>0||a.y>0)return v(),w.current=e,m(_,s),g.current=a,void(y.current=o)}g.current={x:0,y:0},y.current={x:0,y:0},v()}else v()}),[t,_,n,v,o,s,JSON.stringify(b),JSON.stringify(h),m,u,C,d,JSON.stringify(p)])}(class extends EM{constructor(e){super(e,RM)}static setup(){return window.addEventListener(RM.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(RM.move.name,e)};function e(){}}}).activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:i}=r;return!(i.length>1)&&(null==n||n({event:r}),!0)}}],function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"}(TM||(TM={})),function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"}(AM||(AM={}));const MM={x:{[rM.Backward]:!1,[rM.Forward]:!1},y:{[rM.Backward]:!1,[rM.Forward]:!1}};var PM,jM;!function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"}(PM||(PM={})),function(e){e.Optimized="optimized"}(jM||(jM={}));const DM=new Map;function FM(e,t){return aN((r=>e?r||("function"==typeof t?t(e):e):null),[t,e])}function VM(e){let{callback:t,disabled:r}=e;const n=iN(t),i=Object(a.useMemo)((()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:e}=window;return new e(n)}),[r]);return Object(a.useEffect)((()=>()=>null==i?void 0:i.disconnect()),[i]),i}function LM(e){return new dM(qN(e),e)}function $M(e,t,r){void 0===t&&(t=LM);const[n,i]=Object(a.useReducer)((function(n){if(!e)return null;var i;if(!1===e.isConnected)return null!=(i=null!=n?n:r)?i:null;const o=t(e);return JSON.stringify(n)===JSON.stringify(o)?n:o}),null),o=function(e){let{callback:t,disabled:r}=e;const n=iN(t),i=Object(a.useMemo)((()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:e}=window;return new e(n)}),[n,r]);return Object(a.useEffect)((()=>()=>null==i?void 0:i.disconnect()),[i]),i}({callback(t){if(e)for(const r of t){const{type:t,target:n}=r;if("childList"===t&&n instanceof HTMLElement&&n.contains(e)){i();break}}}}),s=VM({callback:i});return nN((()=>{i(),e?(null==s||s.observe(e),null==o||o.observe(document.body,{childList:!0,subtree:!0})):(null==s||s.disconnect(),null==o||o.disconnect())}),[e]),n}const BM=[];function zM(e,t){void 0===t&&(t=[]);const r=Object(a.useRef)(null);return Object(a.useEffect)((()=>{r.current=null}),t),Object(a.useEffect)((()=>{const t=e!==AN;t&&!r.current&&(r.current=e),!t&&r.current&&(r.current=null)}),[e]),r.current?pN(e,r.current):AN}function UM(e){return Object(a.useMemo)((()=>e?function(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}(e):null),[e])}const HM=[];function WM(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return tN(t)?t:e}const GM=[{sensor:SM,options:{}},{sensor:wM,options:{}}],KM={current:{}},qM={draggable:{measure:YN},droppable:{measure:YN,strategy:PM.WhileDragging,frequency:jM.Optimized},dragOverlay:{measure:qN}};class YM extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter((e=>{let{disabled:t}=e;return!t}))}getNodeFor(e){var t,r;return null!=(t=null==(r=this.get(e))?void 0:r.node.current)?t:void 0}}const XM={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new YM,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:IN},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:qM,measureDroppableContainers:IN,windowRect:null,measuringScheduled:!1},ZM={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:IN,draggableNodes:new Map,over:null,measureDroppableContainers:IN},JM=Object(a.createContext)(ZM),QM=Object(a.createContext)(XM);function eP(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new YM}}}function tP(e,t){switch(t.type){case ON.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ON.DragMove:return e.draggable.active?{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}}:e;case ON.DragEnd:case ON.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ON.RegisterDroppable:{const{element:r}=t,{id:n}=r,i=new YM(e.droppable.containers);return i.set(n,r),{...e,droppable:{...e.droppable,containers:i}}}case ON.SetDroppableDisabled:{const{id:r,key:n,disabled:i}=t,o=e.droppable.containers.get(r);if(!o||n!==o.key)return e;const a=new YM(e.droppable.containers);return a.set(r,{...o,disabled:i}),{...e,droppable:{...e.droppable,containers:a}}}case ON.UnregisterDroppable:{const{id:r,key:n}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;const o=new YM(e.droppable.containers);return o.delete(r),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function rP(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:i}=Object(a.useContext)(JM),o=lN(n),s=lN(null==r?void 0:r.id);return Object(a.useEffect)((()=>{if(!t&&!n&&o&&null!=s){if(!hN(o)||document.activeElement===o.target)return;const e=i.get(s);if(!e)return;const{activatorNode:t,node:r}=e;if(!t.current&&!r.current)return;requestAnimationFrame((()=>{for(const e of[t.current,r.current]){if(!e)continue;const t=yN(e);if(t){t.focus();break}}}))}}),[n,t,i,s,o]),null}function nP(e,t){let{transform:r,...n}=t;return null!=e&&e.length?e.reduce(((e,t)=>t({transform:e,...n})),r):r}const iP=Object(a.createContext)({...AN,scaleX:1,scaleY:1});var oP;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(oP||(oP={}));const aP=Object(a.memo)((function(e){var t,r,n,i;let{id:o,accessibility:c,autoScroll:u=!0,children:d,sensors:f=GM,collisionDetection:p=BN,measuring:h,modifiers:m,...v}=e;const g=Object(a.useReducer)(tP,void 0,eP),[y,b]=g,[w,_]=function(){const[e]=Object(a.useState)((()=>new Set)),t=Object(a.useCallback)((t=>(e.add(t),()=>e.delete(t))),[e]);return[Object(a.useCallback)((t=>{let{type:r,event:n}=t;e.forEach((e=>{var t;return null==(t=e[r])?void 0:t.call(e,n)}))}),[e]),t]}(),[C,E]=Object(a.useState)(oP.Uninitialized),x=C===oP.Initialized,{draggable:{active:S,nodes:k,translate:O},droppable:{containers:I}}=y,R=S?k.get(S):null,T=Object(a.useRef)({initial:null,translated:null}),A=Object(a.useMemo)((()=>{var e;return null!=S?{id:S,data:null!=(e=null==R?void 0:R.data)?e:KM,rect:T}:null}),[S,R]),N=Object(a.useRef)(null),[M,P]=Object(a.useState)(null),[j,D]=Object(a.useState)(null),F=oN(v,Object.values(v)),V=uN("DndDescribedBy",o),L=Object(a.useMemo)((()=>I.getEnabled()),[I]),$=function(e){return Object(a.useMemo)((()=>({draggable:{...qM.draggable,...null==e?void 0:e.draggable},droppable:{...qM.droppable,...null==e?void 0:e.droppable},dragOverlay:{...qM.dragOverlay,...null==e?void 0:e.dragOverlay}})),[null==e?void 0:e.draggable,null==e?void 0:e.droppable,null==e?void 0:e.dragOverlay])}(h),{droppableRects:B,measureDroppableContainers:z,measuringScheduled:U}=function(e,t){let{dragging:r,dependencies:n,config:i}=t;const[o,s]=Object(a.useState)(null),{frequency:l,measure:c,strategy:u}=i,d=Object(a.useRef)(e),f=function(){switch(u){case PM.Always:return!1;case PM.BeforeDragging:return r;default:return!r}}(),p=oN(f),h=Object(a.useCallback)((function(e){void 0===e&&(e=[]),!p.current&&s((t=>null===t?e:t.concat(e.filter((e=>!t.includes(e))))))}),[p]),m=Object(a.useRef)(null),v=aN((t=>{if(f&&!r)return DM;if(!t||t===DM||d.current!==e||null!=o){const t=new Map;for(let r of e){if(!r)continue;if(o&&o.length>0&&!o.includes(r.id)&&r.rect.current){t.set(r.id,r.rect.current);continue}const e=r.node.current,n=e?new dM(c(e),e):null;r.rect.current=n,n&&t.set(r.id,n)}return t}return t}),[e,o,r,f,c]);return Object(a.useEffect)((()=>{d.current=e}),[e]),Object(a.useEffect)((()=>{f||h()}),[r,f]),Object(a.useEffect)((()=>{o&&o.length>0&&s(null)}),[JSON.stringify(o)]),Object(a.useEffect)((()=>{f||"number"!=typeof l||null!==m.current||(m.current=setTimeout((()=>{h(),m.current=null}),l))}),[l,f,h,...n]),{droppableRects:v,measureDroppableContainers:h,measuringScheduled:null!=o}}(L,{dragging:x,dependencies:[O.x,O.y],config:$.droppable}),H=function(e,t){const r=null!==t?e.get(t):void 0,n=r?r.node.current:null;return aN((e=>{var r;return null===t?null:null!=(r=null!=n?n:e)?r:null}),[n,t])}(k,S),W=Object(a.useMemo)((()=>j?mN(j):null),[j]),G=function(){const e=!1===(null==M?void 0:M.autoScrollEnabled),t="object"==typeof u?!1===u.enabled:!1===u,r=x&&!e&&!t;return"object"==typeof u?{...u,enabled:r}:{enabled:r}}(),K=function(e,t){return FM(e,t)}(H,$.draggable.measure);!function(e){let{activeNode:t,measure:r,initialRect:n,config:i=!0}=e;const o=Object(a.useRef)(!1),{x:s,y:l}="boolean"==typeof i?{x:i,y:i}:i;nN((()=>{if(!s&&!l||!t)return void(o.current=!1);if(o.current||!n)return;const e=null==t?void 0:t.node.current;if(!e||!1===e.isConnected)return;const i=UN(r(e),n);if(s||(i.x=0),l||(i.y=0),o.current=!0,Math.abs(i.x)>0||Math.abs(i.y)>0){const t=ZN(e);t&&t.scrollBy({top:i.y,left:i.x})}}),[t,s,l,n,r])}({activeNode:S?k.get(S):null,config:G.layoutShiftCompensation,initialRect:K,measure:$.draggable.measure});const q=$M(H,$.draggable.measure,K),Y=$M(H?H.parentElement:null),X=Object(a.useRef)({activatorEvent:null,active:null,activeNode:H,collisionRect:null,collisions:null,droppableRects:B,draggableNodes:k,draggingNode:null,draggingNodeRect:null,droppableContainers:I,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Z=I.getNodeFor(null==(t=X.current.over)?void 0:t.id),J=function(e){let{measure:t}=e;const[r,n]=Object(a.useState)(null),i=VM({callback:Object(a.useCallback)((e=>{for(const{target:r}of e)if(tN(r)){n((e=>{const n=t(r);return e?{...e,width:n.width,height:n.height}:n}));break}}),[t])}),o=Object(a.useCallback)((e=>{const r=WM(e);null==i||i.disconnect(),r&&(null==i||i.observe(r)),n(r?t(r):null)}),[t,i]),[s,l]=sN(o);return Object(a.useMemo)((()=>({nodeRef:s,rect:r,setRef:l})),[r,s,l])}({measure:$.dragOverlay.measure}),Q=null!=(r=J.nodeRef.current)?r:H,ee=x?null!=(n=J.rect)?n:q:null,te=Boolean(J.nodeRef.current&&J.rect),re=function(e){return UN(e,FM(e))}(te?null:q),ne=UM(Q?QA(Q):null),ie=function(e){const t=Object(a.useRef)(e),r=aN((r=>e?r&&r!==BM&&e&&t.current&&e.parentNode===t.current.parentNode?r:XN(e):BM),[e]);return Object(a.useEffect)((()=>{t.current=e}),[e]),r}(x?null!=Z?Z:H:null),oe=function(e,t){void 0===t&&(t=qN);const[r]=e,n=UM(r?QA(r):null),[i,o]=Object(a.useReducer)((function(){return e.length?e.map((e=>nM(e)?n:new dM(t(e),e))):HM}),HM),s=VM({callback:o});return e.length>0&&i===HM&&o(),nN((()=>{e.length?e.forEach((e=>null==s?void 0:s.observe(e))):(null==s||s.disconnect(),o())}),[e]),i}(ie),ae=nP(m,{transform:{x:O.x-re.x,y:O.y-re.y,scaleX:1,scaleY:1},activatorEvent:j,active:A,activeNodeRect:q,containerNodeRect:Y,draggingNodeRect:ee,over:X.current.over,overlayNodeRect:J.rect,scrollableAncestors:ie,scrollableAncestorRects:oe,windowRect:ne}),se=W?fN(W,O):null,le=function(e){const[t,r]=Object(a.useState)(null),n=Object(a.useRef)(e),i=Object(a.useCallback)((e=>{const t=JN(e.target);!t||r((e=>e?(e.set(t,tM(t)),new Map(e)):null))}),[]);return Object(a.useEffect)((()=>{const t=n.current;if(e!==t){o(t);const a=e.map((e=>{const t=JN(e);return t?(t.addEventListener("scroll",i,{passive:!0}),[t,tM(t)]):null})).filter((e=>null!=e));r(a.length?new Map(a):null),n.current=e}return()=>{o(e),o(t)};function o(e){e.forEach((e=>{const t=JN(e);null==t||t.removeEventListener("scroll",i)}))}}),[i,e]),Object(a.useMemo)((()=>e.length?t?Array.from(t.values()).reduce(((e,t)=>fN(e,t)),AN):lM(e):AN),[e,t])}(ie),ce=zM(le),ue=zM(le,[q]),de=fN(ae,ce),fe=ee?WN(ee,ae):null,pe=A&&fe?p({active:A,collisionRect:fe,droppableRects:B,droppableContainers:L,pointerCoordinates:se}):null,he=FN(pe,"id"),[me,ve]=Object(a.useState)(null),ge=function(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}(te?ae:fN(ae,ue),null!=(i=null==me?void 0:me.rect)?i:null,q),ye=Object(a.useCallback)(((e,t)=>{let{sensor:r,options:n}=t;if(null==N.current)return;const i=k.get(N.current);if(!i)return;const o=e.nativeEvent,a=new r({active:N.current,activeNode:i,event:o,options:n,context:X,onStart(e){const t=N.current;if(null==t)return;const r=k.get(t);if(!r)return;const{onDragStart:n}=F.current,i={active:{id:t,data:r.data,rect:T}};Object(l.unstable_batchedUpdates)((()=>{null==n||n(i),E(oP.Initializing),b({type:ON.DragStart,initialCoordinates:e,active:t}),w({type:"onDragStart",event:i})}))},onMove(e){b({type:ON.DragMove,coordinates:e})},onEnd:s(ON.DragEnd),onCancel:s(ON.DragCancel)});function s(e){return async function(){const{active:t,collisions:r,over:n,scrollAdjustedTranslate:i}=X.current;let a=null;if(t&&i){const{cancelDrop:s}=F.current;a={activatorEvent:o,active:t,collisions:r,delta:i,over:n},e===ON.DragEnd&&"function"==typeof s&&await Promise.resolve(s(a))&&(e=ON.DragCancel)}N.current=null,Object(l.unstable_batchedUpdates)((()=>{b({type:e}),E(oP.Uninitialized),ve(null),P(null),D(null);const t=e===ON.DragEnd?"onDragEnd":"onDragCancel";if(a){const e=F.current[t];null==e||e(a),w({type:t,event:a})}}))}}Object(l.unstable_batchedUpdates)((()=>{P(a),D(e.nativeEvent)}))}),[k]),be=function(e,t){return Object(a.useMemo)((()=>e.reduce(((e,r)=>{const{sensor:n}=r;return[...e,...n.activators.map((e=>({eventName:e.eventName,handler:t(e.handler,r)})))]}),[])),[e,t])}(f,Object(a.useCallback)(((e,t)=>(r,n)=>{const i=r.nativeEvent,o=k.get(n);if(null!==N.current||!o||i.dndKit||i.defaultPrevented)return;const a={active:o};!0===e(r,t.options,a)&&(i.dndKit={capturedBy:t.sensor},N.current=n,ye(r,t))}),[k,ye]));(function(e){Object(a.useEffect)((()=>{if(!XA)return;const t=e.map((e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()}));return()=>{for(const e of t)null==e||e()}}),e.map((e=>{let{sensor:t}=e;return t})))})(f),nN((()=>{q&&C===oP.Initializing&&E(oP.Initialized)}),[q,C]),Object(a.useEffect)((()=>{const{onDragMove:e}=F.current,{active:t,activatorEvent:r,collisions:n,over:i}=X.current;if(!t||!r)return;const o={active:t,activatorEvent:r,collisions:n,delta:{x:de.x,y:de.y},over:i};Object(l.unstable_batchedUpdates)((()=>{null==e||e(o),w({type:"onDragMove",event:o})}))}),[de.x,de.y]),Object(a.useEffect)((()=>{const{active:e,activatorEvent:t,collisions:r,droppableContainers:n,scrollAdjustedTranslate:i}=X.current;if(!e||null==N.current||!t||!i)return;const{onDragOver:o}=F.current,a=n.get(he),s=a&&a.rect.current?{id:a.id,rect:a.rect.current,data:a.data,disabled:a.disabled}:null,c={active:e,activatorEvent:t,collisions:r,delta:{x:i.x,y:i.y},over:s};Object(l.unstable_batchedUpdates)((()=>{ve(s),null==o||o(c),w({type:"onDragOver",event:c})}))}),[he]),nN((()=>{X.current={activatorEvent:j,active:A,activeNode:H,collisionRect:fe,collisions:pe,droppableRects:B,draggableNodes:k,draggingNode:Q,draggingNodeRect:ee,droppableContainers:I,over:me,scrollableAncestors:ie,scrollAdjustedTranslate:de},T.current={initial:ee,translated:fe}}),[A,H,pe,fe,k,Q,ee,B,I,me,ie,de]),NM({...G,delta:O,draggingRect:fe,pointerCoordinates:se,scrollableAncestors:ie,scrollableAncestorRects:oe});const we=Object(a.useMemo)((()=>({active:A,activeNode:H,activeNodeRect:q,activatorEvent:j,collisions:pe,containerNodeRect:Y,dragOverlay:J,draggableNodes:k,droppableContainers:I,droppableRects:B,over:me,measureDroppableContainers:z,scrollableAncestors:ie,scrollableAncestorRects:oe,measuringConfiguration:$,measuringScheduled:U,windowRect:ne})),[A,H,q,j,pe,Y,J,k,I,B,me,z,ie,oe,$,U,ne]),_e=Object(a.useMemo)((()=>({activatorEvent:j,activators:be,active:A,activeNodeRect:q,ariaDescribedById:{draggable:V},dispatch:b,draggableNodes:k,over:me,measureDroppableContainers:z})),[j,be,A,q,b,V,k,me,z]);return s.a.createElement(EN.Provider,{value:_},s.a.createElement(JM.Provider,{value:_e},s.a.createElement(QM.Provider,{value:we},s.a.createElement(iP.Provider,{value:ge},d)),s.a.createElement(rP,{disabled:!1===(null==c?void 0:c.restoreFocus)})),s.a.createElement(kN,{...c,hiddenTextDescribedById:V}))})),sP=Object(a.createContext)(null),lP="button",cP="Droppable";function uP(e){let{id:t,data:r,disabled:n=!1,attributes:i}=e;const o=uN(cP),{activators:s,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:f,over:p}=Object(a.useContext)(JM),{role:h=lP,roleDescription:m="draggable",tabIndex:v=0}=null!=i?i:{},g=(null==c?void 0:c.id)===t,y=Object(a.useContext)(g?iP:sP),[b,w]=sN(),[_,C]=sN(),E=function(e,t){return Object(a.useMemo)((()=>e.reduce(((e,r)=>{let{eventName:n,handler:i}=r;return e[n]=e=>{i(e,t)},e}),{})),[e,t])}(s,t),x=oN(r);nN((()=>(f.set(t,{id:t,key:o,node:b,activatorNode:_,data:x}),()=>{const e=f.get(t);e&&e.key===o&&f.delete(t)})),[f,t]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:Object(a.useMemo)((()=>({role:h,tabIndex:v,"aria-disabled":n,"aria-pressed":!(!g||h!==lP)||void 0,"aria-roledescription":m,"aria-describedby":d.draggable})),[n,h,v,g,m,d.draggable]),isDragging:g,listeners:n?void 0:E,node:b,over:p,setNodeRef:w,setActivatorNodeRef:C,transform:y}}function dP(){return Object(a.useContext)(QM)}const fP="Droppable",pP={timeout:25};function hP(e){let{animation:t,children:r}=e;const[n,i]=Object(a.useState)(null),[o,l]=Object(a.useState)(null),c=lN(r);return!r&&!n&&c&&i(c),nN((()=>{if(!o)return;const e=null==n?void 0:n.key,r=null==n?void 0:n.props.id;null!=e&&null!=r?Promise.resolve(t(r,o)).then((()=>{i(null)})):i(null)}),[t,n,o]),s.a.createElement(s.a.Fragment,null,r,n?Object(a.cloneElement)(n,{ref:l}):null)}const mP={x:0,y:0,scaleX:1,scaleY:1};function vP(e){let{children:t}=e;return s.a.createElement(JM.Provider,{value:ZM},s.a.createElement(iP.Provider,{value:mP},t))}const gP={position:"fixed",touchAction:"none"},yP=e=>hN(e)?"transform 250ms ease":void 0,bP=Object(a.forwardRef)(((e,t)=>{let{as:r,activatorEvent:n,adjustScale:i,children:o,className:a,rect:l,style:c,transform:u,transition:d=yP}=e;if(!l)return null;const f=i?u:{...u,scaleX:1,scaleY:1},p={...gP,width:l.width,height:l.height,top:l.top,left:l.left,transform:vN.Transform.toString(f),transformOrigin:i&&n?MN(n,l):void 0,transition:"function"==typeof d?d(n):d,...c};return s.a.createElement(r,{className:a,style:p,ref:t},o)})),wP=e=>t=>{let{active:r,dragOverlay:n}=t;const i={},{styles:o,className:a}=e;if(null!=o&&o.active)for(const[e,t]of Object.entries(o.active))void 0!==t&&(i[e]=r.node.style.getPropertyValue(e),r.node.style.setProperty(e,t));if(null!=o&&o.dragOverlay)for(const[e,t]of Object.entries(o.dragOverlay))void 0!==t&&n.node.style.setProperty(e,t);return null!=a&&a.active&&r.node.classList.add(a.active),null!=a&&a.dragOverlay&&n.node.classList.add(a.dragOverlay),function(){for(const[e,t]of Object.entries(i))r.node.style.setProperty(e,t);null!=a&&a.active&&r.node.classList.remove(a.active)}},_P={duration:250,easing:"ease",keyframes:e=>{let{transform:{initial:t,final:r}}=e;return[{transform:vN.Transform.toString(t)},{transform:vN.Transform.toString(r)}]},sideEffects:wP({styles:{active:{opacity:"0"}}})};function CP(e){let{config:t,draggableNodes:r,droppableContainers:n,measuringConfiguration:i}=e;return iN(((e,o)=>{if(null===t)return;const a=r.get(e);if(!a)return;const s=a.node.current;if(!s)return;const l=WM(o);if(!l)return;const{transform:c}=QA(o).getComputedStyle(o),u=GN(c);if(!u)return;const d="function"==typeof t?t:function(e){const{duration:t,easing:r,sideEffects:n,keyframes:i}={..._P,...e};return e=>{let{active:o,dragOverlay:a,transform:s,...l}=e;if(!t)return;const c={x:a.rect.left-o.rect.left,y:a.rect.top-o.rect.top},u={scaleX:1!==s.scaleX?o.rect.width*s.scaleX/a.rect.width:1,scaleY:1!==s.scaleY?o.rect.height*s.scaleY/a.rect.height:1},d={x:s.x-c.x,y:s.y-c.y,...u},f=i({...l,active:o,dragOverlay:a,transform:{initial:s,final:d}}),[p]=f,h=f[f.length-1];if(JSON.stringify(p)===JSON.stringify(h))return;const m=null==n?void 0:n({active:o,dragOverlay:a,...l}),v=a.node.animate(f,{duration:t,easing:r,fill:"forwards"});return new Promise((e=>{v.onfinish=()=>{null==m||m(),e()}}))}}(t);return cM(s,i.draggable.measure),d({active:{id:e,data:a.data,node:s,rect:i.draggable.measure(s)},draggableNodes:r,dragOverlay:{node:o,rect:i.dragOverlay.measure(l)},droppableContainers:n,measuringConfiguration:i,transform:u})}))}let EP=0;const xP=s.a.memo((e=>{let{adjustScale:t=!1,children:r,dropAnimation:n,style:i,transition:o,modifiers:l,wrapperElement:c="div",className:u,zIndex:d=999}=e;const{activatorEvent:f,active:p,activeNodeRect:h,containerNodeRect:m,draggableNodes:v,droppableContainers:g,dragOverlay:y,over:b,measuringConfiguration:w,scrollableAncestors:_,scrollableAncestorRects:C,windowRect:E}=dP(),x=Object(a.useContext)(iP),S=function(e){return Object(a.useMemo)((()=>{if(null!=e)return EP++,EP}),[e])}(null==p?void 0:p.id),k=nP(l,{activatorEvent:f,active:p,activeNodeRect:h,containerNodeRect:m,draggingNodeRect:y.rect,over:b,overlayNodeRect:y.rect,scrollableAncestors:_,scrollableAncestorRects:C,transform:x,windowRect:E}),O=FM(h),I=CP({config:n,draggableNodes:v,droppableContainers:g,measuringConfiguration:w}),R=O?y.setRef:void 0;return s.a.createElement(vP,null,s.a.createElement(hP,{animation:I},p&&S?s.a.createElement(bP,{key:S,id:p.id,ref:R,as:c,activatorEvent:f,adjustScale:t,className:u,transition:o,rect:O,style:{zIndex:d,...i},transform:k},r):null))}));function SP(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function kP(e,t){return e.reduce(((e,r,n)=>{const i=t.get(r);return i&&(e[n]=i),e}),Array(e.length))}function OP(e){return null!==e&&e>=0}const IP={scaleX:1,scaleY:1},RP=e=>{var t;let{rects:r,activeNodeRect:n,activeIndex:i,overIndex:o,index:a}=e;const s=null!=(t=r[i])?t:n;if(!s)return null;const l=function(e,t,r){const n=e[t],i=e[t-1],o=e[t+1];return n&&(i||o)?r<t?i?n.left-(i.left+i.width):o.left-(n.left+n.width):o?o.left-(n.left+n.width):n.left-(i.left+i.width):0}(r,a,i);if(a===i){const e=r[o];return e?{x:i<o?e.left+e.width-(s.left+s.width):e.left-s.left,y:0,...IP}:null}return a>i&&a<=o?{x:-s.width-l,y:0,...IP}:a<i&&a>=o?{x:s.width+l,y:0,...IP}:{x:0,y:0,...IP}};const TP=e=>{let{rects:t,activeIndex:r,overIndex:n,index:i}=e;const o=SP(t,n,r),a=t[i],s=o[i];return s&&a?{x:s.left-a.left,y:s.top-a.top,scaleX:s.width/a.width,scaleY:s.height/a.height}:null},AP={scaleX:1,scaleY:1},NP=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:i,rects:o,overIndex:a}=e;const s=null!=(t=o[r])?t:n;if(!s)return null;if(i===r){const e=o[a];return e?{x:0,y:r<a?e.top+e.height-(s.top+s.height):e.top-s.top,...AP}:null}const l=function(e,t,r){const n=e[t],i=e[t-1],o=e[t+1];return n?r<t?i?n.top-(i.top+i.height):o?o.top-(n.top+n.height):0:o?o.top-(n.top+n.height):i?n.top-(i.top+i.height):0:0}(o,i,r);return i>r&&i<=a?{x:0,y:-s.height-l,...AP}:i<r&&i>=a?{x:0,y:s.height+l,...AP}:{x:0,y:0,...AP}};const MP="Sortable",PP=s.a.createContext({activeIndex:-1,containerId:MP,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:TP,disabled:{draggable:!1,droppable:!1}});function jP(e){let{children:t,id:r,items:n,strategy:i=TP,disabled:o=!1}=e;const{active:l,dragOverlay:c,droppableRects:u,over:d,measureDroppableContainers:f}=dP(),p=uN(MP,r),h=Boolean(null!==c.rect),m=Object(a.useMemo)((()=>n.map((e=>"object"==typeof e&&"id"in e?e.id:e))),[n]),v=null!=l,g=l?m.indexOf(l.id):-1,y=d?m.indexOf(d.id):-1,b=Object(a.useRef)(m),w=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(m,b.current),_=-1!==y&&-1===g||w,C=function(e){return"boolean"==typeof e?{draggable:e,droppable:e}:e}(o);nN((()=>{w&&v&&f(m)}),[w,m,v,f]),Object(a.useEffect)((()=>{b.current=m}),[m]);const E=Object(a.useMemo)((()=>({activeIndex:g,containerId:p,disabled:C,disableTransforms:_,items:m,overIndex:y,useDragOverlay:h,sortedRects:kP(m,u),strategy:i})),[g,p,C.draggable,C.droppable,_,m,y,u,h,i]);return s.a.createElement(PP.Provider,{value:E},t)}const DP=e=>{let{id:t,items:r,activeIndex:n,overIndex:i}=e;return SP(r,n,i).indexOf(t)},FP=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:i,items:o,newIndex:a,previousItems:s,previousContainerId:l,transition:c}=e;return!(!c||!n||s!==o&&i===a)&&(!!r||a!==i&&t===l)},VP={duration:200,easing:"ease"},LP="transform",$P=vN.Transition.toString({property:LP,duration:0,easing:"linear"}),BP={roleDescription:"sortable"};function zP(e){let{animateLayoutChanges:t=FP,attributes:r,disabled:n,data:i,getNewIndex:o=DP,id:s,strategy:l,resizeObserverConfig:c,transition:u=VP}=e;const{items:d,containerId:f,activeIndex:p,disabled:h,disableTransforms:m,sortedRects:v,overIndex:g,useDragOverlay:y,strategy:b}=Object(a.useContext)(PP),w=function(e,t){var r,n;return"boolean"==typeof e?{draggable:e,droppable:!1}:{draggable:null!=(r=null==e?void 0:e.draggable)?r:t.draggable,droppable:null!=(n=null==e?void 0:e.droppable)?n:t.droppable}}(n,h),_=d.indexOf(s),C=Object(a.useMemo)((()=>({sortable:{containerId:f,index:_,items:d},...i})),[f,i,_,d]),E=Object(a.useMemo)((()=>d.slice(d.indexOf(s))),[d,s]),{rect:x,node:S,isOver:k,setNodeRef:O}=function(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:i}=e;const o=uN(fP),{active:s,dispatch:l,over:c,measureDroppableContainers:u}=Object(a.useContext)(JM),d=Object(a.useRef)({disabled:r}),f=Object(a.useRef)(!1),p=Object(a.useRef)(null),h=Object(a.useRef)(null),{disabled:m,updateMeasurementsFor:v,timeout:g}={...pP,...i},y=oN(null!=v?v:n),b=VM({callback:Object(a.useCallback)((()=>{f.current?(null!=h.current&&clearTimeout(h.current),h.current=setTimeout((()=>{u(Array.isArray(y.current)?y.current:[y.current]),h.current=null}),g)):f.current=!0}),[g]),disabled:m||!s}),w=Object(a.useCallback)(((e,t)=>{!b||(t&&(b.unobserve(t),f.current=!1),e&&b.observe(e))}),[b]),[_,C]=sN(w),E=oN(t);return Object(a.useEffect)((()=>{!b||!_.current||(b.disconnect(),f.current=!1,b.observe(_.current))}),[_,b]),nN((()=>(l({type:ON.RegisterDroppable,element:{id:n,key:o,disabled:r,node:_,rect:p,data:E}}),()=>l({type:ON.UnregisterDroppable,key:o,id:n}))),[n]),Object(a.useEffect)((()=>{r!==d.current.disabled&&(l({type:ON.SetDroppableDisabled,id:n,key:o,disabled:r}),d.current.disabled=r)}),[n,o,r,l]),{active:s,rect:p,isOver:(null==c?void 0:c.id)===n,node:_,over:c,setNodeRef:C}}({id:s,data:C,disabled:w.droppable,resizeObserverConfig:{updateMeasurementsFor:E,...c}}),{active:I,activatorEvent:R,activeNodeRect:T,attributes:A,setNodeRef:N,listeners:M,isDragging:P,over:j,setActivatorNodeRef:D,transform:F}=uP({id:s,data:C,attributes:{...BP,...r},disabled:w.draggable}),V=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Object(a.useMemo)((()=>e=>{t.forEach((t=>t(e)))}),t)}(O,N),L=Boolean(I),$=L&&!m&&OP(p)&&OP(g),B=!y&&P,z=B&&$?F:null,U=$?null!=z?z:(null!=l?l:b)({rects:v,activeNodeRect:T,activeIndex:p,overIndex:g,index:_}):null,H=OP(p)&&OP(g)?o({id:s,items:d,activeIndex:p,overIndex:g}):_,W=null==I?void 0:I.id,G=Object(a.useRef)({activeId:W,items:d,newIndex:H,containerId:f}),K=d!==G.current.items,q=t({active:I,containerId:f,isDragging:P,isSorting:L,id:s,index:_,items:d,newIndex:G.current.newIndex,previousItems:G.current.items,previousContainerId:G.current.containerId,transition:u,wasDragging:null!=G.current.activeId}),Y=function(e){let{disabled:t,index:r,node:n,rect:i}=e;const[o,s]=Object(a.useState)(null),l=Object(a.useRef)(r);return nN((()=>{if(!t&&r!==l.current&&n.current){const e=i.current;if(e){const t=qN(n.current,{ignoreTransform:!0}),r={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(r.x||r.y)&&s(r)}}r!==l.current&&(l.current=r)}),[t,r,n,i]),Object(a.useEffect)((()=>{o&&s(null)}),[o]),o}({disabled:!q,index:_,node:S,rect:x});return Object(a.useEffect)((()=>{L&&G.current.newIndex!==H&&(G.current.newIndex=H),f!==G.current.containerId&&(G.current.containerId=f),d!==G.current.items&&(G.current.items=d)}),[L,H,f,d]),Object(a.useEffect)((()=>{if(W===G.current.activeId)return;if(W&&!G.current.activeId)return void(G.current.activeId=W);const e=setTimeout((()=>{G.current.activeId=W}),50);return()=>clearTimeout(e)}),[W]),{active:I,activeIndex:p,attributes:A,data:C,rect:x,index:_,newIndex:H,items:d,isOver:k,isSorting:L,isDragging:P,listeners:M,node:S,overIndex:g,over:j,setNodeRef:V,setActivatorNodeRef:D,setDroppableNodeRef:O,setDraggableNodeRef:N,transform:null!=Y?Y:U,transition:function(){if(Y||K&&G.current.newIndex===_)return $P;if((!B||hN(R))&&u&&(L||q))return vN.Transition.toString({...u,property:LP})}()}}mM.Down,mM.Right,mM.Up,mM.Left;const UP=e=>{let{transform:t}=e;return{...t,y:0}};function HP(e,t,r){const n={...e};return t.top+e.y<=r.top?n.y=r.top-t.top:t.bottom+e.y>=r.top+r.height&&(n.y=r.top+r.height-t.bottom),t.left+e.x<=r.left?n.x=r.left-t.left:t.right+e.x>=r.left+r.width&&(n.x=r.left+r.width-t.right),n}const WP=e=>{let{containerNodeRect:t,draggingNodeRect:r,transform:n}=e;return r&&t?HP(n,r,t):n},GP=e=>{let{draggingNodeRect:t,transform:r,scrollableAncestorRects:n}=e;const i=n[0];return t&&i?HP(r,t,i):r},KP=e=>{let{transform:t}=e;return{...t,x:0}},qP={CommentBubble:M.default,Edit:P.default,Delete:j.default,ReviewArrowRight:D.default,MoreHorizontal:F.default,ArrowDown:V.default,ArrowUp:L.default,ArrowRight:$.default,ArrowLeft:B.default,Addlink:z.default,Add:U.default,Check:H.default,Question:W.default,Close:G.default,Drag:K.default,Preview:q.default,Download:Y.default,EditorPaste:X.default,FieldText:Z.default,FieldSelect:J.default,FieldMultiSelect:Q.default,FieldEmail:ee.default,FieldInput:te.default,FieldFile:re.default,FieldImage:ne.default,FieldLink:ie.default,FieldCreator:oe.default,FieldModifier:ae.default,FieldNumber:se.default,FieldMention:le.default,FieldPhone:ce.default,FieldCheckbox:ue.default,FieldDate:de.default,FieldCreatedAt:fe.default,FieldUpdatedAt:pe.default,RowExpand:he.default,RowCollpse:me.default,Search:ve.default,UpArrow:ge.default,DownArrow:ye.default,RightArrow:be.default,LeftArrow:we.default,IconHide:_e.default,RowHeightLow:Ce.default,RowHeightMiddle:Ee.default,RowHeightHigh:xe.default,GridView:Se.default,CardView:ke.default,KanbanView:Oe.default,Clear:Ie.default,ViewerFilter:Re.default,ViewerSort:Te.default,ViewerGroup:Ae.default,Setting:Ne.default,ReviewArrowDown:Me.default,Fullscreen:Pe.default,FullWidth:je.default,NormalWidth:De.default,FormView:Fe.default,Copy:Ve.default,FileDefault:Le.default,FileDefaultDark:$e.default,FileAi:Be.default,FileAiDark:ze.default,FileExcel:Ue.default,FileExcelDark:He.default,FileAudio:We.default,FileAudioDark:Ge.default,FileAxure:Ke.default,FileAxureDark:qe.default,FileDoc:Ye.default,FileDocDark:Xe.default,FileGraffle:Ze.default,FileGraffleDark:Je.default,FileImage:Qe.default,FileImageDark:et.default,FileKeynote:tt.default,FileKeynoteDark:rt.default,FileMindmap:nt.default,FileMindmapDark:it.default,FileMindnode:ot.default,FileMindnodeDark:at.default,FileXmind:st.default,FileXmindDark:lt.default,FileTxt:ct.default,FileTxtDark:ut.default,FileNumbers:dt.default,FileNumbersDark:ft.default,FileFolder:pt.default,FileFolderDark:ht.default,FilePdf:mt.default,FilePdfDark:vt.default,FilePpt:gt.default,FilePptDark:yt.default,FilePsd:bt.default,FilePsdDark:wt.default,FileRar:_t.default,FileRarDark:Ct.default,FileSheet:Et.default,FileSheetDark:xt.default,FileSketch:St.default,FileSketchDark:kt.default,FileVideo:Ot.default,FileVideoDark:It.default,FileWord:Rt.default,FileWordDark:Tt.default,Loading:At.default,Upload:Nt.default,NavBuildarea:Mt.default,NavDay:Pt.default,NavNight:jt.default,Change:Dt.default};const YP=e=>{let{type:t,size:r,className:n,...i}=e;if(!t)return null;const o=qP[t];if(!o)return null;r=function(e,t){return"FormView"===e&&t&&(t+=1),t}(t,r);const a={type:t,...i};return r&&(a.width=+r,a.height=+r),s.a.createElement("span",{className:`larkui-icon-wrap larkui-icon-wrap-${t} ${n||""}`},s.a.createElement(o,{...a}))},XP=e=>{const{ext:t,...r}=e,n=zA(WS),i="dark"===(null==n?void 0:n.getCurrent()),o="File"+xA(e.ext);let a=o;return i&&(a=o+"Dark"),s.a.createElement(YP,{type:a,...r})},ZP=({menu:e,readonly:t,defaultSelectedKeys:r=[],editingKey:n,visibleKey:i,settingVisible:o,onDoubleClick:a,onClick:l,onInputBlur:c,handleVisibleChange:p})=>s.a.createElement(d.a.Item,{key:e.key,eventKey:e.key,icon:e.icon,onDoubleClick:t=>{t.key=e.key,a(t)},onClick:()=>{l(e)},className:GA({"lakex-table-menu-item-selected":r.includes(e.key),"lakex-table-menu-item-multi-line":e.desc})},e.key===n?s.a.createElement(u.a,{className:"lakex-table-menu-configs-input",defaultValue:e.title,autoFocus:!0,onKeyDown:t=>{var r;t.stopPropagation();const n=t.keyCode;27!==n?13===n&&(null==(r=e.onTitleChange)||r.call(e,t,e)):c&&c()},onClick:e=>e.stopPropagation(),onBlur:t=>{var r;return null==(r=e.onTitleChange)?void 0:r.call(e,t,e)}}):s.a.createElement("div",null,e.title,e.desc&&s.a.createElement("div",{className:"lakex-table-menu-configs-desc"},e.desc)),e.settings&&!t&&s.a.createElement(f.a,{overlayClassName:"lakex-table-menu-container lakex-table-menu-configs-settings",content:s.a.createElement(d.a,{onClick:(...t)=>{e.onSettingClick&&e.onSettingClick(e,...t),p(!1,e)}},e.settings.map(((e,r)=>s.a.createElement(ZP,{key:r,readonly:t,menu:e,editingKey:n,visibleKey:i,settingVisible:o,onDoubleClick:a,onClick:l,onInputBlur:c,handleVisibleChange:p})))),trigger:"click",placement:"rightTop",visible:i===e.key&&o,onClick:e=>e.stopPropagation(),onVisibleChange:t=>p(t,e)},s.a.createElement(YP,{type:"MoreHorizontal",size:14})),e.showActiveIcon&&s.a.createElement(YP,{type:"Check",size:14})),JP=({menu:e,index:t,readonly:r,defaultSelectedKeys:n=[],editingKey:i,visibleKey:o,settingVisible:a,onDoubleClick:l,onClick:c,onInputBlur:u,handleVisibleChange:f})=>{const p=e.key?e.key+t:t;let h=e.children;if(e.groupBy){const t=e.children.reduce(((t,r)=>{const n=r[e.groupBy];return t[n]||(t[n]=[]),t[n].push(r),t}),{});Object.values(t).length>1&&(h=t)}return s.a.createElement(d.a.SubMenu,{key:p,eventKey:p,icon:e.icon,title:s.a.createElement("span",{className:"lakex-table-menu-item-title"},s.a.createElement("span",null,e.title),s.a.createElement($.default,{width:16,height:16})),popupClassName:`lakex-table-menu-container lakex-table-menu-configs-submenu ${e.className}`},Array.isArray(h)?h.map(((e,t)=>s.a.createElement(ZP,{key:t,readonly:r,menu:e,defaultSelectedKeys:n,editingKey:i,visibleKey:o,settingVisible:a,onDoubleClick:l,onClick:c,onInputBlur:u,handleVisibleChange:f}))):Object.keys(h).map((e=>s.a.createElement(d.a.ItemGroup,{key:e,title:e},h[e].map(((e,t)=>s.a.createElement(ZP,{key:t,readonly:r,menu:e,defaultSelectedKeys:n,editingKey:i,visibleKey:o,settingVisible:a,onDoubleClick:l,onClick:c,onInputBlur:u,handleVisibleChange:f})))))))},QP=({menu:e,readonly:t,defaultSelectedKeys:r=[],editingKey:n,visibleKey:i,settingVisible:o,onDoubleClick:a,onClick:l,onInputBlur:c,handleVisibleChange:u})=>{const{attributes:d,listeners:f,setNodeRef:p,transform:h,transition:m,isDragging:v}=zP({id:e.key}),g={transform:vN.Transform.toString(h),transition:m,zIndex:v?"100":"auto",opacity:v?.3:1};return s.a.createElement("div",{key:e.key,ref:p,style:{...g},...f,...d},s.a.createElement(ZP,{key:e.key,readonly:t,menu:e,defaultSelectedKeys:r,editingKey:n,visibleKey:i,settingVisible:o,onDoubleClick:a,onClick:l,onInputBlur:c,handleVisibleChange:u}))},ej=({readonly:e,configs:t,defaultSelectedKeys:r,draggable:n=!1,editingKey:i,visibleKey:o,settingVisible:l,onClick:c,onDoubleClick:u,onDragEnd:d,onInputBlur:f,handleVisibleChange:p})=>{const h=TN(RN(SM,{activationConstraint:{distance:8}})),m=t.map(((t,a)=>{const d=t.key?t.key+a:a;return t.children?s.a.createElement(JP,{key:d,index:a,readonly:e,menu:t,defaultSelectedKeys:r,editingKey:i,visibleKey:o,settingVisible:l,onDoubleClick:u,onClick:c,onInputBlur:f,handleVisibleChange:p}):n?s.a.createElement(QP,{key:d,readonly:e,menu:t,defaultSelectedKeys:r,editingKey:i,visibleKey:o,settingVisible:l,onDoubleClick:u,onClick:c,onInputBlur:f,handleVisibleChange:p}):s.a.createElement(ZP,{key:d,readonly:e,menu:t,defaultSelectedKeys:r,editingKey:i,visibleKey:o,settingVisible:l,onDoubleClick:u,onClick:c,onInputBlur:f,handleVisibleChange:p})})),v=Object(a.useMemo)((()=>t.map((e=>({...e,id:e.key})))),[t]);return n?s.a.createElement(aP,{sensors:h,modifiers:[KP,WP],collisionDetection:LN,onDragEnd:d},s.a.createElement(jP,{items:v,strategy:NP},m)):m},tj=e=>{const{readonly:t=!1,draggable:r,className:n,defaultSelectedKeys:i,menuKey:o,onDragEnd:l,onInputBlur:c}=e,{state:u,onClick:f,onDoubleClick:p,handleVisibleChange:h}=(e=>{const t=Object(a.useRef)(null),r=Object(a.useRef)(!1),[n,i]=Object(a.useState)(e.configs),[o,s]=Object(a.useState)(!1),[l,c]=Object(a.useState)(""),[u,d]=Object(a.useState)(e.editingKey||"");return Object(a.useEffect)((()=>{d(e.editingKey)}),[e.editingKey]),Object(a.useEffect)((()=>{i(e.configs)}),[e.configs]),{state:{configs:n,settingVisible:o,visibleKey:l,editingKey:u},timer:t,prevent:r,delay:200,handleVisibleChange:(e,t)=>{s(e),c(e?t.key:"")},onClick:n=>{e.onDoubleClick?t.current=setTimeout((()=>{r.current||null==e||e.onClick(n)}),200):null==e||e.onClick(n)},onDoubleClick:n=>{clearTimeout(t.current),r.current=!0,null==e||e.onDoubleClick(n),setTimeout((()=>{r.current=!1}),200)}}})(e),{configs:m,editingKey:v,visibleKey:g,settingVisible:y}=u;return s.a.createElement(d.a,{className:`lakex-table-menu-configs ${n}`,mode:"vertical",defaultSelectedKeys:i,key:o},s.a.createElement(ej,{readonly:t,configs:m,draggable:r,defaultSelectedKeys:i,editingKey:v,visibleKey:g,settingVisible:y,onClick:f,onDoubleClick:p,onDragEnd:l,onInputBlur:c,handleVisibleChange:h}))};class rj extends s.a.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){var r,n;null==(n=(r=this.props).onError)||n.call(r,e,t)}render(){return this.props.children}}const nj=({src:e,darkSrc:t,width:r,height:n,theme:i,style:o,darkAlpha:l,className:c,children:u,...d})=>{r=r||(null==o?void 0:o.width),n=n||(null==o?void 0:o.height);const f=zA(WS),[p,h]=s.a.useState(i||(null==f?void 0:f.getCurrent())),[m,v]=s.a.useState(p===N.Theme.dark?t:e);if(Object(a.useEffect)((()=>{null==f||f.onChange((r=>{h(r),v(r===N.Theme.dark?t:e)}))}),[]),!m)return null;const g={width:r,height:n,...o};return g.backgroundImage=`url(${m})`,p===N.Theme.dark&&l&&(g.opacity=l),u?s.a.createElement("div",{className:GA("lakex-table-image",c),style:g,...d},u):(delete g.backgroundImage,s.a.createElement("img",{src:m,className:GA("lakex-table-image",c),style:g,...d}))};nj.displayName="Image";var ij=(e=>(e.Unauthorized="401",e.Forbidden="403",e.Notfound="404",e))(ij||{});const oj=e=>s.a.createElement("div",{className:"lakex-table-view-permission-401"},s.a.createElement("img",{className:"lakex-table-view-permission-img",src:"https://mdn.alipayobjects.com/huamei_0prmtq/afts/img/A*hPb5R6QBhj4AAAAAAAAAAAAADvuFAQ/original"}),s.a.createElement("h2",{className:"lakex-table-view-permission-title"},kf("无权访问当前视图")),s.a.createElement("div",{className:"lakex-table-view-permission-desc"},e.desc||kf("查看视图需要编辑权限"))),aj=e=>{let t;return"401"===e.type&&(t=s.a.createElement(oj,{desc:e.desc})),s.a.createElement("div",{className:"lakex-table-view-permission"},t)};var sj=(e=>(e.Checkbox="checkbox",e.Radio="radio",e))(sj||{});const lj=e=>s.a.createElement("div",{className:"lakex-table-form-checkbox-readonly"},s.a.createElement(p.a,{checked:e.value,onChange:t=>{const r=t.target.checked;e.onChange(r)}}));function cj(){const[e,t]=Object(a.useState)(0);return()=>t((e=>e+1))}const uj=Fi.defineToken("HotKeyServiceToken"),dj=Fi.defineToken("HotkeyContribution"),fj={preventDefault:!1,enableOnInput:!1,isEnable:()=>!0},pj=oa.isMac,hj={alt:"altKey",control:"ctrlKey",meta:"metaKey",shift:"shiftKey"},mj={add:"+",break:"pause",cmd:"meta",command:"meta",ctl:"control",ctrl:"control",del:"delete",down:"arrowdown",esc:"escape",ins:"insert",left:"arrowleft",mod:pj?"meta":"control",opt:"alt",option:"alt",return:"enter",right:"arrowright",space:" ",spacebar:" ",up:"arrowup",win:"meta",windows:"meta"},vj={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,escape:27," ":32,pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,insert:45,delete:46,meta:91,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222};for(let e=1;e<20;e++)vj["f"+e]=111+e;function gj(e,t,r){t&&!("byKey"in t)&&(r=t,t=null),Array.isArray(e)||(e=[e]);const n=e.map((e=>function(e,t){const r=t&&t.byKey,n={};e=e.replace("++","+add");const i=e.split("+"),{length:o}=i;for(const e in hj)n[hj[e]]=!1;for(let e of i){const t=e.endsWith("?");t&&(e=e.slice(0,-1));const i=bj(e),a=hj[i];(1===o||!a)&&(r?n.key=i:n.which=yj(e)),a&&(n[a]=!t||null),1===o&&!a&&r&&(n.shiftKey=null)}return n}(e,t))),i=e=>n.some((t=>function(e,t){for(const r in e){const n=e[r];let i;if(null!=n&&(i="key"===r?t.key.toLowerCase():"which"===r?91===n&&93===t.which?91:t.which:t[r],(null!=i||!1!==n)&&i!==n))return!1}return!0}(t,e)));return null==r?i:i(r)}function yj(e){return e=bj(e),vj[e]||e.toUpperCase().charCodeAt(0)}function bj(e){return e=e.toLowerCase(),e=mj[e]||e}const wj={esc:jx.ESC,left:jx.LEFT,up:jx.UP,right:jx.RIGHT,down:jx.DOWN,enter:jx.ENTER,tab:jx.TAB,space:jx.SPACE,del:jx.DEL,backspace:jx.BACKSPACE},_j=Object.keys(wj).reduce(((e,t)=>(e[wj[t]]=t,e)),{});function Cj(e=""){return _j[e]||e.toUpperCase()}function Ej(e){return Mo(e)?oa.isWin?e.replace(/⌘/g,"ctrl").replace(/option/g,"alt"):e:(console.error("hotKey needs to be string!"),"")}const xj=e=>{const{altKey:t,ctrlKey:r,metaKey:n,shiftKey:i,key:o}=e,a={"⌘":n,shift:i,alt:t,ctrl:r,[o]:Cj(o)};return Object.keys(a).reduce(((e,t)=>{const r=a[t];return r&&e.push(Mo(r)?r:t),e}),[]).sort(((e,t)=>Number(e)-Number(t))).join("+")},Sj=e=>Mo(e)?e.split(/[,]\s+/):[],kj=(e,t)=>{const r=xj(e),n=Ej(t);return(Sj(n)||[]).some((e=>e===r))};var Oj;(e=>{e.adapterHotKey=Ej,e.isKeyboardEventMatchingHotkey=kj,e.getFormatHotkey=Cj,e.keyEventToHotKey=xj})(Oj||(Oj={}));var Ij=Object.defineProperty,Rj=Object.getOwnPropertyDescriptor,Tj=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Rj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ij(t,r,o),o};let Aj=class{constructor(){this._hotkeys=new Map,this._hotkeyToCommandId=new Map,this._init=!1}init(){if(this._init)return;this._init=!0;const e=this._hotkeyPluginProvider.getContributions();for(const t of e)try{t.registerHotkey(this)}catch(e){console.error(e)}}registerItem(e){const{id:t,hotkey:r}=e;if(this._hotkeys.has(t))throw new Error(`A hotkey is already registered with the id '${t}'`);this._hotkeys.set(t,{...e,preventDefault:jo(e.preventDefault)?fj.preventDefault:e.preventDefault,enableOnInput:jo(e.enableOnInput)?fj.enableOnInput:e.enableOnInput,isEnable:jo(e.isEnable)?fj.isEnable:e.isEnable}),Sj(r).forEach((e=>{const r=Oj.adapterHotKey(e),n=this._hotkeyToCommandId.get(r)||[];n.push(t),this._hotkeyToCommandId.set(r,n)}))}getRegisterHotkeyIdsByPressedKey(e){return this._hotkeyToCommandId.get(e)}getHotkeyItem(e){return this._hotkeys.get(e)}getHotkeyItems(){return this._hotkeys.values()}unRegister(){this._hotkeys.clear(),this._hotkeyToCommandId.clear()}};Tj([Eo(dj)],Aj.prototype,"_hotkeyPluginProvider",2),Aj=Tj([eo()],Aj);const Nj=Fi.defineToken("RenderPluginContribution"),Mj=Fi.defineToken("RenderPluginFieldContribution");var Pj=(e=>(e.NORMAL="normal",e.MOBILE="mobile",e))(Pj||{});const jj=null;var Dj=(e=>(e.NORMAL="normal",e.LITE="lite",e))(Dj||{});const Fj=Fi.defineToken("ViewerContribution");var Vj=(e=>(e.ACTIVE="active",e.INACTIVE="inactive",e))(Vj||{});const Lj=Fi.defineToken("ActiveTableServiceToken"),$j=null;var Bj=Object.defineProperty,zj=Object.getOwnPropertyDescriptor;let Uj=class{getRenderBoundingClientRect(){const e=this.$workbenchRoot.querySelector(".lakex-table-workbench-toolbar-container");if(e){const t=this.$workbenchRoot.getBoundingClientRect(),r=this.$root.getBoundingClientRect();return new DOMRect(r.x,r.y,r.width,t.height-e.getBoundingClientRect().height)}return this.$root.getBoundingClientRect()}};Uj=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?zj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Bj(t,r,o),o})([eo()],Uj);var Hj=Object.defineProperty,Wj=Object.getOwnPropertyDescriptor,Gj=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Wj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Hj(t,r,o),o};let Kj=class{constructor(){this._viewport=null,this._resizeListener=null}get viewport(){return this._viewport||this._updateViewport(),this._viewport}init(){this._resizeListener=dA(this._renderContextService.$root,"resize",(()=>{this._updateViewport()}))}destroy(){var e;null==(e=this._resizeListener)||e.destroy()}_updateViewport(){const e=this._renderContextService.$root;this._viewport=e.getBoundingClientRect()}isDotInViewPort(e,t){if(!this._viewport)return!1;const r=e>this._viewport.left&&e<this._viewport.right,n=t>this._viewport.top&&t<this._viewport.bottom;return r&&n}};Gj([to(Uj)],Kj.prototype,"_renderContextService",2),Kj=Gj([eo()],Kj);var qj=Object.defineProperty,Yj=Object.getOwnPropertyDescriptor,Xj=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Yj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&qj(t,r,o),o};let Zj=class extends Zf{constructor(){super(...arguments),this._curViewType="",this._viewNodes=new Map,this._viewProxy=null,this._isFirstRender=!0,this._onDoubleClickCell=this._register(new op),this.onDoubleClickCell=this._onDoubleClickCell.event,this._onClickCellIcon=this._register(new op),this.onClickCellIcon=this._onClickCellIcon.event,this._onClickRecord=this._register(new op),this.onClickRecord=this._onClickRecord.event,this._onClickEvent=this._register(new op),this.onClickEvent=this._onClickEvent.event,this._onClickIcon=this._register(new op),this.onClickIcon=this._onClickIcon.event,this._onScroll=this._register(new op),this.onScroll=this._onScroll.event,this.hooks={beforeRender:new Oh,afterRender:new Oh,destroy:new Oh},this._handleScroll=()=>{this.emitOnScroll(1)}}emitDoubleClickCell(e){this._onDoubleClickCell.emit(e)}emitClickCellIcon(e){this._onClickCellIcon.emit(e)}emitClickRecord(e){this._onClickRecord.emit(e)}emitClickEvent(e){this._onClickEvent.emit(e)}emitClickIcon(e){this._onClickIcon.emit(e)}emitOnScroll(e){this._onScroll.emit(e)}async init({onError:e}){this.configuration.getValue("render.autoActive")&&this.activeTableService.active(),this.onError=e,this._initPlugins(),this._initViewers()}initDom(e,t){this.renderContextService.$root=e,this.renderContextService.$workbenchRoot=t,this._renderViewPort.init(),this.renderContextService.$root.addEventListener("wheel",this._handleScroll,{passive:!0})}_initPlugins(){this.renderPluginProvider.getContributions({cache:!1}).forEach((e=>{e.init(this)}))}_initViewers(){this.viewerProvider.getContributions({cache:!1}).forEach((e=>{e.registerViewer(this)}))}render(e,t){const r=e.type!==this._curViewType;this.hooks.beforeRender.call(),(!this._viewProxy||r)&&this._renderViewer(e.type,t),this.hooks.afterRender.call()}destroy(){var e,t;super.destroy(),this.renderPluginProvider.getContributions({cache:!1}).forEach((e=>{var t;null==(t=e.destroy)||t.call(e)})),this._renderViewPort.destroy(),this.hooks.destroy.call(),this._viewNodes.clear(),null==(e=this._viewProxy)||e.destroy(),this._viewProxy=null,this.renderContextService.$root.removeEventListener("wheel",this._handleScroll),null==(t=this.renderContextService.$root.parentNode)||t.removeChild(this.renderContextService.$root)}_renderViewer(e,t){var r;const n=this.renderContextService.$root,i=this._viewNodes.get(e);this._curViewType=e,null==(r=this._viewProxy)||r.destroy(),this._viewProxy=i?i.render(n,{},t):null,this._viewProxy||(n.innerHTML="",n.appendChild(this._defaultViewer())),this._isFirstRender&&(this._lifeService.status=gf.Rendered,this._isFirstRender=!1)}_defaultViewer(){const e=document.createElement("h3");return e.innerHTML="没有注册 Viewer 这里是骨架屏",e}registerItem(e){if(this._viewNodes.get(e.viewType))throw Error(`${e.viewType} view has been registered`);this._viewNodes.set(e.viewType,e)}getViewNodes(){return this._viewNodes}};Xj([Eo(Nj)],Zj.prototype,"renderPluginProvider",2),Xj([Eo(Fj)],Zj.prototype,"viewerProvider",2),Xj([to(Uj)],Zj.prototype,"renderContextService",2),Xj([to(qf)],Zj.prototype,"configuration",2),Xj([to(Lj)],Zj.prototype,"activeTableService",2),Xj([to(Kj)],Zj.prototype,"_renderViewPort",2),Xj([to(yf)],Zj.prototype,"_lifeService",2),Xj([Si()],Zj.prototype,"destroy",1),Zj=Xj([eo()],Zj);var Jj=Object.defineProperty,Qj=Object.getOwnPropertyDescriptor,eD=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Qj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Jj(t,r,o),o};let tD=class{constructor(){this.getFieldComponent=e=>{var t,r;return null==(r=null==(t=this.getFieldTargetPlugin(e))?void 0:t.getFieldComponent)?void 0:r.call(t)},this.getFieldEditComponent=e=>{var t,r;return null==(r=null==(t=this.plugins.find((t=>t.fieldType===e)))?void 0:t.getFieldEditComponent)?void 0:r.call(t)},this.getFieldFormComponent=e=>{var t,r;return null==(r=null==(t=this.plugins.find((t=>t.fieldType===e)))?void 0:t.getFieldFormComponent)?void 0:r.call(t)},this.getFieldIcon=e=>{var t,r;return null==(r=null==(t=this.getFieldTargetPlugin(e))?void 0:t.getFieldIcon)?void 0:r.call(t)},this.getFieldTagComponent=e=>{var t,r;return null==(r=null==(t=this.getFieldTargetPlugin(e))?void 0:t.getFieldTagComponent)?void 0:r.call(t)}}get plugins(){return this.renderPluginFieldProvider.getContributions({cache:!1})}getFieldTargetPlugin(e){return this.plugins.find((t=>t.fieldType===e))}getCellIsShowValidTip(e){var t;return null==(t=this.getFieldTargetPlugin(e))?void 0:t.isShowValidTipInGrid}getFieldIsStrictValidatedValue(e){var t;return!(null==(t=this.getFieldTargetPlugin(e))||!t.isStrictValidatedValue)}getFieldRules(e){var t,r;return null==(r=null==(t=this.plugins.find((t=>t.fieldType===e)))?void 0:t.getFieldRules)?void 0:r.call(t)}cellValueChecker(e,t){var r,n,i,o;const a=null==(o=null==(i=null==(n=null==(r=this._readService)?void 0:r.getValueField)?void 0:n.call(r,e))?void 0:i.getVerify)?void 0:o.call(i,t);return null==a?void 0:a.errorMessage}};eD([Eo(Mj)],tD.prototype,"renderPluginFieldProvider",2),eD([to(Dy)],tD.prototype,"_readService",2),tD=eD([eo()],tD);var rD=Object.defineProperty,nD=Object.getOwnPropertyDescriptor,iD=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?nD(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&rD(t,r,o),o};let oD=class{_init(){this.zIndex={render:0,gridCell:0,gridCellPreviewer:1,gridStickyContent:2,gridCellFrozen:3,gridCellFrozenPreviewer:4,gridHeader:5,gridFooter:5}}};iD([xi()],oD.prototype,"_init",1),oD=iD([eo()],oD);const aD=Fi.defineToken("OpenerContribution");var sD=Object.defineProperty,lD=Object.getOwnPropertyDescriptor;let cD=class{constructor(){this.openerName="href-opener",this.apps=["phone"]}open(e){window.location.href=e}};cD=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?lD(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&sD(t,r,o),o})([eo()],cD);var uD=Object.defineProperty,dD=Object.getOwnPropertyDescriptor;let fD=class{constructor(){this.openerName="safe-redirect-opener",this.apps=["link:external"]}open(e){const{protocol:t,host:r}=document.location;window.open(`${t}//${r}/r/goto?url=${encodeURIComponent(e)}`,"_blank")}};fD=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?dD(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&uD(t,r,o),o})([eo()],fD);var pD=Object.defineProperty,hD=Object.getOwnPropertyDescriptor;let mD=class{constructor(){this.openerName="window-new-opener",this.apps=["link"]}open(e){window.open(e,"_blank")}};mD=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?hD(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&pD(t,r,o),o})([eo()],mD);var vD=Object.defineProperty,gD=Object.getOwnPropertyDescriptor;let yD=class{constructor(){this.openerName="window-opener",this.apps=["email"]}open(e){window.open(e,"_self")}};yD=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?gD(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&vD(t,r,o),o})([eo()],yD);var bD=Object.defineProperty,wD=Object.getOwnPropertyDescriptor,_D=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?wD(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&bD(t,r,o),o};let CD=class{constructor(){this.openers=[],this.apps=[]}init(){const e=this._openerProvider.getContributions();for(const t of e){if(t.registerOpener){const e=t.registerOpener();e&&e.length>0&&this.registerOpeners(e)}if(t.registerOpenerApp){const e=t.registerOpenerApp();if(e&&e.length>0)for(const t of e)this.registerApp(t)}}}registerOpeners(e){if(e)for(const t of e)this.registerOpener(t)}registerOpener(e){const t=this.openers.findIndex((t=>t.openerName===e.openerName));t>-1&&this.openers.splice(t,1),this.openers.push(e)}registerApp(e){const t=this.apps.findIndex((t=>t.name===e.name&&(!e.sub_name||t.sub_name===e.sub_name)));t>-1&&this.apps.splice(t,1),this.apps.push(e)}getApps(){return this.apps}getOpener(e){const t=this.openers;for(const r of t)if(r.apps.includes(e.name+(e.sub_name?":"+e.sub_name:"")))return r}};_D([Eo(aD)],CD.prototype,"_openerProvider",2),CD=_D([eo()],CD);var ED=Object.defineProperty,xD=Object.getOwnPropertyDescriptor,SD=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?xD(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ED(t,r,o),o};let kD=class{getOpenerApp(e,t){const r=this.registry.getApps().filter((t=>t.name===e));let n;for(const e of r){let r=!0;e.pattern&&(new RegExp(e.pattern).test(t)||(r=!1));let i=e.include;i&&(Mo(i)&&i.startsWith("{")&&(i=JSON.parse(i)),No(i)&&!i.test(t)&&(r=!1));let o=e.exclude;if(o&&(Mo(o)&&o.startsWith("{")&&(o=JSON.parse(o)),No(o)&&o.test(t)&&(r=!1)),r){n=e;break}}return n}};SD([to(CD)],kD.prototype,"registry",2),kD=SD([eo()],kD);var OD=Object.defineProperty,ID=Object.getOwnPropertyDescriptor;let RD=class{getHashes(){const e=window.location.hash;if(e){const t=e.replace("#","").split(";");if(t.length>0){const e=[];for(const r of t){let[t,n]=r.split(":");t&&!n&&32===t.length&&(n=t,t="view"),n&&e.push({name:t,url:n})}return e}}}setHash(e,t){const r=this.buildHash(e,t);r&&(window.location.hash=r)}removeHash(e){let t=this.getHashes();if(t)if(t=t.filter((t=>t.name!==e)),t.length>0){const e=this._buildHashStr(t);window.location.hash=e}else window.location.hash=""}buildHash(e,t){const r=this.getHashes()||[],n=r.findIndex((t=>t.name===e));return n>-1&&r.splice(n,1),r.push({name:e,url:t}),this._buildHashStr(r)}_buildHashStr(e){return e.map((e=>e.name+":"+e.url)).join(";")}};RD=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?ID(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&OD(t,r,o),o})([eo()],RD);var TD=Object.defineProperty,AD=Object.getOwnPropertyDescriptor,ND=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?AD(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&TD(t,r,o),o};let MD=class{open(e,t,...r){const n=this._appService.getOpenerApp(e,t);if(!n)throw new Error(`Not match app by url: ${t}`);const i=this.registry.getOpener(n);if(!i)throw new Error(`Not define link app opener: ${n.name}`);i.open(t,...r),i.autoClear?this._openerHash.removeHash(e):i.hash&&this.setHash(e,t)}getOpenLink(e,t){const r=this._openerHash.buildHash(e,t);return window.location.origin+window.location.pathname+window.location.search+"#"+r}setHash(e,t){this._configurationService.getValue("opener").useHash&&this._openerHash.setHash(e,t)}};ND([to(CD)],MD.prototype,"registry",2),ND([to(RD)],MD.prototype,"_openerHash",2),ND([to(kD)],MD.prototype,"_appService",2),ND([to(qf)],MD.prototype,"_configurationService",2),MD=ND([eo()],MD);const PD={name:"email",display_name:"Email",description:"邮件",include:/mailto\:\S+@\S+\.\S+$/},jD={name:"file",display_name:"File",description:"附件"},DD={name:"image",display_name:"Image",description:"图片"},FD=/^https?:\/\/.*(antfin|yuque|alibaba|antfin-inc|alibaba-inc).com/i,VD={name:"link",display_name:"Yuque Link",description:"链接",include:FD},LD={name:"link",sub_name:"external",display_name:"External Link",description:"外部链接",exclude:FD},$D={name:"phone",display_name:"Phone",description:"手机号码",include:/tel\:\d+$/},BD={name:"user",display_name:"用户",description:"用户首页"},zD=Fi.defineToken("FileContribution");var UD=Object.defineProperty,HD=Object.getOwnPropertyDescriptor,WD=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?HD(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&UD(t,r,o),o};let GD=class{getProvider(){const e=this.fileProvider.getContributions()||[],t=e[e.length-1];return null==t?void 0:t.registerFile()}};WD([Eo(zD)],GD.prototype,"fileProvider",2),GD=WD([eo()],GD);const KD={FILE_EXT:[".dwg",".vsd",".vsdm",".vsdx",".vss",".vssm",".vst",".vstm",".vstx",".msi",".chm",".sub",".idx",".sst",".son",".srt",".ssa",".ass",".smi",".psb",".pjs",".stl",".tts",".vsf",".zeg",".ipynb",".msg",".caj",".jar",".tar",".gz",".cnf",".ini",".rpm",".conf"],IMAGE_EXT:[".svg",".png",".bmp",".jpg",".jpeg",".gif",".tif",".tiff",".emf",".webp",".heic",".heif"],TEXT_FILE_EXT:[".txt",".abap",".ada",".adp",".ahk",".as",".as3",".asc",".ascx",".asm",".asp",".awk",".bash",".bash_login",".bash_logout",".bash_profile",".bashrc",".bat",".bib",".bsh",".build",".builder",".c",".c++",".capfile",".cc",".cfc",".cfm",".cfml",".cl",".clj",".cls",".cmake",".cmd",".coffee",".config",".cpp",".cpt",".cpy",".cs",".cshtml",".cson",".csproj",".css",".ctp",".cxx",".dart",".d",".ddl",".di",".diff",".disco",".dml",".dtd",".dtml",".el",".emakefile",".erb",".erl",".f",".f90",".f95",".fs",".fsi",".fsscript",".fsx",".gemfile",".gemspec",".gitconfig",".go",".groovy",".gvy",".Hcp",".h",".h++",".haml",".handlebars",".hbs",".hh",".hpp",".hrl",".hs",".htc",".hxx",".html",".htm",".idl",".iim",".inc",".inf",".ini",".inl",".ipp",".irbrc",".pug",".jade",".jav",".java",".js",".json",".jsp",".jsx",".l",".less",".lhs",".lisp",".log",".lst",".ltx",".lua",".m",".mak",".make",".manifest",".master",".md",".mkd",".markdn",".markdown",".mdown",".mkdn",".ml",".mli",".mll",".mly",".mud",".makefile",".nfo",".opml",".osascript",".p",".pas",".patch",".php",".php2",".php3",".php4",".php5",".phtml",".pl",".plx",".perl",".pm",".pod",".pp",".profile",".ps1",".ps1xml",".psd1",".psm1",".pss",".pt",".py",".pyw",".proto",".r",".rake",".rb",".rbx",".rc",".rdf",".re",".reg",".rest",".resw",".resx",".rhtml",".rjs",".rprofile",".rpy",".rs",".rss",".rst",".ruby",".rxml",".s",".sass",".scala",".scm",".sconscript",".sconstruct",".script",".scss",".sgml",".sh",".shtml",".sml",".svn-base",".swift",".sql",".sty",".tcl",".tex",".textile",".tld",".tli",".tmpl",".tpl",".ts",".tsx",".vb",".vi",".vim",".vmg",".webpart",".wsp",".wsdl",".xhtml",".xml",".jmx",".xoml",".xsd",".xslt",".yaml",".yaws",".yml",".zsh",".arxml"],VIDEO_EXT:[".mp4",".mov",".avi",".wmv",".m4a",".m4v",".webm",".flv",".mkv",".mpg",".ts",".mts",".swf",".3gp",".ogg",".aac",".dv",".f4v",".flac",".rmvb",".vob",".asf",".dat",".m2t",".m3u8",".mj2",".mjpeg",".mpe",".mpeg",".qt",".rm",".rmvb",".wmv"],OFFICE_EXT:[".docx",".doc",".dotx",".dot",".rtf",".txt",".html",".htm",".lake",".lakebook",".lakesheet",".lakemind",".lakeshow",".pdf",".xls",".xlsx",".xltx",".xlsm",".xlt",".csv",".pptx",".ppt",".potx",".pot",".ppsx",".pps",".pages",".numbers",".nmbtemplate",".template",".key",".keynote",".kth",".et",".ett",".dps",".dpt",".wps",".wpt",".txt",".md",".mark",".markdown",".xmind",".graffle",".gtemplate",".gstencil",".mindnode",".vpp",".mmap",".mm",".mpp"],MAC_OFFICE_EXT:[".key",".keynote",".pages",".numbers"],AUDIO_EXT:[".mp3",".mpga",".wav",".m4a",".flac"],PRESENTATION_EXT:[".ppt",".pptx",".ppsx",".potx",".pot",".key"],SHEET_EXT:[".xls",".xlsx",".xlsm",".xltx",".xlt",".csv",".numbers"],MMAP_EXT:[".mindnode",".mindnode.zip",".xmind",".xmind.zip",".mmap",".mmap.zip",".mm"],COMPRESS_EXT:[".zip",".rar",".gz",".tgz",".gzip",".7z",".tar",".jar",".dmg",".pkg"]},qD={"image/jpeg":["jpeg","jpg","jpe"],"image/png":["png"],"image/gif":["gif"],"image/vnd.wap.wbmp":["wbmp"],"image/tiff":["tiff","tiff"],"image/vnd.adobe.photoshop":["psd"],"image/svg+xml":["svg","svgz"],"text/jsx":["jsx"],"text/less":["less"],"text/css":["css"],"text/x-sass":["sass"],"text/x-scss":["scss"],"text/csv":["csv"],"text/xml":["xml"],"text/x-vcard":["vcf"],"text/x-vcalendar":["vcs"],"text/markdown":["md"],"text/plain":["txt"],"text/richtext":["rtx"],"text/rtf":["rtf"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/javascript":["js"],"text/yaml":["yaml","yml"],"audio/mp3":["mp3"],"audio/mp4":["mp4","mp4a"],"video/mp4":["mp4"],"audio/mpeg":["mpeg","mp2","mp3"],"audio/ogg":["oga"],"audio/wav":["wav"],"audio/wave":["wav"],"audio/webm":["weba"],"video/x-msvideo":["avi"],"video/quicktime":["mov","qt"],"video/ogg":["ogv"],"video/x-sgi-movie":["movie"],"application/rss+xml":["rss"],"application/json":["json"],"application/zip":["zip"],"application/gzip":["gzip"],"application/pdf":["pdf"],"application/postscript":["ai","eps","ps"],"application/msword":["doc","dot"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.template":["dotx"],"application/vnd.ms-excel":["xls","xlm","xla","xlc","xlt","xlw"],"application/vnd.ms-excel.sheet.macroenabled.12":["xlsm"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.template":["xltx"],"application/vnd.ms-powerpoint":["ppt","pps","pot"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/vnd.openxmlformats-officedocument.presentationml.slide":["sldx"],"application/vnd.openxmlformats-officedocument.presentationml.slideshow":["ppsx"],"application/vnd.openxmlformats-officedocument.presentationml.template":["potx"],"application/vnd.ms-fontobject":["eot"],"application/vnd.android.package-archive":["apk"],"application/x-apple-diskimage":["dmg"],"application/x-iwork-keynote-sffkey":["key"],"application/x-iwork-pages-sffpages":["pages"],"application/x-iwork-keynote-sffnumbers":["numbers"],"application/x-iwork-numbers-sffnumbers":["numbers"]};function YD(e){if(!e)return"";let t;if(t="string"==typeof e?e:e.name,t){if(t=t.toLowerCase(),t.endsWith(".mindnode.zip"))return"mindnode.zip";if(t.endsWith(".xmind.zip"))return"xmind.zip";if(t.endsWith(".mmap.zip"))return"mmap.zip";if(t.endsWith(".mpp.zip"))return"mpp.zip"}const r=t&&t.split(".").pop()||"",n=e.type&&qD[e.type];return n?n.includes(r)?r:n[0]:r}function XD(e){const t=YD(e);return KD.IMAGE_EXT.includes(t)}function ZD(e){const t=YD(e);return XD(e)?"image":function(e){const t=YD(e);return KD.VIDEO_EXT.includes(t)}(e)?"video":function(e){const t=YD(e);return KD.AUDIO_EXT.includes(t)}(e)?"audio":["doc","docx","dot","dotx"].includes(t)?"word":function(e){const t=YD(e);return["pdf"].includes(t)}(e)?"pdf":"txt"===t?"txt":["pages","md","markdown","rtf"].includes(t)?"doc":"numbers"===t?"numbers":["xls","xlsx","xlsm","xltx","xlt"].includes(t)?"excel":function(e){const t=YD(e);return KD.SHEET_EXT.includes(t)}(e)?"sheet":"key"===e?"keynote":function(e){const t=YD(e);return KD.PRESENTATION_EXT.includes(t)}(e)?"ppt":["xmind","xmind.zip"].includes(t)?"xmind":["mindnode","mindnode.zip"].includes(t)?"mindnote":function(e){const t=YD(e);return KD.MMAP_EXT.includes(t)}(e)?"minimap":"sketch"===t?"sketch":["rp","rplib"].includes(t)?"axure":"psd"===t?"psd":"ai"===t?"ai":"graffle"===t?"graffle":"zip"===t?"rar":"lake"===t?"lake":"lakesheet"===t?"lakesheet":"default"}var JD=Object.defineProperty,QD=Object.getOwnPropertyDescriptor,eF=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?QD(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&JD(t,r,o),o};let tF=class{get _provider(){return this._fileRegistry.getProvider()}getExts(){var e;return null!=(e=this._provider)&&e.getExts?this._provider.getExts():function(){let e=[];return Object.keys(KD).forEach((t=>{e=e.concat(KD[t])})),e}().join(",")}getFileKey(e){var t;return null!=(t=this._provider)&&t.getFileKey?this._provider.getFileKey(e):ZD(e)}getPreviewUrl(e){var t,r;return null!=(t=this._provider)&&t.getPreviewUrl?null==(r=this._provider)?void 0:r.getPreviewUrl(e):e}getPreviewOrDownloadUrl(e,t){var r,n;return null!=(r=this._provider)&&r.getPreviewOrDownloadUrl?null==(n=this._provider)?void 0:n.getPreviewOrDownloadUrl(e,t):e}};eF([to(GD)],tF.prototype,"_fileRegistry",2),tF=eF([eo()],tF);const rF=bo().contribution(zD).register(GD).register(tF);var nF=Object.defineProperty,iF=Object.getOwnPropertyDescriptor,oF=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?iF(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&nF(t,r,o),o};let aF=class{constructor(){this.openerName="file-previewer-opener",this.apps=["file"]}open(e,t){const r=this._fileService.getPreviewOrDownloadUrl(e,t.size);!r||window.open(r,"_blank","noopener,noreferrer")}};oF([to(tF)],aF.prototype,"_fileService",2),aF=oF([eo()],aF);var sF={exports:{}};!function(e,t){e.exports=function(){var e=function(e,t,r,n){var i={features:null,bind:function(e,t,r,n){var i=(n?"remove":"add")+"EventListener";t=t.split(" ");for(var o=0;o<t.length;o++)t[o]&&e[i](t[o],r,!1)},isArray:function(e){return e instanceof Array},createEl:function(e,t){var r=document.createElement(t||"div");return e&&(r.className=e),r},getScrollY:function(){var e=window.pageYOffset;return void 0!==e?e:document.documentElement.scrollTop},unbind:function(e,t,r){i.bind(e,t,r,!0)},removeClass:function(e,t){var r=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(r," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")},addClass:function(e,t){i.hasClass(e,t)||(e.className+=(e.className?" ":"")+t)},hasClass:function(e,t){return e.className&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},getChildByClass:function(e,t){for(var r=e.firstChild;r;){if(i.hasClass(r,t))return r;r=r.nextSibling}},arraySearch:function(e,t,r){for(var n=e.length;n--;)if(e[n][r]===t)return n;return-1},extend:function(e,t,r){for(var n in t)if(t.hasOwnProperty(n)){if(r&&e.hasOwnProperty(n))continue;e[n]=t[n]}},easing:{sine:{out:function(e){return Math.sin(e*(Math.PI/2))},inOut:function(e){return-(Math.cos(Math.PI*e)-1)/2}},cubic:{out:function(e){return--e*e*e+1}}},detectFeatures:function(){if(i.features)return i.features;var e=i.createEl().style,t="",r={};if(r.oldIE=document.all&&!document.addEventListener,r.touch="ontouchstart"in window,window.requestAnimationFrame&&(r.raf=window.requestAnimationFrame,r.caf=window.cancelAnimationFrame),r.pointerEvent=!!window.PointerEvent||navigator.msPointerEnabled,!r.pointerEvent){var n=navigator.userAgent;if(/iP(hone|od)/.test(navigator.platform)){var o=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);o&&o.length>0&&(o=parseInt(o[1],10))>=1&&o<8&&(r.isOldIOSPhone=!0)}var a=n.match(/Android\s([0-9\.]*)/),s=a?a[1]:0;(s=parseFloat(s))>=1&&(s<4.4&&(r.isOldAndroid=!0),r.androidVersion=s),r.isMobileOpera=/opera mini|opera mobi/i.test(n)}for(var l,c,u=["transform","perspective","animationName"],d=["","webkit","Moz","ms","O"],f=0;f<4;f++){t=d[f];for(var p=0;p<3;p++)l=u[p],c=t+(t?l.charAt(0).toUpperCase()+l.slice(1):l),!r[l]&&c in e&&(r[l]=c);t&&!r.raf&&(t=t.toLowerCase(),r.raf=window[t+"RequestAnimationFrame"],r.raf&&(r.caf=window[t+"CancelAnimationFrame"]||window[t+"CancelRequestAnimationFrame"]))}if(!r.raf){var h=0;r.raf=function(e){var t=(new Date).getTime(),r=Math.max(0,16-(t-h)),n=window.setTimeout((function(){e(t+r)}),r);return h=t+r,n},r.caf=function(e){clearTimeout(e)}}return r.svg=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,i.features=r,r}};i.detectFeatures(),i.features.oldIE&&(i.bind=function(e,t,r,n){t=t.split(" ");for(var i,o=(n?"detach":"attach")+"Event",a=function(){r.handleEvent.call(r)},s=0;s<t.length;s++)if(i=t[s])if("object"==typeof r&&r.handleEvent){if(n){if(!r["oldIE"+i])return!1}else r["oldIE"+i]=a;e[o]("on"+i,r["oldIE"+i])}else e[o]("on"+i,r)});var o=this,a=25,s=3,l={allowPanToNext:!0,spacing:.12,bgOpacity:1,mouseUsed:!1,loop:!0,pinchToClose:!0,closeOnScroll:!0,closeOnVerticalDrag:!0,verticalDragRange:.75,hideAnimationDuration:333,showAnimationDuration:333,showHideOpacity:!1,focus:!0,escKey:!0,arrowKeys:!0,mainScrollEndFriction:.35,panEndFriction:.35,isClickableElement:function(e){return"A"===e.tagName},getDoubleTapZoom:function(e,t){return e||t.initialZoomLevel<.7?1:1.33},maxSpreadZoom:1.33,modal:!0,scaleMode:"fit"};i.extend(l,n);var c,u,d,f,p,h,m,v,g,y,b,w,_,C,E,x,S,k,O,I,R,T,A,N,M,P,j,D,F,V,L,$,B,z,U,H,W,G,K,q,Y,X,Z,J,Q,ee,te,re,ne,ie,oe,ae,se,le,ce,ue,de=function(){return{x:0,y:0}},fe=de(),pe=de(),he=de(),me={},ve=0,ge={},ye=de(),be=0,we=!0,_e=[],Ce={},Ee=!1,xe=function(e,t){i.extend(o,t.publicMethods),_e.push(e)},Se=function(e){var t=Qt();return e>t-1?e-t:e<0?t+e:e},ke={},Oe=function(e,t){return ke[e]||(ke[e]=[]),ke[e].push(t)},Ie=function(e){var t=ke[e];if(t){var r=Array.prototype.slice.call(arguments);r.shift();for(var n=0;n<t.length;n++)t[n].apply(o,r)}},Re=function(){return(new Date).getTime()},Te=function(e){le=e,o.bg.style.opacity=e*l.bgOpacity},Ae=function(e,t,r,n,i){(!Ee||i&&i!==o.currItem)&&(n/=i?i.fitRatio:o.currItem.fitRatio),e[T]=w+t+"px, "+r+"px"+_+" scale("+n+")"},Ne=function(e){ne&&(e&&(y>o.currItem.fitRatio?Ee||(ur(o.currItem,!1,!0),Ee=!0):Ee&&(ur(o.currItem),Ee=!1)),Ae(ne,he.x,he.y,y))},Me=function(e){e.container&&Ae(e.container.style,e.initialPosition.x,e.initialPosition.y,e.initialZoomLevel,e)},Pe=function(e,t){t[T]=w+e+"px, 0px"+_},je=function(e,t){if(!l.loop&&t){var r=f+(ye.x*ve-e)/ye.x,n=Math.round(e-yt.x);(r<0&&n>0||r>=Qt()-1&&n<0)&&(e=yt.x+n*l.mainScrollEndFriction)}yt.x=e,Pe(e,p)},De=function(e,t){var r=bt[e]-ge[e];return pe[e]+fe[e]+r-r*(t/b)},Fe=function(e,t){e.x=t.x,e.y=t.y,t.id&&(e.id=t.id)},Ve=function(e){e.x=Math.round(e.x),e.y=Math.round(e.y)},Le=null,$e=function(){Le&&(i.unbind(document,"mousemove",$e),i.addClass(e,"pswp--has_mouse"),l.mouseUsed=!0,Ie("mouseUsed")),Le=setTimeout((function(){Le=null}),100)},Be=function(){i.bind(document,"keydown",o),L.transform&&i.bind(o.scrollWrap,"click",o),l.mouseUsed||i.bind(document,"mousemove",$e),i.bind(window,"resize scroll orientationchange",o),Ie("bindEvents")},ze=function(){i.unbind(window,"resize scroll orientationchange",o),i.unbind(window,"scroll",g.scroll),i.unbind(document,"keydown",o),i.unbind(document,"mousemove",$e),L.transform&&i.unbind(o.scrollWrap,"click",o),K&&i.unbind(window,m,o),clearTimeout($),Ie("unbindEvents")},Ue=function(e,t){var r=ar(o.currItem,me,e);return t&&(re=r),r},He=function(e){return e||(e=o.currItem),e.initialZoomLevel},We=function(e){return e||(e=o.currItem),e.w>0?l.maxSpreadZoom:1},Ge=function(e,t,r,n){return n===o.currItem.initialZoomLevel?(r[e]=o.currItem.initialPosition[e],!0):(r[e]=De(e,n),r[e]>t.min[e]?(r[e]=t.min[e],!0):r[e]<t.max[e]&&(r[e]=t.max[e],!0))},Ke=function(){if(T){var t=L.perspective&&!N;return w="translate"+(t?"3d(":"("),void(_=L.perspective?", 0px)":")")}T="left",i.addClass(e,"pswp--ie"),Pe=function(e,t){t.left=e+"px"},Me=function(e){var t=e.fitRatio>1?1:e.fitRatio,r=e.container.style,n=t*e.w,i=t*e.h;r.width=n+"px",r.height=i+"px",r.left=e.initialPosition.x+"px",r.top=e.initialPosition.y+"px"},Ne=function(){if(ne){var e=ne,t=o.currItem,r=t.fitRatio>1?1:t.fitRatio,n=r*t.w,i=r*t.h;e.width=n+"px",e.height=i+"px",e.left=he.x+"px",e.top=he.y+"px"}}},qe=function(e){var t="";l.escKey&&27===e.keyCode?t="close":l.arrowKeys&&(37===e.keyCode?t="prev":39===e.keyCode&&(t="next")),t&&!e.ctrlKey&&!e.altKey&&!e.shiftKey&&!e.metaKey&&(e.preventDefault?e.preventDefault():e.returnValue=!1,o[t]())},Ye=function(e){!e||(X||Y||ie||W)&&(e.preventDefault(),e.stopPropagation())},Xe=function(){o.setScrollOffset(0,i.getScrollY())},Ze={},Je=0,Qe=function(e){Ze[e]&&(Ze[e].raf&&P(Ze[e].raf),Je--,delete Ze[e])},et=function(e){Ze[e]&&Qe(e),Ze[e]||(Je++,Ze[e]={})},tt=function(){for(var e in Ze)Ze.hasOwnProperty(e)&&Qe(e)},rt=function(e,t,r,n,i,o,a){var s,l=Re();et(e);var c=function(){if(Ze[e]){if((s=Re()-l)>=n)return Qe(e),o(r),void(a&&a());o((r-t)*i(s/n)+t),Ze[e].raf=M(c)}};c()},nt={shout:Ie,listen:Oe,viewportSize:me,options:l,isMainScrollAnimating:function(){return ie},getZoomLevel:function(){return y},getCurrentIndex:function(){return f},isDragging:function(){return K},isZooming:function(){return ee},setScrollOffset:function(e,t){ge.x=e,V=ge.y=t,Ie("updateScrollOffset",ge)},applyZoomPan:function(e,t,r,n){he.x=t,he.y=r,y=e,Ne(n)},init:function(){if(!c&&!u){var r;o.framework=i,o.template=e,o.bg=i.getChildByClass(e,"pswp__bg"),j=e.className,c=!0,L=i.detectFeatures(),M=L.raf,P=L.caf,T=L.transform,F=L.oldIE,o.scrollWrap=i.getChildByClass(e,"pswp__scroll-wrap"),o.container=i.getChildByClass(o.scrollWrap,"pswp__container"),p=o.container.style,o.itemHolders=x=[{el:o.container.children[0],wrap:0,index:-1},{el:o.container.children[1],wrap:0,index:-1},{el:o.container.children[2],wrap:0,index:-1}],x[0].el.style.display=x[2].el.style.display="none",Ke(),g={resize:o.updateSize,orientationchange:function(){clearTimeout($),$=setTimeout((function(){me.x!==o.scrollWrap.clientWidth&&o.updateSize()}),500)},scroll:Xe,keydown:qe,click:Ye};var n=L.isOldIOSPhone||L.isOldAndroid||L.isMobileOpera;for((!L.animationName||!L.transform||n)&&(l.showAnimationDuration=l.hideAnimationDuration=0),r=0;r<_e.length;r++)o["init"+_e[r]]();t&&(o.ui=new t(o,i)).init(),Ie("firstUpdate"),f=f||l.index||0,(isNaN(f)||f<0||f>=Qt())&&(f=0),o.currItem=Jt(f),(L.isOldIOSPhone||L.isOldAndroid)&&(we=!1),e.setAttribute("aria-hidden","false"),l.modal&&(we?e.style.position="fixed":(e.style.position="absolute",e.style.top=i.getScrollY()+"px")),void 0===V&&(Ie("initialLayout"),V=D=i.getScrollY());var a="pswp--open ";for(l.mainClass&&(a+=l.mainClass+" "),l.showHideOpacity&&(a+="pswp--animate_opacity "),a+=N?"pswp--touch":"pswp--notouch",a+=L.animationName?" pswp--css_animation":"",a+=L.svg?" pswp--svg":"",i.addClass(e,a),o.updateSize(),h=-1,be=null,r=0;r<s;r++)Pe((r+h)*ye.x,x[r].el.style);F||i.bind(o.scrollWrap,v,o),Oe("initialZoomInEnd",(function(){o.setContent(x[0],f-1),o.setContent(x[2],f+1),x[0].el.style.display=x[2].el.style.display="block",l.focus&&e.focus(),Be()})),o.setContent(x[1],f),o.updateCurrItem(),Ie("afterInit"),we||(C=setInterval((function(){!Je&&!K&&!ee&&y===o.currItem.initialZoomLevel&&o.updateSize()}),1e3)),i.addClass(e,"pswp--visible")}},close:function(){!c||(c=!1,u=!0,Ie("close"),ze(),er(o.currItem,null,!0,o.destroy))},destroy:function(){Ie("destroy"),qt&&clearTimeout(qt),e.setAttribute("aria-hidden","true"),e.className=j,C&&clearInterval(C),i.unbind(o.scrollWrap,v,o),i.unbind(window,"scroll",o),xt(),tt(),ke=null},panTo:function(e,t,r){r||(e>re.min.x?e=re.min.x:e<re.max.x&&(e=re.max.x),t>re.min.y?t=re.min.y:t<re.max.y&&(t=re.max.y)),he.x=e,he.y=t,Ne()},handleEvent:function(e){e=e||window.event,g[e.type]&&g[e.type](e)},goTo:function(e){var t=(e=Se(e))-f;be=t,f=e,o.currItem=Jt(f),ve-=t,je(ye.x*ve),tt(),ie=!1,o.updateCurrItem()},next:function(){o.goTo(f+1)},prev:function(){o.goTo(f-1)},updateCurrZoomItem:function(e){if(e&&Ie("beforeChange",0),x[1].el.children.length){var t=x[1].el.children[0];ne=i.hasClass(t,"pswp__zoom-wrap")?t.style:null}else ne=null;re=o.currItem.bounds,b=y=o.currItem.initialZoomLevel,he.x=re.center.x,he.y=re.center.y,e&&Ie("afterChange")},invalidateCurrItems:function(){E=!0;for(var e=0;e<s;e++)x[e].item&&(x[e].item.needsUpdate=!0)},updateCurrItem:function(e){if(0!==be){var t,r=Math.abs(be);if(!(e&&r<2)){o.currItem=Jt(f),Ee=!1,Ie("beforeChange",be),r>=s&&(h+=be+(be>0?-s:s),r=s);for(var n=0;n<r;n++)be>0?(t=x.shift(),x[s-1]=t,h++,Pe((h+2)*ye.x,t.el.style),o.setContent(t,f-r+n+1+1)):(t=x.pop(),x.unshift(t),h--,Pe(h*ye.x,t.el.style),o.setContent(t,f+r-n-1-1));if(ne&&1===Math.abs(be)){var i=Jt(S);i.initialZoomLevel!==y&&(ar(i,me),ur(i),Me(i))}be=0,o.updateCurrZoomItem(),S=f,Ie("afterChange")}}},updateSize:function(t){if(!we&&l.modal){var r=i.getScrollY();if(V!==r&&(e.style.top=r+"px",V=r),!t&&Ce.x===window.innerWidth&&Ce.y===window.innerHeight)return;Ce.x=window.innerWidth,Ce.y=window.innerHeight,e.style.height=Ce.y+"px"}if(me.x=o.scrollWrap.clientWidth,me.y=o.scrollWrap.clientHeight,Xe(),ye.x=me.x+Math.round(me.x*l.spacing),ye.y=me.y,je(ye.x*ve),Ie("beforeResize"),void 0!==h){for(var n,a,c,u=0;u<s;u++)n=x[u],Pe((u+h)*ye.x,n.el.style),c=f+u-1,l.loop&&Qt()>2&&(c=Se(c)),(a=Jt(c))&&(E||a.needsUpdate||!a.bounds)?(o.cleanSlide(a),o.setContent(n,c),1===u&&(o.currItem=a,o.updateCurrZoomItem(!0)),a.needsUpdate=!1):-1===n.index&&c>=0&&o.setContent(n,c),a&&a.container&&(ar(a,me),ur(a),Me(a));E=!1}b=y=o.currItem.initialZoomLevel,(re=o.currItem.bounds)&&(he.x=re.center.x,he.y=re.center.y,Ne(!0)),Ie("resize")},zoomTo:function(e,t,r,n,o){t&&(b=y,bt.x=Math.abs(t.x)-he.x,bt.y=Math.abs(t.y)-he.y,Fe(pe,he));var a=Ue(e,!1),s={};Ge("x",a,s,e),Ge("y",a,s,e);var l=y,c={x:he.x,y:he.y};Ve(s);var u=function(t){1===t?(y=e,he.x=s.x,he.y=s.y):(y=(e-l)*t+l,he.x=(s.x-c.x)*t+c.x,he.y=(s.y-c.y)*t+c.y),o&&o(t),Ne(1===t)};r?rt("customZoomTo",0,1,r,n||i.easing.sine.inOut,u):u(1)}},it=30,ot=10,at={},st={},lt={},ct={},ut={},dt=[],ft={},pt=[],ht={},mt=0,vt=de(),gt=0,yt=de(),bt=de(),wt=de(),_t=function(e,t){return e.x===t.x&&e.y===t.y},Ct=function(e,t){return Math.abs(e.x-t.x)<a&&Math.abs(e.y-t.y)<a},Et=function(e,t){return ht.x=Math.abs(e.x-t.x),ht.y=Math.abs(e.y-t.y),Math.sqrt(ht.x*ht.x+ht.y*ht.y)},xt=function(){Z&&(P(Z),Z=null)},St=function(){K&&(Z=M(St),Bt())},kt=function(){return!("fit"===l.scaleMode&&y===o.currItem.initialZoomLevel)},Ot=function(e,t){return!(!e||e===document||e.getAttribute("class")&&e.getAttribute("class").indexOf("pswp__scroll-wrap")>-1)&&(t(e)?e:Ot(e.parentNode,t))},It={},Rt=function(e,t){return It.prevent=!Ot(e.target,l.isClickableElement),Ie("preventDragEvent",e,t,It),It.prevent},Tt=function(e,t){return t.x=e.pageX,t.y=e.pageY,t.id=e.identifier,t},At=function(e,t,r){r.x=.5*(e.x+t.x),r.y=.5*(e.y+t.y)},Nt=function(e,t,r){if(e-z>50){var n=pt.length>2?pt.shift():{};n.x=t,n.y=r,pt.push(n),z=e}},Mt=function(){var e=he.y-o.currItem.initialPosition.y;return 1-Math.abs(e/(me.y/2))},Pt={},jt={},Dt=[],Ft=function(e){for(;Dt.length>0;)Dt.pop();return A?(ue=0,dt.forEach((function(e){0===ue?Dt[0]=e:1===ue&&(Dt[1]=e),ue++}))):e.type.indexOf("touch")>-1?e.touches&&e.touches.length>0&&(Dt[0]=Tt(e.touches[0],Pt),e.touches.length>1&&(Dt[1]=Tt(e.touches[1],jt))):(Pt.x=e.pageX,Pt.y=e.pageY,Pt.id="",Dt[0]=Pt),Dt},Vt=function(e,t){var r,n,i,a,s=he[e]+t[e],c=t[e]>0,u=yt.x+t.x,d=yt.x-ft.x;if(r=s>re.min[e]||s<re.max[e]?l.panEndFriction:1,s=he[e]+t[e]*r,(l.allowPanToNext||y===o.currItem.initialZoomLevel)&&(ne?"h"===oe&&"x"===e&&!Y&&(c?(s>re.min[e]&&(r=l.panEndFriction,re.min[e],n=re.min[e]-pe[e]),(n<=0||d<0)&&Qt()>1?(a=u,d<0&&u>ft.x&&(a=ft.x)):re.min.x!==re.max.x&&(i=s)):(s<re.max[e]&&(r=l.panEndFriction,re.max[e],n=pe[e]-re.max[e]),(n<=0||d>0)&&Qt()>1?(a=u,d>0&&u<ft.x&&(a=ft.x)):re.min.x!==re.max.x&&(i=s))):a=u,"x"===e))return void 0!==a&&(je(a,!0),J=a!==ft.x),re.min.x!==re.max.x&&(void 0!==i?he.x=i:J||(he.x+=t.x*r)),void 0!==a;ie||J||y>o.currItem.fitRatio&&(he[e]+=t[e]*r)},Lt=function(e){if(!("mousedown"===e.type&&e.button>0)){if(Zt)return void e.preventDefault();if(!G||"mousedown"!==e.type){if(Rt(e,!0)&&e.preventDefault(),Ie("pointerDown"),A){var t=i.arraySearch(dt,e.pointerId,"id");t<0&&(t=dt.length),dt[t]={x:e.pageX,y:e.pageY,id:e.pointerId}}var r=Ft(e),n=r.length;Q=null,tt(),(!K||1===n)&&(K=ae=!0,i.bind(window,m,o),H=ce=se=W=J=X=q=Y=!1,oe=null,Ie("firstTouchStart",r),Fe(pe,he),fe.x=fe.y=0,Fe(ct,r[0]),Fe(ut,ct),ft.x=ye.x*ve,pt=[{x:ct.x,y:ct.y}],z=B=Re(),Ue(y,!0),xt(),St()),!ee&&n>1&&!ie&&!J&&(b=y,Y=!1,ee=q=!0,fe.y=fe.x=0,Fe(pe,he),Fe(at,r[0]),Fe(st,r[1]),At(at,st,wt),bt.x=Math.abs(wt.x)-he.x,bt.y=Math.abs(wt.y)-he.y,te=Et(at,st))}}},$t=function(e){if(e.preventDefault(),A){var t=i.arraySearch(dt,e.pointerId,"id");if(t>-1){var r=dt[t];r.x=e.pageX,r.y=e.pageY}}if(K){var n=Ft(e);if(oe||X||ee)Q=n;else if(yt.x!==ye.x*ve)oe="h";else{var o=Math.abs(n[0].x-ct.x)-Math.abs(n[0].y-ct.y);Math.abs(o)>=ot&&(oe=o>0?"h":"v",Q=n)}}},Bt=function(){if(Q){var e=Q.length;if(0!==e)if(Fe(at,Q[0]),lt.x=at.x-ct.x,lt.y=at.y-ct.y,ee&&e>1){if(ct.x=at.x,ct.y=at.y,!lt.x&&!lt.y&&_t(Q[1],st))return;Fe(st,Q[1]),Y||(Y=!0,Ie("zoomGestureStarted"));var t=Et(at,st),r=Gt(t);r>o.currItem.initialZoomLevel+o.currItem.initialZoomLevel/15&&(ce=!0);var n=1,i=He(),a=We();if(r<i)if(l.pinchToClose&&!ce&&b<=o.currItem.initialZoomLevel){var s=1-(i-r)/(i/1.2);Te(s),Ie("onPinchClose",s),se=!0}else(n=(i-r)/i)>1&&(n=1),r=i-n*(i/3);else r>a&&((n=(r-a)/(6*i))>1&&(n=1),r=a+n*i);n<0&&(n=0),At(at,st,vt),fe.x+=vt.x-wt.x,fe.y+=vt.y-wt.y,Fe(wt,vt),he.x=De("x",r),he.y=De("y",r),H=r>y,y=r,Ne()}else{if(!oe||(ae&&(ae=!1,Math.abs(lt.x)>=ot&&(lt.x-=Q[0].x-ut.x),Math.abs(lt.y)>=ot&&(lt.y-=Q[0].y-ut.y)),ct.x=at.x,ct.y=at.y,0===lt.x&&0===lt.y))return;if("v"===oe&&l.closeOnVerticalDrag&&!kt()){fe.y+=lt.y,he.y+=lt.y;var c=Mt();return W=!0,Ie("onVerticalDrag",c),Te(c),void Ne()}Nt(Re(),at.x,at.y),X=!0,re=o.currItem.bounds,Vt("x",lt)||(Vt("y",lt),Ve(he),Ne())}}},zt=function(e){if(L.isOldAndroid){if(G&&"mouseup"===e.type)return;e.type.indexOf("touch")>-1&&(clearTimeout(G),G=setTimeout((function(){G=0}),600))}var t;if(Ie("pointerUp"),Rt(e,!1)&&e.preventDefault(),A){var r=i.arraySearch(dt,e.pointerId,"id");if(r>-1)if(t=dt.splice(r,1)[0],navigator.msPointerEnabled){var n={4:"mouse",2:"touch",3:"pen"};t.type=n[e.pointerType],t.type||(t.type=e.pointerType||"mouse")}else t.type=e.pointerType||"mouse"}var a,s=Ft(e),c=s.length;if("mouseup"===e.type&&(c=0),2===c)return Q=null,!0;1===c&&Fe(ut,s[0]),0===c&&!oe&&!ie&&(t||("mouseup"===e.type?t={x:e.pageX,y:e.pageY,type:"mouse"}:e.changedTouches&&e.changedTouches[0]&&(t={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY,type:"touch"})),Ie("touchRelease",e,t));var u=-1;if(0===c&&(K=!1,i.unbind(window,m,o),xt(),ee?u=0:-1!==gt&&(u=Re()-gt)),gt=1===c?Re():-1,a=-1!==u&&u<150?"zoom":"swipe",ee&&c<2&&(ee=!1,1===c&&(a="zoomPointerUp"),Ie("zoomGestureEnded")),Q=null,X||Y||ie||W){if(tt(),U||(U=Ut()),U.calculateSwipeSpeed("x"),W){if(Mt()<l.verticalDragRange)o.close();else{var d=he.y,f=le;rt("verticalDrag",0,1,300,i.easing.cubic.out,(function(e){he.y=(o.currItem.initialPosition.y-d)*e+d,Te((1-f)*e+f),Ne()})),Ie("onVerticalDrag",1)}return}if((J||ie)&&0===c){if(Wt(a,U))return;a="zoomPointerUp"}if(!ie){if("swipe"!==a)return void Kt();!J&&y>o.currItem.fitRatio&&Ht(U)}}},Ut=function(){var e,t,r={lastFlickOffset:{},lastFlickDist:{},lastFlickSpeed:{},slowDownRatio:{},slowDownRatioReverse:{},speedDecelerationRatio:{},speedDecelerationRatioAbs:{},distanceOffset:{},backAnimDestination:{},backAnimStarted:{},calculateSwipeSpeed:function(n){pt.length>1?(e=Re()-z+50,t=pt[pt.length-2][n]):(e=Re()-B,t=ut[n]),r.lastFlickOffset[n]=ct[n]-t,r.lastFlickDist[n]=Math.abs(r.lastFlickOffset[n]),r.lastFlickDist[n]>20?r.lastFlickSpeed[n]=r.lastFlickOffset[n]/e:r.lastFlickSpeed[n]=0,Math.abs(r.lastFlickSpeed[n])<.1&&(r.lastFlickSpeed[n]=0),r.slowDownRatio[n]=.95,r.slowDownRatioReverse[n]=1-r.slowDownRatio[n],r.speedDecelerationRatio[n]=1},calculateOverBoundsAnimOffset:function(e,t){r.backAnimStarted[e]||(he[e]>re.min[e]?r.backAnimDestination[e]=re.min[e]:he[e]<re.max[e]&&(r.backAnimDestination[e]=re.max[e]),void 0!==r.backAnimDestination[e]&&(r.slowDownRatio[e]=.7,r.slowDownRatioReverse[e]=1-r.slowDownRatio[e],r.speedDecelerationRatioAbs[e]<.05&&(r.lastFlickSpeed[e]=0,r.backAnimStarted[e]=!0,rt("bounceZoomPan"+e,he[e],r.backAnimDestination[e],t||300,i.easing.sine.out,(function(t){he[e]=t,Ne()})))))},calculateAnimOffset:function(e){r.backAnimStarted[e]||(r.speedDecelerationRatio[e]=r.speedDecelerationRatio[e]*(r.slowDownRatio[e]+r.slowDownRatioReverse[e]-r.slowDownRatioReverse[e]*r.timeDiff/10),r.speedDecelerationRatioAbs[e]=Math.abs(r.lastFlickSpeed[e]*r.speedDecelerationRatio[e]),r.distanceOffset[e]=r.lastFlickSpeed[e]*r.speedDecelerationRatio[e]*r.timeDiff,he[e]+=r.distanceOffset[e])},panAnimLoop:function(){if(Ze.zoomPan&&(Ze.zoomPan.raf=M(r.panAnimLoop),r.now=Re(),r.timeDiff=r.now-r.lastNow,r.lastNow=r.now,r.calculateAnimOffset("x"),r.calculateAnimOffset("y"),Ne(),r.calculateOverBoundsAnimOffset("x"),r.calculateOverBoundsAnimOffset("y"),r.speedDecelerationRatioAbs.x<.05&&r.speedDecelerationRatioAbs.y<.05))return he.x=Math.round(he.x),he.y=Math.round(he.y),Ne(),void Qe("zoomPan")}};return r},Ht=function(e){if(e.calculateSwipeSpeed("y"),re=o.currItem.bounds,e.backAnimDestination={},e.backAnimStarted={},Math.abs(e.lastFlickSpeed.x)<=.05&&Math.abs(e.lastFlickSpeed.y)<=.05)return e.speedDecelerationRatioAbs.x=e.speedDecelerationRatioAbs.y=0,e.calculateOverBoundsAnimOffset("x"),e.calculateOverBoundsAnimOffset("y"),!0;et("zoomPan"),e.lastNow=Re(),e.panAnimLoop()},Wt=function(e,t){var r,n,a;if(ie||(mt=f),"swipe"===e){var s=ct.x-ut.x,c=t.lastFlickDist.x<10;s>it&&(c||t.lastFlickOffset.x>20)?n=-1:s<-it&&(c||t.lastFlickOffset.x<-20)&&(n=1)}n&&((f+=n)<0?(f=l.loop?Qt()-1:0,a=!0):f>=Qt()&&(f=l.loop?0:Qt()-1,a=!0),(!a||l.loop)&&(be+=n,ve-=n,r=!0));var u,d=ye.x*ve,p=Math.abs(d-yt.x);return r||d>yt.x==t.lastFlickSpeed.x>0?(u=Math.abs(t.lastFlickSpeed.x)>0?p/Math.abs(t.lastFlickSpeed.x):333,u=Math.min(u,400),u=Math.max(u,250)):u=333,mt===f&&(r=!1),ie=!0,Ie("mainScrollAnimStart"),rt("mainScroll",yt.x,d,u,i.easing.cubic.out,je,(function(){tt(),ie=!1,mt=-1,(r||mt!==f)&&o.updateCurrItem(),Ie("mainScrollAnimComplete")})),r&&o.updateCurrItem(!0),r},Gt=function(e){return 1/te*e*b},Kt=function(){var e=y,t=He(),r=We();y<t?e=t:y>r&&(e=r);var n,a=1,s=le;return se&&!H&&!ce&&y<t?(o.close(),!0):(se&&(n=function(e){Te((a-s)*e+s)}),o.zoomTo(e,0,200,i.easing.cubic.out,n),!0)};xe("Gestures",{publicMethods:{initGestures:function(){var e=function(e,t,r,n,i){k=e+t,O=e+r,I=e+n,R=i?e+i:""};(A=L.pointerEvent)&&L.touch&&(L.touch=!1),A?navigator.msPointerEnabled?e("MSPointer","Down","Move","Up","Cancel"):e("pointer","down","move","up","cancel"):L.touch?(e("touch","start","move","end","cancel"),N=!0):e("mouse","down","move","up"),m=O+" "+I+" "+R,v=k,A&&!N&&(N=navigator.maxTouchPoints>1||navigator.msMaxTouchPoints>1),o.likelyTouchDevice=N,g[k]=Lt,g[O]=$t,g[I]=zt,R&&(g[R]=g[I]),L.touch&&(v+=" mousedown",m+=" mousemove mouseup",g.mousedown=g[k],g.mousemove=g[O],g.mouseup=g[I]),N||(l.allowPanToNext=!1)}}});var qt,Yt,Xt,Zt,Jt,Qt,er=function(t,r,n,a){var s;qt&&clearTimeout(qt),Zt=!0,Xt=!0,t.initialLayout?(s=t.initialLayout,t.initialLayout=null):s=l.getThumbBoundsFn&&l.getThumbBoundsFn(f);var c,u,p=n?l.hideAnimationDuration:l.showAnimationDuration,h=function(){Qe("initialZoom"),n?(o.template.removeAttribute("style"),o.bg.removeAttribute("style")):(Te(1),r&&(r.style.display="block"),i.addClass(e,"pswp--animated-in"),Ie("initialZoom"+(n?"OutEnd":"InEnd"))),a&&a(),Zt=!1};if(!p||!s||void 0===s.x)return Ie("initialZoom"+(n?"Out":"In")),y=t.initialZoomLevel,Fe(he,t.initialPosition),Ne(),e.style.opacity=n?0:1,Te(1),void(p?setTimeout((function(){h()}),p):h());c=d,u=!o.currItem.src||o.currItem.loadError||l.showHideOpacity,t.miniImg&&(t.miniImg.style.webkitBackfaceVisibility="hidden"),n||(y=s.w/t.w,he.x=s.x,he.y=s.y-D,o[u?"template":"bg"].style.opacity=.001,Ne()),et("initialZoom"),n&&!c&&i.removeClass(e,"pswp--animated-in"),u&&(n?i[(c?"remove":"add")+"Class"](e,"pswp--animate_opacity"):setTimeout((function(){i.addClass(e,"pswp--animate_opacity")}),30)),qt=setTimeout((function(){if(Ie("initialZoom"+(n?"Out":"In")),n){var r=s.w/t.w,o={x:he.x,y:he.y},a=y,l=le,d=function(t){1===t?(y=r,he.x=s.x,he.y=s.y-V):(y=(r-a)*t+a,he.x=(s.x-o.x)*t+o.x,he.y=(s.y-V-o.y)*t+o.y),Ne(),u?e.style.opacity=1-t:Te(l-t*l)};c?rt("initialZoom",0,1,p,i.easing.cubic.out,d,h):(d(1),qt=setTimeout(h,p+20))}else y=t.initialZoomLevel,Fe(he,t.initialPosition),Ne(),Te(1),u?e.style.opacity=1:Te(1),qt=setTimeout(h,p+20)}),n?25:90)},tr={},rr=[],nr={index:0,errorMsg:'<div class="pswp__error-msg"><a href="%url%" target="_blank">The image</a> could not be loaded.</div>',forceProgressiveLoading:!1,preload:[1,1],getNumItemsFn:function(){return Yt.length}},ir=function(){return{center:{x:0,y:0},max:{x:0,y:0},min:{x:0,y:0}}},or=function(e,t,r){var n=e.bounds;n.center.x=Math.round((tr.x-t)/2),n.center.y=Math.round((tr.y-r)/2)+e.vGap.top,n.max.x=t>tr.x?Math.round(tr.x-t):n.center.x,n.max.y=r>tr.y?Math.round(tr.y-r)+e.vGap.top:n.center.y,n.min.x=t>tr.x?0:n.center.x,n.min.y=r>tr.y?e.vGap.top:n.center.y},ar=function(e,t,r){if(e.src&&!e.loadError){var n=!r;if(n&&(e.vGap||(e.vGap={top:0,bottom:0}),Ie("parseVerticalMargin",e)),tr.x=t.x,tr.y=t.y-e.vGap.top-e.vGap.bottom,n){var i=tr.x/e.w,o=tr.y/e.h;e.fitRatio=i<o?i:o;var a=l.scaleMode;"orig"===a?r=1:"fit"===a&&(r=e.fitRatio),r>1&&(r=1),e.initialZoomLevel=r,e.bounds||(e.bounds=ir())}return r?(or(e,e.w*r,e.h*r),n&&r===e.initialZoomLevel&&(e.initialPosition=e.bounds.center),e.bounds):void 0}return e.w=e.h=0,e.initialZoomLevel=e.fitRatio=1,e.bounds=ir(),e.initialPosition=e.bounds.center,e.bounds},sr=function(e,t,r,n,i,a){t.loadError||n&&(t.imageAppended=!0,ur(t,n,t===o.currItem&&Ee),r.appendChild(n),a&&setTimeout((function(){t&&t.loaded&&t.placeholder&&(t.placeholder.style.display="none",t.placeholder=null)}),500))},lr=function(e){e.loading=!0,e.loaded=!1;var t=e.img=i.createEl("pswp__img","img"),r=function(){e.loading=!1,e.loaded=!0,e.loadComplete?e.loadComplete(e):e.img=null,t.onload=t.onerror=null,t=null};return t.onload=r,t.onerror=function(){e.loadError=!0,r()},t.src=e.src,t},cr=function(e,t){if(e.src&&e.loadError&&e.container)return t&&(e.container.innerHTML=""),e.container.innerHTML=l.errorMsg.replace("%url%",e.src),!0},ur=function(e,t,r){if(e.src){t||(t=e.container.lastChild);var n=r?e.w:Math.round(e.w*e.fitRatio),i=r?e.h:Math.round(e.h*e.fitRatio);e.placeholder&&!e.loaded&&(e.placeholder.style.width=n+"px",e.placeholder.style.height=i+"px"),t.style.width=n+"px",t.style.height=i+"px"}},dr=function(){if(rr.length){for(var e,t=0;t<rr.length;t++)(e=rr[t]).holder.index===e.index&&sr(e.index,e.item,e.baseDiv,e.img,!1,e.clearPlaceholder);rr=[]}};xe("Controller",{publicMethods:{lazyLoadItem:function(e){e=Se(e);var t=Jt(e);!t||(t.loaded||t.loading)&&!E||(Ie("gettingData",e,t),t.src&&lr(t))},initController:function(){i.extend(l,nr,!0),o.items=Yt=r,Jt=o.getItemAt,Qt=l.getNumItemsFn,l.loop,Qt()<3&&(l.loop=!1),Oe("beforeChange",(function(e){var t,r=l.preload,n=null===e||e>=0,i=Math.min(r[0],Qt()),a=Math.min(r[1],Qt());for(t=1;t<=(n?a:i);t++)o.lazyLoadItem(f+t);for(t=1;t<=(n?i:a);t++)o.lazyLoadItem(f-t)})),Oe("initialLayout",(function(){o.currItem.initialLayout=l.getThumbBoundsFn&&l.getThumbBoundsFn(f)})),Oe("mainScrollAnimComplete",dr),Oe("initialZoomInEnd",dr),Oe("destroy",(function(){for(var e,t=0;t<Yt.length;t++)(e=Yt[t]).container&&(e.container=null),e.placeholder&&(e.placeholder=null),e.img&&(e.img=null),e.preloader&&(e.preloader=null),e.loadError&&(e.loaded=e.loadError=!1);rr=null}))},getItemAt:function(e){return e>=0&&void 0!==Yt[e]&&Yt[e]},allowProgressiveImg:function(){return l.forceProgressiveLoading||!N||l.mouseUsed||screen.width>1200},setContent:function(e,t){l.loop&&(t=Se(t));var r=o.getItemAt(e.index);r&&(r.container=null);var n,a=o.getItemAt(t);if(a){Ie("gettingData",t,a),e.index=t,e.item=a;var s=a.container=i.createEl("pswp__zoom-wrap");if(!a.src&&a.html&&(a.html.tagName?s.appendChild(a.html):s.innerHTML=a.html),cr(a),ar(a,me),!a.src||a.loadError||a.loaded)a.src&&!a.loadError&&((n=i.createEl("pswp__img","img")).style.opacity=1,n.src=a.src,ur(a,n),sr(t,a,s,n));else{if(a.loadComplete=function(r){if(c){if(e&&e.index===t){if(cr(r,!0))return r.loadComplete=r.img=null,ar(r,me),Me(r),void(e.index===f&&o.updateCurrZoomItem());r.imageAppended?!Zt&&r.placeholder&&(r.placeholder.style.display="none",r.placeholder=null):L.transform&&(ie||Zt)?rr.push({item:r,baseDiv:s,img:r.img,index:t,holder:e,clearPlaceholder:!0}):sr(t,r,s,r.img,ie||Zt,!0)}r.loadComplete=null,r.img=null,Ie("imageLoadComplete",t,r)}},i.features.transform){var u="pswp__img pswp__img--placeholder";u+=a.msrc?"":" pswp__img--placeholder--blank";var d=i.createEl(u,a.msrc?"img":"");a.msrc&&(d.src=a.msrc),ur(a,d),s.appendChild(d),a.placeholder=d}a.loading||lr(a),o.allowProgressiveImg()&&(!Xt&&L.transform?rr.push({item:a,baseDiv:s,img:a.img,index:t,holder:e}):sr(t,a,s,a.img,!0,!0))}Xt||t!==f?Me(a):(ne=s.style,er(a,n||a.img)),e.el.innerHTML="",e.el.appendChild(s)}else e.el.innerHTML=""},cleanSlide:function(e){e.img&&(e.img.onload=e.img.onerror=null),e.loaded=e.loading=e.img=e.imageAppended=!1}}});var fr,pr,hr={},mr=function(e,t,r){var n=document.createEvent("CustomEvent"),i={origEvent:e,target:e.target,releasePoint:t,pointerType:r||"touch"};n.initCustomEvent("pswpTap",!0,!0,i),e.target.dispatchEvent(n)};xe("Tap",{publicMethods:{initTap:function(){Oe("firstTouchStart",o.onTapStart),Oe("touchRelease",o.onTapRelease),Oe("destroy",(function(){hr={},fr=null}))},onTapStart:function(e){e.length>1&&(clearTimeout(fr),fr=null)},onTapRelease:function(e,t){if(t&&!X&&!q&&!Je){var r=t;if(fr&&(clearTimeout(fr),fr=null,Ct(r,hr)))return void Ie("doubleTap",r);if("mouse"===t.type)return void mr(e,t,"mouse");if("BUTTON"===e.target.tagName.toUpperCase()||i.hasClass(e.target,"pswp__single-tap"))return void mr(e,t);Fe(hr,r),fr=setTimeout((function(){mr(e,t),fr=null}),300)}}}}),xe("DesktopZoom",{publicMethods:{initDesktopZoom:function(){F||(N?Oe("mouseUsed",(function(){o.setupDesktopZoom()})):o.setupDesktopZoom(!0))},setupDesktopZoom:function(t){pr={};var r="wheel mousewheel DOMMouseScroll";Oe("bindEvents",(function(){i.bind(e,r,o.handleMouseWheel)})),Oe("unbindEvents",(function(){pr&&i.unbind(e,r,o.handleMouseWheel)})),o.mouseZoomedIn=!1;var n,a=function(){o.mouseZoomedIn&&(i.removeClass(e,"pswp--zoomed-in"),o.mouseZoomedIn=!1),y<1?i.addClass(e,"pswp--zoom-allowed"):i.removeClass(e,"pswp--zoom-allowed"),s()},s=function(){n&&(i.removeClass(e,"pswp--dragging"),n=!1)};Oe("resize",a),Oe("afterChange",a),Oe("pointerDown",(function(){o.mouseZoomedIn&&(n=!0,i.addClass(e,"pswp--dragging"))})),Oe("pointerUp",s),t||a()},handleMouseWheel:function(e){if(y<=o.currItem.fitRatio)return l.modal&&(!l.closeOnScroll||Je||K?e.preventDefault():T&&Math.abs(e.deltaY)>2&&(d=!0,o.close())),!0;if(e.stopPropagation(),pr.x=0,"deltaX"in e)1===e.deltaMode?(pr.x=18*e.deltaX,pr.y=18*e.deltaY):(pr.x=e.deltaX,pr.y=e.deltaY);else if("wheelDelta"in e)e.wheelDeltaX&&(pr.x=-.16*e.wheelDeltaX),e.wheelDeltaY?pr.y=-.16*e.wheelDeltaY:pr.y=-.16*e.wheelDelta;else{if(!("detail"in e))return;pr.y=e.detail}Ue(y,!0);var t=he.x-pr.x,r=he.y-pr.y;(l.modal||t<=re.min.x&&t>=re.max.x&&r<=re.min.y&&r>=re.max.y)&&e.preventDefault(),o.panTo(t,r)},toggleDesktopZoom:function(t){t=t||{x:me.x/2+ge.x,y:me.y/2+ge.y};var r=l.getDoubleTapZoom(!0,o.currItem),n=y===r;o.mouseZoomedIn=!n,o.zoomTo(n?o.currItem.initialZoomLevel:r,t,333),i[(n?"remove":"add")+"Class"](e,"pswp--zoomed-in")}}});var vr,gr,yr,br,wr,_r,Cr,Er,xr,Sr,kr,Or,Ir={history:!0,galleryUID:1},Rr=function(){return kr.hash.substring(1)},Tr=function(){vr&&clearTimeout(vr),yr&&clearTimeout(yr)},Ar=function(){var e=Rr(),t={};if(e.length<5)return t;var r,n=e.split("&");for(r=0;r<n.length;r++)if(n[r]){var i=n[r].split("=");i.length<2||(t[i[0]]=i[1])}if(l.galleryPIDs){var o=t.pid;for(t.pid=0,r=0;r<Yt.length;r++)if(Yt[r].pid===o){t.pid=r;break}}else t.pid=parseInt(t.pid,10)-1;return t.pid<0&&(t.pid=0),t},Nr=function(){if(yr&&clearTimeout(yr),Je||K)yr=setTimeout(Nr,500);else{br?clearTimeout(gr):br=!0;var e=f+1,t=Jt(f);t.hasOwnProperty("pid")&&(e=t.pid);var r=Cr+"&gid="+l.galleryUID+"&pid="+e;Er||-1===kr.hash.indexOf(r)&&(Sr=!0);var n=kr.href.split("#")[0]+"#"+r;Or?"#"+r!==window.location.hash&&history[Er?"replaceState":"pushState"]("",document.title,n):Er?kr.replace(n):kr.hash=r,Er=!0,gr=setTimeout((function(){br=!1}),60)}};xe("History",{publicMethods:{initHistory:function(){if(i.extend(l,Ir,!0),l.history){kr=window.location,Sr=!1,xr=!1,Er=!1,Cr=Rr(),Or="pushState"in history,Cr.indexOf("gid=")>-1&&(Cr=(Cr=Cr.split("&gid=")[0]).split("?gid=")[0]),Oe("afterChange",o.updateURL),Oe("unbindEvents",(function(){i.unbind(window,"hashchange",o.onHashChange)}));var e=function(){_r=!0,xr||(Sr?history.back():Cr?kr.hash=Cr:Or?history.pushState("",document.title,kr.pathname+kr.search):kr.hash=""),Tr()};Oe("unbindEvents",(function(){d&&e()})),Oe("destroy",(function(){_r||e()})),Oe("firstUpdate",(function(){f=Ar().pid}));var t=Cr.indexOf("pid=");t>-1&&"&"===(Cr=Cr.substring(0,t)).slice(-1)&&(Cr=Cr.slice(0,-1)),setTimeout((function(){c&&i.bind(window,"hashchange",o.onHashChange)}),40)}},onHashChange:function(){if(Rr()===Cr)return xr=!0,void o.close();br||(wr=!0,o.goTo(Ar().pid),wr=!1)},updateURL:function(){Tr(),!wr&&(Er?vr=setTimeout(Nr,800):Nr())}}}),i.extend(o,nt)};return e}()}(sF);const lF=sF.exports;var cF={exports:{}};!function(e,t){e.exports=function(){var e=function(e,t){var r,n,i,o,a,s,l,c,u,d,f,p,h,m,v,g,y,b,w=this,_=!1,C=!0,E=!0,x={barsSize:{top:44,bottom:"auto"},closeElClasses:["item","caption","zoom-wrap","ui","top-bar"],timeToIdle:4e3,timeToIdleOutside:1e3,loadingIndicatorDelay:1e3,addCaptionHTMLFn:function(e,t){return e.title?(t.children[0].innerHTML=e.title,!0):(t.children[0].innerHTML="",!1)},closeEl:!0,captionEl:!0,fullscreenEl:!0,zoomEl:!0,shareEl:!0,counterEl:!0,arrowEl:!0,preloaderEl:!0,tapToClose:!1,tapToToggleControls:!0,clickToCloseNonZoomable:!0,shareButtons:[{id:"facebook",label:"Share on Facebook",url:"https://www.facebook.com/sharer/sharer.php?u={{url}}"},{id:"twitter",label:"Tweet",url:"https://twitter.com/intent/tweet?text={{text}}&url={{url}}"},{id:"pinterest",label:"Pin it",url:"http://www.pinterest.com/pin/create/button/?url={{url}}&media={{image_url}}&description={{text}}"},{id:"download",label:"Download image",url:"{{raw_image_url}}",download:!0}],getImageURLForShare:function(){return e.currItem.src||""},getPageURLForShare:function(){return window.location.href},getTextForShare:function(){return e.currItem.title||""},indexIndicatorSep:" / ",fitControlsWidth:1200},S=function(e){if(g)return!0;e=e||window.event,v.timeToIdle&&v.mouseUsed&&!u&&j();for(var r,n,i=(e.target||e.srcElement).getAttribute("class")||"",o=0;o<U.length;o++)(r=U[o]).onTap&&i.indexOf("pswp__"+r.name)>-1&&(r.onTap(),n=!0);if(n){e.stopPropagation&&e.stopPropagation(),g=!0;var a=t.features.isOldAndroid?600:30;setTimeout((function(){g=!1}),a)}},k=function(){return!e.likelyTouchDevice||v.mouseUsed||screen.width>v.fitControlsWidth},O=function(e,r,n){t[(n?"add":"remove")+"Class"](e,"pswp__"+r)},I=function(){var e=1===v.getNumItemsFn();e!==m&&(O(n,"ui--one-slide",e),m=e)},R=function(){O(l,"share-modal--hidden",E)},T=function(){return(E=!E)?(t.removeClass(l,"pswp__share-modal--fade-in"),setTimeout((function(){E&&R()}),300)):(R(),setTimeout((function(){E||t.addClass(l,"pswp__share-modal--fade-in")}),30)),E||N(),!1},A=function(t){var r=(t=t||window.event).target||t.srcElement;return e.shout("shareLinkClick",t,r),!(!r.href||!r.hasAttribute("download")&&(window.open(r.href,"pswp_share","scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,top=100,left="+(window.screen?Math.round(screen.width/2-275):100)),E||T(),1))},N=function(){for(var e,t,r,n,i="",o=0;o<v.shareButtons.length;o++)e=v.shareButtons[o],t=v.getImageURLForShare(e),r=v.getPageURLForShare(e),n=v.getTextForShare(e),i+='<a href="'+e.url.replace("{{url}}",encodeURIComponent(r)).replace("{{image_url}}",encodeURIComponent(t)).replace("{{raw_image_url}}",t).replace("{{text}}",encodeURIComponent(n))+'" target="_blank" class="pswp__share--'+e.id+'"'+(e.download?"download":"")+">"+e.label+"</a>",v.parseShareButtonOut&&(i=v.parseShareButtonOut(e,i));l.children[0].innerHTML=i,l.children[0].onclick=A},M=function(e){for(var r=0;r<v.closeElClasses.length;r++)if(t.hasClass(e,"pswp__"+v.closeElClasses[r]))return!0},P=0,j=function(){clearTimeout(b),P=0,u&&w.setIdle(!1)},D=function(e){var t=(e=e||window.event).relatedTarget||e.toElement;(!t||"HTML"===t.nodeName)&&(clearTimeout(b),b=setTimeout((function(){w.setIdle(!0)}),v.timeToIdleOutside))},F=function(){v.fullscreenEl&&!t.features.isOldAndroid&&(r||(r=w.getFullscreenAPI()),r?(t.bind(document,r.eventK,w.updateFullscreen),w.updateFullscreen(),t.addClass(e.template,"pswp--supports-fs")):t.removeClass(e.template,"pswp--supports-fs"))},V=function(){v.preloaderEl&&(L(!0),d("beforeChange",(function(){clearTimeout(h),h=setTimeout((function(){e.currItem&&e.currItem.loading?(!e.allowProgressiveImg()||e.currItem.img&&!e.currItem.img.naturalWidth)&&L(!1):L(!0)}),v.loadingIndicatorDelay)})),d("imageLoadComplete",(function(t,r){e.currItem===r&&L(!0)})))},L=function(e){p!==e&&(O(f,"preloader--active",!e),p=e)},$=function(e){var r=e.vGap;if(k()){var a=v.barsSize;if(v.captionEl&&"auto"===a.bottom)if(o||((o=t.createEl("pswp__caption pswp__caption--fake")).appendChild(t.createEl("pswp__caption__center")),n.insertBefore(o,i),t.addClass(n,"pswp__ui--fit")),v.addCaptionHTMLFn(e,o,!0)){var s=o.clientHeight;r.bottom=parseInt(s,10)||44}else r.bottom=a.top;else r.bottom="auto"===a.bottom?0:a.bottom;r.top=a.top}else r.top=r.bottom=0},B=function(){v.timeToIdle&&d("mouseUsed",(function(){t.bind(document,"mousemove",j),t.bind(document,"mouseout",D),y=setInterval((function(){2==++P&&w.setIdle(!0)}),v.timeToIdle/2)}))},z=function(){var e;d("onVerticalDrag",(function(e){C&&e<.95?w.hideControls():!C&&e>=.95&&w.showControls()})),d("onPinchClose",(function(t){C&&t<.9?(w.hideControls(),e=!0):e&&!C&&t>.9&&w.showControls()})),d("zoomGestureEnded",(function(){(e=!1)&&!C&&w.showControls()}))},U=[{name:"caption",option:"captionEl",onInit:function(e){i=e}},{name:"share-modal",option:"shareEl",onInit:function(e){l=e},onTap:function(){T()}},{name:"button--share",option:"shareEl",onInit:function(e){s=e},onTap:function(){T()}},{name:"button--zoom",option:"zoomEl",onTap:e.toggleDesktopZoom},{name:"counter",option:"counterEl",onInit:function(e){a=e}},{name:"button--close",option:"closeEl",onTap:e.close},{name:"button--arrow--left",option:"arrowEl",onTap:e.prev},{name:"button--arrow--right",option:"arrowEl",onTap:e.next},{name:"button--fs",option:"fullscreenEl",onTap:function(){r.isFullscreen()?r.exit():r.enter()}},{name:"preloader",option:"preloaderEl",onInit:function(e){f=e}}],H=function(){var e,r,i,o=function(n){if(n)for(var o=n.length,a=0;a<o;a++){e=n[a],r=e.className;for(var s=0;s<U.length;s++)i=U[s],r.indexOf("pswp__"+i.name)>-1&&(v[i.option]?(t.removeClass(e,"pswp__element--disabled"),i.onInit&&i.onInit(e)):t.addClass(e,"pswp__element--disabled"))}};o(n.children);var a=t.getChildByClass(n,"pswp__top-bar");a&&o(a.children)};w.init=function(){t.extend(e.options,x,!0),v=e.options,n=t.getChildByClass(e.scrollWrap,"pswp__ui"),d=e.listen,z(),d("beforeChange",w.update),d("doubleTap",(function(t){var r=e.currItem.initialZoomLevel;e.getZoomLevel()!==r?e.zoomTo(r,t,333):e.zoomTo(v.getDoubleTapZoom(!1,e.currItem),t,333)})),d("preventDragEvent",(function(e,t,r){var n=e.target||e.srcElement;n&&n.getAttribute("class")&&e.type.indexOf("mouse")>-1&&(n.getAttribute("class").indexOf("__caption")>0||/(SMALL|STRONG|EM)/i.test(n.tagName))&&(r.prevent=!1)})),d("bindEvents",(function(){t.bind(n,"pswpTap click",S),t.bind(e.scrollWrap,"pswpTap",w.onGlobalTap),e.likelyTouchDevice||t.bind(e.scrollWrap,"mouseover",w.onMouseOver)})),d("unbindEvents",(function(){E||T(),y&&clearInterval(y),t.unbind(document,"mouseout",D),t.unbind(document,"mousemove",j),t.unbind(n,"pswpTap click",S),t.unbind(e.scrollWrap,"pswpTap",w.onGlobalTap),t.unbind(e.scrollWrap,"mouseover",w.onMouseOver),r&&(t.unbind(document,r.eventK,w.updateFullscreen),r.isFullscreen()&&(v.hideAnimationDuration=0,r.exit()),r=null)})),d("destroy",(function(){v.captionEl&&(o&&n.removeChild(o),t.removeClass(i,"pswp__caption--empty")),l&&(l.children[0].onclick=null),t.removeClass(n,"pswp__ui--over-close"),t.addClass(n,"pswp__ui--hidden"),w.setIdle(!1)})),v.showAnimationDuration||t.removeClass(n,"pswp__ui--hidden"),d("initialZoomIn",(function(){v.showAnimationDuration&&t.removeClass(n,"pswp__ui--hidden")})),d("initialZoomOut",(function(){t.addClass(n,"pswp__ui--hidden")})),d("parseVerticalMargin",$),H(),v.shareEl&&s&&l&&(E=!0),I(),B(),F(),V()},w.setIdle=function(e){u=e,O(n,"ui--idle",e)},w.update=function(){C&&e.currItem?(w.updateIndexIndicator(),v.captionEl&&(v.addCaptionHTMLFn(e.currItem,i),O(i,"caption--empty",!e.currItem.title)),_=!0):_=!1,E||T(),I()},w.updateFullscreen=function(n){n&&setTimeout((function(){e.setScrollOffset(0,t.getScrollY())}),50),t[(r.isFullscreen()?"add":"remove")+"Class"](e.template,"pswp--fs")},w.updateIndexIndicator=function(){v.counterEl&&(a.innerHTML=e.getCurrentIndex()+1+v.indexIndicatorSep+v.getNumItemsFn())},w.onGlobalTap=function(r){var n=(r=r||window.event).target||r.srcElement;if(!g)if(r.detail&&"mouse"===r.detail.pointerType){if(M(n))return void e.close();t.hasClass(n,"pswp__img")&&(1===e.getZoomLevel()&&e.getZoomLevel()<=e.currItem.fitRatio?v.clickToCloseNonZoomable&&e.close():e.toggleDesktopZoom(r.detail.releasePoint))}else if(v.tapToToggleControls&&(C?w.hideControls():w.showControls()),v.tapToClose&&(t.hasClass(n,"pswp__img")||M(n)))return void e.close()},w.onMouseOver=function(e){var t=(e=e||window.event).target||e.srcElement;O(n,"ui--over-close",M(t))},w.hideControls=function(){t.addClass(n,"pswp__ui--hidden"),C=!1},w.showControls=function(){C=!0,_||w.update(),t.removeClass(n,"pswp__ui--hidden")},w.supportsFullscreen=function(){var e=document;return!!(e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen)},w.getFullscreenAPI=function(){var t,r=document.documentElement,n="fullscreenchange";return r.requestFullscreen?t={enterK:"requestFullscreen",exitK:"exitFullscreen",elementK:"fullscreenElement",eventK:n}:r.mozRequestFullScreen?t={enterK:"mozRequestFullScreen",exitK:"mozCancelFullScreen",elementK:"mozFullScreenElement",eventK:"moz"+n}:r.webkitRequestFullscreen?t={enterK:"webkitRequestFullscreen",exitK:"webkitExitFullscreen",elementK:"webkitFullscreenElement",eventK:"webkit"+n}:r.msRequestFullscreen&&(t={enterK:"msRequestFullscreen",exitK:"msExitFullscreen",elementK:"msFullscreenElement",eventK:"MSFullscreenChange"}),t&&(t.enter=function(){if(c=v.closeOnScroll,v.closeOnScroll=!1,"webkitRequestFullscreen"!==this.enterK)return e.template[this.enterK]();e.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT)},t.exit=function(){return v.closeOnScroll=c,document[this.exitK]()},t.isFullscreen=function(){return document[this.elementK]}),t}};return e}()}(cF);const uF=cF.exports;var dF,fF={exports:{}},pF={exports:{}},hF={};var mF,vF,gF,yF,bF,wF,_F,CF,EF,xF,SF,kF,OF,IF,RF={};function TF(){return vF||(vF=1,function(e){"production"===Ti.exports.env.NODE_ENV?e.exports=function(){if(dF)return hF;dF=1;var e="function"==typeof Symbol&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,a=e?Symbol.for("react.provider"):60109,s=e?Symbol.for("react.context"):60110,l=e?Symbol.for("react.async_mode"):60111,c=e?Symbol.for("react.concurrent_mode"):60111,u=e?Symbol.for("react.forward_ref"):60112,d=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,p=e?Symbol.for("react.memo"):60115,h=e?Symbol.for("react.lazy"):60116,m=e?Symbol.for("react.block"):60121,v=e?Symbol.for("react.fundamental"):60117,g=e?Symbol.for("react.responder"):60118,y=e?Symbol.for("react.scope"):60119;function b(e){if("object"==typeof e&&null!==e){var f=e.$$typeof;switch(f){case t:switch(e=e.type){case l:case c:case n:case o:case i:case d:return e;default:switch(e=e&&e.$$typeof){case s:case u:case h:case p:case a:return e;default:return f}}case r:return f}}}function w(e){return b(e)===c}return hF.AsyncMode=l,hF.ConcurrentMode=c,hF.ContextConsumer=s,hF.ContextProvider=a,hF.Element=t,hF.ForwardRef=u,hF.Fragment=n,hF.Lazy=h,hF.Memo=p,hF.Portal=r,hF.Profiler=o,hF.StrictMode=i,hF.Suspense=d,hF.isAsyncMode=function(e){return w(e)||b(e)===l},hF.isConcurrentMode=w,hF.isContextConsumer=function(e){return b(e)===s},hF.isContextProvider=function(e){return b(e)===a},hF.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===t},hF.isForwardRef=function(e){return b(e)===u},hF.isFragment=function(e){return b(e)===n},hF.isLazy=function(e){return b(e)===h},hF.isMemo=function(e){return b(e)===p},hF.isPortal=function(e){return b(e)===r},hF.isProfiler=function(e){return b(e)===o},hF.isStrictMode=function(e){return b(e)===i},hF.isSuspense=function(e){return b(e)===d},hF.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===n||e===c||e===o||e===i||e===d||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===h||e.$$typeof===p||e.$$typeof===a||e.$$typeof===s||e.$$typeof===u||e.$$typeof===v||e.$$typeof===g||e.$$typeof===y||e.$$typeof===m)},hF.typeOf=b,hF}():e.exports=(mF||(mF=1,"production"!==Ti.exports.env.NODE_ENV&&function(){var e="function"==typeof Symbol&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,a=e?Symbol.for("react.provider"):60109,s=e?Symbol.for("react.context"):60110,l=e?Symbol.for("react.async_mode"):60111,c=e?Symbol.for("react.concurrent_mode"):60111,u=e?Symbol.for("react.forward_ref"):60112,d=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,p=e?Symbol.for("react.memo"):60115,h=e?Symbol.for("react.lazy"):60116,m=e?Symbol.for("react.block"):60121,v=e?Symbol.for("react.fundamental"):60117,g=e?Symbol.for("react.responder"):60118,y=e?Symbol.for("react.scope"):60119;function b(e){if("object"==typeof e&&null!==e){var f=e.$$typeof;switch(f){case t:var m=e.type;switch(m){case l:case c:case n:case o:case i:case d:return m;default:var v=m&&m.$$typeof;switch(v){case s:case u:case h:case p:case a:return v;default:return f}}case r:return f}}}var w=l,_=c,C=s,E=a,x=t,S=u,k=n,O=h,I=p,R=r,T=o,A=i,N=d,M=!1;function P(e){return b(e)===c}RF.AsyncMode=w,RF.ConcurrentMode=_,RF.ContextConsumer=C,RF.ContextProvider=E,RF.Element=x,RF.ForwardRef=S,RF.Fragment=k,RF.Lazy=O,RF.Memo=I,RF.Portal=R,RF.Profiler=T,RF.StrictMode=A,RF.Suspense=N,RF.isAsyncMode=function(e){return M||(M=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),P(e)||b(e)===l},RF.isConcurrentMode=P,RF.isContextConsumer=function(e){return b(e)===s},RF.isContextProvider=function(e){return b(e)===a},RF.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===t},RF.isForwardRef=function(e){return b(e)===u},RF.isFragment=function(e){return b(e)===n},RF.isLazy=function(e){return b(e)===h},RF.isMemo=function(e){return b(e)===p},RF.isPortal=function(e){return b(e)===r},RF.isProfiler=function(e){return b(e)===o},RF.isStrictMode=function(e){return b(e)===i},RF.isSuspense=function(e){return b(e)===d},RF.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===n||e===c||e===o||e===i||e===d||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===h||e.$$typeof===p||e.$$typeof===a||e.$$typeof===s||e.$$typeof===u||e.$$typeof===v||e.$$typeof===g||e.$$typeof===y||e.$$typeof===m)},RF.typeOf=b}()),RF)}(pF)),pF.exports}function AF(){if(yF)return gF;yF=1;var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;return gF=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch{return!1}}()?Object.assign:function(n,i){for(var o,a,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(n),l=1;l<arguments.length;l++){for(var c in o=Object(arguments[l]))t.call(o,c)&&(s[c]=o[c]);if(e){a=e(o);for(var u=0;u<a.length;u++)r.call(o,a[u])&&(s[a[u]]=o[a[u]])}}return s},gF}function NF(){if(wF)return bF;wF=1;return bF="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}function MF(){return CF||(CF=1,_F=Function.call.bind(Object.prototype.hasOwnProperty)),_F}if("production"!==Ti.exports.env.NODE_ENV){var PF=TF();fF.exports=function(){if(kF)return SF;kF=1;var e=TF(),t=AF(),r=NF(),n=MF(),i=function(){if(xF)return EF;xF=1;var e=function(){};if("production"!==Ti.exports.env.NODE_ENV){var t=NF(),r={},n=MF();e=function(e){var t="Warning: "+e;typeof console<"u"&&console.error(t);try{throw new Error(t)}catch{}}}function i(i,o,a,s,l){if("production"!==Ti.exports.env.NODE_ENV)for(var c in i)if(n(i,c)){var u;try{if("function"!=typeof i[c]){var d=Error((s||"React class")+": "+a+" type `"+c+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof i[c]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw d.name="Invariant Violation",d}u=i[c](o,c,s,a,null,t)}catch(e){u=e}if(u&&!(u instanceof Error)&&e((s||"React class")+": type specification of "+a+" `"+c+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof u+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),u instanceof Error&&!(u.message in r)){r[u.message]=!0;var f=l?l():"";e("Failed "+a+" type: "+u.message+(null!=f?f:""))}}}return i.resetWarningCache=function(){"production"!==Ti.exports.env.NODE_ENV&&(r={})},EF=i}(),o=function(){};function a(){return null}return"production"!==Ti.exports.env.NODE_ENV&&(o=function(e){var t="Warning: "+e;typeof console<"u"&&console.error(t);try{throw new Error(t)}catch{}}),SF=function(s,l){var c="function"==typeof Symbol&&Symbol.iterator,u="@@iterator",d="<<anonymous>>",f={array:v("array"),bigint:v("bigint"),bool:v("boolean"),func:v("function"),number:v("number"),object:v("object"),string:v("string"),symbol:v("symbol"),any:m(a),arrayOf:function(e){return m((function(t,n,i,o,a){if("function"!=typeof e)return new h("Property `"+a+"` of component `"+i+"` has invalid PropType notation inside arrayOf.");var s=t[n];if(!Array.isArray(s))return new h("Invalid "+o+" `"+a+"` of type `"+b(s)+"` supplied to `"+i+"`, expected an array.");for(var l=0;l<s.length;l++){var c=e(s,l,i,o,a+"["+l+"]",r);if(c instanceof Error)return c}return null}))},element:m((function(e,t,r,n,i){var o=e[t];return s(o)?null:new h("Invalid "+n+" `"+i+"` of type `"+b(o)+"` supplied to `"+r+"`, expected a single ReactElement.")})),elementType:m((function(t,r,n,i,o){var a=t[r];return e.isValidElementType(a)?null:new h("Invalid "+i+" `"+o+"` of type `"+b(a)+"` supplied to `"+n+"`, expected a single ReactElement type.")})),instanceOf:function(e){return m((function(t,r,n,i,o){if(!(t[r]instanceof e)){var a=e.name||d,s=function(e){return e.constructor&&e.constructor.name?e.constructor.name:d}(t[r]);return new h("Invalid "+i+" `"+o+"` of type `"+s+"` supplied to `"+n+"`, expected instance of `"+a+"`.")}return null}))},node:m((function(e,t,r,n,i){return y(e[t])?null:new h("Invalid "+n+" `"+i+"` supplied to `"+r+"`, expected a ReactNode.")})),objectOf:function(e){return m((function(t,i,o,a,s){if("function"!=typeof e)return new h("Property `"+s+"` of component `"+o+"` has invalid PropType notation inside objectOf.");var l=t[i],c=b(l);if("object"!==c)return new h("Invalid "+a+" `"+s+"` of type `"+c+"` supplied to `"+o+"`, expected an object.");for(var u in l)if(n(l,u)){var d=e(l,u,o,a,s+"."+u,r);if(d instanceof Error)return d}return null}))},oneOf:function(e){return Array.isArray(e)?m((function(t,r,n,i,o){for(var a=t[r],s=0;s<e.length;s++)if(p(a,e[s]))return null;var l=JSON.stringify(e,(function(e,t){return"symbol"===w(t)?String(t):t}));return new h("Invalid "+i+" `"+o+"` of value `"+String(a)+"` supplied to `"+n+"`, expected one of "+l+".")})):("production"!==Ti.exports.env.NODE_ENV&&o(arguments.length>1?"Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).":"Invalid argument supplied to oneOf, expected an array."),a)},oneOfType:function(e){if(!Array.isArray(e))return"production"!==Ti.exports.env.NODE_ENV&&o("Invalid argument supplied to oneOfType, expected an instance of array."),a;for(var t=0;t<e.length;t++){var i=e[t];if("function"!=typeof i)return o("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+_(i)+" at index "+t+"."),a}return m((function(t,i,o,a,s){for(var l=[],c=0;c<e.length;c++){var u=(0,e[c])(t,i,o,a,s,r);if(null==u)return null;u.data&&n(u.data,"expectedType")&&l.push(u.data.expectedType)}return new h("Invalid "+a+" `"+s+"` supplied to `"+o+"`"+(l.length>0?", expected one of type ["+l.join(", ")+"]":"")+".")}))},shape:function(e){return m((function(t,n,i,o,a){var s=t[n],l=b(s);if("object"!==l)return new h("Invalid "+o+" `"+a+"` of type `"+l+"` supplied to `"+i+"`, expected `object`.");for(var c in e){var u=e[c];if("function"!=typeof u)return g(i,o,a,c,w(u));var d=u(s,c,i,o,a+"."+c,r);if(d)return d}return null}))},exact:function(e){return m((function(i,o,a,s,l){var c=i[o],u=b(c);if("object"!==u)return new h("Invalid "+s+" `"+l+"` of type `"+u+"` supplied to `"+a+"`, expected `object`.");var d=t({},i[o],e);for(var f in d){var p=e[f];if(n(e,f)&&"function"!=typeof p)return g(a,s,l,f,w(p));if(!p)return new h("Invalid "+s+" `"+l+"` key `"+f+"` supplied to `"+a+"`.\nBad object: "+JSON.stringify(i[o],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var m=p(c,f,a,s,l+"."+f,r);if(m)return m}return null}))}};function p(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function h(e,t){this.message=e,this.data=t&&"object"==typeof t?t:{},this.stack=""}function m(e){if("production"!==Ti.exports.env.NODE_ENV)var t={},n=0;function i(i,a,s,c,u,f,p){if(c=c||d,f=f||s,p!==r){if(l){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}if("production"!==Ti.exports.env.NODE_ENV&&typeof console<"u"){var v=c+":"+s;!t[v]&&n<3&&(o("You are manually calling a React.PropTypes validation function for the `"+f+"` prop on `"+c+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),t[v]=!0,n++)}}return null==a[s]?i?null===a[s]?new h("The "+u+" `"+f+"` is marked as required in `"+c+"`, but its value is `null`."):new h("The "+u+" `"+f+"` is marked as required in `"+c+"`, but its value is `undefined`."):null:e(a,s,c,u,f)}var a=i.bind(null,!1);return a.isRequired=i.bind(null,!0),a}function v(e){return m((function(t,r,n,i,o,a){var s=t[r];return b(s)!==e?new h("Invalid "+i+" `"+o+"` of type `"+w(s)+"` supplied to `"+n+"`, expected `"+e+"`.",{expectedType:e}):null}))}function g(e,t,r,n,i){return new h((e||"React class")+": "+t+" type `"+r+"."+n+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+i+"`.")}function y(e){switch(typeof e){case"number":case"string":case"undefined":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(y);if(null===e||s(e))return!0;var t=function(e){var t=e&&(c&&e[c]||e[u]);if("function"==typeof t)return t}(e);if(!t)return!1;var r,n=t.call(e);if(t!==e.entries){for(;!(r=n.next()).done;)if(!y(r.value))return!1}else for(;!(r=n.next()).done;){var i=r.value;if(i&&!y(i[1]))return!1}return!0;default:return!1}}function b(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||!!t&&("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}(t,e)?"symbol":t}function w(e){if(typeof e>"u"||null===e)return""+e;var t=b(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function _(e){var t=w(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}return h.prototype=Error.prototype,f.checkPropTypes=i,f.resetWarningCache=i.resetWarningCache,f.PropTypes=f,f},SF}()(PF.isElement,!0)}else fF.exports=function(){if(IF)return OF;IF=1;var e=NF();function t(){}function r(){}return r.resetWarningCache=t,OF=function(){function n(t,r,n,i,o,a){if(a!==e){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function i(){return n}n.isRequired=n;var o={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:r,resetWarningCache:t};return o.PropTypes=o,o},OF}()();const jF=.05;class DF extends s.a.Component{constructor(e){super(e),this.state={prevStatus:"default",nextStatus:"default",zoomInStatus:"default",zoomOutStatus:"default",originSizeStatus:"default",bestSizeStatus:"default"}}afterZoom(){const{imageBrowser:e}=this.props,t=e.getCurrentZoomLevel(),r=e.getInitialZoomLevel();let n;t===r&&(n="activated"),1===r&&(n="disable"),this.setState({zoomOutStatus:t===jF?"disable":"default",zoomInStatus:5===t?"disable":"default",originSizeStatus:1===t?"activated":"default",bestSizeStatus:n})}afterChange(){const{imageBrowser:e}=this.props,t=e.getCount();this.setState({nextStatus:1===t?"disable":"default",prevStatus:1===t?"disable":"default"})}componentDidMount(){const{imageBrowser:e}=this.props;e.on("afterzoom",(()=>{this.afterZoom()})),e.on("afterchange",(()=>{this.afterChange()})),e.on("resize",(()=>{setTimeout((()=>{this.afterChange(),this.afterZoom()}),333)})),this.setState({tooltipContainer:this.tooltipContainer})}renderBtn(e,t,r,n){const{tooltipContainer:i}=this.state;return i?s.a.createElement(h.a,{title:t,getPopupContainer:()=>i,mouseEnterDelay:1},s.a.createElement("span",{className:`lake-pswp-${e} btn ${r}`,onClick:n})):""}render(){const{imageBrowser:e,shouldShowNavigation:t,shouldShowDownload:r,shouldShowRemove:n}=this.props,{prevStatus:i,nextStatus:o,zoomInStatus:a,zoomOutStatus:l,originSizeStatus:c,bestSizeStatus:u}=this.state;return s.a.createElement("div",{className:"lake-pswp-tool-bar"},s.a.createElement("div",{ref:e=>{this.tooltipContainer=e}}),s.a.createElement("div",{className:"pswp-toolbar-content"},t&&s.a.createElement(s.a.Fragment,null,this.renderBtn("arrow-left",kf("上一张"),i,(()=>{"disable"!==i&&e.prev()})),s.a.createElement("span",{className:"lake-pswp-counter"}),this.renderBtn("arrow-right",kf("下一张"),o,(()=>{"disable"!==o&&e.next()})),s.a.createElement("span",{className:"separation"})),this.renderBtn("zoom-out",kf("缩小"),l,(()=>{"disable"!==l&&e.zoomOut()})),this.renderBtn("zoom-in",kf("放大"),a,(()=>{"disable"!==a&&e.zoomIn()})),this.renderBtn("origin-size",kf("实际尺寸"),c,(()=>{"disable"!==c&&e.zoomToOriginSize()})),this.renderBtn("best-size",kf("适应屏幕"),u,(()=>{"disable"!==u&&e.zoomToBestSize()})),r&&this.renderBtn("download",kf("下载图片"),null,(()=>{e.download()})),n&&this.renderBtn("remove",kf("删除图片"),null,(()=>{e.remove()}))))}}DF.propTypes={imageBrowser:fF.exports.object,shouldShowNavigation:fF.exports.bool,shouldShowDownload:fF.exports.bool,shouldShowRemove:fF.exports.bool};var FF={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new i(n,o||e,a),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=new Array(o);i<o;i++)a[i]=n[i].fn;return a},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,i,o,a){var s=r?r+e:e;if(!this._events[s])return!1;var l,c,u=this._events[s],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,i),!0;case 5:return u.fn.call(u.context,t,n,i,o),!0;case 6:return u.fn.call(u.context,t,n,i,o,a),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var f,p=u.length;for(c=0;c<p;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,n);break;case 4:u[c].fn.call(u[c].context,t,n,i);break;default:if(!l)for(f=1,l=new Array(d-1);f<d;f++)l[f-1]=arguments[f];u[c].fn.apply(u[c].context,l)}}return!0},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn===t&&(!i||s.once)&&(!n||s.context===n)&&a(this,o);else{for(var l=0,c=[],u=s.length;l<u;l++)(s[l].fn!==t||i&&!s[l].once||n&&s[l].context!==n)&&c.push(s[l]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&a(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s}(FF);const VF=FF.exports;function LF(e){return["http:","https:","data:","blob:","/"].some((t=>e.startsWith(t)))?e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):""}class $F extends VF{constructor(e={}){super();const t=e.pswpOptions||{};this.options={shouldToggleOnHover:!1,shouldShowNavigation:!0,shouldShowDownload:!1,shouldShowRemove:!1,closable:!0,container:document.body,...globalThis.__LakeTableImageBrowser_options||{},...e,pswpOptions:{shareEl:!1,fullscreenEl:!1,zoomEl:!1,history:!1,dragging:oa.isMobile,closeOnScroll:!1,preloaderEl:!1,captionEl:!1,counterEl:!1,clickToCloseNonZoomable:!0,bgOpacity:.8,showAnimationDuration:0,hideAnimationDuration:0,closeOnVerticalDrag:oa.isMobile,tapToClose:!0,barsSize:{top:44,bottom:80},...t}},this.options.closable||(this.options.pswpOptions.escKey=!1,this.options.pswpOptions.closeElClasses=[]),this.images=[],this.pswpDestroy=!0,this.timeouts={},this._initRoot()}static loadImageSize(e,t,r,n=null){if(t.cleanSlide(e),e.loading=!0,n)e.img=n(),e.img.className="pswp__img",setTimeout((()=>{var t;e.loading=!1,e.loaded=!0,null==(t=e.loadComplete)||t.call(e,e)}));else{let n=document.createElement("img");n.className="pswp__img",e.img=n;const i=()=>{if(r.pswpDestroy)return n=null,void(e.img=null);(0===e.w||0===e.h)&&(e.w=n.width,e.h=n.height),e.needUpdate=!0,t.updateSize(),e.loading=!1,e.loaded=!0,e.loadComplete?e.loadComplete(e):e.img=null,n.onload=n.onerror=null,n=null};n.onload=i,n.onerror=function(){e.loadError=!0,i()},n.src=e.src}}_initRoot(){const e=this.options.closable?'<button type="button" class="pswp__button lake-pswp-button-close" title="Close (Esc)"></button>':"",t=document.createElement("div");t.innerHTML=`\n    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">\n        <div class="pswp__bg"></div>\n        <div class="pswp__scroll-wrap">\n            <div class="pswp__container">\n                <div class="pswp__item"></div>\n                <div class="pswp__item"></div>\n                <div class="pswp__item"></div>\n            </div>\n            <div class="pswp__ui pswp__ui--hidden">\n                ${e}\n                <div class="lake-pswp-custom-top-bar"></div>\n            </div>\n        </div>\n    </div>\n    `,this.options.container?this.options.container.appendChild(t):document.body.appendChild(t),this.root=t.children[0],oa.isMobile?this.root.classList.add("lake-pswp-mobile"):this.root.classList.add("lake-pswp-pc");const r=this.root.querySelector(".lake-pswp-custom-top-bar"),n=this.root.querySelector(".lake-pswp-button-close");this.toolbarContainer=r,this.closeBtnContainer=n,c.a.render(s.a.createElement(DF,{imageBrowser:this,shouldShowNavigation:this.options.shouldShowNavigation,shouldShowDownload:this.options.shouldShowDownload,shouldShowRemove:this.options.shouldShowRemove}),r,(()=>{oa.isMobile||(this.bindKeyboardEvnet(),this.bindClickEvent(),this.options.shouldToggleOnHover&&this.hoverControllerFadeInAndOut(r))}))}hoverControllerFadeInAndOut(){const{toolbarContainer:e,closeBtnContainer:t}=this;e.addEventListener("mouseenter",(()=>{this.removeFadeOut(e,"toolbarFadeInAndOut"),this.removeFadeOut(t,"closeFadeInAndOut")})),e.addEventListener("mouseleave",(()=>{this.fadeOut(e,"toolbarFadeInAndOut"),this.fadeOut(t,"closeFadeInAndOut")})),t.addEventListener("mouseenter",(()=>{this.removeFadeOut(e,"toolbarFadeInAndOut"),this.removeFadeOut(t,"closeFadeInAndOut")})),t.addEventListener("mouseleave",(()=>{this.fadeOut(e,"toolbarFadeInAndOut"),this.fadeOut(t,"closeFadeInAndOut")}))}removeFadeOut(e,t){const{timeouts:r}=this;r[t]&&clearTimeout(r[t]),e.removeClass("pswp-fade-out")}fadeOut(e,t){const{timeouts:r}=this;r[t]&&clearTimeout(r[t]),r[t]=setTimeout((()=>{e.addClass("pswp-fade-out")}),3e3)}bindClickEvent(){const{root:e,closeBtnContainer:t}=this;e.addEventListener("click",(e=>{const t=e.target;t.classList.contains("pswp__img")&&setTimeout((()=>{this.currentZoom=null,this.afterZoom()}),366),(t.classList.contains("pswp__bg")||t.classList.contains("lake-pswp-tool-bar"))&&this.close()})),t.addEventListener("click",(()=>{this.close()}))}prev(){this.pswp.prev()}next(){this.pswp.next()}renderCounter(){const{toolbarContainer:e,pswp:t}=this;!e||(e.querySelector(".lake-pswp-counter").innerHTML=`${t.getCurrentIndex()+1} / ${t.items.length}`)}getCurrentZoomLevel(){return this.currentZoom&&Number(this.currentZoom.toFixed(2))||this.pswp&&Number(this.pswp.getZoomLevel().toFixed(2))}zoomTo(e){const t=this.pswp;t.zoomTo(e,{x:t.viewportSize.x/2,y:t.viewportSize.y/2},100),this.currentZoom=e,this.afterZoom()}zoomIn(){const e=this.getCurrentZoomLevel();let t=1.2*e;5!==e&&(t>5&&(t=5),this.zoomTo(t))}zoomOut(){const e=this.getCurrentZoomLevel();if(e!==jF){let t=e/1.2;t<jF&&(t=jF),this.zoomTo(t)}}bindKeyboardEvnet(){this.root.addEventListener("keydown",(e=>{(e.metaKey||e.ctrlKey)&&187===e.keyCode&&(e.preventDefault(),this.zoomIn()),gj("mod+-",e)&&(e.preventDefault(),this.zoomOut())}))}zoomToOriginSize(){this.zoomTo(1)}zoomToBestSize(){const e=this.getInitialZoomLevel();this.zoomTo(e)}getInitialZoomLevel(){return Number(this.pswp.currItem.initialZoomLevel.toFixed(2))}afterZoom(){this.emit("afterzoom")}getCount(){return this.pswp.items.length}afterChange(){if(!oa.isMobile){const e=this.getInitialZoomLevel();this.renderCounter(),this.currentZoom=e,setTimeout((()=>{this.afterZoom()}),100),this.emit("afterchange"),this.currentZoom=this.getInitialZoomLevel()}this.setWhiteBackground()}bindPswpEvent(){const{pswp:e}=this;e.listen("afterChange",(()=>{this.afterChange()})),e.listen("destroy",(()=>{this.pswpDestroy=!0})),e.listen("resize",(()=>{this.emit("resize")})),e.listen("imageLoadComplete",(()=>{this.setWhiteBackground()}))}setWhiteBackground(){const{root:e}=this,t=0===this.options.pswpOptions.bgOpacity?"0 2px 14px rgba(0, 0, 0, 0.25)":"0 0 10px rgba(0, 0, 0, 0.5)";e.querySelectorAll(".pswp__img").forEach((e=>{e.complete?(e.style.background="white",e.style["box-shadow"]=t):e.onload=()=>{e.style.background="white",e.style["box-shadow"]=t}}))}open(e,t){if(!0!==this.pswpDestroy)return;e.forEach((e=>(e.src=LF(e.src),e.msrc=LF(e.msrc),e)));const{root:r}=this,{pswpOptions:n}=this.options,i=new lF(r,uF,e.map((e=>({...e}))),{index:t,...n}),o=i.lazyLoadItem;i.lazyLoadItem=function(t){if(!e[(e.length+t)%e.length].layoutSelf)return o.call(i,t)},i.listen("gettingData",((t,r)=>{isNaN(r.w)||isNaN(r.h)?(r.w=0,r.h=0,$F.loadImageSize(r,i,this)):e[t].layoutSelf&&$F.loadImageSize(r,i,this,e[t].layoutSelf)})),i.items=e.map((e=>(e.src=LF(e.src),e.msrc=LF(e.msrc),e))),i.init(),this.pswp=i,this.pswpDestroy=!1,this.options.shouldToggleOnHover&&(oa.isMobile||(this.toolbarContainer.removeClass("pswp-fade-out"),this.fadeOut(this.toolbarContainer,"toolbarFadeInAndOut"),this.closeBtnContainer.removeClass("pswp-fade-out"),this.fadeOut(this.closeBtnContainer,"closeFadeInAndOut")),r.removeClass("pswp-fade-in"),r.addClass("pswp-fade-in")),this.afterChange(),this.bindPswpEvent()}download(){window.open(this.pswp.currItem.src,"_blank")}remove(){this.emit("remove"),this.destroy()}close(){!this.options.closable||this.pswp&&this.pswp.close()}destroy(){!this.root||(this.close(),this.root.remove(),this.options=null)}}var BF=Object.defineProperty,zF=Object.getOwnPropertyDescriptor;const UF=e=>({src:e.src,msrc:e.src,w:null==e?void 0:e.width,h:null==e?void 0:e.height});function HF(e,t){const r=(globalThis.__LakeTableImageBrowser||(globalThis.__LakeTableImageBrowser=new $F),globalThis.__LakeTableImageBrowser),n=Array.isArray(e)?e.map((e=>UF(e))):[e].map((e=>UF(e)));r.open(n,t||0)}let WF=class{constructor(){this.openerName="image-viewer-opener",this.apps=["image"]}open(e,t={}){let r=t.list,n=t.index||0;r||(n=0,r=[{src:e,width:t.width,height:t.height}]),HF(r,n)}};WF=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?zF(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&BF(t,r,o),o})([eo()],WF);var GF=Object.defineProperty,KF=Object.getOwnPropertyDescriptor;let qF=class{constructor(){this.openerName="user-opener",this.apps=["user"]}open(e){!e.login||window.open("/"+e.login,"_blank")}};qF=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?KF(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&GF(t,r,o),o})([eo()],qF);var YF=Object.defineProperty,XF=Object.getOwnPropertyDescriptor,ZF=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?XF(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&YF(t,r,o),o};let JF=class{init(){this.registry.registerApp(PD),this.registry.registerApp(jD),this.registry.registerApp(PD),this.registry.registerApp(DD),this.registry.registerApp(VD),this.registry.registerApp(LD),this.registry.registerApp($D),this.registry.registerApp(BD),this.registry.registerOpener(this.filePreviewOpener),this.registry.registerOpener(this.imageViewerOpener),this.registry.registerOpener(this.hrefOpener),this.registry.registerOpener(this.safeRedirectOpener),this.registry.registerOpener(this.userOpener),this.registry.registerOpener(this.windowOpener),this.registry.registerOpener(this.windowNewOpener),this.registry.init();const e=this.openerHash.getHashes();if(e)for(const t of e)!t.name||!t.url||this.openerService.open(t.name,t.url)}initConfiguration(){this._configurationService.registerConfiguration({id:"opener",type:"object",title:"打开器",properties:{useHash:{type:"boolean",description:"opener 是否同步更新 url hash"}}}),this._configurationService.registerDefaultValue({"opener.useHash":!0})}};ZF([to(CD)],JF.prototype,"registry",2),ZF([to(RD)],JF.prototype,"openerHash",2),ZF([to(MD)],JF.prototype,"openerService",2),ZF([to(qf)],JF.prototype,"_configurationService",2),ZF([to(aF)],JF.prototype,"filePreviewOpener",2),ZF([to(WF)],JF.prototype,"imageViewerOpener",2),ZF([to(cD)],JF.prototype,"hrefOpener",2),ZF([to(fD)],JF.prototype,"safeRedirectOpener",2),ZF([to(qF)],JF.prototype,"userOpener",2),ZF([to(yD)],JF.prototype,"windowOpener",2),ZF([to(mD)],JF.prototype,"windowNewOpener",2),JF=ZF([eo()],JF);const QF=bo().contribution(aD).register(kD).register(CD).register(MD).register(RD).register(JF).register(aF).register(WF).register(yD).register(mD).register(cD).register(fD).register(qF);class eV extends Ih{constructor(e){super(),this._activeViewId="",this._options=e,this.container=e.container,this._kernelService=e.kernelService,this._loadCoreServices(),this.registerPlugins(e.plugins,{container:this.container}),this._registerContribs(e.contribs),this.init(),this._logger.log({type:"render",action:"renderInited",data:e})}get renderService(){return this._renderService}init(){this._listenEvent(),this._renderService.init({onError:this._options.onError})}destroy(){this._renderService.destroy(),this.unregisterPlugins(this.container)}render(e){if(!e)throw Error("Can't get active view data.");this._renderService.render(e,this.container)}get _logger(){return this.container.get(ib)}_listenEvent(){this._kernelService.onDataLoaded((e=>{const t=this.container.get(qf).getValue("render.noRecord");if("loadedRecords"!==e&&!t)return;const r=this._readService.getActiveView();r&&(this._activeViewId=r.uuid,this.render(r))})),this._kernelService.onDataChanged((()=>{if(!this.container.get(qf).getValue("render.noRecord")&&this._lifeService.status<gf.RecordReady)return;const e=this._readService.getActiveView();e&&this._activeViewId!==e.uuid&&(this._activeViewId=e.uuid,this.render(e))})),this._lifeService.when(gf.Rendered,(()=>{this.container.get(JF).init()}))}_loadCoreServices(){this._renderService=this.container.get(Zj),this._lifeService=this.container.get(yf),this._readService=this.container.get(Dy)}_registerContribs(e){if(e)for(const t of e)this.container.register(t)}}class tV extends a.Component{constructor(e){super(e),this.state={key:+new Date},this._props=e.props,this._ref=s.a.createRef()}componentDidMount(){}getRef(){return this._ref.current}update(e){this._props={...this._props,...e},this.forceUpdate()}render(){const{component:e,container:t}=this.props;return e instanceof s.a.Component?s.a.createElement(rj,{onError:this.props.onError},s.a.createElement(BA,{value:{container:t,onError:this.props.onError},key:this.state.key},s.a.createElement(e.type,{...this._props,ref:this._ref},e.props.children))):s.a.createElement(rj,{onError:this.props.onError},s.a.createElement(BA,{value:{container:t,onError:this.props.onError},key:this.state.key},s.a.createElement(e,{...this._props,ref:this._ref})," "))}}tV.propTypes={props:fF.exports.object.isRequired,component:fF.exports.any.isRequired,container:fF.exports.object.isRequired,onError:fF.exports.func};class rV{constructor({onError:e}){this._onError=e}render(e,t,r){let n=null;if(!this.Component)throw Error("This view didn't provide view component.");return c.a.render(s.a.createElement(tV,{props:t,component:this.Component,container:r,ref:e=>{n=e},onError:this._onError}),e),{getReactRef:()=>null==n?void 0:n.getRef(),rerender(e){n&&n.update({...e})},destroy(){c.a.unmountComponentAtNode(e),n=null}}}unmount(e){}}var nV=Object.defineProperty,iV=Object.getOwnPropertyDescriptor,oV=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?iV(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&nV(t,r,o),o};let aV=class extends Zf{constructor(){super(...arguments),this._onStatusChange=this._register(new op),this.onStatusChange=this._onStatusChange.event,this.isActive=!1}get isAutoActive(){return this._configurationService.getValue("render.autoActive")}active(){this.isActive||(this.isActive=!0,this._onStatusChange.emit({status:Vj.ACTIVE,isActive:this.isActive}))}inactive(){!this.isActive||(this.isActive=!1,this._onStatusChange.emit({status:Vj.INACTIVE,isActive:this.isActive}))}destroy(){super.destroy()}};oV([to(qf)],aV.prototype,"_configurationService",2),oV([Si()],aV.prototype,"destroy",1),aV=oV([eo({token:Lj})],aV);const sV=bo().contribution(Mj).contribution(Nj).contribution(Fj).register(Zj).register(tD).register(Kj).register(oD).register(Uj).register(aV);var lV=Object.defineProperty,cV=Object.getOwnPropertyDescriptor,uV=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?cV(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&lV(t,r,o),o};const dV=["copy","paste","cut"];let fV=class{constructor(){this._toDestroyStore=new ep,this._ignoreEnableOnInputVerify=!1}init(){this._hotkeyRegister.init(),this._$container=document,this._hotkeyListenerBindEvents()}_getTargetHotkeyByEvent(e){const t=this._getPotentialHotkeyIdsByEvent(e);return this._getEnableHotkey(e,t)}fireEventByEditable(e,t){this._ignoreEnableOnInputVerify=!0,this._dispatchEvent(e,t),this._ignoreEnableOnInputVerify=!1}_dispatchEvent(e,t){let r=null;nd(t)&&dV.includes(t)&&(r=this._hotkeyRegister.getHotkeyItem(t)),t||(r=this._getTargetHotkeyByEvent(e)),r&&(!this._isValidEventInThisHotKey(e,r)||this._runHotkeyCallBack(e,r))}registerItem(e){this._hotkeyRegister.registerItem(e)}getRegisterHotKeys(){return this._hotkeyRegister.getHotkeyItems()}_hotkeyListenerBindEvents(){this._toDestroyStore.push(dA(this._$container,"keydown",(e=>{this._dispatchEvent(e)}))),dV.forEach((e=>{this._toDestroyStore.push(dA(document,e,(t=>{this._dispatchEvent(t,e)})))}))}_getPotentialHotkeyIdsByEvent(e){const t=Oj.keyEventToHotKey(e);return this._hotkeyRegister.getRegisterHotkeyIdsByPressedKey(t)}_getEnableHotkey(e,t){if(t)for(const r of t){const t=this._hotkeyRegister.getHotkeyItem(r);if(this._isValidEventInThisHotKey(e,t))return t}}_isValidEventInThisHotKey(e,t){var r;return!(!e||!t||!this._ignoreEnableOnInputVerify&&function(e){const t=e.target,r=t&&t.tagName,n=Boolean(r&&gA.some((e=>e.toLocaleLowerCase()===r.toLocaleLowerCase()))),i=!(null==t||!t.isContentEditable);return n||i}(e)&&!t.enableOnInput||!this._activeTableService.isActive)&&(!(null==(r=t.isEnable)||!r.call(t))||(mA(e),vA(e),!1))}_runHotkeyCallBack(e,t){!t||(t.preventDefault&&e.preventDefault(),t.onHotKey(e))}destroy(){this._toDestroyStore.destroy(),this._hotkeyRegister.unRegister()}};uV([to(Aj)],fV.prototype,"_hotkeyRegister",2),uV([to(Lj)],fV.prototype,"_activeTableService",2),fV=uV([eo({token:uj})],fV);const pV=bo().contribution(dj).register(fV).register(Aj);function hV(){throw new Error("INVALID_USEEVENT_INVOCATION: the callback from useEvent cannot be invoked before the component has mounted.")}function mV(e){const t=Object(a.useRef)(hV);Object(a.useLayoutEffect)((()=>{t.current=e}),[e]);const r=Object(a.useRef)(null);return r.current||(r.current=function(){return t.current.apply(this,arguments)}),r.current}function vV(e,t,r){const n=Object(a.useRef)(null),i=(null==r?void 0:r.isEnable)||fj.isEnable,o=mV(t);return Object(a.useLayoutEffect)((()=>{const t=t=>{if(null!==n.current&&document.activeElement!==n.current&&!n.current.contains(document.activeElement))return mA(t),void vA(t);Sj(e).forEach((e=>{if(Oj.isKeyboardEventMatchingHotkey(t,e)){if(!i())return mA(t),void vA(t);null!=r&&r.preventDefault&&t.preventDefault(),o(t)}}))};return(n.current||document).addEventListener("keydown",t),()=>{(n.current||document).removeEventListener("keydown",t)}}),[e,o]),n}function gV(e,t,r){const n=Object(a.useRef)(null),i=Object(a.useRef)(0),o=Object(a.useRef)(),s=Object(a.useRef)([]),l=Object(a.useRef)(),c=Object(a.useRef)(),u=Object(a.useRef)(e),d=Object(a.useRef)(!0);Object(a.useEffect)((()=>{u.current=e}),[e]);const f=!t&&0!==t&&typeof window<"u";if("function"!=typeof e)throw new TypeError("Expected a function");t=t||0;const p=!!(r=r||{}).leading,h=!("trailing"in r)||!!r.trailing,m="maxWait"in r,v=m?Math.max(r.maxWait||0,t):null;return Object(a.useEffect)((()=>(d.current=!0,()=>{d.current=!1})),[]),Object(a.useMemo)((()=>{const e=e=>{const t=s.current,r=l.current;return s.current=l.current=[],i.current=e,c.current=u.current.apply(r,t)},r=(e,t)=>{f&&o.current&&cancelAnimationFrame(o.current),o.current=f?requestAnimationFrame(e):setTimeout(e,t)},a=e=>{if(!d.current)return!1;const r=e-(n.current||0),o=e-i.current;return!n.current||r>=(t||0)||r<0||m&&o>=(v||0)},g=t=>(o.current=null,h&&s.current?e(t):(s.current=l.current=null,c.current)),y=()=>{const e=Date.now();if(a(e))return g(e);if(!d.current)return;const o=e-(n.current||0),s=e-i.current,l=(t||0)-o,c=m?Math.min(l,(v||0)-s):l;r(y,c)},b=(...u)=>{const f=Date.now(),h=a(f);if(s.current=u,l.current=this,n.current=f,h){if(!o.current&&d.current)return i.current=n.current,r(y,t||0),p?e(n.current):c.current;if(m)return r(y,t||0),e(n.current)}return o.current||r(y,t||0),c.current};return b.cancel=()=>{o.current&&(f?cancelAnimationFrame(o.current):clearTimeout(o.current)),i.current=0,s.current=n.current=l.current=o.current=null},b.isPending=()=>!!o.current,b.flush=()=>o.current?g(Date.now()):c.current,b}),[p,m,t,v,h,f])}function yV(e){const[t,r]=Object(a.useState)({bottom:0,height:0,left:0,right:0,top:0,width:0,x:0,y:0}),n=Object(a.useRef)(),i=Object(a.useRef)(),o=Object(a.useCallback)((e=>e.width!==(null==t?void 0:t.width)||e.height!==(null==t?void 0:t.height)||e.left!==(null==t?void 0:t.left)||e.right!==(null==t?void 0:t.right)||e.top!==(null==t?void 0:t.top)||e.bottom!==(null==t?void 0:t.bottom)||e.x!==(null==t?void 0:t.x)||e.y!==(null==t?void 0:t.y)),[t]),s=gV((e=>{r(e)}),(null==e?void 0:e.debounce)||300),l=Object(a.useCallback)((e=>{var t,r;null==(t=i.current)||t.disconnect(),null!=n.current&&cancelAnimationFrame(n.current),e&&(null==(r=i.current)||r.unobserve(e))}),[i.current]),c=Object(a.useCallback)((e=>{r(e)}),[]);return[t,t=>{null!==t&&(i.current=new ResizeObserver((i=>{l(t),n.current=requestAnimationFrame((()=>{const t=i[0].contentRect.toJSON();if(null!=e&&e.debounce)s(t);else{if(!o(t))return;r(t)}}))})),i.current.observe(t))},l,c]}function bV(e){const{value:t,defaultValue:r,onChange:n}=e,i=cj(),o=Object(a.useRef)(void 0!==t?t:r),s=(e,t=!1)=>{const r="function"==typeof e?e(o.current):e;!t&&r===o.current||(o.current=r,i(),null==n||n(r))};return Object(a.useEffect)((()=>{void 0!==t&&!od(t,o.current)&&s(t)}),[t]),[o.current,s]}const wV=e=>{const t=Object(a.useRef)(e);t.current=e,Object(a.useEffect)((()=>()=>t.current()),[])},_V=(e,t,r)=>Object(a.useMemo)((()=>e&&""!==e?null!=r&&r.ignore?e:Od.getRenderText(e,t,null==r?void 0:r.fonStyle):""),[e,t,null==r?void 0:r.ignore]),CV=[{value:!0,name:kf("是")},{value:!1,name:kf("否")}],EV=({id:e,type:t=sj.Checkbox,defaultValue:r,value:n,onChange:i,focus:o})=>{const[a,l]=bV({value:n,defaultValue:r,onChange:i});let c;return t===sj.Checkbox?c=s.a.createElement(p.a,{checked:a,onChange:e=>{const t=e.target.checked;null==i||i(t),l(t)}}):t===sj.Radio&&(c=s.a.createElement(m.a.Group,{defaultValue:a,autoFocus:o},CV.map(((e,t)=>s.a.createElement(m.a,{value:e.value,key:t,onChange:t=>{const r=e.value;null==i||i(r),l(r)}},s.a.createElement("span",{className:"lakex-table-form-type-checkbox-value"},e.name)))))),s.a.createElement("div",{className:"lakex-table-form-checkbox",id:e},c)};function xV(){return s.a.createElement("div",{className:"lakex-table-form-empty"},`(${kf("空")})`)}const SV=({value:e,format:t="YYYY-MM-DD",showEmpty:r})=>e?s.a.createElement("div",{className:"lakex-table-form-date-readonly"},e?Td(e).format(t):""):r?s.a.createElement(xV,null):null;var kV={},OV={exports:{}};!function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports}(OV);var IV,RV={};var TV,AV={exports:{}};function NV(){return TV||(TV=1,function(e,t){e.exports=function(e,t){t.prototype.weekday=function(e){var t=this.$locale().weekStart||0,r=this.$W,n=(r<t?r+7:r)-t;return this.$utils().u(e)?n:this.subtract(n,"day").add(e,"day")}}}(AV)),AV.exports}var MV={exports:{}};!function(e,t){e.exports=function(e,t,r){var n=t.prototype,i=function(e){return e&&(e.indexOf?e:e.s)},o=function(e,t,r,n,o){var a=e.name?e:e.$locale(),s=i(a[t]),l=i(a[r]),c=s||l.map((function(e){return e.slice(0,n)}));if(!o)return c;var u=a.weekStart;return c.map((function(e,t){return c[(t+(u||0))%7]}))},a=function(){return r.Ls[r.locale()]},s=function(e,t){return e.formats[t]||e.formats[t.toUpperCase()].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,r){return t||r.slice(1)}))},l=function(){var e=this;return{months:function(t){return t?t.format("MMMM"):o(e,"months")},monthsShort:function(t){return t?t.format("MMM"):o(e,"monthsShort","months",3)},firstDayOfWeek:function(){return e.$locale().weekStart||0},weekdays:function(t){return t?t.format("dddd"):o(e,"weekdays")},weekdaysMin:function(t){return t?t.format("dd"):o(e,"weekdaysMin","weekdays",2)},weekdaysShort:function(t){return t?t.format("ddd"):o(e,"weekdaysShort","weekdays",3)},longDateFormat:function(t){return s(e.$locale(),t)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};n.localeData=function(){return l.bind(this)()},r.localeData=function(){var e=a();return{firstDayOfWeek:function(){return e.weekStart||0},weekdays:function(){return r.weekdays()},weekdaysShort:function(){return r.weekdaysShort()},weekdaysMin:function(){return r.weekdaysMin()},months:function(){return r.months()},monthsShort:function(){return r.monthsShort()},longDateFormat:function(t){return s(e,t)},meridiem:e.meridiem,ordinal:e.ordinal}},r.months=function(){return o(a(),"months")},r.monthsShort=function(){return o(a(),"monthsShort","months",3)},r.weekdays=function(e){return o(a(),"weekdays",null,null,e)},r.weekdaysShort=function(e){return o(a(),"weekdaysShort","weekdays",3,e)},r.weekdaysMin=function(e){return o(a(),"weekdaysMin","weekdays",2,e)}}}(MV);const PV=MV.exports;var jV,DV={exports:{}};var FV,VV={exports:{}};var LV,$V={exports:{}};var BV,zV={exports:{}};var UV=OV.exports;Object.defineProperty(kV,"__esModule",{value:!0});var HV=kV.default=void 0,WV=UV(Rd.exports),GV=function(){if(IV)return RV;IV=1,Object.defineProperty(RV,"__esModule",{value:!0}),RV.call=a,RV.default=void 0,RV.note=i,RV.noteOnce=l,RV.preMessage=void 0,RV.resetWarned=o,RV.warning=n,RV.warningOnce=s;var e={},t=[],r=function(e){t.push(e)};function n(e,r){if("production"!==Ti.exports.env.NODE_ENV&&!e&&void 0!==console){var n=t.reduce((function(e,t){return t(null!=e?e:"","warning")}),r);n&&console.error("Warning: ".concat(n))}}function i(e,r){if("production"!==Ti.exports.env.NODE_ENV&&!e&&void 0!==console){var n=t.reduce((function(e,t){return t(null!=e?e:"","note")}),r);n&&console.warn("Note: ".concat(n))}}function o(){e={}}function a(t,r,n){!r&&!e[n]&&(t(!1,n),e[n]=!0)}function s(e,t){a(n,e,t)}function l(e,t){a(i,e,t)}RV.preMessage=r,s.preMessage=r,s.resetWarned=o,s.noteOnce=l;var c=s;return RV.default=c,RV}(),KV=UV(NV()),qV=UV(MV.exports),YV=UV((jV||(jV=1,function(e,t){e.exports=function(){var e="week",t="year";return function(r,n,i){var o=n.prototype;o.week=function(r){if(void 0===r&&(r=null),null!==r)return this.add(7*(r-this.week()),"day");var n=this.$locale().yearStart||1;if(11===this.month()&&this.date()>25){var o=i(this).startOf(t).add(1,t).date(n),a=i(this).endOf(e);if(o.isBefore(a))return 1}var s=i(this).startOf(t).date(n).startOf(e).subtract(1,"millisecond"),l=this.diff(s,e,!0);return l<0?i(this).startOf("week").week():Math.ceil(l)},o.weeks=function(e){return void 0===e&&(e=null),this.week(e)}}}()}(DV)),DV.exports)),XV=UV((FV||(FV=1,function(e,t){e.exports=function(e,t){t.prototype.weekYear=function(){var e=this.month(),t=this.week(),r=this.year();return 1===t&&11===e?r+1:0===e&&t>=52?r-1:r}}}(VV)),VV.exports)),ZV=UV((LV||(LV=1,function(e,t){e.exports=function(e,t){var r=t.prototype,n=r.format;r.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return n.bind(this)(e);var i=this.$utils(),o=(e||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,(function(e){switch(e){case"Q":return Math.ceil((t.$M+1)/3);case"Do":return r.ordinal(t.$D);case"gggg":return t.weekYear();case"GGGG":return t.isoWeekYear();case"wo":return r.ordinal(t.week(),"W");case"w":case"ww":return i.s(t.week(),"w"===e?1:2,"0");case"W":case"WW":return i.s(t.isoWeek(),"W"===e?1:2,"0");case"k":case"kk":return i.s(String(0===t.$H?24:t.$H),"k"===e?1:2,"0");case"X":return Math.floor(t.$d.getTime()/1e3);case"x":return t.$d.getTime();case"z":return"["+t.offsetName()+"]";case"zzz":return"["+t.offsetName("long")+"]";default:return e}}));return n.bind(this)(o)}}}($V)),$V.exports)),JV=UV((BV||(BV=1,function(e,t){e.exports=function(){var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d\d/,n=/\d\d?/,i=/\d*[^-_:/,()\s\d]+/,o={},a=function(e){return(e=+e)+(e>68?1900:2e3)},s=function(e){return function(t){this[e]=+t}},l=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e||"Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),r=60*t[1]+(+t[2]||0);return 0===r?0:"+"===t[0]?-r:r}(e)}],c=function(e){var t=o[e];return t&&(t.indexOf?t:t.s.concat(t.f))},u=function(e,t){var r,n=o.meridiem;if(n){for(var i=1;i<=24;i+=1)if(e.indexOf(n(i,0,t))>-1){r=i>12;break}}else r=e===(t?"pm":"PM");return r},d={A:[i,function(e){this.afternoon=u(e,!1)}],a:[i,function(e){this.afternoon=u(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[r,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[n,s("seconds")],ss:[n,s("seconds")],m:[n,s("minutes")],mm:[n,s("minutes")],H:[n,s("hours")],h:[n,s("hours")],HH:[n,s("hours")],hh:[n,s("hours")],D:[n,s("day")],DD:[r,s("day")],Do:[i,function(e){var t=o.ordinal,r=e.match(/\d+/);if(this.day=r[0],t)for(var n=1;n<=31;n+=1)t(n).replace(/\[|\]/g,"")===e&&(this.day=n)}],M:[n,s("month")],MM:[r,s("month")],MMM:[i,function(e){var t=c("months"),r=(c("monthsShort")||t.map((function(e){return e.slice(0,3)}))).indexOf(e)+1;if(r<1)throw new Error;this.month=r%12||r}],MMMM:[i,function(e){var t=c("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,s("year")],YY:[r,function(e){this.year=a(e)}],YYYY:[/\d{4}/,s("year")],Z:l,ZZ:l};function f(r){var n,i;n=r,i=o&&o.formats;for(var a=(r=n.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,r,n){var o=n&&n.toUpperCase();return r||i[n]||e[n]||i[o].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,r){return t||r.slice(1)}))}))).match(t),s=a.length,l=0;l<s;l+=1){var c=a[l],u=d[c],f=u&&u[0],p=u&&u[1];a[l]=p?{regex:f,parser:p}:c.replace(/^\[|\]$/g,"")}return function(e){for(var t={},r=0,n=0;r<s;r+=1){var i=a[r];if("string"==typeof i)n+=i.length;else{var o=i.regex,l=i.parser,c=e.slice(n),u=o.exec(c)[0];l.call(t,u),e=e.replace(u,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var r=e.hours;t?r<12&&(e.hours+=12):12===r&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,r){r.p.customParseFormat=!0,e&&e.parseTwoDigitYear&&(a=e.parseTwoDigitYear);var n=t.prototype,i=n.parse;n.parse=function(e){var t=e.date,n=e.utc,a=e.args;this.$u=n;var s=a[1];if("string"==typeof s){var l=!0===a[2],c=!0===a[3],u=l||c,d=a[2];c&&(d=a[2]),o=this.$locale(),!l&&d&&(o=r.Ls[d]),this.$d=function(e,t,r){try{if(["x","X"].indexOf(t)>-1)return new Date(("X"===t?1e3:1)*e);var n=f(t)(e),i=n.year,o=n.month,a=n.day,s=n.hours,l=n.minutes,c=n.seconds,u=n.milliseconds,d=n.zone,p=new Date,h=a||(i||o?1:p.getDate()),m=i||p.getFullYear(),v=0;i&&!o||(v=o>0?o-1:p.getMonth());var g=s||0,y=l||0,b=c||0,w=u||0;return d?new Date(Date.UTC(m,v,h,g,y,b,w+60*d.offset*1e3)):r?new Date(Date.UTC(m,v,h,g,y,b,w)):new Date(m,v,h,g,y,b,w)}catch{return new Date("")}}(t,s,n),this.init(),d&&!0!==d&&(this.$L=this.locale(d).$L),u&&t!=this.format(s)&&(this.$d=new Date("")),o={}}else if(s instanceof Array)for(var p=s.length,h=1;h<=p;h+=1){a[1]=s[h-1];var m=r.apply(this,a);if(m.isValid()){this.$d=m.$d,this.$L=m.$L,this.init();break}h===p&&(this.$d=new Date(""))}else i.call(this,e)}}}()}(zV)),zV.exports));WV.default.extend(JV.default),WV.default.extend(ZV.default),WV.default.extend(KV.default),WV.default.extend(qV.default),WV.default.extend(YV.default),WV.default.extend(XV.default),WV.default.extend((function(e,t){var r=t.prototype,n=r.format;r.format=function(e){var t=(e||"").replace("Wo","wo");return n.bind(this)(t)}}));var QV={en_GB:"en-gb",en_US:"en",zh_CN:"zh-cn",zh_TW:"zh-tw"},eL=function(e){return QV[e]||e.split("_")[0]},tL=function(){(0,GV.noteOnce)(!1,"Not match any format. Please help to fire a issue about this.")},rL={getNow:function(){return(0,WV.default)()},getFixedDate:function(e){return(0,WV.default)(e,"YYYY-MM-DD")},getEndDate:function(e){return e.endOf("month")},getWeekDay:function(e){var t=e.locale("en");return t.weekday()+t.localeData().firstDayOfWeek()},getYear:function(e){return e.year()},getMonth:function(e){return e.month()},getDate:function(e){return e.date()},getHour:function(e){return e.hour()},getMinute:function(e){return e.minute()},getSecond:function(e){return e.second()},addYear:function(e,t){return e.add(t,"year")},addMonth:function(e,t){return e.add(t,"month")},addDate:function(e,t){return e.add(t,"day")},setYear:function(e,t){return e.year(t)},setMonth:function(e,t){return e.month(t)},setDate:function(e,t){return e.date(t)},setHour:function(e,t){return e.hour(t)},setMinute:function(e,t){return e.minute(t)},setSecond:function(e,t){return e.second(t)},isAfter:function(e,t){return e.isAfter(t)},isValidate:function(e){return e.isValid()},locale:{getWeekFirstDay:function(e){return(0,WV.default)().locale(eL(e)).localeData().firstDayOfWeek()},getWeekFirstDate:function(e,t){return t.locale(eL(e)).weekday(0)},getWeek:function(e,t){return t.locale(eL(e)).week()},getShortWeekDays:function(e){return(0,WV.default)().locale(eL(e)).localeData().weekdaysMin()},getShortMonths:function(e){return(0,WV.default)().locale(eL(e)).localeData().monthsShort()},format:function(e,t,r){return t.locale(eL(e)).format(r)},parse:function(e,t,r){for(var n=eL(e),i=0;i<r.length;i+=1){var o=r[i],a=t;if(o.includes("wo")||o.includes("Wo")){for(var s=a.split("-")[0],l=a.split("-")[1],c=(0,WV.default)(s,"YYYY").startOf("year").locale(n),u=0;u<=52;u+=1){var d=c.add(u,"week");if(d.format("Wo")===l)return d}return tL(),null}var f=(0,WV.default)(a,o).locale(n);if(f.isValid())return f}return t&&tL(),null}}},nL=rL;function iL(){return iL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iL.apply(this,arguments)}function oL(e){return(oL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aL(e){var t=function(e,t){if("object"!==oL(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==oL(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===oL(t)?t:String(t)}function sL(e,t,r){return(t=aL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lL(e){if(Array.isArray(e))return e}function cL(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function uL(e,t){if(e){if("string"==typeof e)return cL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cL(e,t)}}function dL(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fL(e,t){return lL(e)||function(e,t){var r=null==e?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],l=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||uL(e,t)||dL()}function pL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function hL(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pL(Object(r),!0).forEach((function(t){sL(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pL(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function mL(e,t){var r=hL({},e);return Array.isArray(t)&&t.forEach((function(e){delete r[e]})),r}HV=kV.default=nL;const vL=Object(a.createContext)({});function gL(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}function yL(e){if(typeof Symbol<"u"&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function bL(e){return function(e){if(Array.isArray(e))return cL(e)}(e)||yL(e)||uL(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aL(n.key),n)}}function CL(e,t,r){return t&&_L(e.prototype,t),r&&_L(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xL(e,t){return xL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xL(e,t)}function SL(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xL(e,t)}function kL(e){return(kL=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function OL(e){var t=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}}();return function(){var r,n=kL(e);if(t){var i=kL(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===oL(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return EL(e)}(this,r)}}var IL=TF();function RL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[];return s.a.Children.forEach(e,(function(e){null==e&&!t.keepEmpty||(Array.isArray(e)?r=r.concat(RL(e)):IL.isFragment(e)&&e.props?r=r.concat(RL(e.props.children,t)):r.push(e))})),r}var TL={},AL=[];function NL(e,t){if("production"!==Ti.exports.env.NODE_ENV&&!e&&void 0!==console){var r=AL.reduce((function(e,t){return t(null!=e?e:"","warning")}),t);r&&console.error("Warning: ".concat(r))}}function ML(e,t){if("production"!==Ti.exports.env.NODE_ENV&&!e&&void 0!==console){var r=AL.reduce((function(e,t){return t(null!=e?e:"","note")}),t);r&&console.warn("Note: ".concat(r))}}function PL(e,t,r){!t&&!TL[r]&&(e(!1,r),TL[r]=!0)}function jL(e,t){PL(NL,e,t)}jL.preMessage=function(e){AL.push(e)},jL.resetWarned=function(){TL={}},jL.noteOnce=function(e,t){PL(ML,e,t)};var DL="RC_FORM_INTERNAL_HOOKS",FL=function(){jL(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},VL=a.createContext({getFieldValue:FL,getFieldsValue:FL,getFieldError:FL,getFieldsError:FL,isFieldsTouched:FL,isFieldTouched:FL,isFieldValidating:FL,isFieldsValidating:FL,resetFields:FL,setFields:FL,setFieldsValue:FL,validateFields:FL,submit:FL,getInternalHooks:function(){return FL(),{dispatch:FL,initEntityValue:FL,registerField:FL,useSubscribe:FL,setInitialValues:FL,setCallbacks:FL,getFields:FL,setValidateMessages:FL,setPreserve:FL}}});function LL(e){return null==e?[]:Array.isArray(e)?e:[e]}var $L={exports:{}},BL={exports:{}};!function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(BL),function(e){var t=BL.exports.default;function r(){e.exports=r=function(){return i},e.exports.__esModule=!0,e.exports.default=e.exports;var n,i={},o=Object.prototype,a=o.hasOwnProperty,s=Object.defineProperty||function(e,t,r){e[t]=r.value},l="function"==typeof Symbol?Symbol:{},c=l.iterator||"@@iterator",u=l.asyncIterator||"@@asyncIterator",d=l.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch{f=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var i=t&&t.prototype instanceof w?t:w,o=Object.create(i.prototype),a=new M(n||[]);return s(o,"_invoke",{value:R(e,r,a)}),o}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}i.wrap=p;var m="suspendedStart",v="suspendedYield",g="executing",y="completed",b={};function w(){}function _(){}function C(){}var E={};f(E,c,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(P([])));S&&S!==o&&a.call(S,c)&&(E=S);var k=C.prototype=w.prototype=Object.create(E);function O(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,r){function n(i,o,s,l){var c=h(e[i],e,o);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==t(d)&&a.call(d,"__await")?r.resolve(d.__await).then((function(e){n("next",e,s,l)}),(function(e){n("throw",e,s,l)})):r.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,l)}))}l(c.arg)}var i;s(this,"_invoke",{value:function(e,t){function o(){return new r((function(r,i){n(e,t,r,i)}))}return i=i?i.then(o,o):o()}})}function R(e,t,r){var i=m;return function(o,a){if(i===g)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:n,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var l=T(s,r);if(l){if(l===b)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===m)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=g;var c=h(e,t,r);if("normal"===c.type){if(i=r.done?y:v,c.arg===b)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function T(e,t){var r=t.method,i=e.iterator[r];if(i===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=n,T(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),b;var o=h(i,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,b;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,b):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,b)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function P(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function t(){for(;++i<e.length;)if(a.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}throw new TypeError(t(e)+" is not iterable")}return _.prototype=C,s(k,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:_,configurable:!0}),_.displayName=f(C,d,"GeneratorFunction"),i.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},i.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,f(e,d,"GeneratorFunction")),e.prototype=Object.create(k),e},i.awrap=function(e){return{__await:e}},O(I.prototype),f(I.prototype,u,(function(){return this})),i.AsyncIterator=I,i.async=function(e,t,r,n,o){void 0===o&&(o=Promise);var a=new I(p(e,t,r,n),o);return i.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(k),f(k,d,"Generator"),f(k,c,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),i.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},i.values=P,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(N),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,i){return s.type="throw",s.arg=e,t.next=r,i&&(t.method="next",t.arg=n),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var l=a.call(o,"catchLoc"),c=a.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),N(r),b}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;N(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:P(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),b}},i}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}($L);var zL=$L.exports(),UL=zL;try{regeneratorRuntime=zL}catch{"object"==typeof globalThis?globalThis.regeneratorRuntime=zL:Function("r","regeneratorRuntime = r")(zL)}function HL(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function WL(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){HL(o,n,i,a,s,"next",e)}function s(e){HL(o,n,i,a,s,"throw",e)}a(void 0)}))}}function GL(){return GL=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},GL.apply(this,arguments)}function KL(e){return(KL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qL(e,t){return qL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},qL(e,t)}function YL(e,t,r){return YL=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}}()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&qL(i,r.prototype),i},YL.apply(null,arguments)}function XL(e){var t="function"==typeof Map?new Map:void 0;return XL=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return YL(e,arguments,KL(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),qL(r,e)},XL(e)}var ZL=/%[sdj%]/g,JL=function(){};function QL(e){if(!e||!e.length)return null;var t={};return e.forEach((function(e){var r=e.field;t[r]=t[r]||[],t[r].push(e)})),t}function e$(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=1,i=t[0],o=t.length;return"function"==typeof i?i.apply(null,t.slice(1)):"string"==typeof i?String(i).replace(ZL,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(t[n++]);case"%d":return Number(t[n++]);case"%j":try{return JSON.stringify(t[n++])}catch{return"[Circular]"}break;default:return e}})):i}function t$(e,t){return!!(null==e||"array"===t&&Array.isArray(e)&&!e.length||function(e){return"string"===e||"url"===e||"hex"===e||"email"===e||"date"===e||"pattern"===e}(t)&&"string"==typeof e&&!e)}function r$(e,t,r){var n=0,i=e.length;!function o(a){if(a&&a.length)r(a);else{var s=n;n+=1,s<i?t(e[s],o):r([])}}([])}typeof Ti.exports<"u"&&Ti.exports.env&&"production"!==Ti.exports.env.NODE_ENV&&typeof window<"u"&&typeof document<"u"&&(JL=function(e,t){typeof console<"u"&&console.warn&&t.every((function(e){return"string"==typeof e}))&&console.warn(e,t)});var n$=function(e){function t(t,r){var n;return(n=e.call(this,"Async Validation Error")||this).errors=t,n.fields=r,n}return function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,qL(e,t)}(t,e),t}(XL(Error));function i$(e,t,r,n){if(t.first){var i=new Promise((function(t,i){var o=function(e){var t=[];return Object.keys(e).forEach((function(r){t.push.apply(t,e[r])})),t}(e);r$(o,r,(function(e){return n(e),e.length?i(new n$(e,QL(e))):t()}))}));return i.catch((function(e){return e})),i}var o=t.firstFields||[];!0===o&&(o=Object.keys(e));var a=Object.keys(e),s=a.length,l=0,c=[],u=new Promise((function(t,i){var u=function(e){if(c.push.apply(c,e),++l===s)return n(c),c.length?i(new n$(c,QL(c))):t()};a.length||(n(c),t()),a.forEach((function(t){var n=e[t];-1!==o.indexOf(t)?r$(n,r,u):function(e,t,r){var n=[],i=0,o=e.length;function a(e){n.push.apply(n,e),++i===o&&r(n)}e.forEach((function(e){t(e,a)}))}(n,r,u)}))}));return u.catch((function(e){return e})),u}function o$(e){return function(t){return t&&t.message?(t.field=t.field||e.fullField,t):{message:"function"==typeof t?t():t,field:t.field||e.fullField}}}function a$(e,t){if(t)for(var r in t)if(t.hasOwnProperty(r)){var n=t[r];"object"==typeof n&&"object"==typeof e[r]?e[r]=GL({},e[r],n):e[r]=n}return e}function s$(e,t,r,n,i,o){e.required&&(!r.hasOwnProperty(e.field)||t$(t,o||e.type))&&n.push(e$(i.messages.required,e.fullField))}var l$={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,url:new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},c$={integer:function(e){return c$.number(e)&&parseInt(e,10)===e},float:function(e){return c$.number(e)&&!c$.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch{return!1}},date:function(e){return"function"==typeof e.getTime&&"function"==typeof e.getMonth&&"function"==typeof e.getYear&&!isNaN(e.getTime())},number:function(e){return!isNaN(e)&&"number"==typeof e},object:function(e){return"object"==typeof e&&!c$.array(e)},method:function(e){return"function"==typeof e},email:function(e){return"string"==typeof e&&!!e.match(l$.email)&&e.length<255},url:function(e){return"string"==typeof e&&!!e.match(l$.url)},hex:function(e){return"string"==typeof e&&!!e.match(l$.hex)}};var u$="enum";var d$={required:s$,whitespace:function(e,t,r,n,i){(/^\s+$/.test(t)||""===t)&&n.push(e$(i.messages.whitespace,e.fullField))},type:function(e,t,r,n,i){if(e.required&&void 0===t)s$(e,t,r,n,i);else{var o=e.type;["integer","float","array","regexp","object","method","email","number","date","url","hex"].indexOf(o)>-1?c$[o](t)||n.push(e$(i.messages.types[o],e.fullField,e.type)):o&&typeof t!==e.type&&n.push(e$(i.messages.types[o],e.fullField,e.type))}},range:function(e,t,r,n,i){var o="number"==typeof e.len,a="number"==typeof e.min,s="number"==typeof e.max,l=t,c=null,u="number"==typeof t,d="string"==typeof t,f=Array.isArray(t);if(u?c="number":d?c="string":f&&(c="array"),!c)return!1;f&&(l=t.length),d&&(l=t.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length),o?l!==e.len&&n.push(e$(i.messages[c].len,e.fullField,e.len)):a&&!s&&l<e.min?n.push(e$(i.messages[c].min,e.fullField,e.min)):s&&!a&&l>e.max?n.push(e$(i.messages[c].max,e.fullField,e.max)):a&&s&&(l<e.min||l>e.max)&&n.push(e$(i.messages[c].range,e.fullField,e.min,e.max))},enum:function(e,t,r,n,i){e[u$]=Array.isArray(e[u$])?e[u$]:[],-1===e[u$].indexOf(t)&&n.push(e$(i.messages[u$],e.fullField,e[u$].join(", ")))},pattern:function(e,t,r,n,i){if(e.pattern)if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(t)||n.push(e$(i.messages.pattern.mismatch,e.fullField,t,e.pattern));else if("string"==typeof e.pattern){new RegExp(e.pattern).test(t)||n.push(e$(i.messages.pattern.mismatch,e.fullField,t,e.pattern))}}};function f$(e,t,r,n,i){var o=e.type,a=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(t$(t,o)&&!e.required)return r();d$.required(e,t,n,a,i,o),t$(t,o)||d$.type(e,t,n,a,i)}r(a)}var p$={string:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(t$(t,"string")&&!e.required)return r();d$.required(e,t,n,o,i,"string"),t$(t,"string")||(d$.type(e,t,n,o,i),d$.range(e,t,n,o,i),d$.pattern(e,t,n,o,i),!0===e.whitespace&&d$.whitespace(e,t,n,o,i))}r(o)},method:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(t$(t)&&!e.required)return r();d$.required(e,t,n,o,i),void 0!==t&&d$.type(e,t,n,o,i)}r(o)},number:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(""===t&&(t=void 0),t$(t)&&!e.required)return r();d$.required(e,t,n,o,i),void 0!==t&&(d$.type(e,t,n,o,i),d$.range(e,t,n,o,i))}r(o)},boolean:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(t$(t)&&!e.required)return r();d$.required(e,t,n,o,i),void 0!==t&&d$.type(e,t,n,o,i)}r(o)},regexp:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(t$(t)&&!e.required)return r();d$.required(e,t,n,o,i),t$(t)||d$.type(e,t,n,o,i)}r(o)},integer:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(t$(t)&&!e.required)return r();d$.required(e,t,n,o,i),void 0!==t&&(d$.type(e,t,n,o,i),d$.range(e,t,n,o,i))}r(o)},float:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(t$(t)&&!e.required)return r();d$.required(e,t,n,o,i),void 0!==t&&(d$.type(e,t,n,o,i),d$.range(e,t,n,o,i))}r(o)},array:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(null==t&&!e.required)return r();d$.required(e,t,n,o,i,"array"),null!=t&&(d$.type(e,t,n,o,i),d$.range(e,t,n,o,i))}r(o)},object:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(t$(t)&&!e.required)return r();d$.required(e,t,n,o,i),void 0!==t&&d$.type(e,t,n,o,i)}r(o)},enum:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(t$(t)&&!e.required)return r();d$.required(e,t,n,o,i),void 0!==t&&d$.enum(e,t,n,o,i)}r(o)},pattern:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(t$(t,"string")&&!e.required)return r();d$.required(e,t,n,o,i),t$(t,"string")||d$.pattern(e,t,n,o,i)}r(o)},date:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(t$(t,"date")&&!e.required)return r();var a;if(d$.required(e,t,n,o,i),!t$(t,"date"))a=t instanceof Date?t:new Date(t),d$.type(e,a,n,o,i),a&&d$.range(e,a.getTime(),n,o,i)}r(o)},url:f$,hex:f$,email:f$,required:function(e,t,r,n,i){var o=[],a=Array.isArray(t)?"array":typeof t;d$.required(e,t,n,o,i,a),r(o)},any:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(t$(t)&&!e.required)return r();d$.required(e,t,n,o,i)}r(o)}};function h$(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}var m$=h$();function v$(e){this.rules=null,this._messages=m$,this.define(e)}function g$(e,t){for(var r=e,n=0;n<t.length;n+=1){if(null==r)return;r=r[t[n]]}return r}function y$(e,t,r,n){if(!t.length)return r;var i,o=function(e){return lL(e)||yL(e)||uL(e)||dL()}(t),a=o[0],s=o.slice(1);return i=e||"number"!=typeof a?Array.isArray(e)?bL(e):hL({},e):[],n&&void 0===r&&1===s.length?delete i[a][s[0]]:i[a]=y$(i[a],s,r,n),i}function b$(e){return LL(e)}function w$(e,t){return g$(e,t)}function _$(e,t,r){var n=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t.length&&n&&void 0===r&&!g$(e,t.slice(0,-1))?e:y$(e,t,r,n)}(e,t,r,arguments.length>3&&void 0!==arguments[3]&&arguments[3]);return n}function C$(e,t){var r={};return t.forEach((function(t){var n=w$(e,t);r=_$(r,t,n)})),r}function E$(e,t){return e&&e.some((function(e){return O$(e,t)}))}function x$(e){return"object"===oL(e)&&null!==e&&Object.getPrototypeOf(e)===Object.prototype}function S$(e,t){var r=Array.isArray(e)?bL(e):hL({},e);return t&&Object.keys(t).forEach((function(e){var n=r[e],i=t[e],o=x$(n)&&x$(i);r[e]=o?S$(n,i||{}):i})),r}function k$(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.reduce((function(e,t){return S$(e,t)}),e)}function O$(e,t){return!(!e||!t||e.length!==t.length)&&e.every((function(e,r){return t[r]===e}))}function I$(e){var t=arguments.length<=1?void 0:arguments[1];return t&&t.target&&e in t.target?t.target[e]:t}function R$(e,t,r){var n=e.length;if(t<0||t>=n||r<0||r>=n)return e;var i=e[t],o=t-r;return o>0?[].concat(bL(e.slice(0,r)),[i],bL(e.slice(r,t)),bL(e.slice(t+1,n))):o<0?[].concat(bL(e.slice(0,t)),bL(e.slice(t+1,r+1)),[i],bL(e.slice(r+1,n))):e}v$.prototype={messages:function(e){return e&&(this._messages=a$(h$(),e)),this._messages},define:function(e){if(!e)throw new Error("Cannot configure a schema with no rules");if("object"!=typeof e||Array.isArray(e))throw new Error("Rules must be an object");var t,r;for(t in this.rules={},e)e.hasOwnProperty(t)&&(r=e[t],this.rules[t]=Array.isArray(r)?r:[r])},validate:function(e,t,r){var n=this;void 0===t&&(t={}),void 0===r&&(r=function(){});var i=e,o=t,a=r;if("function"==typeof o&&(a=o,o={}),!this.rules||0===Object.keys(this.rules).length)return a&&a(),Promise.resolve();if(o.messages){var s=this.messages();s===m$&&(s=h$()),a$(s,o.messages),o.messages=s}else o.messages=this.messages();var l,c,u={};(o.keys||Object.keys(this.rules)).forEach((function(t){l=n.rules[t],c=i[t],l.forEach((function(r){var o=r;"function"==typeof o.transform&&(i===e&&(i=GL({},i)),c=i[t]=o.transform(c)),(o="function"==typeof o?{validator:o}:GL({},o)).validator=n.getValidationMethod(o),o.field=t,o.fullField=o.fullField||t,o.type=n.getType(o),o.validator&&(u[t]=u[t]||[],u[t].push({rule:o,value:c,source:i,field:t}))}))}));var d={};return i$(u,o,(function(e,t){var r,n=e.rule,i=!("object"!==n.type&&"array"!==n.type||"object"!=typeof n.fields&&"object"!=typeof n.defaultField);function a(e,t){return GL({},t,{fullField:n.fullField+"."+e})}function s(r){void 0===r&&(r=[]);var s=r;if(Array.isArray(s)||(s=[s]),!o.suppressWarning&&s.length&&v$.warning("async-validator:",s),s.length&&void 0!==n.message&&(s=[].concat(n.message)),s=s.map(o$(n)),o.first&&s.length)return d[n.field]=1,t(s);if(i){if(n.required&&!e.value)return void 0!==n.message?s=[].concat(n.message).map(o$(n)):o.error&&(s=[o.error(n,e$(o.messages.required,n.field))]),t(s);var l={};if(n.defaultField)for(var c in e.value)e.value.hasOwnProperty(c)&&(l[c]=n.defaultField);for(var u in l=GL({},l,e.rule.fields))if(l.hasOwnProperty(u)){var f=Array.isArray(l[u])?l[u]:[l[u]];l[u]=f.map(a.bind(null,u))}var p=new v$(l);p.messages(o.messages),e.rule.options&&(e.rule.options.messages=o.messages,e.rule.options.error=o.error),p.validate(e.value,e.rule.options||o,(function(e){var r=[];s&&s.length&&r.push.apply(r,s),e&&e.length&&r.push.apply(r,e),t(r.length?r:null)}))}else t(s)}i=i&&(n.required||!n.required&&e.value),n.field=e.field,n.asyncValidator?r=n.asyncValidator(n,e.value,s,e.source,o):n.validator&&(!0===(r=n.validator(n,e.value,s,e.source,o))?s():!1===r?s(n.message||n.field+" fails"):r instanceof Array?s(r):r instanceof Error&&s(r.message)),r&&r.then&&r.then((function(){return s()}),(function(e){return s(e)}))}),(function(e){!function(e){var t,r,n,i=[],o={};for(t=0;t<e.length;t++)r=e[t],n=void 0,Array.isArray(r)?i=(n=i).concat.apply(n,r):i.push(r);i.length?o=QL(i):(i=null,o=null),a(i,o)}(e)}))},getType:function(e){if(void 0===e.type&&e.pattern instanceof RegExp&&(e.type="pattern"),"function"!=typeof e.validator&&e.type&&!p$.hasOwnProperty(e.type))throw new Error(e$("Unknown rule type %s",e.type));return e.type||"string"},getValidationMethod:function(e){if("function"==typeof e.validator)return e.validator;var t=Object.keys(e),r=t.indexOf("message");return-1!==r&&t.splice(r,1),1===t.length&&"required"===t[0]?p$.required:p$[this.getType(e)]||!1}},v$.register=function(e,t){if("function"!=typeof t)throw new Error("Cannot register a validator by type, validator is not a function");p$[e]=t},v$.warning=JL,v$.messages=m$,v$.validators=p$;var T$="'${name}' is not a valid ${type}",A$={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:T$,method:T$,array:T$,object:T$,number:T$,date:T$,boolean:T$,integer:T$,float:T$,regexp:T$,email:T$,url:T$,hex:T$},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},N$=v$;function M$(e,t,r,n){var i=hL(hL({},r),{},{name:t,enum:(r.enum||[]).join(", ")});return function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).forEach((function(o){var a=t[o];"string"==typeof a?r[o]=function(e,t){return function(){return function(e,t){return e.replace(/\$\{\w+\}/g,(function(e){var r=e.slice(2,-1);return t[r]}))}(e,hL(hL({},i),t))}}(a,n):a&&"object"===oL(a)?(r[o]={},e(a,r[o])):r[o]=a})),r}(k$({},A$,e))}function P$(e,t,r,n,i){return j$.apply(this,arguments)}function j$(){return j$=WL(UL.mark((function e(t,r,n,i,o){var s,l,c,u,d,f;return UL.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=hL({},n),l=null,s&&"array"===s.type&&s.defaultField&&(l=s.defaultField,delete s.defaultField),c=new N$(sL({},t,[s])),u=M$(i.validateMessages,t,s,o),c.messages(u),d=[],e.prev=7,e.next=10,Promise.resolve(c.validate(sL({},t,r),hL({},i)));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(7),e.t0.errors?d=e.t0.errors.map((function(e,t){var r=e.message;return a.isValidElement(r)?a.cloneElement(r,{key:"error_".concat(t)}):r})):(console.error(e.t0),d=[u.default()]);case 15:if(d.length||!l){e.next=20;break}return e.next=18,Promise.all(r.map((function(e,r){return P$("".concat(t,".").concat(r),e,l,i,o)})));case 18:return f=e.sent,e.abrupt("return",f.reduce((function(e,t){return[].concat(bL(e),bL(t))}),[]));case 20:return e.abrupt("return",d);case 21:case"end":return e.stop()}}),e,null,[[7,12]])}))),j$.apply(this,arguments)}function D$(e,t,r,n,i,o){var a,s=e.join("."),l=r.map((function(e){var t=e.validator;return t?hL(hL({},e),{},{validator:function(e,r,n){var i=!1,o=t(e,r,(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];Promise.resolve().then((function(){jL(!i,"Your validator function has already return a promise. `callback` will be ignored."),i||n.apply(void 0,t)}))}));jL(i=o&&"function"==typeof o.then&&"function"==typeof o.catch,"`callback` is deprecated. Please return a promise instead."),i&&o.then((function(){n()})).catch((function(e){n(e||" ")}))}}):e}));if(!0===i)a=new Promise(function(){var e=WL(UL.mark((function e(r,i){var a,c;return UL.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=0;case 1:if(!(a<l.length)){e.next=11;break}return e.next=4,P$(s,t,l[a],n,o);case 4:if(!(c=e.sent).length){e.next=8;break}return i(c),e.abrupt("return");case 8:a+=1,e.next=1;break;case 11:r([]);case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}());else{var c=l.map((function(e){return P$(s,t,e,n,o)}));a=(i?function(e){return V$.apply(this,arguments)}(c):function(e){return F$.apply(this,arguments)}(c)).then((function(e){return e.length?Promise.reject(e):[]}))}return a.catch((function(e){return e})),a}function F$(){return F$=WL(UL.mark((function e(t){return UL.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(t).then((function(e){var t;return(t=[]).concat.apply(t,bL(e))})));case 1:case"end":return e.stop()}}),e)}))),F$.apply(this,arguments)}function V$(){return V$=WL(UL.mark((function e(t){var r;return UL.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=0,e.abrupt("return",new Promise((function(e){t.forEach((function(n){n.then((function(n){n.length&&e(n),(r+=1)===t.length&&e([])}))}))})));case 2:case"end":return e.stop()}}),e)}))),V$.apply(this,arguments)}function L$(e,t,r,n,i,o){return"function"==typeof e?e(t,r,"source"in o?{source:o.source}:{}):n!==i}var $$=function(e){SL(r,e);var t=OL(r);function r(e){var n;(wL(this,r),(n=t.call(this,e)).state={resetCount:0},n.cancelRegisterFunc=null,n.mounted=!1,n.touched=!1,n.dirty=!1,n.validatePromise=null,n.errors=[],n.cancelRegister=function(){var e=n.props,t=e.preserve,r=e.isListField,i=e.name;n.cancelRegisterFunc&&n.cancelRegisterFunc(r,t,b$(i)),n.cancelRegisterFunc=null},n.getNamePath=function(){var e=n.props,t=e.name,r=e.fieldContext.prefixName;return void 0!==t?[].concat(bL(void 0===r?[]:r),bL(t)):[]},n.getRules=function(){var e=n.props,t=e.rules,r=void 0===t?[]:t,i=e.fieldContext;return r.map((function(e){return"function"==typeof e?e(i):e}))},n.refresh=function(){!n.mounted||n.setState((function(e){return{resetCount:e.resetCount+1}}))},n.onStoreChange=function(e,t,r){var i=n.props,o=i.shouldUpdate,a=i.dependencies,s=void 0===a?[]:a,l=i.onReset,c=r.store,u=n.getNamePath(),d=n.getValue(e),f=n.getValue(c),p=t&&E$(t,u);switch("valueUpdate"===r.type&&"external"===r.source&&d!==f&&(n.touched=!0,n.dirty=!0,n.validatePromise=null,n.errors=[]),r.type){case"reset":if(!t||p)return n.touched=!1,n.dirty=!1,n.validatePromise=null,n.errors=[],l&&l(),void n.refresh();break;case"setField":if(p){var h=r.data;return"touched"in h&&(n.touched=h.touched),"validating"in h&&!("originRCField"in h)&&(n.validatePromise=h.validating?Promise.resolve([]):null),"errors"in h&&(n.errors=h.errors||[]),n.dirty=!0,void n.reRender()}if(o&&!u.length&&L$(o,e,c,d,f,r))return void n.reRender();break;case"dependenciesUpdate":if(s.map(b$).some((function(e){return E$(r.relatedFields,e)})))return void n.reRender();break;default:if(p||(!s.length||u.length||o)&&L$(o,e,c,d,f,r))return void n.reRender()}!0===o&&n.reRender()},n.validateRules=function(e){var t=n.getNamePath(),r=n.getValue(),i=Promise.resolve().then((function(){if(!n.mounted)return[];var o=n.props,a=o.validateFirst,s=void 0!==a&&a,l=o.messageVariables,c=(e||{}).triggerName,u=n.getRules();c&&(u=u.filter((function(e){var t=e.validateTrigger;return!t||LL(t).includes(c)})));var d=D$(t,r,u,e,s,l);return d.catch((function(e){return e})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];n.validatePromise===i&&(n.validatePromise=null,n.errors=e,n.reRender())})),d}));return n.validatePromise=i,n.dirty=!0,n.errors=[],n.reRender(),i},n.isFieldValidating=function(){return!!n.validatePromise},n.isFieldTouched=function(){return n.touched},n.isFieldDirty=function(){return n.dirty},n.getErrors=function(){return n.errors},n.isListField=function(){return n.props.isListField},n.isList=function(){return n.props.isList},n.isPreserve=function(){return n.props.preserve},n.getMeta=function(){return n.prevValidating=n.isFieldValidating(),{touched:n.isFieldTouched(),validating:n.prevValidating,errors:n.errors,name:n.getNamePath()}},n.getOnlyChild=function(e){if("function"==typeof e){var t=n.getMeta();return hL(hL({},n.getOnlyChild(e(n.getControlled(),t,n.props.fieldContext))),{},{isFunction:!0})}var r=RL(e);return 1===r.length&&a.isValidElement(r[0])?{child:r[0],isFunction:!1}:{child:r,isFunction:!1}},n.getValue=function(e){var t=n.props.fieldContext.getFieldsValue,r=n.getNamePath();return w$(e||t(!0),r)},n.getControlled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.props,r=t.trigger,i=t.validateTrigger,o=t.getValueFromEvent,a=t.normalize,s=t.valuePropName,l=t.getValueProps,c=t.fieldContext,u=void 0!==i?i:c.validateTrigger,d=n.getNamePath(),f=c.getInternalHooks,p=c.getFieldsValue,h=f(DL).dispatch,m=n.getValue(),v=l||function(e){return sL({},s,e)},g=e[r],y=hL(hL({},e),v(m));return y[r]=function(){n.touched=!0,n.dirty=!0;for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];e=o?o.apply(void 0,r):I$.apply(void 0,[s].concat(r)),a&&(e=a(e,m,p(!0))),h({type:"updateValue",namePath:d,value:e}),g&&g.apply(void 0,r)},LL(u||[]).forEach((function(e){var t=y[e];y[e]=function(){t&&t.apply(void 0,arguments);var r=n.props.rules;r&&r.length&&h({type:"validateField",namePath:d,triggerName:e})}})),y},e.fieldContext)&&(0,(0,e.fieldContext.getInternalHooks)(DL).initEntityValue)(EL(n));return n}return CL(r,[{key:"componentDidMount",value:function(){var e=this.props,t=e.shouldUpdate,r=e.fieldContext;if(this.mounted=!0,r){var n=(0,r.getInternalHooks)(DL).registerField;this.cancelRegisterFunc=n(this)}!0===t&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.mounted=!1}},{key:"reRender",value:function(){!this.mounted||this.forceUpdate()}},{key:"render",value:function(){var e,t=this.state.resetCount,r=this.props.children,n=this.getOnlyChild(r),i=n.child;return n.isFunction?e=i:a.isValidElement(i)?e=a.cloneElement(i,this.getControlled(i.props)):(jL(!i,"`children` of Field is not validate ReactElement."),e=i),a.createElement(a.Fragment,{key:t},e)}}]),r}(a.Component);function B$(e){var t=e.name,r=gL(e,["name"]),n=a.useContext(VL),i=void 0!==t?b$(t):void 0,o="keep";return r.isListField||(o="_".concat((i||[]).join("_"))),"production"!==Ti.exports.env.NODE_ENV&&!1===r.preserve&&r.isListField&&i.length<=1&&jL(!1,"`preserve` should not apply on Form.List fields."),a.createElement($$,iL({key:o,name:i},r,{fieldContext:n}))}$$.contextType=VL,$$.defaultProps={trigger:"onChange",valuePropName:"value"};var z$="__@field_split__";function U$(e){return e.map((function(e){return"".concat(oL(e),":").concat(e)})).join(z$)}var H$=function(){function e(){wL(this,e),this.kvs=new Map}return CL(e,[{key:"set",value:function(e,t){this.kvs.set(U$(e),t)}},{key:"get",value:function(e){return this.kvs.get(U$(e))}},{key:"update",value:function(e,t){var r=t(this.get(e));r?this.set(e,r):this.delete(e)}},{key:"delete",value:function(e){this.kvs.delete(U$(e))}},{key:"map",value:function(e){return bL(this.kvs.entries()).map((function(t){var r=fL(t,2),n=r[0],i=r[1],o=n.split(z$);return e({key:o.map((function(e){var t=fL(e.match(/^([^:]*):(.*)$/),3),r=t[1],n=t[2];return"number"===r?Number(n):n})),value:i})}))}},{key:"toJSON",value:function(){var e={};return this.map((function(t){var r=t.key,n=t.value;return e[r.join(".")]=n,null})),e}}]),e}(),W$=function e(t){var r=this;wL(this,e),this.formHooked=!1,this.subscribable=!0,this.store={},this.fieldEntities=[],this.initialValues={},this.callbacks={},this.validateMessages=null,this.preserve=null,this.lastValidatePromise=null,this.getForm=function(){return{getFieldValue:r.getFieldValue,getFieldsValue:r.getFieldsValue,getFieldError:r.getFieldError,getFieldsError:r.getFieldsError,isFieldsTouched:r.isFieldsTouched,isFieldTouched:r.isFieldTouched,isFieldValidating:r.isFieldValidating,isFieldsValidating:r.isFieldsValidating,resetFields:r.resetFields,setFields:r.setFields,setFieldsValue:r.setFieldsValue,validateFields:r.validateFields,submit:r.submit,getInternalHooks:r.getInternalHooks}},this.getInternalHooks=function(e){return e===DL?(r.formHooked=!0,{dispatch:r.dispatch,initEntityValue:r.initEntityValue,registerField:r.registerField,useSubscribe:r.useSubscribe,setInitialValues:r.setInitialValues,setCallbacks:r.setCallbacks,setValidateMessages:r.setValidateMessages,getFields:r.getFields,setPreserve:r.setPreserve}):(jL(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)},this.useSubscribe=function(e){r.subscribable=e},this.setInitialValues=function(e,t){r.initialValues=e||{},t&&(r.store=k$({},e,r.store))},this.getInitialValue=function(e){return w$(r.initialValues,e)},this.setCallbacks=function(e){r.callbacks=e},this.setValidateMessages=function(e){r.validateMessages=e},this.setPreserve=function(e){r.preserve=e},this.timeoutId=null,this.warningUnhooked=function(){"production"!==Ti.exports.env.NODE_ENV&&!r.timeoutId&&typeof window<"u"&&(r.timeoutId=setTimeout((function(){r.timeoutId=null,r.formHooked||jL(!1,"Instance created by `useForm` is not connected to any Form element. Forget to pass `form` prop?")})))},this.getFieldEntities=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?r.fieldEntities.filter((function(e){return e.getNamePath().length})):r.fieldEntities},this.getFieldsMap=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new H$;return r.getFieldEntities(e).forEach((function(e){var r=e.getNamePath();t.set(r,e)})),t},this.getFieldEntitiesForNamePathList=function(e){if(!e)return r.getFieldEntities(!0);var t=r.getFieldsMap(!0);return e.map((function(e){var r=b$(e);return t.get(r)||{INVALIDATE_NAME_PATH:b$(e)}}))},this.getFieldsValue=function(e,t){if(r.warningUnhooked(),!0===e&&!t)return r.store;var n=r.getFieldEntitiesForNamePathList(Array.isArray(e)?e:null),i=[];return n.forEach((function(r){var n,o="INVALIDATE_NAME_PATH"in r?r.INVALIDATE_NAME_PATH:r.getNamePath();if(e||!(null===(n=r.isListField)||void 0===n?void 0:n.call(r)))if(t){var a="getMeta"in r?r.getMeta():null;t(a)&&i.push(o)}else i.push(o)})),C$(r.store,i.map(b$))},this.getFieldValue=function(e){r.warningUnhooked();var t=b$(e);return w$(r.store,t)},this.getFieldsError=function(e){return r.warningUnhooked(),r.getFieldEntitiesForNamePathList(e).map((function(t,r){return t&&!("INVALIDATE_NAME_PATH"in t)?{name:t.getNamePath(),errors:t.getErrors()}:{name:b$(e[r]),errors:[]}}))},this.getFieldError=function(e){r.warningUnhooked();var t=b$(e);return r.getFieldsError([t])[0].errors},this.isFieldsTouched=function(){r.warningUnhooked();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i,o=t[0],a=t[1],s=!1;0===t.length?i=null:1===t.length?Array.isArray(o)?(i=o.map(b$),s=!1):(i=null,s=o):(i=o.map(b$),s=a);var l=r.getFieldEntities(!0),c=function(e){return e.isFieldTouched()};if(!i)return s?l.every(c):l.some(c);var u=new H$;i.forEach((function(e){u.set(e,[])})),l.forEach((function(e){var t=e.getNamePath();i.forEach((function(r){r.every((function(e,r){return t[r]===e}))&&u.update(r,(function(t){return[].concat(bL(t),[e])}))}))}));var d=function(e){return e.some(c)},f=u.map((function(e){return e.value}));return s?f.every(d):f.some(d)},this.isFieldTouched=function(e){return r.warningUnhooked(),r.isFieldsTouched([e])},this.isFieldsValidating=function(e){r.warningUnhooked();var t=r.getFieldEntities();if(!e)return t.some((function(e){return e.isFieldValidating()}));var n=e.map(b$);return t.some((function(e){var t=e.getNamePath();return E$(n,t)&&e.isFieldValidating()}))},this.isFieldValidating=function(e){return r.warningUnhooked(),r.isFieldsValidating([e])},this.resetWithFieldInitialValue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new H$,n=r.getFieldEntities(!0);n.forEach((function(e){var r=e.props.initialValue,n=e.getNamePath();if(void 0!==r){var i=t.get(n)||new Set;i.add({entity:e,value:r}),t.set(n,i)}}));var i;e.entities?i=e.entities:e.namePathList?(i=[],e.namePathList.forEach((function(e){var r,n=t.get(e);n&&(r=i).push.apply(r,bL(bL(n).map((function(e){return e.entity}))))}))):i=n,i.forEach((function(n){if(void 0!==n.props.initialValue){var i=n.getNamePath();if(void 0!==r.getInitialValue(i))jL(!1,"Form already set 'initialValues' with path '".concat(i.join("."),"'. Field can not overwrite it."));else{var o=t.get(i);if(o&&o.size>1)jL(!1,"Multiple Field with path '".concat(i.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(o){var a=r.getFieldValue(i);(!e.skipExist||void 0===a)&&(r.store=_$(r.store,i,bL(o)[0].value))}}}}))},this.resetFields=function(e){r.warningUnhooked();var t=r.store;if(!e)return r.store=k$({},r.initialValues),r.resetWithFieldInitialValue(),void r.notifyObservers(t,null,{type:"reset"});var n=e.map(b$);n.forEach((function(e){var t=r.getInitialValue(e);r.store=_$(r.store,e,t)})),r.resetWithFieldInitialValue({namePathList:n}),r.notifyObservers(t,n,{type:"reset"})},this.setFields=function(e){r.warningUnhooked();var t=r.store;e.forEach((function(e){var n=e.name;e.errors;var i=gL(e,["name","errors"]),o=b$(n);"value"in i&&(r.store=_$(r.store,o,i.value)),r.notifyObservers(t,[o],{type:"setField",data:e})}))},this.getFields=function(){return r.getFieldEntities(!0).map((function(e){var t=e.getNamePath(),n=hL(hL({},e.getMeta()),{},{name:t,value:r.getFieldValue(t)});return Object.defineProperty(n,"originRCField",{value:!0}),n}))},this.initEntityValue=function(e){var t=e.props.initialValue;if(void 0!==t){var n=e.getNamePath();void 0===w$(r.store,n)&&(r.store=_$(r.store,n,t))}},this.registerField=function(e){if(r.fieldEntities.push(e),void 0!==e.props.initialValue){var t=r.store;r.resetWithFieldInitialValue({entities:[e],skipExist:!0}),r.notifyObservers(t,[e.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(r.fieldEntities=r.fieldEntities.filter((function(t){return t!==e})),!1===(void 0!==n?n:r.preserve)&&(!t||i.length>1)){var o=e.getNamePath(),a=t?void 0:w$(r.initialValues,o);o.length&&r.getFieldValue(o)!==a&&r.fieldEntities.every((function(e){return!O$(e.getNamePath(),o)}))&&(r.store=_$(r.store,o,a,!0))}}},this.dispatch=function(e){switch(e.type){case"updateValue":var t=e.namePath,n=e.value;r.updateValue(t,n);break;case"validateField":var i=e.namePath,o=e.triggerName;r.validateFields([i],{triggerName:o})}},this.notifyObservers=function(e,t,n){if(r.subscribable){var i=hL(hL({},n),{},{store:r.getFieldsValue(!0)});r.getFieldEntities().forEach((function(r){(0,r.onStoreChange)(e,t,i)}))}else r.forceRootUpdate()},this.updateValue=function(e,t){var n=b$(e),i=r.store;r.store=_$(r.store,n,t),r.notifyObservers(i,[n],{type:"valueUpdate",source:"internal"});var o=r.getDependencyChildrenFields(n);o.length&&r.validateFields(o),r.notifyObservers(i,o,{type:"dependenciesUpdate",relatedFields:[n].concat(bL(o))});var a=r.callbacks.onValuesChange;a&&a(C$(r.store,[n]),r.getFieldsValue());r.triggerOnFieldsChange([n].concat(bL(o)))},this.setFieldsValue=function(e){r.warningUnhooked();var t=r.store;e&&(r.store=k$(r.store,e)),r.notifyObservers(t,null,{type:"valueUpdate",source:"external"})},this.getDependencyChildrenFields=function(e){var t=new Set,n=[],i=new H$;r.getFieldEntities().forEach((function(e){(e.props.dependencies||[]).forEach((function(t){var r=b$(t);i.update(r,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Set;return t.add(e),t}))}))}));return function e(r){(i.get(r)||new Set).forEach((function(r){if(!t.has(r)){t.add(r);var i=r.getNamePath();r.isFieldDirty()&&i.length&&(n.push(i),e(i))}}))}(e),n},this.triggerOnFieldsChange=function(e,t){var n=r.callbacks.onFieldsChange;if(n){var i=r.getFields();if(t){var o=new H$;t.forEach((function(e){var t=e.name,r=e.errors;o.set(t,r)})),i.forEach((function(e){e.errors=o.get(e.name)||e.errors}))}n(i.filter((function(t){var r=t.name;return E$(e,r)})),i)}},this.validateFields=function(e,t){r.warningUnhooked();var n=!!e,i=n?e.map(b$):[],o=[];r.getFieldEntities(!0).forEach((function(a){if(n||i.push(a.getNamePath()),(null==t?void 0:t.recursive)&&n){var s=a.getNamePath();s.every((function(t,r){return e[r]===t||void 0===e[r]}))&&i.push(s)}if(a.props.rules&&a.props.rules.length){var l=a.getNamePath();if(!n||E$(i,l)){var c=a.validateRules(hL({validateMessages:hL(hL({},A$),r.validateMessages)},t));o.push(c.then((function(){return{name:l,errors:[]}})).catch((function(e){return Promise.reject({name:l,errors:e})})))}}}));var a=function(e){var t=!1,r=e.length,n=[];return e.length?new Promise((function(i,o){e.forEach((function(e,a){e.catch((function(e){return t=!0,e})).then((function(e){r-=1,n[a]=e,!(r>0)&&(t&&o(n),i(n))}))}))})):Promise.resolve([])}(o);r.lastValidatePromise=a,a.catch((function(e){return e})).then((function(e){var t=e.map((function(e){return e.name}));r.notifyObservers(r.store,t,{type:"validateFinish"}),r.triggerOnFieldsChange(t,e)}));var s=a.then((function(){return r.lastValidatePromise===a?Promise.resolve(r.getFieldsValue(i)):Promise.reject([])})).catch((function(e){var t=e.filter((function(e){return e&&e.errors.length}));return Promise.reject({values:r.getFieldsValue(i),errorFields:t,outOfDate:r.lastValidatePromise!==a})}));return s.catch((function(e){return e})),s},this.submit=function(){r.warningUnhooked(),r.validateFields().then((function(e){var t=r.callbacks.onFinish;if(t)try{t(e)}catch(e){console.error(e)}})).catch((function(e){var t=r.callbacks.onFinishFailed;t&&t(e)}))},this.forceRootUpdate=t};function G$(e){var t=a.useRef(),r=fL(a.useState({}),2)[1];if(!t.current)if(e)t.current=e;else{var n=new W$((function(){r({})}));t.current=n.getForm()}return[t.current]}var K$=a.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),q$=function(e,t){var r=e.name,n=e.initialValues,i=e.fields,o=e.form,s=e.preserve,l=e.children,c=e.component,u=void 0===c?"form":c,d=e.validateMessages,f=e.validateTrigger,p=void 0===f?"onChange":f,h=e.onValuesChange,m=e.onFieldsChange,v=e.onFinish,g=e.onFinishFailed,y=gL(e,["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed"]),b=a.useContext(K$),w=fL(G$(o),1)[0],_=w.getInternalHooks(DL),C=_.useSubscribe,E=_.setInitialValues,x=_.setCallbacks,S=_.setValidateMessages,k=_.setPreserve;a.useImperativeHandle(t,(function(){return w})),a.useEffect((function(){return b.registerForm(r,w),function(){b.unregisterForm(r)}}),[b,w,r]),S(hL(hL({},b.validateMessages),d)),x({onValuesChange:h,onFieldsChange:function(e){if(b.triggerFormChange(r,e),m){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];m.apply(void 0,[e].concat(n))}},onFinish:function(e){b.triggerFormFinish(r,e),v&&v(e)},onFinishFailed:g}),k(s);var O=a.useRef(null);E(n,!O.current),O.current||(O.current=!0);var I=l,R="function"==typeof l;R&&(I=l(w.getFieldsValue(!0),w));C(!R);var T=a.useRef();a.useEffect((function(){(function(e,t){if(e===t)return!0;if(!e&&t||e&&!t||!e||!t||"object"!==oL(e)||"object"!==oL(t))return!1;var r=Object.keys(e),n=Object.keys(t),i=new Set([].concat(bL(r),bL(n)));return bL(i).every((function(r){var n=e[r],i=t[r];return"function"==typeof n&&"function"==typeof i||n===i}))})(T.current||[],i||[])||w.setFields(i||[]),T.current=i}),[i,w]);var A=a.useMemo((function(){return hL(hL({},w),{},{validateTrigger:p})}),[w,p]),N=a.createElement(VL.Provider,{value:A},I);return!1===u?N:a.createElement(u,iL({},y,{onSubmit:function(e){e.preventDefault(),e.stopPropagation(),w.submit()},onReset:function(e){var t;e.preventDefault(),w.resetFields(),null===(t=y.onReset)||void 0===t||t.call(y,e)}}),N)},Y$=a.forwardRef(q$);function X$(e,t,r){var n=a.useRef({});return(!("value"in n.current)||r(n.current.condition,t))&&(n.current.value=e(),n.current.condition=t),n.current.value}Y$.FormProvider=function(e){var t=e.validateMessages,r=e.onFormChange,n=e.onFormFinish,i=e.children,o=a.useContext(K$),s=a.useRef({});return a.createElement(K$.Provider,{value:hL(hL({},o),{},{validateMessages:hL(hL({},o.validateMessages),t),triggerFormChange:function(e,t){r&&r(e,{changedFields:t,forms:s.current}),o.triggerFormChange(e,t)},triggerFormFinish:function(e,t){n&&n(e,{values:t,forms:s.current}),o.triggerFormFinish(e,t)},registerForm:function(e,t){e&&(s.current=hL(hL({},s.current),{},sL({},e,t))),o.registerForm(e,t)},unregisterForm:function(e){var t=hL({},s.current);delete t[e],s.current=t,o.unregisterForm(e)}})},i)},Y$.Field=B$,Y$.List=function(e){var t=e.name,r=e.initialValue,n=e.children,i=e.rules,o=e.validateTrigger,s=a.useContext(VL),l=a.useRef({keys:[],id:0}).current;if("function"!=typeof n)return jL(!1,"Form.List only accepts function as children."),null;var c=b$(s.prefixName)||[],u=[].concat(bL(c),bL(b$(t)));return a.createElement(VL.Provider,{value:hL(hL({},s),{},{prefixName:u})},a.createElement(B$,{name:[],shouldUpdate:function(e,t,r){return"internal"!==r.source&&e!==t},rules:i,validateTrigger:o,initialValue:r,isList:!0},(function(e,t){var r=e.value,i=void 0===r?[]:r,o=e.onChange,a=s.getFieldValue,c=function(){return a(u||[])||[]},d={add:function(e,t){var r=c();t>=0&&t<=r.length?(l.keys=[].concat(bL(l.keys.slice(0,t)),[l.id],bL(l.keys.slice(t))),o([].concat(bL(r.slice(0,t)),[e],bL(r.slice(t))))):("production"!==Ti.exports.env.NODE_ENV&&(t<0||t>r.length)&&jL(!1,"The second parameter of the add function should be a valid positive number."),l.keys=[].concat(bL(l.keys),[l.id]),o([].concat(bL(r),[e]))),l.id+=1},remove:function(e){var t=c(),r=new Set(Array.isArray(e)?e:[e]);r.size<=0||(l.keys=l.keys.filter((function(e,t){return!r.has(t)})),o(t.filter((function(e,t){return!r.has(t)}))))},move:function(e,t){if(e!==t){var r=c();e<0||e>=r.length||t<0||t>=r.length||(l.keys=R$(l.keys,e,t),o(R$(r,e,t)))}}},f=i||[];return Array.isArray(f)||(f=[],"production"!==Ti.exports.env.NODE_ENV&&jL(!1,"Current value of '".concat(u.join(" > "),"' is not an array type."))),n(f.map((function(e,t){var r=l.keys[t];return void 0===r&&(l.keys[t]=l.id,r=l.keys[t],l.id+=1),{name:t,key:r,isListField:!0}})),d,t)})))},Y$.useForm=G$;const Z$=function(e,t,r){jL(e,"[antd: ".concat(t,"] ").concat(r))};const J$={placeholder:"Select time",rangePlaceholder:["Start time","End time"]};const Q$={lang:iL({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},{locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"Ok",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"}),timePickerLocale:iL({},J$)};var eB="${label} is not a valid ${type}";const tB={locale:"en",Pagination:{items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"},DatePicker:Q$,TimePicker:J$,Calendar:Q$,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No Data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand"},PageHeader:{back:"Back"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:eB,method:eB,array:eB,object:eB,number:eB,date:eB,boolean:eB,integer:eB,float:eB,regexp:eB,email:eB,url:eB,hex:eB},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"}};const rB=Object(a.createContext)(void 0);var nB=function(e){SL(r,e);var t=OL(r);function r(){return wL(this,r),t.apply(this,arguments)}return CL(r,[{key:"getLocale",value:function(){var e=this.props,t=e.componentName,r=e.defaultLocale||tB[t||"global"],n=this.context,i=t&&n?n[t]:{};return iL(iL({},"function"==typeof r?r():r),i||{})}},{key:"getLocaleCode",value:function(){var e=this.context,t=e&&e.locale;return e&&e.exist&&!t?tB.locale:t}},{key:"render",value:function(){return this.props.children(this.getLocale(),this.getLocaleCode(),this.context)}}]),r}(a.Component);nB.defaultProps={componentName:"global"},nB.contextType=rB;const iB=function(){var e=(0,a.useContext(fB).getPrefixCls)("empty-img-default");return a.createElement("svg",{className:e,width:"184",height:"152",viewBox:"0 0 184 152",xmlns:"http://www.w3.org/2000/svg"},a.createElement("g",{fill:"none",fillRule:"evenodd"},a.createElement("g",{transform:"translate(24 31.67)"},a.createElement("ellipse",{className:"".concat(e,"-ellipse"),cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"}),a.createElement("path",{className:"".concat(e,"-path-1"),d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z"}),a.createElement("path",{className:"".concat(e,"-path-2"),d:"M101.537 86.214L80.63 61.102c-1.001-1.207-2.507-1.867-4.048-1.867H31.724c-1.54 0-3.047.66-4.048 1.867L6.769 86.214v13.792h94.768V86.214z",transform:"translate(13.56)"}),a.createElement("path",{className:"".concat(e,"-path-3"),d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z"}),a.createElement("path",{className:"".concat(e,"-path-4"),d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z"})),a.createElement("path",{className:"".concat(e,"-path-5"),d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z"}),a.createElement("g",{className:"".concat(e,"-g"),transform:"translate(149.65 15.383)"},a.createElement("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"}),a.createElement("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"}))))};const oB=function(){var e=(0,a.useContext(fB).getPrefixCls)("empty-img-simple");return a.createElement("svg",{className:e,width:"64",height:"41",viewBox:"0 0 64 41",xmlns:"http://www.w3.org/2000/svg"},a.createElement("g",{transform:"translate(0 1)",fill:"none",fillRule:"evenodd"},a.createElement("ellipse",{className:"".concat(e,"-ellipse"),cx:"32",cy:"33",rx:"32",ry:"7"}),a.createElement("g",{className:"".concat(e,"-g"),fillRule:"nonzero"},a.createElement("path",{d:"M55 12.76L44.854 1.258C44.367.474 43.656 0 42.907 0H21.093c-.749 0-1.46.474-1.947 1.257L9 12.761V22h46v-9.24z"}),a.createElement("path",{d:"M41.613 15.931c0-1.605.994-2.93 2.227-2.931H55v18.137C55 33.26 53.68 35 52.05 35h-40.1C10.32 35 9 33.259 9 31.137V13h11.16c1.233 0 2.227 1.323 2.227 2.928v.022c0 1.605 1.005 2.901 2.237 2.901h14.752c1.232 0 2.237-1.308 2.237-2.913v-.007z",className:"".concat(e,"-path")}))))};var aB=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},sB=a.createElement(iB,null),lB=a.createElement(oB,null),cB=function(e){var t=e.className,r=e.prefixCls,n=e.image,i=void 0===n?sB:n,o=e.description,s=e.children,l=e.imageStyle,c=aB(e,["className","prefixCls","image","description","children","imageStyle"]),u=a.useContext(fB),d=u.getPrefixCls,f=u.direction;return a.createElement(nB,{componentName:"Empty"},(function(e){var n,u=d("empty",r),p=typeof o<"u"?o:e.description,h="string"==typeof p?p:"empty",m=null;return m="string"==typeof i?a.createElement("img",{alt:h,src:i}):i,a.createElement("div",iL({className:GA(u,(n={},sL(n,"".concat(u,"-normal"),i===lB),sL(n,"".concat(u,"-rtl"),"rtl"===f),n),t)},c),a.createElement("div",{className:"".concat(u,"-image"),style:l},m),p&&a.createElement("div",{className:"".concat(u,"-description")},p),s&&a.createElement("div",{className:"".concat(u,"-footer")},s))}))};cB.PRESENTED_IMAGE_DEFAULT=sB,cB.PRESENTED_IMAGE_SIMPLE=lB;const uB=cB;const dB=function(e){return a.createElement(pB,null,(function(t){var r=(0,t.getPrefixCls)("empty");switch(e){case"Table":case"List":return a.createElement(uB,{image:uB.PRESENTED_IMAGE_SIMPLE});case"Select":case"TreeSelect":case"Cascader":case"Transfer":case"Mentions":return a.createElement(uB,{image:uB.PRESENTED_IMAGE_SIMPLE,className:"".concat(r,"-small")});default:return a.createElement(uB,null)}}))};var fB=a.createContext({getPrefixCls:function(e,t){return t||(e?"ant-".concat(e):"ant")},renderEmpty:dB}),pB=fB.Consumer;const hB=a.createContext(void 0);function mB(e){return e instanceof HTMLElement||e instanceof SVGElement}function vB(e){return mB(e)?e:e instanceof s.a.Component?c.a.findDOMNode(e):null}function gB(e,t){"function"==typeof e?e(t):"object"===oL(e)&&e&&"current"in e&&(e.current=t)}function yB(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.filter((function(e){return e}));return n.length<=1?n[0]:function(e){t.forEach((function(t){gB(t,e)}))}}function bB(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return X$((function(){return yB.apply(void 0,t)}),t,(function(e,t){return e.length!==t.length||e.every((function(e,r){return e!==t[r]}))}))}function wB(e){var t,r,n=IL.isMemo(e)?e.type.type:e.type;return!("function"==typeof n&&(null===(t=n.prototype)||void 0===t||!t.render)||"function"==typeof e&&(null===(r=e.prototype)||void 0===r||!r.render))}var _B=a.createContext({}),CB=function(e){SL(r,e);var t=OL(r);function r(){return wL(this,r),t.apply(this,arguments)}return CL(r,[{key:"render",value:function(){return this.props.children}}]),r}(a.Component);function EB(e){var t=a.useRef(!1),r=fL(a.useState(e),2),n=r[0],i=r[1];return a.useEffect((function(){return t.current=!1,function(){t.current=!0}}),[]),[n,function(e,r){r&&t.current||i(e)}]}var xB="none",SB="appear",kB="enter",OB="leave",IB="none",RB="prepare",TB="start",AB="active",NB="end",MB="prepared";function PB(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function jB(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit".concat(e)]="webkit".concat(t),r["Moz".concat(e)]="moz".concat(t),r["ms".concat(e)]="MS".concat(t),r["O".concat(e)]="o".concat(t.toLowerCase()),r}var DB=function(e,t){var r={animationend:jB("Animation","AnimationEnd"),transitionend:jB("Transition","TransitionEnd")};return e&&("AnimationEvent"in t||delete r.animationend.animation,"TransitionEvent"in t||delete r.transitionend.transition),r}(PB(),typeof window<"u"?window:{}),FB={};if(PB()){var VB=document.createElement("div");FB=VB.style}var LB={};function $B(e){if(LB[e])return LB[e];var t=DB[e];if(t)for(var r=Object.keys(t),n=r.length,i=0;i<n;i+=1){var o=r[i];if(Object.prototype.hasOwnProperty.call(t,o)&&o in FB)return LB[e]=t[o],LB[e]}return""}var BB=$B("animationend"),zB=$B("transitionend"),UB=!(!BB||!zB),HB=BB||"animationend",WB=zB||"transitionend";function GB(e,t){if(!e)return null;if("object"===oL(e)){var r=t.replace(/-\w/g,(function(e){return e[1].toUpperCase()}));return e[r]}return"".concat(e,"-").concat(t)}const KB=function(e){var t=Object(a.useRef)(),r=Object(a.useRef)(e);r.current=e;var n=a.useCallback((function(e){r.current(e)}),[]);function i(e){e&&(e.removeEventListener(WB,n),e.removeEventListener(HB,n))}return a.useEffect((function(){return function(){i(t.current)}}),[]),[function(e){t.current&&t.current!==e&&i(t.current),e&&e!==t.current&&(e.addEventListener(WB,n),e.addEventListener(HB,n),t.current=e)},i]};var qB=PB()?a.useLayoutEffect:a.useEffect,YB=function(e){return+setTimeout(e,16)},XB=function(e){return clearTimeout(e)};typeof window<"u"&&"requestAnimationFrame"in window&&(YB=function(e){return window.requestAnimationFrame(e)},XB=function(e){return window.cancelAnimationFrame(e)});var ZB=0,JB=new Map;function QB(e){JB.delete(e)}var ez=function(e){var t=ZB+=1;return function r(n){if(0===n)QB(t),e();else{var i=YB((function(){r(n-1)}));JB.set(t,i)}}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),t};ez.cancel=function(e){var t=JB.get(e);return QB(t),XB(t)};var tz=[RB,TB,AB,NB],rz=[RB,MB],nz=!1,iz=!0;function oz(e){return e===AB||e===NB}const az=function(e,t,r){var n=fL(EB(IB),2),i=n[0],o=n[1],s=function(){var e=a.useRef(null);function t(){ez.cancel(e.current)}return a.useEffect((function(){return function(){t()}}),[]),[function r(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;t();var o=ez((function(){i<=1?n({isCanceled:function(){return o!==e.current}}):r(n,i-1)}));e.current=o},t]}(),l=fL(s,2),c=l[0],u=l[1];var d=t?rz:tz;return qB((function(){if(i!==IB&&i!==NB){var e=d.indexOf(i),t=d[e+1],n=r(i);n===nz?o(t,!0):t&&c((function(e){function r(){e.isCanceled()||o(t,!0)}!0===n?r():Promise.resolve(n).then(r)}))}}),[e,i]),a.useEffect((function(){return function(){u()}}),[]),[function(){o(RB,!0)},i]};const sz=function(e){var t=e;"object"===oL(e)&&(t=e.transitionSupport);var r=a.forwardRef((function(e,r){var n=e.visible,i=void 0===n||n,o=e.removeOnLeave,s=void 0===o||o,l=e.forceRender,c=e.children,u=e.motionName,d=e.leavedClassName,f=e.eventProps,p=function(e,r){return!(!e.motionName||!t||!1===r)}(e,a.useContext(_B).motion),h=Object(a.useRef)(),m=Object(a.useRef)();var v=function(e,t,r,n){var i=n.motionEnter,o=void 0===i||i,s=n.motionAppear,l=void 0===s||s,c=n.motionLeave,u=void 0===c||c,d=n.motionDeadline,f=n.motionLeaveImmediately,p=n.onAppearPrepare,h=n.onEnterPrepare,m=n.onLeavePrepare,v=n.onAppearStart,g=n.onEnterStart,y=n.onLeaveStart,b=n.onAppearActive,w=n.onEnterActive,_=n.onLeaveActive,C=n.onAppearEnd,E=n.onEnterEnd,x=n.onLeaveEnd,S=n.onVisibleChanged,k=fL(EB(),2),O=k[0],I=k[1],R=fL(EB(xB),2),T=R[0],A=R[1],N=fL(EB(null),2),M=N[0],P=N[1],j=Object(a.useRef)(!1),D=Object(a.useRef)(null);function F(){return r()}var V=Object(a.useRef)(!1);function L(){A(xB,!0),P(null,!0)}function $(e){var t=F();if(!e||e.deadline||e.target===t){var r,n=V.current;T===SB&&n?r=null==C?void 0:C(t,e):T===kB&&n?r=null==E?void 0:E(t,e):T===OB&&n&&(r=null==x?void 0:x(t,e)),T!==xB&&n&&!1!==r&&L()}}var B=fL(KB($),1)[0],z=function(e){var t,r,n;switch(e){case SB:return sL(t={},RB,p),sL(t,TB,v),sL(t,AB,b),t;case kB:return sL(r={},RB,h),sL(r,TB,g),sL(r,AB,w),r;case OB:return sL(n={},RB,m),sL(n,TB,y),sL(n,AB,_),n;default:return{}}},U=a.useMemo((function(){return z(T)}),[T]),H=fL(az(T,!e,(function(e){if(e===RB){var t=U[RB];return t?t(F()):nz}var r;return G in U&&P((null===(r=U[G])||void 0===r?void 0:r.call(U,F(),null))||null),G===AB&&(B(F()),d>0&&(clearTimeout(D.current),D.current=setTimeout((function(){$({deadline:!0})}),d))),G===MB&&L(),iz})),2),W=H[0],G=H[1],K=oz(G);V.current=K,qB((function(){I(t);var r,n=j.current;j.current=!0,!n&&t&&l&&(r=SB),n&&t&&o&&(r=kB),(n&&!t&&u||!n&&f&&!t&&u)&&(r=OB);var i=z(r);r&&(e||i[RB])?(A(r),W()):A(xB)}),[t]),Object(a.useEffect)((function(){(T===SB&&!l||T===kB&&!o||T===OB&&!u)&&A(xB)}),[l,o,u]),Object(a.useEffect)((function(){return function(){j.current=!1,clearTimeout(D.current)}}),[]);var q=a.useRef(!1);Object(a.useEffect)((function(){O&&(q.current=!0),void 0!==O&&T===xB&&((q.current||O)&&(null==S||S(O)),q.current=!0)}),[O,T]);var Y=M;return U[RB]&&G===TB&&(Y=hL({transition:"none"},Y)),[T,G,Y,null!=O?O:t]}(p,i,(function(){try{return h.current instanceof HTMLElement?h.current:vB(m.current)}catch{return null}}),e),g=fL(v,4),y=g[0],b=g[1],w=g[2],_=g[3],C=a.useRef(_);_&&(C.current=!0);var E,x=a.useCallback((function(e){h.current=e,gB(r,e)}),[r]),S=hL(hL({},f),{},{visible:i});if(c)if(y===xB)E=_?c(hL({},S),x):!s&&C.current&&d?c(hL(hL({},S),{},{className:d}),x):l||!s&&!d?c(hL(hL({},S),{},{style:{display:"none"}}),x):null;else{var k,O;b===RB?O="prepare":oz(b)?O="active":b===TB&&(O="start");var I=GB(u,"".concat(y,"-").concat(O));E=c(hL(hL({},S),{},{className:GA(GB(u,y),(k={},sL(k,I,I&&O),sL(k,u,"string"==typeof u),k)),style:w}),x)}else E=null;a.isValidElement(E)&&wB(E)&&(E.ref||(E=a.cloneElement(E,{ref:x})));return a.createElement(CB,{ref:m},E)}));return r.displayName="CSSMotion",r}(UB);var lz="add",cz="keep",uz="remove",dz="removed";function fz(e){var t;return hL(hL({},t=e&&"object"===oL(e)&&"key"in e?e:{key:e}),{},{key:String(t.key)})}function pz(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(fz)}var hz=["component","children","onVisibleChanged","onAllRemoved"],mz=["status"],vz=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sz,r=function(e){SL(n,e);var r=OL(n);function n(){var e;wL(this,n);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return sL(EL(e=r.call.apply(r,[this].concat(i))),"state",{keyEntities:[]}),sL(EL(e),"removeKey",(function(t){var r=e.state.keyEntities.map((function(e){return e.key!==t?e:hL(hL({},e),{},{status:dz})}));return e.setState({keyEntities:r}),r.filter((function(e){return e.status!==dz})).length})),e}return CL(n,[{key:"render",value:function(){var e=this,r=this.state.keyEntities,n=this.props,i=n.component,o=n.children,s=n.onVisibleChanged,l=n.onAllRemoved,c=gL(n,hz),u=i||a.Fragment,d={};return vz.forEach((function(e){d[e]=c[e],delete c[e]})),delete c.keys,a.createElement(u,c,r.map((function(r,n){var i=r.status,c=gL(r,mz),u=i===lz||i===cz;return a.createElement(t,iL({},d,{key:c.key,visible:u,eventProps:c,onVisibleChanged:function(t){(null==s||s(t,{key:c.key}),t)||0===e.removeKey(c.key)&&l&&l()}}),(function(e,t){return o(hL(hL({},e),{},{index:n}),t)}))})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r=e.keys,n=t.keyEntities,i=pz(r),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[],n=0,i=t.length,o=pz(e),a=pz(t);o.forEach((function(e){for(var t=!1,o=n;o<i;o+=1){var s=a[o];if(s.key===e.key){n<o&&(r=r.concat(a.slice(n,o).map((function(e){return hL(hL({},e),{},{status:lz})}))),n=o),r.push(hL(hL({},s),{},{status:cz})),n+=1,t=!0;break}}t||r.push(hL(hL({},e),{},{status:uz}))})),n<i&&(r=r.concat(a.slice(n).map((function(e){return hL(hL({},e),{},{status:lz})}))));var s={};return r.forEach((function(e){var t=e.key;s[t]=(s[t]||0)+1})),Object.keys(s).filter((function(e){return s[e]>1})).forEach((function(e){(r=r.filter((function(t){var r=t.key,n=t.status;return r!==e||n!==uz}))).forEach((function(t){t.key===e&&(t.status=cz)}))})),r}(n,i);return{keyEntities:o.filter((function(e){var t=n.find((function(t){var r=t.key;return e.key===r}));return!(t&&t.status===dz&&e.status===uz)}))}}}]),n}(a.Component);sL(r,"defaultProps",{component:"div"})}(UB);const gz={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"};function yz(e,t){(function(e){return"string"==typeof e&&-1!==e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var r=function(e){return"string"==typeof e&&-1!==e.indexOf("%")}(e);return e=360===t?e:Math.min(t,Math.max(0,parseFloat(e))),r&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:e=360===t?(e<0?e%t+t:e%t)/parseFloat(String(t)):e%t/parseFloat(String(t))}function bz(e){return e<=1?"".concat(100*Number(e),"%"):e}function wz(e){return 1===e.length?"0"+e:String(e)}function _z(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*r*(t-e):r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function Cz(e){return Ez(e)/255}function Ez(e){return parseInt(e,16)}var xz={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Sz(e){var t={r:0,g:0,b:0},r=1,n=null,i=null,o=null,a=!1,s=!1;return"string"==typeof e&&(e=function(e){if(e=e.trim().toLowerCase(),0===e.length)return!1;var t=!1;if(xz[e])e=xz[e],t=!0;else if("transparent"===e)return{r:0,g:0,b:0,a:0,format:"name"};var r=Rz.rgb.exec(e);return r?{r:r[1],g:r[2],b:r[3]}:(r=Rz.rgba.exec(e),r?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=Rz.hsl.exec(e),r?{h:r[1],s:r[2],l:r[3]}:(r=Rz.hsla.exec(e),r?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=Rz.hsv.exec(e),r?{h:r[1],s:r[2],v:r[3]}:(r=Rz.hsva.exec(e),r?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=Rz.hex8.exec(e),r?{r:Ez(r[1]),g:Ez(r[2]),b:Ez(r[3]),a:Cz(r[4]),format:t?"name":"hex8"}:(r=Rz.hex6.exec(e),r?{r:Ez(r[1]),g:Ez(r[2]),b:Ez(r[3]),format:t?"name":"hex"}:(r=Rz.hex4.exec(e),r?{r:Ez(r[1]+r[1]),g:Ez(r[2]+r[2]),b:Ez(r[3]+r[3]),a:Cz(r[4]+r[4]),format:t?"name":"hex8"}:(r=Rz.hex3.exec(e),!!r&&{r:Ez(r[1]+r[1]),g:Ez(r[2]+r[2]),b:Ez(r[3]+r[3]),format:t?"name":"hex"})))))))))}(e)),"object"==typeof e&&(Tz(e.r)&&Tz(e.g)&&Tz(e.b)?(t=function(e,t,r){return{r:255*yz(e,255),g:255*yz(t,255),b:255*yz(r,255)}}(e.r,e.g,e.b),a=!0,s="%"===String(e.r).substr(-1)?"prgb":"rgb"):Tz(e.h)&&Tz(e.s)&&Tz(e.v)?(n=bz(e.s),i=bz(e.v),t=function(e,t,r){e=6*yz(e,360),t=yz(t,100),r=yz(r,100);var n=Math.floor(e),i=e-n,o=r*(1-t),a=r*(1-i*t),s=r*(1-(1-i)*t),l=n%6;return{r:255*[r,a,o,o,s,r][l],g:255*[s,r,r,a,o,o][l],b:255*[o,o,s,r,r,a][l]}}(e.h,n,i),a=!0,s="hsv"):Tz(e.h)&&Tz(e.s)&&Tz(e.l)&&(n=bz(e.s),o=bz(e.l),t=function(e,t,r){var n,i,o;if(e=yz(e,360),t=yz(t,100),r=yz(r,100),0===t)i=r,o=r,n=r;else{var a=r<.5?r*(1+t):r+t-r*t,s=2*r-a;n=_z(s,a,e+1/3),i=_z(s,a,e),o=_z(s,a,e-1/3)}return{r:255*n,g:255*i,b:255*o}}(e.h,n,o),a=!0,s="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(r=e.a)),r=function(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}(r),{ok:a,format:e.format||s,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:r}}var kz="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),Oz="[\\s|\\(]+(".concat(kz,")[,|\\s]+(").concat(kz,")[,|\\s]+(").concat(kz,")\\s*\\)?"),Iz="[\\s|\\(]+(".concat(kz,")[,|\\s]+(").concat(kz,")[,|\\s]+(").concat(kz,")[,|\\s]+(").concat(kz,")\\s*\\)?"),Rz={CSS_UNIT:new RegExp(kz),rgb:new RegExp("rgb"+Oz),rgba:new RegExp("rgba"+Iz),hsl:new RegExp("hsl"+Oz),hsla:new RegExp("hsla"+Iz),hsv:new RegExp("hsv"+Oz),hsva:new RegExp("hsva"+Iz),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function Tz(e){return Boolean(Rz.CSS_UNIT.exec(String(e)))}var Az=2,Nz=.16,Mz=.05,Pz=.05,jz=.15,Dz=5,Fz=4,Vz=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function Lz(e){var t=function(e,t,r){e=yz(e,255),t=yz(t,255),r=yz(r,255);var n=Math.max(e,t,r),i=Math.min(e,t,r),o=0,a=n,s=n-i,l=0===n?0:s/n;if(n===i)o=0;else{switch(n){case e:o=(t-r)/s+(t<r?6:0);break;case t:o=(r-e)/s+2;break;case r:o=(e-t)/s+4}o/=6}return{h:o,s:l,v:a}}(e.r,e.g,e.b);return{h:360*t.h,s:t.s,v:t.v}}function $z(e){var t=e.r,r=e.g,n=e.b;return"#".concat(function(e,t,r,n){var i=[wz(Math.round(e).toString(16)),wz(Math.round(t).toString(16)),wz(Math.round(r).toString(16))];return n&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}(t,r,n,!1))}function Bz(e,t,r){var n;return(n=Math.round(e.h)>=60&&Math.round(e.h)<=240?r?Math.round(e.h)-Az*t:Math.round(e.h)+Az*t:r?Math.round(e.h)+Az*t:Math.round(e.h)-Az*t)<0?n+=360:n>=360&&(n-=360),n}function zz(e,t,r){return 0===e.h&&0===e.s?e.s:((n=r?e.s-Nz*t:t===Fz?e.s+Nz:e.s+Mz*t)>1&&(n=1),r&&t===Dz&&n>.1&&(n=.1),n<.06&&(n=.06),Number(n.toFixed(2)));var n}function Uz(e,t,r){var n;return(n=r?e.v+Pz*t:e.v-jz*t)>1&&(n=1),Number(n.toFixed(2))}function Hz(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[],n=Sz(e),i=Dz;i>0;i-=1){var o=Lz(n),a=$z(Sz({h:Bz(o,i,!0),s:zz(o,i,!0),v:Uz(o,i,!0)}));r.push(a)}r.push($z(n));for(var s=1;s<=Fz;s+=1){var l=Lz(n),c=$z(Sz({h:Bz(l,s),s:zz(l,s),v:Uz(l,s)}));r.push(c)}return"dark"===t.theme?Vz.map((function(e){var n=e.index,i=e.opacity,o=$z(function(e,t,r){var n=r/100;return{r:(t.r-e.r)*n+e.r,g:(t.g-e.g)*n+e.g,b:(t.b-e.b)*n+e.b}}(Sz(t.backgroundColor||"#141414"),Sz(r[n]),100*i));return o})):r}var Wz={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1890FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},Gz={},Kz={};function qz(e,t){if(!e)return!1;if(e.contains)return e.contains(t);for(var r=t;r;){if(r===e)return!0;r=r.parentNode}return!1}Object.keys(Wz).forEach((function(e){Gz[e]=Hz(Wz[e]),Gz[e].primary=Gz[e][5],Kz[e]=Hz(Wz[e],{theme:"dark",backgroundColor:"#141414"}),Kz[e].primary=Kz[e][5]}));var Yz="data-rc-order",Xz="data-rc-priority",Zz="rc-util-key",Jz=new Map;function Qz(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).mark;return e?e.startsWith("data-")?e:"data-".concat(e):Zz}function eU(e){return e.attachTo?e.attachTo:document.querySelector("head")||document.body}function tU(e){return Array.from((Jz.get(e)||e).children).filter((function(e){return"STYLE"===e.tagName}))}function rU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!PB())return null;var r=t.csp,n=t.prepend,i=t.priority,o=void 0===i?0:i,a=function(e){return"queue"===e?"prependQueue":e?"prepend":"append"}(n),s="prependQueue"===a,l=document.createElement("style");l.setAttribute(Yz,a),s&&o&&l.setAttribute(Xz,"".concat(o)),null!=r&&r.nonce&&(l.nonce=null==r?void 0:r.nonce),l.innerHTML=e;var c=eU(t),u=c.firstChild;if(n){if(s){var d=tU(c).filter((function(e){if(!["prepend","prependQueue"].includes(e.getAttribute(Yz)))return!1;var t=Number(e.getAttribute(Xz)||0);return o>=t}));if(d.length)return c.insertBefore(l,d[d.length-1].nextSibling),l}c.insertBefore(l,u)}else c.appendChild(l);return l}function nU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return tU(eU(t)).find((function(r){return r.getAttribute(Qz(t))===e}))}function iU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=nU(e,t);r&&eU(t).removeChild(r)}function oU(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){var r=Jz.get(e);if(!r||!qz(document,r)){var n=rU("",t),i=n.parentNode;Jz.set(e,i),e.removeChild(n)}}(eU(r),r);var n=nU(t,r);if(n){var i,o,a;if(null!==(i=r.csp)&&void 0!==i&&i.nonce&&n.nonce!==(null===(o=r.csp)||void 0===o?void 0:o.nonce))n.nonce=null===(a=r.csp)||void 0===a?void 0:a.nonce;return n.innerHTML!==e&&(n.innerHTML=e),n}var s=rU(e,r);return s.setAttribute(Qz(r),t),s}var aU="object"==typeof ki&&ki&&ki.Object===Object&&ki,sU=aU,lU="object"==typeof self&&self&&self.Object===Object&&self,cU=sU||lU||Function("return this")(),uU=cU.Symbol;var dU=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i},fU=Array.isArray,pU=uU,hU=Object.prototype,mU=hU.hasOwnProperty,vU=hU.toString,gU=pU?pU.toStringTag:void 0;var yU=function(e){var t=mU.call(e,gU),r=e[gU];try{e[gU]=void 0;var n=!0}catch{}var i=vU.call(e);return n&&(t?e[gU]=r:delete e[gU]),i},bU=Object.prototype.toString;var wU=function(e){return bU.call(e)},_U=yU,CU=wU,EU=uU?uU.toStringTag:void 0;var xU=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":EU&&EU in Object(e)?_U(e):CU(e)};var SU=function(e){return null!=e&&"object"==typeof e},kU=xU,OU=SU;var IU=function(e){return"symbol"==typeof e||OU(e)&&"[object Symbol]"==kU(e)},RU=dU,TU=fU,AU=IU,NU=uU?uU.prototype:void 0,MU=NU?NU.toString:void 0;var PU=function e(t){if("string"==typeof t)return t;if(TU(t))return RU(t,e)+"";if(AU(t))return MU?MU.call(t):"";var r=t+"";return"0"==r&&1/t==-Infinity?"-0":r},jU=PU;var DU=function(e){return null==e?"":jU(e)};var FU=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o},VU=FU;var LU=function(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&r>=n?e:VU(e,t,r)},$U=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var BU=function(e){return $U.test(e)};var zU=function(e){return e.split("")},UU="\\ud800-\\udfff",HU="["+UU+"]",WU="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",GU="\\ud83c[\\udffb-\\udfff]",KU="[^"+UU+"]",qU="(?:\\ud83c[\\udde6-\\uddff]){2}",YU="[\\ud800-\\udbff][\\udc00-\\udfff]",XU="(?:"+WU+"|"+GU+")"+"?",ZU="[\\ufe0e\\ufe0f]?",JU=ZU+XU+("(?:\\u200d(?:"+[KU,qU,YU].join("|")+")"+ZU+XU+")*"),QU="(?:"+[KU+WU+"?",WU,qU,YU,HU].join("|")+")",eH=RegExp(GU+"(?="+GU+")|"+QU+JU,"g");var tH=function(e){return e.match(eH)||[]},rH=zU,nH=BU,iH=tH;var oH=function(e){return nH(e)?iH(e):rH(e)},aH=LU,sH=BU,lH=oH,cH=DU;var uH=function(e){return function(t){t=cH(t);var r=sH(t)?lH(t):void 0,n=r?r[0]:t.charAt(0),i=r?aH(r,1).join(""):t.slice(1);return n[e]()+i}},dH=uH("toUpperCase"),fH=DU,pH=dH;var hH=function(e){return pH(fH(e).toLowerCase())};var mH=function(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r};var vH=function(e){return function(t){return null==e?void 0:e[t]}},gH=vH({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),yH=DU,bH=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,wH=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");var _H=function(e){return(e=yH(e))&&e.replace(bH,gH).replace(wH,"")},CH=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var EH=function(e){return e.match(CH)||[]},xH=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var SH=function(e){return xH.test(e)},kH="\\ud800-\\udfff",OH="\\u2700-\\u27bf",IH="a-z\\xdf-\\xf6\\xf8-\\xff",RH="A-Z\\xc0-\\xd6\\xd8-\\xde",TH="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",AH="["+TH+"]",NH="\\d+",MH="["+OH+"]",PH="["+IH+"]",jH="[^"+kH+TH+NH+OH+IH+RH+"]",DH="(?:\\ud83c[\\udde6-\\uddff]){2}",FH="[\\ud800-\\udbff][\\udc00-\\udfff]",VH="["+RH+"]",LH="(?:"+PH+"|"+jH+")",$H="(?:"+VH+"|"+jH+")",BH="(?:['’](?:d|ll|m|re|s|t|ve))?",zH="(?:['’](?:D|LL|M|RE|S|T|VE))?",UH="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",HH="[\\ufe0e\\ufe0f]?",WH=HH+UH+("(?:\\u200d(?:"+["[^"+kH+"]",DH,FH].join("|")+")"+HH+UH+")*"),GH="(?:"+[MH,DH,FH].join("|")+")"+WH,KH=RegExp([VH+"?"+PH+"+"+BH+"(?="+[AH,VH,"$"].join("|")+")",$H+"+"+zH+"(?="+[AH,VH+LH,"$"].join("|")+")",VH+"?"+LH+"+"+BH,VH+"+"+zH,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",NH,GH].join("|"),"g");var qH=function(e){return e.match(KH)||[]},YH=EH,XH=SH,ZH=DU,JH=qH;var QH=function(e,t,r){return e=ZH(e),void 0===(t=r?void 0:t)?XH(e)?JH(e):YH(e):e.match(t)||[]},eW=mH,tW=_H,rW=QH,nW=RegExp("['’]","g");var iW=function(e){return function(t){return eW(rW(tW(t).replace(nW,"")),e,"")}},oW=hH,aW=iW((function(e,t,r){return t=t.toLowerCase(),e+(r?oW(t):t)})),sW=aW;function lW(e){return"object"===oL(e)&&"string"==typeof e.name&&"string"==typeof e.theme&&("object"===oL(e.icon)||"function"==typeof e.icon)}function cW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((function(t,r){var n=e[r];if("class"===r)t.className=n,delete t.class;else delete t[r],t[sW(r)]=n;return t}),{})}function uW(e,t,r){return r?s.a.createElement(e.tag,hL(hL({key:t},cW(e.attrs)),r),(e.children||[]).map((function(r,n){return uW(r,"".concat(t,"-").concat(e.tag,"-").concat(n))}))):s.a.createElement(e.tag,hL({key:t},cW(e.attrs)),(e.children||[]).map((function(r,n){return uW(r,"".concat(t,"-").concat(e.tag,"-").concat(n))})))}function dW(e){return Hz(e)[0]}function fW(e){return e?Array.isArray(e)?e:[e]:[]}var pW=["icon","className","onClick","style","primaryColor","secondaryColor"],hW={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};var mW=function(e){var t=e.icon,r=e.className,n=e.onClick,i=e.style,o=e.primaryColor,s=e.secondaryColor,l=gL(e,pW),c=hW;if(o&&(c={primaryColor:o,secondaryColor:s||dW(o)}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\n.anticon {\n  display: inline-block;\n  color: inherit;\n  font-style: normal;\n  line-height: 0;\n  text-align: center;\n  text-transform: none;\n  vertical-align: -0.125em;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.anticon > * {\n  line-height: 1;\n}\n\n.anticon svg {\n  display: inline-block;\n}\n\n.anticon::before {\n  display: none;\n}\n\n.anticon .anticon-icon {\n  display: block;\n}\n\n.anticon[tabindex] {\n  cursor: pointer;\n}\n\n.anticon-spin::before,\n.anticon-spin {\n  display: inline-block;\n  -webkit-animation: loadingCircle 1s infinite linear;\n  animation: loadingCircle 1s infinite linear;\n}\n\n@-webkit-keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n",t=Object(a.useContext)(vL).csp;Object(a.useEffect)((function(){oU(e,"@ant-design-icons",{prepend:!0,csp:t})}),[])}(),function(e,t){jL(e,"[@ant-design/icons] ".concat(t))}(lW(t),"icon should be icon definiton, but got ".concat(t)),!lW(t))return null;var u=t;return u&&"function"==typeof u.icon&&(u=hL(hL({},u),{},{icon:u.icon(c.primaryColor,c.secondaryColor)})),uW(u.icon,"svg-".concat(u.name),hL({className:r,onClick:n,style:i,"data-icon":u.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},l))};mW.displayName="IconReact",mW.getTwoToneColors=function(){return hL({},hW)},mW.setTwoToneColors=function(e){var t=e.primaryColor,r=e.secondaryColor;hW.primaryColor=t,hW.secondaryColor=r||dW(t),hW.calculated=!!r};const vW=mW;function gW(e){var t=fL(fW(e),2),r=t[0],n=t[1];return vW.setTwoToneColors({primaryColor:r,secondaryColor:n})}var yW=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];gW("#1890ff");var bW=a.forwardRef((function(e,t){var r,n=e.className,i=e.icon,o=e.spin,s=e.rotate,l=e.tabIndex,c=e.onClick,u=e.twoToneColor,d=gL(e,yW),f=a.useContext(vL),p=f.prefixCls,h=void 0===p?"anticon":p,m=f.rootClassName,v=GA(m,h,(sL(r={},"".concat(h,"-").concat(i.name),!!i.name),sL(r,"".concat(h,"-spin"),!!o||"loading"===i.name),r),n),g=l;void 0===g&&c&&(g=-1);var y=s?{msTransform:"rotate(".concat(s,"deg)"),transform:"rotate(".concat(s,"deg)")}:void 0,b=fL(fW(u),2),w=b[0],_=b[1];return a.createElement("span",hL(hL({role:"img","aria-label":i.name},d),{},{ref:t,tabIndex:g,onClick:c,className:v}),a.createElement(vW,{icon:i,primaryColor:w,secondaryColor:_,style:y}))}));bW.displayName="AntdIcon",bW.getTwoToneColor=function(){var e=vW.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor},bW.setTwoToneColor=gW;const wW=bW;var _W=function(e,t){return a.createElement(wW,hL(hL({},e),{},{ref:t,icon:gz}))};_W.displayName="LoadingOutlined";const CW=a.forwardRef(_W);const EW={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"};var xW=function(e,t){return a.createElement(wW,hL(hL({},e),{},{ref:t,icon:EW}))};xW.displayName="CloseCircleFilled";const SW=a.forwardRef(xW);const kW={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z"}}]},name:"close",theme:"outlined"};var OW=function(e,t){return a.createElement(wW,hL(hL({},e),{},{ref:t,icon:kW}))};OW.displayName="CloseOutlined";const IW=a.forwardRef(OW);var RW=function e(t){return wL(this,e),new Error("unreachable case: ".concat(JSON.stringify(t)))},TW=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};const AW=function(e){return a.createElement(pB,null,(function(t){var r,n=t.getPrefixCls,i=t.direction,o=e.prefixCls,s=e.size,l=e.className,c=TW(e,["prefixCls","size","className"]),u=n("btn-group",o),d="";switch(s){case"large":d="lg";break;case"small":d="sm";break;case"middle":case void 0:break;default:console.warn(new RW(s))}var f=GA(u,(sL(r={},"".concat(u,"-").concat(d),d),sL(r,"".concat(u,"-rtl"),"rtl"===i),r),l);return a.createElement("div",iL({},c,{className:f}))}))};var NW=0,MW={};function PW(e){var t=NW++,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return MW[t]=ez((function n(){(r-=1)<=0?(e(),delete MW[t]):MW[t]=ez(n)})),t}PW.cancel=function(e){void 0!==e&&(ez.cancel(MW[e]),delete MW[e])},PW.ids=MW;var jW,DW=a.isValidElement;function FW(e,t){return function(e,t,r){return DW(e)?a.cloneElement(e,"function"==typeof r?r(e.props||{}):r):t}(e,e,t)}function VW(e){return"test"!==Ti.exports.env.NODE_ENV&&(!e||null===e.offsetParent||e.hidden)}var LW=function(e){SL(r,e);var t=OL(r);function r(){var e;return wL(this,r),(e=t.apply(this,arguments)).containerRef=a.createRef(),e.animationStart=!1,e.destroyed=!1,e.onClick=function(t,r){var n,i;if(!(!t||VW(t)||t.className.indexOf("-leave")>=0)){var o=e.props.insertExtraNode;e.extraNode=document.createElement("div");var a=EL(e).extraNode,s=e.context.getPrefixCls;a.className="".concat(s(""),"-click-animating-node");var l=e.getAttributeName();if(t.setAttribute(l,"true"),r&&"#ffffff"!==r&&"rgb(255, 255, 255)"!==r&&function(e){var t=(e||"").match(/rgba?\((\d*), (\d*), (\d*)(, [\d.]*)?\)/);return!(t&&t[1]&&t[2]&&t[3]&&t[1]===t[2]&&t[2]===t[3])}(r)&&!/rgba\((?:\d*, ){3}0\)/.test(r)&&"transparent"!==r){a.style.borderColor=r;var c=(null===(n=t.getRootNode)||void 0===n?void 0:n.call(t))||t.ownerDocument,u=c instanceof Document?c.body:null!==(i=c.firstChild)&&void 0!==i?i:c;jW=oU("\n      [".concat(s(""),"-click-animating-without-extra-node='true']::after, .").concat(s(""),"-click-animating-node {\n        --antd-wave-shadow-color: ").concat(r,";\n      }"),"antd-wave",{csp:e.csp,attachTo:u})}o&&t.appendChild(a),["transition","animation"].forEach((function(r){t.addEventListener("".concat(r,"start"),e.onTransitionStart),t.addEventListener("".concat(r,"end"),e.onTransitionEnd)}))}},e.onTransitionStart=function(t){if(!e.destroyed){var r=e.containerRef.current;!t||t.target!==r||e.animationStart||e.resetEffect(r)}},e.onTransitionEnd=function(t){!t||"fadeEffect"!==t.animationName||e.resetEffect(t.target)},e.bindAnimationEvent=function(t){if(t&&t.getAttribute&&!t.getAttribute("disabled")&&!(t.className.indexOf("disabled")>=0)){var r=function(r){if("INPUT"!==r.target.tagName&&!VW(r.target)){e.resetEffect(t);var n=getComputedStyle(t).getPropertyValue("border-top-color")||getComputedStyle(t).getPropertyValue("border-color")||getComputedStyle(t).getPropertyValue("background-color");e.clickWaveTimeoutId=window.setTimeout((function(){return e.onClick(t,n)}),0),PW.cancel(e.animationStartId),e.animationStart=!0,e.animationStartId=PW((function(){e.animationStart=!1}),10)}};return t.addEventListener("click",r,!0),{cancel:function(){t.removeEventListener("click",r,!0)}}}},e.renderWave=function(t){var r=t.csp,n=e.props.children;if(e.csp=r,!a.isValidElement(n))return n;var i=e.containerRef;return wB(n)&&(i=yB(n.ref,e.containerRef)),FW(n,{ref:i})},e}return CL(r,[{key:"componentDidMount",value:function(){var e=this.containerRef.current;!e||1!==e.nodeType||(this.instance=this.bindAnimationEvent(e))}},{key:"componentWillUnmount",value:function(){this.instance&&this.instance.cancel(),this.clickWaveTimeoutId&&clearTimeout(this.clickWaveTimeoutId),this.destroyed=!0}},{key:"getAttributeName",value:function(){var e=this.context.getPrefixCls,t=this.props.insertExtraNode;return"".concat(e(""),t?"-click-animating":"-click-animating-without-extra-node")}},{key:"resetEffect",value:function(e){var t=this;if(e&&e!==this.extraNode&&e instanceof Element){var r=this.props.insertExtraNode,n=this.getAttributeName();e.setAttribute(n,"false"),jW&&(jW.innerHTML=""),r&&this.extraNode&&e.contains(this.extraNode)&&e.removeChild(this.extraNode),["transition","animation"].forEach((function(r){e.removeEventListener("".concat(r,"start"),t.onTransitionStart),e.removeEventListener("".concat(r,"end"),t.onTransitionEnd)}))}}},{key:"render",value:function(){return a.createElement(pB,null,this.renderWave)}}]),r}(a.Component);LW.contextType=fB;var $W=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t},BW=function(){return{width:0,opacity:0,transform:"scale(0)"}},zW=function(e){return{width:e.scrollWidth,opacity:1,transform:"scale(1)"}};const UW=function(e){var t=e.prefixCls,r=!!e.loading;return e.existIcon?s.a.createElement("span",{className:"".concat(t,"-loading-icon")},s.a.createElement(CW,null)):s.a.createElement(sz,{visible:r,motionName:"".concat(t,"-loading-icon-motion"),removeOnLeave:!0,onAppearStart:BW,onAppearActive:zW,onEnterStart:BW,onEnterActive:zW,onLeaveStart:zW,onLeaveActive:BW},(function(e,r){var n=e.className,i=e.style;return s.a.createElement("span",{className:"".concat(t,"-loading-icon"),style:i,ref:r},s.a.createElement(CW,{className:n}))}))};var HW=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},WW=/^[\u4e00-\u9fa5]{2}$/,GW=WW.test.bind(WW);function KW(e){return"text"===e||"link"===e}function qW(e,t){var r=!1,n=[];return a.Children.forEach(e,(function(e){var t=oL(e),i="string"===t||"number"===t;if(r&&i){var o=n.length-1,a=n[o];n[o]="".concat(a).concat(e)}else n.push(e);r=i})),a.Children.map(n,(function(e){return function(e,t){if(null!=e){var r=t?" ":"";return"string"!=typeof e&&"number"!=typeof e&&function(e){return"string"==typeof e}(e.type)&&GW(e.props.children)?FW(e,{children:e.props.children.split("").join(r)}):"string"==typeof e?(GW(e)&&(e=e.split("").join(r)),a.createElement("span",null,e)):e}}(e,t)}))}$W("default","primary","ghost","dashed","link","text"),$W("circle","round"),$W("submit","button","reset");var YW=function(e,t){var r,n,i=e.loading,o=void 0!==i&&i,s=e.prefixCls,l=e.type,c=e.danger,u=e.shape,d=e.size,f=e.className,p=e.children,h=e.icon,m=e.ghost,v=void 0!==m&&m,g=e.block,y=void 0!==g&&g,b=e.htmlType,w=void 0===b?"button":b,_=HW(e,["loading","prefixCls","type","danger","shape","size","className","children","icon","ghost","block","htmlType"]),C=a.useContext(hB),E=fL(a.useState(!!o),2),x=E[0],S=E[1],k=fL(a.useState(!1),2),O=k[0],I=k[1],R=a.useContext(fB),T=R.getPrefixCls,A=R.autoInsertSpaceInButton,N=R.direction,M=t||a.createRef(),P=a.useRef(),j=function(){return 1===a.Children.count(p)&&!h&&!KW(l)};n="object"===oL(o)&&o.delay?o.delay||!0:!!o,a.useEffect((function(){clearTimeout(P.current),"number"==typeof n?P.current=window.setTimeout((function(){S(n)}),n):S(n)}),[n]),a.useEffect((function(){if(M&&M.current&&!1!==A){var e=M.current.textContent;j()&&GW(e)?O||I(!0):O&&I(!1)}}),[M]);var D=function(t){var r,n=e.onClick,i=e.disabled;x||i?t.preventDefault():null===(r=n)||void 0===r||r(t)};Z$(!("string"==typeof h&&h.length>2),"Button","`icon` is using ReactNode instead of string naming in v4. Please check `".concat(h,"` at https://ant.design/components/icon")),Z$(!(v&&KW(l)),"Button","`link` or `text` button can't be a `ghost` button.");var F=T("btn",s),V=!1!==A,L="";switch(d||C){case"large":L="lg";break;case"small":L="sm"}var $=x?"loading":h,B=GA(F,(sL(r={},"".concat(F,"-").concat(l),l),sL(r,"".concat(F,"-").concat(u),u),sL(r,"".concat(F,"-").concat(L),L),sL(r,"".concat(F,"-icon-only"),!p&&0!==p&&!!$),sL(r,"".concat(F,"-background-ghost"),v&&!KW(l)),sL(r,"".concat(F,"-loading"),x),sL(r,"".concat(F,"-two-chinese-chars"),O&&V),sL(r,"".concat(F,"-block"),y),sL(r,"".concat(F,"-dangerous"),!!c),sL(r,"".concat(F,"-rtl"),"rtl"===N),r),f),z=h&&!x?h:a.createElement(UW,{existIcon:!!h,prefixCls:F,loading:!!x}),U=p||0===p?qW(p,j()&&V):null,H=mL(_,["navigate"]);if(void 0!==H.href)return a.createElement("a",iL({},H,{className:B,onClick:D,ref:M}),z,U);var W=a.createElement("button",iL({},_,{type:w,className:B,onClick:D,ref:M}),z,U);return KW(l)?W:a.createElement(LW,null,W)},XW=a.forwardRef(YW);XW.displayName="Button",XW.Group=AW,XW.__ANT_BUTTON=!0;const ZW=XW;var JW=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};const QW=function(e){var t,r=e.prefixCls,n=e.className,i=e.checked,o=e.onChange,s=e.onClick,l=JW(e,["prefixCls","className","checked","onChange","onClick"]),c=(0,a.useContext(fB).getPrefixCls)("tag",r),u=GA(c,(sL(t={},"".concat(c,"-checkable"),!0),sL(t,"".concat(c,"-checkable-checked"),i),t),n);return a.createElement("span",iL({},l,{className:u,onClick:function(e){null==o||o(!i),null==s||s(e)}}))};var eG=$W("success","processing","error","default","warning"),tG=$W("pink","red","yellow","orange","cyan","green","blue","purple","geekblue","magenta","volcano","gold","lime"),rG=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},nG=new RegExp("^(".concat(tG.join("|"),")(-inverse)?$")),iG=new RegExp("^(".concat(eG.join("|"),")$")),oG=function(e,t){var r,n=e.prefixCls,i=e.className,o=e.style,s=e.children,l=e.icon,c=e.color,u=e.onClose,d=e.closeIcon,f=e.closable,p=void 0!==f&&f,h=rG(e,["prefixCls","className","style","children","icon","color","onClose","closeIcon","closable"]),m=a.useContext(fB),v=m.getPrefixCls,g=m.direction,y=fL(a.useState(!0),2),b=y[0],w=y[1];a.useEffect((function(){"visible"in h&&w(h.visible)}),[h.visible]);var _=function(){return!!c&&(nG.test(c)||iG.test(c))},C=iL({backgroundColor:c&&!_()?c:void 0},o),E=_(),x=v("tag",n),S=GA(x,(sL(r={},"".concat(x,"-").concat(c),E),sL(r,"".concat(x,"-has-color"),c&&!E),sL(r,"".concat(x,"-hidden"),!b),sL(r,"".concat(x,"-rtl"),"rtl"===g),r),i),k=function(e){e.stopPropagation(),null==u||u(e),!e.defaultPrevented&&("visible"in h||w(!1))},O="onClick"in h||s&&"a"===s.type,I=mL(h,["visible"]),R=l||null,T=R?a.createElement(a.Fragment,null,R,a.createElement("span",null,s)):s,A=a.createElement("span",iL({},I,{ref:t,className:S,style:C}),T,p?d?a.createElement("span",{className:"".concat(x,"-close-icon"),onClick:k},d):a.createElement(IW,{className:"".concat(x,"-close-icon"),onClick:k}):null);return O?a.createElement(LW,null,A):A},aG=a.forwardRef(oG);aG.displayName="Tag",aG.CheckableTag=QW;const sG=aG;const lG={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 184H712v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H384v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H144c-17.7 0-32 14.3-32 32v664c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V216c0-17.7-14.3-32-32-32zm-40 656H184V460h656v380zM184 392V256h128v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h256v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h128v136H184z"}}]},name:"calendar",theme:"outlined"};var cG=function(e,t){return a.createElement(wW,hL(hL({},e),{},{ref:t,icon:lG}))};cG.displayName="CalendarOutlined";const uG=a.forwardRef(cG);const dG={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]},name:"clock-circle",theme:"outlined"};var fG=function(e,t){return a.createElement(wW,hL(hL({},e),{},{ref:t,icon:dG}))};fG.displayName="ClockCircleOutlined";const pG=a.forwardRef(fG);function hG(e){var t=a.useRef();t.current=e;var r=a.useCallback((function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return null===(e=t.current)||void 0===e?void 0:e.call.apply(e,[t].concat(n))}),[]);return r}var mG="test"!==Ti.exports.env.NODE_ENV&&PB()?a.useLayoutEffect:a.useEffect,vG=function(e,t){var r=a.useRef(!0);mG((function(){return e(r.current)}),t),mG((function(){return r.current=!1,function(){r.current=!0}}),[])},gG=function(e,t){vG((function(t){if(!t)return e()}),t)};function yG(e){return void 0!==e}function bG(e,t){var r=t||{},n=r.defaultValue,i=r.value,o=r.onChange,a=r.postState,s=fL(EB((function(){return yG(i)?i:yG(n)?"function"==typeof n?n():n:"function"==typeof e?e():e})),2),l=s[0],c=s[1],u=void 0!==i?i:l,d=a?a(u):u,f=hG(o),p=fL(EB([u]),2),h=p[0],m=p[1];return gG((function(){var e=h[0];l!==e&&f(l,e)}),[h]),gG((function(){yG(i)||c(i)}),[i]),[d,hG((function(e,t){c(e,t),m([u],t)}))]}var wG={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var t=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||t>=wG.F1&&t<=wG.F12)return!1;switch(t){case wG.ALT:case wG.CAPS_LOCK:case wG.CONTEXT_MENU:case wG.CTRL:case wG.DOWN:case wG.END:case wG.ESC:case wG.HOME:case wG.INSERT:case wG.LEFT:case wG.MAC_FF_META:case wG.META:case wG.NUMLOCK:case wG.NUM_CENTER:case wG.PAGE_DOWN:case wG.PAGE_UP:case wG.PAUSE:case wG.PRINT_SCREEN:case wG.RIGHT:case wG.SHIFT:case wG.UP:case wG.WIN_KEY:case wG.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=wG.ZERO&&e<=wG.NINE||e>=wG.NUM_ZERO&&e<=wG.NUM_MULTIPLY||e>=wG.A&&e<=wG.Z||-1!==window.navigator.userAgent.indexOf("WebKit")&&0===e)return!0;switch(e){case wG.SPACE:case wG.QUESTION_MARK:case wG.NUM_PLUS:case wG.NUM_MINUS:case wG.NUM_PERIOD:case wG.NUM_DIVISION:case wG.SEMICOLON:case wG.DASH:case wG.EQUALS:case wG.COMMA:case wG.PERIOD:case wG.SLASH:case wG.APOSTROPHE:case wG.SINGLE_QUOTE:case wG.OPEN_SQUARE_BRACKET:case wG.BACKSLASH:case wG.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},_G=a.createContext({}),CG={visibility:"hidden"};function EG(e){var t=e.prefixCls,r=e.prevIcon,n=void 0===r?"‹":r,i=e.nextIcon,o=void 0===i?"›":i,s=e.superPrevIcon,l=void 0===s?"«":s,c=e.superNextIcon,u=void 0===c?"»":c,d=e.onSuperPrev,f=e.onSuperNext,p=e.onPrev,h=e.onNext,m=e.children,v=a.useContext(_G),g=v.hideNextBtn,y=v.hidePrevBtn;return a.createElement("div",{className:t},d&&a.createElement("button",{type:"button",onClick:d,tabIndex:-1,className:"".concat(t,"-super-prev-btn"),style:y?CG:{}},l),p&&a.createElement("button",{type:"button",onClick:p,tabIndex:-1,className:"".concat(t,"-prev-btn"),style:y?CG:{}},n),a.createElement("div",{className:"".concat(t,"-view")},m),h&&a.createElement("button",{type:"button",onClick:h,tabIndex:-1,className:"".concat(t,"-next-btn"),style:g?CG:{}},o),f&&a.createElement("button",{type:"button",onClick:f,tabIndex:-1,className:"".concat(t,"-super-next-btn"),style:g?CG:{}},u))}function xG(e){var t=e.prefixCls,r=e.generateConfig,n=e.viewDate,i=e.onPrevDecades,o=e.onNextDecades;if(a.useContext(_G).hideHeader)return null;var s="".concat(t,"-header"),l=r.getYear(n),c=Math.floor(l/UG)*UG,u=c+UG-1;return a.createElement(EG,iL({},e,{prefixCls:s,onSuperPrev:i,onSuperNext:o}),c,"-",u)}function SG(e,t,r,n,i){var o=e.setHour(t,r);return o=e.setMinute(o,n),o=e.setSecond(o,i)}function kG(e,t,r){if(!r)return t;var n=t;return n=e.setHour(n,e.getHour(r)),n=e.setMinute(n,e.getMinute(r)),n=e.setSecond(n,e.getSecond(r))}function OG(e,t){var r=e.getYear(t),n=e.getMonth(t)+1,i=e.getEndDate(e.getFixedDate("".concat(r,"-").concat(n,"-01"))),o=e.getDate(i),a=n<10?"0".concat(n):"".concat(n);return"".concat(r,"-").concat(a,"-").concat(o)}function IG(e){for(var t=e.prefixCls,r=e.disabledDate,n=e.onSelect,i=e.picker,o=e.rowNum,s=e.colNum,l=e.prefixColumn,c=e.rowClassName,u=e.baseDate,d=e.getCellClassName,f=e.getCellText,p=e.getCellNode,h=e.getCellDate,m=e.generateConfig,v=e.titleCell,g=e.headerCells,y=a.useContext(_G),b=y.onDateMouseEnter,w=y.onDateMouseLeave,_=y.mode,C="".concat(t,"-cell"),E=[],x=0;x<o;x+=1){for(var S=[],k=void 0,O=function(e){var t,o=h(u,x*s+e),c=iK({cellDate:o,mode:_,disabledDate:r,generateConfig:m});0===e&&(k=o,l&&S.push(l(k)));var g=v&&v(o);S.push(a.createElement("td",{key:e,title:g,className:GA(C,hL((t={},sL(t,"".concat(C,"-disabled"),c),sL(t,"".concat(C,"-start"),1===f(o)||"year"===i&&Number(g)%10==0),sL(t,"".concat(C,"-end"),g===OG(m,o)||"year"===i&&Number(g)%10==9),t),d(o))),onClick:function(){c||n(o)},onMouseEnter:function(){!c&&b&&b(o)},onMouseLeave:function(){!c&&w&&w(o)}},p?p(o):a.createElement("div",{className:"".concat(C,"-inner")},f(o))))},I=0;I<s;I+=1)O(I);E.push(a.createElement("tr",{key:x,className:c&&c(k)},S))}return a.createElement("div",{className:"".concat(t,"-body")},a.createElement("table",{className:"".concat(t,"-content")},g&&a.createElement("thead",null,a.createElement("tr",null,g)),a.createElement("tbody",null,E)))}var RG=3,TG=4;function AG(e){var t=zG-1,r=e.prefixCls,n=e.viewDate,i=e.generateConfig,o="".concat(r,"-cell"),s=i.getYear(n),l=Math.floor(s/zG)*zG,c=Math.floor(s/UG)*UG,u=c+UG-1,d=i.setYear(n,c-Math.ceil((RG*TG*zG-UG)/2));return a.createElement(IG,iL({},e,{rowNum:TG,colNum:RG,baseDate:d,getCellText:function(e){var r=i.getYear(e);return"".concat(r,"-").concat(r+t)},getCellClassName:function(e){var r,n=i.getYear(e),a=n+t;return sL(r={},"".concat(o,"-in-view"),c<=n&&a<=u),sL(r,"".concat(o,"-selected"),n===l),r},getCellDate:function(e,t){return i.addYear(e,t*zG)}}))}const NG=function(e){if(!e)return!1;if(e instanceof Element){if(e.offsetParent)return!0;if(e.getBBox){var t=e.getBBox(),r=t.width,n=t.height;if(r||n)return!0}if(e.getBoundingClientRect){var i=e.getBoundingClientRect(),o=i.width,a=i.height;if(o||a)return!0}}return!1};var MG=new Map;function PG(e,t,r){if(MG.get(e)&&cancelAnimationFrame(MG.get(e)),r<=0)MG.set(e,requestAnimationFrame((function(){e.scrollTop=t})));else{var n=(t-e.scrollTop)/r*10;MG.set(e,requestAnimationFrame((function(){e.scrollTop+=n,e.scrollTop!==t&&PG(e,t,r-10)})))}}function jG(e,t){var r=t.onLeftRight,n=t.onCtrlLeftRight,i=t.onUpDown,o=t.onPageUpDown,a=t.onEnter,s=e.which,l=e.ctrlKey,c=e.metaKey;switch(s){case wG.LEFT:if(l||c){if(n)return n(-1),!0}else if(r)return r(-1),!0;break;case wG.RIGHT:if(l||c){if(n)return n(1),!0}else if(r)return r(1),!0;break;case wG.UP:if(i)return i(-1),!0;break;case wG.DOWN:if(i)return i(1),!0;break;case wG.PAGE_UP:if(o)return o(-1),!0;break;case wG.PAGE_DOWN:if(o)return o(1),!0;break;case wG.ENTER:if(a)return a(),!0}return!1}function DG(e,t,r,n){var i=e;if(!i)switch(t){case"time":i=n?"hh:mm:ss a":"HH:mm:ss";break;case"week":i="gggg-wo";break;case"month":i="YYYY-MM";break;case"quarter":i="YYYY-[Q]Q";break;case"year":i="YYYY";break;default:i=r?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD"}return i}function FG(e,t,r){var n="time"===e?8:10,i="function"==typeof t?t(r.getNow()).length:t.length;return Math.max(n,i)+2}var VG=null,LG=new Set;var $G={year:function(e){return"month"===e||"date"===e?"year":e},month:function(e){return"date"===e?"month":e},quarter:function(e){return"month"===e||"date"===e?"quarter":e},week:function(e){return"date"===e?"week":e},time:null,date:null};function BG(e,t){return e.some((function(e){return e&&e.contains(t)}))}var zG=10,UG=10*zG;function HG(e){var t=e.prefixCls,r=e.onViewDateChange,n=e.generateConfig,i=e.viewDate,o=e.operationRef,s=e.onSelect,l=e.onPanelChange,c="".concat(t,"-decade-panel");o.current={onKeyDown:function(e){return jG(e,{onLeftRight:function(e){s(n.addYear(i,e*zG),"key")},onCtrlLeftRight:function(e){s(n.addYear(i,e*UG),"key")},onUpDown:function(e){s(n.addYear(i,e*zG*RG),"key")},onEnter:function(){l("year",i)}})}};var u=function(e){var t=n.addYear(i,e*UG);r(t),l(null,t)};return a.createElement("div",{className:c},a.createElement(xG,iL({},e,{prefixCls:t,onPrevDecades:function(){u(-1)},onNextDecades:function(){u(1)}})),a.createElement(AG,iL({},e,{prefixCls:t,onSelect:function(e){s(e,"mouse"),l("year",e)}})))}var WG=7;function GG(e,t){return!e&&!t||!(!e||!t)&&void 0}function KG(e,t,r){var n=GG(t,r);return"boolean"==typeof n?n:e.getYear(t)===e.getYear(r)}function qG(e,t){return Math.floor(e.getMonth(t)/3)+1}function YG(e,t,r){var n=GG(t,r);return"boolean"==typeof n?n:KG(e,t,r)&&qG(e,t)===qG(e,r)}function XG(e,t,r){var n=GG(t,r);return"boolean"==typeof n?n:KG(e,t,r)&&e.getMonth(t)===e.getMonth(r)}function ZG(e,t,r){var n=GG(t,r);return"boolean"==typeof n?n:e.getYear(t)===e.getYear(r)&&e.getMonth(t)===e.getMonth(r)&&e.getDate(t)===e.getDate(r)}function JG(e,t,r,n){var i=GG(r,n);return"boolean"==typeof i?i:e.locale.getWeek(t,r)===e.locale.getWeek(t,n)}function QG(e,t,r){return ZG(e,t,r)&&function(e,t,r){var n=GG(t,r);return"boolean"==typeof n?n:e.getHour(t)===e.getHour(r)&&e.getMinute(t)===e.getMinute(r)&&e.getSecond(t)===e.getSecond(r)}(e,t,r)}function eK(e,t,r,n){return!!(t&&r&&n)&&(!ZG(e,t,n)&&!ZG(e,r,n)&&e.isAfter(n,t)&&e.isAfter(r,n))}function tK(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;switch(t){case"year":return r.addYear(e,10*n);case"quarter":case"month":return r.addYear(e,n);default:return r.addMonth(e,n)}}function rK(e,t){var r=t.generateConfig,n=t.locale,i=t.format;return"function"==typeof i?i(e):r.locale.format(n.locale,e,i)}function nK(e,t){var r=t.generateConfig,n=t.locale,i=t.formatList;return e&&"function"!=typeof i[0]?r.locale.parse(n.locale,e,i):null}function iK(e){var t=e.cellDate,r=e.mode,n=e.disabledDate,i=e.generateConfig;if(!n)return!1;var o=function(e,r,o){for(var a=r;a<=o;){var s=void 0;switch(e){case"date":if(s=i.setDate(t,a),!n(s))return!1;break;case"month":if(!iK({cellDate:s=i.setMonth(t,a),mode:"month",generateConfig:i,disabledDate:n}))return!1;break;case"year":if(!iK({cellDate:s=i.setYear(t,a),mode:"year",generateConfig:i,disabledDate:n}))return!1}a+=1}return!0};switch(r){case"date":case"week":return n(t);case"month":return o("date",1,i.getDate(i.getEndDate(t)));case"quarter":var a=3*Math.floor(i.getMonth(t)/3);return o("month",a,a+2);case"year":return o("month",0,11);case"decade":var s=i.getYear(t),l=Math.floor(s/zG)*zG;return o("year",l,l+zG-1)}}function oK(e){if(a.useContext(_G).hideHeader)return null;var t=e.prefixCls,r=e.generateConfig,n=e.locale,i=e.value,o=e.format,s="".concat(t,"-header");return a.createElement(EG,{prefixCls:s},i?rK(i,{locale:n,format:o,generateConfig:r}):" ")}function aK(e){var t=e.prefixCls,r=e.units,n=e.onSelect,i=e.value,o=e.active,s=e.hideDisabledOptions,l="".concat(t,"-cell"),c=a.useContext(_G).open,u=Object(a.useRef)(null),d=Object(a.useRef)(new Map),f=Object(a.useRef)();return Object(a.useLayoutEffect)((function(){var e=d.current.get(i);e&&!1!==c&&PG(u.current,e.offsetTop,120)}),[i]),Object(a.useLayoutEffect)((function(){if(c){var e=d.current.get(i);e&&(f.current=function(e,t){var r;return function n(){NG(e)?t():r=ez((function(){n()}))}(),function(){ez.cancel(r)}}(e,(function(){PG(u.current,e.offsetTop,0)})))}return function(){var e;null===(e=f.current)||void 0===e||e.call(f)}}),[c]),a.createElement("ul",{className:GA("".concat(t,"-column"),sL({},"".concat(t,"-column-active"),o)),ref:u,style:{position:"relative"}},r.map((function(e){var t;return s&&e.disabled?null:a.createElement("li",{key:e.value,ref:function(t){d.current.set(e.value,t)},className:GA(l,(t={},sL(t,"".concat(l,"-disabled"),e.disabled),sL(t,"".concat(l,"-selected"),i===e.value),t)),onClick:function(){e.disabled||n(e.value)}},a.createElement("div",{className:"".concat(l,"-inner")},e.label))})))}function sK(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0",n=String(e);n.length<t;)n="".concat(r).concat(e);return n}function lK(e){return null==e?[]:Array.isArray(e)?e:[e]}function cK(e){var t={};return Object.keys(e).forEach((function(r){("data-"===r.substr(0,5)||"aria-"===r.substr(0,5)||"role"===r||"name"===r)&&"data-__"!==r.substr(0,7)&&(t[r]=e[r])})),t}function uK(e,t){return e?e[t]:null}function dK(e,t,r){var n=[uK(e,0),uK(e,1)];return n[r]="function"==typeof t?t(n[r]):t,n[0]||n[1]?n:null}function fK(e,t){if(e.length!==t.length)return!0;for(var r=0;r<e.length;r+=1)if(e[r].disabled!==t[r].disabled)return!0;return!1}function pK(e,t,r,n){for(var i=[],o=e;o<=t;o+=r)i.push({label:sK(o,2),value:o,disabled:(n||[]).includes(o)});return i}function hK(e){var t,r=e.generateConfig,n=e.prefixCls,i=e.operationRef,o=e.activeColumnIndex,s=e.value,l=e.showHour,c=e.showMinute,u=e.showSecond,d=e.use12Hours,f=e.hourStep,p=void 0===f?1:f,h=e.minuteStep,m=void 0===h?1:h,v=e.secondStep,g=void 0===v?1:v,y=e.disabledHours,b=e.disabledMinutes,w=e.disabledSeconds,_=e.hideDisabledOptions,C=e.onSelect,E=[],x="".concat(n,"-content"),S="".concat(n,"-time-panel"),k=s?r.getHour(s):-1,O=k,I=s?r.getMinute(s):-1,R=s?r.getSecond(s):-1,T=function(e,t,n,i){var o=s||r.getNow(),a=Math.max(0,t),l=Math.max(0,n),c=Math.max(0,i);return o=SG(r,o,d&&e?a+12:a,l,c)},A=pK(0,23,p,y&&y()),N=X$((function(){return A}),A,fK);d&&(t=O>=12,O%=12);var M=fL(a.useMemo((function(){if(!d)return[!1,!1];var e=[!0,!0];return N.forEach((function(t){var r=t.disabled,n=t.value;r||(n>=12?e[1]=!1:e[0]=!1)})),e}),[d,N]),2),P=M[0],j=M[1],D=a.useMemo((function(){return d?N.filter(t?function(e){return e.value>=12}:function(e){return e.value<12}).map((function(e){var t=e.value%12,r=0===t?"12":sK(t,2);return hL(hL({},e),{},{label:r,value:t})})):N}),[d,t,N]),F=pK(0,59,m,b&&b(k)),V=pK(0,59,g,w&&w(k,I));function L(e,t,r,n,i){!1!==e&&E.push({node:a.cloneElement(t,{prefixCls:S,value:r,active:o===E.length,onSelect:i,units:n,hideDisabledOptions:_}),onSelect:i,value:r,units:n})}i.current={onUpDown:function(e){var t=E[o];if(t)for(var r=t.units.findIndex((function(e){return e.value===t.value})),n=t.units.length,i=1;i<n;i+=1){var a=t.units[(r+e*i+n)%n];if(!0!==a.disabled){t.onSelect(a.value);break}}}},L(l,a.createElement(aK,{key:"hour"}),O,D,(function(e){C(T(t,e,I,R),"mouse")})),L(c,a.createElement(aK,{key:"minute"}),I,F,(function(e){C(T(t,O,e,R),"mouse")})),L(u,a.createElement(aK,{key:"second"}),R,V,(function(e){C(T(t,O,I,e),"mouse")}));var $=-1;return"boolean"==typeof t&&($=t?1:0),L(!0===d,a.createElement(aK,{key:"12hours"}),$,[{label:"AM",value:0,disabled:P},{label:"PM",value:1,disabled:j}],(function(e){C(T(!!e,O,I,R),"mouse")})),a.createElement("div",{className:x},E.map((function(e){return e.node})))}var mK=function(e){return e.filter((function(e){return!1!==e})).length};function vK(e){var t=e.generateConfig,r=e.format,n=void 0===r?"HH:mm:ss":r,i=e.prefixCls,o=e.active,s=e.operationRef,l=e.showHour,c=e.showMinute,u=e.showSecond,d=e.use12Hours,f=void 0!==d&&d,p=e.onSelect,h=e.value,m="".concat(i,"-time-panel"),v=a.useRef(),g=fL(a.useState(-1),2),y=g[0],b=g[1],w=mK([l,c,u,f]);return s.current={onKeyDown:function(e){return jG(e,{onLeftRight:function(e){b((y+e+w)%w)},onUpDown:function(e){-1===y?b(0):v.current&&v.current.onUpDown(e)},onEnter:function(){p(h||t.getNow(),"key"),b(-1)}})},onBlur:function(){b(-1)}},a.createElement("div",{className:GA(m,sL({},"".concat(m,"-active"),o))},a.createElement(oK,iL({},e,{format:n,prefixCls:i})),a.createElement(hK,iL({},e,{prefixCls:i,activeColumnIndex:y,operationRef:v})))}var gK=a.createContext({});function yK(e){var t=e.cellPrefixCls,r=e.generateConfig,n=e.rangedValue,i=e.hoverRangedValue,o=e.isInView,a=e.isSameCell,s=e.offsetCell,l=e.today,c=e.value;return function(e){var u,d=s(e,-1),f=s(e,1),p=uK(n,0),h=uK(n,1),m=uK(i,0),v=uK(i,1),g=eK(r,m,v,e);function y(e){return a(p,e)}function b(e){return a(h,e)}var w=a(m,e),_=a(v,e),C=(g||_)&&(!o(d)||b(d)),E=(g||w)&&(!o(f)||y(f));return sL(u={},"".concat(t,"-in-view"),o(e)),sL(u,"".concat(t,"-in-range"),eK(r,p,h,e)),sL(u,"".concat(t,"-range-start"),y(e)),sL(u,"".concat(t,"-range-end"),b(e)),sL(u,"".concat(t,"-range-start-single"),y(e)&&!h),sL(u,"".concat(t,"-range-end-single"),b(e)&&!p),sL(u,"".concat(t,"-range-start-near-hover"),y(e)&&(a(d,m)||eK(r,m,v,d))),sL(u,"".concat(t,"-range-end-near-hover"),b(e)&&(a(f,v)||eK(r,m,v,f))),sL(u,"".concat(t,"-range-hover"),g),sL(u,"".concat(t,"-range-hover-start"),w),sL(u,"".concat(t,"-range-hover-end"),_),sL(u,"".concat(t,"-range-hover-edge-start"),C),sL(u,"".concat(t,"-range-hover-edge-end"),E),sL(u,"".concat(t,"-range-hover-edge-start-near-range"),C&&a(d,h)),sL(u,"".concat(t,"-range-hover-edge-end-near-range"),E&&a(f,p)),sL(u,"".concat(t,"-today"),a(l,e)),sL(u,"".concat(t,"-selected"),a(c,e)),u}}function bK(e){var t=e.prefixCls,r=e.generateConfig,n=e.prefixColumn,i=e.locale,o=e.rowCount,s=e.viewDate,l=e.value,c=e.dateRender,u=a.useContext(gK),d=u.rangedValue,f=u.hoverRangedValue,p=function(e,t,r){var n=t.locale.getWeekFirstDay(e),i=t.setDate(r,1),o=t.getWeekDay(i),a=t.addDate(i,n-o);return t.getMonth(a)===t.getMonth(r)&&t.getDate(a)>1&&(a=t.addDate(a,-7)),a}(i.locale,r,s),h="".concat(t,"-cell"),m=r.locale.getWeekFirstDay(i.locale),v=r.getNow(),g=[],y=i.shortWeekDays||(r.locale.getShortWeekDays?r.locale.getShortWeekDays(i.locale):[]);n&&g.push(a.createElement("th",{key:"empty","aria-label":"empty cell"}));for(var b=0;b<WG;b+=1)g.push(a.createElement("th",{key:b},y[(b+m)%WG]));var w=yK({cellPrefixCls:h,today:v,value:l,generateConfig:r,rangedValue:n?null:d,hoverRangedValue:n?null:f,isSameCell:function(e,t){return ZG(r,e,t)},isInView:function(e){return XG(r,e,s)},offsetCell:function(e,t){return r.addDate(e,t)}}),_=c?function(e){return c(e,v)}:void 0;return a.createElement(IG,iL({},e,{rowNum:o,colNum:WG,baseDate:p,getCellNode:_,getCellText:r.getDate,getCellClassName:w,getCellDate:r.addDate,titleCell:function(e){return rK(e,{locale:i,format:"YYYY-MM-DD",generateConfig:r})},headerCells:g}))}function wK(e){var t=e.prefixCls,r=e.generateConfig,n=e.locale,i=e.viewDate,o=e.onNextMonth,s=e.onPrevMonth,l=e.onNextYear,c=e.onPrevYear,u=e.onYearClick,d=e.onMonthClick;if(a.useContext(_G).hideHeader)return null;var f="".concat(t,"-header"),p=n.shortMonths||(r.locale.getShortMonths?r.locale.getShortMonths(n.locale):[]),h=r.getMonth(i),m=a.createElement("button",{type:"button",key:"year",onClick:u,tabIndex:-1,className:"".concat(t,"-year-btn")},rK(i,{locale:n,format:n.yearFormat,generateConfig:r})),v=a.createElement("button",{type:"button",key:"month",onClick:d,tabIndex:-1,className:"".concat(t,"-month-btn")},n.monthFormat?rK(i,{locale:n,format:n.monthFormat,generateConfig:r}):p[h]),g=n.monthBeforeYear?[v,m]:[m,v];return a.createElement(EG,iL({},e,{prefixCls:f,onSuperPrev:c,onPrev:s,onNext:o,onSuperNext:l}),g)}var _K=6;function CK(e){var t=e.prefixCls,r=e.panelName,n=void 0===r?"date":r,i=e.keyboardConfig,o=e.active,s=e.operationRef,l=e.generateConfig,c=e.value,u=e.viewDate,d=e.onViewDateChange,f=e.onPanelChange,p=e.onSelect,h="".concat(t,"-").concat(n,"-panel");s.current={onKeyDown:function(e){return jG(e,hL({onLeftRight:function(e){p(l.addDate(c||u,e),"key")},onCtrlLeftRight:function(e){p(l.addYear(c||u,e),"key")},onUpDown:function(e){p(l.addDate(c||u,e*WG),"key")},onPageUpDown:function(e){p(l.addMonth(c||u,e),"key")}},i))}};var m=function(e){var t=l.addYear(u,e);d(t),f(null,t)},v=function(e){var t=l.addMonth(u,e);d(t),f(null,t)};return a.createElement("div",{className:GA(h,sL({},"".concat(h,"-active"),o))},a.createElement(wK,iL({},e,{prefixCls:t,value:c,viewDate:u,onPrevYear:function(){m(-1)},onNextYear:function(){m(1)},onPrevMonth:function(){v(-1)},onNextMonth:function(){v(1)},onMonthClick:function(){f("month",u)},onYearClick:function(){f("year",u)}})),a.createElement(bK,iL({},e,{onSelect:function(e){return p(e,"mouse")},prefixCls:t,value:c,viewDate:u,rowCount:_K})))}var EK=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t}("date","time");function xK(e){var t=e.prefixCls,r=e.operationRef,n=e.generateConfig,i=e.value,o=e.defaultValue,s=e.disabledTime,l=e.showTime,c=e.onSelect,u="".concat(t,"-datetime-panel"),d=fL(a.useState(null),2),f=d[0],p=d[1],h=a.useRef({}),m=a.useRef({}),v="object"===oL(l)?hL({},l):{};var g=function(e){m.current.onBlur&&m.current.onBlur(e),p(null)};r.current={onKeyDown:function(e){if(e.which===wG.TAB){var t=function(e){var t=EK.indexOf(f)+e;return EK[t]||null}(e.shiftKey?-1:1);return p(t),t&&e.preventDefault(),!0}if(f){var r="date"===f?h:m;return r.current&&r.current.onKeyDown&&r.current.onKeyDown(e),!0}return!![wG.LEFT,wG.RIGHT,wG.UP,wG.DOWN].includes(e.which)&&(p("date"),!0)},onBlur:g,onClose:g};var y=function(e,t){var r=e;"date"===t&&!i&&v.defaultValue?(r=n.setHour(r,n.getHour(v.defaultValue)),r=n.setMinute(r,n.getMinute(v.defaultValue)),r=n.setSecond(r,n.getSecond(v.defaultValue))):"time"===t&&!i&&o&&(r=n.setYear(r,n.getYear(o)),r=n.setMonth(r,n.getMonth(o)),r=n.setDate(r,n.getDate(o))),c&&c(r,"mouse")},b=s?s(i||null):{};return a.createElement("div",{className:GA(u,sL({},"".concat(u,"-active"),f))},a.createElement(CK,iL({},e,{operationRef:h,active:"date"===f,onSelect:function(e){y(kG(n,e,l&&"object"===oL(l)?l.defaultValue:null),"date")}})),a.createElement(vK,iL({},e,{format:void 0},v,b,{defaultValue:void 0,operationRef:m,active:"time"===f,onSelect:function(e){y(e,"time")}})))}function SK(e){var t=e.prefixCls,r=e.generateConfig,n=e.locale,i=e.value,o="".concat(t,"-cell"),s="".concat(t,"-week-panel-row");return a.createElement(CK,iL({},e,{panelName:"week",prefixColumn:function(e){return a.createElement("td",{key:"week",className:GA(o,"".concat(o,"-week"))},r.locale.getWeek(n.locale,e))},rowClassName:function(e){return GA(s,sL({},"".concat(s,"-selected"),JG(r,n.locale,i,e)))},keyboardConfig:{onLeftRight:null}}))}function kK(e){var t=e.prefixCls,r=e.generateConfig,n=e.locale,i=e.viewDate,o=e.onNextYear,s=e.onPrevYear,l=e.onYearClick;if(a.useContext(_G).hideHeader)return null;var c="".concat(t,"-header");return a.createElement(EG,iL({},e,{prefixCls:c,onSuperPrev:s,onSuperNext:o}),a.createElement("button",{type:"button",onClick:l,className:"".concat(t,"-year-btn")},rK(i,{locale:n,format:n.yearFormat,generateConfig:r})))}var OK=3,IK=4;function RK(e){var t=e.prefixCls,r=e.locale,n=e.value,i=e.viewDate,o=e.generateConfig,s=e.monthCellRender,l=a.useContext(gK),c=l.rangedValue,u=l.hoverRangedValue,d=yK({cellPrefixCls:"".concat(t,"-cell"),value:n,generateConfig:o,rangedValue:c,hoverRangedValue:u,isSameCell:function(e,t){return XG(o,e,t)},isInView:function(){return!0},offsetCell:function(e,t){return o.addMonth(e,t)}}),f=r.shortMonths||(o.locale.getShortMonths?o.locale.getShortMonths(r.locale):[]),p=o.setMonth(i,0),h=s?function(e){return s(e,r)}:void 0;return a.createElement(IG,iL({},e,{rowNum:IK,colNum:OK,baseDate:p,getCellNode:h,getCellText:function(e){return r.monthFormat?rK(e,{locale:r,format:r.monthFormat,generateConfig:o}):f[o.getMonth(e)]},getCellClassName:d,getCellDate:o.addMonth,titleCell:function(e){return rK(e,{locale:r,format:"YYYY-MM",generateConfig:o})}}))}function TK(e){var t=e.prefixCls,r=e.operationRef,n=e.onViewDateChange,i=e.generateConfig,o=e.value,s=e.viewDate,l=e.onPanelChange,c=e.onSelect,u="".concat(t,"-month-panel");r.current={onKeyDown:function(e){return jG(e,{onLeftRight:function(e){c(i.addMonth(o||s,e),"key")},onCtrlLeftRight:function(e){c(i.addYear(o||s,e),"key")},onUpDown:function(e){c(i.addMonth(o||s,e*OK),"key")},onEnter:function(){l("date",o||s)}})}};var d=function(e){var t=i.addYear(s,e);n(t),l(null,t)};return a.createElement("div",{className:u},a.createElement(kK,iL({},e,{prefixCls:t,onPrevYear:function(){d(-1)},onNextYear:function(){d(1)},onYearClick:function(){l("year",s)}})),a.createElement(RK,iL({},e,{prefixCls:t,onSelect:function(e){c(e,"mouse"),l("date",e)}})))}function AK(e){var t=e.prefixCls,r=e.generateConfig,n=e.locale,i=e.viewDate,o=e.onNextYear,s=e.onPrevYear,l=e.onYearClick;if(a.useContext(_G).hideHeader)return null;var c="".concat(t,"-header");return a.createElement(EG,iL({},e,{prefixCls:c,onSuperPrev:s,onSuperNext:o}),a.createElement("button",{type:"button",onClick:l,className:"".concat(t,"-year-btn")},rK(i,{locale:n,format:n.yearFormat,generateConfig:r})))}var NK=4,MK=1;function PK(e){var t=e.prefixCls,r=e.locale,n=e.value,i=e.viewDate,o=e.generateConfig,s=a.useContext(gK),l=s.rangedValue,c=s.hoverRangedValue,u=yK({cellPrefixCls:"".concat(t,"-cell"),value:n,generateConfig:o,rangedValue:l,hoverRangedValue:c,isSameCell:function(e,t){return YG(o,e,t)},isInView:function(){return!0},offsetCell:function(e,t){return o.addMonth(e,3*t)}}),d=o.setDate(o.setMonth(i,0),1);return a.createElement(IG,iL({},e,{rowNum:MK,colNum:NK,baseDate:d,getCellText:function(e){return rK(e,{locale:r,format:r.quarterFormat||"[Q]Q",generateConfig:o})},getCellClassName:u,getCellDate:function(e,t){return o.addMonth(e,3*t)},titleCell:function(e){return rK(e,{locale:r,format:"YYYY-[Q]Q",generateConfig:o})}}))}function jK(e){var t=e.prefixCls,r=e.operationRef,n=e.onViewDateChange,i=e.generateConfig,o=e.value,s=e.viewDate,l=e.onPanelChange,c=e.onSelect,u="".concat(t,"-quarter-panel");r.current={onKeyDown:function(e){return jG(e,{onLeftRight:function(e){c(i.addMonth(o||s,3*e),"key")},onCtrlLeftRight:function(e){c(i.addYear(o||s,e),"key")},onUpDown:function(e){c(i.addYear(o||s,e),"key")}})}};var d=function(e){var t=i.addYear(s,e);n(t),l(null,t)};return a.createElement("div",{className:u},a.createElement(AK,iL({},e,{prefixCls:t,onPrevYear:function(){d(-1)},onNextYear:function(){d(1)},onYearClick:function(){l("year",s)}})),a.createElement(PK,iL({},e,{prefixCls:t,onSelect:function(e){c(e,"mouse")}})))}function DK(e){var t=e.prefixCls,r=e.generateConfig,n=e.viewDate,i=e.onPrevDecade,o=e.onNextDecade,s=e.onDecadeClick;if(a.useContext(_G).hideHeader)return null;var l="".concat(t,"-header"),c=r.getYear(n),u=Math.floor(c/$K)*$K,d=u+$K-1;return a.createElement(EG,iL({},e,{prefixCls:l,onSuperPrev:i,onSuperNext:o}),a.createElement("button",{type:"button",onClick:s,className:"".concat(t,"-decade-btn")},u,"-",d))}var FK=3,VK=4;function LK(e){var t=e.prefixCls,r=e.value,n=e.viewDate,i=e.locale,o=e.generateConfig,s=a.useContext(gK),l=s.rangedValue,c=s.hoverRangedValue,u="".concat(t,"-cell"),d=o.getYear(n),f=Math.floor(d/$K)*$K,p=f+$K-1,h=o.setYear(n,f-Math.ceil((FK*VK-$K)/2)),m=yK({cellPrefixCls:u,value:r,generateConfig:o,rangedValue:l,hoverRangedValue:c,isSameCell:function(e,t){return KG(o,e,t)},isInView:function(e){var t=o.getYear(e);return f<=t&&t<=p},offsetCell:function(e,t){return o.addYear(e,t)}});return a.createElement(IG,iL({},e,{rowNum:VK,colNum:FK,baseDate:h,getCellText:o.getYear,getCellClassName:m,getCellDate:o.addYear,titleCell:function(e){return rK(e,{locale:i,format:"YYYY",generateConfig:o})}}))}var $K=10;function BK(e){var t=e.prefixCls,r=e.operationRef,n=e.onViewDateChange,i=e.generateConfig,o=e.value,s=e.viewDate,l=e.sourceMode,c=e.onSelect,u=e.onPanelChange,d="".concat(t,"-year-panel");r.current={onKeyDown:function(e){return jG(e,{onLeftRight:function(e){c(i.addYear(o||s,e),"key")},onCtrlLeftRight:function(e){c(i.addYear(o||s,e*$K),"key")},onUpDown:function(e){c(i.addYear(o||s,e*FK),"key")},onEnter:function(){u("date"===l?"date":"month",o||s)}})}};var f=function(e){var t=i.addYear(s,10*e);n(t),u(null,t)};return a.createElement("div",{className:d},a.createElement(DK,iL({},e,{prefixCls:t,onPrevDecade:function(){f(-1)},onNextDecade:function(){f(1)},onDecadeClick:function(){u("decade",s)}})),a.createElement(LK,iL({},e,{prefixCls:t,onSelect:function(e){u("date"===l?"date":"month",e),c(e,"mouse")}})))}function zK(e,t,r){return r?a.createElement("div",{className:"".concat(e,"-footer-extra")},r(t)):null}function UK(e){var t,r,n=e.prefixCls,i=e.rangeList,o=void 0===i?[]:i,s=e.components,l=void 0===s?{}:s,c=e.needConfirmButton,u=e.onNow,d=e.onOk,f=e.okDisabled,p=e.showNow,h=e.locale;if(o.length){var m=l.rangeItem||"span";t=a.createElement(a.Fragment,null,o.map((function(e){var t=e.label,r=e.onClick,i=e.onMouseEnter,o=e.onMouseLeave;return a.createElement("li",{key:t,className:"".concat(n,"-preset")},a.createElement(m,{onClick:r,onMouseEnter:i,onMouseLeave:o},t))})))}if(c){var v=l.button||"button";u&&!t&&!1!==p&&(t=a.createElement("li",{className:"".concat(n,"-now")},a.createElement("a",{className:"".concat(n,"-now-btn"),onClick:u},h.now))),r=c&&a.createElement("li",{className:"".concat(n,"-ok")},a.createElement(v,{disabled:f,onClick:d},h.ok))}return t||r?a.createElement("ul",{className:"".concat(n,"-ranges")},t,r):null}function HK(e){var t,r=e.prefixCls,n=void 0===r?"rc-picker":r,i=e.className,o=e.style,s=e.locale,l=e.generateConfig,c=e.value,u=e.defaultValue,d=e.pickerValue,f=e.defaultPickerValue,p=e.disabledDate,h=e.mode,m=e.picker,v=void 0===m?"date":m,g=e.tabIndex,y=void 0===g?0:g,b=e.showNow,w=e.showTime,_=e.showToday,C=e.renderExtraFooter,E=e.hideHeader,x=e.onSelect,S=e.onChange,k=e.onPanelChange,O=e.onMouseDown,I=e.onPickerValueChange,R=e.onOk,T=e.components,A=e.direction,N=e.hourStep,M=void 0===N?1:N,P=e.minuteStep,j=void 0===P?1:P,D=e.secondStep,F=void 0===D?1:D,V="date"===v&&!!w||"time"===v,L=24%M==0,$=60%j==0,B=60%F==0;"production"!==Ti.exports.env.NODE_ENV&&(jL(!c||l.isValidate(c),"Invalidate date pass to `value`."),jL(!c||l.isValidate(c),"Invalidate date pass to `defaultValue`."),jL(L,"`hourStep` ".concat(M," is invalid. It should be a factor of 24.")),jL($,"`minuteStep` ".concat(j," is invalid. It should be a factor of 60.")),jL(B,"`secondStep` ".concat(F," is invalid. It should be a factor of 60.")));var z=a.useContext(_G),U=z.operationRef,H=z.panelRef,W=z.onSelect,G=z.hideRanges,K=z.defaultOpenValue,q=a.useContext(gK),Y=q.inRange,X=q.panelPosition,Z=q.rangedValue,J=q.hoverRangedValue,Q=a.useRef({}),ee=a.useRef(!0),te=fL(bG(null,{value:c,defaultValue:u,postState:function(e){return!e&&K&&"time"===v?K:e}}),2),re=te[0],ne=te[1],ie=fL(bG(null,{value:d,defaultValue:f||re,postState:function(e){var t=l.getNow();return e?!re&&w?"object"===oL(w)?kG(l,Array.isArray(e)?e[0]:e,w.defaultValue||t):kG(l,Array.isArray(e)?e[0]:e,u||t):e:t}}),2),oe=ie[0],ae=ie[1],se=function(e){ae(e),I&&I(e)},le=function(e){var t=$G[v];return t?t(e):e},ce=fL(bG((function(){return"time"===v?"time":le("date")}),{value:h}),2),ue=ce[0],de=ce[1];a.useEffect((function(){de(v)}),[v]);var fe=fL(a.useState((function(){return ue})),2),pe=fe[0],he=fe[1],me=function(e,t){(ue===v||arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&(ne(e),x&&x(e),W&&W(e,t),S&&!QG(l,e,re)&&(null==p||!p(e))&&S(e))},ve=function(e){return Q.current&&Q.current.onKeyDown?([wG.LEFT,wG.RIGHT,wG.UP,wG.DOWN,wG.PAGE_UP,wG.PAGE_DOWN,wG.ENTER].includes(e.which)&&e.preventDefault(),Q.current.onKeyDown(e)):(jL(!1,"Panel not correct handle keyDown event. Please help to fire issue about this."),!1)};U&&"right"!==X&&(U.current={onKeyDown:ve,onClose:function(){Q.current&&Q.current.onClose&&Q.current.onClose()}}),a.useEffect((function(){c&&!ee.current&&ae(c)}),[c]),a.useEffect((function(){ee.current=!1}),[]);var ge,ye=hL(hL({},e),{},{operationRef:Q,prefixCls:n,viewDate:oe,value:re,onViewDateChange:se,sourceMode:pe,onPanelChange:function(e,t){var r=le(e||ue);he(ue),de(r),k&&(ue!==r||QG(l,oe,oe))&&k(t,r)},disabledDate:p});switch(delete ye.onChange,delete ye.onSelect,ue){case"decade":ge=a.createElement(HG,iL({},ye,{onSelect:function(e,t){se(e),me(e,t)}}));break;case"year":ge=a.createElement(BK,iL({},ye,{onSelect:function(e,t){se(e),me(e,t)}}));break;case"month":ge=a.createElement(TK,iL({},ye,{onSelect:function(e,t){se(e),me(e,t)}}));break;case"quarter":ge=a.createElement(jK,iL({},ye,{onSelect:function(e,t){se(e),me(e,t)}}));break;case"week":ge=a.createElement(SK,iL({},ye,{onSelect:function(e,t){se(e),me(e,t)}}));break;case"time":delete ye.showTime,ge=a.createElement(vK,iL({},ye,"object"===oL(w)?w:null,{onSelect:function(e,t){se(e),me(e,t)}}));break;default:ge=w?a.createElement(xK,iL({},ye,{onSelect:function(e,t){se(e),me(e,t)}})):a.createElement(CK,iL({},ye,{onSelect:function(e,t){se(e),me(e,t)}}))}var be,we,_e;if(G||(be=zK(n,ue,C),we=UK({prefixCls:n,components:T,needConfirmButton:V,okDisabled:!re||p&&p(re),locale:s,showNow:b,onNow:V&&function(){var e=l.getNow(),t=function(e,t,r,n,i,o){var a=Math.floor(e/n)*n;if(a<e)return[a,60-i,60-o];var s=Math.floor(t/i)*i;return s<t?[a,s,60-o]:[a,s,Math.floor(r/o)*o]}(l.getHour(e),l.getMinute(e),l.getSecond(e),L?M:1,$?j:1,B?F:1),r=SG(l,e,t[0],t[1],t[2]);me(r,"submit")},onOk:function(){re&&(me(re,"submit",!0),R&&R(re))}})),_&&"date"===ue&&"date"===v&&!w){var Ce=l.getNow(),Ee="".concat(n,"-today-btn"),xe=p&&p(Ce);_e=a.createElement("a",{className:GA(Ee,xe&&"".concat(Ee,"-disabled")),"aria-disabled":xe,onClick:function(){xe||me(Ce,"mouse",!0)}},s.today)}return a.createElement(_G.Provider,{value:hL(hL({},z),{},{mode:ue,hideHeader:"hideHeader"in e?E:z.hideHeader,hidePrevBtn:Y&&"right"===X,hideNextBtn:Y&&"left"===X})},a.createElement("div",{tabIndex:y,className:GA("".concat(n,"-panel"),i,(t={},sL(t,"".concat(n,"-panel-has-range"),Z&&Z[0]&&Z[1]),sL(t,"".concat(n,"-panel-has-range-hover"),J&&J[0]&&J[1]),sL(t,"".concat(n,"-panel-rtl"),"rtl"===A),t)),style:o,onKeyDown:ve,onBlur:function(e){Q.current&&Q.current.onBlur&&Q.current.onBlur(e)},onMouseDown:O,ref:H},ge,be||we||_e?a.createElement("div",{className:"".concat(n,"-footer")},be,we,_e):null))}function WK(e,t,r,n){var i=c.a.unstable_batchedUpdates?function(e){c.a.unstable_batchedUpdates(r,e)}:r;return null!=e&&e.addEventListener&&e.addEventListener(t,i,n),{remove:function(){null!=e&&e.removeEventListener&&e.removeEventListener(t,i,n)}}}var GK=Object(a.forwardRef)((function(e,t){var r=e.didUpdate,n=e.getContainer,i=e.children,o=Object(a.useRef)(),s=Object(a.useRef)();Object(a.useImperativeHandle)(t,(function(){return{}}));var l=Object(a.useRef)(!1);return!l.current&&PB()&&(s.current=n(),o.current=s.current.parentNode,l.current=!0),Object(a.useEffect)((function(){null==r||r(e)})),Object(a.useEffect)((function(){return null===s.current.parentNode&&null!==o.current&&o.current.appendChild(s.current),function(){var e,t;null===(e=s.current)||void 0===e||null===(t=e.parentNode)||void 0===t||t.removeChild(s.current)}}),[]),s.current?c.a.createPortal(i,s.current):null}));function KK(e,t,r){return r?e[0]===t[0]:e[0]===t[0]&&e[1]===t[1]}const qK=function(){if(typeof navigator>"u"||typeof window>"u")return!1;var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(null==e?void 0:e.substr(0,4))};function YK(e){var t=e.prefixCls,r=e.motion,n=e.animation,i=e.transitionName;return r||(n?{motionName:"".concat(t,"-").concat(n)}:i?{motionName:i}:null)}function XK(e){var t=e.prefixCls,r=e.visible,n=e.zIndex,i=e.mask,o=e.maskMotion,s=e.maskAnimation,l=e.maskTransitionName;if(!i)return null;var c={};return(o||l||s)&&(c=hL({motionAppear:!0},YK({motion:o,prefixCls:t,transitionName:l,animation:s}))),a.createElement(sz,iL({},c,{visible:r,removeOnLeave:!0}),(function(e){var r=e.className;return a.createElement("div",{style:{zIndex:n},className:GA("".concat(t,"-mask"),r)})}))}function ZK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function JK(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ZK(Object(r),!0).forEach((function(t){eq(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZK(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function QK(e){return(QK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eq(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var tq,rq={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-",O:"-o-"};function nq(){if(void 0!==tq)return tq;tq="";var e=document.createElement("p").style;for(var t in rq)t+"Transform"in e&&(tq=t);return tq}function iq(){return nq()?"".concat(nq(),"TransitionProperty"):"transitionProperty"}function oq(){return nq()?"".concat(nq(),"Transform"):"transform"}function aq(e,t){var r=iq();r&&(e.style[r]=t,"transitionProperty"!==r&&(e.style.transitionProperty=t))}function sq(e,t){var r=oq();r&&(e.style[r]=t,"transform"!==r&&(e.style.transform=t))}var lq,cq=/matrix\((.*)\)/,uq=/matrix3d\((.*)\)/;function dq(e){var t=e.style.display;e.style.display="none",e.offsetHeight,e.style.display=t}function fq(e,t,r){var n=r;if("object"!==QK(t))return typeof n<"u"?("number"==typeof n&&(n="".concat(n,"px")),void(e.style[t]=n)):lq(e,t);for(var i in t)t.hasOwnProperty(i)&&fq(e,i,t[i])}function pq(e,t){var r=e["page".concat(t?"Y":"X","Offset")],n="scroll".concat(t?"Top":"Left");if("number"!=typeof r){var i=e.document;"number"!=typeof(r=i.documentElement[n])&&(r=i.body[n])}return r}function hq(e){return pq(e)}function mq(e){return pq(e,!0)}function vq(e){var t=function(e){var t,r,n,i=e.ownerDocument,o=i.body,a=i&&i.documentElement;return t=e.getBoundingClientRect(),r=Math.floor(t.left),n=Math.floor(t.top),{left:r-=a.clientLeft||o.clientLeft||0,top:n-=a.clientTop||o.clientTop||0}}(e),r=e.ownerDocument,n=r.defaultView||r.parentWindow;return t.left+=hq(n),t.top+=mq(n),t}function gq(e){return null!=e&&e==e.window}function yq(e){return gq(e)?e.document:9===e.nodeType?e:e.ownerDocument}var bq=new RegExp("^(".concat(/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,")(?!px)[a-z%]+$"),"i"),wq=/^(top|right|bottom|left)$/,_q="currentStyle",Cq="runtimeStyle",Eq="left";function xq(e,t){return"left"===e?t.useCssRight?"right":e:t.useCssBottom?"bottom":e}function Sq(e){return"left"===e?"right":"right"===e?"left":"top"===e?"bottom":"bottom"===e?"top":void 0}function kq(e,t,r){"static"===fq(e,"position")&&(e.style.position="relative");var n=-999,i=-999,o=xq("left",r),a=xq("top",r),s=Sq(o),l=Sq(a);"left"!==o&&(n=999),"top"!==a&&(i=999);var c="",u=vq(e);("left"in t||"top"in t)&&(c=function(e){return e.style.transitionProperty||e.style[iq()]}(e)||"",aq(e,"none")),"left"in t&&(e.style[s]="",e.style[o]="".concat(n,"px")),"top"in t&&(e.style[l]="",e.style[a]="".concat(i,"px")),dq(e);var d=vq(e),f={};for(var p in t)if(t.hasOwnProperty(p)){var h=xq(p,r),m="left"===p?n:i,v=u[p]-d[p];f[h]=h===p?m+v:m-v}fq(e,f),dq(e),("left"in t||"top"in t)&&aq(e,c);var g={};for(var y in t)if(t.hasOwnProperty(y)){var b=xq(y,r),w=t[y]-u[y];g[b]=y===b?f[b]+w:f[b]-w}fq(e,g)}function Oq(e,t){var r=vq(e),n=function(e){var t=window.getComputedStyle(e,null),r=t.getPropertyValue("transform")||t.getPropertyValue(oq());if(r&&"none"!==r){var n=r.replace(/[^0-9\-.,]/g,"").split(",");return{x:parseFloat(n[12]||n[4],0),y:parseFloat(n[13]||n[5],0)}}return{x:0,y:0}}(e),i={x:n.x,y:n.y};"left"in t&&(i.x=n.x+t.left-r.left),"top"in t&&(i.y=n.y+t.top-r.top),function(e,t){var r=window.getComputedStyle(e,null),n=r.getPropertyValue("transform")||r.getPropertyValue(oq());if(n&&"none"!==n){var i,o=n.match(cq);o?((i=(o=o[1]).split(",").map((function(e){return parseFloat(e,10)})))[4]=t.x,i[5]=t.y,sq(e,"matrix(".concat(i.join(","),")"))):((i=n.match(uq)[1].split(",").map((function(e){return parseFloat(e,10)})))[12]=t.x,i[13]=t.y,sq(e,"matrix3d(".concat(i.join(","),")")))}else sq(e,"translateX(".concat(t.x,"px) translateY(").concat(t.y,"px) translateZ(0)"))}(e,i)}function Iq(e,t){for(var r=0;r<e.length;r++)t(e[r])}function Rq(e){return"border-box"===lq(e,"boxSizing")}typeof window<"u"&&(lq=window.getComputedStyle?function(e,t,r){var n=r,i="",o=yq(e);return(n=n||o.defaultView.getComputedStyle(e,null))&&(i=n.getPropertyValue(t)||n[t]),i}:function(e,t){var r=e[_q]&&e[_q][t];if(bq.test(r)&&!wq.test(t)){var n=e.style,i=n[Eq],o=e[Cq][Eq];e[Cq][Eq]=e[_q][Eq],n[Eq]="fontSize"===t?"1em":r||0,r=n.pixelLeft+"px",n[Eq]=i,e[Cq][Eq]=o}return""===r?"auto":r});var Tq=["margin","border","padding"],Aq=-1,Nq=2,Mq=1;function Pq(e,t,r){var n,i,o,a=0;for(i=0;i<t.length;i++)if(n=t[i])for(o=0;o<r.length;o++){var s=void 0;s="border"===n?"".concat(n).concat(r[o],"Width"):n+r[o],a+=parseFloat(lq(e,s))||0}return a}var jq={getParent:function(e){var t=e;do{t=11===t.nodeType&&t.host?t.host:t.parentNode}while(t&&1!==t.nodeType&&9!==t.nodeType);return t}};function Dq(e,t,r){var n=r;if(gq(e))return"width"===t?jq.viewportWidth(e):jq.viewportHeight(e);if(9===e.nodeType)return"width"===t?jq.docWidth(e):jq.docHeight(e);var i="width"===t?["Left","Right"]:["Top","Bottom"],o=Math.floor("width"===t?e.getBoundingClientRect().width:e.getBoundingClientRect().height),a=Rq(e),s=0;(null==o||o<=0)&&(o=void 0,(null==(s=lq(e,t))||Number(s)<0)&&(s=e.style[t]||0),s=Math.floor(parseFloat(s))||0),void 0===n&&(n=a?Mq:Aq);var l=void 0!==o||a,c=o||s;return n===Aq?l?c-Pq(e,["border","padding"],i):s:l?n===Mq?c:c+(n===Nq?-Pq(e,["border"],i):Pq(e,["margin"],i)):s+Pq(e,Tq.slice(n),i)}Iq(["Width","Height"],(function(e){jq["doc".concat(e)]=function(t){var r=t.document;return Math.max(r.documentElement["scroll".concat(e)],r.body["scroll".concat(e)],jq["viewport".concat(e)](r))},jq["viewport".concat(e)]=function(t){var r="client".concat(e),n=t.document,i=n.body,o=n.documentElement[r];return"CSS1Compat"===n.compatMode&&o||i&&i[r]||o}}));var Fq={position:"absolute",visibility:"hidden",display:"block"};function Vq(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=t[0];return 0!==i.offsetWidth?n=Dq.apply(void 0,t):function(e,t,r){var n,i={},o=e.style;for(n in t)t.hasOwnProperty(n)&&(i[n]=o[n],o[n]=t[n]);for(n in r.call(e),t)t.hasOwnProperty(n)&&(o[n]=i[n])}(i,Fq,(function(){n=Dq.apply(void 0,t)})),n}function Lq(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}Iq(["width","height"],(function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);jq["outer".concat(t)]=function(t,r){return t&&Vq(t,e,r?0:Mq)};var r="width"===e?["Left","Right"]:["Top","Bottom"];jq[e]=function(t,n){var i=n;return void 0!==i?t?(Rq(t)&&(i+=Pq(t,["padding","border"],r)),fq(t,e,i)):void 0:t&&Vq(t,e,Aq)}}));var $q={getWindow:function(e){if(e&&e.document&&e.setTimeout)return e;var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},getDocument:yq,offset:function(e,t,r){if(!(typeof t<"u"))return vq(e);!function(e,t,r){if(r.ignoreShake){var n=vq(e),i=n.left.toFixed(0),o=n.top.toFixed(0),a=t.left.toFixed(0),s=t.top.toFixed(0);if(i===a&&o===s)return}r.useCssRight||r.useCssBottom?kq(e,t,r):r.useCssTransform&&oq()in document.body.style?Oq(e,t):kq(e,t,r)}(e,t,r||{})},isWindow:gq,each:Iq,css:fq,clone:function(e){var t,r={};for(t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);if(e.overflow)for(t in e)e.hasOwnProperty(t)&&(r.overflow[t]=e.overflow[t]);return r},mix:Lq,getWindowScrollLeft:function(e){return hq(e)},getWindowScrollTop:function(e){return mq(e)},merge:function(){for(var e={},t=0;t<arguments.length;t++)$q.mix(e,t<0||arguments.length<=t?void 0:arguments[t]);return e},viewportWidth:0,viewportHeight:0};Lq($q,jq);var Bq=$q.getParent;function zq(e){if($q.isWindow(e)||9===e.nodeType)return null;var t,r=$q.getDocument(e).body,n=$q.css(e,"position");if(!("fixed"===n||"absolute"===n))return"html"===e.nodeName.toLowerCase()?null:Bq(e);for(t=Bq(e);t&&t!==r&&9!==t.nodeType;t=Bq(t))if("static"!==(n=$q.css(t,"position")))return t;return null}var Uq=$q.getParent;function Hq(e,t){for(var r={left:0,right:1/0,top:0,bottom:1/0},n=zq(e),i=$q.getDocument(e),o=i.defaultView||i.parentWindow,a=i.body,s=i.documentElement;n;){if(-1!==navigator.userAgent.indexOf("MSIE")&&0===n.clientWidth||n===a||n===s||"visible"===$q.css(n,"overflow")){if(n===a||n===s)break}else{var l=$q.offset(n);l.left+=n.clientLeft,l.top+=n.clientTop,r.top=Math.max(r.top,l.top),r.right=Math.min(r.right,l.left+n.clientWidth),r.bottom=Math.min(r.bottom,l.top+n.clientHeight),r.left=Math.max(r.left,l.left)}n=zq(n)}var c=null;$q.isWindow(e)||9===e.nodeType||(c=e.style.position,"absolute"===$q.css(e,"position")&&(e.style.position="fixed"));var u=$q.getWindowScrollLeft(o),d=$q.getWindowScrollTop(o),f=$q.viewportWidth(o),p=$q.viewportHeight(o),h=s.scrollWidth,m=s.scrollHeight,v=window.getComputedStyle(a);if("hidden"===v.overflowX&&(h=o.innerWidth),"hidden"===v.overflowY&&(m=o.innerHeight),e.style&&(e.style.position=c),t||function(e){if($q.isWindow(e)||9===e.nodeType)return!1;var t=$q.getDocument(e),r=t.body,n=null;for(n=Uq(e);n&&n!==r&&n!==t;n=Uq(n))if("fixed"===$q.css(n,"position"))return!0;return!1}(e))r.left=Math.max(r.left,u),r.top=Math.max(r.top,d),r.right=Math.min(r.right,u+f),r.bottom=Math.min(r.bottom,d+p);else{var g=Math.max(h,u+f);r.right=Math.min(r.right,g);var y=Math.max(m,d+p);r.bottom=Math.min(r.bottom,y)}return r.top>=0&&r.left>=0&&r.bottom>r.top&&r.right>r.left?r:null}function Wq(e){var t,r,n;if($q.isWindow(e)||9===e.nodeType){var i=$q.getWindow(e);t={left:$q.getWindowScrollLeft(i),top:$q.getWindowScrollTop(i)},r=$q.viewportWidth(i),n=$q.viewportHeight(i)}else t=$q.offset(e),r=$q.outerWidth(e),n=$q.outerHeight(e);return t.width=r,t.height=n,t}function Gq(e,t){var r=t.charAt(0),n=t.charAt(1),i=e.width,o=e.height,a=e.left,s=e.top;return"c"===r?s+=o/2:"b"===r&&(s+=o),"c"===n?a+=i/2:"r"===n&&(a+=i),{left:a,top:s}}function Kq(e,t,r,n,i){var o=Gq(t,r[1]),a=Gq(e,r[0]),s=[a.left-o.left,a.top-o.top];return{left:Math.round(e.left-s[0]+n[0]-i[0]),top:Math.round(e.top-s[1]+n[1]-i[1])}}function qq(e,t,r){return e.left<r.left||e.left+t.width>r.right}function Yq(e,t,r){return e.top<r.top||e.top+t.height>r.bottom}function Xq(e,t,r){var n=[];return $q.each(e,(function(e){n.push(e.replace(t,(function(e){return r[e]})))})),n}function Zq(e,t){return e[t]=-e[t],e}function Jq(e,t){return(/%$/.test(e)?parseInt(e.substring(0,e.length-1),10)/100*t:parseInt(e,10))||0}function Qq(e,t){e[0]=Jq(e[0],t.width),e[1]=Jq(e[1],t.height)}function eY(e,t,r,n){var i=r.points,o=r.offset||[0,0],a=r.targetOffset||[0,0],s=r.overflow,l=r.source||e;o=[].concat(o),a=[].concat(a);var c={},u=0,d=Hq(l,!(!(s=s||{})||!s.alwaysByViewport)),f=Wq(l);Qq(o,f),Qq(a,t);var p=Kq(f,t,i,o,a),h=$q.merge(f,p);if(d&&(s.adjustX||s.adjustY)&&n){if(s.adjustX&&qq(p,f,d)){var m=Xq(i,/[lr]/gi,{l:"r",r:"l"}),v=Zq(o,0),g=Zq(a,0);(function(e,t,r){return e.left>r.right||e.left+t.width<r.left})(Kq(f,t,m,v,g),f,d)||(u=1,i=m,o=v,a=g)}if(s.adjustY&&Yq(p,f,d)){var y=Xq(i,/[tb]/gi,{t:"b",b:"t"}),b=Zq(o,1),w=Zq(a,1);(function(e,t,r){return e.top>r.bottom||e.top+t.height<r.top})(Kq(f,t,y,b,w),f,d)||(u=1,i=y,o=b,a=w)}u&&(p=Kq(f,t,i,o,a),$q.mix(h,p));var _=qq(p,f,d),C=Yq(p,f,d);if(_||C){var E=i;_&&(E=Xq(i,/[lr]/gi,{l:"r",r:"l"})),C&&(E=Xq(i,/[tb]/gi,{t:"b",b:"t"})),i=E,o=r.offset||[0,0],a=r.targetOffset||[0,0]}c.adjustX=s.adjustX&&_,c.adjustY=s.adjustY&&C,(c.adjustX||c.adjustY)&&(h=function(e,t,r,n){var i=$q.clone(e),o={width:t.width,height:t.height};return n.adjustX&&i.left<r.left&&(i.left=r.left),n.resizeWidth&&i.left>=r.left&&i.left+o.width>r.right&&(o.width-=i.left+o.width-r.right),n.adjustX&&i.left+o.width>r.right&&(i.left=Math.max(r.right-o.width,r.left)),n.adjustY&&i.top<r.top&&(i.top=r.top),n.resizeHeight&&i.top>=r.top&&i.top+o.height>r.bottom&&(o.height-=i.top+o.height-r.bottom),n.adjustY&&i.top+o.height>r.bottom&&(i.top=Math.max(r.bottom-o.height,r.top)),$q.mix(i,o)}(p,f,d,c))}return h.width!==f.width&&$q.css(l,"width",$q.width(l)+h.width-f.width),h.height!==f.height&&$q.css(l,"height",$q.height(l)+h.height-f.height),$q.offset(l,{left:h.left,top:h.top},{useCssRight:r.useCssRight,useCssBottom:r.useCssBottom,useCssTransform:r.useCssTransform,ignoreShake:r.ignoreShake}),{points:i,offset:o,targetOffset:a,overflow:c}}function tY(e,t,r){var n=r.target||t,i=Wq(n),o=!function(e,t){var r=Hq(e,t),n=Wq(e);return!r||n.left+n.width<=r.left||n.top+n.height<=r.top||n.left>=r.right||n.top>=r.bottom}(n,r.overflow&&r.overflow.alwaysByViewport);return eY(e,i,r,o)}function rY(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=new Set;return function e(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=n.has(t);if(jL(!a,"Warning: There may be circular references"),a)return!1;if(t===i)return!0;if(r&&o>1)return!1;n.add(t);var s=o+1;if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],i[l],s))return!1;return!0}if(t&&i&&"object"===oL(t)&&"object"===oL(i)){var c=Object.keys(t);return c.length===Object.keys(i).length&&c.every((function(r){return e(t[r],i[r],s)}))}return!1}(e,t)}tY.__getOffsetParent=zq,tY.__getVisibleRectForElement=Hq;var nY=function(){if(typeof Map<"u")return Map;function e(e,t){var r=-1;return e.some((function(e,n){return e[0]===t&&(r=n,!0)})),r}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var r=e(this.__entries__,t),n=this.__entries__[r];return n&&n[1]},t.prototype.set=function(t,r){var n=e(this.__entries__,t);~n?this.__entries__[n][1]=r:this.__entries__.push([t,r])},t.prototype.delete=function(t){var r=this.__entries__,n=e(r,t);~n&&r.splice(n,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var r=0,n=this.__entries__;r<n.length;r++){var i=n[r];e.call(t,i[1],i[0])}},t}()}(),iY=typeof window<"u"&&typeof document<"u"&&window.document===document,oY=typeof fa<"u"&&fa.Math===Math?fa:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")(),aY="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(oY):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)};var sY=["top","right","bottom","left","width","height","size","weight"],lY=typeof MutationObserver<"u",cY=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var r=!1,n=!1,i=0;function o(){r&&(r=!1,e()),n&&s()}function a(){aY(o)}function s(){var e=Date.now();if(r){if(e-i<2)return;n=!0}else r=!0,n=!1,setTimeout(a,t);i=e}return s}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,r=t.indexOf(e);~r&&t.splice(r,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){!iY||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),lY?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!iY||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,r=void 0===t?"":t;sY.some((function(e){return!!~r.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),uY=function(e,t){for(var r=0,n=Object.keys(t);r<n.length;r++){var i=n[r];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},dY=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||oY},fY=yY(0,0,0,0);function pY(e){return parseFloat(e)||0}function hY(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.reduce((function(t,r){return t+pY(e["border-"+r+"-width"])}),0)}function mY(e){var t=e.clientWidth,r=e.clientHeight;if(!t&&!r)return fY;var n=dY(e).getComputedStyle(e),i=function(e){for(var t={},r=0,n=["top","right","bottom","left"];r<n.length;r++){var i=n[r],o=e["padding-"+i];t[i]=pY(o)}return t}(n),o=i.left+i.right,a=i.top+i.bottom,s=pY(n.width),l=pY(n.height);if("border-box"===n.boxSizing&&(Math.round(s+o)!==t&&(s-=hY(n,"left","right")+o),Math.round(l+a)!==r&&(l-=hY(n,"top","bottom")+a)),!function(e){return e===dY(e).document.documentElement}(e)){var c=Math.round(s+o)-t,u=Math.round(l+a)-r;1!==Math.abs(c)&&(s-=c),1!==Math.abs(u)&&(l-=u)}return yY(i.left,i.top,s,l)}var vY=typeof SVGGraphicsElement<"u"?function(e){return e instanceof dY(e).SVGGraphicsElement}:function(e){return e instanceof dY(e).SVGElement&&"function"==typeof e.getBBox};function gY(e){return iY?vY(e)?function(e){var t=e.getBBox();return yY(0,0,t.width,t.height)}(e):mY(e):fY}function yY(e,t,r,n){return{x:e,y:t,width:r,height:n}}var bY=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=yY(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=gY(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),wY=function(e,t){var r=function(e){var t=e.x,r=e.y,n=e.width,i=e.height,o=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,a=Object.create(o.prototype);return uY(a,{x:t,y:r,width:n,height:i,top:r,right:t+n,bottom:i+r,left:t}),a}(t);uY(this,{target:e,contentRect:r})},_Y=function(){function e(e,t,r){if(this.activeObservations_=[],this.observations_=new nY,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=r}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u")&&Element instanceof Object){if(!(e instanceof dY(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new bY(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u")&&Element instanceof Object){if(!(e instanceof dY(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;!t.has(e)||(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new wY(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),CY=typeof WeakMap<"u"?new WeakMap:new nY,EY=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var r=cY.getInstance(),n=new _Y(t,r,this);CY.set(this,n)};["observe","unobserve","disconnect"].forEach((function(e){EY.prototype[e]=function(){var t;return(t=CY.get(this))[e].apply(t,arguments)}}));var xY=typeof oY.ResizeObserver<"u"?oY.ResizeObserver:EY;function SY(e,t){var r=null,n=null;var i=new xY((function(e){var i=fL(e,1)[0].target;if(document.documentElement.contains(i)){var o=i.getBoundingClientRect(),a=o.width,s=o.height,l=Math.floor(a),c=Math.floor(s);(r!==l||n!==c)&&Promise.resolve().then((function(){t({width:l,height:c})})),r=l,n=c}}));return e&&i.observe(e),function(){i.disconnect()}}function kY(e){return"function"!=typeof e?null:e()}function OY(e){return"object"===oL(e)&&e?e:null}var IY=function(e,t){var r=e.children,n=e.disabled,i=e.target,o=e.align,a=e.onAlign,l=e.monitorWindowResize,c=e.monitorBufferTime,u=void 0===c?0:c,d=s.a.useRef({}),f=s.a.useRef(),p=s.a.Children.only(r),h=s.a.useRef({});h.current.disabled=n,h.current.target=i,h.current.align=o,h.current.onAlign=a;var m=function(e,t){var r=s.a.useRef(!1),n=s.a.useRef(null);function i(){window.clearTimeout(n.current)}return[function o(a){if(i(),r.current&&!0!==a)n.current=window.setTimeout((function(){r.current=!1,o()}),t);else{if(!1===e(a))return;r.current=!0,n.current=window.setTimeout((function(){r.current=!1}),t)}},function(){r.current=!1,i()}]}((function(){var e=h.current,t=e.disabled,r=e.target,n=e.align,i=e.onAlign,o=f.current;if(!t&&r&&o){var a,s=kY(r),l=OY(r);d.current.element=s,d.current.point=l,d.current.align=n;var c=document.activeElement;return s&&NG(s)?a=tY(o,s,n):l&&(a=function(e,t,r){var n,i,o=$q.getDocument(e),a=o.defaultView||o.parentWindow,s=$q.getWindowScrollLeft(a),l=$q.getWindowScrollTop(a),c=$q.viewportWidth(a),u=$q.viewportHeight(a),d={left:n="pageX"in t?t.pageX:s+t.clientX,top:i="pageY"in t?t.pageY:l+t.clientY,width:0,height:0},f=n>=0&&n<=s+c&&i>=0&&i<=l+u,p=[r.points[0],"cc"];return eY(e,d,JK(JK({},r),{},{points:p}),f)}(o,l,n)),function(e,t){e!==document.activeElement&&qz(t,e)&&"function"==typeof e.focus&&e.focus()}(c,o),i&&a&&i(o,a),!0}return!1}),u),v=fL(m,2),g=v[0],y=v[1],b=fL(s.a.useState(),2),w=b[0],_=b[1],C=fL(s.a.useState(),2),E=C[0],x=C[1];return vG((function(){_(kY(i)),x(OY(i))})),s.a.useEffect((function(){(d.current.element!==w||!function(e,t){return e===t||!(!e||!t)&&("pageX"in t&&"pageY"in t?e.pageX===t.pageX&&e.pageY===t.pageY:"clientX"in t&&"clientY"in t&&e.clientX===t.clientX&&e.clientY===t.clientY)}(d.current.point,E)||!rY(d.current.align,o))&&g()})),s.a.useEffect((function(){return SY(f.current,g)}),[f.current]),s.a.useEffect((function(){return SY(w,g)}),[w]),s.a.useEffect((function(){n?y():g()}),[n]),s.a.useEffect((function(){if(l)return WK(window,"resize",g).remove}),[l]),s.a.useEffect((function(){return function(){y()}}),[]),s.a.useImperativeHandle(t,(function(){return{forceAlign:function(){return g(!0)}}})),s.a.isValidElement(p)&&(p=s.a.cloneElement(p,{ref:yB(p.ref,f)})),p},RY=s.a.forwardRef(IY);function TY(){TY=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch{c=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new T(n||[]);return i(a,"_invoke",{value:k(e,r,s)}),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",p="suspendedYield",h="executing",m="completed",v={};function g(){}function y(){}function b(){}var w={};c(w,a,(function(){return this}));var _=Object.getPrototypeOf,C=_&&_(_(A([])));C&&C!==r&&n.call(C,a)&&(w=C);var E=b.prototype=g.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(i,o,a,s){var l=d(e[i],e,o);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==oL(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(l.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function k(t,r,n){var i=f;return function(o,a){if(i===h)throw new Error("Generator is already running");if(i===m){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=O(s,n);if(l){if(l===v)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=h;var c=d(t,r,n);if("normal"===c.type){if(i=n.done?m:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=m,n.method="throw",n.arg=c.arg)}}}function O(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,O(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var o=d(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function A(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(oL(t)+" is not iterable")}return y.prototype=b,i(E,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},x(S.prototype),c(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new S(u(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(E),c(E,l,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=A,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;R(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:A(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}RY.displayName="Align";var AY=["measure","alignPre","align",null,"motion"];var NY=a.forwardRef((function(e,t){var r=e.visible,n=e.prefixCls,i=e.className,o=e.style,s=e.children,l=e.zIndex,c=e.stretch,u=e.destroyPopupOnHide,d=e.forceRender,f=e.align,p=e.point,h=e.getRootDomNode,m=e.getClassNameFromAlign,v=e.onAlign,g=e.onMouseEnter,y=e.onMouseLeave,b=e.onMouseDown,w=e.onTouchStart,_=e.onClick,C=Object(a.useRef)(),E=Object(a.useRef)(),x=fL(Object(a.useState)(),2),S=x[0],k=x[1],O=function(e){var t=fL(a.useState({width:0,height:0}),2),r=t[0],n=t[1];return[a.useMemo((function(){var t={};if(e){var n=r.width,i=r.height;-1!==e.indexOf("height")&&i?t.height=i:-1!==e.indexOf("minHeight")&&i&&(t.minHeight=i),-1!==e.indexOf("width")&&n?t.width=n:-1!==e.indexOf("minWidth")&&n&&(t.minWidth=n)}return t}),[e,r]),function(e){var t=e.offsetWidth,r=e.offsetHeight,i=e.getBoundingClientRect(),o=i.width,a=i.height;Math.abs(t-o)<1&&Math.abs(r-a)<1&&(t=o,r=a),n({width:t,height:r})}]}(c),I=fL(O,2),R=I[0],T=I[1];var A=function(e,t){var r=fL(EB(null),2),n=r[0],i=r[1],o=Object(a.useRef)();function s(e){i(e,!0)}function l(){ez.cancel(o.current)}return Object(a.useEffect)((function(){s("measure")}),[e]),Object(a.useEffect)((function(){"measure"===n&&t(),n&&(o.current=ez(WL(TY().mark((function e(){var t,r;return TY().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=AY.indexOf(n),(r=AY[t+1])&&-1!==t&&s(r);case 3:case"end":return e.stop()}}),e)})))))}),[n]),Object(a.useEffect)((function(){return function(){l()}}),[]),[n,function(e){l(),o.current=ez((function(){s((function(e){switch(n){case"align":return"motion";case"motion":return"stable"}return e})),null==e||e()}))}]}(r,(function(){c&&T(h())})),N=fL(A,2),M=N[0],P=N[1],j=fL(Object(a.useState)(0),2),D=j[0],F=j[1],V=Object(a.useRef)();function L(){var e;null===(e=C.current)||void 0===e||e.forceAlign()}function $(e,t){var r=m(t);S!==r&&k(r),F((function(e){return e+1})),"align"===M&&(null==v||v(e,t))}vG((function(){"alignPre"===M&&F(0)}),[M]),vG((function(){"align"===M&&(D<3?L():P((function(){var e;null===(e=V.current)||void 0===e||e.call(V)})))}),[D]);var B=hL({},YK(e));function z(){return new Promise((function(e){V.current=e}))}["onAppearEnd","onEnterEnd","onLeaveEnd"].forEach((function(e){var t=B[e];B[e]=function(e,r){return P(),null==t?void 0:t(e,r)}})),a.useEffect((function(){!B.motionName&&"motion"===M&&P()}),[B.motionName,M]),a.useImperativeHandle(t,(function(){return{forceAlign:L,getElement:function(){return E.current}}}));var U=hL(hL({},R),{},{zIndex:l,opacity:"motion"!==M&&"stable"!==M&&r?0:void 0,pointerEvents:r||"stable"===M?void 0:"none"},o),H=!0;null!=f&&f.points&&("align"===M||"stable"===M)&&(H=!1);var W=s;return a.Children.count(s)>1&&(W=a.createElement("div",{className:"".concat(n,"-content")},s)),a.createElement(sz,iL({visible:r,ref:E,leavedClassName:"".concat(n,"-hidden")},B,{onAppearPrepare:z,onEnterPrepare:z,removeOnLeave:u,forceRender:d}),(function(e,t){var r=e.className,o=e.style,s=GA(n,i,S,r);return a.createElement(RY,{target:p||h,key:"popup",ref:C,monitorWindowResize:!0,disabled:H,align:f,onAlign:$},a.createElement("div",{ref:t,className:s,onMouseEnter:g,onMouseLeave:y,onMouseDownCapture:b,onTouchStartCapture:w,onClick:_,style:hL(hL({},o),U)},W))}))}));NY.displayName="PopupInner";var MY=a.forwardRef((function(e,t){var r=e.prefixCls,n=e.visible,i=e.zIndex,o=e.children,s=e.mobile,l=(s=void 0===s?{}:s).popupClassName,c=s.popupStyle,u=s.popupMotion,d=void 0===u?{}:u,f=s.popupRender,p=e.onClick,h=a.useRef();a.useImperativeHandle(t,(function(){return{forceAlign:function(){},getElement:function(){return h.current}}}));var m=hL({zIndex:i},c),v=o;return a.Children.count(o)>1&&(v=a.createElement("div",{className:"".concat(r,"-content")},o)),f&&(v=f(v)),a.createElement(sz,iL({visible:n,ref:h,removeOnLeave:!0},d),(function(e,t){var n=e.className,i=e.style,o=GA(r,l,n);return a.createElement("div",{ref:t,className:o,onClick:p,style:hL(hL({},i),m)},v)}))}));MY.displayName="MobilePopupInner";var PY=["visible","mobile"],jY=a.forwardRef((function(e,t){var r=e.visible,n=e.mobile,i=gL(e,PY),o=fL(Object(a.useState)(r),2),s=o[0],l=o[1],c=fL(Object(a.useState)(!1),2),u=c[0],d=c[1],f=hL(hL({},i),{},{visible:s});Object(a.useEffect)((function(){l(r),r&&n&&d(qK())}),[r,n]);var p=u?a.createElement(MY,iL({},f,{mobile:n,ref:t})):a.createElement(NY,iL({},f,{ref:t}));return a.createElement("div",null,a.createElement(XK,f),p)}));jY.displayName="Popup";var DY=a.createContext(null);function FY(){}function VY(){return""}function LY(e){return e?e.ownerDocument:window.document}var $Y=["onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur","onContextMenu"];const BY=function(e){var t=function(t){SL(n,t);var r=OL(n);function n(e){var t,i;return wL(this,n),sL(EL(t=r.call(this,e)),"popupRef",a.createRef()),sL(EL(t),"triggerRef",a.createRef()),sL(EL(t),"portalContainer",void 0),sL(EL(t),"attachId",void 0),sL(EL(t),"clickOutsideHandler",void 0),sL(EL(t),"touchOutsideHandler",void 0),sL(EL(t),"contextMenuOutsideHandler1",void 0),sL(EL(t),"contextMenuOutsideHandler2",void 0),sL(EL(t),"mouseDownTimeout",void 0),sL(EL(t),"focusTime",void 0),sL(EL(t),"preClickTime",void 0),sL(EL(t),"preTouchTime",void 0),sL(EL(t),"delayTimer",void 0),sL(EL(t),"hasPopupMouseDown",void 0),sL(EL(t),"onMouseEnter",(function(e){var r=t.props.mouseEnterDelay;t.fireEvents("onMouseEnter",e),t.delaySetPopupVisible(!0,r,r?null:e)})),sL(EL(t),"onMouseMove",(function(e){t.fireEvents("onMouseMove",e),t.setPoint(e)})),sL(EL(t),"onMouseLeave",(function(e){t.fireEvents("onMouseLeave",e),t.delaySetPopupVisible(!1,t.props.mouseLeaveDelay)})),sL(EL(t),"onPopupMouseEnter",(function(){t.clearDelayTimer()})),sL(EL(t),"onPopupMouseLeave",(function(e){var r;e.relatedTarget&&!e.relatedTarget.setTimeout&&qz(null===(r=t.popupRef.current)||void 0===r?void 0:r.getElement(),e.relatedTarget)||t.delaySetPopupVisible(!1,t.props.mouseLeaveDelay)})),sL(EL(t),"onFocus",(function(e){t.fireEvents("onFocus",e),t.clearDelayTimer(),t.isFocusToShow()&&(t.focusTime=Date.now(),t.delaySetPopupVisible(!0,t.props.focusDelay))})),sL(EL(t),"onMouseDown",(function(e){t.fireEvents("onMouseDown",e),t.preClickTime=Date.now()})),sL(EL(t),"onTouchStart",(function(e){t.fireEvents("onTouchStart",e),t.preTouchTime=Date.now()})),sL(EL(t),"onBlur",(function(e){t.fireEvents("onBlur",e),t.clearDelayTimer(),t.isBlurToHide()&&t.delaySetPopupVisible(!1,t.props.blurDelay)})),sL(EL(t),"onContextMenu",(function(e){e.preventDefault(),t.fireEvents("onContextMenu",e),t.setPopupVisible(!0,e)})),sL(EL(t),"onContextMenuClose",(function(){t.isContextMenuToShow()&&t.close()})),sL(EL(t),"onClick",(function(e){if(t.fireEvents("onClick",e),t.focusTime){var r;if(t.preClickTime&&t.preTouchTime?r=Math.min(t.preClickTime,t.preTouchTime):t.preClickTime?r=t.preClickTime:t.preTouchTime&&(r=t.preTouchTime),Math.abs(r-t.focusTime)<20)return;t.focusTime=0}t.preClickTime=0,t.preTouchTime=0,t.isClickToShow()&&(t.isClickToHide()||t.isBlurToHide())&&e&&e.preventDefault&&e.preventDefault();var n=!t.state.popupVisible;(t.isClickToHide()&&!n||n&&t.isClickToShow())&&t.setPopupVisible(!t.state.popupVisible,e)})),sL(EL(t),"onPopupMouseDown",(function(){var e;(t.hasPopupMouseDown=!0,clearTimeout(t.mouseDownTimeout),t.mouseDownTimeout=window.setTimeout((function(){t.hasPopupMouseDown=!1}),0),t.context)&&(e=t.context).onPopupMouseDown.apply(e,arguments)})),sL(EL(t),"onDocumentClick",(function(e){if(!t.props.mask||t.props.maskClosable){var r=e.target,n=t.getRootDomNode(),i=t.getPopupDomNode();(!qz(n,r)||t.isContextMenuOnly())&&!qz(i,r)&&!t.hasPopupMouseDown&&t.close()}})),sL(EL(t),"getRootDomNode",(function(){var e=t.props.getTriggerDOMNode;if(e)return e(t.triggerRef.current);try{var r=vB(t.triggerRef.current);if(r)return r}catch{}return c.a.findDOMNode(EL(t))})),sL(EL(t),"getPopupClassNameFromAlign",(function(e){var r=[],n=t.props,i=n.popupPlacement,o=n.builtinPlacements,a=n.prefixCls,s=n.alignPoint,l=n.getPopupClassNameFromAlign;return i&&o&&r.push(function(e,t,r,n){for(var i=r.points,o=Object.keys(e),a=0;a<o.length;a+=1){var s=o[a];if(KK(e[s].points,i,n))return"".concat(t,"-placement-").concat(s)}return""}(o,a,e,s)),l&&r.push(l(e)),r.join(" ")})),sL(EL(t),"getComponent",(function(){var e=t.props,r=e.prefixCls,n=e.destroyPopupOnHide,i=e.popupClassName,o=e.onPopupAlign,s=e.popupMotion,l=e.popupAnimation,c=e.popupTransitionName,u=e.popupStyle,d=e.mask,f=e.maskAnimation,p=e.maskTransitionName,h=e.maskMotion,m=e.zIndex,v=e.popup,g=e.stretch,y=e.alignPoint,b=e.mobile,w=e.forceRender,_=e.onPopupClick,C=t.state,E=C.popupVisible,x=C.point,S=t.getPopupAlign(),k={};return t.isMouseEnterToShow()&&(k.onMouseEnter=t.onPopupMouseEnter),t.isMouseLeaveToHide()&&(k.onMouseLeave=t.onPopupMouseLeave),k.onMouseDown=t.onPopupMouseDown,k.onTouchStart=t.onPopupMouseDown,a.createElement(jY,iL({prefixCls:r,destroyPopupOnHide:n,visible:E,point:y&&x,className:i,align:S,onAlign:o,animation:l,getClassNameFromAlign:t.getPopupClassNameFromAlign},k,{stretch:g,getRootDomNode:t.getRootDomNode,style:u,mask:d,zIndex:m,transitionName:c,maskAnimation:f,maskTransitionName:p,maskMotion:h,ref:t.popupRef,motion:s,mobile:b,forceRender:w,onClick:_}),"function"==typeof v?v():v)})),sL(EL(t),"attachParent",(function(e){ez.cancel(t.attachId);var r,n=t.props,i=n.getPopupContainer,o=n.getDocument,a=t.getRootDomNode();i?(a||0===i.length)&&(r=i(a)):r=o(t.getRootDomNode()).body,r?r.appendChild(e):t.attachId=ez((function(){t.attachParent(e)}))})),sL(EL(t),"getContainer",(function(){if(!t.portalContainer){var e=(0,t.props.getDocument)(t.getRootDomNode()).createElement("div");e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",t.portalContainer=e}return t.attachParent(t.portalContainer),t.portalContainer})),sL(EL(t),"setPoint",(function(e){!t.props.alignPoint||!e||t.setState({point:{pageX:e.pageX,pageY:e.pageY}})})),sL(EL(t),"handlePortalUpdate",(function(){t.state.prevPopupVisible!==t.state.popupVisible&&t.props.afterPopupVisibleChange(t.state.popupVisible)})),sL(EL(t),"triggerContextValue",{onPopupMouseDown:t.onPopupMouseDown}),i="popupVisible"in e?!!e.popupVisible:!!e.defaultPopupVisible,t.state={prevPopupVisible:i,popupVisible:i},$Y.forEach((function(e){t["fire".concat(e)]=function(r){t.fireEvents(e,r)}})),t}return CL(n,[{key:"componentDidMount",value:function(){this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){var e,t=this.props;if(this.state.popupVisible)return!this.clickOutsideHandler&&(this.isClickToHide()||this.isContextMenuToShow())&&(e=t.getDocument(this.getRootDomNode()),this.clickOutsideHandler=WK(e,"mousedown",this.onDocumentClick)),this.touchOutsideHandler||(e=e||t.getDocument(this.getRootDomNode()),this.touchOutsideHandler=WK(e,"touchstart",this.onDocumentClick)),!this.contextMenuOutsideHandler1&&this.isContextMenuToShow()&&(e=e||t.getDocument(this.getRootDomNode()),this.contextMenuOutsideHandler1=WK(e,"scroll",this.onContextMenuClose)),void(!this.contextMenuOutsideHandler2&&this.isContextMenuToShow()&&(this.contextMenuOutsideHandler2=WK(window,"blur",this.onContextMenuClose)));this.clearOutsideHandler()}},{key:"componentWillUnmount",value:function(){this.clearDelayTimer(),this.clearOutsideHandler(),clearTimeout(this.mouseDownTimeout),ez.cancel(this.attachId)}},{key:"getPopupDomNode",value:function(){var e;return(null===(e=this.popupRef.current)||void 0===e?void 0:e.getElement())||null}},{key:"getPopupAlign",value:function(){var e=this.props,t=e.popupPlacement,r=e.popupAlign,n=e.builtinPlacements;return t&&n?function(e,t,r){return hL(hL({},e[t]||{}),r)}(n,t,r):r}},{key:"setPopupVisible",value:function(e,t){var r=this.props.alignPoint,n=this.state.popupVisible;this.clearDelayTimer(),n!==e&&("popupVisible"in this.props||this.setState({popupVisible:e,prevPopupVisible:n}),this.props.onPopupVisibleChange(e)),r&&t&&e&&this.setPoint(t)}},{key:"delaySetPopupVisible",value:function(e,t,r){var n=this,i=1e3*t;if(this.clearDelayTimer(),i){var o=r?{pageX:r.pageX,pageY:r.pageY}:null;this.delayTimer=window.setTimeout((function(){n.setPopupVisible(e,o),n.clearDelayTimer()}),i)}else this.setPopupVisible(e,r)}},{key:"clearDelayTimer",value:function(){this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null)}},{key:"clearOutsideHandler",value:function(){this.clickOutsideHandler&&(this.clickOutsideHandler.remove(),this.clickOutsideHandler=null),this.contextMenuOutsideHandler1&&(this.contextMenuOutsideHandler1.remove(),this.contextMenuOutsideHandler1=null),this.contextMenuOutsideHandler2&&(this.contextMenuOutsideHandler2.remove(),this.contextMenuOutsideHandler2=null),this.touchOutsideHandler&&(this.touchOutsideHandler.remove(),this.touchOutsideHandler=null)}},{key:"createTwoChains",value:function(e){var t=this.props.children.props,r=this.props;return t[e]&&r[e]?this["fire".concat(e)]:t[e]||r[e]}},{key:"isClickToShow",value:function(){var e=this.props,t=e.action,r=e.showAction;return-1!==t.indexOf("click")||-1!==r.indexOf("click")}},{key:"isContextMenuOnly",value:function(){var e=this.props.action;return"contextMenu"===e||1===e.length&&"contextMenu"===e[0]}},{key:"isContextMenuToShow",value:function(){var e=this.props,t=e.action,r=e.showAction;return-1!==t.indexOf("contextMenu")||-1!==r.indexOf("contextMenu")}},{key:"isClickToHide",value:function(){var e=this.props,t=e.action,r=e.hideAction;return-1!==t.indexOf("click")||-1!==r.indexOf("click")}},{key:"isMouseEnterToShow",value:function(){var e=this.props,t=e.action,r=e.showAction;return-1!==t.indexOf("hover")||-1!==r.indexOf("mouseEnter")}},{key:"isMouseLeaveToHide",value:function(){var e=this.props,t=e.action,r=e.hideAction;return-1!==t.indexOf("hover")||-1!==r.indexOf("mouseLeave")}},{key:"isFocusToShow",value:function(){var e=this.props,t=e.action,r=e.showAction;return-1!==t.indexOf("focus")||-1!==r.indexOf("focus")}},{key:"isBlurToHide",value:function(){var e=this.props,t=e.action,r=e.hideAction;return-1!==t.indexOf("focus")||-1!==r.indexOf("blur")}},{key:"forcePopupAlign",value:function(){var e;this.state.popupVisible&&(null===(e=this.popupRef.current)||void 0===e||e.forceAlign())}},{key:"fireEvents",value:function(e,t){var r=this.props.children.props[e];r&&r(t);var n=this.props[e];n&&n(t)}},{key:"close",value:function(){this.setPopupVisible(!1)}},{key:"render",value:function(){var t=this.state.popupVisible,r=this.props,n=r.children,i=r.forceRender,o=r.alignPoint,s=r.className,l=r.autoDestroy,c=a.Children.only(n),u={key:"trigger"};this.isContextMenuToShow()?u.onContextMenu=this.onContextMenu:u.onContextMenu=this.createTwoChains("onContextMenu"),this.isClickToHide()||this.isClickToShow()?(u.onClick=this.onClick,u.onMouseDown=this.onMouseDown,u.onTouchStart=this.onTouchStart):(u.onClick=this.createTwoChains("onClick"),u.onMouseDown=this.createTwoChains("onMouseDown"),u.onTouchStart=this.createTwoChains("onTouchStart")),this.isMouseEnterToShow()?(u.onMouseEnter=this.onMouseEnter,o&&(u.onMouseMove=this.onMouseMove)):u.onMouseEnter=this.createTwoChains("onMouseEnter"),this.isMouseLeaveToHide()?u.onMouseLeave=this.onMouseLeave:u.onMouseLeave=this.createTwoChains("onMouseLeave"),this.isFocusToShow()||this.isBlurToHide()?(u.onFocus=this.onFocus,u.onBlur=this.onBlur):(u.onFocus=this.createTwoChains("onFocus"),u.onBlur=this.createTwoChains("onBlur"));var d=GA(c&&c.props&&c.props.className,s);d&&(u.className=d);var f=hL({},u);wB(c)&&(f.ref=yB(this.triggerRef,c.ref));var p,h=a.cloneElement(c,f);return(t||this.popupRef.current||i)&&(p=a.createElement(e,{key:"portal",getContainer:this.getContainer,didUpdate:this.handlePortalUpdate},this.getComponent())),!t&&l&&(p=null),a.createElement(DY.Provider,{value:this.triggerContextValue},h,p)}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r=e.popupVisible,n={};return void 0!==r&&t.popupVisible!==r&&(n.popupVisible=r,n.prevPopupVisible=t.popupVisible),n}}]),n}(a.Component);return sL(t,"contextType",DY),sL(t,"defaultProps",{prefixCls:"rc-trigger-popup",getPopupClassNameFromAlign:VY,getDocument:LY,onPopupVisibleChange:FY,afterPopupVisibleChange:FY,onPopupAlign:FY,popupClassName:"",mouseEnterDelay:0,mouseLeaveDelay:.1,focusDelay:0,blurDelay:.15,popupStyle:{},destroyPopupOnHide:!1,popupAlign:{},defaultPopupVisible:!1,mask:!1,maskClosable:!0,action:[],showAction:[],hideAction:[],autoDestroy:!1}),t}(GK);var zY={bottomLeft:{points:["tl","bl"],offset:[0,4],overflow:{adjustX:1,adjustY:1}},bottomRight:{points:["tr","br"],offset:[0,4],overflow:{adjustX:1,adjustY:1}},topLeft:{points:["bl","tl"],offset:[0,-4],overflow:{adjustX:0,adjustY:1}},topRight:{points:["br","tr"],offset:[0,-4],overflow:{adjustX:0,adjustY:1}}};function UY(e){var t,r=e.prefixCls,n=e.popupElement,i=e.popupStyle,o=e.visible,s=e.dropdownClassName,l=e.dropdownAlign,c=e.transitionName,u=e.getPopupContainer,d=e.children,f=e.range,p=e.popupPlacement,h=e.direction,m="".concat(r,"-dropdown");return a.createElement(BY,{showAction:[],hideAction:[],popupPlacement:void 0!==p?p:"rtl"===h?"bottomRight":"bottomLeft",builtinPlacements:zY,prefixCls:m,popupTransitionName:c,popup:n,popupAlign:l,popupVisible:o,popupClassName:GA(s,(t={},sL(t,"".concat(m,"-range"),f),sL(t,"".concat(m,"-rtl"),"rtl"===h),t)),popupStyle:i,getPopupContainer:u},d)}function HY(e){var t=e.open,r=e.value,n=e.isClickOutside,i=e.triggerOpen,o=e.forwardKeyDown,s=e.onKeyDown,l=e.blurToCancel,c=e.onSubmit,u=e.onCancel,d=e.onFocus,f=e.onBlur,p=fL(Object(a.useState)(!1),2),h=p[0],m=p[1],v=fL(Object(a.useState)(!1),2),g=v[0],y=v[1],b=Object(a.useRef)(!1),w=Object(a.useRef)(!1),_=Object(a.useRef)(!1),C={onMouseDown:function(){m(!0),i(!0)},onKeyDown:function(e){if(s(e,(function(){_.current=!0})),!_.current){switch(e.which){case wG.ENTER:return t?!1!==c()&&m(!0):i(!0),void e.preventDefault();case wG.TAB:return void(h&&t&&!e.shiftKey?(m(!1),e.preventDefault()):!h&&t&&!o(e)&&e.shiftKey&&(m(!0),e.preventDefault()));case wG.ESC:return m(!0),void u()}t||[wG.SHIFT].includes(e.which)?h||o(e):i(!0)}},onFocus:function(e){m(!0),y(!0),d&&d(e)},onBlur:function(e){!b.current&&n(document.activeElement)?(l?setTimeout((function(){for(var e=document.activeElement;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;n(e)&&u()}),0):t&&(i(!1),w.current&&c()),y(!1),f&&f(e)):b.current=!1}};return Object(a.useEffect)((function(){w.current=!1}),[t]),Object(a.useEffect)((function(){w.current=!0}),[r]),Object(a.useEffect)((function(){return function(e){return!VG&&typeof window<"u"&&window.addEventListener&&(VG=function(e){bL(LG).forEach((function(t){t(e)}))},window.addEventListener("mousedown",VG)),LG.add(e),function(){LG.delete(e),0===LG.size&&(window.removeEventListener("mousedown",VG),VG=null)}}((function(e){var r=function(e){var t,r=e.target;return e.composed&&r.shadowRoot&&(null===(t=e.composedPath)||void 0===t?void 0:t.call(e)[0])||r}(e);if(t){var o=n(r);o?(!g||o)&&i(!1):(b.current=!0,requestAnimationFrame((function(){b.current=!1})))}}))})),[C,{focused:g,typing:h}]}function WY(e){var t=e.valueTexts,r=e.onTextChange,n=fL(a.useState(""),2),i=n[0],o=n[1],s=a.useRef([]);function l(){o(s.current[0])}return s.current=t,a.useEffect((function(){t.every((function(e){return e!==i}))&&l()}),[t.join("||")]),[i,function(e){o(e),r(e)},l]}var GY=function(e,t,r,n){var i=r?r.call(n,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var o=Object.keys(e),a=Object.keys(t);if(o.length!==a.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),l=0;l<o.length;l++){var c=o[l];if(!s(c))return!1;var u=e[c],d=t[c];if(!1===(i=r?r.call(n,u,d,c):void 0)||void 0===i&&u!==d)return!1}return!0};function KY(e,t){var r=t.formatList,n=t.generateConfig,i=t.locale;return X$((function(){if(!e)return[[""],""];for(var t="",o=[],a=0;a<r.length;a+=1){var s=r[a],l=rK(e,{generateConfig:n,locale:i,format:s});o.push(l),0===a&&(t=l)}return[o,t]}),[e,r],(function(e,t){return e[0]!==t[0]||!GY(e[1],t[1])}))}function qY(e,t){var r=t.formatList,n=t.generateConfig,i=t.locale,o=fL(Object(a.useState)(null),2),s=o[0],l=o[1],c=Object(a.useRef)(null);function u(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];cancelAnimationFrame(c.current),t?l(e):c.current=requestAnimationFrame((function(){l(e)}))}var d=fL(KY(s,{formatList:r,generateConfig:n,locale:i}),2)[1];function f(){u(null,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}return Object(a.useEffect)((function(){f(!0)}),[e]),Object(a.useEffect)((function(){return function(){return cancelAnimationFrame(c.current)}}),[]),[d,function(e){u(e)},f]}function YY(e){var t,r=e.prefixCls,n=void 0===r?"rc-picker":r,i=e.id,o=e.tabIndex,s=e.style,l=e.className,c=e.dropdownClassName,u=e.dropdownAlign,d=e.popupStyle,f=e.transitionName,p=e.generateConfig,h=e.locale,m=e.inputReadOnly,v=e.allowClear,g=e.autoFocus,y=e.showTime,b=e.picker,w=void 0===b?"date":b,_=e.format,C=e.use12Hours,E=e.value,x=e.defaultValue,S=e.open,k=e.defaultOpen,O=e.defaultOpenValue,I=e.suffixIcon,R=e.clearIcon,T=e.disabled,A=e.disabledDate,N=e.placeholder,M=e.getPopupContainer,P=e.pickerRef,j=e.panelRender,D=e.onChange,F=e.onOpenChange,V=e.onFocus,L=e.onBlur,$=e.onMouseDown,B=e.onMouseUp,z=e.onMouseEnter,U=e.onMouseLeave,H=e.onContextMenu,W=e.onClick,G=e.onKeyDown,K=e.onSelect,q=e.direction,Y=e.autoComplete,X=void 0===Y?"off":Y,Z=a.useRef(null),J="date"===w&&!!y||"time"===w,Q=lK(DG(_,w,y,C)),ee=a.useRef(null),te=a.useRef(null),re=a.useRef(null),ne=fL(bG(null,{value:E,defaultValue:x}),2),ie=ne[0],oe=ne[1],ae=fL(a.useState(ie),2),se=ae[0],le=ae[1],ce=a.useRef(null),ue=fL(bG(!1,{value:S,defaultValue:k,postState:function(e){return!T&&e},onChange:function(e){F&&F(e),!e&&ce.current&&ce.current.onClose&&ce.current.onClose()}}),2),de=ue[0],fe=ue[1],pe=fL(KY(se,{formatList:Q,generateConfig:p,locale:h}),2),he=pe[0],me=pe[1],ve=fL(WY({valueTexts:he,onTextChange:function(e){var t=nK(e,{locale:h,formatList:Q,generateConfig:p});t&&(!A||!A(t))&&le(t)}}),3),ge=ve[0],ye=ve[1],be=ve[2],we=function(e){le(e),oe(e),D&&!QG(p,ie,e)&&D(e,e?rK(e,{generateConfig:p,locale:h,format:Q[0]}):"")},_e=function(e){T&&e||fe(e)},Ce=fL(HY({blurToCancel:J,open:de,value:ge,triggerOpen:_e,forwardKeyDown:function(e){return de&&ce.current&&ce.current.onKeyDown?ce.current.onKeyDown(e):(jL(!1,"Picker not correct forward KeyDown operation. Please help to fire issue about this."),!1)},isClickOutside:function(e){return!BG([ee.current,te.current,re.current],e)},onSubmit:function(){return!(!se||A&&A(se))&&(we(se),_e(!1),be(),!0)},onCancel:function(){_e(!1),le(ie),be()},onKeyDown:function(e,t){null==G||G(e,t)},onFocus:V,onBlur:L}),2),Ee=Ce[0],xe=Ce[1],Se=xe.focused,ke=xe.typing;a.useEffect((function(){de||(le(ie),he.length&&""!==he[0]?me!==ge&&be():ye(""))}),[de,he]),a.useEffect((function(){de||be()}),[w]),a.useEffect((function(){le(ie)}),[ie]),P&&(P.current={focus:function(){Z.current&&Z.current.focus()},blur:function(){Z.current&&Z.current.blur()}});var Oe=fL(qY(ge,{formatList:Q,generateConfig:p,locale:h}),3),Ie=Oe[0],Re=Oe[1],Te=Oe[2],Ae=hL(hL({},e),{},{className:void 0,style:void 0,pickerValue:void 0,onPickerValueChange:void 0,onChange:null}),Ne=a.createElement(HK,iL({},Ae,{generateConfig:p,className:GA(sL({},"".concat(n,"-panel-focused"),!ke)),value:se,locale:h,tabIndex:-1,onSelect:function(e){null==K||K(e),le(e)},direction:q,onPanelChange:function(t,r){var n=e.onPanelChange;Te(!0),null==n||n(t,r)}}));j&&(Ne=j(Ne));var Me,Pe,je=a.createElement("div",{className:"".concat(n,"-panel-container"),onMouseDown:function(e){e.preventDefault()}},Ne);I&&(Me=a.createElement("span",{className:"".concat(n,"-suffix")},I)),v&&ie&&!T&&(Pe=a.createElement("span",{onMouseDown:function(e){e.preventDefault(),e.stopPropagation()},onMouseUp:function(e){e.preventDefault(),e.stopPropagation(),we(null),_e(!1)},className:"".concat(n,"-clear"),role:"button"},R||a.createElement("span",{className:"".concat(n,"-clear-btn")}))),"production"!==Ti.exports.env.NODE_ENV&&jL(!O,"`defaultOpenValue` may confuse user for the current value status. Please use `defaultValue` instead.");var De="rtl"===q?"bottomRight":"bottomLeft";return a.createElement(_G.Provider,{value:{operationRef:ce,hideHeader:"time"===w,panelRef:ee,onSelect:function(e,t){("submit"===t||"key"!==t&&!J)&&(we(e),_e(!1))},open:de,defaultOpenValue:O,onDateMouseEnter:Re,onDateMouseLeave:Te}},a.createElement(UY,{visible:de,popupElement:je,popupStyle:d,prefixCls:n,dropdownClassName:c,dropdownAlign:u,getPopupContainer:M,transitionName:f,popupPlacement:De,direction:q},a.createElement("div",{ref:re,className:GA(n,l,(t={},sL(t,"".concat(n,"-disabled"),T),sL(t,"".concat(n,"-focused"),Se),sL(t,"".concat(n,"-rtl"),"rtl"===q),t)),style:s,onMouseDown:$,onMouseUp:function(){B&&B.apply(void 0,arguments),Z.current&&(Z.current.focus(),_e(!0))},onMouseEnter:z,onMouseLeave:U,onContextMenu:H,onClick:W},a.createElement("div",{className:GA("".concat(n,"-input"),sL({},"".concat(n,"-input-placeholder"),!!Ie)),ref:te},a.createElement("input",iL({id:i,tabIndex:o,disabled:T,readOnly:m||"function"==typeof Q[0]||!ke,value:Ie||ge,onChange:function(e){ye(e.target.value)},autoFocus:g,placeholder:N,ref:Z,title:ge},Ee,{size:FG(w,Q[0],p)},cK(e),{autoComplete:X})),Me,Pe))))}var XY=function(e){SL(r,e);var t=OL(r);function r(){var e;wL(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).pickerRef=a.createRef(),e.focus=function(){e.pickerRef.current&&e.pickerRef.current.focus()},e.blur=function(){e.pickerRef.current&&e.pickerRef.current.blur()},e}return CL(r,[{key:"render",value:function(){return a.createElement(YY,iL({},this.props,{pickerRef:this.pickerRef}))}}]),r}(a.Component);function ZY(e,t,r,n){var i=tK(e,r,n,1);function o(r){return r(e,t)?"same":r(i,t)?"closing":"far"}switch(r){case"year":return o((function(e,t){return function(e,t,r){var n=GG(t,r);return"boolean"==typeof n?n:Math.floor(e.getYear(t)/10)===Math.floor(e.getYear(r)/10)}(n,e,t)}));case"quarter":case"month":return o((function(e,t){return KG(n,e,t)}));default:return o((function(e,t){return XG(n,e,t)}))}}function JY(e){var t=e.values,r=e.picker,n=e.defaultDates,i=e.generateConfig,o=fL(a.useState((function(){return[uK(n,0),uK(n,1)]})),2),s=o[0],l=o[1],c=fL(a.useState(null),2),u=c[0],d=c[1],f=uK(t,0),p=uK(t,1);return[function(e){return s[e]?s[e]:uK(u,e)||function(e,t,r,n){var i=uK(e,0),o=uK(e,1);if(0===t)return i;if(i&&o)switch(ZY(i,o,r,n)){case"same":case"closing":return i;default:return tK(o,r,n,-1)}return i}(t,e,r,i)||f||p||i.getNow()},function(e,r){if(e){var n=dK(u,e,r);l(dK(s,null,r)||[null,null]);var i=(r+1)%2;uK(t,i)||(n=dK(n,e,i)),d(n)}else(f||p)&&d(null)}]}function QY(e,t){return e&&e[0]&&e[1]&&t.isAfter(e[0],e[1])?[e[1],e[0]]:e}function eX(e,t,r,n){return!!(e||n&&n[t]||r[(t+1)%2])}function tX(e){var t,r,n,i=e.prefixCls,o=void 0===i?"rc-picker":i,s=e.id,l=e.style,c=e.className,u=e.popupStyle,d=e.dropdownClassName,f=e.transitionName,p=e.dropdownAlign,h=e.getPopupContainer,m=e.generateConfig,v=e.locale,g=e.placeholder,y=e.autoFocus,b=e.disabled,w=e.format,_=e.picker,C=void 0===_?"date":_,E=e.showTime,x=e.use12Hours,S=e.separator,k=void 0===S?"~":S,O=e.value,I=e.defaultValue,R=e.defaultPickerValue,T=e.open,A=e.defaultOpen,N=e.disabledDate,M=e.disabledTime,P=e.dateRender,j=e.panelRender,D=e.ranges,F=e.allowEmpty,V=e.allowClear,L=e.suffixIcon,$=e.clearIcon,B=e.pickerRef,z=e.inputReadOnly,U=e.mode,H=e.renderExtraFooter,W=e.onChange,G=e.onOpenChange,K=e.onPanelChange,q=e.onCalendarChange,Y=e.onFocus,X=e.onBlur,Z=e.onMouseEnter,J=e.onMouseLeave,Q=e.onOk,ee=e.onKeyDown,te=e.components,re=e.order,ne=e.direction,ie=e.activePickerIndex,oe=e.autoComplete,ae=void 0===oe?"off":oe,se="date"===C&&!!E||"time"===C,le=Object(a.useRef)({}),ce=Object(a.useRef)(null),ue=Object(a.useRef)(null),de=Object(a.useRef)(null),fe=Object(a.useRef)(null),pe=Object(a.useRef)(null),he=Object(a.useRef)(null),me=Object(a.useRef)(null),ve=lK(DG(w,C,E,x)),ge=fL(bG(0,{value:ie}),2),ye=ge[0],be=ge[1],we=Object(a.useRef)(null),_e=a.useMemo((function(){return Array.isArray(b)?b:[b||!1,b||!1]}),[b]),Ce=fL(bG(null,{value:O,defaultValue:I,postState:function(e){return"time"!==C||re?QY(e,m):e}}),2),Ee=Ce[0],xe=Ce[1],Se=fL(JY({values:Ee,picker:C,defaultDates:R,generateConfig:m}),2),ke=Se[0],Oe=Se[1],Ie=fL(bG(Ee,{postState:function(e){var t=e;if(_e[0]&&_e[1])return t;for(var r=0;r<2;r+=1)_e[r]&&!uK(t,r)&&!uK(F,r)&&(t=dK(t,m.getNow(),r));return t}}),2),Re=Ie[0],Te=Ie[1],Ae=fL(bG([C,C],{value:U}),2),Ne=Ae[0],Me=Ae[1];Object(a.useEffect)((function(){Me([C,C])}),[C]);var Pe=function(e,t){Me(e),K&&K(t,e)},je=function(e,t,r){var n=e.picker,i=e.locale,o=e.selectedValue,s=e.disabledDate,l=e.disabled,c=e.generateConfig,u=uK(o,0),d=uK(o,1);function f(e){return c.locale.getWeekFirstDate(i.locale,e)}function p(e){return 100*c.getYear(e)+c.getMonth(e)}function h(e){return 10*c.getYear(e)+qG(c,e)}return[a.useCallback((function(e){if(s&&s(e))return!0;if(l[1]&&d)return!ZG(c,e,d)&&c.isAfter(e,d);if(t&&d)switch(n){case"quarter":return h(e)>h(d);case"month":return p(e)>p(d);case"week":return f(e)>f(d);default:return!ZG(c,e,d)&&c.isAfter(e,d)}return!1}),[s,l[1],d,t]),a.useCallback((function(e){if(s&&s(e))return!0;if(l[0]&&u)return!ZG(c,e,d)&&c.isAfter(u,e);if(r&&u)switch(n){case"quarter":return h(e)<h(u);case"month":return p(e)<p(u);case"week":return f(e)<f(u);default:return!ZG(c,e,u)&&c.isAfter(u,e)}return!1}),[s,l[0],u,r])]}({picker:C,selectedValue:Re,locale:v,disabled:_e,disabledDate:N,generateConfig:m},le.current[1],le.current[0]),De=fL(je,2),Fe=De[0],Ve=De[1],Le=fL(bG(!1,{value:T,defaultValue:A,postState:function(e){return!_e[ye]&&e},onChange:function(e){G&&G(e),!e&&we.current&&we.current.onClose&&we.current.onClose()}}),2),$e=Le[0],Be=Le[1],ze=$e&&0===ye,Ue=$e&&1===ye,He=fL(Object(a.useState)(0),2),We=He[0],Ge=He[1];Object(a.useEffect)((function(){!$e&&ce.current&&Ge(ce.current.offsetWidth)}),[$e]);var Ke=a.useRef();function qe(e,t){if(e)clearTimeout(Ke.current),le.current[t]=!0,be(t),Be(e),$e||Oe(null,t);else if(ye===t){Be(e);var r=le.current;Ke.current=setTimeout((function(){r===le.current&&(le.current={})}))}}function Ye(e){qe(!0,e),setTimeout((function(){var t=[he,me][e];t.current&&t.current.focus()}),0)}function Xe(e,t){var r=e,n=uK(r,0),i=uK(r,1);n&&i&&m.isAfter(n,i)&&("week"===C&&!JG(m,v.locale,n,i)||"quarter"===C&&!YG(m,n,i)||"week"!==C&&"quarter"!==C&&"time"!==C&&!ZG(m,n,i)?(0===t?(r=[n,null],i=null):(n=null,r=[null,i]),le.current=sL({},t,!0)):("time"!==C||!1!==re)&&(r=QY(r,m))),Te(r);var o=r&&r[0]?rK(r[0],{generateConfig:m,locale:v,format:ve[0]}):"",a=r&&r[1]?rK(r[1],{generateConfig:m,locale:v,format:ve[0]}):"";q&&q(r,[o,a],{range:0===t?"start":"end"});var s=eX(n,0,_e,F),l=eX(i,1,_e,F);(null===r||s&&l)&&(xe(r),W&&(!QG(m,uK(Ee,0),n)||!QG(m,uK(Ee,1),i))&&W(r,[o,a]));var c=null;0!==t||_e[1]?1===t&&!_e[0]&&(c=0):c=1,null===c||c===ye||le.current[c]&&uK(r,c)||!uK(r,t)?qe(!1,t):Ye(c)}var Ze=function(e){return $e&&we.current&&we.current.onKeyDown?we.current.onKeyDown(e):(jL(!1,"Picker not correct forward KeyDown operation. Please help to fire issue about this."),!1)},Je={formatList:ve,generateConfig:m,locale:v},Qe=fL(KY(uK(Re,0),Je),2),et=Qe[0],tt=Qe[1],rt=fL(KY(uK(Re,1),Je),2),nt=rt[0],it=rt[1],ot=function(e,t){var r=nK(e,{locale:v,formatList:ve,generateConfig:m});r&&!(0===t?Fe:Ve)(r)&&(Te(dK(Re,r,t)),Oe(r,t))},at=fL(WY({valueTexts:et,onTextChange:function(e){return ot(e,0)}}),3),st=at[0],lt=at[1],ct=at[2],ut=fL(WY({valueTexts:nt,onTextChange:function(e){return ot(e,1)}}),3),dt=ut[0],ft=ut[1],pt=ut[2],ht=fL(Object(a.useState)(null),2),mt=ht[0],vt=ht[1],gt=fL(Object(a.useState)(null),2),yt=gt[0],bt=gt[1],wt=fL(qY(st,{formatList:ve,generateConfig:m,locale:v}),3),_t=wt[0],Ct=wt[1],Et=wt[2],xt=fL(qY(dt,{formatList:ve,generateConfig:m,locale:v}),3),St=xt[0],kt=xt[1],Ot=xt[2],It=function(e,t){return{blurToCancel:se,forwardKeyDown:Ze,onBlur:X,isClickOutside:function(e){return!BG([ue.current,de.current,fe.current,ce.current],e)},onFocus:function(t){be(e),Y&&Y(t)},triggerOpen:function(t){qe(t,e)},onSubmit:function(){Xe(Re,e),t()},onCancel:function(){qe(!1,e),Te(Ee),t()}}},Rt=fL(HY(hL(hL({},It(0,ct)),{},{open:ze,value:st,onKeyDown:function(e,t){null==ee||ee(e,t)}})),2),Tt=Rt[0],At=Rt[1],Nt=At.focused,Mt=At.typing,Pt=fL(HY(hL(hL({},It(1,pt)),{},{open:Ue,value:dt,onKeyDown:function(e,t){null==ee||ee(e,t)}})),2),jt=Pt[0],Dt=Pt[1],Ft=Dt.focused,Vt=Dt.typing,Lt=Ee&&Ee[0]?rK(Ee[0],{locale:v,format:"YYYYMMDDHHmmss",generateConfig:m}):"",$t=Ee&&Ee[1]?rK(Ee[1],{locale:v,format:"YYYYMMDDHHmmss",generateConfig:m}):"";Object(a.useEffect)((function(){$e||(Te(Ee),et.length&&""!==et[0]?tt!==st&&ct():lt(""),nt.length&&""!==nt[0]?it!==dt&&pt():ft(""))}),[$e,et,nt]),Object(a.useEffect)((function(){Te(Ee)}),[Lt,$t]),"production"!==Ti.exports.env.NODE_ENV&&O&&Array.isArray(b)&&(uK(b,0)&&!uK(O,0)||uK(b,1)&&!uK(O,1))&&jL(!1,"`disabled` should not set with empty `value`. You should set `allowEmpty` or `value` instead."),B&&(B.current={focus:function(){he.current&&he.current.focus()},blur:function(){he.current&&he.current.blur(),me.current&&me.current.blur()}});var Bt=Object.keys(D||{}).map((function(e){var t=D[e],r="function"==typeof t?t():t;return{label:e,onClick:function(){Xe(r,null),qe(!1,ye)},onMouseEnter:function(){vt(r)},onMouseLeave:function(){vt(null)}}}));function zt(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null;$e&&yt&&yt[0]&&yt[1]&&m.isAfter(yt[1],yt[0])&&(n=yt);var i=E;if(E&&"object"===oL(E)&&E.defaultValue){var s=E.defaultValue;i=hL(hL({},E),{},{defaultValue:uK(s,ye)||void 0})}var l=null;return P&&(l=function(e,t){return P(e,t,{range:ye?"end":"start"})}),a.createElement(gK.Provider,{value:{inRange:!0,panelPosition:t,rangedValue:mt||Re,hoverRangedValue:n}},a.createElement(HK,iL({},e,r,{dateRender:l,showTime:i,mode:Ne[ye],generateConfig:m,style:void 0,direction:ne,disabledDate:0===ye?Fe:Ve,disabledTime:function(e){return!!M&&M(e,0===ye?"start":"end")},className:GA(sL({},"".concat(o,"-panel-focused"),0===ye?!Mt:!Vt)),value:uK(Re,ye),locale:v,tabIndex:-1,onPanelChange:function(e,r){0===ye&&Et(!0),1===ye&&Ot(!0),Pe(dK(Ne,r,ye),dK(Re,e,ye));var n=e;"right"===t&&Ne[ye]===r&&(n=tK(n,r,m,-1)),Oe(n,ye)},onOk:null,onSelect:void 0,onChange:void 0,defaultValue:uK(Re,0===ye?1:0)})))}var Ut=0,Ht=0;ye&&de.current&&pe.current&&ue.current&&(Ut=de.current.offsetWidth+pe.current.offsetWidth,ue.current.offsetWidth&&Ut>ue.current.offsetWidth&&(Ht=Ut));var Wt="rtl"===ne?{right:Ut}:{left:Ut};var Gt,Kt,qt=a.createElement("div",{className:GA("".concat(o,"-range-wrapper"),"".concat(o,"-").concat(C,"-range-wrapper")),style:{minWidth:We}},a.createElement("div",{className:"".concat(o,"-range-arrow"),style:Wt}),function(){var e,t=zK(o,Ne[ye],H),r=UK({prefixCls:o,components:te,needConfirmButton:se,okDisabled:!uK(Re,ye)||N&&N(Re[ye]),locale:v,rangeList:Bt,onOk:function(){uK(Re,ye)&&(Xe(Re,ye),Q&&Q(Re))}});if("time"===C||E)e=zt();else{var n=ke(ye),i=tK(n,C,m),s=Ne[ye]===C,l=zt(!!s&&"left",{pickerValue:n,onPickerValueChange:function(e){Oe(e,ye)}}),c=zt("right",{pickerValue:i,onPickerValueChange:function(e){Oe(tK(e,C,m,-1),ye)}});e="rtl"===ne?a.createElement(a.Fragment,null,c,s&&l):a.createElement(a.Fragment,null,l,s&&c)}var u=a.createElement(a.Fragment,null,a.createElement("div",{className:"".concat(o,"-panels")},e),(t||r)&&a.createElement("div",{className:"".concat(o,"-footer")},t,r));return j&&(u=j(u)),a.createElement("div",{className:"".concat(o,"-panel-container"),style:{marginLeft:Ht},ref:ue,onMouseDown:function(e){e.preventDefault()}},u)}());L&&(Gt=a.createElement("span",{className:"".concat(o,"-suffix")},L)),V&&(uK(Ee,0)&&!_e[0]||uK(Ee,1)&&!_e[1])&&(Kt=a.createElement("span",{onMouseDown:function(e){e.preventDefault(),e.stopPropagation()},onMouseUp:function(e){e.preventDefault(),e.stopPropagation();var t=Ee;_e[0]||(t=dK(t,null,0)),_e[1]||(t=dK(t,null,1)),Xe(t,null),qe(!1,ye)},className:"".concat(o,"-clear")},$||a.createElement("span",{className:"".concat(o,"-clear-btn")})));var Yt={size:FG(C,ve[0],m)},Xt=0,Zt=0;de.current&&fe.current&&pe.current&&(0===ye?Zt=de.current.offsetWidth:(Xt=Ut,Zt=fe.current.offsetWidth));var Jt="rtl"===ne?{right:Xt}:{left:Xt};return a.createElement(_G.Provider,{value:{operationRef:we,hideHeader:"time"===C,onDateMouseEnter:function(e){bt(dK(Re,e,ye)),0===ye?Ct(e):kt(e)},onDateMouseLeave:function(){bt(dK(Re,null,ye)),0===ye?Et():Ot()},hideRanges:!0,onSelect:function(e,t){var r=dK(Re,e,ye);"submit"===t||"key"!==t&&!se?(Xe(r,ye),0===ye?Et():Ot()):Te(r)},open:$e}},a.createElement(UY,{visible:$e,popupElement:qt,popupStyle:u,prefixCls:o,dropdownClassName:d,dropdownAlign:p,getPopupContainer:h,transitionName:f,range:!0,direction:ne},a.createElement("div",iL({ref:ce,className:GA(o,"".concat(o,"-range"),c,(t={},sL(t,"".concat(o,"-disabled"),_e[0]&&_e[1]),sL(t,"".concat(o,"-focused"),0===ye?Nt:Ft),sL(t,"".concat(o,"-rtl"),"rtl"===ne),t)),style:l,onClick:function(e){!$e&&!he.current.contains(e.target)&&!me.current.contains(e.target)&&(_e[0]?_e[1]||Ye(1):Ye(0))},onMouseEnter:Z,onMouseLeave:J,onMouseDown:function(e){$e&&(Nt||Ft)&&!he.current.contains(e.target)&&!me.current.contains(e.target)&&e.preventDefault()}},cK(e)),a.createElement("div",{className:GA("".concat(o,"-input"),(r={},sL(r,"".concat(o,"-input-active"),0===ye),sL(r,"".concat(o,"-input-placeholder"),!!_t),r)),ref:de},a.createElement("input",iL({id:s,disabled:_e[0],readOnly:z||"function"==typeof ve[0]||!Mt,value:_t||st,onChange:function(e){lt(e.target.value)},autoFocus:y,placeholder:uK(g,0)||"",ref:he},Tt,Yt,{autoComplete:ae}))),a.createElement("div",{className:"".concat(o,"-range-separator"),ref:pe},k),a.createElement("div",{className:GA("".concat(o,"-input"),(n={},sL(n,"".concat(o,"-input-active"),1===ye),sL(n,"".concat(o,"-input-placeholder"),!!St),n)),ref:fe},a.createElement("input",iL({disabled:_e[1],readOnly:z||"function"==typeof ve[0]||!Vt,value:St||dt,onChange:function(e){ft(e.target.value)},placeholder:uK(g,1)||"",ref:me},jt,Yt,{autoComplete:ae}))),a.createElement("div",{className:"".concat(o,"-active-bar"),style:hL(hL({},Jt),{},{width:Zt,position:"absolute"})}),Gt,Kt)))}var rX=function(e){SL(r,e);var t=OL(r);function r(){var e;wL(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).pickerRef=a.createRef(),e.focus=function(){e.pickerRef.current&&e.pickerRef.current.focus()},e.blur=function(){e.pickerRef.current&&e.pickerRef.current.blur()},e}return CL(r,[{key:"render",value:function(){return a.createElement(tX,iL({},this.props,{pickerRef:this.pickerRef}))}}]),r}(a.Component);function nX(e,t,r){return void 0!==r?r:"year"===e&&t.lang.yearPlaceholder?t.lang.yearPlaceholder:"quarter"===e&&t.lang.quarterPlaceholder?t.lang.quarterPlaceholder:"month"===e&&t.lang.monthPlaceholder?t.lang.monthPlaceholder:"week"===e&&t.lang.weekPlaceholder?t.lang.weekPlaceholder:"time"===e&&t.timePickerLocale.placeholder?t.timePickerLocale.placeholder:t.lang.placeholder}function iX(e,t,r){return void 0!==r?r:"year"===e&&t.lang.yearPlaceholder?t.lang.rangeYearPlaceholder:"month"===e&&t.lang.monthPlaceholder?t.lang.rangeMonthPlaceholder:"week"===e&&t.lang.weekPlaceholder?t.lang.rangeWeekPlaceholder:"time"===e&&t.timePickerLocale.placeholder?t.timePickerLocale.rangePlaceholder:t.lang.rangePlaceholder}var oX=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};const aX={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M873.1 596.2l-164-208A32 32 0 00684 376h-64.8c-6.7 0-10.4 7.7-6.3 13l144.3 183H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h695.9c26.8 0 41.7-30.8 25.2-51.8z"}}]},name:"swap-right",theme:"outlined"};var sX=function(e,t){return a.createElement(wW,hL(hL({},e),{},{ref:t,icon:aX}))};sX.displayName="SwapRightOutlined";const lX=a.forwardRef(sX);var cX=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};var uX={button:function(e){return a.createElement(ZW,iL({size:"small",type:"primary"},e))},rangeItem:function(e){return a.createElement(sG,iL({color:"blue"},e))}};function dX(e){var t=e.format,r=e.picker,n=e.showHour,i=e.showMinute,o=e.showSecond,a=e.use12Hours,s=function(e){return e?Array.isArray(e)?e:[e]:[]}(t)[0],l=iL({},e);return s&&"string"==typeof s&&(!s.includes("s")&&void 0===o&&(l.showSecond=!1),!s.includes("m")&&void 0===i&&(l.showMinute=!1),!s.includes("H")&&!s.includes("h")&&void 0===n&&(l.showHour=!1),(s.includes("a")||s.includes("A"))&&void 0===a&&(l.use12Hours=!0)),"time"===r?l:("function"==typeof s&&delete l.format,{showTime:l})}!function(e,t){e.exports=function(e){function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=t(e),n={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(e,t){return"W"===t?e+"周":e+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(e,t){var r=100*e+t;return r<600?"凌晨":r<900?"早上":r<1100?"上午":r<1300?"中午":r<1800?"下午":"晚上"}};return r.default.locale(n,null,!0),n}(Rd.exports)}({exports:{}});var fX,pX={},hX={},mX={};var vX,gX={},yX={exports:{}};function bX(){return vX||(vX=1,function(e){function t(){return e.exports=t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(this,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(yX)),yX.exports}var wX,_X={};var CX,EX,xX={};function SX(){return CX||(CX=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t={placeholder:"Select time",rangePlaceholder:["Start time","End time"]};e.default=t}(xX)),xX}function kX(){return EX||(EX=1,function(e){var t=OV.exports;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=t(bX()),n=t(function(){if(wX)return _X;wX=1,Object.defineProperty(_X,"__esModule",{value:!0}),_X.default=void 0;var e={locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"Ok",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"};return _X.default=e,_X}()),i=t(SX()),o={lang:(0,r.default)({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},n.default),timePickerLocale:(0,r.default)({},i.default)};e.default=o}(gX)),gX}var OX,IX,RX={};function TX(){return IX||(IX=1,function(e){var t=OV.exports;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=t((fX||(fX=1,Object.defineProperty(mX,"__esModule",{value:!0}),mX.default=void 0,mX.default={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"}),mX)),n=t(kX()),i=t(SX()),o=t((OX||(OX=1,function(e){var t=OV.exports;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=t(kX()).default;e.default=r}(RX)),RX)),a="${label} is not a valid ${type}",s={locale:"en",Pagination:r.default,DatePicker:n.default,TimePicker:i.default,Calendar:o.default,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No Data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand"},PageHeader:{back:"Back"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:a,method:a,array:a,object:a,number:a,date:a,boolean:a,integer:a,float:a,regexp:a,email:a,url:a,hex:a},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"}};e.default=s}(hX)),hX}!function(e){var t=OV.exports;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=t(TX()).default;e.default=r}(pX);const AX=Oi(pX);var NX,MX={},PX={};var jX,DX={},FX={};var VX,LX,$X={};function BX(){return VX||(VX=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t={placeholder:"请选择时间",rangePlaceholder:["开始时间","结束时间"]};e.default=t}($X)),$X}function zX(){return LX||(LX=1,function(e){var t=OV.exports;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=t(bX()),n=t(function(){if(jX)return FX;jX=1,Object.defineProperty(FX,"__esModule",{value:!0}),FX.default=void 0;var e={locale:"zh_CN",today:"今天",now:"此刻",backToToday:"返回今天",ok:"确定",timeSelect:"选择时间",dateSelect:"选择日期",weekSelect:"选择周",clear:"清除",month:"月",year:"年",previousMonth:"上个月 (翻页上键)",nextMonth:"下个月 (翻页下键)",monthSelect:"选择月份",yearSelect:"选择年份",decadeSelect:"选择年代",yearFormat:"YYYY年",dayFormat:"D日",dateFormat:"YYYY年M月D日",dateTimeFormat:"YYYY年M月D日 HH时mm分ss秒",previousYear:"上一年 (Control键加左方向键)",nextYear:"下一年 (Control键加右方向键)",previousDecade:"上一年代",nextDecade:"下一年代",previousCentury:"上一世纪",nextCentury:"下一世纪"};return FX.default=e,FX}()),i=t(BX()),o={lang:(0,r.default)({placeholder:"请选择日期",yearPlaceholder:"请选择年份",quarterPlaceholder:"请选择季度",monthPlaceholder:"请选择月份",weekPlaceholder:"请选择周",rangePlaceholder:["开始日期","结束日期"],rangeYearPlaceholder:["开始年份","结束年份"],rangeMonthPlaceholder:["开始月份","结束月份"],rangeWeekPlaceholder:["开始周","结束周"]},n.default),timePickerLocale:(0,r.default)({},i.default)};o.lang.ok="确 定";var a=o;e.default=a}(DX)),DX}var UX,HX={};!function(e){var t=OV.exports;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=t((NX||(NX=1,Object.defineProperty(PX,"__esModule",{value:!0}),PX.default=void 0,PX.default={items_per_page:"条/页",jump_to:"跳至",jump_to_confirm:"确定",page:"页",prev_page:"上一页",next_page:"下一页",prev_5:"向前 5 页",next_5:"向后 5 页",prev_3:"向前 3 页",next_3:"向后 3 页",page_size:"页码"}),PX)),n=t(zX()),i=t(BX()),o=t((UX||(UX=1,function(e){var t=OV.exports;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=t(zX()).default;e.default=r}(HX)),HX)),a="${label}不是一个有效的${type}",s={locale:"zh-cn",Pagination:r.default,DatePicker:n.default,TimePicker:i.default,Calendar:o.default,global:{placeholder:"请选择"},Table:{filterTitle:"筛选",filterConfirm:"确定",filterReset:"重置",filterEmptyText:"无筛选项",selectAll:"全选当页",selectInvert:"反选当页",selectNone:"清空所有",selectionAll:"全选所有",sortTitle:"排序",expand:"展开行",collapse:"关闭行",triggerDesc:"点击降序",triggerAsc:"点击升序",cancelSort:"取消排序"},Modal:{okText:"确定",cancelText:"取消",justOkText:"知道了"},Popconfirm:{cancelText:"取消",okText:"确定"},Transfer:{searchPlaceholder:"请输入搜索内容",itemUnit:"项",itemsUnit:"项",remove:"删除",selectCurrent:"全选当页",removeCurrent:"删除当页",selectAll:"全选所有",removeAll:"删除全部",selectInvert:"反选当页"},Upload:{uploading:"文件上传中",removeFile:"删除文件",uploadError:"上传错误",previewFile:"预览文件",downloadFile:"下载文件"},Empty:{description:"暂无数据"},Icon:{icon:"图标"},Text:{edit:"编辑",copy:"复制",copied:"复制成功",expand:"展开"},PageHeader:{back:"返回"},Form:{optional:"（可选）",defaultValidateMessages:{default:"字段验证错误${label}",required:"请输入${label}",enum:"${label}必须是其中一个[${enum}]",whitespace:"${label}不能为空字符",date:{format:"${label}日期格式无效",parse:"${label}不能转换为日期",invalid:"${label}是一个无效日期"},types:{string:a,method:a,array:a,object:a,number:a,date:a,boolean:a,integer:a,float:a,regexp:a,email:a,url:a,hex:a},string:{len:"${label}须为${len}个字符",min:"${label}最少${min}个字符",max:"${label}最多${max}个字符",range:"${label}须在${min}-${max}字符之间"},number:{len:"${label}必须等于${len}",min:"${label}最小值为${min}",max:"${label}最大值为${max}",range:"${label}须在${min}-${max}之间"},array:{len:"须为${len}个${label}",min:"最少${min}个${label}",max:"最多${max}个${label}",range:"${label}数量须在${min}-${max}之间"},pattern:{mismatch:"${label}与模式不匹配${pattern}"}}},Image:{preview:"预览"}};e.default=s}(MX);const WX=Oi(MX);var GX=NV();Td.extend(GX),Td.extend(PV);const KX=function(e){var t=function(e){function t(t,r){var n=function(n){SL(o,n);var i=OL(o);function o(n){var s;return wL(this,o),(s=i.call(this,n)).pickerRef=a.createRef(),s.focus=function(){s.pickerRef.current&&s.pickerRef.current.focus()},s.blur=function(){s.pickerRef.current&&s.pickerRef.current.blur()},s.renderPicker=function(r){var n=iL(iL({},r),s.props.locale),i=s.context,o=i.getPrefixCls,l=i.direction,c=i.getPopupContainer,u=s.props,d=u.prefixCls,f=u.getPopupContainer,p=u.className,h=u.size,m=u.bordered,v=void 0===m||m,g=u.placeholder,y=oX(u,["prefixCls","getPopupContainer","className","size","bordered","placeholder"]),b=s.props,w=b.format,_=b.showTime,C=o("picker",d),E={showToday:!0},x={};t&&(x.picker=t);var S=t||s.props.picker;x=iL(iL(iL({},x),_?dX(iL({format:w,picker:S},_)):{}),"time"===S?dX(iL(iL({format:w},s.props),{picker:S})):{});var k=o();return a.createElement(hB.Consumer,null,(function(t){var r,i=h||t;return a.createElement(XY,iL({ref:s.pickerRef,placeholder:nX(S,n,g),suffixIcon:"time"===S?a.createElement(pG,null):a.createElement(uG,null),clearIcon:a.createElement(SW,null),allowClear:!0,transitionName:"".concat(k,"-slide-up")},E,y,x,{locale:n.lang,className:GA((r={},sL(r,"".concat(C,"-").concat(i),i),sL(r,"".concat(C,"-borderless"),!v),r),p),prefixCls:C,getPopupContainer:f||c,generateConfig:e,prevIcon:a.createElement("span",{className:"".concat(C,"-prev-icon")}),nextIcon:a.createElement("span",{className:"".concat(C,"-next-icon")}),superPrevIcon:a.createElement("span",{className:"".concat(C,"-super-prev-icon")}),superNextIcon:a.createElement("span",{className:"".concat(C,"-super-next-icon")}),components:uX,direction:l}))}))},Z$("quarter"!==t,r,"DatePicker.".concat(r," is legacy usage. Please use DatePicker[picker='").concat(t,"'] directly.")),s}return CL(o,[{key:"render",value:function(){return a.createElement(nB,{componentName:"DatePicker",defaultLocale:Q$},this.renderPicker)}}]),o}(a.Component);return n.contextType=fB,r&&(n.displayName=r),n}return{DatePicker:t(),WeekPicker:t("week","WeekPicker"),MonthPicker:t("month","MonthPicker"),YearPicker:t("year","YearPicker"),TimePicker:t("time","TimePicker"),QuarterPicker:t("quarter","QuarterPicker")}}(e),r=t.DatePicker,n=t.WeekPicker,i=t.MonthPicker,o=t.YearPicker,s=t.TimePicker,l=t.QuarterPicker,c=function(e){var t=function(t){SL(n,t);var r=OL(n);function n(){var t;return wL(this,n),(t=r.apply(this,arguments)).pickerRef=a.createRef(),t.focus=function(){t.pickerRef.current&&t.pickerRef.current.focus()},t.blur=function(){t.pickerRef.current&&t.pickerRef.current.blur()},t.renderPicker=function(r){var n=iL(iL({},r),t.props.locale),i=t.context,o=i.getPrefixCls,s=i.direction,l=i.getPopupContainer,c=t.props,u=c.prefixCls,d=c.getPopupContainer,f=c.className,p=c.size,h=c.bordered,m=void 0===h||h,v=c.placeholder,g=cX(c,["prefixCls","getPopupContainer","className","size","bordered","placeholder"]),y=t.props,b=y.format,w=y.showTime,_=y.picker,C=o("picker",u),E={};E=iL(iL(iL({},E),w?dX(iL({format:b,picker:_},w)):{}),"time"===_?dX(iL(iL({format:b},t.props),{picker:_})):{});var x=o();return a.createElement(hB.Consumer,null,(function(r){var i,o=p||r;return a.createElement(rX,iL({separator:a.createElement("span",{"aria-label":"to",className:"".concat(C,"-separator")},a.createElement(lX,null)),ref:t.pickerRef,placeholder:iX(_,n,v),suffixIcon:"time"===_?a.createElement(pG,null):a.createElement(uG,null),clearIcon:a.createElement(SW,null),allowClear:!0,transitionName:"".concat(x,"-slide-up")},g,E,{className:GA((i={},sL(i,"".concat(C,"-").concat(o),o),sL(i,"".concat(C,"-borderless"),!m),i),f),locale:n.lang,prefixCls:C,getPopupContainer:d||l,generateConfig:e,prevIcon:a.createElement("span",{className:"".concat(C,"-prev-icon")}),nextIcon:a.createElement("span",{className:"".concat(C,"-next-icon")}),superPrevIcon:a.createElement("span",{className:"".concat(C,"-super-prev-icon")}),superNextIcon:a.createElement("span",{className:"".concat(C,"-super-next-icon")}),components:uX,direction:s}))}))},t}return CL(n,[{key:"render",value:function(){return a.createElement(nB,{componentName:"DatePicker",defaultLocale:Q$},this.renderPicker)}}]),n}(a.Component);return t.contextType=fB,t}(e),u=r;return u.WeekPicker=n,u.MonthPicker=i,u.YearPicker=o,u.RangePicker=c,u.TimePicker=s,u.QuarterPicker=l,u}(HV),qX="zhCN"===Sf._lang?WX:AX,YX=({id:e,onChange:t=(()=>{}),defaultValue:r,value:n,focus:i,renderMode:o,rectStyle:l={},...c})=>{const u=zA(qf),[d,f]=bV({value:n,defaultValue:r,onChange:t}),p=Object(a.useRef)(null),h=Object(a.useMemo)((()=>d?Td(d):""),[d]);return Object(a.useEffect)((()=>{i&&p.current&&setTimeout((()=>{var e;null==(e=p.current)||e.focus()}),30)}),[i]),s.a.createElement("div",{className:`lakex-table-form-date lakex-table-form-date-render-mode-${o}`,id:e},s.a.createElement(KX,{ref:p,defaultValue:h,value:h,autoFocus:i,onChange:(...e)=>{const[,t]=e;f(t)},style:{...l},...c,locale:qX.DatePicker,getPopupContainer:()=>(null==u?void 0:u.getValue("modal.customModalContainer"))||document.body}))},XX=({value:e,showEmpty:t})=>{const r=zA(MD);if(!e)return t?s.a.createElement(xV,null):null;return s.a.createElement("div",{className:"lakex-table-form-email-readonly"},s.a.createElement("span",{className:"lakex-table-form-email-text"},e),s.a.createElement(YP,{className:"lakex-table-form-email-action",type:"FieldEmail",onClick:t=>{t.stopPropagation(),null==r||r.open("email","mailto:"+e)}}))},ZX=e=>{const{id:t,defaultValue:r="",focus:n,onBlur:i,renderMode:o,prefix:l}=e,c=Object(a.useRef)(null),[d,f]=bV({value:e.value,defaultValue:e.defaultValue,onChange:e.onChange}),p=zA(MD);Object(a.useEffect)((()=>{n&&c.current&&c.current.focus({cursor:"end"})}),[n]);const h=null!==l?l:s.a.createElement(YP,{type:"FieldEmail",size:14});return s.a.createElement("div",{className:`lakex-table-form-email lakex-table-form-email-render-mode-${o}`,id:t},s.a.createElement(u.a,{allowClear:o!==Dj.LITE,value:d,defaultValue:r,type:"text",placeholder:kf("请输入"),prefix:h,onChange:t=>{var r;const n=t.target.value;f(n),null==(r=e.onChange)||r.call(e,n)},onBlur:i,suffix:s.a.createElement(YP,{className:GA("lakex-table-form-email-action",{hasValue:d}),type:"FieldEmail",onClick:e=>{e.stopPropagation(),null==p||p.open("email","mailto:"+d)}}),autoFocus:n,ref:c}))},JX=Fi.defineToken("ImageContribution");var QX=Object.defineProperty,eZ=Object.getOwnPropertyDescriptor,tZ=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?eZ(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&QX(t,r,o),o};let rZ=class{getProvider(){const e=this.imageProvider.getContributions()||[],t=e[e.length-1];return null==t?void 0:t.registerImage()}};tZ([Eo(JX)],rZ.prototype,"imageProvider",2),rZ=tZ([eo()],rZ);var nZ=Object.defineProperty,iZ=Object.getOwnPropertyDescriptor,oZ=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?iZ(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&nZ(t,r,o),o};let aZ=class{get _provider(){return this._imageRegistry.getProvider()}getExts(){var e;return null!=(e=this._provider)&&e.getExts?this._provider.getExts():KD.IMAGE_EXT.join(",")}isImage(e){var t;if(null==(t=this._provider)||!t.isImage)try{const t=new URL(e);return XD(t.origin+t.pathname)}catch{return!1}return this._provider.isImage(e)}tryGetWebp(e,t,r){var n;return null!=(n=this._provider)&&n.tryGetWebp?this._provider.tryGetWebp(e,t,r):e}viewImage(e,t){var r;null==(r=this._provider)||!r.viewImage||this._provider.viewImage(e,t)}getThumbnailUrl(e,t,r,n){var i;return null!=(i=this._provider)&&i.getThumbnailUrl?this._provider.getThumbnailUrl(e,t,r,n):e}};oZ([to(rZ)],aZ.prototype,"_imageRegistry",2),aZ=oZ([eo()],aZ);const sZ=bo().contribution(JX).register(rZ).register(aZ),lZ=({type:e="file",file:t,list:r=[],size:n=32})=>{const i=zA(MD),o=zA(tF),a=zA(aZ);let l,c=t.src;if(!c)return null;if("file"===e){const e=null==o?void 0:o.getFileKey(t);e&&(l=t=>s.a.createElement(XP,{ext:e,...t,size:n}))}else c=(null==a?void 0:a.getThumbnailUrl(c,t.width,t.height,n))||c,l=e=>s.a.createElement("img",{loading:"lazy",src:c,...e});return s.a.createElement("div",{className:`lakex-table-simple-file-item ${e}`,"data-id":t.uid},s.a.createElement("div",{className:"lakex-table-simple-file-img"},l&&s.a.createElement(l,{className:`lakex-table-simple-file-${e}`,onClick:n=>{n.preventDefault(),n.stopPropagation();let o={};"image"===e?o={list:r,index:r.findIndex((e=>e.src===t.src))}:"file"===e&&(o={size:t.size}),null==i||i.open(e,t.src,o)}})),s.a.createElement("div",{className:"lakex-table-simple-file-name"},t.name))},cZ=({id:e,value:t=[]})=>{var r;return t?s.a.createElement("div",{className:"lakex-table-file-list",id:e},null==(r=t.map)?void 0:r.call(t,((e,t)=>s.a.createElement(lZ,{key:e.uid||t,type:"file",file:e,size:24})))):null};var uZ=(e=>(e.IMAGE="image",e.FILE="file",e))(uZ||{}),dZ=(e=>(e.PENDING="pending",e.RUNNING="running",e.SUCCESS="success",e.ERROR="error",e.ABORTED="aborted",e.TIMEOUT="timeout",e))(dZ||{});const fZ=Fi.defineToken("UploadContribution");var pZ=Object.defineProperty,hZ=Object.getOwnPropertyDescriptor,mZ=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?hZ(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&pZ(t,r,o),o};let vZ=class{getUploader(){if(this._uploader)return this._uploader;const e=this.uploadProvider.getContributions(),t=e[e.length-1];return this._uploader=t.registerUpload(),this._uploader}};mZ([Eo(fZ)],vZ.prototype,"uploadProvider",2),vZ=mZ([eo()],vZ);var gZ=Object.defineProperty,yZ=Object.getOwnPropertyDescriptor,bZ=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?yZ(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&gZ(t,r,o),o};let wZ=class extends Zf{constructor(){super(...arguments),this._onDidChange=this._register(new op),this.onDidChange=this._onDidChange.event,this._fileMap={}}async beforeUpload(e){}init(){this.uploadTask=this.taskService.createQueueTask({name:this.name})}async uploadFile(e,t){e.uid=(null==e?void 0:e.uid)||Io();const r=this._uploadRegistry.getUploader();r.checkSize&&r.checkSize(e,this.code);try{await this.beforeUpload(e)}catch(t){return console.error(t),v.a.error(kf("文件读取失败，请重新上传")),void this._onDidChange.emit({status:dZ.ERROR,file:e})}!r.upload||r.upload(e,this.type,(e=>{e.status===dZ.RUNNING&&e.percent?t.onProcess(e.percent):e.status===dZ.SUCCESS?t.onSuccess():e.status===dZ.ERROR&&t.onError(),this._onDidChange.emit(e)}))}addFile(e){return e.uid=(null==e?void 0:e.uid)||Io(),this._fileMap[e.uid]=e,this.uploadTask.addJob(e.uid,(async e=>{await this.uploadFile(this._fileMap[e.jobId],e)})),this}destroy(){super.destroy(),this.uploadTask.destroy()}};bZ([to(vb)],wZ.prototype,"taskService",2),bZ([to(qf)],wZ.prototype,"configuration",2),bZ([to(vZ)],wZ.prototype,"_uploadRegistry",2),bZ([xi()],wZ.prototype,"init",1),bZ([Si()],wZ.prototype,"destroy",1),wZ=bZ([Qi()],wZ);var _Z=Object.defineProperty,CZ=Object.getOwnPropertyDescriptor;let EZ=class extends wZ{constructor(){super(...arguments),this.name=kf("图片上传任务"),this.type=uZ.IMAGE,this.maxSizeCode="max_single_image_size"}beforeUpload(e){return new Promise(((t,r)=>{const n=new FileReader;n.addEventListener("load",(r=>{const n=()=>{this._onDidChange.emit({status:dZ.RUNNING,file:e}),t(e)};if(r.target){const i=new Image;i.src=r.target.result,i.onload=()=>{e.width=i.width,e.height=i.height,n()},i.onerror=()=>{this._onDidChange.emit({status:dZ.ERROR,file:e}),t(e)}}else n()}),!1),n.addEventListener("error",(()=>{r(e)})),n.readAsDataURL(e)}))}};EZ=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?CZ(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&_Z(t,r,o),o})([eo()],EZ);var xZ=Object.defineProperty,SZ=Object.getOwnPropertyDescriptor;let kZ=class extends wZ{constructor(){super(...arguments),this.name=kf("附件上传任务"),this.type=uZ.FILE,this.maxSizeCode="max_single_file_size"}};kZ=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?SZ(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&xZ(t,r,o),o})([eo()],kZ);var OZ=Object.defineProperty,IZ=Object.getOwnPropertyDescriptor,RZ=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?IZ(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&OZ(t,r,o),o};let TZ=class{initConfiguration(){this._configuration.registerConfiguration({id:"upload",type:"object",title:"上传",properties:{image:{type:"object",properties:{accept:{type:"string",description:"图片可接受的格式"}}},file:{type:"object",properties:{accept:{type:"string",description:"文件可接受的格式"}}}}}),this._configuration.registerDefaultValue({"upload.image.accept":this._imageService.getExts(),"upload.file.accept":this._fileService.getExts()})}getAccept(e){return e===uZ.IMAGE?this._configuration.getValue("upload.image.accept"):e===uZ.FILE?this._configuration.getValue("upload.file.accept"):void 0}uploadImage(e){return this.imageUploadTask.addFile(e)}uploadFile(e){return this.fileUploadTask.addFile(e)}};RZ([to(qf)],TZ.prototype,"_configuration",2),RZ([to(tF)],TZ.prototype,"_fileService",2),RZ([to(aZ)],TZ.prototype,"_imageService",2),RZ([to(kZ)],TZ.prototype,"fileUploadTask",2),RZ([to(EZ)],TZ.prototype,"imageUploadTask",2),TZ=RZ([eo()],TZ);const AZ=bo().contribution(fZ).register(vZ).register(TZ).register(kZ).register(EZ),NZ=({onRetry:e,onRemove:t})=>s.a.createElement("div",{className:"lakex-table-file-upload-error"},s.a.createElement(YP,{className:"remove-file-icon",type:"Delete",onClick:t}),kf("上传失败"),s.a.createElement("div",{className:"re-upload-file",onClick:e},kf("重新上传"))),MZ=({file:e,list:t=[],type:r="file",readonly:n,onRemove:i=(()=>{})})=>{const o=zA(MD),a=zA(tF),l=zA(aZ);let c,u=e.src;if(!u)return null;if("file"===r){const t=null==a?void 0:a.getFileKey(e);t&&(c=e=>s.a.createElement(XP,{ext:t,...e}))}else u=(null==l?void 0:l.getThumbnailUrl(u,e.width,e.height,150))||u,c=e=>s.a.createElement("img",{loading:"lazy",src:u,...e});return s.a.createElement("div",{className:GA("lakex-table-file-item"),"data-id":e.uid},s.a.createElement("div",{className:`lakex-table-file-${r}`},c&&s.a.createElement(c,{className:"lakex-table-file-item-image",size:120}),s.a.createElement("div",{className:"lakex-table-file-actions"},s.a.createElement(YP,{type:"Preview",onClick:n=>{let i={};"image"===r?i={list:t,index:t.findIndex((t=>t.src===e.src))}:"file"===r&&(i={size:e.size}),null==o||o.open(r,e.src,i)}}),s.a.createElement(YP,{type:"Download",onClick:()=>{return t=e.src,void window.open(t,"_blank");var t}}),!n&&s.a.createElement(YP,{type:"Delete",onClick:()=>i(e)}))),s.a.createElement("div",{className:"lakex-table-file-name"},e.name))},PZ=({percent:e})=>s.a.createElement("div",{className:"lakex-table-file-uploading-file"},parseFloat(e.toFixed(2)),"%",s.a.createElement(g.a,{indicator:s.a.createElement(YP,{className:"lakex-table-file-uploading-icon",type:"Loading"})})),jZ=()=>s.a.createElement("div",{className:"lakex-table-file-uploading-file"},0,"%",s.a.createElement(g.a,{indicator:s.a.createElement(YP,{className:"lakex-table-file-uploading-icon",type:"Loading"})})),DZ=({event:e,type:t,list:r,onRemove:n=(()=>{}),onRetry:i=(()=>{})})=>{const{attributes:o,listeners:a,setNodeRef:l,transform:c,transition:u,isDragging:d}=zP({id:e.file.uid}),f={transform:vN.Transform.toString(c),transition:u,zIndex:d?"100":"auto",opacity:d?.3:1};let p=null;return e.status===dZ.SUCCESS?p=s.a.createElement(MZ,{type:t,key:e.file.uid,file:e.file,list:r.filter((e=>e.status===dZ.SUCCESS)).map((e=>e.file)),onRemove:n}):e.status===dZ.RUNNING?p=s.a.createElement(PZ,{key:e.file.uid,percent:e.percent||0}):e.status===dZ.PENDING?p=s.a.createElement(jZ,null):e.status===dZ.ERROR&&(p=s.a.createElement(NZ,{onRemove:()=>n(e.file),onRetry:()=>i(e.file)})),s.a.createElement("div",{ref:l,style:{...f},...a,...o},p)},FZ=({id:e,type:t,list:r,onDragEnd:n=(()=>{}),onRemove:i=(()=>{}),onRetry:o=(()=>{})})=>{const l=Object(a.useMemo)((()=>r.map((e=>({...e,id:e.file.uid||Io()})))),[r]),{activeId:c,sensors:u,handleDragStart:d,handleDragEnd:f}=(e=>{const[t,r]=Object(a.useState)(null);return{activeId:t,sensors:TN(RN(SM,{activationConstraint:{distance:8}})),handleDragStart:e=>{r(e.active.id)},handleDragEnd:async t=>{r(null);const{active:n,over:i}=t;n.id!==i.id&&e(n.id,i.id)}}})(n),p=Object(a.useMemo)((()=>r.find((e=>e.file.uid===c))),[c,r]);return s.a.createElement("div",{id:e},s.a.createElement(aP,{sensors:u,collisionDetection:LN,onDragStart:d,onDragEnd:f},s.a.createElement(jP,{items:l,strategy:TP},s.a.createElement("div",{className:"lakex-table-file"},r.map(((e,n)=>s.a.createElement("div",{key:e.id||n,className:"lakex-table-file-item-wrap"},s.a.createElement(DZ,{event:e,type:t,list:r,onRemove:i,onRetry:o})))))),s.a.createElement(xP,{dropAnimation:null},p?s.a.createElement(DZ,{event:p,type:t,list:r,onRemove:i,onRetry:o}):null)))},{Dragger:VZ}=y.a,LZ=e=>{var t;return(null==(t=null==e?void 0:e.map)?void 0:t.call(e,(e=>({id:e.uid,status:dZ.SUCCESS,file:e}))))||[]},$Z=({id:e=Io(32),type:t=uZ.IMAGE,files:r,className:n,onChange:i=(()=>{}),onCreate:o=(()=>{}),onRemove:l=(()=>{}),onOrderChange:c=(()=>{})})=>{const u=gV((e=>{i(e)}),300),d=Object(a.useRef)(null),f=cj(),p=zA(TZ),h=null==p?void 0:p.getAccept(t),[m,g]=Object(a.useState)(LZ(r)),w=Object(a.useRef)(LZ(r)),[_,C]=Object(a.useState)(0===m.length);Object(a.useEffect)((()=>{const e=LZ(r);g(e),w.current=e}),[r]);const E=e=>{e.status===dZ.ERROR&&v.a.error(e.message||kf("上传失败，请重试"));const t=w.current,r=t.findIndex((t=>t.file.uid===e.file.uid));r>-1?(e.id=e.file.uid,t[r]=e):t.push(e),e.status===dZ.SUCCESS&&o(e.file),w.current=t,S(t)};Object(a.useEffect)((()=>{null==p||p.imageUploadTask.onDidChange((t=>{t.file.uploadId===e&&E(t)})),null==p||p.fileUploadTask.onDidChange((t=>{t.file.uploadId===e&&E(t)}))}),[]);const x=Object(a.useCallback)((r=>{r.uploadId=e,"image"===t?null==p||p.uploadImage(r):"file"===t&&(null==p||p.uploadFile(r))}),[]),S=Object(a.useCallback)((e=>{const t=e.filter((e=>e.status===dZ.SUCCESS)).map((e=>e.file));m.map((e=>e.file.uid)).join(",")!==t.map((e=>e.uid)).join(",")&&u(t),g(e),C(0===e.length),f()}),[m]),k=oa.isMobile?"lakex-table-file-manage-component-h5":"";return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:GA("lakex-table-file-manage-component",k,n)},s.a.createElement("div",{onClick:()=>{var e;null==(e=d.current)||e.focus()},onPaste:e=>{var t;e.preventDefault(),e.stopPropagation();const r=null==(t=e.clipboardData)?void 0:t.files;if(!r||!r.length)return void v.a.error(kf("剪贴板里没有文件可粘贴"));const n=Array.from(r);null==n||n.forEach((e=>x(e)))},className:"lakex-table-file-manage-component-upload"},s.a.createElement("input",{className:"lakex-table-file-manage-component-paste-container",ref:d}),s.a.createElement(VZ,{showUploadList:!1,customRequest:e=>x(e.file),accept:h,openFileDialogOnClick:!1,multiple:!0},s.a.createElement("div",{className:_?"lakex-table-file-manage-component-empty-content":"lakex-table-file-manage-component-content"},s.a.createElement(YP,{type:"EditorPaste",size:22}),s.a.createElement("span",{className:"lakex-table-file-manage-component-title"},kf("直接粘贴或拖拽到这里")),s.a.createElement(y.a,{customRequest:e=>x(e.file),accept:h,showUploadList:!1,multiple:!0},s.a.createElement(b.a,{className:"lakex-table-file-manage-component-upload-button"},s.a.createElement(YP,{className:"lakex-table-file-manage-component-plus-icon",type:"Add",size:18}),s.a.createElement("div",{className:"lakex-table-file-manage-component-button-title"},kf("本地上传"))))))),!_&&s.a.createElement(FZ,{type:t,list:m,onRemove:e=>{const t=[...m],r=t.findIndex((t=>t.file.uid===e.uid));r>-1&&(t.splice(r,1),w.current=t,S(t),l(e))},onRetry:e=>{x(e)},onDragEnd:(e,t)=>{const r=m.findIndex((e=>e.file.uid===t)),n=m.findIndex((t=>t.file.uid===e)),i=[...m],[o]=i.splice(r,1);i.splice(n,0,o),w.current=i,c({targetUid:e,sourceUid:t}),S(i)}})))},BZ=({id:e,onChange:t,defaultValue:r,onCreate:n=(()=>{}),onUpdate:i=(()=>{}),onRemove:o=(()=>{}),onOrderChange:a=(()=>{}),style:l})=>s.a.createElement("div",{className:"lakex-table-file-form-upload",style:l||{}},s.a.createElement($Z,{id:e,type:uZ.FILE,onChange:t,onCreate:n,onUpdate:i,onRemove:o,onOrderChange:a,files:r})),zZ=({id:e,onChange:t,defaultValue:r,onCreate:n=(()=>{}),onUpdate:i=(()=>{}),onRemove:o=(()=>{}),onOrderChange:a=(()=>{}),style:l})=>s.a.createElement("div",{className:"lakex-table-file-form-upload",style:l||{}},s.a.createElement($Z,{id:e,type:uZ.IMAGE,onChange:t,onCreate:n,onUpdate:i,onRemove:o,onOrderChange:a,files:r})),UZ=({id:e,value:t})=>{var r;return t?s.a.createElement("div",{className:"lakex-table-image-list",id:e},null==(r=t.map)?void 0:r.call(t,((e,r)=>s.a.createElement(lZ,{key:e.uid||r,type:"image",file:e,list:t})))):null},HZ=e=>{const{onClick:t=(()=>{}),list:r,onUnSelect:n=(()=>{}),onMentionTagClick:i=(()=>{}),writeable:o,showPlaceholder:a,hideDropdownIcon:l}=e;let c=null;return c=r&&0!==r.length||!a?s.a.createElement("div",{className:"lakex-table-form-mention-tag-wrap"},null==r?void 0:r.map((e=>e?s.a.createElement("span",{className:"lakex-table-form-mention-tag",key:e.uid,onClick:t=>{i(e)}},s.a.createElement("img",{className:"lakex-table-form-mention-tag-avatar",src:e.icon}),s.a.createElement("span",{className:"lakex-table-form-mention-tag-name"},e.name),o&&s.a.createElement("span",{className:"lakex-table-form-mention-tag-close",onClick:t=>{t.stopPropagation(),n(e,t)}},s.a.createElement(YP,{type:"Close"}))):null))):s.a.createElement("p",{className:"lakex-table-form-mention-placeholder"},kf("请选择")),s.a.createElement("div",{className:GA("lakex-table-form-mention-content",{writeable:o}),onClick:t},c,o&&!l&&s.a.createElement("span",{className:"lakex-table-form-mention-caret-down",onClick:e.onClickDropDownIcon},s.a.createElement(YP,{type:"ReviewArrowDown",size:16})))};HZ.defaultProps={writeable:!1,showPlaceholder:!0};const WZ=({isSelected:e,user:t,onSelect:r=(()=>{}),onUnselect:n=(()=>{})})=>{const i=GA("lakex-table-form-mention-selector-item",{selected:e});return s.a.createElement("div",{onClick:i=>{e?n(t):r(t)},className:i},s.a.createElement("div",{className:"lakex-table-form-mention-selector-content"},s.a.createElement("span",{className:"lakex-table-form-mention-selector-avatar"},s.a.createElement("img",{src:t.icon})),s.a.createElement("div",null,s.a.createElement("div",{className:"lakex-table-form-mention-selector-name"},t.name),s.a.createElement("div",{className:"lakex-table-form-mention-selector-login"},t.login))),e&&s.a.createElement(YP,{type:"Check"}))},GZ=({list:e,highlightId:t,selectedIds:r,emptyText:n=kf("未搜索到结果"),onSelect:i,onUnselect:o})=>((({highlightId:e})=>{Object(a.useEffect)((()=>{const e=document.querySelector(".lakex-table-form-mention-selector-list");if(!e)return;const t=document.querySelector(".highlight");if(!t)return;const r=t.offsetTop-38,n=r+t.getBoundingClientRect().height;r<e.scrollTop?e.scrollTop-=e.scrollTop-r:n-e.scrollTop>e.getBoundingClientRect().height&&(e.scrollTop=n-e.getBoundingClientRect().height)}),[e])})({highlightId:t}),e&&e.length>0?s.a.createElement("ul",{className:"lakex-table-form-mention-selector-list"},e.map((e=>{if(!e)return null;const n=GA({highlight:t===e.uid});return s.a.createElement("li",{key:e.uid,className:n},s.a.createElement(WZ,{isSelected:r.includes(e.uid),onSelect:i,onUnselect:o,user:e}))}))):s.a.createElement("div",{className:"lakex-table-form-mention-selector-empty"},s.a.createElement("span",null,n))),KZ=({type:e="text",defaultValue:t="",value:r,focus:n,onSearch:i=(()=>{}),onChange:o=(()=>{}),inputRef:l})=>{const c=Object(a.useRef)(),u=l||c,d=Object(a.useRef)();Object(a.useEffect)((()=>{n&&setTimeout((()=>{var e;null==(e=u.current)||e.focus()}),300)}),[n]);const f={type:e,placeholder:kf("搜索人员"),onChange:e=>{o(e),!d.current&&i(e)},onCompositionStart:()=>{d.current=!0},onCompositionEnd:e=>{d.current=!1,i(e)},bordered:!1,defaultValue:t,value:r};return s.a.createElement(YA,{...f,ref:u,allowEnter:!1})},qZ=e=>{const t=new Set;return e&&Array.isArray(e)&&e.forEach((e=>{t.add(e.uid)})),[...t.values()]},YZ=e=>{const{inputRef:t}=e,{state:r,onKeyDown:n,onSearch:i,onSelect:o,onUnselect:l,onChange:c}=(e=>{const{selected:t,inputRef:r,focus:n}=e,i=zA(kb),[o,s]=Object(a.useState)(""),[l,c]=Object(a.useState)([]),[u,d]=Object(a.useState)(!1),[f,p]=Object(a.useState)(),[h,m]=Object(a.useState)((()=>qZ(t)));Object(a.useEffect)((()=>{null==i||i.contextUsers().then((e=>{c(e)})),setTimeout((()=>{var e;n&&(null==(e=null==r?void 0:r.current)||e.focus())}),40)}),[]),Object(a.useEffect)((()=>{m(qZ(t))}),[t]);const v=Object(a.useCallback)((e=>{var t;const r=e.keyCode||e.which;if([Px.UP,Px.DOWN].includes(r)){e.preventDefault();let n=l.findIndex((e=>e.uid===f));r===Px.UP?(n-=1,n<0&&(n=0)):r===Px.DOWN&&(n+=1,n>=l.length&&(n=l.length-1)),p(null==(t=l[n])?void 0:t.uid)}else if(r===Px.ENTER){e.preventDefault();const t=document.querySelector(".highlight .lakex-table-form-mention-selector-item");t&&t.click()}}),[l,f]);Object(a.useEffect)((()=>{const e=document.querySelector(".lakex-table-form-mention-selector-list"),t=null==e?void 0:e.querySelector("li.highlight");if(!t)return;const r=t.offsetTop-38,n=r+t.getBoundingClientRect().height;r<e.scrollTop?e.scrollTop-=e.scrollTop-r:n-e.scrollTop>e.getBoundingClientRect().height&&(e.scrollTop=n-e.getBoundingClientRect().height)}),[f]);const g=Object(a.useCallback)((t=>{var r;null==(r=e.onSelect)||r.call(e,t),!h.includes(t.uid)&&(m(h.concat(t.uid)),s(""))}),[e.onSelect,t]),y=Object(a.useCallback)((t=>{var r;null==(r=e.onUnselect)||r.call(e,t);const n=h.filter((e=>e!==t.uid));m(n)}),[e.onUnselect]),b=Object(a.useCallback)((e=>{const t=e.target.value||"";s(t)}),[]);return Object(a.useLayoutEffect)((()=>{!e.visible&&o&&s("")}),[e.visible]),{state:{list:l,loading:u,highlightId:f,selectedUserIds:h,filterValue:o},onKeyDown:v,onSearch:e=>{d(!0);const t=e.target.value;null==i||i.searchUser(t).then((e=>{c(e),d(!1)}))},onSelect:g,onUnselect:y,onChange:b}})(e);return s.a.createElement("div",{className:"lakex-table-form-mention-selector-container lakex-table-mention-wrapper",onKeyDown:n},s.a.createElement("div",{className:"lakex-table-form-mention-selector-search"},s.a.createElement(KZ,{focus:e.focus,onSearch:i,onChange:c,inputRef:t,value:r.filterValue})),r.loading?s.a.createElement("div",{className:"lakex-table-form-mention-selector-spin"},s.a.createElement(g.a,null)):s.a.createElement("div",{className:"lakex-table-form-mention-selector-body"},s.a.createElement(GZ,{selectedIds:r.selectedUserIds,list:r.list,highlightId:r.highlightId,onSelect:o,onUnselect:l})))};const XZ=({defaultValue:e,onChange:t,onSelect:r,onUnselect:n})=>{const[i,o]=Object(a.useState)((()=>function(e){return ad(e)?[]:Array.isArray(e)?e:[e]}(e))),[s,l]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{const e=e=>{let t=e.target;for(;t&&t!==document.body;){if(t.classList.contains("lakex-table-mention-wrapper"))return;t=t.parentNode}l(!1)};return document.body.addEventListener("click",e),()=>{document.body.removeEventListener("click",e)}}),[]),{state:{visible:s,selected:i},onMentionSelect:e=>{const n=i.concat(e);o(n),l(!1),t(n),r(e)},onMentionUnselect:e=>{const r=i.filter((t=>t.uid!==e.uid));o(r),l(!1),t(r),n(e)},onToggleVisible:()=>{l(!s)}}},ZZ=({id:e,onChange:t=(()=>{}),onSelect:r=(()=>{}),onUnselect:n=(()=>{}),defaultValue:i=[],onMentionTagClick:o=(()=>{}),renderMode:a})=>{const{state:l,onMentionSelect:c,onMentionUnselect:u,onToggleVisible:d}=XZ({defaultValue:i,onChange:t,onSelect:r,onUnselect:n});return s.a.createElement(s.a.Fragment,null,s.a.createElement(w.a,{overlay:s.a.createElement(YZ,{focus:!1,visible:l.visible,selected:l.selected,onSelect:c,onUnselect:u}),visible:l.visible,placement:"bottomLeft",dropdownClassName:"lakex-table-mention-wrapper"},s.a.createElement("div",{className:`lakex-table-form-mention lakex-table-mention-wrapper lakex-table-form-mention-render-mode-${a}`,id:e,onClick:()=>d()},s.a.createElement(HZ,{writeable:l.visible,list:l.selected,hideDropdownIcon:a===Dj.LITE,onUnSelect:u,onMentionTagClick:o}))))},JZ=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{var r;const{value:n,showEmpty:i,onMentionTagClick:o=(()=>{})}=e,l=Object(a.useRef)(null),c=Object(a.useRef)([]),[u,d]=Object(a.useState)(null);Object(a.useImperativeHandle)(t,(()=>({applyOverflow:e=>{p(e)}})));const f=Object(a.useCallback)(((e,t)=>{const r={};return u&&u.width&&u.index===t&&(r.width=u.width),r}),[u]);Object(a.useLayoutEffect)((()=>{const e=l.current,t=c.current,r=null==e?void 0:e.childNodes;!r||r.forEach((e=>{const r=e;t.push({width:r.scrollWidth,height:r.offsetHeight})}))}),[]);const p=Object(a.useCallback)((e=>{var t;const r=c.current;if(!e||!r||r.length<=1)return;const n=e.height,i=e.width;let o=-1,a=0,s=0,l=0;for(const e of r){o++;const{width:c,height:u}=e,f=a+c+3+12>i,p=i-a-c-3-12;if(f&&s+u+3>=n){const e=c>0&&c<p?c:l,n=e<12?(null==(t=r[o-1])?void 0:t.width)-12:e;return void d({index:n<12?o-1:o,width:Math.max(n,12)})}f&&(s+=3+u+3,a=0),a+=3+c,l=p}d(null)}),[c]);return n&&0!==n.length?s.a.createElement("div",{className:"lakex-table-form-mention-readonly"},s.a.createElement("div",{className:"lakex-table-form-mention-tag-wrap",ref:l},null==(r=null==n?void 0:n.map)?void 0:r.call(n,((e,t)=>{if(!e)return null;const r=f(e,t);return s.a.createElement("span",{className:"lakex-table-form-mention-tag",key:e.uuid,style:r,onClick:t=>{o(e)}},s.a.createElement("img",{className:"lakex-table-form-mention-tag-avatar",src:e.icon}),s.a.createElement("span",{className:"lakex-table-form-mention-tag-name"},e.name))})))):i?s.a.createElement("div",{className:"lakex-table-form-mention-readonly"},s.a.createElement(xV,null)):null}))),QZ=({value:e,showEmpty:t})=>e||0===Number(e)?s.a.createElement("div",{className:"lakex-table-form-number-readonly"},e):t?s.a.createElement(xV,null):null,eJ=e=>{const{id:t,defaultValue:r,focus:n,onBlur:i,renderMode:o}=e,l=null!==e.prefix?e.prefix:s.a.createElement(YP,{type:"FieldNumber",size:14}),[c,d]=bV({value:e.value,defaultValue:e.defaultValue,onChange:e.onChange}),f=Object(a.useRef)(null);return Object(a.useEffect)((()=>{n&&f.current&&f.current.focus({cursor:"end"})}),[n]),s.a.createElement("div",{className:`lakex-table-form-number lakex-table-form-number-render-mode-${o}`,id:t},s.a.createElement(u.a,{allowClear:o!==Dj.LITE,type:"text",value:c,defaultValue:r,placeholder:kf("请输入"),prefix:l,onChange:t=>{var r;const n=t.target.value;d(n),null==(r=e.onChange)||r.call(e,n)},onBlur:i,autoFocus:n,ref:f}))},tJ=({value:e,showEmpty:t})=>{const r=zA(MD);if(!e)return t?s.a.createElement(xV,null):null;return s.a.createElement("div",{className:"lakex-table-form-phone-readonly"},s.a.createElement("span",{className:"lakex-table-form-phone-text"},e),s.a.createElement(YP,{className:"lakex-table-form-phone-action",type:"FieldPhone",onClick:t=>{t.stopPropagation(),null==r||r.open("phone","tel:"+e)}}))},rJ=e=>{const{id:t,defaultValue:r,prefix:n,focus:i,renderMode:o,onChange:l=(()=>{}),onBlur:c}=e,d=zA(MD),[f,p]=bV({value:e.value,defaultValue:e.defaultValue,onChange:e.onChange}),h=null!==n?n:s.a.createElement(YP,{type:"FieldPhone"}),m=Object(a.useRef)(null);return Object(a.useEffect)((()=>{i&&m.current&&m.current.focus({cursor:"end"})}),[i]),s.a.createElement("div",{className:`lakex-table-form-phone lakex-table-form-phone-render-mode-${o}`,id:t},s.a.createElement(u.a,{allowClear:o!==Dj.LITE,value:f,defaultValue:r,autoFocus:i,type:"text",placeholder:kf("请输入"),prefix:h,onChange:e=>{const t=e.target.value;p(t),null==l||l(t)},onBlur:c,suffix:s.a.createElement(YP,{className:GA("lakex-table-form-phone-action",{hasValue:f}),type:"FieldPhone",onClick:e=>{e.stopPropagation(),null==d||d.open("phone","tel:"+f)}}),ref:m}))};var nJ=(e=>(e.Dropdown="dropdown",e.List="list",e))(nJ||{}),iJ=(e=>(e.Select="select",e.MultiSelect="multiSelect",e))(iJ||{});const oJ=({placeholder:e,defaultValue:t="",value:r="",onChange:n=(()=>{}),focus:i,inputRef:o})=>{const l=Object(a.useRef)(),c=o||l;return Object(a.useEffect)((()=>{i&&setTimeout((()=>{var e;null==(e=c.current)||e.focus()}),300)}),[i]),s.a.createElement("div",{className:"lakex-table-dropdown-search"},s.a.createElement(YA,{ref:c,type:"text",placeholder:e,onChange:n,bordered:!1,defaultValue:t,value:r,allowEnter:!1}))},aJ=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{const{value:r,color:n}=e,{state:i,style:o}=(({value:e,color:t})=>{const[r,n]=Object(a.useState)(e),i=zA(rk),o=t?{background:(null==i?void 0:i.getRenderColor(t))||"none"}:{};return o.color=null==i?void 0:i.getRenderTextColor(t),Object(a.useEffect)((()=>{n(e)}),[e]),{state:{optionValue:r},style:o}})({value:r,color:n});return Object(a.useImperativeHandle)(t,(()=>({getValue:()=>r||""}))),s.a.createElement("div",{className:GA("lakex-table-dropdown-item create",{active:e.isActive}),onClick:()=>{e.onCreate(r)}},s.a.createElement("span",{className:"lakex-table-dropdown-item-prefix"},kf("新建选项")),i.optionValue&&s.a.createElement("span",{className:"lakex-table-dropdown-item-text",style:o},i.optionValue))}))),sJ=e=>{const{item:t,colorable:r}=e,{labelColor:n}={labelColor:zA(rk)},[i,o]=Object(a.useState)(t.name),l=Object(a.useRef)(!1),c=Object(a.useRef)(null),d=gV((()=>{var r,n,i;!l.current||(null==(n=e.onOptionChange)||n.call(e,{...t,name:null==(r=c.current)?void 0:r.input.value}),l.current=!1,null==(i=e.onClose)||i.call(e,t))}),400);return Object(a.useEffect)((()=>()=>{var r,n;!l.current||null==(n=e.onOptionChange)||n.call(e,{...t,name:null==(r=c.current)?void 0:r.input.value})}),[]),s.a.createElement("div",{key:t.id,className:"lakex-table-dropdown-item editing active"},s.a.createElement(u.a,{ref:c,className:"lakex-table-dropdown-item-input editing-input",value:i,onChange:e=>{const t=(e.target.value||"").trim();o(t),l.current=!0},onPressEnter:e=>{e.stopPropagation(),d()},onKeyDown:r=>{var n;r.stopPropagation(),r.keyCode===Px.ESC&&(null==(n=e.onClose)||n.call(e,t))},onBlur:()=>{setTimeout((()=>{var e;(null==(e=c.current)?void 0:e.input)!==document.activeElement&&d()}),300)},autoFocus:!0}),r&&s.a.createElement(f.a,{placement:"rightTop",overlayClassName:"lakex-table-colorpicker",overlayStyle:{zIndex:1050},content:s.a.createElement(UA,{colorSource:[...YS],activeColor:t.color,onSelect:r=>{var n,i;null==(n=e.onOptionChange)||n.call(e,{...t,color:r}),null==(i=c.current)||i.focus()}})},s.a.createElement("span",{className:"option-color",style:{background:null==n?void 0:n.getRenderColor(t.color)}})))},lJ=e=>{const{isEditing:t,isActive:r,isSelected:n,canEditing:i=!0,item:o,colorable:l,editable:c,onSelect:u=(()=>{}),onSetActive:p=(()=>{})}=e,{optionItem:h,setOptionItem:m,style:v}=(({item:e,colorable:t})=>{const r=r=>t?{background:e.color?null==n?void 0:n.getRenderColor(r.color):"none",color:null==n?void 0:n.getRenderTextColor(r.color)}:{},n=zA(rk),[i,o]=Object(a.useState)(e),[s,l]=Object(a.useState)(r(e));return{optionItem:i,setOptionItem(e){o(e),l(r(e))},labelColor:n,style:s}})({item:o,colorable:l}),[g,y]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{!r&&y(!1)}),[r]),t?s.a.createElement(sJ,{onOptionChange:t=>{var r;(t.name!==o.name||t.color!==o.color)&&(null==(r=e.onOptionChange)||r.call(e,t),m(t))},item:h,colorable:l,onClose:()=>{var t;null==(t=e.onSetEditing)||t.call(e,null)}}):s.a.createElement("div",{key:h.uuid,className:GA("lakex-table-dropdown-item",{active:r}),onClick:()=>{!i||u(h)}},n&&s.a.createElement(YP,{type:"Check",size:14}),s.a.createElement("span",{className:"lakex-table-dropdown-item-text",style:v},h.name),c&&s.a.createElement(f.a,{visible:g,overlayClassName:"lakex-table-dropdown-popover-container",overlayStyle:{zIndex:1051},getPopupContainer:()=>{let e=document.getElementById("lakex-table-dropdown-popup-container");return e||(e=document.createElement("div"),e.id="lakex-table-dropdown-popup-container",e.onmouseup=e=>{e.preventDefault(),e.stopPropagation()},document.body.appendChild(e),e)},content:s.a.createElement(d.a,{onClick:({key:t,domEvent:r})=>{var n,i;r.stopPropagation(),"edit"===t?null==(n=e.onSetEditing)||n.call(e,h.uuid):"del"===t&&(null==(i=e.onRemove)||i.call(e,h.uuid)),y(!1)}},s.a.createElement(d.a.Item,{key:"edit",icon:s.a.createElement(YP,{type:"Edit",size:14})},kf("编辑")),s.a.createElement(d.a.Item,{key:"del",icon:s.a.createElement(YP,{type:"Delete",size:14})},kf("删除"))),trigger:"click",placement:"rightTop",onClick:e=>e.stopPropagation()},s.a.createElement(YP,{type:"MoreHorizontal",onClick:()=>{y(!g),p()}})))};lJ.defaultProps={canEditing:!1,colorable:!1,editable:!1};const cJ=e=>{const{options:t=[],focus:r,selectedIds:n,colorable:i,optionEditable:o,inputRef:l}=e,{state:c,onInputChange:u,onCreateOption:d,setActiveIdx:f,onOptionChange:p,onOptionDelete:h,onOptionSelect:m}=(e=>{const{options:t,onOptionCreate:r,colorable:n,inputRef:i,visible:o,focus:s}=e,[l,c]=Object(a.useState)(0),[u,d]=Object(a.useState)(""),f=zA(rk),p=Object(a.useMemo)((()=>{var e,r,i;if(n)return 0===t.length?null==(e=rk)?void 0:e.getNextColor(""):null==(i=rk)?void 0:i.getNextColor(null==(r=t[t.length-1])?void 0:r.color)}),[n,f,t]),h=Object(a.useMemo)((()=>u?t.filter((e=>{var t,r;return null==(r=null==(t=e.name)?void 0:t.toLowerCase)?void 0:r.call(t).includes(u.toLowerCase())})):t),[u,t]);Object(a.useEffect)((()=>{setTimeout((()=>{var e;s&&(null==(e=null==i?void 0:i.current)||e.focus())}),20)}),[]),Object(a.useLayoutEffect)((()=>{!o&&u&&d("")}),[o,u]);const m=Object(a.useMemo)((()=>""!==u&&!h.some((e=>e.name===u))),[u,h]),g=mV((e=>{const t=e.trim();if(!t)return void v.a.error(kf("新建选项不能为空字符"));const n={name:t,uuid:Io(6),color:p||""};null==r||r(n),d(""),c(0)})),y=Object(a.useMemo)((()=>({value:u,selectOptions:h,showNew:m,newOptionColor:p,activeIdx:l})),[u,m,p,h,l]),b=mV((t=>{var r,n;null==(r=e.onOptionChange)||r.call(e,t),null==(n=null==i?void 0:i.current)||n.focus()})),w=mV(((t,r)=>{var n;c(r),e.onOptionSelect(t),d(""),null==(n=null==i?void 0:i.current)||n.focus()})),_=Object(a.useCallback)((t=>{var r;e.onOptionDelete(t),null==(r=null==i?void 0:i.current)||r.focus()}),[]);return{state:y,onInputChange:Object(a.useCallback)((e=>{const t=e.target.value;d(t),c(0)}),[]),onCreateOption:g,setActiveIdx:c,onOptionChange:b,onOptionDelete:_,onOptionSelect:w}})(e),{activeIdx:g}=c,[y,b]=Object(a.useState)(null),w=Object(a.useRef)(null),_=Object(a.useCallback)((e=>{var t;const r=e.keyCode||e.which,n=r===Px.UP,i=r===Px.DOWN,o=c.selectOptions.length,a=c.showNew?o:o-1;if((n||i)&&o>0){e.preventDefault();let t=0;t=0===g?n?a:1:g===a?n?g-1:0:g+(n?-1:1),f(t)}else if(r===Px.ENTER){const e=0===o||g===o;if(c.showNew&&e){const e=null==(t=w.current)?void 0:t.getValue();e&&d(e)}else{const e=c.selectOptions[g];e&&m(e,g)}}}),[g,t,c.showNew,w.current,c.selectOptions]);return Object(a.useEffect)((()=>{const e=document.querySelector(".lakex-table-dropdown-list"),t=document.querySelector(".lakex-table-dropdown-item.active");if(!t)return;const r=t.offsetTop-38,n=r+t.getBoundingClientRect().height;r<e.scrollTop?e.scrollTop-=e.scrollTop-r:n-e.scrollTop>e.getBoundingClientRect().height&&(e.scrollTop=n-e.getBoundingClientRect().height)}),[g]),s.a.createElement("div",{className:"lakex-table-dropdown-celleditor",onKeyDown:_},s.a.createElement(oJ,{placeholder:kf(o?"可搜索或新建选项":"搜索选项"),onChange:u,focus:r,value:c.value,inputRef:l}),s.a.createElement("div",{className:"lakex-table-dropdown-list"},c.selectOptions.map(((e,t)=>{const r=g===t,a=null==n?void 0:n.includes(e.uuid),l=e.uuid===y;return s.a.createElement(lJ,{key:e.uuid,isEditing:l,onSetEditing:e=>{b(e)},canEditing:!0,colorable:i,onOptionChange:p,onRemove:h,onSelect:e=>m(e,t),onSetActive:()=>{f(t)},isActive:r,isSelected:a,item:e,editable:!!o})})),c.showNew&&o&&s.a.createElement(aJ,{isActive:g===c.selectOptions.length||0===c.selectOptions.length,ref:w,onCreate:e=>{d(e)},value:c.value,colorable:i,color:c.newOptionColor})))};cJ.defaultProps={colorable:!0,editable:!1};const uJ=({value:e=[],colorable:t,onDelete:r=(()=>{}),onClickDropDownIcon:n=(()=>{}),writeable:i,showPlaceholder:o,hideDropdownIcon:a})=>{const{labelColor:l}={labelColor:zA(rk)};return Array.isArray(e)?0===e.length&&o?s.a.createElement("p",{className:"lakex-table-dropdown-selected-placeholder"},kf("请选择")):s.a.createElement("div",{className:"lakex-table-dropdown-selector"},s.a.createElement("div",{className:"lakex-table-dropdown-selected-list "+(i?"writeable":"")},e.map((e=>s.a.createElement("div",{className:"lakex-table-dropdown-selected-item",key:e.uuid,style:t?{background:e.color?null==l?void 0:l.getRenderColor(e.color):"none",color:null==l?void 0:l.getRenderTextColor(e.color)}:{}},s.a.createElement("span",{className:"lakex-table-dropdown-selected-item-text"},e.name),i&&s.a.createElement(YP,{className:"lakex-table-select-close-action",type:"Close",size:12,onClick:t=>{t.stopPropagation(),r(e)}}))))),i&&!a?s.a.createElement("span",{className:"lakex-table-form-mention-caret-down",onClick:e=>{null==n||n(e)}},s.a.createElement(YP,{type:"ReviewArrowDown",size:16})):null):null};function dJ(e){return jo(e)?[]:Array.isArray(e)?e:[e]}uJ.defaultProps={hideDropdownIcon:!1,writeable:!1,showPlaceholder:!0};const fJ=e=>{const{options:t,editable:r,optionEditable:n,colorable:i}=e,{state:o,onKeyDown:l,onToggleVisible:c,onToggleSelect:u}=(e=>{const{defaultValue:t,options:r,type:n}=e,[i,o]=Object(a.useState)(!1),[s,l]=Object(a.useState)((()=>dJ(t))),c=Object(a.useRef)(null),u=Object(a.useMemo)((()=>!jo(e.onChange)),[e.onChange]);Object(a.useEffect)((()=>{if(u){const e=dJ(t);l(e)}}),[t,u]),Object(a.useEffect)((()=>{const e=e=>{let t=e.target;for(;t&&t!==document.body;){if(t.classList.contains("lakex-table-colorpicker")||t.classList.contains("lakex-table-dropdown-popover-container")||t.classList.contains("lakex-table-dropdown-celleditor")||t.classList.contains("lakex-table-select-close-action"))return;t=t.parentNode}o(!1)};return document.body.addEventListener("click",e),()=>{document.body.removeEventListener("click",e)}}),[]);const d=Object(a.useCallback)((e=>{(e.keyCode||e.which)===Px.ESC&&o(!1)}),[r]),f=Object(a.useMemo)((()=>r.filter((e=>s.includes(e.uuid)))),[r,s]),p=Object(a.useCallback)((()=>{o(!i)}),[i]),h=Object(a.useCallback)((t=>{var i;const o=n===iJ.MultiSelect,a=t.uuid,c=s.includes(a),d=o?s.concat(a):[a],f=o?s.filter((e=>e!==a)):[],h=c?f:d;u?null==(i=e.onChange)||i.call(e,r.filter((e=>h.includes(e.uuid)))):l(h),!o&&!c&&p()}),[i,n,s,u,r]);return{state:{visible:i,selectedOptions:f,selectedIds:s,selectInputRef:c},onKeyDown:d,onToggleVisible:p,onToggleSelect:h}})(e);return s.a.createElement("div",{className:"lakex-table-dropdown",onKeyDown:l},s.a.createElement(w.a,{overlay:s.a.createElement(cJ,{visible:o.visible,inputRef:o.selectInputRef,focus:!0,colorable:!!i,options:t,editable:!!r,optionEditable:!!n,selectedIds:o.selectedIds||[],onOptionCreate:t=>{var r;null==(r=e.onOptionCreate)||r.call(e,t)},onOptionChange:t=>{var r;null==(r=e.onOptionChange)||r.call(e,t)},onOptionDelete:t=>{var r;null==(r=e.onOptionDelete)||r.call(e,t)},onOptionSelect:e=>{u(e)}}),placement:"bottomLeft",visible:o.visible,overlayClassName:"lakex-table-dropdown"},s.a.createElement("div",{className:"lakex-table-dropdown-cellview",onClick:c},s.a.createElement(uJ,{writeable:o.visible,colorable:!!i,value:o.selectedOptions,hideDropdownIcon:e.hideDropdownIcon,onDelete:e=>u(e),showPlaceholder:!0}))))},pJ=({options:e,value:t,focus:r,onOptionSelect:n=(()=>{})})=>{const{radioRef:i}=(({focus:e})=>{const t=Object(a.useRef)(null);return Object(a.useEffect)((()=>{e&&setTimeout((()=>{var e;null==(e=t.current)||e.focus()}),300)}),[e]),{radioRef:t}})({focus:r});return s.a.createElement(m.a.Group,{ref:i,value:t},e.map(((e,t)=>s.a.createElement(m.a,{className:"lakex-table-form-select-radio",value:e.uuid,key:t,onChange:()=>{n([e])}},s.a.createElement("span",{className:"lakex-table-form-select-value"},e.name)))))},hJ=({options:e=[],focus:t,value:r,onOptionSelect:n=(()=>{})})=>s.a.createElement(p.a.Group,{onChange:t=>{n(e.filter((e=>t.includes(e.uuid))))},value:r,autoFocus:t},e.map(((e,t)=>s.a.createElement(p.a,{className:"lakex-table-form-select-checkbox",value:e.uuid,key:t},s.a.createElement("span",{className:"lakex-table-form-select-value"},e.name))))),mJ=(e,t)=>e!==iJ.Select||Array.isArray(t)?t:[t],vJ=e=>{const{id:t,type:r=iJ.Select,defaultValue:n=[],value:i,options:o=[],renderMode:a,displayType:l=nJ.List,focus:c=!1,className:u=""}=e;let d;e.onChange&&(d=t=>{var n;const i=r===iJ.Select?t[0]:t;null==(n=e.onChange)||n.call(e,i)});const[f,p]=bV({value:i?mJ(r,i):void 0,defaultValue:mJ(r,n),onChange:d});let h;if(l===nJ.Dropdown){const{defaultValue:t,onChange:r,...n}=e;h=s.a.createElement(fJ,{...n,defaultValue:f,value:f,onChange:e=>{p(e.map((e=>e.uuid)))},onOptionCreate:t=>{var r;null==(r=e.onOptionCreate)||r.call(e,t),f.push(t.uuid),p(f)},onOptionChange:e.onOptionChange,onOptionDelete:e.onOptionDelete,hideDropdownIcon:a===Dj.LITE})}else l===nJ.List&&r===iJ.Select?h=s.a.createElement(pJ,{value:f[0],options:o,focus:c,onOptionSelect:e=>{p(e.map((e=>e.uuid)))}}):l===nJ.List&&r===iJ.MultiSelect&&(h=s.a.createElement(hJ,{value:f,options:o,focus:c,onOptionSelect:e=>{p(e.map((e=>e.uuid)))}}));return s.a.createElement("div",{className:`lakex-table-form-select lakex-table-form-select-${r||"normal"} ${u} lakex-table-form-select-render-mode-${a}`,id:t},h)},gJ=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{const{colorable:r,type:n="",value:i=[],className:o="",showEmpty:l=!1}=e,c=zA(rk),u=Object(a.useRef)(null),d=Object(a.useRef)([]),[f,p]=Object(a.useState)(null),h=Object(a.useCallback)(((e,t)=>{const n={};if(r){const t=e.color?null==c?void 0:c.getRenderColor(e.color):"none";n.background=t,n.color=null==c?void 0:c.getRenderTextColor(e.color)}return f&&f.width&&f.index===t&&(n.width=f.width),n}),[r,f]);Object(a.useImperativeHandle)(t,(()=>({applyOverflow:e=>{m(e)}}))),Object(a.useLayoutEffect)((()=>{const e=u.current,t=d.current,r=null==e?void 0:e.childNodes;!r||r.forEach((e=>{const r=e;t.push({width:r.scrollWidth,height:r.offsetHeight})}))}),[]);const m=Object(a.useCallback)((e=>{var t;const r=d.current;if(!e||!r||r.length<=1)return;const n=e.height,i=e.width;let o=-1,a=0,s=0,l=0;for(const e of r){o++;const{width:c,height:u}=e,d=a+c+4+5>i,f=i-a-c-4-5;if(d&&s+u+4>=n){const e=c>0&&c<f?c:l,n=e<5?(null==(t=r[o-1])?void 0:t.width)-e:e-5;return void p({index:n<5?o-1:o,width:Math.max(n,12)})}d&&(s+=4+u+4,a=0),a+=4+c,l=f}p(null)}),[d]);return i&&0!==i.length?s.a.createElement("div",{className:`lakex-table-form-select lakex-table-form-select-${n||"normal"} ${o}`},s.a.createElement("div",{className:"lakex-table-form-select-readonly",ref:u},i.map(((e,t)=>{const r=h(e,t);return s.a.createElement("div",{className:"lakex-table-select-item lakex-table-select-item-overflow-apply",key:t,style:r},s.a.createElement("span",{className:"lakex-table-select-item-text"},e.name||""))})))):l?s.a.createElement(xV,null):null})));class yJ extends s.a.Component{constructor(e){super(e),this._inputRefs=[],this.getDefaultOptions=()=>{const{configs:e,multiple:t}=this.props,{options:r,color:n}=e;let i=!!n;if(r&&r.length>0)return r.forEach((e=>{e.uuid||(e.uuid=Io(6)),typeof n>"u"&&(i=!!r[0]&&!!r[0].color)})),{options:r,multi:t,hasColor:i};const o=[{name:"",uuid:Io(6),color:"$label-back-color:0-0"},{name:"",uuid:Io(6),color:"$label-back-color:0-1"},{name:"",uuid:Io(6),color:"$label-back-color:0-2"}];return o.forEach(((e,t)=>{i&&!e.color&&(e.color=0===t?rk.getNextColor(""):rk.getNextColor(o[t-1].color))})),{options:o,multi:t,hasColor:i}},this.onAddItem=e=>{const{options:t}=this.state,r={name:"",uuid:Io(6),color:""},n=0===t.length?"":t[t.length-1].color;r.color=rk.getNextColor(n),t.push(r),this.setState({options:t.slice()},(()=>{this._optionListRef&&this._optionListRef.current&&(this._optionListRef.current.scrollTop=1e4),e&&this._inputRefs.length>1&&this._inputRefs[this._inputRefs.length-1].focus(),this.onChange()}))},this.onChangeItem=(e,t)=>{const r=e.target.value.trim(),{options:n}=this.state,i=[];n.forEach(((e,n)=>{const o=n===t?r:e.name;i.push({...e,name:o})})),this.setState({options:i},(()=>{this._inputRefs[t].focus(),this.onChange()}))},this.onDeleteItem=(e,t)=>{const{options:r}=this.state,n=r.filter(((e,r)=>r!==t));this._inputRefs.splice(t,1),this.setState({options:n},(()=>{this.onChange()}))},this.onChangeColor=(e,t)=>{const{options:r}=this.state,n=[];r.forEach((r=>{const i=r.uuid===e?t:r.color;n.push({...r,color:i})})),this.setState({options:n},(()=>{this.onChange()}))},this.toggleColor=e=>{const t=e.target.checked,{options:r}=this.state;t&&r[0]&&!r[0].color&&r.forEach(((e,t)=>{e.color=this.props.labelColor.getByIndex(t)})),this.setState({options:r,hasColor:t},(()=>{this.onChange()}))},this.beforeChange=e=>{this.setState({options:e},(()=>{this.onChange()}))},this.onPressEnter=e=>{e>=this.state.options.length-1?this.onAddItem(!0):this._inputRefs[e+1].input.focus()},this.onChangeOrder=(e,t)=>{const{options:r}=this.state,n=r.findIndex((t=>t.uuid===e)),i=r.findIndex((e=>e.uuid===t));this.setState({options:SP(r,n,i)},(()=>{this.props.onChangeOrder&&this.props.onChangeOrder(e,t),this.onChange()}))},this.state={options:[],multi:!1,hasColor:!1}}componentDidMount(){this._optionListRef=s.a.createRef();const{options:e,multi:t,hasColor:r}=this.getDefaultOptions();this.setState({options:e,multi:t,hasColor:r})}onChange(){const e={color:this.state.hasColor,options:[]},t=[];this.state.options.forEach((e=>{if(""===e.name)return;const r={name:e.name,uuid:e.uuid,color:this.state.hasColor?e.color:null};""!==e.name&&t.push(r)})),e.options=xd(t,(e=>e.name)),this.props.multiple&&(e.multi=!!this.state.multi),this.props.onChange&&this.props.onChange(e)}_ignoreSortableRule(e){return!(!(null==e?void 0:e.tagName)||"input"!==e.tagName.toLowerCase())}render(){const{options:e}=this.state;return e?s.a.createElement("div",{className:"col-config-select-options"},this.props.title,s.a.createElement("div",{className:"multi-select"},s.a.createElement(p.a,{size:"small",checked:!!this.state.hasColor,onChange:this.toggleColor,style:{marginLeft:12}}),kf("颜色")),s.a.createElement("div",{className:"option-list",ref:this._optionListRef},s.a.createElement(_J,{hasColor:this.state.hasColor,labelColor:this.props.labelColor,options:this.state.options,inputRefs:this._inputRefs,onChangeColor:this.onChangeColor,onChangeItem:this.onChangeItem,onDeleteItem:this.onDeleteItem,onPressEnter:this.onPressEnter,onChangeOrder:this.onChangeOrder,autoFocus:this.props.autoFocus})),s.a.createElement("div",{className:"select-options-add-item"+(this.state.hasColor?" colored":""),onClick:this.onAddItem},s.a.createElement(YP,{type:"Add"}),kf("添加一个选项"))):null}}const bJ=e=>{const t=zA(rk);return t?s.a.createElement(yJ,{labelColor:t,...e}):null},wJ=({hasColor:e,labelColor:t,option:r,index:n,inputRefs:i,autoFocus:o,onChangeColor:a,onChangeItem:l,onPressEnter:c,onDeleteItem:d})=>{const{attributes:p,listeners:h,setNodeRef:m,transform:v,transition:g,isDragging:y}=zP({id:r.uuid});let b=null;e&&(b=s.a.createElement(f.a,{placement:"leftTop",overlayClassName:"lakex-table-colorpicker",content:s.a.createElement(UA,{colorSource:[...YS],activeColor:r.color||"",onSelect:e=>{a(r.uuid,e)}})},s.a.createElement("span",{className:"option-color",style:{background:t.getRenderColor(r.color)}})));const w={transform:vN.Transform.toString(v),transition:g,zIndex:y?"100":"auto",opacity:y?.3:1};return s.a.createElement("div",{ref:m,className:"input-item",key:r.uuid,"data-id":r.uuid,style:w,...p},s.a.createElement("span",{className:"input-item-content"},b,s.a.createElement(u.a,{value:r.name,onChange:e=>{l(e,n)},onPressEnter:()=>{c(n)},ref:e=>{i[n]=e},autoFocus:o&&0===n}),s.a.createElement(YP,{type:"Delete",onClick:e=>{d(e,n)}})),s.a.createElement("div",{className:"input-item-drag",...h},s.a.createElement(YP,{type:"Drag"})))},_J=({autoFocus:e,hasColor:t,labelColor:r,options:n,inputRefs:i,onChangeColor:o,onChangeItem:a,onPressEnter:l,onDeleteItem:c,onChangeOrder:u})=>{const d=TN(RN(SM,{activationConstraint:{distance:8}}));return s.a.createElement(aP,{sensors:d,modifiers:[KP,WP],collisionDetection:LN,onDragEnd:async e=>{const{active:t,over:r}=e;t.id!==r.id&&u(t.id,r.id)}},s.a.createElement(jP,{items:n.map((e=>({...e,id:e.uuid}))),strategy:NP},n.map(((n,u)=>s.a.createElement(wJ,{key:n.uuid,option:n,index:u,hasColor:t,labelColor:r,inputRefs:i,onChangeColor:o,onChangeItem:a,onPressEnter:l,onDeleteItem:c,autoFocus:!!e})))))},CJ=({value:e,showEmpty:t})=>e?s.a.createElement("div",{className:"lakex-table-form-textarea-readonly"},e):t?s.a.createElement(xV,null):null,EJ=({id:e,focus:t,defaultValue:r="",renderMode:n,value:i,onChange:o})=>{const l=Object(a.useRef)(null),[c,d]=bV({value:i,defaultValue:r,onChange:o});return Object(a.useEffect)((()=>{t&&l.current&&l.current.focus({cursor:"end"})}),[t]),s.a.createElement("div",{className:`lakex-table-form-textarea lakex-table-form-textarea-render-mode-${n}`,id:e||""},s.a.createElement(u.a.TextArea,{defaultValue:r,value:c,autoSize:{minRows:1},placeholder:kf("请输入"),onChange:e=>{const t=e.target.value;d(t),null==o||o(t)},autoFocus:t,ref:l}))},xJ=({value:e,showEmpty:t})=>{const r=zA(MD);if(!e)return t?s.a.createElement(xV,null):null;return s.a.createElement("div",{className:"lakex-table-form-link-readonly"},s.a.createElement("a",{href:e.src,target:"_blank",onClick:t=>{t.defaultPrevented||(t.preventDefault(),t.stopPropagation(),null==r||r.open("link",e.src))}},e.name))},SJ=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{const{defaultValue:r,onSubmit:n=(()=>{}),onBlur:i=(()=>{}),style:o}=e,l=Object(a.useRef)(),c=s.a.useRef(null);Object(a.useImperativeHandle)(t,(()=>({getValues:()=>{var e;const t=null==(e=c.current)?void 0:e.getFieldsValue();return d(t)}}))),Object(a.useEffect)((()=>{l.current&&setTimeout((()=>{var e;null==(e=l.current)||e.focus({cursor:"end"})}),300)}),[]);const d=Object(a.useCallback)((e=>{const t={src:e.src||e.name||"",name:e.name||e.src||""};return{src:Fd(t.src)||`http://${t.src}`,name:t.name}}),[]),f=e=>{const t=d(e);n(t),i()};return s.a.createElement("div",{className:"lakex-table-link-editor",style:o||{},onKeyDown:e=>{var t;if(e.key===jx.ENTER){const e=null==(t=c.current)?void 0:t.getFieldsValue();f(e)}}},s.a.createElement(_.a,{initialValues:r,onFinish:f,ref:c},s.a.createElement(_.a.Item,{name:"name",label:kf("文本"),className:"lakex-table-link-editor-title"},s.a.createElement(u.a,{ref:l,placeholder:kf("请输入"),autoComplete:"off"})),s.a.createElement(_.a.Item,{name:"src",label:kf("链接"),className:"lakex-table-link-editor-link"},s.a.createElement(u.a,{placeholder:kf("请输入"),autoComplete:"off"})),s.a.createElement(_.a.Item,{className:"lakex-table-link-editor-footer"},s.a.createElement(b.a,{onClick:()=>i()},kf("取消")),s.a.createElement(b.a,{type:"primary",htmlType:"submit"},kf("确定")))))}))),kJ=({id:e,defaultValue:t,useLinkEditor:r,prefix:n,renderMode:i,onChange:o=(()=>{}),onBlur:l=(()=>{}),focus:c})=>{const d=zA(MD),{state:f,setVisible:p,checkLink:m,onInputChange:v,onSubmit:g}=(e=>{const{defaultValue:t,onChange:r}=e,[n,i]=Object(a.useState)((()=>Po(t)?{src:t.src,name:t.name}:t)),[o,s]=Object(a.useState)(!1);Object(a.useEffect)((()=>{i(n)}),[n]);const l=Object(a.useCallback)((e=>{i(e),r(e)}),[r]);return Object(a.useEffect)((()=>{const e=e=>{e.target.closest(".lakex-table-form-link-popover")||s(!1)};return document.body.addEventListener("click",e),()=>{document.body.removeEventListener("click",e)}}),[]),{state:{value:n,visible:o},setVisible:s,checkLink:e=>{e.target.closest(".lakex-table-form-link-anchor")&&(n||(e.preventDefault(),e.stopPropagation(),s(!0)))},onSubmit:l,onInputChange:e=>{let t,n;if(e.target){if(!e.target.value)return void r(null);n=e.target.value,t=Fd(e.target.value)}else t=e.src,n=e.name;const o={name:n,src:t};o.src||(o.src=o.name),o.name||(o.name=o.src),i(o),r(o)}}})({defaultValue:t,onChange:o});void 0===n&&(n=s.a.createElement(YP,{type:"FieldLink",size:14}));const y=r?"lakex-table-form-link-useeditor":"";return s.a.createElement("div",{className:`lakex-table-form-link ${y} lakex-table-form-link-render-mode-${i}`,id:e},!r&&s.a.createElement(u.a,{allowClear:!0,defaultValue:null==t?void 0:t.src,type:"text",placeholder:kf("请输入"),prefix:n,onChange:v,autoFocus:c,onBlur:l}),r&&s.a.createElement(w.a,{overlayClassName:"lakex-table-form-link-popover",destroyTooltipOnHide:!0,overlay:s.a.createElement(SJ,{defaultValue:t,onSubmit:g,onBlur:()=>p(!1)}),visible:f.visible},s.a.createElement(s.a.Fragment,null,f.value&&(f.value.src||f.value.name)?s.a.createElement("a",{href:"#javascript",target:"_blank",className:"lakex-table-form-link-anchor",onClick:e=>{var t;e.defaultPrevented||(e.preventDefault(),e.stopPropagation(),null==d||d.open("link",null==(t=f.value)?void 0:t.src),m(e))}},f.value.name):s.a.createElement(u.a,{allowClear:!0,defaultValue:null==t?void 0:t.src,type:"text",placeholder:kf("请输入"),onBlur:v,onPressEnter:v,autoFocus:c}),s.a.createElement(h.a,{title:kf("编辑链接")},s.a.createElement(YP,{className:"lakex-table-link-editor-action",type:"FieldLink",size:14,onClick:()=>p(!0)})))))},OJ=Fi.defineToken("ToolbarServiceToken"),IJ=Fi.defineToken("ToolbarContribution");var RJ;(e=>{e.isCustom=function(e){return!!e.RenderComponent},e.isNormal=function(e){return!!e.tooltip}})(RJ||(RJ={}));var TJ=(e=>(e.NORMAL="normal",e.LITE="lite",e))(TJ||{}),AJ=Object.defineProperty,NJ=Object.getOwnPropertyDescriptor,MJ=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?NJ(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&AJ(t,r,o),o};let PJ=class{constructor(){this._items=new Map,this._customItems=new Map,this.isInit=!1}init(){var e;if(this.isInit)return;this.isInit=!0;const t=this.toolbarPluginProvider.getContributions();for(const r of t)try{null==(e=r.registerToolbar)||e.call(r,this)}catch(e){console.error(e)}}registerRender(e){this._toolbarRender=e}registerItem(e){if(RJ.isCustom(e))this._registerCustomItem(e);else{if(!RJ.isNormal(e))throw new Error("An invalid toolbar item!");this._registerNormalItem(e)}return e}getToolbarItem(e){return this._items.get(e)}getCustomItem(e){return this._customItems.get(e)}getRender(){return this._toolbarRender}unregisterItem(e){const t="string"==typeof e?e:e.id,r=this.getToolbarItem(t),n=this.getCustomItem(t);r&&this._items.delete(t),n&&this._customItems.delete(t)}get hasToolbars(){return this._customItems.size>0||this._items.size>0}_registerNormalItem(e){const{id:t}=e;if(this._items.has(t))throw new Error(`A normal toolbar item is already registered with the '${t}'`);this._items.set(t,e)}_registerCustomItem(e){const{id:t}=e;if(this._customItems.has(t))throw new Error(`A custom toolbar item is already registered with the '${t}'`);this._customItems.set(t,e)}destroy(){this._items.clear(),this._customItems.clear(),this._toolbarRender=null}};MJ([Eo(IJ)],PJ.prototype,"toolbarPluginProvider",2),MJ([Si()],PJ.prototype,"destroy",1),PJ=MJ([eo()],PJ);const jJ=()=>{},DJ=({id:e,isActive:t,isDisable:r,isShowIcon:n,isShowTitle:i,iconType:o,iconSize:a,titleFontSize:l,tooltipStr:c,onCommand:u})=>s.a.createElement("button",{className:GA({"lakex-workbench-toolbar-button":!0,"lakex-workbench-toolbar-button-active":t,"lakex-workbench-toolbar-button-disable":r}),id:e,onClick:e=>{r||u(e)},tabIndex:-1},n&&o&&s.a.createElement(YP,{type:o,size:a}),i&&s.a.createElement("span",{className:"toolbar-button-title",style:{fontSize:l}},c)),FJ=({onCommand:e=jJ,id:t,tooltip:r,showTooltip:n=!1,disable:i,active:o,showIcon:a=!0,showTitle:l=!0,icon:c,iconSize:u=16,titleFontSize:d=14,visible:f=!1})=>{const p=Ao(i)?i():i,m=Ao(o)?o():o,v=Ao(a)?a():a,g=Ao(c)?c():c,y=Ao(l)?l():l,b=Ao(r)?r():r;return(Ao(f)?f():f)?n?s.a.createElement(h.a,{title:b},s.a.createElement("div",null,s.a.createElement(DJ,{id:t,isDisable:p,isActive:m,isShowIcon:v,isShowTitle:y,iconSize:u,iconType:g,tooltipStr:b,titleFontSize:d,onCommand:e}))):s.a.createElement(DJ,{id:t,isDisable:p,isActive:m,isShowIcon:v,isShowTitle:y,iconSize:u,iconType:g,tooltipStr:b,titleFontSize:d,onCommand:e}):null},VJ=()=>s.a.createElement("div",{className:"lakex-table-workbench-toolbar-btn lake-workbench-toolbar-divider"});var LJ=Object.defineProperty,$J=Object.getOwnPropertyDescriptor,BJ=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?$J(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&LJ(t,r,o),o};let zJ=class extends Zf{constructor(){super(...arguments),this._$ref=s.a.createRef(),this._toolbarRef=s.a.createRef(),this._onChange=this._register(new op),this.onChange=this._onChange.event,this.Buttons=({buttons:e,mode:t})=>Array.isArray(e)?s.a.createElement(s.a.Fragment,null,e.map(((e,r)=>s.a.createElement(s.a.Fragment,{key:r},this._renderButtonItem(e,t))))):s.a.createElement(s.a.Fragment,null)}init(){this._toolbarRegistry.init()}getDom(){return this._$ref.current}render(){const e=this._toolbarRegistry.getRender();return e?s.a.createElement("div",{className:"lakex-table-workbench-toolbar-container",style:{width:"100%"},ref:this._$ref},s.a.createElement(e,{ref:this._toolbarRef})):null}rerender(){this._toolbarRef.current&&this._toolbarRef.current.refresh()}filterVisibleButtons(e){return e?e.filter((e=>{const t=this._toolbarRegistry.getCustomItem(e);if(t)return!(null==t||!t.RenderComponent);const r=this._toolbarRegistry.getToolbarItem(e);return!(!r||!r.visible)&&(Ao(r.visible)?r.visible():r.visible)})).filter(((t,r)=>!!("|"!==t||e[r-1]&&e[r+1]))):[]}_renderButtonItem(e,t=TJ.NORMAL){const r=this._toolbarRegistry.getCustomItem(e);if(r){const{RenderComponent:e,...t}=r;return s.a.createElement(e,{onCommand:e=>{var r;null==(r=t.onClick)||r.call(t,{target:e.currentTarget})}})}const n=this._toolbarRegistry.getToolbarItem(e);if(n){const{visible:e,onClick:r,...i}=n;return t===TJ.LITE&&(NA(i.showTitle)&&(i.showTitle=!1),NA(i.showTooltip)&&(i.showTooltip=!0)),s.a.createElement(FJ,{visible:e,onCommand:e=>{null==r||r({target:e.currentTarget})},...i})}return"|"===e&&this._toolbarRegistry.hasToolbars?s.a.createElement(VJ,null):null}destroy(){super.destroy(),this._$ref.current=null,this._toolbarRef.current=null}};BJ([to(PJ)],zJ.prototype,"_toolbarRegistry",2),BJ([Si()],zJ.prototype,"destroy",1),zJ=BJ([eo({token:OJ})],zJ);var UJ=Object.defineProperty,HJ=Object.getOwnPropertyDescriptor,WJ=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?HJ(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&UJ(t,r,o),o};let GJ=class{init(){this._toolbarRegistry.init()}};WJ([to(PJ)],GJ.prototype,"_toolbarRegistry",2),GJ=WJ([eo({contrib:[PA]})],GJ);const KJ=bo().contribution(IJ).register(GJ).register(zJ).register(PJ);var qJ=Object.defineProperty,YJ=Object.getOwnPropertyDescriptor,XJ=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?YJ(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&qJ(t,r,o),o};const ZJ=1004;let JJ=class{init(){this.zIndex={...this._renderZIndexService.zIndex,mask:ZJ,modalRenderBase:1005,modalFromRender:1006,modalFromToolbar:1007,expandRecord:1008,modalFromExpandRecord:1009,modalMessage:1010}}get maxZIndex(){const e=Object.values(this.zIndex);return Math.max(...e)}};var QJ;XJ([to(oD)],JJ.prototype,"_renderZIndexService",2),XJ([xi()],JJ.prototype,"init",1),JJ=XJ([eo()],JJ),(e=>{e.isAbsolutePosi=function(e){return e&&!jo(e.left)&&!jo(e.top)},e.isAttachRefPosi=function(e){return e&&!!e.placement&&!!e.origin}})(QJ||(QJ={}));var eQ=(e=>(e.MODAL="modal",e.DRAWER="drawer",e))(eQ||{});const tQ=Fi.defineToken("ModalServiceToken"),rQ=Fi.defineToken("ModalContribution");var nQ=Object.defineProperty,iQ=Object.getOwnPropertyDescriptor,oQ=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?iQ(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&nQ(t,r,o),o};let aQ=class{constructor(){this._modals=new Map,this._hasInit=!1}init(){if(this._hasInit)return;this._hasInit=!0;const e=this._modalPluginProvider.getContributions();for(const t of e)try{t.registerModal(this)}catch(e){console.error(e)}}registerItem(e){const{id:t}=e;this._modals.has(t)&&this._modals.delete(t),this._modals.set(t,e)}getModalItem(e){return this._modals.get(e)}getModalItems(){return[...this._modals.values()]}};oQ([Eo(rQ)],aQ.prototype,"_modalPluginProvider",2),aQ=oQ([eo()],aQ);var sQ=Object.defineProperty,lQ=Object.getOwnPropertyDescriptor,cQ=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?lQ(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&sQ(t,r,o),o};let uQ=class extends Zf{constructor(){super(...arguments),this._$scrollContainer=null,this._hasScrollListener=!1,this._scrolledCount=0,this._onScrollEmitter=this._register(new op),this._onScroll=this._onScrollEmitter.event,this._scrolledDistance=0,this._scrollHandler=e=>{this._getScrollDistance(e),this._scrolledDistance>10&&this._onScrollEmitter.emit()}}attachScrollContainer(e){!e||(this._$scrollContainer=e)}attachScrollListener(e,t){this._hasScrollListener||this._addGlobalScrollListener();const r=this._onScroll((()=>{e()}));return this._scrolledCount++,{destroy:()=>{this._scrolledCount--,r.destroy(),this._scrolledCount<=0&&this._removeGlobalScrollListener()}}}_getScrollDistance(e){const t=Math.abs(e.deltaX),r=Math.abs(e.deltaY);this._scrolledDistance=r||t}_addGlobalScrollListener(){!this._$scrollContainer||this._$scrollContainer.addEventListener("wheel",this._scrollHandler,{passive:!0})}_removeGlobalScrollListener(){!this._$scrollContainer||this._$scrollContainer.removeEventListener("wheel",this._scrollHandler)}destroy(){super.destroy()}};cQ([Si()],uQ.prototype,"destroy",1),uQ=cQ([eo()],uQ);const dQ=e=>{const t=Object(a.useRef)(null),r=zA(uQ);Object(a.useEffect)((()=>{r.attachScrollContainer(t.current);const n=r.attachScrollListener((t=>{"block"===e.scrollStrategy?(t.preventDefault(),t.stopPropagation()):"close"===e.scrollStrategy&&e.onScrollAutoClose()}));return()=>{n.destroy()}}),[]);const n={zIndex:e.zIndex,opacity:e.visible?1:0,...e.style&&e.style};return e.enable?s.a.createElement("div",{className:"lakex-workbench-modal-mask",onClick:t=>{e.maskClick&&e.maskClick(),t.preventDefault()},style:n,ref:t,onContextMenu:e=>(e.preventDefault(),!1)}):null};function fQ(e){return Mo(e)&&e.endsWith("%")}function pQ(e){return Mo(e)&&e.startsWith("calc(")}function hQ(e){return fQ(e)||pQ(e)}function mQ(e){return!function(e){return ka(e)&&1===e.nodeType&&!ec(e)}(e)}function vQ(e,t){if(!e)return 0;if(pQ(e)){if((e=e.replace(/^(\s|calc\()+|(\s|\))+$/g,"")).includes("%")){const[r,n]=e.split("%");return CA(parseInt(r,10)/100*t+n)}}else if(fQ(e)){const r=e.replace("%","");return parseInt(r,10)/100*t}return 0}const gQ=e=>{var t,r,n;const i=e.id,o=cj(),l=zA(tQ),c=l.visibleList.includes(i),u=Object(a.useRef)(null),[d,f,p,h]=yV(),m=Object(a.useRef)(null),v=Object(a.useRef)(null),g=Object(a.useMemo)((()=>l.isDisableEscClose(i)),[i]),y=Object(a.useMemo)((()=>l.isDisableClickAwayClose(i)),[i]);Object(a.useEffect)((()=>{const e=l.onChange((e=>{const t=Date.now();v.current=t,o()}));return()=>{e.destroy()}}),[]),vV("esc",(t=>{g||(t.preventDefault(),l.close(e.id))})),Object(a.useLayoutEffect)((()=>{u.current?c?f(u.current):p(u.current):p()}),[u,c]),Object(a.useEffect)((()=>{let e;const t=l.onUpdatePosition((t=>{t.modalId===i&&(clearTimeout(e),e=So((()=>{var e;const t=null==(e=u.current)?void 0:e.getBoundingClientRect();h(t||null)})))}));return()=>{t.destroy(),clearTimeout(e)}}),[]);const b=Object(a.useMemo)((()=>{if(l.getModalProps(e.id).mode!==eQ.DRAWER)return l.getPosition(e.id,d)}),[e.id,d,null==d?void 0:d.height,null==d?void 0:d.width,v.current]);if(!c)return null;const w=l.getModalProps(e.id),_={left:null!=(t=null==b?void 0:b.left)?t:"initial",top:null!=(r=null==b?void 0:b.top)?r:"initial"},C={},E=(null==(n=null==w?void 0:w.position)?void 0:n.placement)||"";if(QJ.isAttachRefPosi(w.position)&&"cover"===E){const e=mQ(w.position.origin)?w.position.origin:w.position.origin.getBoundingClientRect();_.width=null==e?void 0:e.width,_.height=null==e?void 0:e.height,C.width="100%",C.height="100%"}const x=()=>{var t;null==(t=m.current)||t.onCloseByClickAwayOrScroll(),l.close(e.id)},S=e.RenderComponent,k=null!=w.hasMask?w.hasMask:e.showMask;return s.a.createElement("div",{className:GA("lakex-workbench-modal-container",{hasAnimation:e.hasAnimation,hasMask:k,[`lakex-workbench-modal-container-mode-${w.mode}`]:!0,[`lakex-workbench-modal-container-placement-${E}`]:!0}),style:{zIndex:e.zIndex,visibility:b||w.mode!==eQ.MODAL?"visible":"hidden"}},s.a.createElement(dQ,{zIndex:e.maskZIndex,scrollStrategy:e.scrollStrategy,style:e.maskStyle,maskClick:x,onScrollAutoClose:x,enable:!y,visible:k}),s.a.createElement("div",{className:"lakex-workbench-modal-layout",style:{zIndex:e.zIndex,...w.mode===eQ.MODAL&&b&&_}},s.a.createElement("div",{className:"lakex-workbench-modal-content",ref:u,style:{...C}},s.a.createElement(S,{...w,ref:m}))))},yQ=({initialState:e})=>{const{message:t=""}=e,r=zA(tQ),[n,i]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{i(!0);const e=setTimeout((()=>{r.close("tooltip")}),2e3);return()=>{clearTimeout(e)}}),[t]),s.a.createElement("div",{className:GA("lakex-table-tooltip",{"lakex-table-tooltip-active":n,"lakex-table-tooltip-placement-top":!0})},s.a.createElement("div",{className:"lakex-table-tooltip-message"},t))},bQ=Fi.defineToken("ViewportServiceToken");var wQ=Object.defineProperty,_Q=Object.getOwnPropertyDescriptor,CQ=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?_Q(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&wQ(t,r,o),o};let EQ=class{getPosition(e,t){if(ad(t)||ad(t.width)||ad(t.height))return null;let r=null;return QJ.isAbsolutePosi(e)?r=this._calculateAbsolutePosition(e,t):QJ.isAttachRefPosi(e)&&(r=this._calculateAutoPlacementPosition(e,t)),(null==r?void 0:r.top)&&Number(r.top)<0&&(r.top=0),(null==r?void 0:r.left)&&Number(r.left)<0&&(r.left=0),!r||AA(r.left)||AA(r.top)?(console.warn("modal size has conflicts with the placement in this origin and viewport"),null):r}_calculateAbsolutePosition(e,t){const r={left:e.left,top:e.top},n=this._getBoundingBox(),{width:i,height:o}=n,a=(null==t?void 0:t.height)||0,s=(null==t?void 0:t.width)||0;if(hQ(e.left)){const t=vQ(e.left,i);r.left=t-Math.floor(s/2)}if(hQ(e.top)){const t=vQ(e.top,o);r.top=t-Math.floor(a/2)}return r}_calculateAutoPlacementPosition(e,t){if(!t)return null;const r=mQ(e.origin)?e.origin:e.origin.getBoundingClientRect(),n=this._getBoundingBox(),i=(null==t?void 0:t.width)||0,o=(null==t?void 0:t.height)||0,a=e.placement,s=this.getRenderRangeBox(r,a,o,i);if(this._rectIsContain(s,n))return{left:s.left,top:s.top};const l={left:s.left,top:s.top},c=s.top+s.height>n.bottom,u=s.top<n.top;if(c||u){const e=this._autoLayoutWithMinimalOffset(r.top,o,[n.top,n.bottom]);l.top=e}const d=s.left+s.width>n.right;if(s.left<n.left||d){const e=this._autoLayoutWithMinimalOffset(r.left,i,[n.left,n.right]);l.left=e}return l}_autoLayoutWithMinimalOffset(e,t,[r,n]){const i=e+t+5;return e>r&&i<n?e:e<r?e+=r-e:i>n?e-=i-n:0}_getBoundingBox(){return this._viewportService.getViewportRect()}getRenderRangeBox(e,t,r,n){const i={left:0,top:0,width:n,height:r};if("top"===t&&(i.top=e.top-r-5),("bottom"===t||"bottomRight"===t)&&(i.top=e.top+e.height+5),("top"===t||"bottom"===t)&&(i.left=e.left-0),"left"===t&&(i.left=e.left-n-5),"bottomRight"===t&&(i.left=e.left+e.width-n),"right"===t&&(i.left=e.left+e.width+5),"left"===t||"right"===t){const t=Math.ceil((r-e.height)/2);i.top=e.top-t}return"cover"===t&&(i.left=e.left,i.top=e.top,i.width=n,i.height=r),i}_rectIsContain(e,t){if(e.left<0||e.top<0)return!1;const[r,n,i,o]=[e.left,e.top,e.left+e.width,e.top+e.height],[a,s,l,c]=[t.left,t.top,t.left+t.width,t.top+t.height];return r>=a&&n>=s&&i<=l&&o<=c}};CQ([to(bQ)],EQ.prototype,"_viewportService",2),EQ=CQ([eo()],EQ);var xQ=Object.defineProperty,SQ=Object.getOwnPropertyDescriptor,kQ=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?SQ(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&xQ(t,r,o),o};const OQ="lakex-workbench-global-modal-container";let IQ=class extends Zf{constructor(){super(...arguments),this._onBeforeClose=this._register(new op),this.onBeforeClose=this._onBeforeClose.event,this._onUpdatePosition=this._register(new op),this.onUpdatePosition=this._onUpdatePosition.event,this._visibleList=[],this._visibleListOpenArgs=new Map,this._toDestroyList=new ep,this._onChange=this._register(new op),this.onChange=this._onChange.event,this._onAppend=this._register(new op),this.onAppend=this._onAppend.event}init(){this._modalRegistry.init(),this._innerModalRegister()}destroy(){this._toDestroyList.destroy()}_innerModalRegister(){this._modalRegistry.registerItem({id:"tooltip",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromRender",disableClickAwayClose:!0,disableEscClose:!0,RenderComponent:yQ})}showTooltip(e,t){this.open("tooltip",{position:t,initialState:{message:e}})}confirm(e){const t=this._zIndexService.maxZIndex,r=e.type||"confirm",n={...e,zIndex:t,getContainer:this._getOrCreateRoot()};C.a[r](n)}open(e,t){t&&this._visibleListOpenArgs.set(e,t),this._addVisible(e)}close(e){this._removeVisible(e),this._visibleListOpenArgs.delete(e)}closeTopVisible(){if(!this._hasVisibleModal())return;const e=this.getTopVisibleModalId();this._removeVisible(e)}getTopVisibleModalId(){return this._visibleList[this._visibleList.length-1]}_hasVisibleModal(){return this._visibleList.length>0}closeAll(){this._removeVisible()}getPosition(e,t){var r;const n=this._visibleListOpenArgs.get(e),i=null==(r=this._modalRegistry.getModalItem(e))?void 0:r.position,o=(null==n?void 0:n.position)||i;return o?this._modalLayoutService.getPosition(o,t):null}emitUpdatePosition(e){this._onUpdatePosition.emit({modalId:e})}getModalProps(e){var t;const r={...this._modalRegistry.getModalItem(e),...this._visibleListOpenArgs.get(e)||{}};return r.mode===eQ.DRAWER&&!(null!=(t=r.position)&&t.placement)&&(r.position={placement:"right"}),{...r,mode:r.mode||eQ.MODAL,position:r.position||{},initialState:r.initialState||{}}}render(){const e=this._modalRegistry.getModalItems();return e?e.map((e=>this.getRenderModal(e))):null}getRenderModal(e){const{id:t,RenderComponent:r,hasMask:n,mode:i=eQ.MODAL,zIndex:o="modalFromToolbar",scrollStrategy:a="block",maskStyle:l,hasAnimation:u=!1}=e,d=this._zIndexService.zIndex[o],f=this._zIndexService.zIndex.mask,p=s.a.createElement(gQ,{id:t,key:t,mode:i,showMask:n,maskStyle:l||{},zIndex:d,maskZIndex:f,scrollStrategy:a,hasAnimation:u,RenderComponent:r});return c.a.createPortal(p,this._getOrCreateRoot())}get visibleList(){return this._visibleList}_getModalRegisterInfo(e){return this._modalRegistry.getModalItem(e)}isModalVisible(e){return this._visibleList.includes(e)}isDisableEscClose(e){var t;return!(null==(t=this._getModalRegisterInfo(e))||!t.disableEscClose)}isDisableClickAwayClose(e){var t;return!(null==(t=this._getModalRegisterInfo(e))||!t.disableClickAwayClose)}_getOrCreateRoot(){const e=this._configurationService.getValue("modal.customModalContainer")||document.body;let t=e.querySelector(`.${OQ}`);if(!t){const r=document.createElement("div");r.classList.add(OQ),e.appendChild(r),t=r}return t}_addVisible(e){if(!this._isValidModal(e))return;const t=this._visibleList,r=[...new Set(t.concat(e))];this._notify(r)}_removeVisible(e){if(e&&!this._isValidModal(e))return;const t=this._visibleList;let r=[];if(e){if(!this._modalRegistry.getModalItem(e))return void console.error(`The Compo: ${e} is not registered`);r=t.filter((t=>t!==e)),this._onBeforeClose.emit({modalId:e})}else t.forEach((e=>{this._onBeforeClose.emit({modalId:e})}));this._notify(r)}_isValidModal(e){return Boolean(this._modalRegistry.getModalItem(e))}_notify(e){this._visibleList=e,this._onChange.emit(this._visibleList)}emitAppendEvent(e){return this._onAppend.emit(e)}};kQ([to(aQ)],IQ.prototype,"_modalRegistry",2),kQ([to(JJ)],IQ.prototype,"_zIndexService",2),kQ([to(EQ)],IQ.prototype,"_modalLayoutService",2),kQ([to(qf)],IQ.prototype,"_configurationService",2),kQ([Si()],IQ.prototype,"destroy",1),IQ=kQ([eo({token:tQ,contrib:[PA]})],IQ);var RQ=Object.defineProperty,TQ=Object.getOwnPropertyDescriptor,AQ=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?TQ(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&RQ(t,r,o),o};let NQ=class{getRenderViewPort(){return this._renderContext.$root.getBoundingClientRect()}getViewportRect(){const e=document.documentElement.getBoundingClientRect();return new DOMRect(e.x,0,e.width,e.height)}};AQ([to(Uj)],NQ.prototype,"_renderContext",2),NQ=AQ([eo({token:bQ})],NQ);const MQ=bo().contribution(rQ).register(IQ).register(aQ).register(uQ).register(EQ).register(JJ).register(NQ),PQ=e=>{const t=zA(aQ),r=zA(tQ);return Object(a.useEffect)((()=>{null==t||t.registerItem(e),null==r||r.emitAppendEvent(e.id)}),[]),s.a.createElement(s.a.Fragment,null)};class jQ extends s.a.PureComponent{constructor(e){super(e),this._$renderRef=s.a.createRef(),this._toDestroyCollection=[],this.state={isRenderReady:!1,isWorkbenchReady:!1,key:+new Date}}componentDidMount(){this.props.attachRender(this._$renderRef.current);const{container:e}=this.props;this.toolbarService=e.get(OJ),this.modalService=e.get(tQ),this.setState({isRenderReady:!0}),this.props.initWorkbench(),this.setState({isWorkbenchReady:!0}),this.modalService.onAppend((e=>{this.forceUpdate()})),e.get(ib).log({type:"workbench",action:"workbenchReady"})}componentWillUnmount(){this._toDestroyCollection.forEach((e=>e.destroy()))}_getWorkbenchRender(){const{isWorkbenchReady:e}=this.state;return e?s.a.createElement(s.a.Fragment,null,s.a.createElement(rj,{onError:this.props.onError},this.toolbarService.render()),s.a.createElement(rj,{onError:this.props.onError},this.modalService.render())):null}render(){const e=this.props.container;return s.a.createElement(s.a.Fragment,null,s.a.createElement(rj,{onError:this.props.onError},s.a.createElement(E.a,{prefixCls:"ant"},s.a.createElement(BA,{value:{container:e,onError:this.props.onError},key:this.state.key},s.a.createElement("div",{className:"lakex-table-workbench-container"},this._getWorkbenchRender(),s.a.createElement(rj,{onError:this.props.onError},s.a.createElement("div",{className:"lakex-table-render-container",ref:this._$renderRef,onContextMenu:e=>e.preventDefault()})))))))}}class DQ extends Ih{constructor(e){super(),this.render=null,this._options=e||{},this.$root=e.$root,this.container=e.container,this._loadCoreServices(),this.registerPlugins(e.plugins,{container:this.container}),this._registerContribs(e.contribs),this._mountComponent(),this._logger.log({type:"workbench",action:"workbenchInited",data:e})}attachRender(e){this._options.renderService.initDom(e,this.$root)}initWorkbench(){this._workbenchRegistry.init(),this.container.get(yf).status=gf.WorkbenchInited}destroy(){var e;null==(e=this.render)||e.destroy(),this._workbenchRegistry.destroy(),this.unregisterPlugins(this.container),this._unMountComponent()}_loadCoreServices(){this.container.register({token:LA,useValue:{$root:this.$root}}),this._workbenchRegistry=this.container.get(VA)}get _logger(){return this.container.get(ib)}_mountComponent(){c.a.render(s.a.createElement(jQ,{key:+new Date,container:this.container,attachRender:e=>this.attachRender(e),initWorkbench:()=>this.initWorkbench(),onError:this._options.onError}),this.$root)}_unMountComponent(){c.a.unmountComponentAtNode(this.$root)}_registerContribs(e){if(e)for(const t of e)this.container.register(t)}}var FQ=Object.defineProperty,VQ=Object.getOwnPropertyDescriptor,LQ=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?VQ(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&FQ(t,r,o),o};const $Q=1004;let BQ=class{init(){this.zIndex={...this._renderZIndexService.zIndex,mask:$Q,modalRenderBase:1005,modalFromRender:1006,modalFromToolbar:1007,expandRecord:1008,modalFromExpandRecord:1009,modalMessage:1010}}get maxZIndex(){const e=Object.values(this.zIndex);return Math.max(...e)}};LQ([to(oD)],BQ.prototype,"_renderZIndexService",2),LQ([xi()],BQ.prototype,"init",1),BQ=LQ([eo()],BQ);const zQ=bo().contribution(PA).register(BQ).register(VA);class UQ{constructor(){this.kernelContainer=Co.createChild(),this.renderContainer=this.kernelContainer.createChild(),this.workbenchContainer=this.renderContainer.createChild()}init(){this._loadGlobalServices(),this._loadKernelServices(),this._loadRenderServices(),this._loadWorkbenchServices()}destroy(){this._unloadGlobalServices(),this._unloadKernelServices(),this._unloadRenderServices(),this._unloadWorkbenchServices()}_loadGlobalServices(){this.kernelContainer.load(ik,!0),this.kernelContainer.load(cb,!0),this.kernelContainer.load(bp,!0)}_unloadGlobalServices(){this.kernelContainer.unload(ik),this.kernelContainer.unload(cb),this.kernelContainer.unload(bp)}_loadKernelServices(){this.kernelContainer.load(Gp,!0),this.kernelContainer.load(gb,!0),this.kernelContainer.load(Ob,!0),this.kernelContainer.load(Zv,!0),this.kernelContainer.load(n_,!0),this.kernelContainer.load(Rw,!0),this.kernelContainer.load(c_,!0),this.kernelContainer.load(eb,!0)}_unloadKernelServices(){this.kernelContainer.unload(Gp),this.kernelContainer.unload(gb),this.kernelContainer.unload(Ob),this.kernelContainer.unload(Zv),this.kernelContainer.unload(n_),this.kernelContainer.unload(Rw),this.kernelContainer.unload(c_),this.kernelContainer.unload(eb)}_loadRenderServices(){this.renderContainer.load(nk,!0),this.renderContainer.load(GS,!0),this.renderContainer.load(rF,!0),this.renderContainer.load(sZ,!0),this.renderContainer.load(sV,!0),this.renderContainer.load(AZ,!0),this.renderContainer.load(QF,!0)}_unloadRenderServices(){this.renderContainer.unload(nk),this.renderContainer.unload(GS),this.renderContainer.unload(rF),this.renderContainer.unload(sZ),this.renderContainer.unload(sV),this.renderContainer.unload(AZ),this.renderContainer.unload(QF)}_loadWorkbenchServices(){this.workbenchContainer.load(zQ,!0),this.workbenchContainer.load(KJ,!0),this.workbenchContainer.load(MQ,!0)}_unloadWorkbenchServices(){this.workbenchContainer.unload(zQ),this.workbenchContainer.unload(KJ),this.workbenchContainer.unload(MQ)}}class HQ{init(e,t){this.kernelContainer=e.kernelContainer,this.renderContainer=e.renderContainer,this.workbenchContainer=e.workbenchContainer,this.configurationService=this.kernelContainer.get(qf),this._registerKernelConfig(t.kernelPlugins),this._registerRenderConfig(t.renderPlugins),this._registerWorkbenchConfig(t.workbenchPlugins),this._setInitConfigData(t.settings)}_registerKernelConfig(e){this.configurationService.registerConfiguration({id:"development",type:"object",title:"开发配置",properties:{disableReactDevTools:{type:"boolean",description:"是否禁用 react 开发工具"}}}),this.configurationService.registerDefaultValue({"development.disableReactDevTools":!0}),this.registerPluginConfiguration(e,this.configurationService)}_registerRenderConfig(e){this.renderContainer.get(JF).initConfiguration(),this.renderContainer.get(TZ).initConfiguration(),this.configurationService.registerConfiguration({id:"render",type:"object",title:"渲染",properties:{noRecord:{type:"boolean",description:"不渲染 record 数据，表单提交编辑器不需要加载 record"},showFieldIcon:{type:"boolean",description:"是否展示字段 icon"},mode:{type:"string",description:"通用渲染模式",enum:Object.values(Pj)},autoActive:{type:"boolean",description:"是否自动激活"}}}),this.configurationService.registerDefaultValue({"render.noRecord":!1,"render.showFieldIcon":!0,"render.mode":Pj.NORMAL,"render.autoActive":!0}),this.registerPluginConfiguration(e,this.configurationService)}_registerWorkbenchConfig(e){this.configurationService.registerConfiguration({id:"workbench",type:"object",title:"Workbench",properties:{toolbar:{type:"object",properties:{visible:{type:"boolean",description:"是否显示工具栏"}}}}}),this.configurationService.registerDefaultValue({"workbench.toolbar.visible":!0}),this.configurationService.registerConfiguration({id:"modal",type:"object",title:"弹出窗",properties:{mode:{type:"string",description:"通用弹出层模式",enum:Object.values(eQ)},customModalContainer:{type:"object",description:"自定义弹出层容器，类型为 HTMLElement | undefined"}}}),this.configurationService.registerDefaultValue({"modal.mode":eQ.MODAL,"modal.customModalContainer":void 0}),this.registerPluginConfiguration(e,this.configurationService)}_setInitConfigData(e){e&&this.configurationService.setValue(e)}registerPluginConfiguration(e,t){!e||e.forEach((e=>{e.registerConfiguration&&e.registerConfiguration(t)}))}}_o.config({lifecycle:Fi.Lifecycle.singleton});class WQ{constructor(e){this._destroy=!1,this._containerService=new UQ,this._configService=new HQ,this._errors=[],this._reactErrors=[],this._options=e,Sf.setLanguage(e.lang),this._containerService.init(),this._loadCoreServices(),this._lifeService.status=gf.Init,this._configService.init({kernelContainer:this._containerService.kernelContainer,renderContainer:this._containerService.renderContainer,workbenchContainer:this._containerService.workbenchContainer},e),this._configService.configurationService.getValue("development.disableReactDevTools")&&(()=>{const e=()=>{},t=window.__REACT_DEVTOOLS_GLOBAL_HOOK__;if("object"==typeof t)for(const[r,n]of Object.entries(t))t[r]="function"==typeof n?e:null})(),this._lifeService.status=gf.Configed,MA.isTraceDi&&this._addContainerSlowLog(),this.kernel=new l_({container:this._containerService.kernelContainer,plugins:this._filterPlugins(e.kernelPlugins),contribs:e.kernelContribs,settings:e.settings,data:e.data}),this.render=new eV({container:this._containerService.renderContainer,plugins:this._filterPlugins(e.renderPlugins),contribs:e.renderContribs,kernelService:this.kernel.kernelService,onError:(e,t)=>{var r,n;e&&this._errors.push(e),t&&this._reactErrors.push(t),null==(n=(r=this._options).onError)||n.call(r,e,t)}}),this.workbench=new DQ({$root:this.$root,container:this._containerService.workbenchContainer,plugins:this._filterPlugins(e.workbenchPlugins),contribs:e.workbenchContribs,renderService:this.render.renderService,onError:(e,t)=>{var r,n;e&&this._errors.push(e),t&&this._reactErrors.push(t),null==(n=(r=this._options).onError)||n.call(r,e,t)}}),this._logger.log({type:"core",action:"editorInited",data:e}),e.onDataLoaded&&this.kernel.onDataLoaded(e.onDataLoaded),this.kernel.onFinishExecuteCommand((e=>{var t,r;!e.context.isRemote&&e.type!==jb.Auto&&(null==(r=(t=this._options).onChange)||r.call(t))})),this._lifeService.when(gf.Rendered,(()=>{var t;null==(t=e.onRendered)||t.call(e)})),this._storage=this._containerService.kernelContainer.get(Nf),So((()=>{var t;null==(t=e.onLoad)||t.call(e,this)})),this.kernel.start()}get $root(){return this._options.$root}get readService(){return this._containerService.kernelContainer.get(Dy)}get commandService(){return this._containerService.kernelContainer.get(Pb)}get tableId(){return this.readService.getTable().uuid}get _logger(){return this._containerService.kernelContainer.get(ib)}_loadCoreServices(){this._lifeService=this._containerService.kernelContainer.get(yf)}_filterPlugins(e){const{disablePlugins:t,enablePlugins:r}=this._options;return r?e.filter((e=>r.some((t=>t.startsWith("workbench-")||t.startsWith("render-")||t.startsWith("kernel-")?t===e.pluginName:e.pluginName.replace(/^(workbench|render|kernel)-/,"")===t)))):t?e.filter((e=>!t.some((t=>t.startsWith("workbench-")||t.startsWith("render-")||t.startsWith("kernel-")?t===e.pluginName:e.pluginName.replace(/^(workbench|render|kernel)-/,"")===t)))):e}_addContainerSlowLog(){const e=function(e){let{settings:t,renderer:r}=e||{};return function(n){return null==t&&(t=$x),null==r&&(r=vf),r=>{let i=null;const o={error:!1,exception:null,guid:zx(),multiInject:r.isMultiInject,results:[],rootRequest:null,serviceIdentifier:r.serviceIdentifier,time:null},a=r.contextInterceptor;r.contextInterceptor=r=>(null!=t&&t.request&&(o.rootRequest=Bx(r.plan.rootRequest,t.request,null==e?void 0:e.filter)),a(r));try{const e=Vx();i=n(r);const a=Vx();o.results=i,o.time=null!=t&&t.time?Lx(e,a):null}catch(e){o.error=!0,o.exception=e,o.time=null}if(i)return i;throw new Error(o.exception.message)}}}({filter:e=>Number(e.time)>40});this._containerService.kernelContainer.container.applyMiddleware(e),this._containerService.renderContainer.container.applyMiddleware(e),this._containerService.workbenchContainer.container.applyMiddleware(e)}getService(e){return this._containerService.workbenchContainer.get(e)}getContent(){return this.kernel.getContent()}setContent(e){this.kernel.setContent(e)}setRecords(e,t){t&&this._storage.clear([bv.table]),this.kernel.setRecords(e)}setUsers(e){this.kernel.setUsers(e)}isEmptyTable(){return!(!this._destroy&&this.readService)||this.readService.isEmptyTable()}destroy(){this._destroy=!0,this.kernel.destroy(),this.render.destroy(),this.workbench.destroy(),this._containerService.destroy()}}const GQ=null;Sf.setData({"$1 条记录":"$1 records","$1个筛选":"$1 filters","(空)":"(Empty)","上一个":"Previous","上一张":"Previous","上一条记录":"Prev row","上传失败":"Upload failure","上传失败，请重试":"Upload failure, please retry","上传超时，请重试":"Upload timeout, please retry","上周":"Last week","上月":"Last month","下一个":"Next","下一张":"Next","下一条记录":"Next row","下周":"Next week","下月":"Next month","下载图片":"Download Picture","不包含":"Not contains","不存在对应字段":"There is no corresponding field","不存在对应选项":"There is no corresponding option","不展示":"None","不是":"is not","不等于":"Not equal to","不能与其他列重名":"Field name must be unique","中":"Middle","为空":"is empty","人员":"Mention","今天":"Today","从大到小":"9 → 1","从小到大":"1 → 9","任务流转一目了然":"Task flow is clear at a glance","低":"Low","你还未进行任何分组":"You haven't done any grouping yet","你还未进行任何排序":"You haven't done any sorting yet","你还未进行任何筛选":"You haven't done any filtering yet","保存":"Save","保持排序":"Keep sort","修改人":"Update people","修改分组":"Edit group","修改分组人员":"Edit group member","修改分组名称":"Edit group name","修改时间":"Update time","关闭弹窗 (ESC)":"Close modal (ESC)","分组":"Group","分组设置":"Group configs","切换视图":"Switch View","列名不能为空":"Field name must not empty","列类型":"Field type","创建人":"creator","创建时间":"Create time","删除":"Delete","删除分组":"Delete group","删除列":"Remove field","删除图片":"Remove Picture","删除行":"Remove row","删除视图":"Remove view","删除记录":"Remove record","删除该条件":"Delete this condition","剪贴板里没有文件可粘贴":"There is no file in the clipboard to paste","副本":"Copy","包含":"Contains","包含一个":"has one of","包含所有":"has all of","升序":"Asc","单选":"Select","取消":"Cancel","取消分组":"Ungroup","取消排序后，可进行拖拽":"After unsorting, you can drag and drop","取消筛选":"Unfilter","可以快速新建一个单选列进行分组":"You can quickly create a select column for grouping","可搜索或新建选项":"Select an option or create one","合并为分组":"Merge into group","向上插入行":"Insert row above","向上插入记录":"Insert record above","向下插入行":"Insert row below","向下插入记录":"Insert record below","向右插入列":"Insert field right","向右插入记录":"Insert record right","向左插入列":"Insert field left","向左插入记录":"Insert record left","否":"Not","唯一数":"Unique","唯一数 $1":"Unique $1","唯一数占比":"Percent Unique","唯一数占比 $1":"Unique $1","图片":"Image","图片上传任务":"Image upload task","图片列表":"image list","基础":"Basis","复制":"Copy","复制失败，没有足够的列":"Copy failed, not enough columns","复制成功":"Copy success","复制视图":"Copy view","复制记录":"Copy record","复制链接":"Copy link","复选框":"Checkbox","多选":"Multi-select","大于":"Greater than","大于等于":"Greater than or equal to","完成":"Finish","实际尺寸":"Actual size","封面效果":"Cover displays","封面来源":"Cover source","小于":"Less than","小于等于":"Less than or equal to","展开行":"Expand row","展开行（Space）":"Expand row（Space）","展开记录":"Expand record","已勾选":"Checked","已勾选 $1":"Checked $1","已勾选占比":"Percent Checked","已勾选占比 $1":"Checked $1","已填写 $1":"Filled $1","已填写占比":"Percent Filled","已填写占比 $1":"Filled $1","已填写数":"Filled","已存在该选项，不可重复创建！":"This option already exists","已选择 $1 个单元格":"$1 cells selected","平均值":"Average","平均值 $1":"Avg $1","并且":"And","开头不是":"Not Starts with","开头是":"Starts with","当":"Where","当前处于保持排序状态，为您重新定位":"Re-locate when keep sort","当前浏览器不支持访问剪贴板数据，建议您使用 Chrome 浏览器访问":"Current browser don't support access clipboard data, we recommend that you use the Chrome browser to visit","成功复制 $1 个单元格":"$1 cells copied","或者":"Or","手机号码":"Phone","按":"By","按以下选项进行分组":"Group by options","按以下选项进行排序":"Sort by the following options","按本列分组":"Group by current col","按本列筛选":"Filter by current col","排序":"Sort","排序设置":"Sort settings","搜索":"Search","搜索人员":"Search member","搜索选项":"Search option","放大":"Zoom out","数字":"Number","数字类型只能输入数字":"Number type can only enter numbers","数据表列名":"Field name","数据表已达最大行数限制":"Records in this table is over limits","文件读取失败，请重新上传":"File read failed, please re-upload","文本":"Text","文档已保存":"Document has been saved","新增字段":"New field","新建分组":"New group","新建视图":"New view","新建选项":"New option","新建选项不能为空字符":"The new option cannot be an empty character","无封面":"No cover","无权访问当前视图":"Not authorized to access current view","日期":"Date","时间范围 $1 天":"RNG $1 days","时间范围 $1 月":"RNG $1 months","时间范围（日）":"Date Range(days)","时间范围（月）":"Date Range(months)","明天":"Tomorrow","昨天":"Yesterday","是":"is","显示字段名":"Show column name","暂无人员":"Empty","最大值":"Max","最大值 $1":"Max $1","最小值":"Min","最小值 $1":"Min $1","最早时间":"Earlist Date","最早时间 $1":"Earlist Date $1","最晚时间":"Lastest Date","最晚时间 $1":"Latest Date $1","未分组":"Ungrouped","未勾选":"Unchecked","未勾选 $1":"Unchecked $1","未勾选占比":"Percent Unchecked","未勾选占比 $1":"Unchecked $1","未命名记录":"Untitled record","未填写 $1":"Empty $1","未填写占比":"Percent Empty","未填写占比 $1":"Empty $1","未填写数":"Empty","未搜索到结果":"No data","本周":"This week","本地上传":"Local Upload","本月":"This month","本记录不属于该分组，点击其他区域将移走该记录":"This record will move to its new position when you select another record","本记录因排序规则会移动，点击其他区域将移走该记录":"This record will move to its new position when you select another record","本记录将被移动到新的排序位置":"Record moved","本记录将被移至新的分组":"Record moved","本记录将被过滤":"Record filtered","本记录已被筛选过滤，点击其他区域将隐藏该记录":"This record is no longer visible based on this view's filter, and will be hidden when you select another record","查找":"Search","查看视图需要编辑权限":"View current view requires edit permission","标题":"Title","正在处理粘贴内容...":"Processing pasted content...","求和":"Sum","求和 $1":"Sum $1","添加一个选项":"Add an option","添加下一个":"Add next","添加分组条件":"Add grouping conditions","添加排序条件":"Add sorting conditions","添加筛选":"Add filter","添加筛选条件":"Add filter","添加记录":"Add record","画册视图":"Gallery view","画册配置":"Gallery setting","直接粘贴或拖拽到这里":"Paste or drag directly here","看板暂无分组":"Kanban no grouping","看板视图":"Kanban view","看板配置":"Kanban setting","确定":"Confirm","确认":"Confirm",'确认要删除 "$1" 分组吗':'Are you sure you want to delete the "$1" group','确认要删除 "$1" 字段吗':'Are you sure you want to delete the "$1" field',"空":"Empty","等于":"Equal to","筛选":"Filter","粘贴":"Paste","粘贴失败, 请稍后重试":"Paste failed, please try again later","粘贴成功":"Pasted successfully","系统字段不支持粘贴修改":"System fields do not support paste modification","结尾不是":"Not ends with","结尾是":"Ends with","统计":"Calculation","编辑":"Edit","编辑列":"Edit field","编辑链接":"Edit link","缩小":"Zoom in","行高":"Row height","表单":"Form","表格视图":"Grid view","表格配置":"Table Config","裁剪":"Clip","规范化存储和展示数据":"Normalized storage and presentation of data","视图名称":"view name","记录总数":"Count","设置该列内容类型，支持文本、日期、数字、单选、多选等":"Set the content type of the column, support text, date, number, single select, multiple select, etc.","请上传":"Please upload","请输入":"Please enter","请输入关键词...":"Please enter a keyword...","请输入关键词搜索":"Please enter keywords to search","请输入有效手机号":"Please enter a valid mobile phone number","请输入有效邮箱":"Please enter a valid email address","请选择":"Please choose","输入格式有误":"Please enter a valid data","过去7天":"7 days ago","还未设置任何分组":"No groupings applied to this view","还未设置任何排序":"No sorts applied to this view","还未设置任何筛选":"No filters applied to this view","适合展示图片类数据":"Suitable for displaying image data","适应":"Fit","适应屏幕":"adapt to screen","选择一列进行分组":"Pick a field to group by","选择一列进行排序":"Pick a field to sort by","选择分组字段":"Select grouping field","选项倒序":"Last-First","选项名不能为空":"Option name cannot be empty","选项名不能超过最大长度限制":"Option name cannot be over max length","选项设置":"Filed options","选项顺序":"First-Last","邮箱":"Email","重命名视图":"Rename view","重新上传":"Upload again","链接":"Link","附件":"File","附件上传任务":"Attachment upload task","附件列表":"attachment list","降序":"Desc","非空":"is not empty","颜色":"Color","高":"High","高级":"Advanced","（空）":"(Empty)"});const KQ=[VO,fk,wk,Ik,Dk,Hk,Jk,aO,hO,CO,TO,GO,eI,lI,vI,xI,NI,LI,GI,QI,lR,mR,bR,SR,MR,zR,ZR,aT,vT,xT,AT,nR,DT,UT,qT,eA,iA,cA],qQ=Object(a.memo)((({cell:e,boxRect:t,isSelected:r=!1})=>{const n=_V(null==e?void 0:e.value,t,{ignore:r||!t,fonStyle:{lineHeight:24,font:"14px PingFang SC",fontSize:14}});return s.a.createElement(CJ,{key:null==e?void 0:e.uuid,value:n})}),((e,t)=>{var r,n,i;const o=(null==(r=e.cell)?void 0:r.cellKey)!==(null==(n=t.cell)?void 0:n.cellKey),a=e.boxRect!==t.boxRect,s=e.isSelected!==t.isSelected;return!((null==(i=t.cell)?void 0:i.temp)||o||a||s)})),YQ=e=>s.a.createElement(YP,{type:"FieldText",...e}),XQ=e=>{const{field:t,cell:r,defaultValue:n,onCellChange:i,...o}=e;return r?s.a.createElement(EJ,{id:r.cellId,defaultValue:n,value:r.value||"",onChange:e=>{null==i||i(e)},...o}):null},ZQ=e=>s.a.createElement(EJ,{...e}),JQ=Fi.defineToken("FieldTextPluginFieldTagContribution");var QQ=Object.defineProperty,e0=Object.getOwnPropertyDescriptor,t0=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?e0(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&QQ(t,r,o),o};let r0=class{constructor(){this.getTextFieldTagComponent=()=>{var e,t;const r=this.fieldTextPluginFieldTagProvider.getContributions({cache:!1});return r[0]?null==(t=(e=r[0]).getTextFieldTagComponent)?void 0:t.call(e):null}}};t0([Eo(JQ)],r0.prototype,"fieldTextPluginFieldTagProvider",2),r0=t0([eo()],r0);var n0=Object.defineProperty,i0=Object.getOwnPropertyDescriptor,o0=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?i0(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&n0(t,r,o),o};let a0=class{constructor(){this.fieldType="text",this.showFieldIcon=!0}static pluginModule(){return bo().contribution(JQ).register(this).register(r0)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return qQ}getFieldEditComponent(){return XQ}getFieldIcon(){return this.showFieldIcon?YQ:null}getFieldTagComponent(){return this._fieldTextService.getTextFieldTagComponent()}getFieldFormComponent(){return ZQ}};function s0(e){const t=zA(Hw);return{isReadonly:(...r)=>(null==t?void 0:t.isReadonly(e,...r))||!1,can:(r,...n)=>(null==t?void 0:t.can(r,e,...n))||!1,canCreate:(...r)=>(null==t?void 0:t.canCreate(e,...r))||!1,canDelete:(...r)=>(null==t?void 0:t.canDelete(e,...r))||!1,canUpdate:(...r)=>(null==t?void 0:t.canUpdate(e,...r))||!1,canRead:(...r)=>(null==t?void 0:t.canRead(e,...r))||!1}}function l0(){const e=zA(Dy),t=zA(s_),r=e.getActiveView(),[n,i]=Object(a.useState)(r),o=Object(a.useCallback)((()=>{const t=e.getActiveView();i(t)}),[e]);return Object(a.useLayoutEffect)((()=>{const e=t.onDataLoaded((()=>{o()})),r=t.onDataChanged((()=>{o()}));return()=>{e.destroy(),r.destroy()}}),[t,o]),n}function c0(){const e=zA(Dy),t=zA(s_),[r,n]=Object(a.useState)(e.getViews()),i=()=>{const t=e.getViews();n(t)};return Object(a.useEffect)((()=>{const e=t.onDataLoaded((()=>{i()})),r=t.onDataChanged((()=>{i()}));return()=>{e.destroy(),r.destroy()}}),[]),r}function u0(){const e=zA(Dy),t=zA(s_),r=zA(By),[n,i]=Object(a.useState)((()=>e.getActiveViewData())),o=()=>{const t=e.getActiveViewData();i(t)};return Object(a.useEffect)((()=>{const e=t.onDataLoaded((()=>{o()})),r=t.onDataChanged((()=>{o()}));return()=>{e.destroy(),r.destroy()}}),[]),Object(a.useEffect)((()=>{const t=r.onBeforeRefresh((({commandName:t,params:r})=>{if("setCell"===t){const t=e.getActiveViewData(),n=(e,t)=>{for(const r of e)if(r.record_uuid===t.recordId){for(const e of r.cells)if(e.fieldId===t.fieldId){e.value=t.value,e.temp=!0;break}break}};if(null!=t&&t.group){const e=(null==t?void 0:t.viewRecords)||[];for(const t of e){n(t.records||[],r)}}else{n((null==t?void 0:t.viewRecords)||[],r)}i(t)}}));return()=>{t.destroy()}}),[]),n}a0.pluginName="render-field-text",o0([to(qf)],a0.prototype,"_configuration",2),o0([to(r0)],a0.prototype,"_fieldTextService",2),a0=o0([eo({contrib:[Mj,Nj]})],a0);var d0=(e=>(e.changeFieldType="changeFieldType",e.updateFieldName="updateFieldName",e.updateFieldHidden="updateFieldHidden",e.updateFieldProperty="updateFieldProperty",e.updateField="updateField",e))(d0||{});function f0(e){const t=zA(Dy),r=zA(Pb),n=s0(Nw.TABLE).isReadonly(),[i,o]=Object(a.useState)((()=>t.getField(e)));Object(a.useEffect)((()=>{o(t.getField(e))}),[e,t]);const s=null==i?void 0:i.type,l=null==i?void 0:i.name;Object(a.useEffect)((()=>{const n=null==r?void 0:r.onDidExecuteCommand((({context:r})=>{var n;if(Object.values(d0).includes(r.commandName)){const i=r.argArray[0];let a=i.uuid;"updateField"===r.commandName&&(a=null==(n=i.field)?void 0:n.uuid),a===e&&o(t.getField(e))}}));return()=>{null==n||n.destroy()}}),[r,e,t]);return i?{...i,id:e,name:l,type:s,options:i.options||null,isPrimary:!1,updateProperty:async n=>(await(null==r?void 0:r.execCommand("updateField",{field:i,newFieldProperty:n})),t.getField(e)),hasPermissionForWrite:e=>n}:null}const p0=["addField","removeField","changeFieldOrder",...Object.values(d0)];function h0(){const e=zA(Dy),t=zA(Pb),[r,n]=Object(a.useState)((()=>null==e?void 0:e.getAllViewFields()));return Object(a.useEffect)((()=>{const r=null==t?void 0:t.onDidExecuteCommand((({context:t})=>{p0.includes(t.commandName)&&n(null==e?void 0:e.getAllViewFields())}));return()=>{r.destroy()}}),[t,e]),r||null}function m0(e,t){const r=zA(Dy),n=zA(Pb),i=zA(Fv),o=zA(By),s=f0(t),l=null==s?void 0:s.type,c=s0(Nw.TABLE).isReadonly(),u=Object(a.useCallback)(((e,t)=>r.getCell(t,e)),[r]),[d,f]=Object(a.useState)((()=>u(e,t)));Object(a.useEffect)((()=>{f(u(e,t))}),[e,t,u]),Object(a.useEffect)((()=>{const r=null==i?void 0:i.onCellChange((r=>{r.recordId===e&&r.fieldId===t&&f(u(e,t))}));return()=>{null==r||r.destroy()}}),[i,t,e,u]);const p=Object(a.useCallback)((async i=>{if(c)return;if(!e||!t||!d)return null;const a={recordId:e,fieldId:t,value:i,cellId:d.cellId,fieldType:l,uuid:d.uuid};!a||(async()=>{const e=r.getActiveView(),t=null==o?void 0:o.getRefreshType((null==e?void 0:e.uuid)||"",a.fieldId||"");t&&(null==e?void 0:e.type)===Wh.GRID?null==n||n.execDeferCommand("setCell",a,t):await(null==n?void 0:n.execCommand("setCell",a))})()}),[n,e,t,d,c]);return e&&t&&s&&d?{cellId:d.cellId,fieldId:t,recordId:e,fieldType:l,value:d.value,errorMessage:d.errorMessage,setCell:p}:null}const v0=Object(a.memo)((e=>{var t;const{cell:r,field:n,checkCell:i,isSelected:o=!1}=e,l=(null==r?void 0:r.recordId)||"",c=(null==r?void 0:r.fieldId)||"",u=s0(Nw.TABLE).isReadonly(),d=m0(l,c),f=null==(t=e.field)?void 0:t.options,p=(null==r?void 0:r.value)||(null==d?void 0:d.value),h=(null==f?void 0:f.filter((e=>e.uuid===p)))||null,m=zA(Zj),v=Object(a.useCallback)((e=>{null==m||m.emitClickCellIcon({recordId:l,fieldId:c,event:e,iconName:"cellSelectIcon"})}),[l,c]);return!i||null!=d&&d.value?s.a.createElement(s.a.Fragment,null,s.a.createElement(uJ,{writeable:o&&!u,colorable:!(null==n||!n.color),value:h,onDelete:e=>{null==d||d.setCell(null)},showPlaceholder:!1,onClickDropDownIcon:v})):null}),((e,t)=>{var r;const n=e.cell,i=t.cell,o=e.isSelected!==t.isSelected;return!(null==(r=t.cell)?void 0:r.temp)&&!o&&(null!=n&&n.cellKey||null!=i&&i.cellKey?(null==n?void 0:n.cellKey)===(null==i?void 0:i.cellKey):od(null==n?void 0:n.value,null==i?void 0:i.value)&&od(null==n?void 0:n.name,null==i?void 0:i.name)&&od(null==n?void 0:n.color,null==i?void 0:i.color))})),g0=e=>s.a.createElement(YP,{type:"FieldSelect",...e}),y0=e=>{var t;const{viewField:r,defaultValue:n,cell:i,onCellChange:o,...a}=e,l=f0((null==(t=e.field)?void 0:t.uuid)||""),c=s0(Nw.FIELD).canUpdate(l),u=m0(null==i?void 0:i.recordId,null==i?void 0:i.fieldId),d=cj(),f=(null==l?void 0:l.options)||[],p=mV((async e=>{const t=f.concat(e);await(null==l?void 0:l.updateProperty({options:t})),(async e=>{const t=((null==i?void 0:i.value)||[]).includes(e.uuid);null==u||u.setCell(t?"":e.uuid)})(e),d()})),h=mV((e=>{const t=f.map((t=>t.uuid===e.uuid?e:t));null==l||l.updateProperty({options:t}),d()})),m=mV((e=>{const t=f.filter((t=>t.uuid!==e));null==l||l.updateProperty({options:t}),d()})),v=mV((e=>{null==o||o(e)}));return l&&i?s.a.createElement(vJ,{id:l.id,defaultValue:n?[n.value]:[],value:i.value?[i.value]:null,type:l.type,options:f,colorable:l.color,editable:!0,optionEditable:c,displayType:null==r?void 0:r.display_type,onChange:v,onOptionChange:h,onOptionCreate:p,onOptionDelete:m,...a}):null},b0=e=>{const{viewField:t,...r}=e,n=t.field,i="dropdown"===(null==t?void 0:t.display_type)?nJ.Dropdown:nJ.List;return s.a.createElement(vJ,{type:iJ.Select,options:n.options||[],colorable:n.color,displayType:i,editable:!1,...r})};b0.OptionEditable=e=>{if(!Kh.isSelectLike(e.type))return null;const t={type:e.type,options:(null==e?void 0:e.options)||[],color:(null==e?void 0:e.color)||!1};return s.a.createElement(bJ,{title:s.a.createElement("span",{className:"lakex-table-form-design-option-title"},kf("选项设置")),onChange:e.onChange,onChangeOrder:e.onChangeOrder,multiple:!1,configs:t,autoFocus:e.autoFocus})};var w0=Object.defineProperty,_0=Object.getOwnPropertyDescriptor,C0=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?_0(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&w0(t,r,o),o};let E0=class{constructor(){this.fieldType="select",this.showFieldIcon=!0}static pluginModule(){return bo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return v0}getFieldEditComponent(){return y0}getFieldIcon(){return this.showFieldIcon?g0:null}getFieldFormComponent(){return b0}};E0.pluginName="render-field-select",C0([to(qf)],E0.prototype,"_configuration",2),E0=C0([eo({contrib:[Mj,Nj]})],E0);const x0=Object(a.memo)((e=>{var t,r,n,i;const{cell:o,field:l,writeable:c,isSelected:u=!1}=e,d=(null==o?void 0:o.recordId)||"",f=(null==o?void 0:o.fieldId)||"",p=s0(Nw.TABLE).isReadonly(),h=m0(d,f),m=(null==o?void 0:o.value)||(null==h?void 0:h.value)||[],v=zA(Zj),g=null==(t=e.field)?void 0:t.options,y=Object(a.useRef)(null),b=null==(i=null==(r=m.map)?void 0:(n=r.call(m,(e=>{const t=null==g?void 0:g.find((t=>t.uuid===e));return{...t,value:null==t?void 0:t.uuid}}))).filter)?void 0:i.call(n,(e=>!!e)),w=Object(a.useCallback)((e=>{null==v||v.emitClickCellIcon({recordId:d,fieldId:f,event:e,iconName:"cellSelectIcon"})}),[d,f]);return Object(a.useLayoutEffect)((()=>{!y.current||!e.boxRect||y.current.applyOverflow(e.boxRect)}),[e.boxRect,y,u]),o?p||!u?s.a.createElement(gJ,{ref:y,colorable:!(null==l||!l.color),value:b}):s.a.createElement(uJ,{writeable:ad(c)?u&&!p:c,colorable:!(null==l||!l.color),value:b,onDelete:e=>{const t=b.filter((t=>t.uuid!==e.uuid));null==h||h.setCell(t)},showPlaceholder:!1,onClickDropDownIcon:w}):null}),((e,t)=>{var r,n,i;const o=(null==(r=e.cell)?void 0:r.cellKey)!==(null==(n=t.cell)?void 0:n.cellKey),a=e.boxRect!==t.boxRect,s=e.isSelected!==t.isSelected;return!((null==(i=t.cell)?void 0:i.temp)||o||a||s)})),S0=e=>s.a.createElement(YP,{type:"FieldMultiSelect",...e}),k0=e=>{var t;const{viewField:r,cell:n,defaultValue:i,onChange:o,onCellChange:a,...l}=e,c=f0((null==(t=e.field)?void 0:t.uuid)||""),u=m0(null==n?void 0:n.recordId,null==n?void 0:n.fieldId),d=cj(),f=s0(Nw.FIELD).canUpdate(c),p=null==n?void 0:n.value,h=i||[""],m=(null==c?void 0:c.options)||[],v=mV((async e=>{const t=m.concat(e);null==c||c.updateProperty({options:t}),(async e=>{const t=(null==n?void 0:n.value)||[],r=t.includes(e.uuid)?t.filter((t=>t!==e.uuid)):t.concat(e.uuid);null==u||u.setCell(r.map((e=>({value:e}))))})(e),d()})),g=mV((e=>{const t=m.map((t=>t.uuid===e.uuid?e:t));null==c||c.updateProperty({options:t}),d()})),y=mV((e=>{const t=m.filter((t=>t.uuid!==e));null==c||c.updateProperty({options:t}),d()})),b=mV((e=>{const t=((null==c?void 0:c.options)||[]).filter((t=>e.includes(t.uuid))).map((e=>(e.value=e.uuid,e)));null==a||a(t),null==o||o(t)}));return c?s.a.createElement(vJ,{id:c.uuid,defaultValue:h,value:p,type:c.type,options:c.options,colorable:null==c?void 0:c.color,editable:!0,optionEditable:f,displayType:null==r?void 0:r.display_type,onChange:b,onOptionChange:g,onOptionCreate:v,onOptionDelete:y,...l}):null},O0=e=>{const{viewField:t,onChange:r,...n}=e,i=t.field,o="dropdown"===(null==t?void 0:t.display_type)?nJ.Dropdown:nJ.List;return s.a.createElement(vJ,{type:iJ.MultiSelect,options:i.options||[],colorable:null==i?void 0:i.color,displayType:o,editable:!1,onChange:e=>{const t=(i.options||[]).filter((t=>e.includes(t.uuid))).map((e=>e.uuid));null==r||r(t)},...n})};O0.OptionEditable=e=>{if(!Kh.isSelectLike(e.type))return null;const t={type:e.type,options:(null==e?void 0:e.options)||[],color:(null==e?void 0:e.color)||!1};return s.a.createElement(bJ,{title:s.a.createElement("span",{className:"lakex-table-form-design-option-title"},kf("选项设置")),onChange:e.onChange,onChangeOrder:e.onChangeOrder,multiple:!0,configs:t,autoFocus:e.autoFocus})};var I0=Object.defineProperty,R0=Object.getOwnPropertyDescriptor,T0=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?R0(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&I0(t,r,o),o};let A0=class{constructor(){this.fieldType="multiSelect",this.showFieldIcon=!0}static pluginModule(){return bo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return x0}getFieldEditComponent(){return k0}getFieldIcon(){return this.showFieldIcon?S0:null}getFieldFormComponent(){return O0}};A0.pluginName="render-field-multi-select",T0([to(qf)],A0.prototype,"_configuration",2),A0=T0([eo({contrib:[Mj,Nj]})],A0);const N0=Object(a.memo)((({cell:e})=>e&&null!=e.value?s.a.createElement(QZ,{key:null==e?void 0:e.fieldId,value:null==e?void 0:e.value}):null),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.cellKey)===(null==(i=t.cell)?void 0:i.cellKey)})),M0=e=>s.a.createElement(YP,{type:"FieldNumber",...e}),P0=e=>{const{field:t,cell:r,defaultValue:n,onCellChange:i,...o}=e;return r?s.a.createElement(eJ,{id:null==r?void 0:r.cellId,defaultValue:n,value:r.value||"",prefix:e.renderMode===Dj.LITE?void 0:s.a.createElement(YP,{type:"FieldNumber"}),onChange:e=>{null==i||i(e)},...o}):null},j0=e=>s.a.createElement(eJ,{...e});var D0=Object.defineProperty,F0=Object.getOwnPropertyDescriptor,V0=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?F0(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&D0(t,r,o),o};let L0=class{constructor(){this.fieldType="number",this.isStrictValidatedValue=!0,this.showFieldIcon=!0}static pluginModule(){return bo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return N0}getFieldEditComponent(){return P0}getFieldIcon(){return this.showFieldIcon?M0:null}getFieldRules(){return this._numberField.rules}getFieldFormComponent(){return j0}};L0.pluginName="render-field-number",V0([to(xk)],L0.prototype,"_numberField",2),V0([to(qf)],L0.prototype,"_configuration",2),L0=V0([eo({contrib:[Mj,Nj]})],L0);const $0=Object(a.memo)((({cell:e,checkCell:t=!0,disableOpen:r=!1,isSelected:n=!1,boxRect:i})=>{const o=(null==e?void 0:e.recordId)||"",l=(null==e?void 0:e.fieldId)||"",c=s0(Nw.TABLE).isReadonly(),u=m0(o,l),d=(null==e?void 0:e.value)||(null==u?void 0:u.value)||[],f=zA(Zj),p=zA(Dy),h=zA(MD),m=Object(a.useRef)(null),v=mV((e=>{null==f||f.emitClickCellIcon({recordId:o,fieldId:l,event:e,iconName:"cellMentionIcon"})})),g=Object(a.useCallback)((e=>{!n&&p.getActiveViewType()===Wh.GRID||!r&&(null==h||h.open("user",e))}),[n]);return Object(a.useLayoutEffect)((()=>{!m.current||!i||m.current.applyOverflow(i)}),[i,m,n]),t&&!e?null:c||!n?s.a.createElement(JZ,{ref:m,value:d,onMentionTagClick:g}):s.a.createElement(HZ,{showPlaceholder:!1,writeable:n&&!c,list:d||[],onUnSelect:e=>{const t=null==d?void 0:d.filter((t=>t.uid!==e.uid));null==u||u.setCell(t)},onMentionTagClick:g,onClickDropDownIcon:v})}),((e,t)=>{var r,n,i;const o=e.cell,a=t.cell,s=e.boxRect!==t.boxRect,l=e.isSelected!==t.isSelected;return!((null==(r=t.cell)?void 0:r.temp)||s||l)&&(null!=o&&o.cellKey||null!=a&&a.cellKey?(null==(n=e.cell)?void 0:n.cellKey)===(null==(i=t.cell)?void 0:i.cellKey):od(o.uuid,a.uuid))})),B0=e=>s.a.createElement(YP,{type:"FieldMention",...e}),z0=e=>{const{field:t,cell:r,onCellChange:n,...i}=e,o=zA(MD),l=m0(null==r?void 0:r.recordId,null==r?void 0:r.fieldId),c=Object(a.useCallback)((e=>{null==o||o.open("user",e)}),[]);return r?s.a.createElement(ZZ,{onMentionTagClick:c,id:r.cellId,defaultValue:r.value,onChange:e=>{null==l||l.setCell(e)},...i}):null},U0=e=>{const t=zA(MD),r=Object(a.useCallback)((e=>{null==t||t.open("user",e)}),[]);return s.a.createElement(ZZ,{...e,onMentionTagClick:r})};var H0=Object.defineProperty,W0=Object.getOwnPropertyDescriptor,G0=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?W0(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&H0(t,r,o),o};let K0=class{constructor(){this.fieldType="mention",this.showFieldIcon=!0}static pluginModule(){return bo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return $0}getFieldEditComponent(){return z0}getFieldIcon(){return this.showFieldIcon?B0:null}getFieldFormComponent(){return U0}};K0.pluginName="render-field-mention",G0([to(qf)],K0.prototype,"_configuration",2),K0=G0([eo({contrib:[Mj,Nj]})],K0);const q0=Object(a.memo)((({cell:e})=>s.a.createElement(SV,{key:null==e?void 0:e.fieldId,value:null==e?void 0:e.value})),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.cellKey)===(null==(i=t.cell)?void 0:i.cellKey)})),Y0=e=>s.a.createElement(YP,{type:"FieldDate",...e}),X0=e=>{const{cell:t,defaultValue:r,onCellChange:n,...i}=e;return t?s.a.createElement(YX,{id:t.fieldId,defaultValue:r,value:t.value,onChange:e=>{null==n||n(e)},...i}):null},Z0=e=>s.a.createElement(YX,{...e});var J0=Object.defineProperty,Q0=Object.getOwnPropertyDescriptor,e1=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Q0(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&J0(t,r,o),o};let t1=class{constructor(){this.fieldType="date",this.showFieldIcon=!0}static pluginModule(){return bo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return q0}getFieldEditComponent(){return X0}getFieldIcon(){return this.showFieldIcon?Y0:null}getFieldFormComponent(){return Z0}};t1.pluginName="render-field-date",e1([to(qf)],t1.prototype,"_configuration",2),t1=e1([eo({contrib:[Mj,Nj]})],t1);const r1=Object(a.memo)((e=>{const{readonly:t,cell:r}=e,n=s0(Nw.TABLE).isReadonly(),i=zA(Pb),o=m0(null==r?void 0:r.recordId,null==r?void 0:r.fieldId),l=Object(a.useCallback)((e=>{!n&&!t&&(null==o||o.setCell(e))}),[n,t,i]);if(!o&&!r)return null;const c=(null==r?void 0:r.value)||(null==o?void 0:o.value);return s.a.createElement(lj,{value:!!c,onChange:l})}),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.cellKey)===(null==(i=t.cell)?void 0:i.cellKey)})),n1=e=>{const{field:t,recordId:r}=e,n=m0(r,null==t?void 0:t.uuid),i=Object(a.useCallback)((e=>{null==n||n.setCell(e)}),[]);return n?s.a.createElement(EV,{id:n.cellId,defaultValue:n.value,value:n.value,onChange:i}):null},i1=e=>s.a.createElement(YP,{type:"FieldCheckbox",...e}),o1=e=>s.a.createElement(EV,{type:sj.Radio,...e});var a1=Object.defineProperty,s1=Object.getOwnPropertyDescriptor,l1=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?s1(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&a1(t,r,o),o};let c1=class{constructor(){this.fieldType="checkbox",this.showFieldIcon=!0}static pluginModule(){return bo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return r1}getFieldEditComponent(){return n1}getFieldIcon(){return this.showFieldIcon?i1:null}getFieldFormComponent(){return o1}};c1.pluginName="render-field-checkbox",l1([to(qf)],c1.prototype,"_configuration",2),c1=l1([eo({contrib:[Mj,Nj]})],c1);const u1=Object(a.memo)((({cell:e,isSelected:t=!1})=>{const r=zA(MD),n=Object(a.useCallback)((e=>{!t||null==r||r.open("user",e)}),[t]);return e&&null!=e.value?s.a.createElement(JZ,{value:e.value?[e.value]:[],onMentionTagClick:n}):null}),((e,t)=>{var r,n,i;const o=e.isSelected!==t.isSelected;return!(null==(r=t.cell)?void 0:r.temp)&&!o&&(null==(n=e.cell)?void 0:n.cellKey)===(null==(i=t.cell)?void 0:i.cellKey)})),d1=e=>s.a.createElement(YP,{type:"FieldCreator",...e});var f1=Object.defineProperty,p1=Object.getOwnPropertyDescriptor,h1=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?p1(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&f1(t,r,o),o};let m1=class{constructor(){this.fieldType="userId",this.isSystemType=!0,this.showFieldIcon=!0}static pluginModule(){return bo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return u1}getFieldIcon(){return this.showFieldIcon?d1:null}};m1.pluginName="render-field-user-id",h1([to(qf)],m1.prototype,"_configuration",2),m1=h1([eo({contrib:[Mj,Nj]})],m1);const v1=Object(a.memo)((({cell:e})=>s.a.createElement(SV,{key:null==e?void 0:e.cellId,value:null==e?void 0:e.value,format:"YYYY-MM-DD HH:mm:ss"})),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.cellKey)===(null==(i=t.cell)?void 0:i.cellKey)})),g1=e=>s.a.createElement(YP,{type:"FieldCreatedAt",...e});var y1=Object.defineProperty,b1=Object.getOwnPropertyDescriptor,w1=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?b1(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&y1(t,r,o),o};let _1=class{constructor(){this.fieldType="createdAt",this.isSystemType=!0,this.showFieldIcon=!0}static pluginModule(){return bo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return v1}getFieldIcon(){return this.showFieldIcon?g1:null}};_1.pluginName="render-field-created-at",w1([to(qf)],_1.prototype,"_configuration",2),_1=w1([eo({contrib:[Mj,Nj]})],_1);const C1=Object(a.memo)((({cell:e,isSelected:t=!1})=>{const r=zA(MD),n=Object(a.useCallback)((e=>{!t||null==r||r.open("user",e)}),[t]);return e?s.a.createElement(JZ,{value:e.value?[e.value]:[],onMentionTagClick:n}):null}),((e,t)=>{var r,n,i;const o=e.isSelected!==t.isSelected;return!(null==(r=t.cell)?void 0:r.temp)&&!o&&(null==(n=e.cell)?void 0:n.cellKey)===(null==(i=t.cell)?void 0:i.cellKey)})),E1=e=>s.a.createElement(YP,{type:"FieldModifier",...e});var x1=Object.defineProperty,S1=Object.getOwnPropertyDescriptor,k1=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?S1(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&x1(t,r,o),o};let O1=class{constructor(){this.fieldType="modifierId",this.isSystemType=!0,this.showFieldIcon=!0}static pluginModule(){return bo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return C1}getFieldIcon(){return this.showFieldIcon?E1:null}};O1.pluginName="render-field-modifier-id",k1([to(qf)],O1.prototype,"_configuration",2),O1=k1([eo({contrib:[Mj,Nj]})],O1);const I1=Object(a.memo)((({cell:e})=>s.a.createElement(SV,{value:null==e?void 0:e.value,format:"YYYY-MM-DD HH:mm:ss"})),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.cellKey)===(null==(i=t.cell)?void 0:i.cellKey)})),R1=e=>s.a.createElement(YP,{type:"FieldUpdatedAt",...e});var T1=Object.defineProperty,A1=Object.getOwnPropertyDescriptor,N1=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?A1(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&T1(t,r,o),o};let M1=class{constructor(){this.fieldType="updatedAt",this.isSystemType=!0,this.showFieldIcon=!0}static pluginModule(){return bo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return I1}getFieldIcon(){return this.showFieldIcon?R1:null}};M1.pluginName="render-field-updated-at",N1([to(qf)],M1.prototype,"_configuration",2),M1=N1([eo({contrib:[Mj,Nj]})],M1);const P1=Object(a.memo)((({cell:e,readonly:t})=>{var r;const n=s0(Nw.TABLE).isReadonly(),i=zA(Zj),o=(null==e?void 0:e.recordId)||"",l=(null==e?void 0:e.fieldId)||"",c=Object(a.useCallback)((e=>{null==i||i.emitClickCellIcon({recordId:o,fieldId:l,event:e,iconName:"cellImageIcon"})}),[o,l]);return e&&0!==(null==(r=e.value)?void 0:r.length)?s.a.createElement(s.a.Fragment,null,s.a.createElement(UZ,{value:null==e?void 0:e.value}),!n&&!t&&s.a.createElement(YP,{type:"Add",onClick:c})):null}),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.cellKey)===(null==(i=t.cell)?void 0:i.cellKey)})),j1=e=>s.a.createElement(YP,{type:"FieldImage",...e}),D1=e=>{const{field:t,cell:r,recordId:n,defaultValue:i,onCellChange:o,...a}=e,l=zA(Pb),c=zA(tQ),{fieldUriModel:u}=zA(Ov);return t?e.renderMode===Dj.LITE?s.a.createElement("div",{className:"lakex-table-field-image-editable-lite",onClick:e=>{const r={position:{placement:"bottom",origin:e.target},initialState:{fieldId:t.uuid,fieldType:t.type,recordId:n}};c.open("expandRecordFileEditable",r)}},i?i.map((e=>s.a.createElement("div",{key:e.src,className:"lakex-table-field-image-editable-wrap"},s.a.createElement("img",{loading:"lazy",src:e.src})))):s.a.createElement("p",{className:"lakex-table-field-image-placeholder"},kf("请上传"))):s.a.createElement(zZ,{id:(null==r?void 0:r.cellId)||Io(32),defaultValue:i,onChange:e=>{null==o||o(e)},onOrderChange:({targetUid:e,sourceUid:r})=>{var i,o;const a=null==(i=u.findOne({uid:e}))?void 0:i.uuid,s=null==(o=u.findOne({uid:r}))?void 0:o.uuid;l.execCommand("updateValueOrder",{fieldId:t.uuid,fieldType:t.type,recordId:n,targetValueId:a,sourceValueId:s})},...a}):null},F1=e=>s.a.createElement(zZ,{...e});var V1=Object.defineProperty,L1=Object.getOwnPropertyDescriptor,$1=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?L1(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&V1(t,r,o),o};let B1=class{constructor(){this.fieldType="image",this.showFieldIcon=!0}static pluginModule(){return bo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return P1}getFieldEditComponent(){return D1}getFieldIcon(){return this.showFieldIcon?j1:null}getFieldFormComponent(){return F1}};B1.pluginName="render-field-image",$1([to(qf)],B1.prototype,"_configuration",2),B1=$1([eo({contrib:[Mj,Nj]})],B1);const z1=Object(a.memo)((({cell:e,readonly:t})=>{var r;const n=s0(Nw.TABLE).isReadonly(),i=zA(Zj),o=(null==e?void 0:e.recordId)||"",l=(null==e?void 0:e.fieldId)||"",c=Object(a.useCallback)((e=>{null==i||i.emitClickCellIcon({recordId:o,fieldId:l,event:e,iconName:"cellFileIcon"})}),[o,l]);return e&&0!==(null==(r=e.value)?void 0:r.length)?s.a.createElement(s.a.Fragment,null,s.a.createElement(cZ,{value:e.value}),!n&&!t&&s.a.createElement(YP,{type:"Add",onClick:c})):null}),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.cellKey)===(null==(i=t.cell)?void 0:i.cellKey)})),U1=e=>s.a.createElement(YP,{type:"FieldFile",...e}),H1=e=>{const{field:t,recordId:r,cell:n,onCellChange:i,...o}=e,a=zA(Pb),l=zA(tQ),{fieldUriModel:c}=zA(Ov);return t&&n?e.renderMode===Dj.LITE?s.a.createElement("div",{className:"lakex-table-field-file-editable-lite",onClick:e=>{const n={position:{placement:"bottom",origin:e.target},initialState:{fieldId:t.uuid,fieldType:t.type,recordId:r}};l.open("expandRecordFileEditable",n)}},n.value?n.value.map((e=>s.a.createElement("div",{className:"lakex-table-field-file-editable-wrap"},s.a.createElement(lZ,{key:e.uid,type:"file",file:e})))):s.a.createElement("p",{className:"lakex-table-field-file-placeholder"},kf("请上传"))):s.a.createElement(BZ,{id:(null==n?void 0:n.cellId)||Io(32),defaultValue:n.value,onChange:e=>{null==i||i(e)},onOrderChange:({targetUid:e,sourceUid:n})=>{var i,o;const s=null==(i=c.findOne({uid:e}))?void 0:i.uuid,l=null==(o=c.findOne({uid:n}))?void 0:o.uuid;null==a||a.execCommand("updateValueOrder",{fieldId:t.uuid,fieldType:t.type,recordId:r,targetValueId:s,sourceValueId:l})},...o}):null},W1=e=>s.a.createElement(BZ,{...e});var G1=Object.defineProperty,K1=Object.getOwnPropertyDescriptor,q1=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?K1(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&G1(t,r,o),o};let Y1=class{constructor(){this.fieldType="file",this.showFieldIcon=!0}static pluginModule(){return bo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return z1}getFieldEditComponent(){return H1}getFieldIcon(){return this.showFieldIcon?U1:null}getFieldFormComponent(){return W1}};Y1.pluginName="render-field-file",q1([to(qf)],Y1.prototype,"_configuration",2),Y1=q1([eo({contrib:[Mj,Nj]})],Y1);const X1=e=>s.a.createElement(YP,{type:"FieldLink",...e}),Z1=Object(a.memo)((e=>{const{cell:t,readonly:r}=e,n=s0(Nw.TABLE).isReadonly(),i=zA(Zj);if(!t)return null;const o=t.recordId,a=t.fieldId;return s.a.createElement(s.a.Fragment,null,s.a.createElement(xJ,{key:t.fieldId,value:t.value}),!n&&!r&&s.a.createElement(X1,{onClick:e=>{e.stopPropagation(),null==i||i.emitClickCellIcon({recordId:o,fieldId:a,iconName:"cellLinkIcon",event:e})}}))}),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.cellKey)===(null==(i=t.cell)?void 0:i.cellKey)})),J1=e=>{const{field:t,cell:r,defaultValue:n,onCellChange:i,useLinkEditor:o,...a}=e;return r?s.a.createElement(kJ,{useLinkEditor:o,id:r.cellId,defaultValue:n,onChange:i,...a}):null},Q1=e=>s.a.createElement(kJ,{...e});var e2=Object.defineProperty,t2=Object.getOwnPropertyDescriptor,r2=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?t2(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&e2(t,r,o),o};let n2=class{constructor(){this.fieldType="link",this.showFieldIcon=!0}static pluginModule(){return bo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return Z1}getFieldEditComponent(){return J1}getFieldIcon(){return this.showFieldIcon?X1:null}getFieldRules(){return this._linkField.rules}getFieldFormComponent(){return Q1}};n2.pluginName="render-field-link",r2([to(iI)],n2.prototype,"_linkField",2),r2([to(qf)],n2.prototype,"_configuration",2),n2=r2([eo({contrib:[Mj,Nj]})],n2);const i2=Object(a.memo)((({cell:e})=>e&&e.value?s.a.createElement(XX,{key:null==e?void 0:e.fieldId,value:e.value}):null),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.cellKey)===(null==(i=t.cell)?void 0:i.cellKey)})),o2=e=>s.a.createElement(YP,{type:"FieldEmail",...e}),a2=e=>{const{field:t,cell:r,defaultValue:n,onCellChange:i,...o}=e;return r?s.a.createElement(ZX,{id:r.cellId,defaultValue:n,value:r.value,prefix:e.renderMode===Dj.LITE?void 0:s.a.createElement(YP,{type:"FieldEmail"}),onChange:e=>{null==i||i(e)},...o}):null},s2=e=>s.a.createElement(ZX,{...e});var l2=Object.defineProperty,c2=Object.getOwnPropertyDescriptor,u2=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?c2(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&l2(t,r,o),o};let d2=class{constructor(){this.fieldType="email",this.isShowValidTipInGrid=!0,this.showFieldIcon=!0}static pluginModule(){return bo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return i2}getFieldEditComponent(){return a2}getFieldIcon(){return this.showFieldIcon?o2:null}getFieldRules(){return this._emailField.rules}getFieldFormComponent(){return s2}};d2.pluginName="render-field-email",u2([to(fI)],d2.prototype,"_emailField",2),u2([to(qf)],d2.prototype,"_configuration",2),d2=u2([eo({contrib:[Mj,Nj]})],d2);const f2=Object(a.memo)((({cell:e})=>e&&null!=e.value?s.a.createElement(tJ,{key:null==e?void 0:e.fieldId,value:null==e?void 0:e.value}):null),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.cellKey)===(null==(i=t.cell)?void 0:i.cellKey)})),p2=e=>s.a.createElement(YP,{type:"FieldPhone",...e}),h2=e=>{const{field:t,cell:r,defaultValue:n,onCellChange:i,...o}=e;return r?s.a.createElement(rJ,{id:r.cellId,defaultValue:n,value:r.value||"",prefix:e.renderMode===Dj.LITE?void 0:s.a.createElement(YP,{type:"FieldPhone"}),onChange:e=>{null==i||i(e)},...o}):null},m2=e=>s.a.createElement(rJ,{...e});var v2=Object.defineProperty,g2=Object.getOwnPropertyDescriptor,y2=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?g2(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&v2(t,r,o),o};let b2=class{constructor(){this.fieldType="phone",this.isShowValidTipInGrid=!0,this.showFieldIcon=!0}static pluginModule(){return bo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return f2}getFieldEditComponent(){return h2}getFieldIcon(){return this.showFieldIcon?p2:null}getFieldRules(){return this._phoneField.rules}getFieldFormComponent(){return m2}};b2.pluginName="render-field-phone",y2([to(wI)],b2.prototype,"_phoneField",2),y2([to(qf)],b2.prototype,"_configuration",2),b2=y2([eo({contrib:[Mj,Nj]})],b2);const w2=Fi.defineToken("FieldTitleRenderPluginContribution"),_2=e=>s.a.createElement(YP,{type:"FieldText",...e}),C2=Object(a.memo)((({cell:e,boxRect:t,isSelected:r=!1})=>{const n=_V(null==e?void 0:e.value,t,{ignore:r||!t,fonStyle:{lineHeight:24,font:"14px PingFang SC",fontSize:14}});return s.a.createElement(CJ,{key:null==e?void 0:e.uuid,value:n})}),((e,t)=>{var r,n,i;const o=(null==(r=e.cell)?void 0:r.cellKey)!==(null==(n=t.cell)?void 0:n.cellKey),a=e.boxRect!==t.boxRect,s=e.isSelected!==t.isSelected;return!((null==(i=t.cell)?void 0:i.temp)||o||a||s)})),E2=e=>{const{field:t,cell:r,defaultValue:n,onCellChange:i,...o}=e;return r?s.a.createElement(EJ,{id:r.cellId,defaultValue:n,value:r.value||"",onChange:e=>{null==i||i(e)},...o}):null},x2=e=>s.a.createElement(EJ,{...e});var S2=Object.defineProperty,k2=Object.getOwnPropertyDescriptor,O2=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?k2(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&S2(t,r,o),o};let I2=class{constructor(){this.fieldType="title",this.showFieldIcon=!0}static pluginModule(){return bo().contribution(w2).register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return C2}getFieldEditComponent(){return E2}getFieldIcon(){return this.showFieldIcon?_2:null}getFieldFormComponent(){return x2}};I2.pluginName="render-field-title",O2([to(qf)],I2.prototype,"_configuration",2),I2=O2([eo({contrib:[Mj,Nj]})],I2);var R2=Object.defineProperty,T2=Object.getOwnPropertyDescriptor,A2=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?T2(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&R2(t,r,o),o};let N2=class extends Zf{constructor(){super(...arguments),this._onShowNewGroup=this._register(new op),this.onShowNewGroup=this._onShowNewGroup.event,this._onShowEditGroup=this._register(new op),this.onShowEditGroup=this._onShowEditGroup.event}showNewGroup(e,t){this._onShowNewGroup.emit({target:e,groupField:t})}showEditGroup(e,t,r){this._onShowEditGroup.emit({target:e,groupField:t,groupOption:r})}destroy(){super.destroy()}};A2([Si()],N2.prototype,"destroy",1),N2=A2([eo()],N2);var M2=Object.defineProperty,P2=Object.getOwnPropertyDescriptor;let j2=class{static pluginModule(){return bo().register(this).register(N2)}init(){}};j2.pluginName="render-group",j2=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?P2(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&M2(t,r,o),o})([eo({contrib:[PA,rQ]})],j2);const D2=Fi.defineToken("HighlightRenderPluginContribution");var F2=Object.defineProperty,V2=Object.getOwnPropertyDescriptor,L2=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?V2(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&F2(t,r,o),o};let $2=class extends Zf{constructor(){super(...arguments),this._highlightCellIds=new Set,this._highlightRecordIds=new Set,this._onChange=this._register(new op),this.onChange=this._onChange.event}destroy(){this._clear(),this._onChange.destroy()}_getCellIdByHighlightItem(e){return e.fieldId?`${e.recordId}-${e.fieldId}`:null}isInHighlight(e){if(jo(e.recordId))return!1;if(!jo(e.fieldId)){const t=this._getCellIdByHighlightItem(e);return this._highlightCellIds.has(t)}return this._highlightRecordIds.has(e.recordId)}setHighlights(e){this._clear(),e.forEach((e=>{const{recordId:t}=e;t&&this._highlightRecordIds.add(t);const r=this._getCellIdByHighlightItem(e);r&&this._highlightCellIds.add(r)})),this._notify()}clearHighlights(){this._clear(),this._notify()}_clear(){this._highlightCellIds.clear(),this._highlightRecordIds.clear()}_notify(){this._onChange.emit({highlightCellIds:this._highlightCellIds,highlightRecordIds:this._highlightRecordIds})}};L2([Si()],$2.prototype,"destroy",1),$2=L2([eo()],$2);var B2=Object.defineProperty,z2=Object.getOwnPropertyDescriptor;let U2=class{static pluginModule(){return bo().contribution(D2).register(this).register($2)}init(){}};U2.pluginName="render-highlight",U2=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?z2(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&B2(t,r,o),o})([eo({contrib:Nj})],U2);const H2=Fi.defineToken("WorkbenchHotkeyContribution"),W2=Fi.defineToken("SelectionRenderPluginScrollContribution");class G2{static createAt(e,t){return new G2(e,t)}static equal(e,t){return!(!e||!t)&&(e===t||dR.equal(e.start,t.start)&&dR.equal(e.end,t.end))}constructor(e,t){t||(t=e);const{minRow:r,minColumn:n,maxRow:i,maxColumn:o}=function(e,t){const{column:r,row:n}=e,{column:i,row:o}=t;return{minColumn:Math.min(r,i),maxColumn:Math.max(r,i),minRow:Math.min(n,o),maxRow:Math.max(n,o)}}(e,t);this._start=new dR(r,n,e.rowCount,e.columnCount),this._end=new dR(i,o,t.rowCount,t.columnCount),this._isCollapsed=dR.equal(e,this._end)}get start(){return this._start}get end(){return this._end}get isCollapsed(){return this._isCollapsed}get rowCount(){return this._start.rowCount}get columnCount(){return this._start.columnCount}cloneRange(){return new G2(this._start,this._end)}}class K2{static createAt(e){return new K2(e)}static equal(e,t){return e._recordId===t._recordId}constructor(e){this._recordId=e}get isCollapsed(){return!0}get recordId(){return this._recordId}cloneRange(){return new K2(this._recordId)}}class q2{constructor(e,t,r){if(this._anchor=t,this._focus=r,this._ranges=[],0===e.length)throw new Error("ranges construct error");this._ranges=function(e){return 1===e.length?[...e]:e.sort(((e,t)=>e.start.row<t.start.row?-1:e.start.row>t.start.row?1:e.start.column-t.start.column))}(e.slice())}static createBy(e,t=e[0].start,r=e[0].end){let n;return n=Array.isArray(e)?e:[e],new q2(n,t,r)}static equal(e,t){return!(e.ranges.length!==t.ranges.length||e.rowCount!==t.rowCount||e.columnCount!==t.columnCount||!dR.equal(e.anchor,t.anchor)||!dR.equal(e.focus,t.focus))}destroy(){delete this._ranges,delete this._anchor,delete this._focus}get type(){return 0===this.rangeCount?uR.NONE:this.isCollapsed?uR.CARET:uR.RANGE}get rangeCount(){return this._ranges.length}get ranges(){return this._ranges.slice()}get isCollapsed(){return 1===this._ranges.length&&this._ranges[0].isCollapsed}get isMultiSelection(){return this._ranges.length>1}get isAllSelect(){return 1===this._ranges.length&&0===this._ranges[0].start.row&&0===this._ranges[0].start.column&&this._ranges[0].end.row===this._ranges[0].start.rowCount-1&&this._ranges[0].end.column===this._ranges[0].start.columnCount-1}get focus(){return this._focus}get anchor(){return this._anchor}get rowCount(){return this.anchor.rowCount}get columnCount(){return this.anchor.columnCount}isValid(){return this._ranges.length>0}cloneSelection(){return new q2(function(e){return e.map((e=>e.cloneRange()))}(this._ranges),this._anchor,this._focus)}getRangeAt(e){return this._ranges[e]}}class Y2{constructor(e){if(this._ranges=[],0===e.length)throw new Error("ranges construct error");this._ranges=e.slice()}static createBy(e){let t;return t=Array.isArray(e)?e:[e],new Y2(t)}get type(){return 0===this.rangeCount?uR.NONE:this.isCollapsed?uR.CARET:uR.RANGE}get rangeCount(){return this._ranges.length}get ranges(){return this._ranges.slice()}get isCollapsed(){return 1===this._ranges.length&&this._ranges[0].isCollapsed}destroy(){delete this._ranges}getRangeAt(e){return this._ranges[e]}removeAllRanges(){this._ranges=[]}removeRange(e){const t=this._ranges.findIndex((t=>t.recordId===e.recordId));return this._ranges.splice(t,1)}}var X2=Object.defineProperty,Z2=Object.getOwnPropertyDescriptor,J2=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Z2(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&X2(t,r,o),o};function Q2(e){return e instanceof q2}let e3=class extends Zf{constructor(){super(...arguments),this._onChange=this._register(new op),this.onChange=this._onChange.event,this._onAnchorChange=this._register(new op),this.onAnchorChange=this._onAnchorChange.event,this._selection=null,this._prevSelection=null,this._fieldValue=null,this._kanbanScrollService=null,this._cardScrollService=null,this._gridScrollService=null}get _currentViewType(){var e;return null==(e=this._readService.getActiveView())?void 0:e.type}get gridScrollService(){return this._gridScrollService}setKanbanScrollService(e){this._kanbanScrollService=e}setCardScrollService(e){this._cardScrollService=e}setGridScrollService(e){this._gridScrollService=e}destroy(){this._selection=null,this._onChange.destroy(),this._onAnchorChange.destroy()}hasSelection(){return null!==this._selection}isEqualSelection(e){return!!(this._selection&&e instanceof q2&&this._selection instanceof q2)&&q2.equal(e,this._selection)}getSelection(){return this._selection}getFieldValue(){return this._currentViewType===Wh.GRID?this._fieldValue:null}getFieldValues(){return this._selection instanceof q2?this._getSelectFieldValues(this._selection):null}setSelection(e){var t,r;const n=this._readService.getActiveView();let i;if(n){if(this._prevSelection=this._selection,n.type===Wh.GRID){if(i=Array.isArray(e)?q2.createBy(e):e.cloneSelection(),i instanceof q2&&this._prevSelection instanceof q2&&dR.equal(i.anchor,this._prevSelection.anchor)){if(i instanceof q2&&this._fieldValue){const e=this._readService.getFlatViewRecords(n.uuid),o=this._readService.getViewFields(n.uuid)||[],a=null==(t=e[i.anchor.row])?void 0:t.record_uuid,s=null==(r=o[i.anchor.column])?void 0:r.field_uuid;(this._fieldValue.recordId!==a||this._fieldValue.fieldId!==s)&&(this._fieldValue=this._getSelectFieldValue(i),this._onAnchorChange.emit({selection:i,fieldValue:this._fieldValue}))}}else this._fieldValue=this._getSelectFieldValue(i),this._onAnchorChange.emit({selection:i,fieldValue:this._fieldValue});if(this._prevSelection instanceof q2&&i instanceof q2&&q2.equal(i,this._prevSelection))return}else i=e;this._selection=i,this._onChange.emit({selection:this._selection})}}removeSelection(){this._selection=null,this._prevSelection=null,this._fieldValue=null,this._onChange.emit({selection:null}),this._onAnchorChange.emit({selection:null,fieldValue:null})}getRangeAt(e){var t;return null==(t=this._selection)?void 0:t.getRangeAt(e)}createGridSelectionByScope(e,t,r,n){return function(e,t,r,n){const i=new dR(e.row,e.column,r,n),o=new dR(t.row,t.column,r,n),a=G2.createAt(i,o);return q2.createBy([a],i,o)}(e,t,r,n)}createGridSelectionByIndex(e,t,r,n){if(ad(r)||ad(n)){const e=this._readService.getActiveView();r=ad(r)?(this._readService.getFlatViewRecords(null==e?void 0:e.uuid)||[]).length:r,n=ad(n)?(this._readService.getViewFields(null==e?void 0:e.uuid)||[]).length:n}return function(e,t,r,n){const i=G2.createAt(new dR(e,t,r,n),new dR(e,t,r,n));return q2.createBy([i])}(e,t,r,n)}createRowGridSelectionByIndex(e,t,r){return function(e,t,r){const n=G2.createAt(new dR(e,0,t,r),new dR(e,r-1,t,r));return q2.createBy([n])}(e,t,r)}createColumnGridSelectionByIndex(e,t,r){return function(e,t,r){const n=G2.createAt(new dR(0,e,t,r),new dR(t-1,e,t,r));return q2.createBy([n])}(e,t,r)}createSelectionById(e,t){const r=this._readService.getActiveView();if(!r)return null;if(r.type===Wh.GRID){const n=this._readService.getViewFields(r.uuid)||[],i=this._readService.getFlatViewRecords(r.uuid)||[];let o=0;t&&"string"==typeof t&&(o=null==n?void 0:n.findIndex((e=>e.field_uuid===t)));const a=i.findIndex((t=>t.record_uuid===e)),s=G2.createAt(new dR(a,o,i.length,n.length));return q2.createBy([s])}const n=K2.createAt(e);return Y2.createBy([n])}moveToRecord(e){const t=this._readService.getActiveView(),r=this._readService.getFlatViewRecords(null==t?void 0:t.uuid),n=r.findIndex((t=>t.record_uuid===e));if(!(n<0)){if((null==t?void 0:t.type)===Wh.GRID){const e=this._readService.getViewFieldsCount(),t=this.createGridSelectionByIndex(n,0,r.length,e);this.scrollToSelection(t,"end")}if((null==t?void 0:t.type)===Wh.KANBAN&&this._kanbanScrollService){const r=this._readService.getViewRecords(null==t?void 0:t.uuid),{index:n,groupId:i}=this._kanbanScrollService.getKanbanGroupPositionByRecordId(e,r);i&&n>=0&&this._kanbanScrollIntoView(i,n,"end")}(null==t?void 0:t.type)===Wh.CARD&&this._cardScrollIntoView(n,"end")}}moveUp(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof q2&&t){const e=function(e){return e.isAtRowStart?null:q2.createBy([G2.createAt(new dR(e.row-1,e.column,e.rowCount,e.columnCount))])}(this._selection.anchor);this.scrollToSelection(e,"start")}}moveDown(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof q2&&t){const e=function(e){return e.isAtRowEnd?null:q2.createBy([G2.createAt(new dR(e.row+1,e.column,e.rowCount,e.columnCount))])}(this._selection.anchor);this.scrollToSelection(e,"end")}}moveLeft(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof q2&&t){const e=function(e){return e.isAtColumnStart?e.isAtRowStart?null:q2.createBy([G2.createAt(new dR(e.row-1,e.columnCount-1,e.rowCount,e.columnCount))]):q2.createBy([G2.createAt(new dR(e.row,e.column-1,e.rowCount,e.columnCount))])}(this._selection.anchor);this.scrollToSelection(e,"start")}}moveRight(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof q2&&t){const e=function(e){return e.isAtColumnEnd?e.isAtRowEnd?null:q2.createBy([G2.createAt(new dR(e.row+1,0,e.rowCount,e.columnCount))]):q2.createBy([G2.createAt(new dR(e.row,e.column+1,e.rowCount,e.columnCount))])}(this._selection.anchor);this.scrollToSelection(e,"end")}}moveFocusUp(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof q2&&t){const e=function(e){const t=e.anchor,r=e.focus;if(!r.isAtRowStart){const n=e.getRangeAt(0),i=new dR(r.row-1,r.column,n.rowCount,n.columnCount);return q2.createBy([G2.createAt(t,i)],t,i)}return null}(this._selection);this.scrollToSelection(e,"start")}}moveFocusDown(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof q2&&t){const e=function(e){const t=e.anchor,r=e.focus;if(!r.isAtRowEnd){const n=e.getRangeAt(0),i=new dR(r.row+1,r.column,n.rowCount,n.columnCount);return q2.createBy([G2.createAt(t,i)],t,i)}return null}(this._selection);this.scrollToSelection(e,"end")}}moveFocusLeft(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof q2&&t){const e=function(e){const t=e.anchor,r=e.focus;if(!r.isAtColumnStart){const n=e.getRangeAt(0),i=new dR(r.row,r.column-1,n.rowCount,n.columnCount);return q2.createBy([G2.createAt(t,i)],t,i)}return null}(this._selection);this.scrollToSelection(e,"start")}}moveFocusRight(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof q2&&t){const e=function(e){const t=e.anchor,r=e.focus;if(!r.isAtColumnEnd){const n=e.getRangeAt(0),i=new dR(r.row,r.column+1,n.rowCount,n.columnCount);return q2.createBy([G2.createAt(t,i)],t,i)}return null}(this._selection);this.scrollToSelection(e,"end")}}moveTop(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof q2&&t){const e=function(e){return e.isAtRowStart?null:q2.createBy([G2.createAt(new dR(0,e.column,e.rowCount,e.columnCount))])}(this._selection.anchor);this.scrollToSelection(e,"start")}}moveBottom(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof q2&&t){const e=function(e){return e.isAtRowEnd?null:q2.createBy([G2.createAt(new dR(e.rowCount-1,e.column,e.rowCount,e.columnCount))])}(this._selection.anchor);this.scrollToSelection(e,"end")}}moveFirstLeft(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof q2&&t){const e=function(e){return e.isAtColumnStart?null:q2.createBy([G2.createAt(new dR(e.row,0,e.rowCount,e.columnCount))])}(this._selection.anchor);this.scrollToSelection(e,"start")}}moveLastRight(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof q2&&t){const e=function(e){return e.isAtColumnEnd?null:q2.createBy([G2.createAt(new dR(e.row,e.columnCount-1,e.rowCount,e.columnCount))])}(this._selection.anchor);this.scrollToSelection(e,"end")}}selectAll(){const e=this._readService.getActiveView();if(e&&e.type===Wh.GRID){const t=this._readService.getViewRecordsCount(e.uuid),r=this._readService.getViewFieldsCount(e.uuid),n=this.createGridSelectionByScope({row:0,column:0},{row:t-1,column:r-1},t,r);this.setSelection(n)}}getSelectBoundingRect(){if(this._selection){const e=this._renderContext.$root,t=this.getSelectAnchorTarget();if(t){const r=e.getBoundingClientRect(),n=t.getBoundingClientRect();return n.right<r.left||n.left>r.right||n.bottom<r.top||n.top>r.bottom?null:DOMRect.fromRect({x:n.x,y:n.y,width:n.width,height:n.height})}}return null}_getSelectPositionTarget(e){return this._renderContext.$root.querySelector(`.lakex-viewer-grid-row[data-row="${e.row}"] .lakex-viewer-grid-cell[data-col="${e.column}"]`)}getSelectAnchorTarget(e){return!e&&this._selection instanceof q2&&(e=this._selection),e?this._getSelectPositionTarget(e.anchor):null}getSelectFocusTarget(e){return!e&&this._selection instanceof q2&&(e=this._selection),e?this._getSelectPositionTarget(e.focus):null}isSelectOneCell(){const e=this._selection;if(!e)return!1;if(this._currentViewType===Wh.GRID){const{anchor:t,focus:r}=e;return t.row===r.row&&t.column===r.column}return!1}isInSelect(e,t){const r=this._selection;if(!r)return!1;const{start:n,end:i}=r.ranges[0];return e>=n.row&&e<=i.row&&t>=n.column&&t<=i.column}isActiveCell(e,t){const r=this._selection;return!!r&&(r.anchor.column===t&&r.anchor.row===e)}isAtStart(){const e=this._selection,{anchor:t,focus:r}=e;return!!e&&(t.row===r.row&&t.column===r.column&&e.anchor.isAtRowStart&&e.anchor.isAtColumnStart)}isAtEnd(){const e=this._selection,{anchor:t,focus:r}=e;return!!e&&(t.row===r.row&&t.column===r.column&&e.anchor.isAtRowEnd&&e.anchor.isAtColumnEnd)}scrollToAnchorPosition(e,t,r){const n=null==e?void 0:e.anchor;this._gridScrollIntoView(n.row,t,(()=>{requestAnimationFrame((()=>{var t;const n=this.getSelectAnchorTarget(e);n&&(null==(t=this._gridScrollService)||t.horizontalScroll(n,e.anchor.column)),this.setSelection(e),r&&r()}))}))}scrollToFocusPosition(e,t,r){const n=null==e?void 0:e.focus;this._gridScrollIntoView(n.row,t,(()=>{requestAnimationFrame((()=>{var t;const n=this.getSelectFocusTarget(e);n&&(null==(t=this._gridScrollService)||t.horizontalScroll(n,e.focus.column)),this.setSelection(e),r&&r()}))}))}scrollToSelection(e,t,r){if(!e)return;const n=this._readService.getActiveView();if((null==n?void 0:n.type)!==Wh.GRID)if((null==n?void 0:n.type)===Wh.KANBAN&&this._kanbanScrollService){const{recordId:i}=e.getRangeAt(0),o=this._readService.getViewRecords(null==n?void 0:n.uuid),{index:a,groupId:s}=this._kanbanScrollService.getKanbanGroupPositionByRecordId(i,o);s&&a>=0&&this._kanbanScrollIntoView(s,a,t,(()=>{var t,n;null==(n=null==(t=this._kanbanScrollService)?void 0:t.groupRefs[s])||n.scrollIntoView(),this.setSelection(e),r&&r()}))}else if((null==n?void 0:n.type)!==Wh.CARD);else{const{recordId:i}=e.getRangeAt(0),o=this._readService.getViewRecords(null==n?void 0:n.uuid);let a=-1;for(let e=0;e<o.length;e++)if(o[e].record_uuid===i){a=e;break}a>=0&&this._cardScrollIntoView(a,t,(()=>{this.setSelection(e),r&&r()}))}else this.scrollToFocusPosition(e,t,r)}_gridScrollIntoView(e,t,r){var n;null==(n=this._gridScrollService)||n.scrollIntoView({index:e,align:t,done:()=>{r&&r()}})}_kanbanScrollIntoView(e,t,r,n){var i;null==(i=this._kanbanScrollService)||i.scrollIntoView(e,{index:t,align:r,done:()=>{n&&n()}})}_cardScrollIntoView(e,t,r){var n;null==(n=this._cardScrollService)||n.scrollToIndex({index:e,align:t}),r&&r()}_getSelectFieldValue(e){var t,r;if(!e)return null;const n=this._readService.getActiveView();if(!n)return null;const i=e.anchor,o=this._readService.getViewFields(n.uuid)||[],a=this._readService.getFlatViewRecords(n.uuid)||[],s=null==(t=null==o?void 0:o[i.column])?void 0:t.field_uuid,l=null==(r=a[i.row])?void 0:r.record_uuid;return s&&l?this._readService.getCell(s,l):null}_getSelectFieldValues(e){var t,r;if(!e)return null;const n=this._readService.getActiveView();if(!n)return null;const i=this._readService.getViewFields(n.uuid)||[],o=this._readService.getFlatViewRecords(n.uuid)||[],a=[],s=e.getRangeAt(0);for(let e=s.start.row;e<=s.end.row;e++)for(let n=s.start.column;n<=s.end.column;n++){const s=null==(t=null==i?void 0:i[n])?void 0:t.field_uuid,l=null==(r=o[e])?void 0:r.record_uuid;if(!s||!l)continue;const c=this._readService.getCell(s,l);c&&a.push(c)}return a}};function t3(){const e=zA(e3),[t,r]=Object(a.useState)((()=>null==e?void 0:e.getSelection()));return Object(a.useEffect)((()=>{const t=null==e?void 0:e.onChange((({selection:e})=>{r(e)}));return()=>{null==t||t.destroy()}}),[e]),t}J2([to(Dy)],e3.prototype,"_readService",2),J2([to(Uj)],e3.prototype,"_renderContext",2),J2([Si()],e3.prototype,"destroy",1),e3=J2([eo()],e3);const r3=Object(a.createContext)(null);function n3(){return Object(a.useContext)(r3)}function i3(e){const t=t3();return s.a.createElement(r3.Provider,{value:t},e.children)}var o3=Object.defineProperty,a3=Object.getOwnPropertyDescriptor;let s3=class{get SelectionContainer(){return i3}};function l3(){const e=zA(e3),t=zA(Pb),[r,n]=Object(a.useState)(null==e?void 0:e.getFieldValue()),i=zA(Dy),o=zA(Fv),s=Object(a.useCallback)(((e,t)=>i.getCell(t,e)),[i]);return Object(a.useEffect)((()=>{const t=null==e?void 0:e.onAnchorChange((({fieldValue:e})=>{n(e)}));return()=>{null==t||t.destroy()}}),[e]),Object(a.useEffect)((()=>{const e=null==o?void 0:o.onCellChange((e=>{!r||e.recordId===r.recordId&&e.fieldId===r.fieldId&&n(s(r.recordId,r.fieldId))}));return()=>{null==e||e.destroy()}}),[t,s,r]),r}function c3(e){const t=zA(e3),[r,n]=Object(a.useState)(null),i=l3(),o=Object(a.useCallback)((()=>{const e=null==t?void 0:t.getSelectBoundingRect();return e?{left:e.left,top:e.top,width:e.width,height:e.height}:null}),[]),s=Object(a.useCallback)((()=>{const e=o();n(e)}),[]);return Object(a.useLayoutEffect)((()=>{const t=setTimeout((()=>{e&&s()}),80);return()=>{clearTimeout(t)}}),[e,null==i?void 0:i.value]),Object(a.useLayoutEffect)((()=>{e&&s()}),[e]),r}s3=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?a3(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&o3(t,r,o),o})([eo()],s3);const u3=Fi.defineToken("ViewerGridPluginRecordContribution"),d3=Fi.defineToken("ViewerGridPluginStatisticsContribution"),f3=Fi.defineToken("ViewerGridPluginAddFieldContribution"),p3=Fi.defineToken("ViewerGridPluginAddRecordContribution");var h3=Object.defineProperty,m3=Object.getOwnPropertyDescriptor,v3=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?m3(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&h3(t,r,o),o};let g3=class{constructor(){this.UNGROUP_KEY="ungroup",this.Record=null,this.Statistics=null,this.AddField=null,this.AddRecord=null,this._getRecordComponent=()=>{var e,t;const r=this.viewerGridPluginRecordProvider.getContributions({cache:!1});return r[0]?null==(t=(e=r[0]).getRecordComponent)?void 0:t.call(e):null},this._getStatisticsComponent=()=>{var e,t;const r=this.viewerGridPluginStatisticsProvider.getContributions({cache:!1});return r[0]?null==(t=(e=r[0]).getStatisticsComponent)?void 0:t.call(e):null},this._getAddFieldComponent=()=>{var e,t;const r=this.viewerGridPluginAddFieldProvider.getContributions({cache:!1});return r[0]?null==(t=(e=r[0]).getAddFieldComponent)?void 0:t.call(e):null},this._getAddRecordComponent=()=>{var e,t;const r=this.viewerGridPluginAddRecordProvider.getContributions({cache:!1});return r[0]?null==(t=(e=r[0]).getAddRecordComponent)?void 0:t.call(e):null}}init(){this.Record=this._getRecordComponent(),this.Statistics=this._getStatisticsComponent(),this.AddField=this._getAddFieldComponent(),this.AddRecord=this._getAddRecordComponent()}};v3([Eo(u3)],g3.prototype,"viewerGridPluginRecordProvider",2),v3([Eo(d3)],g3.prototype,"viewerGridPluginStatisticsProvider",2),v3([Eo(f3)],g3.prototype,"viewerGridPluginAddFieldProvider",2),v3([Eo(p3)],g3.prototype,"viewerGridPluginAddRecordProvider",2),g3=v3([eo()],g3);var y3=Object.defineProperty,b3=Object.getOwnPropertyDescriptor,w3=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?b3(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&y3(t,r,o),o};let _3=class extends Zf{constructor(){super(...arguments),this._onResizeStart=this._register(new op),this.onResizeStart=this._onResizeStart.event,this._onResize=this._register(new op),this.onResize=this._onResize.event,this._onResizeEnd=this._register(new op),this.onResizeEnd=this._onResizeEnd.event,this._indexColWidth=80,this._minColWidth=80,this._maxColWidth=800,this._defaultColWidth=180,this._scrollStep=10,this._scrollThreshold=100,this._groupRowGap=14,this._rootLeft=0,this._rootRight=0,this._scrollLeft=0,this._field=null,this._index=-1,this._startW=0,this._minW=this._indexColWidth+this._minColWidth,this._maxW=Number.MAX_SAFE_INTEGER,this._stickyPaneWidth=0}get indexColWidth(){return this._indexColWidth}get defaultColWidth(){return this._defaultColWidth}get groupRowGap(){return this._groupRowGap}get stickyColNum(){return this._configuration.getValue("viewerGrid.stickyColNum")}getStickyPaneWidth(e){return this._getColTotalWidth(e,this.stickyColNum)+this._indexColWidth}_getColTotalWidth(e,t=0){return e.map((e=>e.size||this._defaultColWidth)).slice(0,t).reduce(((e,t)=>e+t),0)}emitResizeStart(e,t,r){const n=t[r],i=this._renderContext.$root.getBoundingClientRect();this._field=n,this._index=r,this._startW=this._getColTotalWidth(t,r+1)+this._indexColWidth,this._minW=this._getColTotalWidth(t,r)+this._indexColWidth+this._minColWidth,this._maxW=this._minW-this._minColWidth+this._maxColWidth,this._stickyPaneWidth=this.getStickyPaneWidth(t),this._rootLeft=i.left,this._rootRight=i.right,this._$scroller=this._renderContext.$root.querySelector('div[data-virtuoso-scroller="true"]'),this._scrollLeft=this._$scroller.scrollLeft,document.body.style.cursor="col-resize",this._onResizeStart.emit({field:this._field,x:e.clientX-this._rootLeft})}emitResizing(e){if(this._index<this.stickyColNum){const t=e.clientX-this._rootLeft,r=this._minW,n=this._maxW;t>=r&&t<=n&&t>0&&this._onResize.emit({field:this._field,x:t})}else{const t=e.clientX-this._rootLeft,r=this._minW-this._scrollLeft,n=this._maxW-this._scrollLeft;t>=r&&t<n&&this._rootRight-this._rootLeft-t<=this._scrollThreshold&&(this._scrollLeft+=this._scrollStep,this._$scroller.scrollLeft+=this._scrollStep),this._scrollLeft>0&&t<this._stickyPaneWidth+this._scrollThreshold&&r<this._stickyPaneWidth&&(this._scrollLeft-=this._scrollStep,this._$scroller.scrollLeft-=this._scrollStep),t>=r&&t<=n&&t>0&&this._onResize.emit({field:this._field,x:t})}}emitResizeEnd(e){var t,r,n;this._onResizeEnd.emit({field:this._field,x:e.clientX-this._rootLeft});const i=this._index<this.stickyColNum,o=e.clientX-this._rootLeft+(i?0:this._scrollLeft),a=Math.max(o,this._minW)-this._startW,s=(null==(t=this._field)?void 0:t.size)||this._defaultColWidth,l=Math.max(s+a,this._minColWidth);this._commandService.execCommand("changeColWidth",{viewId:null==(r=this._field)?void 0:r.view_uuid,fieldId:null==(n=this._field)?void 0:n.field_uuid,size:Math.min(l,this._maxColWidth)}),this._reset()}_reset(){this._startW=0,this._minW=this._indexColWidth+this._minColWidth,this._maxW=Number.MAX_SAFE_INTEGER,this._stickyPaneWidth=0,this._field=null,this._index=-1,this._rootLeft=0,this._rootRight=0,this._scrollLeft=0,document.body.style.cursor="default"}destroy(){super.destroy()}};w3([to(Uj)],_3.prototype,"_renderContext",2),w3([to(Pb)],_3.prototype,"_commandService",2),w3([to(qf)],_3.prototype,"_configuration",2),w3([Si()],_3.prototype,"destroy",1),_3=w3([eo()],_3);var C3=Object.defineProperty,E3=Object.getOwnPropertyDescriptor,x3=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?E3(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&C3(t,r,o),o};let S3=class{constructor(){this._recordHeightMap={low:36,middle:58,high:146}}getRowHeight(e="low"){return this._recordHeightMap[e]||this._recordHeightMap.low}get rowHeightSize(){const e=this._readService.getViewConfig(),t=null==e?void 0:e.record_height;return this._recordHeightMap[t]}};x3([to(Dy)],S3.prototype,"_readService",2),S3=x3([eo()],S3);var k3=Object.defineProperty,O3=Object.getOwnPropertyDescriptor,I3=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?O3(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&k3(t,r,o),o};let R3=class{constructor(){this._tableVirtuosoRef=null,this._tableScroller=null,this._timer=void 0,this.scrollChangedVersion=null,this.onScroll=RA((()=>{this.scrollChangedVersion=Io()}),60)}get tableVirtuosoRef(){return this._tableVirtuosoRef}get tableScroller(){if(!this._tableScroller){const e=this.renderContext.$root.querySelector('div[data-virtuoso-scroller="true"]');e&&(this._tableScroller=e)}return this._tableScroller}destroy(){clearTimeout(this._timer),this._tableVirtuosoRef=null,this._tableScroller=null}setTableVirtuosoRef(e){this._tableVirtuosoRef=e}isScrolling(e){var t;e?(clearTimeout(this._timer),null==(t=this.tableScroller)||t.setAttribute("data-scrolling","true")):this._timer=setTimeout((()=>{var e;null==(e=this.tableScroller)||e.setAttribute("data-scrolling","false")}),600)}scrollIntoView(e){var t;null==(t=this._tableVirtuosoRef)||t.scrollIntoView(e)}scrollTo(e){var t;null==(t=this._tableVirtuosoRef)||t.scrollTo(e)}horizontalScroll(e,t){const r=this._readService.getActiveView(),n=t<this._columnControllerService.stickyColNum,i=this.tableScroller;if(!n&&e&&i&&r){const t=i.getBoundingClientRect(),n=e.getBoundingClientRect(),o=this._readService.getViewFields(r.uuid)||[],a=this._readService.getViewGroup(null==r?void 0:r.uuid)?this._columnControllerService.groupRowGap:0,s=this._columnControllerService.getStickyPaneWidth(o)+a;n.right>t.right&&(i.scrollLeft+=n.right-t.right),n.left<t.left+s&&(i.scrollLeft-=t.left+s-n.left)}}mouseMoveScroll(e,t,r,n,i){const o=this.tableScroller,a=(null==n?void 0:n.left)||0,s=(null==n?void 0:n.top)||0,l=e.clientX,c=e.clientY,u=100;o&&l+u>=t?o.scrollLeft+=10:o&&l-u<=a+this._columnControllerService.getStickyPaneWidth(i)&&(o.scrollLeft-=10),o&&c-u<=s?o.scrollTop-=10:o&&c+u>=r&&(o.scrollTop+=10)}};I3([to(Uj)],R3.prototype,"renderContext",2),I3([to(_3)],R3.prototype,"_columnControllerService",2),I3([to(Dy)],R3.prototype,"_readService",2),R3=I3([eo()],R3);var T3=Object.defineProperty,A3=Object.getOwnPropertyDescriptor,N3=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?A3(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&T3(t,r,o),o};let M3=class{constructor(){this._rowCoordsByIndex=new Map,this._colCoordsByIndex=new Map,this._scrollUpdatedVersion=""}get _viewport(){return this._renderViewPort.viewport}updateCellCoordsInViewPort(){this._scrollUpdatedVersion&&this._scrollUpdatedVersion===this._scrollService.scrollChangedVersion||(this._scrollUpdatedVersion=this._scrollService.scrollChangedVersion,this._updateRowsLayout(),this._updateColsLayout())}getCellIndexesByClientXY(e,t){if(!this._renderViewPort.isDotInViewPort(e,t))return null;const r=this._getTargetRowIndexByClientY(t);if(ad(r))return null;const n=this._getTargetColIndexByClientX(e);return ad(n)?null:[r,n]}_updateRowsLayout(){this._rowCoordsByIndex.clear();const e=this._renderContext.$root;if(!this._viewport)return;const t=e.querySelectorAll(".lakex-viewer-grid-row-container.normal .lakex-viewer-grid-row[data-row]");if(t)for(const e of t){const t=Number(e.getAttribute("data-row")),r=e.getBoundingClientRect();r.top<this._viewport.top||r.bottom>this._viewport.bottom||this._rowCoordsByIndex.set(t,{top:r.top,bottom:r.bottom})}}_updateColsLayout(){this._colCoordsByIndex.clear();const e=this._renderContext.$root;if(!this._viewport)return;const t=e.querySelectorAll(".lakex-viewer-grid-header-column[data-col-index]");if(t)for(const e of t){const t=Number(e.getAttribute("data-col-index")),r=e.getBoundingClientRect();r.left<this._viewport.left||r.right>this._viewport.right||this._colCoordsByIndex.set(t,{left:r.left,right:r.right})}}_getTargetRowIndexByClientY(e){if(!this._rowCoordsByIndex)return null;const t=[...this._rowCoordsByIndex.keys()];let r=0,n=t.length-1;const i=Date.now();for(;r<=n;){if(Date.now()-i>500)return null;const o=Math.floor((r+n)/2),a=t[o],s=this._rowCoordsByIndex.get(a);if(!s){console.warn("_getTargetRowIndexByClientY.get curRowIndex never");break}if(e<s.bottom&&s.top<e)return a;s.bottom<e?r=o+1:e<s.top&&(n=o-1)}return null}_getTargetColIndexByClientX(e){if(!this._colCoordsByIndex)return null;const t=[...this._colCoordsByIndex.keys()];let r=0,n=t.length-1;const i=Date.now();for(;r<=n;){if(Date.now()-i>500)return null;const o=Math.floor((r+n)/2),a=t[o],s=this._colCoordsByIndex.get(a);if(!s){console.warn("_getTargetColIndexByClientX.get curRowIndex never");break}if(e<s.right&&s.left<e)return a;s.left<e?r=o+1:e<s.right&&(n=o-1)}return null}};N3([to(Uj)],M3.prototype,"_renderContext",2),N3([to(Kj)],M3.prototype,"_renderViewPort",2),N3([to(R3)],M3.prototype,"_scrollService",2),M3=N3([eo()],M3);var P3=(e=>(e.text="text/plain",e.html="text/html",e.innerCopy="innerCopy",e))(P3||{});const j3=class{static _setDataToInnerCache(e){j3._innerCache.push(e)}static _getDataFromInnerCache(){return j3._innerCache[j3._innerCache.length-1]}static getFilesFromClipBoard(e){const t=e&&(e.dataTransfer||e.clipboardData);if(!t)return null;const r=t.getData(P3.text);let n=[];try{t.items&&t.items.length>0?n=Array.from(t.items).map((e=>{let t="file"===e.kind?e.getAsFile():null;return null!==t&&(t.type&&t.type.indexOf("image/png")>-1&&!t.lastModified&&(t=new File([t],"image.png",{type:t.type})),t.ext=r.split(".").pop()),t})).filter((e=>e)):t.files&&t.files.length>0&&(n=Array.from(t.files))}catch{t.files&&t.files.length>0&&(n=Array.from(t.files))}return n}static async getClipboardData(e,t,r){if(null!=r&&r.disableClipboardApi){const t=j3._getDataFromInnerCache();return t?t[e]:null}if(t){const r=j3.getClipboardDataFromClipboardEvent(t,e);if(r)return r}return await j3.getClipboardDataFromClipboardApi(e)}static getClipboardDataFromClipboardEvent(e,t){var r;const n=e&&(e.dataTransfer||e.clipboardData);return n?null==(r=n.getData)?void 0:r.call(n,t):null}static async getClipboardDataFromClipboardApi(e){if(!navigator.clipboard.read)return j3.notSupportClipboardApiToast(),null;try{const t=await navigator.clipboard.read();for(const r of t)for(const t of r.types)if(t===e)return await(await r.getType(t)).text()}catch(e){console.error("getClipboardDataFromClipboardApi err",e)}return null}static async writeToClipboardData(e,t,r){if(null!=r&&r.disableClipboardApi)j3._setDataToInnerCache(e);else{if(null!=t&&t.setData)return null!=e.innerCopy&&t.setData(P3.innerCopy,e.innerCopy),null!=e.html&&t.setData(P3.html,e.html),void(null!=e.text&&t.setData(P3.text,e.text));if(e.html){!function(e){const t=document.createElement("div");t.style.position="fixed",t.style.top="0",t.style.clip="rect(0, 0, 0, 0)",document.body.appendChild(t),t.innerHTML=e;const r=document.createRange(),n=window.getSelection(),i=t.querySelector("table");if(!i||!n)return!1;r.selectNodeContents(i),n.removeAllRanges(),n.addRange(r);let o=!1;try{if(o=document.execCommand("copy"),!o)throw"copy command was unsuccessful"}catch(e){throw new Error("unable to copy using execCommand: ",{cause:e})}finally{t.remove(),n.removeAllRanges()}}(e.html);try{const t=new Blob([e.html],{type:P3.html}),r=new ClipboardItem({[P3.html]:t});await navigator.clipboard.write([r])}catch(e){return void console.error("writeToClipboardDataByClipboardApi err",e)}}}}};let D3=j3;D3._innerCache=[],D3.notSupportClipboardApiToast=RA((()=>{v.a.error(kf("当前浏览器不支持访问剪贴板数据，建议您使用 Chrome 浏览器访问"))}),100);var F3=(e=>(e.COPY="copy",e.CUT="cut",e.NULL="null",e))(F3||{});var V3=IU;var L3=function(e,t,r){for(var n=-1,i=e.length;++n<i;){var o=e[n],a=t(o);if(null!=a&&(void 0===s?a==a&&!V3(a):r(a,s)))var s=a,l=o}return l};var $3=function(e,t){return e>t};var B3=function(e){return e},z3=L3,U3=$3,H3=B3;var W3=function(e){return e&&e.length?z3(e,H3,U3):void 0};var G3=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},K3=xU,q3=G3;var Y3=function(e){if(!q3(e))return!1;var t=K3(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},X3=cU["__core-js_shared__"],Z3=function(){var e=/[^.]+$/.exec(X3&&X3.keys&&X3.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var J3=function(e){return!!Z3&&Z3 in e},Q3=Function.prototype.toString;var e5=function(e){if(null!=e){try{return Q3.call(e)}catch{}try{return e+""}catch{}}return""},t5=Y3,r5=J3,n5=G3,i5=e5,o5=/^\[object .+?Constructor\]$/,a5=Function.prototype,s5=Object.prototype,l5=a5.toString,c5=s5.hasOwnProperty,u5=RegExp("^"+l5.call(c5).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var d5=function(e){return!(!n5(e)||r5(e))&&(t5(e)?u5:o5).test(i5(e))};var f5=function(e,t){return null==e?void 0:e[t]},p5=d5,h5=f5;var m5=function(e,t){var r=h5(e,t);return p5(r)?r:void 0},v5=m5,g5=function(){try{var e=v5(Object,"defineProperty");return e({},"",{}),e}catch{}}(),y5=g5,b5=y5;var w5=function(e,t,r){"__proto__"==t&&b5?b5(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r};var _5=function(e,t,r,n){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(n,a,r(a),e)}return n};var C5=function(e){return function(t,r,n){for(var i=-1,o=Object(t),a=n(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===r(o[l],l,o))break}return t}},E5=C5();var x5=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n},S5=xU,k5=SU;var O5=function(e){return k5(e)&&"[object Arguments]"==S5(e)},I5=O5,R5=SU,T5=Object.prototype,A5=T5.hasOwnProperty,N5=T5.propertyIsEnumerable,M5=I5(function(){return arguments}())?I5:function(e){return R5(e)&&A5.call(e,"callee")&&!N5.call(e,"callee")},P5=M5,j5={exports:{}};var D5=function(){return!1};!function(e,t){var r=cU,n=D5,i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,a=o&&o.exports===i?r.Buffer:void 0,s=(a?a.isBuffer:void 0)||n;e.exports=s}(j5,j5.exports);var F5=/^(?:0|[1-9]\d*)$/;var V5=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&F5.test(e))&&e>-1&&e%1==0&&e<t};var L5=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},$5=xU,B5=L5,z5=SU,U5={};U5["[object Float32Array]"]=U5["[object Float64Array]"]=U5["[object Int8Array]"]=U5["[object Int16Array]"]=U5["[object Int32Array]"]=U5["[object Uint8Array]"]=U5["[object Uint8ClampedArray]"]=U5["[object Uint16Array]"]=U5["[object Uint32Array]"]=!0,U5["[object Arguments]"]=U5["[object Array]"]=U5["[object ArrayBuffer]"]=U5["[object Boolean]"]=U5["[object DataView]"]=U5["[object Date]"]=U5["[object Error]"]=U5["[object Function]"]=U5["[object Map]"]=U5["[object Number]"]=U5["[object Object]"]=U5["[object RegExp]"]=U5["[object Set]"]=U5["[object String]"]=U5["[object WeakMap]"]=!1;var H5=function(e){return z5(e)&&B5(e.length)&&!!U5[$5(e)]};var W5=function(e){return function(t){return e(t)}},G5={exports:{}};!function(e,t){var r=aU,n=t&&!t.nodeType&&t,i=n&&e&&!e.nodeType&&e,o=i&&i.exports===n&&r.process,a=function(){try{return i&&i.require&&i.require("util").types||o&&o.binding&&o.binding("util")}catch{}}();e.exports=a}(G5,G5.exports);var K5=H5,q5=W5,Y5=G5.exports,X5=Y5&&Y5.isTypedArray,Z5=X5?q5(X5):K5,J5=x5,Q5=P5,e6=fU,t6=j5.exports,r6=V5,n6=Z5,i6=Object.prototype.hasOwnProperty;var o6=function(e,t){var r=e6(e),n=!r&&Q5(e),i=!r&&!n&&t6(e),o=!r&&!n&&!i&&n6(e),a=r||n||i||o,s=a?J5(e.length,String):[],l=s.length;for(var c in e)(t||i6.call(e,c))&&(!a||!("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||r6(c,l)))&&s.push(c);return s},a6=Object.prototype;var s6=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||a6)};var l6=function(e,t){return function(r){return e(t(r))}},c6=l6(Object.keys,Object),u6=s6,d6=c6,f6=Object.prototype.hasOwnProperty;var p6=function(e){if(!u6(e))return d6(e);var t=[];for(var r in Object(e))f6.call(e,r)&&"constructor"!=r&&t.push(r);return t},h6=Y3,m6=L5;var v6=function(e){return null!=e&&m6(e.length)&&!h6(e)},g6=o6,y6=p6,b6=v6;var w6=function(e){return b6(e)?g6(e):y6(e)},_6=E5,C6=w6;var E6=function(e,t){return e&&_6(e,t,C6)},x6=v6;var S6=function(e,t){return function(r,n){if(null==r)return r;if(!x6(r))return e(r,n);for(var i=r.length,o=t?i:-1,a=Object(r);(t?o--:++o<i)&&!1!==n(a[o],o,a););return r}},k6=S6(E6),O6=k6;var I6=function(e,t,r,n){return O6(e,(function(e,i,o){t(n,e,r(e),o)})),n};var R6=function(){this.__data__=[],this.size=0};var T6=function(e,t){return e===t||e!=e&&t!=t},A6=T6;var N6=function(e,t){for(var r=e.length;r--;)if(A6(e[r][0],t))return r;return-1},M6=N6,P6=Array.prototype.splice;var j6=function(e){var t=this.__data__,r=M6(t,e);return!(r<0)&&(r==t.length-1?t.pop():P6.call(t,r,1),--this.size,!0)},D6=N6;var F6=function(e){var t=this.__data__,r=D6(t,e);return r<0?void 0:t[r][1]},V6=N6;var L6=function(e){return V6(this.__data__,e)>-1},$6=N6;var B6=function(e,t){var r=this.__data__,n=$6(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},z6=R6,U6=j6,H6=F6,W6=L6,G6=B6;function K6(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}K6.prototype.clear=z6,K6.prototype.delete=U6,K6.prototype.get=H6,K6.prototype.has=W6,K6.prototype.set=G6;var q6=K6,Y6=q6;var X6=function(){this.__data__=new Y6,this.size=0};var Z6=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var J6=function(e){return this.__data__.get(e)};var Q6=function(e){return this.__data__.has(e)},e4=m5(cU,"Map"),t4=m5(Object,"create"),r4=t4;var n4=function(){this.__data__=r4?r4(null):{},this.size=0};var i4=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},o4=t4,a4=Object.prototype.hasOwnProperty;var s4=function(e){var t=this.__data__;if(o4){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return a4.call(t,e)?t[e]:void 0},l4=t4,c4=Object.prototype.hasOwnProperty;var u4=function(e){var t=this.__data__;return l4?void 0!==t[e]:c4.call(t,e)},d4=t4;var f4=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=d4&&void 0===t?"__lodash_hash_undefined__":t,this},p4=n4,h4=i4,m4=s4,v4=u4,g4=f4;function y4(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}y4.prototype.clear=p4,y4.prototype.delete=h4,y4.prototype.get=m4,y4.prototype.has=v4,y4.prototype.set=g4;var b4=y4,w4=q6,_4=e4;var C4=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},E4=C4;var x4=function(e,t){var r=e.__data__;return E4(t)?r["string"==typeof t?"string":"hash"]:r.map},S4=x4;var k4=function(e){var t=S4(this,e).delete(e);return this.size-=t?1:0,t},O4=x4;var I4=function(e){return O4(this,e).get(e)},R4=x4;var T4=function(e){return R4(this,e).has(e)},A4=x4;var N4=function(e,t){var r=A4(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},M4=function(){this.size=0,this.__data__={hash:new b4,map:new(_4||w4),string:new b4}},P4=k4,j4=I4,D4=T4,F4=N4;function V4(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}V4.prototype.clear=M4,V4.prototype.delete=P4,V4.prototype.get=j4,V4.prototype.has=D4,V4.prototype.set=F4;var L4=V4,$4=q6,B4=e4,z4=L4;var U4=function(e,t){var r=this.__data__;if(r instanceof $4){var n=r.__data__;if(!B4||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new z4(n)}return r.set(e,t),this.size=r.size,this},H4=q6,W4=X6,G4=Z6,K4=J6,q4=Q6,Y4=U4;function X4(e){var t=this.__data__=new H4(e);this.size=t.size}X4.prototype.clear=W4,X4.prototype.delete=G4,X4.prototype.get=K4,X4.prototype.has=q4,X4.prototype.set=Y4;var Z4=X4;var J4=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var Q4=function(e){return this.__data__.has(e)},e8=L4,t8=J4,r8=Q4;function n8(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new e8;++t<r;)this.add(e[t])}n8.prototype.add=n8.prototype.push=t8,n8.prototype.has=r8;var i8=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var o8=function(e,t){return e.has(t)},a8=n8,s8=i8,l8=o8;var c8=function(e,t,r,n,i,o){var a=1&r,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=o.get(e),u=o.get(t);if(c&&u)return c==t&&u==e;var d=-1,f=!0,p=2&r?new a8:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var h=e[d],m=t[d];if(n)var v=a?n(m,h,d,t,e,o):n(h,m,d,e,t,o);if(void 0!==v){if(v)continue;f=!1;break}if(p){if(!s8(t,(function(e,t){if(!l8(p,t)&&(h===e||i(h,e,r,n,o)))return p.push(t)}))){f=!1;break}}else if(h!==m&&!i(h,m,r,n,o)){f=!1;break}}return o.delete(e),o.delete(t),f};var u8=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r};var d8=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r},f8=cU.Uint8Array,p8=T6,h8=c8,m8=u8,v8=d8,g8=uU?uU.prototype:void 0,y8=g8?g8.valueOf:void 0;var b8=function(e,t,r,n,i,o,a){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new f8(e),new f8(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return p8(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=m8;case"[object Set]":var l=1&n;if(s||(s=v8),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;n|=2,a.set(e,t);var u=h8(s(e),s(t),n,i,o,a);return a.delete(e),u;case"[object Symbol]":if(y8)return y8.call(e)==y8.call(t)}return!1};var w8=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e},_8=w8,C8=fU;var E8=function(e,t,r){var n=t(e);return C8(e)?n:_8(n,r(e))};var x8=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o};var S8=x8,k8=function(){return[]},O8=Object.prototype.propertyIsEnumerable,I8=Object.getOwnPropertySymbols,R8=I8?function(e){return null==e?[]:(e=Object(e),S8(I8(e),(function(t){return O8.call(e,t)})))}:k8,T8=E8,A8=R8,N8=w6;var M8=function(e){return T8(e,N8,A8)},P8=M8,j8=Object.prototype.hasOwnProperty;var D8=function(e,t,r,n,i,o){var a=1&r,s=P8(e),l=s.length;if(l!=P8(t).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in t:j8.call(t,u)))return!1}var d=o.get(e),f=o.get(t);if(d&&f)return d==t&&f==e;var p=!0;o.set(e,t),o.set(t,e);for(var h=a;++c<l;){var m=e[u=s[c]],v=t[u];if(n)var g=a?n(v,m,u,t,e,o):n(m,v,u,e,t,o);if(!(void 0===g?m===v||i(m,v,r,n,o):g)){p=!1;break}h||(h="constructor"==u)}if(p&&!h){var y=e.constructor,b=t.constructor;y!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(p=!1)}return o.delete(e),o.delete(t),p},F8=m5(cU,"DataView"),V8=e4,L8=m5(cU,"Promise"),$8=m5(cU,"Set"),B8=m5(cU,"WeakMap"),z8=xU,U8=e5,H8="[object Map]",W8="[object Promise]",G8="[object Set]",K8="[object WeakMap]",q8="[object DataView]",Y8=U8(F8),X8=U8(V8),Z8=U8(L8),J8=U8($8),Q8=U8(B8),e9=z8;(F8&&e9(new F8(new ArrayBuffer(1)))!=q8||V8&&e9(new V8)!=H8||L8&&e9(L8.resolve())!=W8||$8&&e9(new $8)!=G8||B8&&e9(new B8)!=K8)&&(e9=function(e){var t=z8(e),r="[object Object]"==t?e.constructor:void 0,n=r?U8(r):"";if(n)switch(n){case Y8:return q8;case X8:return H8;case Z8:return W8;case J8:return G8;case Q8:return K8}return t});var t9=Z4,r9=c8,n9=b8,i9=D8,o9=e9,a9=fU,s9=j5.exports,l9=Z5,c9="[object Arguments]",u9="[object Array]",d9="[object Object]",f9=Object.prototype.hasOwnProperty;var p9=function(e,t,r,n,i,o){var a=a9(e),s=a9(t),l=a?u9:o9(e),c=s?u9:o9(t),u=(l=l==c9?d9:l)==d9,d=(c=c==c9?d9:c)==d9,f=l==c;if(f&&s9(e)){if(!s9(t))return!1;a=!0,u=!1}if(f&&!u)return o||(o=new t9),a||l9(e)?r9(e,t,r,n,i,o):n9(e,t,l,r,n,i,o);if(!(1&r)){var p=u&&f9.call(e,"__wrapped__"),h=d&&f9.call(t,"__wrapped__");if(p||h){var m=p?e.value():e,v=h?t.value():t;return o||(o=new t9),i(m,v,r,n,o)}}return!!f&&(o||(o=new t9),i9(e,t,r,n,i,o))},h9=p9,m9=SU;var v9=function e(t,r,n,i,o){return t===r||(null==t||null==r||!m9(t)&&!m9(r)?t!=t&&r!=r:h9(t,r,n,i,e,o))},g9=Z4,y9=v9;var b9=function(e,t,r,n){var i=r.length,o=i,a=!n;if(null==e)return!o;for(e=Object(e);i--;){var s=r[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var l=(s=r[i])[0],c=e[l],u=s[1];if(a&&s[2]){if(void 0===c&&!(l in e))return!1}else{var d=new g9;if(n)var f=n(c,u,l,e,t,d);if(!(void 0===f?y9(u,c,3,n,d):f))return!1}}return!0},w9=G3;var _9=function(e){return e==e&&!w9(e)},C9=_9,E9=w6;var x9=function(e){for(var t=E9(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,C9(i)]}return t};var S9=function(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}},k9=b9,O9=x9,I9=S9;var R9=function(e){var t=O9(e);return 1==t.length&&t[0][2]?I9(t[0][0],t[0][1]):function(r){return r===e||k9(r,e,t)}},T9=fU,A9=IU,N9=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,M9=/^\w*$/;var P9=function(e,t){if(T9(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!A9(e))||(M9.test(e)||!N9.test(e)||null!=t&&e in Object(t))},j9=L4;function D9(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(D9.Cache||j9),r}D9.Cache=j9;var F9=D9;var V9=function(e){var t=F9(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t},L9=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,$9=/\\(\\)?/g,B9=V9((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(L9,(function(e,r,n,i){t.push(n?i.replace($9,"$1"):r||e)})),t})),z9=fU,U9=P9,H9=B9,W9=DU;var G9=function(e,t){return z9(e)?e:U9(e,t)?[e]:H9(W9(e))},K9=IU;var q9=function(e){if("string"==typeof e||K9(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t},Y9=G9,X9=q9;var Z9=function(e,t){for(var r=0,n=(t=Y9(t,e)).length;null!=e&&r<n;)e=e[X9(t[r++])];return r&&r==n?e:void 0},J9=Z9;var Q9=function(e,t,r){var n=null==e?void 0:J9(e,t);return void 0===n?r:n};var e7=function(e,t){return null!=e&&t in Object(e)},t7=G9,r7=P5,n7=fU,i7=V5,o7=L5,a7=q9;var s7=function(e,t,r){for(var n=-1,i=(t=t7(t,e)).length,o=!1;++n<i;){var a=a7(t[n]);if(!(o=null!=e&&r(e,a)))break;e=e[a]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&o7(i)&&i7(a,i)&&(n7(e)||r7(e))},l7=e7,c7=s7;var u7=function(e,t){return null!=e&&c7(e,t,l7)},d7=v9,f7=Q9,p7=u7,h7=P9,m7=_9,v7=S9,g7=q9;var y7=function(e,t){return h7(e)&&m7(t)?v7(g7(e),t):function(r){var n=f7(r,e);return void 0===n&&n===t?p7(r,e):d7(t,n,3)}};var b7=function(e){return function(t){return null==t?void 0:t[e]}},w7=Z9;var _7=function(e){return function(t){return w7(t,e)}},C7=b7,E7=_7,x7=P9,S7=q9;var k7=function(e){return x7(e)?C7(S7(e)):E7(e)},O7=R9,I7=y7,R7=B3,T7=fU,A7=k7;var N7=function(e){return"function"==typeof e?e:null==e?R7:"object"==typeof e?T7(e)?I7(e[0],e[1]):O7(e):A7(e)},M7=_5,P7=I6,j7=N7,D7=fU;var F7=function(e,t){return function(r,n){var i=D7(r)?M7:P7,o=t?t():{};return i(r,e,j7(n),o)}},V7=w5,L7=F7((function(e,t,r){V7(e,r,t)})),$7=L7,B7=P5,z7=fU,U7=uU?uU.isConcatSpreadable:void 0;var H7=function(e){return z7(e)||B7(e)||!!(U7&&e&&e[U7])},W7=w8,G7=H7;var K7=function e(t,r,n,i,o){var a=-1,s=t.length;for(n||(n=G7),o||(o=[]);++a<s;){var l=t[a];r>0&&n(l)?r>1?e(l,r-1,n,i,o):W7(o,l):i||(o[o.length]=l)}return o},q7=k6,Y7=v6;var X7=function(e,t){var r=-1,n=Y7(e)?Array(e.length):[];return q7(e,(function(e,i,o){n[++r]=t(e,i,o)})),n};var Z7=function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e},J7=IU;var Q7=function(e,t){if(e!==t){var r=void 0!==e,n=null===e,i=e==e,o=J7(e),a=void 0!==t,s=null===t,l=t==t,c=J7(t);if(!s&&!c&&!o&&e>t||o&&a&&l&&!s&&!c||n&&a&&l||!r&&l||!i)return 1;if(!n&&!o&&!c&&e<t||c&&r&&i&&!n&&!o||s&&r&&i||!a&&i||!l)return-1}return 0},eee=Q7;var tee=function(e,t,r){for(var n=-1,i=e.criteria,o=t.criteria,a=i.length,s=r.length;++n<a;){var l=eee(i[n],o[n]);if(l)return n>=s?l:l*("desc"==r[n]?-1:1)}return e.index-t.index},ree=dU,nee=Z9,iee=N7,oee=X7,aee=Z7,see=W5,lee=tee,cee=B3,uee=fU;var dee=function(e,t,r){t=t.length?ree(t,(function(e){return uee(e)?function(t){return nee(t,1===e.length?e[0]:e)}:e})):[cee];var n=-1;t=ree(t,see(iee));var i=oee(e,(function(e,r,i){return{criteria:ree(t,(function(t){return t(e)})),index:++n,value:e}}));return aee(i,(function(e,t){return lee(e,t,r)}))};var fee=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},pee=fee,hee=Math.max;var mee=function(e,t,r){return t=hee(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=hee(n.length-t,0),a=Array(o);++i<o;)a[i]=n[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=n[i];return s[t]=r(a),pee(e,this,s)}};var vee=function(e){return function(){return e}},gee=vee,yee=y5,bee=yee?function(e,t){return yee(e,"toString",{configurable:!0,enumerable:!1,value:gee(t),writable:!0})}:B3,wee=bee,_ee=Date.now;var Cee=function(e){var t=0,r=0;return function(){var n=_ee(),i=16-(n-r);if(r=n,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}},Eee=Cee(wee),xee=B3,See=mee,kee=Eee;var Oee=function(e,t){return kee(See(e,t,xee),e+"")},Iee=T6,Ree=v6,Tee=V5,Aee=G3;var Nee=function(e,t,r){if(!Aee(r))return!1;var n=typeof t;return!!("number"==n?Ree(r)&&Tee(t,r.length):"string"==n&&t in r)&&Iee(r[t],e)},Mee=K7,Pee=dee,jee=Nee,Dee=Oee((function(e,t){if(null==e)return[];var r=t.length;return r>1&&jee(e,t[0],t[1])?t=[]:r>2&&jee(t[0],t[1],t[2])&&(t=[t[0]]),Pee(e,Mee(t,1),[])})),Fee=Dee,Vee=/\s/;var Lee=function(e){for(var t=e.length;t--&&Vee.test(e.charAt(t)););return t},$ee=Lee,Bee=/^\s+/;var zee=function(e){return e&&e.slice(0,$ee(e)+1).replace(Bee,"")},Uee=zee,Hee=G3,Wee=IU,Gee=/^[-+]0x[0-9a-f]+$/i,Kee=/^0b[01]+$/i,qee=/^0o[0-7]+$/i,Yee=parseInt;var Xee=function(e){if("number"==typeof e)return e;if(Wee(e))return NaN;if(Hee(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Hee(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Uee(e);var r=Kee.test(e);return r||qee.test(e)?Yee(e.slice(2),r?2:8):Gee.test(e)?NaN:+e},Zee=Xee,Jee=1/0;var Qee=function(e){return e?(e=Zee(e))===Jee||e===-Jee?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0},ete=Qee;var tte=function(e){var t=ete(e),r=t%1;return t==t?r?t-r:t:0},rte=tte;var nte=function(e){return"number"==typeof e&&e==rte(e)};function ite(e){for(var t=10;t>0&&e;){if(e.tagName&&"td"===e.tagName.toLowerCase()){if(""!==e.innerHTML)return!1;t-=1}e=e.nextSibling}return!0}var ote=/^\s*\(?¥\s*\(?[\d,.]+\)?$/,ate=/^#+$/,ste=/^\d\.\d+[Ee]\+\d+$/,lte=String.fromCharCode(165),cte=String.fromCharCode(36),ute=String.fromCharCode(8364),dte=String.fromCharCode(163);function fte(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;e=function(e){return e.replace(/\\0022/g,"")}(e=function(e,t,r){var n=e.match(/<col[^>]*>/g),i=0;if(n){var o=n[n.length-1].match(/<col[^>]*span=(\d+)[^>]*>/);o&&(i=parseInt(o[1],10))}if(i>r){var a=e.split("</tr>");e=(a=a.map((function(e){var t=e.match(/(\s*<td[^>]*>\s*<\/td>)(\s*)$/);if(t){var r=t[1].repeat(i-30);e.endsWith(r+t[2])&&(e=e.substr(0,e.length-r.length-t[2].length))}return e}))).join("</tr>")}var s=e.match(/\s*<tr[^>]*>\s*(<td[^>]*>\s*<\/td>\s*)+<\/tr>/g);if(s&&s.length>t){var l=e.match(/<td[^>]*>[^<]*[^\s<]+[^<]*<\/td>/g);if(!l)return"<table><tr><td></td></tr></table>";var c=l[l.length-1],u=e.lastIndexOf(c),d=e.slice(0,u+c.length);e=e.slice(u+c.length);var f={};s.forEach((function(e){f[e]=f[e]||{content:e,count:0},f[e].count+=1}));for(var p=Object.values(f),h=(p=Fee(p,"count")).length-1;p[h];){var m=p[h];if(m.count>t){var v=m.content.replace(/([*.?+$^[\](){}|/\\])/g,(function(e){return"\\".concat(e)}));e=e.replace(new RegExp(v,"g"),"")}h--}e=d+e}return e}(e,200,200));var o=(new DOMParser).parseFromString(e,"text/html"),a=o.body,s=function(e,t){for(var r=e.length,n=[],i=0;i<r;i++)t(e[i])&&n.push(e[i]);return n}(o.all,(function(e){return"STYLE"===e.tagName}));if(!a)return null;for(var l,c=a.firstChild,u=[],d=[],f={},p={},h=[],m={},v=!1;c;)if(vte(c)){var g=Ite(c,u.length,s,i);g.mergeCells&&(d=d.concat(g.mergeCells)),g.startCell&&(l=g.startCell),g.selectOptions&&Object.assign(m,g.selectOptions),Object.assign(p,g.rows),g.columns&&Object.assign(f,g.columns),u=u.concat(g.table),g.cellsNeedFix&&(h=h.concat(g.cellsNeedFix)),c=Ote(c),v=!1}else if(Cte(c))wte(c)&&(c.innerHTML=""),gte(c)&&(c.innerHTML=c.innerHTML.replace(/\n/g,"<br/>")),c=c.firstChild||Ote(c),v=!1;else if(bte(c)){var y=c.innerText.trim(),b=c.getAttribute("href");hte(u,u.length,y,b),v=!1,c=Ote(c)}else if(yte(c)){var w=c.getAttribute("src");mte(u,u.length,w,i),v=!1,c=Ote(c)}else if(xte(c))c=c.firstChild||Ote(c);else if(Ste(c))v=!1,c=Ote(c);else if(kte(c)){var _=c.data;if(""!==_.trim()||!Cte(c.parentNode))pte(u,v?u.length-1:u.length,_),v=!0;c=Ote(c)}else c=Ote(c);var C=function(e){var t={};return e.forEach((function(e,r){e.forEach((function(e,n){e&&0!==Object.keys(e).length&&(t[r]=t[r]||{},0!==Object.keys(e).length&&(t[r][n]=e))}))})),t}(u);d=$7(d,(function(e){return"".concat(e.row,":").concat(e.col)}));var E=W3(u.map((function(e){return e.length})))||20,x={name:r||"Sheet".concat(t+1),rowCount:n?Math.max(u.length,n.rowCount):u.length,colCount:n?Math.max(E,n.colCount):E,data:C,mergeCells:d,rows:p,columns:f,filter:{},index:t,defaults:{}};return l&&(x.startCell=l),Object.keys(m).length>0&&(x.selectOptions=m),h.length>0&&(x.cellsNeedFix=h),x}function pte(e,t,r){e[t]=e[t]||[],e[t][0]?e[t][0].value+=""+r:e[t][0]={value:r}}function hte(e,t,r,n){e[t]=e[t]||[],e[t][0]=e[t][0]||{},e[t][0].value={class:"link",text:r,url:n}}function mte(e,t,r,n){r=function(e){return e.replace(/\?x-oss-process=image\/resize.+/,"")}(r),e[t]=e[t]||[],e[t][0]=e[t][0]||{},e[t][0].value=n?{class:"image",name:"",src:r}:{class:"image",name:"",status:"needUpload",originSrc:r}}function vte(e){return"TABLE"===e.tagName}function gte(e){return"PRE"===e.tagName}function yte(e){return"IMG"===e.tagName}function bte(e){return"A"===e.tagName}function wte(e){var t=e.getAttribute("style");return t&&t.startsWith("mso-element")}var _te=["BODY","ARTICLE","ASIDE","ADDRESS","DD","DL","FIELDSET","FIGCAPTION","FIGURE","FOOTER","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","P","DIV","PRE","BLOCKQUOTE","UL","OL","LI","TABLE","THEAD","TBODY","TFOOT","SECTION"];function Cte(e){return 1===e.nodeType&&_te.includes(e.tagName)}var Ete=["B","I","ABBR","CITE","CODE","DFN","DEL","EM","KBD","STRONG","SAMP","A","BDO","Q","SPAN","SUB","SUP","BUTTON","LABEL"];function xte(e){return 1===e.nodeType&&Ete.includes(e.tagName)}function Ste(e){return"BR"===e.tagName}function kte(e){return 3===e.nodeType}function Ote(e){if(e.nextSibling)return e.nextSibling;for(var t=e.parentNode;t;){if(t.nextSibling)return t.nextSibling;t=t.parentNode}return null}function Ite(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=e.cloneNode(!0);document.body.appendChild(i);var o=function(e,t){return function(e){for(var t,r=e.rows,n=r.length,i=[],o=[],a=0,s=0,l=0,c=0;c<n;c++){for(var u=r[c].cells,d=0,f=0;f<u.length;f++){var p=u[f],h=p.rowSpan,m=p.colSpan;a+=h*m,d+=m,h>1&&(s+=(h-1)*m)}o[c]=d,0===c&&(t=d),l=Math.max(d,l)}if(nte(a/t)&&t===l){var v=0;if(o.forEach((function(e){v+=l-e})),v!==s){var g=s-v;if(g&&nte(g/l)){for(var y=[],b=0;b<n;b++){for(var w=r[b].cells;i[b+y.length]===l;)y.push(b+y.length);for(var _=b+y.length,C=0;C<w.length;C++){var E=w[C],x=E.rowSpan,S=E.colSpan;if(x>1)for(var k=1;k<x;k++)i[_+k]=(i[_+k]||0)+S}}y.forEach((function(t){e.insertRow(t)}))}}}}(e),function(e){var t=e.rows[0];0===t.cells.length&&t.remove(),e.rows.length>1&&1===t.cells.length&&""===t.cells[0].innerText.trim()&&0===t.cells[0].getElementsByTagName("img").length&&1===t.cells[0].colSpan&&1===t.cells[0].rowSpan&&t.remove()}(e),function(e){Array.from(e.rows).forEach((function(e){var t=e.getAttribute("style"),r=t&&t.match(/mso-xlrowspan:(\d+)/),n=e.getAttribute("height");if(r&&n){var i=parseInt(r[1]);n=parseInt(n)/i||24,e.setAttribute("height",n),e.style.height=n+"px"}if(Array.from(e.cells).forEach((function(t){var r=t.getAttribute("style");if(t.setAttribute("height",n),t.style.height=n+"px",t.colSpan>1&&r&&-1!==r.indexOf("mso-ignore:colspan")){var i=t.colSpan;t.setAttribute("colSpan",1);for(var o=1;o<i;o++){var a=t.cloneNode();e.insertBefore(a,t.nextSibling)}}})),r){var o=parseInt(r[1]);if(o<1e6)for(var a=1;a<o;a++){var s=e.cloneNode();e.parentNode.insertBefore(s,e)}}}))}(e),function(e,t){for(var r=[],n=e.rows,i=n.length,o=100,a=0;a<i;a++){var s=n[a].cells,l=s.length;r[a]=r[a]||[];for(var c=l>16300,u=0;u<l;u++){var d=s[u];if(c&&u>o&&""===d.innerHTML&&ite(d))break;o=Math.max(o,u);for(var f=d.rowSpan,p=void 0===f?1:f,h=d.colSpan,m=void 0===h?1:h,v=p>1||m>1,g=u;r[a][g];)g++;if(r[a][g]={rowSpan:p,colSpan:m,isMulti:v,element:d},v)for(var y=p;y>0;){for(var b=m;b>0;){if(1!==b||1!==y){var w=a+y-1,_=g+b-1;r[w]=r[w]||[],r[w][_]={isEmpty:!0,parent:{row:a,col:g}}}b--}y--}}}var C=r.map((function(e){return e.length})),E=Math.max.apply(Math,bL(C));return r.forEach((function(e,r){if(e.length<E)for(var n=E-e.length;n--;)0!==r||t?e.push({rowSpan:1,colSpan:1,isShadow:!0,element:null}):e.unshift({rowSpan:1,colSpan:1,isShadow:!0,element:null});for(var i=0;i<E;i++)e[i]||(e[i]={rowSpan:1,colSpan:1,isShadow:!0,element:null})})),{rows:r.length,cols:E,table:r}}(e,t)}(i,n),a={};r&&r.forEach((function(e){document.body.appendChild(e),Object.assign(a,function(e){var t=/([^{}]+){([^{}]+)}/,r=e.match(/[^{}]+{([^{}]+)}/g),n={};return r&&r.forEach((function(e){var r=e.match(t);if(r){var i=r[1].trim(),o=r[2];if(i.startsWith(".")){var a=o.match(/mso-number-format:(.+);(\n|$)/);a&&(n[i.substr(1)]=function(e){return-1!==(e=e.replace(/\/|"|\\/g,"")).indexOf("Date")?"date":-1!==e.indexOf("Time")?"time":e.endsWith("%")?"percentage":-1!==e.indexOf(dte)?{name:"currency",symbol:dte}:-1!==e.indexOf(ute)?{name:"currency",symbol:ute}:-1!==e.indexOf(lte)?{name:"currency",symbol:lte}:e.match(/^@$/)?"text":-1!==e.indexOf("General")||-1!==e.indexOf("Standard")||-1!==e.indexOf("Fixed")?"auto":e.match(/(年|月|日|时|分|秒|dd|y|m|h|s|md|dm)/)?e.match(/(时|分|秒|s|h)/)?"datetime":e.match(/[^d]ddd[^d]/)?{name:"datetime",formatter:"dddd"}:"date":-1!==e.indexOf(cte)?{name:"currency",symbol:cte}:"number"}(a[1]))}}})),0===Object.keys(n).length?null:n}(e.innerHTML))}));var s={table:[]},l=i.querySelectorAll("col");if(l.length>0){var c={},u=0;l.forEach((function(e){for(var t=parseInt(e.getAttribute("width")),r=e.span,n=0;n<r&&u<o.cols;)c[u]=0!==t?{size:t}:{size:0,hidden:!0,oldSize:120},u+=1,n+=1})),s.columns=c}var d=Array.from(i.rows);s.rows={},d.forEach((function(e,r){if(0===e.offsetHeight&&r!==d.length-1)s.rows[r+t]={size:0,hidden:!0,oldSize:24};else{var n=Math.max(e.offsetHeight,24)||24,i={size:n};24!==n&&(i.customSize=n),s.rows[r+t]=i}}));var f=i.getAttribute("data-startCell");if(f){var p=f.split(":");s.startCell={row:parseInt(p[0])||0,col:parseInt(p[1])||0}}var h=i.getAttribute("data-selectOptions");if(h)try{s.selectOptions=JSON.parse(decodeURIComponent(h))}catch(e){console.log(e)}return o.table.forEach((function(e,r){s.table[r]=[],e.forEach((function(e,i){if(e.element){var o=function(e,t){var r=e.getAttribute("data-value");if(r)try{var n=JSON.parse(decodeURIComponent(r));if(function(e){return!!e.class&&("link"===e.class?e.text&&e.url:"file"===e.class||"image"===e.class?e.name&&e.src:"checkbox"===e.class?void 0!==e.value:"select"===e.class?e.value&&(e.options||e.optionId):"mention"===e.class?e.value&&e.value[0].id&&e.value[0].login:"formula"===e.class&&void 0!==e.formula)}(n))return n}catch(e){console.log(e)}for(var i=e.querySelectorAll("img"),o=i.length,a=0;a<o;a++){var s=i[a].getAttribute("src");if(s)return t?{class:"image",src:s,name:"image"}:{class:"image",status:"needUpload",originSrc:s,name:"image"}}e.innerHTML=e.innerHTML.replace(/<!--\[if[\s\S]+<!--\[endif\]-->/g,"").replace(/<rt[^>]*>[^<]*<\/rt>/g,"").replace(/\n/g,"").replace(/<br>\s*/g,"\n");var l,c=e.innerHTML.replace(/<[^>]+>/g,"").trim();c="string"!=typeof(l=c)?l:l.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&nbsp;/g," ");var u=e.querySelector("a");return u&&u.getAttribute("href")?{class:"link",text:c.replace(/\n/g,""),url:u.getAttribute("href")}:(c.endsWith(" %")&&(c=c.replace(/ %$/,"%")),c)}(e.element,n),l=function(e){try{var t=window.getComputedStyle(e),r={};1===e.childNodes.length&&"S"===e.childNodes[0].tagName&&(r.strikeThrough=!0);var n=function(e){var t;-1!==e.indexOf("pt")&&(t=parseInt(e,10));var r=12;if(-1!==e.indexOf("em")?r=parseFloat(e,14):-1!==e.indexOf("px")&&(r=parseFloat(e,10)),t=t||Math.round(r/1.3333333),Tte[t])return t;var n=Object.keys(Tte).map((function(e){return parseInt(e,10)}));n.sort();for(var i=0;n[i];){if(n[i]>t)return n[i];i++}return n[i-1]}(t.fontSize);return-1!==t.textDecoration.indexOf("underline")&&(r.underline=!0),-1!==t.textDecoration.indexOf("line-through")&&(r.strikeThrough=!0),(n>12||e.style.fontSize&&e.style.fontSize.indexOf("px")>0)&&(r.fontSize=n),["rgba(0, 0, 0)","rgb(0, 0, 0)","rgba(0, 0, 0, 0.65)","rgb(88, 90, 90)"].includes(t.color)||(r.color=t.color),"italic"===t.fontStyle&&(r.fontStyle=t.fontStyle),"normal"===t.whiteSpace&&e.classList.length>0&&(r.overflow="wrap"),["400",400,"normal"].includes(t.fontWeight)||(r.fontWeight=t.fontWeight),"middle"!==t.verticalAlign&&(r.vAlign=Rte[t.verticalAlign]||"middle"),"start"!==t.textAlign&&"left"!==t.textAlign&&(r.hAlign=Rte[t.textAlign]||"left"),"rgba(0, 0, 0, 0)"!==t.backgroundColor&&"rgb(255, 255, 255)"!==t.backgroundColor&&(r.backColor=t.backgroundColor),"0px"!==t.borderLeftWidth&&"rgb(204, 204, 204)"!==t.borderLeftColor&&(r.border=r.border||{},r.border.left={color:t.borderLeftColor,lineStyle:"dashed"===t.borderLeftStyle?"dash":"normal"}),"0px"!==t.borderRightWidth&&"rgb(204, 204, 204)"!==t.borderRightColor&&(r.border=r.border||{},r.border.right={color:t.borderRightColor,lineStyle:"dashed"===t.borderRightStyle?"dash":"normal"}),"0px"!==t.borderTopWidth&&"rgb(204, 204, 204)"!==t.borderTopColor&&(r.border=r.border||{},r.border.top={color:t.borderTopColor,lineStyle:"dashed"===t.borderTopStyle?"dash":"normal"}),"0px"!==t.borderBottomWidth&&"rgb(204, 204, 204)"!==t.borderBottomColor&&(r.border=r.border||{},r.border.bottom={color:t.borderBottomColor,lineStyle:"dashed"===t.borderBottomStyle?"dash":"normal"}),0===Object.keys(r).length?null:r}catch{return null}}(e.element),c=function(e){var t=e.getAttribute("data-note");if(t)try{var r=JSON.parse(decodeURIComponent(t));if(r.text)return r}catch(e){console.log(e)}}(e.element),u={name:"auto"},d=!1;if(a){var f=e.element.classList&&e.element.classList[0];a[f]&&("object"===oL(a[f])?Object.assign(u,a[f]):u.name=a[f],["currency","number","percentage"].includes(u.name)&&(u.decimal=2),s.table[r][i]=s.table[r][i]||{},s.table[r][i].type=u,["text","auto"].includes(u.name)||(d=!0))}l&&(s.table[r][i]=s.table[r][i]||{},s.table[r][i].style=l),c&&(s.table[r][i]=s.table[r][i]||{},s.table[r][i].note=c),void 0!==o&&""!==o?(s.table[r][i]=s.table[r][i]||{},s.table[r][i].type=u,s.table[r][i].value=o,"string"==typeof o&&((ate.test(o)||ste.test(o))&&(d=!0),ote.test(o)&&"auto"===u.name&&(d=!0,s.table[r][i].type.name="currency",s.table[r][i].type.symbol=lte,s.table[r][i].type.decimal=2))):""===o&&s.columns&&s.columns[i]&&s.columns[i].size<=15&&s.columns[i].size>=0&&(d=!0),d&&n&&(s.cellsNeedFix=s.cellsNeedFix||[],s.cellsNeedFix.push({row:r+t,col:i})),e.isMulti&&(s.mergeCells=s.mergeCells||[],s.mergeCells.push({row:r+t,col:i,rowCount:e.rowSpan,colCount:e.colSpan}),l&&(s.table[r+e.rowSpan-1]=s.table[r+e.rowSpan-1]||[],s.table[r+e.rowSpan-1][i+e.colSpan-1]=s.table[r+e.rowSpan-1][i+e.colSpan-1]||{},s.table[r+e.rowSpan-1][i+e.colSpan-1].style=l))}}))})),i.remove(),r&&r.forEach((function(e){e.remove()})),s}var Rte={"-webkit-left":"left","-webkit-right":"right","-webkit-center":"center",left:"left",right:"right",center:"center","-webkit-baseline-middle":"middle",top:"top",bottom:"bottom",middle:"middle"};var Tte={9:12,10:13,11:14,12:16,14:19,16:22,18:24,22:29,24:32,30:40,36:48};class Ate{}Ate.html=new class{serialize(e){return e?this._standardTableValueToTableHTML(e):""}deserialize(e){return this._tableHTMLToStandardTableValue(e)}_getTrHTML(e){var t;const{cells:r,fields:n,rowHeight:i}=e,o=[];o.length=r.length;const a=r.length;return Dx(0,(null==(t=r[0])?void 0:t.length)||0,(e=>{const t=null==n?void 0:n[e];Dx(0,a,(n=>{var a,s;o[n]=o[n]||`<tr style="height: ${i}px">`;const l=r[n][e];let c="",u="";if(l&&(l.value||[Rh.CHECKBOX,Rh.SELECT,Rh.MULTI_SELECT].includes(null==t?void 0:t.type))){switch(null==t?void 0:t.type){case Rh.SELECT:case Rh.MULTI_SELECT:{const e=l.formatValue.split(",");c=` data-value="${encodeURIComponent(JSON.stringify({class:"select",value:e,options:null==(a=t.options)?void 0:a.map((e=>({id:e.uuid,value:e.name,color:e.color}))),color:!(null==(s=t.options)||!s[0].color),multi:t.type===Rh.MULTI_SELECT}))}"`,u=l.formatValue;break}case Rh.MENTION:c=` data-value="${encodeURIComponent(JSON.stringify({class:t.type,value:l.formatValue}))}"`,u=l.formatValue;break;case Rh.IMAGE:{const e=l.value;u=(null==e?void 0:e.map((e=>`<img src="${e.src}" height=${t.size} />`)).join(""))||"";break}case Rh.LINK:{const e=l.value;u=e?`<a href="${e.src}">${e.name}</a>`:"";break}case Rh.FILE:{const e=l.value;u=e?e.map((e=>`<a href="${e.src}">${e.name}</a>`)).join(""):"";break}case Rh.CHECKBOX:{const e=l.value;u=!0===e?"✅":"🔲",c=` data-value="${encodeURIComponent(JSON.stringify({class:t.type,value:!0===e}))}"`;break}default:u=function(e){return"string"!=typeof e?e:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\t/g,"&nbsp;&nbsp;").replace(/\n/g,"<br>")}(l.formatValue)}o[n]+=`<td ${c}>${u}</td>`}else o[n]+="<td></td>"}))})),Dx(0,a,(e=>{o[e]+="</tr>"})),o}_standardTableValueToTableHTML(e){const{startCell:t,fields:r}=e,n=this._getTrHTML(e),i=[];r&&r.forEach((e=>{i.push(`<col width=${e.size}>`)}));const o=`<colgroup>${i.join("")}</colgroup>`;return`\x3c!--StartFragment--\x3e<style type="text/css">\x3c!--\n    td {border: 0.5pt solid #ccc;white-space: nowrap;}\n    br {mso-data-placement:same-cell;}\n    .numberstr{mso-number-format:"@";}\n    .perc {mso-number-format:0%;}\n    .curr¥ {mso-number-format:"¥#,##0.00;[red]¥#,##0.00";}\n    .curr$ {mso-number-format:"$#,##0.00;[red]$#,##0.00";}\n    .curr£ {mso-number-format:"£#,##0.00;[red]£#,##0.00";}\n    .curr€ {mso-number-format:"€#,##0.00;[red]€#,##0.00";}\n    --\x3e</style><table style="font-size: 12px;" data-startCell="${t.row}:${t.column}">${o}${n.join("")}</table>\x3c!--EndFragment--\x3e`}_tableHTMLToStandardTableValue(e){const t=fte(e),{rowCount:r,colCount:n,data:i}=t,o=[];let a=0;for(;a<r;){if(o[a]=[],o[a].length=n,i[a]){let e=0;for(;e<n;){if(i[a][e]){const t=i[a][e],r=this._htmlValueToTableCell(t);o[a][e]=r}e++}}a++}return{cells:o}}_htmlValueToTableCell(e){const t={fieldType:Rh.TEXT,value:""},r=e.value||"";if(Mo(r)||function(e){return To(e,"Number")}(r)||Wx(r))return t.value=r,t;const n=r.class;if("link"===n){const e=r,n={name:e.text,src:e.url};t.fieldType=Rh.LINK,t.value=n}else if("file"===n){const e=r,n=[{name:e.text,src:e.url}];t.fieldType=Rh.IMAGE,t.value=n}else if("image"===n){const e=r,n=[{name:e.name,src:e.originSrc}];t.fieldType=Rh.IMAGE,t.value=n}else if("select"===n){const e=r;if(e.multi){const r=e.value;t.fieldType=Rh.MULTI_SELECT,t.value=r}else{const r=e.value[0];t.fieldType=Rh.SELECT,t.value=r}}return t}},Ate.text=new class{serialize(e){if(!e)return"";const{cells:t}=e,r=[],n=t.length,i=t[0].length;return Dx(0,n,(e=>{const n=[];Dx(0,i,(r=>{const i=t[e][r];let o="";o=i?i.formatValue:"",n.push(o)})),r.push(n.join("\t"))})),r.join("\n")}deserialize(e){const t=[],r={cells:t};return e&&e.split("\n").forEach(((e,r)=>{const n=e.split("\t");t[r]=[],n.forEach(((e,n)=>{const i={fieldType:Rh.TEXT,value:e};t[r][n]=i}))})),r}};var Nte=Object.defineProperty,Mte=Object.getOwnPropertyDescriptor,Pte=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Mte(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Nte(t,r,o),o};let jte=class{constructor(){this.runningStatus=F3.NULL,this.clipId=null,this.clipboardData=null}get _selection(){var e;const t=null==(e=this._selectionService)?void 0:e.getSelection();return Q2(t)?t:null}copy(e){v.a.destroy(),this._enable()&&(!this._selection||0===this._selection.rangeCount||(this.runningStatus=F3.COPY,this.clipId=Io(6),this._setDataToClipboard(e),this._showCopyCutSuccessMessage(),this.runningStatus=F3.NULL))}cut(e){!this._enable()||(this.runningStatus=F3.CUT,this.clipId=Io(6),this.runningStatus=F3.NULL)}_enable(){var e;return!(this.runningStatus!==F3.NULL||!this._selection)&&(!!window.formulaCopy||!(this._abilityService.isReadonly(Nw.TABLE)&&(null==(e=window.appData)?void 0:e.disableDocumentCopy)))}_setDataToClipboard(e){null==e||e.preventDefault();const t=this._getDataBySelections(),r=e&&(e.dataTransfer||e.clipboardData),n=Ate.html.serialize(t),i=Ate.text.serialize(t),o=this._configuration.getValue("clipboard.clipboardApi.disable");return D3.writeToClipboardData({innerCopy:this.clipId||"",html:n,text:i},r,{disableClipboardApi:o}),this.clipboardData=t,t}_getDataBySelections(){const e=this._selection,t=null==e?void 0:e.getRangeAt(0),r=null==t?void 0:t.start,n=null==t?void 0:t.end;if(!e||!r||!n)return null;const i=n.row-r.row+1,o=n.column-r.column+1,a=new Array(i).fill(0).map((e=>new Array(o).fill(0))),s=[],l=this._readService.getActiveView(),c=this._readService.getViewFields(null==l?void 0:l.uuid)||[],u=this._readService.getFlatViewRecords(null==l?void 0:l.uuid)||[],d=this._readService.getViewConfig(null==l?void 0:l.uuid);for(let e=0;e<o;e++){const t=null==c?void 0:c[e+r.column],n=t.field,o=(null==n?void 0:n.uuid)||"";n&&s.push({...n,size:t.size||180});for(let t=0;t<i;t++){const n=u[t+r.row].record_uuid,i=this._readService.getCell(o,n);i&&(a[t][e]=i)}}return{fields:s,cells:a,startCell:r,rowHeight:this._rowControllerService.getRowHeight(null==d?void 0:d.record_height)}}_showCopyCutSuccessMessage(){const e=this._selection,t=null==e?void 0:e.getRangeAt(0),r=null==t?void 0:t.start,n=null==t?void 0:t.end;if(!e||!r||!n)return null;const i=n.row-r.row+1,o=n.column-r.column+1;v.a.success(kf("成功复制 $1 个单元格",i*o))}};Pte([to(Dy)],jte.prototype,"_readService",2),Pte([to(e3),Mx()],jte.prototype,"_selectionService",2),Pte([to(S3)],jte.prototype,"_rowControllerService",2),Pte([to(qf)],jte.prototype,"_configuration",2),Pte([to(Hw)],jte.prototype,"_abilityService",2),jte=Pte([eo()],jte);var Dte=Object.defineProperty,Fte=Object.getOwnPropertyDescriptor,Vte=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Fte(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Dte(t,r,o),o};let Lte=class{constructor(){this._pasteData=null}get _selection(){var e;const t=null==(e=this._selectionService)?void 0:e.getSelection();if(Q2(t)){const{anchor:e,focus:r}=t,n=r.row-e.row+1,i=r.column-e.column+1;return{startRowIndex:e.row,startColIndex:e.column,rowCount:n,colCount:i}}return null}async paste(e){!this._selection||(v.a.destroy(),this._asyncPasteIfNeedUpload(e),this._pasteData=await this._getStdCellValueFromClip(e),this._process(this._selection,this._pasteData))}async _getStdCellValueFromClip(e){let t=null;const r=this._configuration.getValue("clipboard.clipboardApi.disable"),n=[{key:P3.innerCopy,serializer:{deserialize:e=>{if(e===this._copyCutService.clipId)return this._copyCutService.clipboardData}}},{key:P3.html,serializer:Ate.html},{key:P3.text,serializer:Ate.text}];for(const i of n){const{key:n,serializer:o}=i,a=await D3.getClipboardData(n,e,{disableClipboardApi:r});if(a&&(t=o.deserialize(a)),t)break}return t}async _process(e,t){if(!this._enable(e,t))return;const{cells:r}=t,n=r.length*r[0].length,i=v.a.loading(kf("正在处理粘贴内容..."),0);return new Promise((r=>{setTimeout((async()=>{var n,o,a,s,l,c,u,d,f,p;const h=await this._commandService.execCommand("pasteUpdateRecords",{selection:e,pasteData:t}),m=(null==(o=null==(n=null==h?void 0:h.result)?void 0:n.data)?void 0:o.createRecordIds)||[];if(m.length>0){const e=null==(a=this._selectionService)?void 0:a.getSelection();if(e){const t=this._selectionService.createGridSelectionByIndex(e.anchor.row,e.anchor.column,e.rowCount+m.length,e.columnCount);this._selectionService.setSelection(t)}}i(),0===(null==(s=null==h?void 0:h.result)?void 0:s.code)?v.a.success(null==(l=null==h?void 0:h.result)?void 0:l.message):(null==(c=null==h?void 0:h.result)?void 0:c.code)&&(null==(u=null==h?void 0:h.result)?void 0:u.code)>0?v.a.error(null==(d=null==h?void 0:h.result)?void 0:d.message):-1===(null==(f=null==h?void 0:h.result)?void 0:f.code)&&(console.error(`Internal Error After execCommand: "pasteUpdateRecords", ${null==(p=null==h?void 0:h.result)?void 0:p.message}`),v.a.error(kf("粘贴失败, 请稍后重试"))),r(null==h?void 0:h.result)}),n>100?100:0)}))}_enable(e,t){var r,n;if(!t||!e)return!1;const{rowCount:i,startRowIndex:o,startColIndex:a}=e;if(o+i>this._readService.maxRecordCount)return v.a.error(kf("数据表已达最大行数限制")),!1;const s=(null==(r=this._readService.getAllViewFields())?void 0:r.length)||0;return!(a+((null==(n=t.fields)?void 0:n.length)||0)>s)||(v.a.error(kf("复制失败，没有足够的列")),!1)}async _asyncPasteIfNeedUpload(e){if(!this._selection||!e)return;const t=D3.getFilesFromClipBoard(e),r=null==t?void 0:t[0];if(!r)return;const n=this._readService.getCellByIndexes(this._selection.startRowIndex,this._selection.startColIndex);if(!n||![Rh.IMAGE,Rh.FILE].includes(n.fieldType))return void console.warn("target field type is not support for file");this._uploadService.getAccept(null==n?void 0:n.fieldType);const i=(null==n?void 0:n.fieldType)===Rh.IMAGE?this._uploadService.uploadImage(r):this._uploadService.uploadFile(r),o={...this._selection,rowCount:1,colCount:1},a=i.onDidChange((async e=>{var t;if(e.status!==dZ.ERROR)if(e.status!==dZ.TIMEOUT){if(e.status===dZ.SUCCESS){const r=e.file,i={cells:[[{...n,value:null==(t=n.value||[])?void 0:t.concat([r])}]]};await this._process(o,i),a.destroy()}}else v.a.error(e.message||kf("上传超时，请重试"));else v.a.error(e.message||kf("上传失败，请重试"))}))}};Vte([to(Dy)],Lte.prototype,"_readService",2),Vte([to(jte)],Lte.prototype,"_copyCutService",2),Vte([to(e3),Mx()],Lte.prototype,"_selectionService",2),Vte([to(Pb)],Lte.prototype,"_commandService",2),Vte([to(qf)],Lte.prototype,"_configuration",2),Vte([to(TZ)],Lte.prototype,"_uploadService",2),Lte=Vte([eo()],Lte);var $te=Object.defineProperty,Bte=Object.getOwnPropertyDescriptor,zte=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Bte(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&$te(t,r,o),o};let Ute=class{constructor(){this._onCopy=null,this._onCut=null,this._onPaste=null}static pluginModule(){return bo().register(this).register(jte).register(Lte)}_hasSelection(){var e;return null==(e=this._selectionService)?void 0:e.hasSelection()}get _isGridView(){return this._readService.getActiveViewType()===Wh.GRID}get _isPasteInUpload(){var e;const t=null==(e=document.activeElement)?void 0:e.classList;return null==t?void 0:t.contains("ant-upload")}init(){}static registerConfiguration(e){e.registerConfiguration({id:"clipboard",type:"object",title:"粘贴板",properties:{"clipboardApi.disable":{type:"boolean",description:"不使用 clipboard api"}}}),e.registerDefaultValue({"clipboard.clipboardApi.disable":!1})}registerHotkey(e){e.registerItem({id:"copy",hotkey:"copy",name:"copy",enableOnInput:!1,preventDefault:!0,isEnable:()=>this._hasSelection()&&this._isGridView,onHotKey:e=>{this._copyCutService.copy(e)}}),e.registerItem({id:"cut",hotkey:"cut",name:"cut",preventDefault:!0,enableOnInput:!1,isEnable:()=>!this._abilityService.isReadonly(Nw.TABLE)&&this._hasSelection()&&this._isGridView,onHotKey:e=>{this._copyCutService.cut(e)}}),e.registerItem({id:"paste",hotkey:"paste",name:"paste",preventDefault:!0,enableOnInput:!1,isEnable:()=>!this._abilityService.isReadonly(Nw.TABLE)&&this._hasSelection()&&this._isGridView&&!this._isPasteInUpload,onHotKey:e=>{this._pasteService.paste(e)}})}destroy(){var e,t,r;null==(e=this._onCopy)||e.destroy(),null==(t=this._onCut)||t.destroy(),null==(r=this._onPaste)||r.destroy()}};Ute.pluginName="render-clipboard",zte([to(Dy)],Ute.prototype,"_readService",2),zte([to(Hw)],Ute.prototype,"_abilityService",2),zte([to(jte)],Ute.prototype,"_copyCutService",2),zte([to(Lte)],Ute.prototype,"_pasteService",2),zte([to(e3),Mx()],Ute.prototype,"_selectionService",2),Ute=zte([eo({contrib:[Nj,dj]})],Ute);const Hte=Fi.defineToken("RefreshRenderPluginContribution");function Wte(e){const t=zA($2),[r,n]=Object(a.useState)((()=>t.isInHighlight(e)));return Object(a.useEffect)((()=>{const r=t.onChange((({highlightCellIds:r,highlightRecordIds:i})=>{const o=t.isInHighlight(e);n(o)}));return()=>{r.destroy()}}),[t]),r}var Gte=Object.defineProperty,Kte=Object.getOwnPropertyDescriptor,qte=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Kte(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Gte(t,r,o),o};let Yte=class extends Zf{constructor(){super(...arguments),this._task=null,this._originCellValue=null,this._handleRefresh=()=>{},this._selectionListener=null,this._commandListener=null,this._onRefreshTooltipChange=this._register(new op),this.onRefreshTooltipChange=this._onRefreshTooltipChange.event,this.DESC_MAP={[$y.GROUP]:{text:kf("本记录将被移至新的分组"),ps:kf("本记录不属于该分组，点击其他区域将移走该记录")},[$y.FILTER]:{text:kf("本记录将被过滤"),ps:kf("本记录已被筛选过滤，点击其他区域将隐藏该记录")},[$y.SORT]:{text:kf("本记录将被移动到新的排序位置"),ps:kf("本记录因排序规则会移动，点击其他区域将移走该记录")}}}destroy(){super.destroy()}init(){this._bindEvent()}_bindEvent(){this._refreshEventService.onBeforeRefresh((async({type:e,commandName:t,params:r,action:n})=>{var i,o,a,s,l,c;const u=this._readService.getActiveView();if(null==(i=this._selectionListener)||i.destroy(),null==(o=this._commandListener)||o.destroy(),"setCell"===t){const i=r,o=this._readService.getCell(i.fieldId,i.recordId),l=null==(a=this._selectionService)?void 0:a.getSelection();if(!this._originCellValue&&o&&(this._originCellValue=o.value),this._task)if(t===this._task.commandName&&i.recordId===this._task.params.recordId&&i.fieldId===this._task.params.fieldId){if(od(null==i?void 0:i.value,this._originCellValue))return this._task=null,this._hideHighlight(),void this._hideTooltip();this._task={type:e,commandName:t,params:r,action:n}}else await this._task.action(),this._task={type:e,commandName:t,params:r,action:n};else this._task={type:e,commandName:t,params:r,action:n};return(null==u?void 0:u.type)===Wh.GRID&&this._showHighlight(u,i.recordId),this._showTooltip(e,i.recordId),this._handleRefresh=async()=>{var e;await(null==(e=this._task)?void 0:e.action()),this._afterRefresh(),this._updateSelection(u,i.recordId,l)},(null==u?void 0:u.type)===Wh.GRID&&(this._selectionListener=null==(s=this._selectionService)?void 0:s.onChange((({selection:e})=>{e?e.isCollapsed&&e.anchor.row!==l.anchor.row&&this._handleRefresh():this._handleRefresh()}))),void(this._commandListener=this._commandService.onDidExecuteCommand((()=>{this._handleRefresh()})))}if("addEmptyRecord"===t){const{uuid:i}=r,o=null==(l=this._selectionService)?void 0:l.getSelection();return this._task?(await this._task.action(),this._task={type:e,commandName:t,params:r,action:n}):this._task={type:e,commandName:t,params:r,action:n},(null==u?void 0:u.type)===Wh.GRID&&this._showHighlight(u,i),this._showTooltip(e,i),this._handleRefresh=async()=>{var e;await(null==(e=this._task)?void 0:e.action()),this._afterRefresh()},(null==u?void 0:u.type)===Wh.GRID&&(this._selectionListener=null==(c=this._selectionService)?void 0:c.onChange((({selection:e})=>{var t;e?e.isCollapsed&&e.anchor.row!==(null==(t=null==o?void 0:o.anchor)?void 0:t.row)&&this._handleRefresh():this._handleRefresh()}))),void(this._commandListener=this._commandService.onDidExecuteCommand((()=>{this._handleRefresh()})))}n()}))}_showHighlight(e,t){const r=this._readService.getViewFields(null==e?void 0:e.uuid),n=(null==r?void 0:r.map((e=>({recordId:t,fieldId:e.field_uuid}))))||[];this._highlightService.setHighlights(n)}_hideHighlight(){this._highlightService.clearHighlights()}_showTooltip(e,t){this._onRefreshTooltipChange.emit({type:e,recordId:t,desc:this.DESC_MAP[e]})}_hideTooltip(){this._onRefreshTooltipChange.emit({type:null,recordId:"",desc:{text:"",ps:""}})}_updateSelection(e,t,r){var n,i,o;if((null==e?void 0:e.type)===Wh.GRID&&r){const a=this._readService.getFlatViewRecords(e.uuid),s=r.anchor,l=a.findIndex((e=>(null==e?void 0:e.record_uuid)===t));if(l>=0){const e=null==(n=this._selectionService)?void 0:n.getSelection(),t=null==(i=this._selectionService)?void 0:i.createGridSelectionByIndex(l,e?e.anchor.column:s.column,s.rowCount,s.columnCount);null==(o=this._selectionService)||o.scrollToSelection(t,"center")}}}_afterRefresh(){var e,t;this._task=null,this._originCellValue=null,this._hideHighlight(),this._hideTooltip(),null==(e=this._selectionListener)||e.destroy(),null==(t=this._commandListener)||t.destroy()}};qte([to(By)],Yte.prototype,"_refreshEventService",2),qte([to(e3),Mx()],Yte.prototype,"_selectionService",2),qte([to(Dy)],Yte.prototype,"_readService",2),qte([to($2)],Yte.prototype,"_highlightService",2),qte([to(Pb)],Yte.prototype,"_commandService",2),qte([Si()],Yte.prototype,"destroy",1),Yte=qte([eo()],Yte);var Xte=Object.defineProperty,Zte=Object.getOwnPropertyDescriptor,Jte=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Zte(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Xte(t,r,o),o};let Qte=class{static pluginModule(){return bo().contribution(Hte).register(this).register(Yte)}init(e){this._refreshService.init()}};Qte.pluginName="render-refresh",Jte([to(Yte)],Qte.prototype,"_refreshService",2),Jte([to(Uj)],Qte.prototype,"_renderContext",2),Qte=Jte([eo({contrib:Nj})],Qte);var ere=Object.defineProperty,tre=Object.getOwnPropertyDescriptor,rre=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?tre(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ere(t,r,o),o},nre=(e=>(e.HEADER="header",e.GROUP_HEADER="group_header",e.CELL="cell",e.MULTI_CELL="multi_cell",e.KANBAN_RECORD="kanban_record",e.CARD_RECORD="card_record",e))(nre||{});let ire=class extends Zf{constructor(){super(...arguments),this._onContextMenu=this._register(new op),this.contextMenuInfo=null,this.onContextMenu=this._onContextMenu.event}showContextMenu(e){this._onContextMenu.emit(e),this.contextMenuInfo=e}destroy(){super.destroy()}};rre([Si()],ire.prototype,"destroy",1),ire=rre([eo()],ire);var ore=Object.defineProperty,are=Object.getOwnPropertyDescriptor;let sre=class{static pluginModule(){return bo().register(this).register(ire)}init(e){}};sre.pluginName="render-context-menu",sre=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?are(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ore(t,r,o),o})([eo({contrib:Nj})],sre);const lre=Fi.defineToken("ViewerRowHeaderIconContribution");var cre=Object.defineProperty,ure=Object.getOwnPropertyDescriptor,dre=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ure(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&cre(t,r,o),o};let fre=class{constructor(){this._getExpandRecordRecordHeaderIcon=()=>{var e,t;const r=this._viewerGridRecordHeaderIconContribution.getContributions({cache:!1});return r[0]?null==(t=(e=r[0]).getHeaderIcon)?void 0:t.call(e):null}}get ExpandRecordRecordHeaderIcon(){return this._getExpandRecordRecordHeaderIcon()}};dre([Eo(lre)],fre.prototype,"_viewerGridRecordHeaderIconContribution",2),fre=dre([eo()],fre);const pre=({recordId:e})=>{const t=zA(Zj);return s.a.createElement(E.a,{prefixCls:"ant"},s.a.createElement(h.a,{title:kf("展开行（Space）"),placement:"top",shouldHiddenOnHover:!0,shouldArrowCenter:!0},s.a.createElement("div",{className:"lakex-viewer-grid-row-expander",onClick:r=>{r.stopPropagation(),null==t||t.emitClickRecord({recordId:e})}},s.a.createElement(YP,{type:"RowExpand"}))))};var hre=Object.defineProperty,mre=Object.getOwnPropertyDescriptor,vre=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?mre(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&hre(t,r,o),o};let gre=class{static pluginModule(){return bo().register(this)}getHeaderIcon(){return pre}registerOpenerApp(){return[{name:"record",display_name:"Record",description:"记录"}]}registerOpener(){return[{openerName:"record-opener",apps:["record"],autoClear:!0,open:e=>{var t;this._lifecycleService.status<gf.Rendered?this._lifecycleService.when(gf.Rendered,(()=>{var t;null==(t=this._renderService)||t.emitClickRecord({recordId:e})})):null==(t=this._renderService)||t.emitClickRecord({recordId:e})}}]}};gre.pluginName="render-expand-record",vre([to(Zj)],gre.prototype,"_renderService",2),vre([to(yf)],gre.prototype,"_lifecycleService",2),gre=vre([eo({contrib:[lre,aD]})],gre);var yre=Object.defineProperty,bre=Object.getOwnPropertyDescriptor,wre=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?bre(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&yre(t,r,o),o};function _re(e){var t;let r=-1,n=-1;return r=parseInt((null==e?void 0:e.getAttribute("data-col"))||"",10),n=parseInt((null==(t=null==e?void 0:e.parentNode)?void 0:t.getAttribute("data-row"))||"",10),(AA(r)||AA(n))&&console.warn("getCoordinateFromNode NaN error",{column:r,row:n}),{row:n,column:r}}const Cre="ant";let Ere=class{constructor(){this._selectorMap={[Wh.GRID]:".lakex-viewer-grid-cell",[Wh.KANBAN]:".lakex-viewer-kanban-record",[Wh.CARD]:".lakex-viewer-card-record-item"},this._baseSelector="",this._mouseDownEmitter=null,this._mouseMoveEmitter=null,this._mouseUpEmitter=null}static pluginModule(){return bo().contribution(W2).register(this).register(e3).register(s3)}init(){this._listenEvent(),this._registerScrollService()}_registerScrollService(){const e=this._selectionPluginProvider.getContributions();for(const t of e)try{t.registerScrollService(this._selectionService)}catch(e){console.error(e)}}_listenEvent(){let e=null,t=null;this._mouseDownEmitter=dA(document.body,"mousedown",(r=>{var n,i,o;if(null==(n=this._mouseMoveEmitter)||n.destroy(),null==(i=this._mouseUpEmitter)||i.destroy(),hA(r.target,`.${OQ}`)||hA(r.target,`.${Cre}-picker-dropdown`)||hA(r.target,`.${Cre}-popover`)||hA(r.target,`.${Cre}-select-dropdown`))return;if(this._activeTableService.isAutoActive||(this._renderContext.$workbenchRoot.contains(r.target)?this._activeTableService.active():this._activeTableService.inactive()),!this._renderContext.$root.contains(r.target))return void this._removeSelection();const a=this._readService.getActiveView();if(!a)return;if(a.type!==Wh.GRID)return void this._removeSelection();const s=this._selectionService.gridScrollService,l=document.body.clientWidth,c=document.body.clientHeight,u=null==(o=null==s?void 0:s.tableScroller)?void 0:o.getBoundingClientRect();if(this._baseSelector=this._selectorMap[(null==a?void 0:a.type)||""],e=hA(r.target,this._baseSelector),!this._baseSelector||!e)return void this._removeSelection();if(2===r.button)return;const d=this._readService.getViewFields(a.uuid)||[],f=this._readService.getViewRecordsCount(a.uuid),p=d.length;this._mouseMoveEmitter=dA(this._renderContext.$root,"mousemove",(r=>{if(ad(e))return;s&&u&&s.mouseMoveScroll(r,l,c,u,d);const n=hA(r.target,this._baseSelector);n!==t&&n&&(t=n,this._updateSelection(e,t,f,p))})),this._mouseUpEmitter=dA(document.body,"mouseup",(r=>{var n,i;null==(n=this._mouseMoveEmitter)||n.destroy();const o=hA(r.target,this._baseSelector);ad(e)||(o!==t&&o&&(t=o,this._updateSelection(e,t,f,p)),null==(i=this._mouseUpEmitter)||i.destroy(),e=null,t=null)}))}))}_updateSelection(e,t,r,n){var i,o;const a=_re(e),s=_re(t),l=null==(i=this._selectionService)?void 0:i.createGridSelectionByScope(a,s,r,n);null==(o=this._selectionService)||o.setSelection(l)}_removeSelection(){var e;null==(e=this._selectionService)||e.removeSelection()}destroy(){var e,t,r;null==(e=this._mouseDownEmitter)||e.destroy(),null==(t=this._mouseMoveEmitter)||t.destroy(),null==(r=this._mouseUpEmitter)||r.destroy(),this._mouseDownEmitter=null,this._mouseMoveEmitter=null,this._mouseUpEmitter=null}};Ere.pluginName="render-selection",wre([to(Uj)],Ere.prototype,"_renderContext",2),wre([to(Dy)],Ere.prototype,"_readService",2),wre([to(Lj)],Ere.prototype,"_activeTableService",2),wre([to(e3),Mx()],Ere.prototype,"_selectionService",2),wre([Eo(W2)],Ere.prototype,"_selectionPluginProvider",2),Ere=wre([eo({contrib:Nj})],Ere);var xre=Object.defineProperty,Sre=Object.getOwnPropertyDescriptor,kre=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Sre(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&xre(t,r,o),o};let Ore=class{static pluginModule(){return pV.register(this),pV}get _isReadonly(){return this._abilityService.isReadonly(Nw.TABLE)}get _currentViewType(){var e;return null==(e=this._readService.getActiveView())?void 0:e.type}_hasSelection(){return!1}init(){this._hotkeyService.init()}destroy(){this._hotkeyService.destroy()}};Ore.pluginName="render-hotkey",kre([to(uj)],Ore.prototype,"_hotkeyService",2),kre([to(Dy)],Ore.prototype,"_readService",2),kre([to(Hw)],Ore.prototype,"_abilityService",2),Ore=kre([eo({contrib:[Nj]})],Ore);const Ire=Fi.defineToken("StatisticsRenderPluginContribution");var Rre=Object.defineProperty,Tre=Object.getOwnPropertyDescriptor,Are=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Tre(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Rre(t,r,o),o};let Nre=class extends Zf{constructor(){super(...arguments),this._onClick=this._register(new op),this.onClick=this._onClick.event}open(e,t,r,n){this._onClick.emit({view:e,field:t,stat:r,target:n})}destroy(){super.destroy()}};Are([Si()],Nre.prototype,"destroy",1),Nre=Are([eo()],Nre);const Mre=[Rh.TEXT,Rh.SELECT,Rh.MULTI_SELECT,Rh.NUMBER,Rh.DATE,Rh.IMAGE,Rh.FILE,Rh.PHONE,Rh.MENTION,Rh.LINK,Rh.EMAIL,Rh.USER_ID,Rh.CREATED_AT,Rh.MODIFIER_ID,Rh.UPDATED_AT],Pre=[Rh.DATE,Rh.CREATED_AT,Rh.UPDATED_AT],jre={none:{stats:kf("统计"),text:kf("不展示")},count:{stats:kf("$1 条记录"),text:kf("记录总数")},filled:{stats:kf("已填写 $1"),text:kf("已填写数"),types:Mre},empty:{stats:kf("未填写 $1"),text:kf("未填写数"),types:Mre},checked:{stats:kf("已勾选 $1"),text:kf("已勾选"),types:[Rh.CHECKBOX]},unchecked:{stats:kf("未勾选 $1"),text:kf("未勾选"),types:[Rh.CHECKBOX]},unique:{stats:kf("唯一数 $1"),text:kf("唯一数"),types:Mre},percentFilled:{stats:kf("已填写占比 $1"),text:kf("已填写占比"),types:Mre},percentEmpty:{stats:kf("未填写占比 $1"),text:kf("未填写占比"),types:Mre},percentUnique:{stats:kf("唯一数占比 $1"),text:kf("唯一数占比"),types:Mre},sum:{stats:kf("求和 $1"),text:kf("求和"),types:[Rh.NUMBER]},average:{stats:kf("平均值 $1"),text:kf("平均值"),types:[Rh.NUMBER]},max:{stats:kf("最大值 $1"),text:kf("最大值"),types:[Rh.NUMBER]},min:{stats:kf("最小值 $1"),text:kf("最小值"),types:[Rh.NUMBER]},earliestDate:{stats:kf("最早时间 $1"),text:kf("最早时间"),types:Pre},latestDate:{stats:kf("最晚时间 $1"),text:kf("最晚时间"),types:Pre},dateRange:{stats:kf("时间范围 $1 天"),text:kf("时间范围（日）"),types:Pre},monthRange:{stats:kf("时间范围 $1 月"),text:kf("时间范围（月）"),types:Pre},percentChecked:{stats:kf("已勾选占比 $1"),text:kf("已勾选占比"),types:[Rh.CHECKBOX]},percentUnchecked:{stats:kf("未勾选占比 $1"),text:kf("未勾选占比"),types:[Rh.CHECKBOX]}},Dre=({field:e,records:t})=>{const r=zA(Dy),n=zA(Nre),i=r.getActiveView(),[o,s]=Object(a.useState)(void 0),l=Object(a.useMemo)((()=>t.map((e=>e.record_uuid))),[t]);return Object(a.useEffect)((()=>{i&&e&&(e=>{window.requestIdleCallback?requestIdleCallback(e):e()})((()=>{const t=r.getStatValue(i.uuid,e.uuid,l);s(Object.assign({},t))}))}),[null==i?void 0:i.uuid,null==e?void 0:e.uuid,l]),{stat:o,onClick(t){null==n||n.open(i,e,o,t.currentTarget)}}},Fre=({field:e,records:t})=>{let r;const{stat:n,onClick:i}=Dre({field:e,records:t});if(n&&n.type){const{stats:e}=jre[n.type];let t=n.value;("earliestDate"===n.type||"latestDate"===n.type&&n.value)&&(t=Td(n.value).format("YYYY-MM-DD")),r=s.a.createElement("span",{className:"lakex-table-stats-filled"},s.a.createElement("span",{className:"lakex-table-stats-text"},kf(e,t+"")),s.a.createElement(YP,{type:"ReviewArrowDown",size:14}))}else r=s.a.createElement("span",{className:"lakex-table-stats-unfilled"},s.a.createElement("span",{className:"lakex-table-stats-text"},jre.none.stats),s.a.createElement(YP,{type:"ReviewArrowDown",size:14}));return s.a.createElement("div",{className:"lakex-table-stats",onClick:i},r)};var Vre=Object.defineProperty,Lre=Object.getOwnPropertyDescriptor;let $re=class{static pluginModule(){return bo().contribution(Ire).register(Nre).register(this)}init(){}getStatisticsComponent(){return Fre}};$re.pluginName="render-statistics",$re=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Lre(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Vre(t,r,o),o})([eo({contrib:[Nj,d3]})],$re);var Bre=Object.defineProperty,zre=Object.getOwnPropertyDescriptor,Ure=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?zre(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Bre(t,r,o),o};let Hre=class{static pluginModule(){return bo().register(this)}init(){}registerHotkey(e){e.registerItem({id:"undo",hotkey:"⌘+Z",name:"撤销",enableOnInput:!1,isEnable:()=>!0,onHotKey:()=>{this._commandService.execCommand("undo")}}),e.registerItem({id:"redo",hotkey:"⌘+shift+Z",name:"重做",enableOnInput:!1,isEnable:()=>!0,onHotKey:()=>{this._commandService.execCommand("redo")}})}};Hre.pluginName="render-history",Ure([to(Pb)],Hre.prototype,"_commandService",2),Hre=Ure([eo({contrib:[Nj,dj]})],Hre);const Wre=({listeners:e,disable:t=!1})=>t?s.a.createElement(h.a,{title:kf("取消排序后，可进行拖拽")},s.a.createElement("div",{className:GA("lakex-viewer-grid-row-dragger",{disable:t}),...e,onClick:e=>e.stopPropagation()},s.a.createElement(YP,{type:"Drag"}))):s.a.createElement("div",{className:GA("lakex-viewer-grid-row-dragger"),...e,onClick:e=>e.stopPropagation()},s.a.createElement(YP,{type:"Drag"}));var Gre=Object.defineProperty,Kre=Object.getOwnPropertyDescriptor,qre=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Kre(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Gre(t,r,o),o};let Yre=class{get OrderDragIcon(){return Wre}async updateViewOrder(e,t){await this._commandService.execCommand("changeViewOrder",{sourceViewId:e,targetViewId:t})}async updateRecordOrder(e,t,r,n){const i=this._readService.getActiveView();await this._commandService.execCommand("changeRecordOrder",{viewId:null==i?void 0:i.uuid,sourceRecordId:e,targetRecordId:t,sourceGroupItem:r,targetGroupItem:n})}async updateFieldOrder(e,t){const r=this._readService.getActiveView();await this._commandService.execCommand("changeFieldOrder",{viewId:null==r?void 0:r.uuid,sourceFieldId:e,targetFieldId:t})}async updateFieldOptionOrder(e,t,r){await this._commandService.execCommand("changeFieldOptionOrder",{fieldId:e,sourceFieldOptionId:t,targetFieldOptionId:r})}};qre([to(Pb)],Yre.prototype,"_commandService",2),qre([to(Dy)],Yre.prototype,"_readService",2),Yre=qre([eo()],Yre);const Xre=Fi.defineToken("OrderRenderPluginContribution");var Zre=Object.defineProperty,Jre=Object.getOwnPropertyDescriptor;let Qre=class{static pluginModule(){return bo().contribution(Xre).register(this).register(Yre)}init(){}};Qre.pluginName="render-order",Qre=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Jre(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Zre(t,r,o),o})([eo({contrib:Nj})],Qre);var ene=Object.defineProperty,tne=Object.getOwnPropertyDescriptor,rne=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?tne(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ene(t,r,o),o};let nne=class{static pluginModule(){return bo().register(this)}static registerConfiguration(e){e.registerConfiguration({id:"view",type:"object",title:"视图",properties:{useWindowScroll:{type:"boolean",description:"滚动容器是否为 window"},customScrollParent:{type:"object",description:"自定义滚动容器，useWindowScroll 场景下触发滚动加载，类型为 HTMLElement | undefined"}}}),e.registerDefaultValue({"view.useWindowScroll":!1,"view.customScrollParent":void 0})}init(){this._commandService.onDidExecuteCommand((({context:e})=>{if("switchView"===e.commandName){const t=e.argArray[0].viewId;this._openerService.setHash("view",t)}}))}registerOpenerApp(){return[{name:"view",display_name:"View",description:"视图"}]}registerOpener(){return[{openerName:"view-opener",apps:["view"],open:e=>{this._commandService.execCommand("switchView",{viewId:e},!0)}}]}};nne.pluginName="render-viewer-manage",rne([to(Pb)],nne.prototype,"_commandService",2),rne([to(MD)],nne.prototype,"_openerService",2),nne=rne([eo({contrib:[Nj,aD]})],nne);const ine=()=>{const e=zA(Zj),t=Object(a.useCallback)((t=>{t.preventDefault(),e.emitClickIcon({iconName:"grid-field-config",event:t})}),[e]);return s.a.createElement("div",{className:"lakex-viewer-grid-header-blank",onClick:t},s.a.createElement(YP,{type:"Add"}))};var one=Object.defineProperty,ane=Object.getOwnPropertyDescriptor;let sne=class{static pluginModule(){return bo().register(this)}init(){}getAddFieldComponent(){return ine}};sne.pluginName="render-add-field",sne=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?ane(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&one(t,r,o),o})([eo({contrib:[Nj,f3]})],sne);const lne=({inGroup:e=!1,index:t=-1,viewGroupRecord:r,viewRecords:n=[],viewFields:i=[]})=>{const o=zA(Pb),l=zA(Dy),c=zA(e3),u=Object(a.useCallback)((async()=>{var a;if(e){const e=null==(a=n[t])?void 0:a.record_uuid;await o.execCommand("addEmptyRecord",{sourceRecordId:e,groupItemKey:r?l.keyValue(r.groupOption):""})}else await o.execCommand("addEmptyRecord");if(c){const r=c.createGridSelectionByIndex(e?t+1:n.length,0,n.length+1,i.length);null==c||c.setSelection(r)}}),[]);return s.a.createElement("div",{className:"lakex-viewer-grid-add-record"},s.a.createElement(YP,{type:"Add",onClick:u,size:14}))};var cne=Object.defineProperty,une=Object.getOwnPropertyDescriptor;let dne=class{static pluginModule(){return bo().register(this)}init(){}getAddRecordComponent(){return lne}};dne.pluginName="render-add-record",dne=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?une(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&cne(t,r,o),o})([eo({contrib:[Nj,p3]})],dne);var fne=Object.defineProperty,pne=Object.getOwnPropertyDescriptor,hne=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?pne(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&fne(t,r,o),o};let mne=class extends Zf{constructor(){super(...arguments),this._onEditGroupName=this._register(new op),this.onEditGroupName=this._onEditGroupName.event}updateFieldGroupName(e,t){this._commandService.execCommand("changeFieldGroupName",{fieldGroupId:e,name:t})}emitEdit(e){this._onEditGroupName.emit({fieldGroupId:e})}destroy(){super.destroy()}};hne([to(Pb)],mne.prototype,"_commandService",2),hne([Si()],mne.prototype,"destroy",1),mne=hne([eo()],mne);var vne=Object.defineProperty,gne=Object.getOwnPropertyDescriptor;let yne=class{static pluginModule(){return bo().register(this).register(mne)}init(){}};yne.pluginName="render-field-group",yne=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?gne(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&vne(t,r,o),o})([eo({contrib:Nj})],yne);const bne=0,wne=1,_ne=2,Cne=4;function Ene(e,t){return r=>e(t(r))}function xne(e,t){return t(e)}function Sne(e,t){return r=>e(t,r)}function kne(e,t){return()=>e(t)}function One(e,t){return t(e),e}function Ine(...e){return e}function Rne(e){e()}function Tne(e){return()=>e}function Ane(e){return void 0!==e}function Nne(){}function Mne(e,t){return e(wne,t)}function Pne(e,t){e(bne,t)}function jne(e){e(_ne)}function Dne(e){return e(Cne)}function Fne(e,t){return Mne(e,Sne(t,bne))}function Vne(e,t){const r=e(wne,(e=>{r(),t(e)}));return r}function Lne(){const e=[];return(t,r)=>{switch(t){case _ne:return void e.splice(0,e.length);case wne:return e.push(r),()=>{const t=e.indexOf(r);t>-1&&e.splice(t,1)};case bne:return void e.slice().forEach((e=>{e(r)}));default:throw new Error(`unrecognized action ${t}`)}}}function $ne(e){let t=e;const r=Lne();return(e,n)=>{switch(e){case wne:n(t);break;case bne:t=n;break;case Cne:return t}return r(e,n)}}function Bne(e){return One(Lne(),(t=>Fne(e,t)))}function zne(e,t){return One($ne(t),(t=>Fne(e,t)))}function Une(e,...t){const r=function(...e){return t=>e.reduceRight(xne,t)}(...t);return(t,n)=>{switch(t){case wne:return Mne(e,r(n));case _ne:return void jne(e)}}}function Hne(e,t){return e===t}function Wne(e=Hne){let t;return r=>n=>{e(t,n)||(t=n,r(n))}}function Gne(e){return t=>r=>{e(r)&&t(r)}}function Kne(e){return t=>Ene(t,e)}function qne(e){return t=>()=>t(e)}function Yne(e,t){return r=>n=>r(t=e(t,n))}function Xne(e){return t=>r=>{e>0?e--:t(r)}}function Zne(e){let t,r=null;return n=>i=>{r=i,!t&&(t=setTimeout((()=>{t=void 0,n(r)}),e))}}function Jne(e){let t,r;return n=>i=>{t=i,r&&clearTimeout(r),r=setTimeout((()=>{n(t)}),e)}}function Qne(...e){const t=new Array(e.length);let r=0,n=null;const i=Math.pow(2,e.length)-1;return e.forEach(((e,o)=>{const a=Math.pow(2,o);Mne(e,(e=>{const s=r;r|=a,t[o]=e,s!==i&&r===i&&n&&(n(),n=null)}))})),e=>o=>{const a=()=>e([o].concat(t));r===i?a():n=a}}function eie(...e){return function(t,r){switch(t){case wne:return function(...e){return()=>{e.map(Rne)}}(...e.map((e=>Mne(e,r))));case _ne:return;default:throw new Error(`unrecognized action ${t}`)}}}function tie(e,t=Hne){return Une(e,Wne(t))}function rie(...e){const t=Lne(),r=new Array(e.length);let n=0;const i=Math.pow(2,e.length)-1;return e.forEach(((e,o)=>{const a=Math.pow(2,o);Mne(e,(e=>{r[o]=e,n|=a,n===i&&Pne(t,r)}))})),function(e,o){switch(e){case wne:return n===i&&o(r),Mne(t,o);case _ne:return jne(t);default:throw new Error(`unrecognized action ${e}`)}}}function nie(e,t=[],{singleton:r}={singleton:!0}){return{id:iie(),constructor:e,dependencies:t,singleton:r}}const iie=()=>Symbol();const oie=typeof document<"u"?s.a.useLayoutEffect:s.a.useEffect;function aie(e,t,r){const n=Object.keys(t.required||{}),i=Object.keys(t.optional||{}),o=Object.keys(t.methods||{}),a=Object.keys(t.events||{}),l=s.a.createContext({});function c(e,r){e.propsReady&&Pne(e.propsReady,!1);for(const i of n){Pne(e[t.required[i]],r[i])}for(const n of i)if(n in r){Pne(e[t.optional[n]],r[n])}e.propsReady&&Pne(e.propsReady,!0)}function u(e){return a.reduce(((r,n)=>(r[n]=function(e){let t,r;const n=()=>t&&t();return function(i,o){switch(i){case wne:return o?r===o?void 0:(n(),r=o,t=Mne(e,o),t):(n(),Nne);case _ne:return n(),void(r=null);default:throw new Error(`unrecognized action ${i}`)}}}(e[t.events[n]]),r)),{})}return{Component:s.a.forwardRef(((d,f)=>{const{children:p,...h}=d,[m]=s.a.useState((()=>One(function(e){const t=new Map,r=({id:e,constructor:n,dependencies:i,singleton:o})=>{if(o&&t.has(e))return t.get(e);const a=n(i.map((e=>r(e))));return o&&t.set(e,a),a};return r(e)}(e),(e=>c(e,h))))),[v]=s.a.useState(kne(u,m));return oie((()=>{for(const e of a)e in h&&Mne(v[e],h[e]);return()=>{Object.values(v).map(jne)}}),[h,v,m]),oie((()=>{c(m,h)})),s.a.useImperativeHandle(f,Tne(function(e){return o.reduce(((r,n)=>(r[n]=r=>{Pne(e[t.methods[n]],r)},r)),{})}(m))),s.a.createElement(l.Provider,{value:m},r?s.a.createElement(r,function(e,t){const r={},n={};let i=0;const o=e.length;for(;i<o;)n[e[i]]=1,i+=1;for(const e in t)n.hasOwnProperty(e)||(r[e]=t[e]);return r}([...n,...i,...a],h),p):p)})),usePublisher:e=>s.a.useCallback(Sne(Pne,s.a.useContext(l)[e]),[e]),useEmitterValue:e=>{const t=s.a.useContext(l)[e],[r,n]=s.a.useState(kne(Dne,t));return oie((()=>Mne(t,(e=>{e!==r&&n(Tne(e))}))),[t,r]),r},useEmitter:(e,t)=>{const r=s.a.useContext(l)[e];oie((()=>Mne(r,t)),[t,r])}}}const sie=typeof document<"u"?s.a.useLayoutEffect:s.a.useEffect;var lie=(e=>(e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR",e))(lie||{});const cie={0:"debug",1:"log",2:"warn",3:"error"},uie=nie((()=>{const e=$ne(3);return{log:$ne(((t,r,n=1)=>{var i;n>=(null!=(i=(typeof globalThis>"u"?window:globalThis).VIRTUOSO_LOG_LEVEL)?i:Dne(e))&&console[cie[n]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",t,r)})),logLevel:e}}),[],{singleton:!0});function die(e,t=!0){const r=s.a.useRef(null);let n=e=>{};if(typeof ResizeObserver<"u"){const i=s.a.useMemo((()=>new ResizeObserver((t=>{const r=t[0].target;null!==r.offsetParent&&e(r)}))),[e]);n=e=>{e&&t?(i.observe(e),r.current=e):(r.current&&i.unobserve(r.current),r.current=null)}}return{ref:r,callbackRef:n}}function fie(e,t=!0){return die(e,t).callbackRef}function pie(e,t,r,n,i,o,a){const l=s.a.useCallback((r=>{const s=function(e,t,r,n){const i=e.length;if(0===i)return null;const o=[];for(let a=0;a<i;a++){const i=e.item(a);if(!i||void 0===i.dataset.index)continue;const s=parseInt(i.dataset.index),l=parseFloat(i.dataset.knownSize),c=t(i,r);if(0===c&&n("Zero-sized element, this should not happen",{child:i},lie.ERROR),c===l)continue;const u=o[o.length-1];0===o.length||u.size!==c||u.endIndex!==s-1?o.push({startIndex:s,endIndex:s,size:c}):o[o.length-1].endIndex++}return o}(r.children,t,"offsetHeight",i);let l=r.parentElement;for(;!l.dataset.virtuosoScroller;)l=l.parentElement;const c="window"===l.lastElementChild.dataset.viewportType,u=a?a.scrollTop:c?window.pageYOffset||document.documentElement.scrollTop:l.scrollTop,d=a?a.scrollHeight:c?document.documentElement.scrollHeight:l.scrollHeight,f=a?a.offsetHeight:c?window.innerHeight:l.offsetHeight;n({scrollTop:Math.max(u,0),scrollHeight:d,viewportHeight:f}),null==o||o(function(e,t,r){return"normal"!==t&&!(null!=t&&t.endsWith("px"))&&r(`${e} was not resolved to pixel value correctly`,t,lie.WARN),"normal"===t?0:parseInt(null!=t?t:"0",10)}("row-gap",getComputedStyle(r).rowGap,i)),null!==s&&e(s)}),[e,t,i,o,a,n]);return die(l,r)}function hie(e,t){return Math.round(e.getBoundingClientRect()[t])}function mie(e,t){return Math.abs(e-t)<1.01}function vie(e,t,r,n=Nne,i){const o=s.a.useRef(null),a=s.a.useRef(null),l=s.a.useRef(null),u=s.a.useCallback((r=>{const n=r.target,i=n===window||n===document,o=i?window.pageYOffset||document.documentElement.scrollTop:n.scrollTop,s=i?document.documentElement.scrollHeight:n.scrollHeight,u=i?window.innerHeight:n.offsetHeight,d=()=>{e({scrollTop:Math.max(o,0),scrollHeight:s,viewportHeight:u})};r.suppressFlushSync?d():c.a.flushSync(d),null!==a.current&&(o===a.current||o<=0||o===s-u)&&(a.current=null,t(!0),l.current&&(clearTimeout(l.current),l.current=null))}),[e,t]);return s.a.useEffect((()=>{const e=i||o.current;return n(i||o.current),u({target:e,suppressFlushSync:!0}),e.addEventListener("scroll",u,{passive:!0}),()=>{n(null),e.removeEventListener("scroll",u)}}),[o,u,r,n,i]),{scrollerRef:o,scrollByCallback:function(e){o.current.scrollBy(e)},scrollToCallback:function(r){const n=o.current;if(!n||"offsetHeight"in n&&0===n.offsetHeight)return;const i="smooth"===r.behavior;let s,c,u;n===window?(c=Math.max(hie(document.documentElement,"height"),document.documentElement.scrollHeight),s=window.innerHeight,u=document.documentElement.scrollTop):(c=n.scrollHeight,s=hie(n,"height"),u=n.scrollTop);const d=c-s;if(r.top=Math.ceil(Math.max(Math.min(d,r.top),0)),mie(s,c)||r.top===u)return e({scrollTop:u,scrollHeight:c,viewportHeight:s}),void(i&&t(!0));i?(a.current=r.top,l.current&&clearTimeout(l.current),l.current=setTimeout((()=>{l.current=null,a.current=null,t(!0)}),1e3)):a.current=null,n.scrollTo(r)}}}const gie=nie((()=>{const e=Lne(),t=Lne(),r=$ne(0),n=Lne(),i=$ne(0),o=Lne(),a=Lne(),s=$ne(0),l=$ne(0),c=$ne(0),u=$ne(0),d=Lne(),f=Lne(),p=$ne(!1);return Fne(Une(e,Kne((({scrollTop:e})=>e))),t),Fne(Une(e,Kne((({scrollHeight:e})=>e))),a),Fne(t,i),{scrollContainerState:e,scrollTop:t,viewportHeight:o,headerHeight:s,fixedHeaderHeight:l,fixedFooterHeight:c,footerHeight:u,scrollHeight:a,smoothScrollTargetReached:n,scrollTo:d,scrollBy:f,statefulScrollTop:i,deviation:r,scrollingInProgress:p}}),[],{singleton:!0}),yie={lvl:0};function bie(e,t,r,n=yie,i=yie){return{k:e,v:t,lvl:r,l:n,r:i}}function wie(e){return e===yie}function _ie(){return yie}function Cie(e,t){if(wie(e))return yie;const{k:r,l:n,r:i}=e;if(t===r){if(wie(n))return i;if(wie(i))return n;{const[t,r]=Iie(n);return Mie(Tie(e,{k:t,v:r,l:Rie(n)}))}}return Mie(Tie(e,t<r?{l:Cie(n,t)}:{r:Cie(i,t)}))}function Eie(e,t){if(!wie(e))return t===e.k?e.v:t<e.k?Eie(e.l,t):Eie(e.r,t)}function xie(e,t,r="k"){if(wie(e))return[-1/0,void 0];if(Number(e[r])===t)return[e.k,e.v];if(Number(e[r])<t){const n=xie(e.r,t,r);return n[0]===-1/0?[e.k,e.v]:n}return xie(e.l,t,r)}function Sie(e,t,r){return wie(e)?bie(t,r,1):t===e.k?Tie(e,{k:t,v:r}):t<e.k?Nie(Tie(e,{l:Sie(e.l,t,r)})):Nie(Tie(e,{r:Sie(e.r,t,r)}))}function kie(e,t,r){if(wie(e))return[];const{k:n,v:i,l:o,r:a}=e;let s=[];return n>t&&(s=s.concat(kie(o,t,r))),n>=t&&n<=r&&s.push({k:n,v:i}),n<=r&&(s=s.concat(kie(a,t,r))),s}function Oie(e){return wie(e)?[]:[...Oie(e.l),{k:e.k,v:e.v},...Oie(e.r)]}function Iie(e){return wie(e.r)?[e.k,e.v]:Iie(e.r)}function Rie(e){return wie(e.r)?e.l:Mie(Tie(e,{r:Rie(e.r)}))}function Tie(e,t){return bie(void 0!==t.k?t.k:e.k,void 0!==t.v?t.v:e.v,void 0!==t.lvl?t.lvl:e.lvl,void 0!==t.l?t.l:e.l,void 0!==t.r?t.r:e.r)}function Aie(e){return wie(e)||e.lvl>e.r.lvl}function Nie(e){return Die(Fie(e))}function Mie(e){const{l:t,r:r,lvl:n}=e;if(r.lvl>=n-1&&t.lvl>=n-1)return e;if(n>r.lvl+1){if(Aie(t))return Fie(Tie(e,{lvl:n-1}));if(!wie(t)&&!wie(t.r))return Tie(t.r,{l:Tie(t,{r:t.r.l}),r:Tie(e,{l:t.r.r,lvl:n-1}),lvl:n});throw new Error("Unexpected empty nodes")}if(Aie(e))return Die(Tie(e,{lvl:n-1}));if(wie(r)||wie(r.l))throw new Error("Unexpected empty nodes");{const t=r.l,i=Aie(t)?r.lvl-1:r.lvl;return Tie(t,{l:Tie(e,{r:t.l,lvl:n-1}),r:Die(Tie(r,{l:t.r,lvl:i})),lvl:t.lvl+1})}}function Pie(e,t,r){if(wie(e))return[];return function(e){return jie(e,(({k:e,v:t})=>({index:e,value:t})))}(kie(e,xie(e,t)[0],r))}function jie(e,t){const r=e.length;if(0===r)return[];let{index:n,value:i}=t(e[0]);const o=[];for(let a=1;a<r;a++){const{index:r,value:s}=t(e[a]);o.push({start:n,end:r-1,value:i}),n=r,i=s}return o.push({start:n,end:1/0,value:i}),o}function Die(e){const{r:t,lvl:r}=e;return wie(t)||wie(t.r)||t.lvl!==r||t.r.lvl!==r?e:Tie(t,{l:Tie(e,{r:t.l}),lvl:r+1})}function Fie(e){const{l:t}=e;return wie(t)||t.lvl!==e.lvl?e:Tie(t,{r:Tie(e,{l:t.r})})}function Vie(e,t,r,n=0){let i=e.length-1;for(;n<=i;){const o=Math.floor((n+i)/2),a=r(e[o],t);if(0===a)return o;if(-1===a){if(i-n<2)return o-1;i=o-1}else{if(i===n)return o;n=o+1}}throw new Error(`Failed binary finding record in array - ${e.join(",")}, searched for ${t}`)}function Lie(e,t,r){return e[Vie(e,t,r)]}const $ie=nie((()=>({recalcInProgress:$ne(!1)})),[],{singleton:!0});function Bie(e){const{size:t,startIndex:r,endIndex:n}=e;return e=>e.start===r&&(e.end===n||e.end===1/0)&&e.value===t}function zie(e,t){let r=0,n=0;for(;r<e;)r+=t[n+1]-t[n]-1,n++;return n-(r===e?0:1)}function Uie({index:e},t){return t===e?0:t<e?-1:1}function Hie({offset:e},t){return t===e?0:t<e?-1:1}function Wie(e){return{index:e.index,value:e}}function Gie(e,t,r,n=0){return n>0&&(t=Math.max(t,Lie(e,n,Uie).offset)),jie(function(e,t,r,n){const i=Vie(e,t,n),o=Vie(e,r,n,i);return e.slice(i,o+1)}(e,t,r,Hie),Wie)}function Kie(e,t,r,n){let i=e,o=0,a=0,s=0,l=0;if(0!==t){l=Vie(i,t-1,Uie),s=i[l].offset;const e=xie(r,t-1);o=e[0],a=e[1],i.length&&i[l].size===xie(r,t)[1]&&(l-=1),i=i.slice(0,l+1)}else i=[];for(const{start:e,value:l}of Pie(r,t,1/0)){const t=e-o,r=t*a+s+t*n;i.push({offset:r,size:l,index:e}),o=e,s=r,a=l}return{offsetTree:i,lastIndex:o,lastOffset:s,lastSize:a}}function qie(e,[t,r,n,i]){t.length>0&&n("received item sizes",t,lie.DEBUG);const o=e.sizeTree;let a=o,s=0;if(r.length>0&&wie(o)&&2===t.length){const e=t[0].size,n=t[1].size;a=r.reduce(((t,r)=>Sie(Sie(t,r,e),r+1,n)),a)}else[a,s]=function(e,t){let r=wie(e)?0:1/0;for(const n of t){const{size:t,startIndex:i,endIndex:o}=n;if(r=Math.min(r,i),wie(e)){e=Sie(e,0,t);continue}const a=Pie(e,i-1,o+1);if(a.some(Bie(n)))continue;let s=!1,l=!1;for(const{start:r,end:n,value:i}of a)s?(o>=r||t===i)&&(e=Cie(e,r)):(l=i!==t,s=!0),n>o&&o>=r&&i!==t&&(e=Sie(e,o+1,i));l&&(e=Sie(e,i,t))}return[e,r]}(a,t);if(a===o)return e;const{offsetTree:l,lastIndex:c,lastSize:u,lastOffset:d}=Kie(e.offsetTree,s,a,i);return{sizeTree:a,offsetTree:l,lastIndex:c,lastOffset:d,lastSize:u,groupOffsetTree:r.reduce(((e,t)=>Sie(e,t,Yie(t,l,i))),_ie()),groupIndices:r}}function Yie(e,t,r){if(0===t.length)return 0;const{offset:n,index:i,size:o}=Lie(t,e,Uie),a=e-i,s=o*a+(a-1)*r+n;return s>0?s+r:s}function Xie(e,t,r){if(function(e){return typeof e.groupIndex<"u"}(e))return t.groupIndices[e.groupIndex]+1;{let n=Zie("LAST"===e.index?r:e.index,t);return n=Math.max(0,n,Math.min(r,n)),n}}function Zie(e,t){if(!Jie(t))return e;let r=0;for(;t.groupIndices[r]<=e+r;)r++;return e+r}function Jie(e){return!wie(e.groupOffsetTree)}const Qie={offsetHeight:"height",offsetWidth:"width"},eoe=nie((([{log:e},{recalcInProgress:t}])=>{const r=Lne(),n=Lne(),i=zne(n,0),o=Lne(),a=Lne(),s=$ne(0),l=$ne([]),c=$ne(void 0),u=$ne(void 0),d=$ne(((e,t)=>hie(e,Qie[t]))),f=$ne(void 0),p=$ne(0),h={offsetTree:[],sizeTree:_ie(),groupOffsetTree:_ie(),lastIndex:0,lastOffset:0,lastSize:0,groupIndices:[]},m=zne(Une(r,Qne(l,e,p),Yne(qie,h),Wne()),h),v=zne(Une(l,Wne(),Yne(((e,t)=>({prev:e.current,current:t})),{prev:[],current:[]}),Kne((({prev:e})=>e))),[]);Fne(Une(l,Gne((e=>e.length>0)),Qne(m,p),Kne((([e,t,r])=>{const n=e.reduce(((e,n,i)=>Sie(e,n,Yie(n,t.offsetTree,r)||i)),_ie());return{...t,groupIndices:e,groupOffsetTree:n}}))),m),Fne(Une(n,Qne(m),Gne((([e,{lastIndex:t}])=>e<t)),Kne((([e,{lastIndex:t,lastSize:r}])=>[{startIndex:e,endIndex:t,size:r}]))),r),Fne(c,u);const g=zne(Une(c,Kne((e=>void 0===e))),!0);Fne(Une(u,Gne((e=>void 0!==e&&wie(Dne(m).sizeTree))),Kne((e=>[{startIndex:0,endIndex:0,size:e}]))),r);const y=Bne(Une(r,Qne(m),Yne((({sizes:e},[t,r])=>({changed:r!==e,sizes:r})),{changed:!1,sizes:h}),Kne((e=>e.changed))));Mne(Une(s,Yne(((e,t)=>({diff:e.prev-t,prev:t})),{diff:0,prev:0}),Kne((e=>e.diff))),(e=>{const{groupIndices:r}=Dne(m);if(e>0)Pne(t,!0),Pne(o,e+zie(e,r));else if(e<0){const t=Dne(v);t.length>0&&(e-=zie(-e,t)),Pne(a,e)}})),Mne(Une(s,Qne(e)),(([e,t])=>{e<0&&t("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:s},lie.ERROR)}));const b=Bne(o);Fne(Une(o,Qne(m),Kne((([e,t])=>{const r=t.groupIndices.length>0,n=[],i=t.lastSize;if(r){const r=Eie(t.sizeTree,0);let o=0,a=0;for(;o<e;){const e=t.groupIndices[a],s=t.groupIndices.length===a+1?1/0:t.groupIndices[a+1]-e-1;n.push({startIndex:e,endIndex:e,size:r}),n.push({startIndex:e+1,endIndex:e+1+s-1,size:i}),a++,o+=s+1}const s=Oie(t.sizeTree);return o!==e&&s.shift(),s.reduce(((t,{k:r,v:n})=>{let i=t.ranges;return 0!==t.prevSize&&(i=[...t.ranges,{startIndex:t.prevIndex,endIndex:r+e-1,size:t.prevSize}]),{ranges:i,prevIndex:r+e,prevSize:n}}),{ranges:n,prevIndex:e,prevSize:0}).ranges}return Oie(t.sizeTree).reduce(((t,{k:r,v:n})=>({ranges:[...t.ranges,{startIndex:t.prevIndex,endIndex:r+e-1,size:t.prevSize}],prevIndex:r+e,prevSize:n})),{ranges:[],prevIndex:0,prevSize:i}).ranges}))),r);const w=Bne(Une(a,Qne(m,p),Kne((([e,{offsetTree:t},r])=>Yie(-e,t,r)))));return Fne(Une(a,Qne(m,p),Kne((([e,t,r])=>{if(t.groupIndices.length>0){if(wie(t.sizeTree))return t;let n=_ie();const i=Dne(v);let o=0,a=0,s=0;for(;o<-e;){s=i[a];const e=i[a+1]-s-1;a++,o+=e+1}if(n=Oie(t.sizeTree).reduce(((t,{k:r,v:n})=>Sie(t,Math.max(0,r+e),n)),n),o!==-e){n=Sie(n,0,Eie(t.sizeTree,s));n=Sie(n,1,xie(t.sizeTree,1-e)[1])}return{...t,sizeTree:n,...Kie(t.offsetTree,0,n,r)}}{const n=Oie(t.sizeTree).reduce(((t,{k:r,v:n})=>Sie(t,Math.max(0,r+e),n)),_ie());return{...t,sizeTree:n,...Kie(t.offsetTree,0,n,r)}}}))),m),{data:f,totalCount:n,sizeRanges:r,groupIndices:l,defaultItemSize:u,fixedItemSize:c,unshiftWith:o,shiftWith:a,shiftWithOffset:w,beforeUnshiftWith:b,firstItemIndex:s,gap:p,sizes:m,listRefresh:y,statefulTotalCount:i,trackItemSizes:g,itemSize:d}}),Ine(uie,$ie),{singleton:!0}),toe=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function roe(e){const t="number"==typeof e?{index:e}:e;return t.align||(t.align="start"),(!t.behavior||!toe)&&(t.behavior="auto"),t.offset||(t.offset=0),t}const noe=nie((([{sizes:e,totalCount:t,listRefresh:r,gap:n},{scrollingInProgress:i,viewportHeight:o,scrollTo:a,smoothScrollTargetReached:s,headerHeight:l,footerHeight:c,fixedHeaderHeight:u,fixedFooterHeight:d},{log:f}])=>{const p=Lne(),h=$ne(0);let m=null,v=null,g=null;function y(){m&&(m(),m=null),g&&(g(),g=null),v&&(clearTimeout(v),v=null),Pne(i,!1)}return Fne(Une(p,Qne(e,o,t,h,l,c,f),Qne(n,u,d),Kne((([[e,t,n,o,a,l,c,u],d,f,h])=>{const b=roe(e),{align:w,behavior:_,offset:C}=b,E=o-1,x=Xie(b,t,E);let S=Yie(x,t.offsetTree,d)+l;"end"===w?(S+=f+xie(t.sizeTree,x)[1]-n+h,x===E&&(S+=c)):"center"===w?S+=(f+xie(t.sizeTree,x)[1]-n+h)/2:S-=a,C&&(S+=C);const k=t=>{y(),t?(u("retrying to scroll to",{location:e},lie.DEBUG),Pne(p,e)):u("list did not change, scroll successful",{},lie.DEBUG)};if(y(),"smooth"===_){let e=!1;g=Mne(r,(t=>{e=e||t})),m=Vne(s,(()=>{k(e)}))}else m=Vne(Une(r,function(e){return t=>{const r=setTimeout((()=>{t(!1)}),e);return e=>{e&&(t(!0),clearTimeout(r))}}}(150)),k);return v=setTimeout((()=>{y()}),1200),Pne(i,!0),u("scrolling from index to",{index:x,top:S,behavior:_},lie.DEBUG),{top:S,behavior:_}}))),a),{scrollToIndex:p,topListHeight:h}}),Ine(eoe,gie,uie),{singleton:!0});const ioe="up",ooe="down",aoe={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollTop:0,viewportHeight:0,scrollHeight:0}},soe=nie((([{scrollContainerState:e,scrollTop:t,viewportHeight:r,headerHeight:n,footerHeight:i,scrollBy:o}])=>{const a=$ne(!1),s=$ne(!0),l=Lne(),c=Lne(),u=$ne(4),d=$ne(0),f=zne(Une(eie(Une(tie(t),Xne(1),qne(!0)),Une(tie(t),Xne(1),qne(!1),Jne(100))),Wne()),!1),p=zne(Une(eie(Une(o,qne(!0)),Une(o,qne(!1),Jne(200))),Wne()),!1);Fne(Une(rie(tie(t),tie(d)),Kne((([e,t])=>e<=t)),Wne()),s),Fne(Une(s,Zne(50)),c);const h=Bne(Une(rie(e,tie(r),tie(n),tie(i),tie(u)),Yne(((e,[{scrollTop:t,scrollHeight:r},n,i,o,a])=>{const s={viewportHeight:n,scrollTop:t,scrollHeight:r};if(t+n-r>-a){let r,n;return t>e.state.scrollTop?(r="SCROLLED_DOWN",n=e.state.scrollTop-t):(r="SIZE_DECREASED",n=e.state.scrollTop-t||e.scrollTopDelta),{atBottom:!0,state:s,atBottomBecause:r,scrollTopDelta:n}}let l;return l=s.scrollHeight>e.state.scrollHeight?"SIZE_INCREASED":n<e.state.viewportHeight?"VIEWPORT_HEIGHT_DECREASING":t<e.state.scrollTop?"SCROLLING_UPWARDS":"NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:l,state:s}}),aoe),Wne(((e,t)=>e&&e.atBottom===t.atBottom)))),m=zne(Une(e,Yne(((e,{scrollTop:t,scrollHeight:r,viewportHeight:n})=>{if(mie(e.scrollHeight,r))return{scrollTop:t,scrollHeight:r,jump:0,changed:!1};{const i=r-(t+n)<1;return e.scrollTop!==t&&i?{scrollHeight:r,scrollTop:t,jump:e.scrollTop-t,changed:!0}:{scrollHeight:r,scrollTop:t,jump:0,changed:!0}}}),{scrollHeight:0,jump:0,scrollTop:0,changed:!1}),Gne((e=>e.changed)),Kne((e=>e.jump))),0);Fne(Une(h,Kne((e=>e.atBottom))),a),Fne(Une(a,Zne(50)),l);const v=$ne(ooe);Fne(Une(e,Kne((({scrollTop:e})=>e)),Wne(),Yne(((e,t)=>Dne(p)?{direction:e.direction,prevScrollTop:t}:{direction:t<e.prevScrollTop?ioe:ooe,prevScrollTop:t}),{direction:ooe,prevScrollTop:0}),Kne((e=>e.direction))),v),Fne(Une(e,Zne(50),qne("none")),v);const g=$ne(0);return Fne(Une(f,Gne((e=>!e)),qne(0)),g),Fne(Une(t,Zne(100),Qne(f),Gne((([e,t])=>!!t)),Yne((([e,t],[r])=>[t,r]),[0,0]),Kne((([e,t])=>t-e))),g),{isScrolling:f,isAtTop:s,isAtBottom:a,atBottomState:h,atTopStateChange:c,atBottomStateChange:l,scrollDirection:v,atBottomThreshold:u,atTopThreshold:d,scrollVelocity:g,lastJumpDueToItemResize:m}}),Ine(gie)),loe=nie((([{log:e}])=>{const t=$ne(!1),r=Bne(Une(t,Gne((e=>e)),Wne()));return Mne(t,(t=>{t&&Dne(e)("props updated",{},lie.DEBUG)})),{propsReady:t,didMount:r}}),Ine(uie),{singleton:!0});function coe(e,t){0==e?t():requestAnimationFrame((()=>coe(e-1,t)))}function uoe(e,t){const r=t-1;return"number"==typeof e?e:"LAST"===e.index?r:e.index}const doe=nie((([{sizes:e,listRefresh:t,defaultItemSize:r},{scrollTop:n},{scrollToIndex:i},{didMount:o}])=>{const a=$ne(!0),s=$ne(0),l=$ne(!1);return Fne(Une(o,Qne(s),Gne((([e,t])=>!!t)),qne(!1)),a),Mne(Une(rie(t,o),Qne(a,e,r,l),Gne((([[,e],t,{sizeTree:r},n,i])=>e&&(!wie(r)||Ane(n))&&!t&&!i)),Qne(s)),(([,e])=>{Pne(l,!0),coe(3,(()=>{Vne(n,(()=>Pne(a,!0))),Pne(i,e)}))})),{scrolledToInitialItem:a,initialTopMostItemIndex:s}}),Ine(eoe,gie,noe,loe),{singleton:!0});function foe(e){return!!e&&("smooth"===e?"smooth":"auto")}const poe=nie((([{totalCount:e,listRefresh:t},{isAtBottom:r,atBottomState:n},{scrollToIndex:i},{scrolledToInitialItem:o},{propsReady:a,didMount:s},{log:l},{scrollingInProgress:c}])=>{const u=$ne(!1),d=Lne();let f=null;function p(e){Pne(i,{index:"LAST",align:"end",behavior:e})}function h(e){const t=Vne(n,(t=>{e&&!t.atBottom&&"SIZE_INCREASED"===t.notAtBottomBecause&&!f&&(Dne(l)("scrolling to bottom due to increased size",{},lie.DEBUG),p("auto"))}));setTimeout(t,100)}return Mne(Une(rie(Une(tie(e),Xne(1)),s),Qne(tie(u),r,o,c),Kne((([[e,t],r,n,i,o])=>{let a=t&&i,s="auto";return a&&(s=((e,t)=>"function"==typeof e?foe(e(t)):t&&foe(e))(r,n||o),a=a&&!!s),{totalCount:e,shouldFollow:a,followOutputBehavior:s}})),Gne((({shouldFollow:e})=>e))),(({totalCount:e,followOutputBehavior:r})=>{f&&(f(),f=null),f=Vne(t,(()=>{Dne(l)("following output to ",{totalCount:e},lie.DEBUG),p(r),f=null}))})),Mne(Une(rie(tie(u),e,a),Gne((([e,,t])=>e&&t)),Yne((({value:e},[,t])=>({refreshed:e===t,value:t})),{refreshed:!1,value:0}),Gne((({refreshed:e})=>e)),Qne(u,e)),(([,e])=>{h(!1!==e)})),Mne(d,(()=>{h(!1!==Dne(u))})),Mne(rie(tie(u),n),(([e,t])=>{e&&!t.atBottom&&"VIEWPORT_HEIGHT_DECREASING"===t.notAtBottomBecause&&p("auto")})),{followOutput:u,autoscrollToBottom:d}}),Ine(eoe,soe,noe,doe,loe,uie,gie));function hoe(e){return e.reduce(((e,t)=>(e.groupIndices.push(e.totalCount),e.totalCount+=t+1,e)),{totalCount:0,groupIndices:[]})}const moe=nie((([{totalCount:e,groupIndices:t,sizes:r},{scrollTop:n,headerHeight:i}])=>{const o=Lne(),a=Lne(),s=Bne(Une(o,Kne(hoe)));return Fne(Une(s,Kne((e=>e.totalCount))),e),Fne(Une(s,Kne((e=>e.groupIndices))),t),Fne(Une(rie(n,r,i),Gne((([e,t])=>Jie(t))),Kne((([e,t,r])=>xie(t.groupOffsetTree,Math.max(e-r,0),"v")[0])),Wne(),Kne((e=>[e]))),a),{groupCounts:o,topItemsIndexes:a}}),Ine(eoe,gie));function voe(e,t){return!(!e||e[0]!==t[0]||e[1]!==t[1])}function goe(e,t){return!(!e||e.startIndex!==t.startIndex||e.endIndex!==t.endIndex)}const yoe="top",boe="bottom",woe="none";function _oe(e,t,r){return"number"==typeof e?r===ioe&&t===yoe||r===ooe&&t===boe?e:0:r===ioe?t===yoe?e.main:e.reverse:t===boe?e.main:e.reverse}function Coe(e,t){return"number"==typeof e?e:e[t]||0}const Eoe=nie((([{scrollTop:e,viewportHeight:t,deviation:r,headerHeight:n,fixedHeaderHeight:i}])=>{const o=Lne(),a=$ne(0),s=$ne(0),l=$ne(0);return{listBoundary:o,overscan:l,topListHeight:a,increaseViewportBy:s,visibleRange:zne(Une(rie(tie(e),tie(t),tie(n),tie(o,voe),tie(l),tie(a),tie(i),tie(r),tie(s)),Kne((([e,t,r,[n,i],o,a,s,l,c])=>{const u=e-l,d=a+s,f=Math.max(r-u,0);let p=woe;const h=Coe(c,yoe),m=Coe(c,boe);return n-=l,i+=r+s,(n+=r+s)>e+d-h&&(p=ioe),(i-=l)<e-f+t+m&&(p=ooe),p!==woe?[Math.max(u-r-_oe(o,yoe,p)-h,0),u-f-s+t+_oe(o,boe,p)+m]:null})),Gne((e=>null!=e)),Wne(voe)),[0,0])}}),Ine(gie),{singleton:!0});const xoe={items:[],topItems:[],offsetTop:0,offsetBottom:0,top:0,bottom:0,topListHeight:0,totalCount:0,firstItemIndex:0};function Soe(e,t,r){if(0===e.length)return[];if(!Jie(t))return e.map((e=>({...e,index:e.index+r,originalIndex:e.index})));const n=e[0].index,i=e[e.length-1].index,o=[],a=Pie(t.groupOffsetTree,n,i);let s,l=0;for(const n of e){let e;(!s||s.end<n.index)&&(s=a.shift(),l=t.groupIndices.indexOf(s.start)),e=n.index===s.start?{type:"group",index:l}:{index:n.index-(l+1)+r,groupIndex:l},o.push({...e,size:n.size,offset:n.offset,originalIndex:n.index,data:n.data})}return o}function koe(e,t,r,n,i,o){const{lastSize:a,lastOffset:s,lastIndex:l}=i;let c=0,u=0;if(e.length>0){c=e[0].offset;const t=e[e.length-1];u=t.offset+t.size}const d=r-l,f=c,p=s+d*a+(d-1)*n-u;return{items:Soe(e,i,o),topItems:Soe(t,i,o),topListHeight:t.reduce(((e,t)=>t.size+e),0),offsetTop:c,offsetBottom:p,top:f,bottom:u,totalCount:r,firstItemIndex:o}}function Ooe(e,t,r,n,i,o){let a=0;if(r.groupIndices.length>0)for(const t of r.groupIndices){if(t-a>=e)break;a++}const s=e+a,l=uoe(t,s);return koe(Array.from({length:s}).map(((e,t)=>({index:t+l,size:0,offset:0,data:o[t+l]}))),[],s,i,r,n)}const Ioe=nie((([{sizes:e,totalCount:t,data:r,firstItemIndex:n,gap:i},o,{visibleRange:a,listBoundary:s,topListHeight:l},{scrolledToInitialItem:c,initialTopMostItemIndex:u},{topListHeight:d},f,{didMount:p},{recalcInProgress:h}])=>{const m=$ne([]),v=$ne(0),g=Lne();Fne(o.topItemsIndexes,m);const y=zne(Une(rie(p,h,tie(a,voe),tie(t),tie(e),tie(u),c,tie(m),tie(n),tie(i),r),Gne((([e,t,,r,,,,,,,n])=>{const i=n&&n.length!==r;return e&&!t&&!i})),Kne((([,,[e,t],r,n,i,o,a,s,l,c])=>{const u=n,{sizeTree:d,offsetTree:f}=u,p=Dne(v);if(0===r)return{...xoe,totalCount:r};if(0===e&&0===t)return 0===p?{...xoe,totalCount:r}:Ooe(p,i,n,s,l,c||[]);if(wie(d))return p>0?null:koe(function(e,t,r){if(Jie(t)){const n=Zie(e,t);return[{index:xie(t.groupOffsetTree,n)[0],size:0,offset:0},{index:n,size:0,offset:0,data:r&&r[0]}]}return[{index:e,size:0,offset:0,data:r&&r[0]}]}(uoe(i,r),u,c),[],r,l,u,s);const h=[];if(a.length>0){const e=a[0],t=a[a.length-1];let r=0;for(const n of Pie(d,e,t)){const i=n.value,o=Math.max(n.start,e),a=Math.min(n.end,t);for(let e=o;e<=a;e++)h.push({index:e,size:i,offset:r,data:c&&c[e]}),r+=i}}if(!o)return koe([],h,r,l,u,s);const m=a.length>0?a[a.length-1]+1:0,g=Gie(f,e,t,m);if(0===g.length)return null;const y=r-1;return koe(One([],(r=>{for(const n of g){const i=n.value;let o=i.offset,a=n.start;const s=i.size;if(i.offset<e){a+=Math.floor((e-i.offset+l)/(s+l));const t=a-n.start;o+=t*s+t*l}a<m&&(o+=(m-a)*s,a=m);const u=Math.min(n.end,y);for(let e=a;e<=u&&!(o>=t);e++)r.push({index:e,size:s,offset:o,data:c&&c[e]}),o+=s+l}})),h,r,l,u,s)})),Gne((e=>null!==e)),Wne()),xoe);Fne(Une(r,Gne(Ane),Kne((e=>null==e?void 0:e.length))),t),Fne(Une(y,Kne((e=>e.topListHeight))),d),Fne(d,l),Fne(Une(y,Kne((e=>[e.top,e.bottom]))),s),Fne(Une(y,Kne((e=>e.items))),g);return{listState:y,topItemsIndexes:m,endReached:Bne(Une(y,Gne((({items:e})=>e.length>0)),Qne(t,r),Gne((([{items:e},t])=>e[e.length-1].originalIndex===t-1)),Kne((([,e,t])=>[e-1,t])),Wne(voe),Kne((([e])=>e)))),startReached:Bne(Une(y,Zne(200),Gne((({items:e,topItems:t})=>e.length>0&&e[0].originalIndex===t.length)),Kne((({items:e})=>e[0].index)),Wne())),rangeChanged:Bne(Une(y,Gne((({items:e})=>e.length>0)),Kne((({items:e})=>{let t=0,r=e.length-1;for(;"group"===e[t].type&&t<r;)t++;for(;"group"===e[r].type&&r>t;)r--;return{startIndex:e[t].index,endIndex:e[r].index}})),Wne(goe))),itemsRendered:g,initialItemCount:v,...f}}),Ine(eoe,moe,Eoe,doe,noe,soe,loe,$ie),{singleton:!0}),Roe=nie((([{sizes:e,firstItemIndex:t,data:r,gap:n},{initialTopMostItemIndex:i},{initialItemCount:o,listState:a},{didMount:s}])=>(Fne(Une(s,Qne(o),Gne((([,e])=>0!==e)),Qne(i,e,t,n,r),Kne((([[,e],t,r,n,i,o=[]])=>Ooe(e,t,r,n,i,o)))),a),{})),Ine(eoe,doe,Ioe,loe),{singleton:!0}),Toe=nie((([{scrollVelocity:e}])=>{const t=$ne(!1),r=Lne(),n=$ne(!1);return Fne(Une(e,Qne(n,t,r),Gne((([e,t])=>!!t)),Kne((([e,t,r,n])=>{const{exit:i,enter:o}=t;if(r){if(i(e,n))return!1}else if(o(e,n))return!0;return r})),Wne()),t),Mne(Une(rie(t,e,r),Qne(n)),(([[e,t,r],n])=>e&&n&&n.change&&n.change(t,r))),{isSeeking:t,scrollSeekConfiguration:n,scrollVelocity:e,scrollSeekRangeChanged:r}}),Ine(soe),{singleton:!0}),Aoe=nie((([{topItemsIndexes:e}])=>{const t=$ne(0);return Fne(Une(t,Gne((e=>e>0)),Kne((e=>Array.from({length:e}).map(((e,t)=>t))))),e),{topItemCount:t}}),Ine(Ioe)),Noe=nie((([{footerHeight:e,headerHeight:t,fixedHeaderHeight:r,fixedFooterHeight:n},{listState:i}])=>{const o=Lne(),a=zne(Une(rie(e,n,t,r,i),Kne((([e,t,r,n,i])=>e+t+r+n+i.offsetBottom+i.bottom))),0);return Fne(tie(a),o),{totalListHeight:a,totalListHeightChanged:o}}),Ine(gie,Ioe),{singleton:!0});function Moe(e){let t,r=!1;return()=>(r||(r=!0,t=e()),t)}const Poe=Moe((()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent))),joe=nie((([{scrollBy:e,scrollTop:t,deviation:r,scrollingInProgress:n},{isScrolling:i,isAtBottom:o,scrollDirection:a,lastJumpDueToItemResize:s},{listState:l},{beforeUnshiftWith:c,shiftWithOffset:u,sizes:d,gap:f},{log:p},{recalcInProgress:h}])=>{const m=Bne(Une(l,Qne(s),Yne((([,e,t,r],[{items:n,totalCount:i,bottom:o,offsetBottom:a},s])=>{const l=o+a;let c=0;return t===i&&e.length>0&&n.length>0&&(0===n[0].originalIndex&&0===e[0].originalIndex||(c=l-r,0!==c&&(c+=s))),[c,n,i,l]}),[0,[],0,0]),Gne((([e])=>0!==e)),Qne(t,a,n,o,p,h),Gne((([,e,t,r,,,n])=>!n&&!r&&0!==e&&t===ioe)),Kne((([[e],,,,,t])=>(t("Upward scrolling compensation",{amount:e},lie.DEBUG),e)))));function v(t){t>0?(Pne(e,{top:-t,behavior:"auto"}),Pne(r,0)):(Pne(r,0),Pne(e,{top:-t,behavior:"auto"}))}return Mne(Une(m,Qne(r,i)),(([e,t,n])=>{n&&Poe()?Pne(r,t-e):v(-e)})),Mne(Une(rie(zne(i,!1),r,h),Gne((([e,t,r])=>!e&&!r&&0!==t)),Kne((([e,t])=>t)),Zne(1)),v),Fne(Une(u,Kne((e=>({top:-e})))),e),Mne(Une(c,Qne(d,f),Kne((([e,{lastSize:t,groupIndices:r,sizeTree:n},i])=>{function o(e){return e*(t+i)}if(0===r.length)return o(e);{let t=0;const i=Eie(n,0);let a=0,s=0;for(;a<e;){a++,t+=i;let n=r.length===s+1?1/0:r[s+1]-r[s]-1;a+n>e&&(t-=i,n=e-a+1),a+=n,t+=o(n),s++}return t}}))),(t=>{Pne(r,t),requestAnimationFrame((()=>{Pne(e,{top:t}),requestAnimationFrame((()=>{Pne(r,0),Pne(h,!1)}))}))})),{deviation:r}}),Ine(gie,soe,Ioe,eoe,uie,$ie)),Doe=nie((([{didMount:e},{scrollTo:t},{listState:r}])=>{const n=$ne(0);return Mne(Une(e,Qne(n),Gne((([,e])=>0!==e)),Kne((([,e])=>({top:e})))),(e=>{Vne(Une(r,Xne(1),Gne((e=>e.items.length>1))),(()=>{requestAnimationFrame((()=>{Pne(t,e)}))}))})),{initialScrollTop:n}}),Ine(loe,gie,Ioe),{singleton:!0}),Foe=nie((([{viewportHeight:e},{totalListHeight:t}])=>{const r=$ne(!1),n=zne(Une(rie(r,e,t),Gne((([e])=>e)),Kne((([,e,t])=>Math.max(0,e-t))),Zne(0),Wne()),0);return{alignToBottom:r,paddingTopAddition:n}}),Ine(gie,Noe),{singleton:!0}),Voe=nie((([{scrollTo:e,scrollContainerState:t}])=>{const r=Lne(),n=Lne(),i=Lne(),o=$ne(!1),a=$ne(void 0);return Fne(Une(rie(r,n),Kne((([{viewportHeight:e,scrollTop:t,scrollHeight:r},{offsetTop:n}])=>({scrollTop:Math.max(0,t-n),scrollHeight:r,viewportHeight:e})))),t),Fne(Une(e,Qne(n),Kne((([e,{offsetTop:t}])=>({...e,top:e.top+t})))),i),{useWindowScroll:o,customScrollParent:a,windowScrollContainerState:r,windowViewportRect:n,windowScrollTo:i}}),Ine(gie)),Loe=({itemTop:e,itemBottom:t,viewportTop:r,viewportBottom:n,locationParams:{behavior:i,align:o,...a}})=>e<r?{...a,behavior:i,align:null!=o?o:"start"}:t>n?{...a,behavior:i,align:null!=o?o:"end"}:null,$oe=nie((([{sizes:e,totalCount:t,gap:r},{scrollTop:n,viewportHeight:i,headerHeight:o,fixedHeaderHeight:a,fixedFooterHeight:s,scrollingInProgress:l},{scrollToIndex:c}])=>{const u=Lne();return Fne(Une(u,Qne(e,i,t,o,a,s,n),Qne(r),Kne((([[e,t,r,n,i,o,a,s],c])=>{const{done:u,behavior:d,align:f,calculateViewLocation:p=Loe,...h}=e,m=Xie(e,t,n-1),v=Yie(m,t.offsetTree,c)+i+o,g=p({itemTop:v,itemBottom:v+xie(t.sizeTree,m)[1],viewportTop:s+o,viewportBottom:s+r-a,locationParams:{behavior:d,align:f,...h}});return g?u&&Vne(Une(l,Gne((e=>!1===e)),Xne(Dne(l)?1:2)),u):u&&u(),g})),Gne((e=>null!==e))),c),{scrollIntoView:u}}),Ine(eoe,gie,noe,Ioe,uie),{singleton:!0}),Boe=nie((([{sizes:e,sizeRanges:t},{scrollTop:r},{initialTopMostItemIndex:n},{didMount:i},{useWindowScroll:o,windowScrollContainerState:a,windowViewportRect:s}])=>{const l=Lne(),c=$ne(void 0),u=$ne(null),d=$ne(null);return Fne(a,u),Fne(s,d),Mne(Une(l,Qne(e,r,o,u,d)),(([e,t,r,n,i,o])=>{const a=function(e){return Oie(e).map((({k:e,v:t},r,n)=>{const i=n[r+1];return{startIndex:e,endIndex:i?i.k-1:1/0,size:t}}))}(t.sizeTree);n&&null!==i&&null!==o&&(r=i.scrollTop-o.offsetTop),e({ranges:a,scrollTop:r})})),Fne(Une(c,Gne(Ane),Kne(zoe)),n),Fne(Une(i,Qne(c),Gne((([,e])=>void 0!==e)),Wne(),Kne((([,e])=>e.ranges))),t),{getState:l,restoreStateFrom:c}}),Ine(eoe,gie,doe,loe,Voe));function zoe(e){return{offset:e.scrollTop,index:0,align:"start"}}const Uoe=nie((([e,t,r,n,i,o,a,s,l,c])=>({...e,...t,...r,...n,...i,...o,...a,...s,...l,...c})),Ine(Eoe,Roe,loe,Toe,Noe,Doe,Foe,Voe,$oe,uie)),Hoe=nie((([{totalCount:e,sizeRanges:t,fixedItemSize:r,defaultItemSize:n,trackItemSizes:i,itemSize:o,data:a,firstItemIndex:s,groupIndices:l,statefulTotalCount:c,gap:u,sizes:d},{initialTopMostItemIndex:f,scrolledToInitialItem:p},h,m,v,{listState:g,topItemsIndexes:y,...b},{scrollToIndex:w},_,{topItemCount:C},{groupCounts:E},x])=>(Fne(b.rangeChanged,x.scrollSeekRangeChanged),Fne(Une(x.windowViewportRect,Kne((e=>e.visibleHeight))),h.viewportHeight),{totalCount:e,data:a,firstItemIndex:s,sizeRanges:t,initialTopMostItemIndex:f,scrolledToInitialItem:p,topItemsIndexes:y,topItemCount:C,groupCounts:E,fixedItemHeight:r,defaultItemHeight:n,gap:u,...v,statefulTotalCount:c,listState:g,scrollToIndex:w,trackItemSizes:i,itemSize:o,groupIndices:l,...b,...x,...h,sizes:d,...m})),Ine(eoe,doe,gie,Boe,poe,Ioe,noe,joe,Aoe,moe,Uoe)),Woe="-webkit-sticky",Goe="sticky",Koe=Moe((()=>{if(typeof document>"u")return Goe;const e=document.createElement("div");return e.style.position=Woe,e.style.position===Woe?Woe:Goe}));function qoe(e,t){const r=s.a.useRef(null),n=s.a.useCallback((n=>{if(null===n||!n.offsetParent)return;const i=n.getBoundingClientRect(),o=i.width;let a,s;if(t){const e=t.getBoundingClientRect(),r=i.top-e.top;a=e.height-Math.max(0,r),s=r+t.scrollTop}else a=window.innerHeight-Math.max(0,i.top),s=i.top+window.pageYOffset;r.current={offsetTop:s,visibleHeight:a,visibleWidth:o},e(r.current)}),[e,t]),{callbackRef:i,ref:o}=die(n),a=s.a.useCallback((()=>{n(o.current)}),[n,o]);return s.a.useEffect((()=>{if(t){t.addEventListener("scroll",a);const e=new ResizeObserver(a);return e.observe(t),()=>{t.removeEventListener("scroll",a),e.unobserve(t)}}return window.addEventListener("scroll",a),window.addEventListener("resize",a),()=>{window.removeEventListener("scroll",a),window.removeEventListener("resize",a)}}),[a,t]),i}const Yoe=s.a.createContext(void 0),Xoe=s.a.createContext(void 0);function Zoe(e){return e}const Joe=nie((()=>{const e=$ne((e=>`Item ${e}`)),t=$ne(null),r=$ne((e=>`Group ${e}`)),n=$ne({}),i=$ne(Zoe),o=$ne("div"),a=$ne(Nne),s=(e,t=null)=>zne(Une(n,Kne((t=>t[e])),Wne()),t);return{context:t,itemContent:e,groupContent:r,components:n,computeItemKey:i,headerFooterTag:o,scrollerRef:a,FooterComponent:s("Footer"),HeaderComponent:s("Header"),TopItemListComponent:s("TopItemList"),ListComponent:s("List","div"),ItemComponent:s("Item","div"),GroupComponent:s("Group","div"),ScrollerComponent:s("Scroller","div"),EmptyPlaceholder:s("EmptyPlaceholder"),ScrollSeekPlaceholder:s("ScrollSeekPlaceholder")}})),Qoe=nie((([e,t])=>({...e,...t})),Ine(Hoe,Joe)),eae=({height:e})=>s.a.createElement("div",{style:{height:e}}),tae={position:Koe(),zIndex:1,overflowAnchor:"none"},rae={overflowAnchor:"none"},nae=s.a.memo((function({showTopList:e=!1}){const t=yae("listState"),r=gae("sizeRanges"),n=yae("useWindowScroll"),i=yae("customScrollParent"),o=gae("windowScrollContainerState"),a=gae("scrollContainerState"),l=i||n?o:a,c=yae("itemContent"),u=yae("context"),d=yae("groupContent"),f=yae("trackItemSizes"),p=yae("itemSize"),h=yae("log"),m=gae("gap"),{callbackRef:v}=pie(r,p,f,e?Nne:l,h,m,i),[g,y]=s.a.useState(0);bae("deviation",(e=>{g!==e&&y(e)}));const b=yae("EmptyPlaceholder"),w=yae("ScrollSeekPlaceholder")||eae,_=yae("ListComponent"),C=yae("ItemComponent"),E=yae("GroupComponent"),x=yae("computeItemKey"),S=yae("isSeeking"),k=yae("groupIndices").length>0,O=yae("paddingTopAddition"),I=yae("scrolledToInitialItem"),R=e?{}:{boxSizing:"border-box",paddingTop:t.offsetTop+O,paddingBottom:t.offsetBottom,marginTop:g,...I?{}:{visibility:"hidden"}};return!e&&0===t.totalCount&&b?s.a.createElement(b,sae(b,u)):s.a.createElement(_,{...sae(_,u),ref:v,style:R,"data-test-id":e?"virtuoso-top-item-list":"virtuoso-item-list"},(e?t.topItems:t.items).map((e=>{const r=e.originalIndex,n=x(r+t.firstItemIndex,e.data,u);return S?s.a.createElement(w,{...sae(w,u),key:n,index:e.index,height:e.size,type:e.type||"item",..."group"===e.type?{}:{groupIndex:e.groupIndex}}):"group"===e.type?s.a.createElement(E,{...sae(E,u),key:n,"data-index":r,"data-known-size":e.size,"data-item-index":e.index,style:tae},d(e.index,u)):s.a.createElement(C,{...sae(C,u),key:n,"data-index":r,"data-known-size":e.size,"data-item-index":e.index,"data-item-group-index":e.groupIndex,item:e.data,style:rae},k?c(e.index,e.groupIndex,e.data,u):c(e.index,e.data,u))})))})),iae={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},oae={width:"100%",height:"100%",position:"absolute",top:0},aae={width:"100%",position:Koe(),top:0,zIndex:1};function sae(e,t){if("string"!=typeof e)return{context:t}}const lae=s.a.memo((function(){const e=yae("HeaderComponent"),t=gae("headerHeight"),r=yae("headerFooterTag"),n=fie((e=>t(hie(e,"height")))),i=yae("context");return e?s.a.createElement(r,{ref:n},s.a.createElement(e,sae(e,i))):null})),cae=s.a.memo((function(){const e=yae("FooterComponent"),t=gae("footerHeight"),r=yae("headerFooterTag"),n=fie((e=>t(hie(e,"height")))),i=yae("context");return e?s.a.createElement(r,{ref:n},s.a.createElement(e,sae(e,i))):null}));function uae({usePublisher:e,useEmitter:t,useEmitterValue:r}){return s.a.memo((function({style:n,children:i,...o}){const a=e("scrollContainerState"),l=r("ScrollerComponent"),c=e("smoothScrollTargetReached"),u=r("scrollerRef"),d=r("context"),{scrollerRef:f,scrollByCallback:p,scrollToCallback:h}=vie(a,c,l,u);return t("scrollTo",h),t("scrollBy",p),s.a.createElement(l,{ref:f,style:{...iae,...n},"data-test-id":"virtuoso-scroller","data-virtuoso-scroller":!0,tabIndex:0,...o,...sae(l,d)},i)}))}function dae({usePublisher:e,useEmitter:t,useEmitterValue:r}){return s.a.memo((function({style:n,children:i,...o}){const a=e("windowScrollContainerState"),l=r("ScrollerComponent"),c=e("smoothScrollTargetReached"),u=r("totalListHeight"),d=r("deviation"),f=r("customScrollParent"),p=r("context"),{scrollerRef:h,scrollByCallback:m,scrollToCallback:v}=vie(a,c,l,Nne,f);return sie((()=>(h.current=f||window,()=>{h.current=null})),[h,f]),t("windowScrollTo",v),t("scrollBy",m),s.a.createElement(l,{style:{position:"relative",...n,...0!==u?{height:u+d}:{}},"data-virtuoso-scroller":!0,...o,...sae(l,p)},i)}))}const fae=({children:e})=>{const t=s.a.useContext(Yoe),r=gae("viewportHeight"),n=gae("fixedItemHeight"),i=fie(Ene(r,(e=>hie(e,"height"))));return s.a.useEffect((()=>{t&&(r(t.viewportHeight),n(t.itemHeight))}),[t,r,n]),s.a.createElement("div",{style:oae,ref:i,"data-viewport-type":"element"},e)},pae=({children:e})=>{const t=s.a.useContext(Yoe),r=gae("windowViewportRect"),n=gae("fixedItemHeight"),i=yae("customScrollParent"),o=qoe(r,i);return s.a.useEffect((()=>{t&&(n(t.itemHeight),r({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:100}))}),[t,r,n]),s.a.createElement("div",{ref:o,style:oae,"data-viewport-type":"window"},e)},hae=({children:e})=>{const t=yae("TopItemListComponent"),r=yae("headerHeight"),n={...aae,marginTop:`${r}px`},i=yae("context");return s.a.createElement(t||"div",{style:n,context:i},e)},mae=s.a.memo((function(e){const t=yae("useWindowScroll"),r=yae("topItemsIndexes").length>0,n=yae("customScrollParent"),i=n||t?_ae:wae,o=n||t?pae:fae;return s.a.createElement(i,{...e},r&&s.a.createElement(hae,null,s.a.createElement(nae,{showTopList:!0})),s.a.createElement(o,null,s.a.createElement(lae,null),s.a.createElement(nae,null),s.a.createElement(cae,null)))})),{Component:vae,usePublisher:gae,useEmitterValue:yae,useEmitter:bae}=aie(Qoe,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},mae),wae=uae({usePublisher:gae,useEmitterValue:yae,useEmitter:bae}),_ae=dae({usePublisher:gae,useEmitterValue:yae,useEmitter:bae}),Cae=vae,Eae={items:[],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},xae={items:[{index:0}],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},{round:Sae,ceil:kae,floor:Oae,min:Iae,max:Rae}=Math;function Tae(e,t,r){return Array.from({length:t-e+1}).map(((t,n)=>{const i=null===r?null:r[n+e];return{index:n+e,data:i}}))}function Aae(e,t){return e&&e.column===t.column&&e.row===t.row}function Nae(e,t){return e&&e.width===t.width&&e.height===t.height}const Mae=nie((([{overscan:e,visibleRange:t,listBoundary:r},{scrollTop:n,viewportHeight:i,scrollBy:o,scrollTo:a,smoothScrollTargetReached:s,scrollContainerState:l,footerHeight:c,headerHeight:u},d,f,{propsReady:p,didMount:h},{windowViewportRect:m,useWindowScroll:v,customScrollParent:g,windowScrollContainerState:y,windowScrollTo:b},w])=>{const _=$ne(0),C=$ne(0),E=$ne(Eae),x=$ne({height:0,width:0}),S=$ne({height:0,width:0}),k=Lne(),O=Lne(),I=$ne(0),R=$ne(null),T=$ne({row:0,column:0}),A=Lne(),N=Lne(),M=$ne(!1),P=$ne(0),j=$ne(!0),D=$ne(!1);Mne(Une(h,Qne(P),Gne((([e,t])=>!!t))),(()=>{Pne(j,!1),Pne(C,0)})),Mne(Une(rie(h,j,S,x,P,D),Gne((([e,t,r,n,,i])=>e&&!t&&0!==r.height&&0!==n.height&&!i))),(([,,,,e])=>{Pne(D,!0),coe(1,(()=>{Pne(k,e)})),Vne(Une(n),(()=>{Pne(r,[0,0]),Pne(j,!0)}))})),Fne(Une(N,Gne((e=>null!=e&&e.scrollTop>0)),qne(0)),C),Mne(Une(h,Qne(N),Gne((([,e])=>null!=e))),(([,e])=>{!e||(Pne(x,e.viewport),Pne(S,null==e?void 0:e.item),Pne(T,e.gap),e.scrollTop>0&&(Pne(M,!0),Vne(Une(n,Xne(1)),(e=>{Pne(M,!1)})),Pne(a,{top:e.scrollTop})))})),Fne(Une(x,Kne((({height:e})=>e))),i),Fne(Une(rie(tie(x,Nae),tie(S,Nae),tie(T,((e,t)=>e&&e.column===t.column&&e.row===t.row)),tie(n)),Kne((([e,t,r,n])=>({viewport:e,item:t,gap:r,scrollTop:n})))),A),Fne(Une(rie(tie(_),t,tie(T,Aae),tie(S,Nae),tie(x,Nae),tie(R),tie(C),tie(M),tie(j),tie(P)),Gne((([,,,,,,,e])=>!e)),Kne((([e,[t,r],n,i,o,a,s,,l,c])=>{const{row:u,column:d}=n,{height:f,width:p}=i,{width:h}=o;if(0===s&&(0===e||0===h))return Eae;if(0===p){const t=uoe(c,e);return function(e){return{...xae,items:e}}(Tae(t,0===t?Math.max(s-1,0):t,a))}const m=Dae(h,p,d);let v,g;l?0===t&&0===r&&s>0?(v=0,g=s-1):(v=m*Oae((t+u)/(f+u)),g=m*kae((r+u)/(f+u))-1,g=Iae(e-1,Rae(g,m-1)),v=Iae(g,Rae(0,v))):(v=0,g=-1);const y=Tae(v,g,a),{top:b,bottom:w}=Pae(o,n,i,y),_=kae(e/m);return{items:y,offsetTop:b,offsetBottom:_*f+(_-1)*u-w,top:b,bottom:w,itemHeight:f,itemWidth:p}}))),E),Fne(Une(R,Gne((e=>null!==e)),Kne((e=>e.length))),_),Fne(Une(rie(x,S,E,T),Gne((([e,t,{items:r}])=>r.length>0&&0!==t.height&&0!==e.height)),Kne((([e,t,{items:r},n])=>{const{top:i,bottom:o}=Pae(e,n,t,r);return[i,o]})),Wne(voe)),r);const F=$ne(!1);Fne(Une(n,Qne(F),Kne((([e,t])=>t||0!==e))),F);const V=Bne(Une(tie(E),Gne((({items:e})=>e.length>0)),Qne(_,F),Gne((([{items:e},t,r])=>r&&e[e.length-1].index===t-1)),Kne((([,e])=>e-1)),Wne())),L=Bne(Une(tie(E),Gne((({items:e})=>e.length>0&&0===e[0].index)),qne(0),Wne())),$=Bne(Une(tie(E),Qne(M),Gne((([{items:e},t])=>e.length>0&&!t)),Kne((([{items:e}])=>({startIndex:e[0].index,endIndex:e[e.length-1].index}))),Wne(goe),Zne(0)));Fne($,f.scrollSeekRangeChanged),Fne(Une(k,Qne(x,S,_,T),Kne((([e,t,r,n,i])=>{const o=roe(e),{align:a,behavior:s,offset:l}=o;let c=o.index;"LAST"===c&&(c=n-1),c=Rae(0,c,Iae(n-1,c));let u=jae(t,i,r,c);return"end"===a?u=Sae(u-t.height+r.height):"center"===a&&(u=Sae(u-t.height/2+r.height/2)),l&&(u+=l),{top:u,behavior:s}}))),a);const B=zne(Une(E,Kne((e=>e.offsetBottom+e.bottom))),0);return Fne(Une(m,Kne((e=>({width:e.visibleWidth,height:e.visibleHeight})))),x),{data:R,totalCount:_,viewportDimensions:x,itemDimensions:S,scrollTop:n,scrollHeight:O,overscan:e,scrollBy:o,scrollTo:a,scrollToIndex:k,smoothScrollTargetReached:s,windowViewportRect:m,windowScrollTo:b,useWindowScroll:v,customScrollParent:g,windowScrollContainerState:y,deviation:I,scrollContainerState:l,footerHeight:c,headerHeight:u,initialItemCount:C,gap:T,restoreStateFrom:N,...f,initialTopMostItemIndex:P,gridState:E,totalListHeight:B,...d,startReached:L,endReached:V,rangeChanged:$,stateChanged:A,propsReady:p,stateRestoreInProgress:M,...w}}),Ine(Eoe,gie,soe,Toe,loe,Voe,uie));function Pae(e,t,r,n){const{height:i}=r;if(void 0===i||0===n.length)return{top:0,bottom:0};return{top:jae(e,t,r,n[0].index),bottom:jae(e,t,r,n[n.length-1].index)+i}}function jae(e,t,r,n){const i=Dae(e.width,r.width,t.column),o=Oae(n/i),a=o*r.height+Rae(0,o-1)*t.row;return a>0?a+t.row:a}function Dae(e,t,r){return Rae(1,Oae((e+r)/(Oae(t)+r)))}const Fae=nie((()=>{const e=$ne((e=>`Item ${e}`)),t=$ne({}),r=$ne(null),n=$ne("virtuoso-grid-item"),i=$ne("virtuoso-grid-list"),o=$ne(Zoe),a=$ne("div"),s=$ne(Nne),l=(e,r=null)=>zne(Une(t,Kne((t=>t[e])),Wne()),r);return{context:r,itemContent:e,components:t,computeItemKey:o,itemClassName:n,listClassName:i,headerFooterTag:a,scrollerRef:s,FooterComponent:l("Footer"),HeaderComponent:l("Header"),ListComponent:l("List","div"),ItemComponent:l("Item","div"),ScrollerComponent:l("Scroller","div"),ScrollSeekPlaceholder:l("ScrollSeekPlaceholder","div")}})),Vae=nie((([e,t])=>({...e,...t})),Ine(Mae,Fae)),Lae=s.a.memo((function(){const e=Kae("gridState"),t=Kae("listClassName"),r=Kae("itemClassName"),n=Kae("itemContent"),i=Kae("computeItemKey"),o=Kae("isSeeking"),a=Gae("scrollHeight"),l=Kae("ItemComponent"),c=Kae("ListComponent"),u=Kae("ScrollSeekPlaceholder"),d=Kae("context"),f=Gae("itemDimensions"),p=Gae("gap"),h=Kae("log"),m=Kae("stateRestoreInProgress"),v=fie((e=>{const t=e.parentElement.parentElement.scrollHeight;a(t);const r=e.firstChild;if(r){const{width:e,height:t}=r.getBoundingClientRect();f({width:e,height:t})}p({row:Zae("row-gap",getComputedStyle(e).rowGap,h),column:Zae("column-gap",getComputedStyle(e).columnGap,h)})}));return m?null:s.a.createElement(c,{ref:v,className:t,...sae(c,d),style:{paddingTop:e.offsetTop,paddingBottom:e.offsetBottom},"data-test-id":"virtuoso-item-list"},e.items.map((t=>{const a=i(t.index,t.data,d);return o?s.a.createElement(u,{key:a,...sae(u,d),index:t.index,height:e.itemHeight,width:e.itemWidth}):s.a.createElement(l,{...sae(l,d),className:r,"data-index":t.index,key:a},n(t.index,t.data,d))})))})),$ae=s.a.memo((function(){const e=Kae("HeaderComponent"),t=Gae("headerHeight"),r=Kae("headerFooterTag"),n=fie((e=>t(hie(e,"height")))),i=Kae("context");return e?s.a.createElement(r,{ref:n},s.a.createElement(e,sae(e,i))):null})),Bae=s.a.memo((function(){const e=Kae("FooterComponent"),t=Gae("footerHeight"),r=Kae("headerFooterTag"),n=fie((e=>t(hie(e,"height")))),i=Kae("context");return e?s.a.createElement(r,{ref:n},s.a.createElement(e,sae(e,i))):null})),zae=({children:e})=>{const t=s.a.useContext(Xoe),r=Gae("itemDimensions"),n=Gae("viewportDimensions"),i=fie((e=>{n(e.getBoundingClientRect())}));return s.a.useEffect((()=>{t&&(n({height:t.viewportHeight,width:t.viewportWidth}),r({height:t.itemHeight,width:t.itemWidth}))}),[t,n,r]),s.a.createElement("div",{style:oae,ref:i},e)},Uae=({children:e})=>{const t=s.a.useContext(Xoe),r=Gae("windowViewportRect"),n=Gae("itemDimensions"),i=Kae("customScrollParent"),o=qoe(r,i);return s.a.useEffect((()=>{t&&(n({height:t.itemHeight,width:t.itemWidth}),r({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:t.viewportWidth}))}),[t,r,n]),s.a.createElement("div",{ref:o,style:oae},e)},Hae=s.a.memo((function({...e}){const t=Kae("useWindowScroll"),r=Kae("customScrollParent"),n=r||t?Xae:Yae,i=r||t?Uae:zae;return s.a.createElement(n,{...e},s.a.createElement(i,null,s.a.createElement($ae,null),s.a.createElement(Lae,null),s.a.createElement(Bae,null)))})),{Component:Wae,usePublisher:Gae,useEmitterValue:Kae,useEmitter:qae}=aie(Vae,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged"}},Hae),Yae=uae({usePublisher:Gae,useEmitterValue:Kae,useEmitter:qae}),Xae=dae({usePublisher:Gae,useEmitterValue:Kae,useEmitter:qae});function Zae(e,t,r){return"normal"!==t&&!(null!=t&&t.endsWith("px"))&&r(`${e} was not resolved to pixel value correctly`,t,lie.WARN),"normal"===t?0:parseInt(null!=t?t:"0",10)}const Jae=Wae,Qae=nie((()=>{const e=$ne((e=>s.a.createElement("td",null,"Item $",e))),t=$ne(null),r=$ne(null),n=$ne(null),i=$ne({}),o=$ne(Zoe),a=$ne(Nne),l=(e,t=null)=>zne(Une(i,Kne((t=>t[e])),Wne()),t);return{context:t,itemContent:e,fixedHeaderContent:r,fixedFooterContent:n,components:i,computeItemKey:o,scrollerRef:a,TableComponent:l("Table","table"),TableHeadComponent:l("TableHead","thead"),TableFooterComponent:l("TableFoot","tfoot"),TableBodyComponent:l("TableBody","tbody"),TableRowComponent:l("TableRow","tr"),ScrollerComponent:l("Scroller","div"),EmptyPlaceholder:l("EmptyPlaceholder"),ScrollSeekPlaceholder:l("ScrollSeekPlaceholder"),FillerRow:l("FillerRow")}})),ese=nie((([e,t])=>({...e,...t})),Ine(Hoe,Qae)),tse=({height:e})=>s.a.createElement("tr",null,s.a.createElement("td",{style:{height:e}})),rse=({height:e})=>s.a.createElement("tr",null,s.a.createElement("td",{style:{height:e,padding:0,border:0}})),nse={overflowAnchor:"none"},ise=s.a.memo((function(){const e=use("listState"),t=cse("sizeRanges"),r=use("useWindowScroll"),n=use("customScrollParent"),i=cse("windowScrollContainerState"),o=cse("scrollContainerState"),a=n||r?i:o,l=use("itemContent"),c=use("trackItemSizes"),u=use("itemSize"),d=use("log"),{callbackRef:f,ref:p}=pie(t,u,c,a,d,void 0,n),[h,m]=s.a.useState(0);dse("deviation",(e=>{h!==e&&(p.current.style.marginTop=`${e}px`,m(e))}));const v=use("EmptyPlaceholder"),g=use("ScrollSeekPlaceholder")||tse,y=use("FillerRow")||rse,b=use("TableBodyComponent"),w=use("TableRowComponent"),_=use("computeItemKey"),C=use("isSeeking"),E=use("paddingTopAddition"),x=use("firstItemIndex"),S=use("statefulTotalCount"),k=use("context");if(0===S&&v)return s.a.createElement(v,sae(v,k));const O=e.offsetTop+E+h,I=e.offsetBottom,R=O>0?s.a.createElement(y,{height:O,key:"padding-top",context:k}):null,T=I>0?s.a.createElement(y,{height:I,key:"padding-bottom",context:k}):null,A=e.items.map((e=>{const t=e.originalIndex,r=_(t+x,e.data,k);return C?s.a.createElement(g,{...sae(g,k),key:r,index:e.index,height:e.size,type:e.type||"item"}):s.a.createElement(w,{...sae(w,k),key:r,"data-index":t,"data-known-size":e.size,"data-item-index":e.index,item:e.data,style:nse},l(e.index,e.data,k))}));return s.a.createElement(b,{ref:f,"data-test-id":"virtuoso-item-list",...sae(b,k)},[R,...A,T])})),ose=({children:e})=>{const t=s.a.useContext(Yoe),r=cse("viewportHeight"),n=cse("fixedItemHeight"),i=fie(Ene(r,(e=>hie(e,"height"))));return s.a.useEffect((()=>{t&&(r(t.viewportHeight),n(t.itemHeight))}),[t,r,n]),s.a.createElement("div",{style:oae,ref:i,"data-viewport-type":"element"},e)},ase=({children:e})=>{const t=s.a.useContext(Yoe),r=cse("windowViewportRect"),n=cse("fixedItemHeight"),i=use("customScrollParent"),o=qoe(r,i);return s.a.useEffect((()=>{t&&(n(t.itemHeight),r({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:100}))}),[t,r,n]),s.a.createElement("div",{ref:o,style:oae,"data-viewport-type":"window"},e)},sse=s.a.memo((function(e){const t=use("useWindowScroll"),r=use("customScrollParent"),n=cse("fixedHeaderHeight"),i=cse("fixedFooterHeight"),o=use("fixedHeaderContent"),a=use("fixedFooterContent"),l=use("context"),c=fie(Ene(n,(e=>hie(e,"height")))),u=fie(Ene(i,(e=>hie(e,"height")))),d=r||t?pse:fse,f=r||t?ase:ose,p=use("TableComponent"),h=use("TableHeadComponent"),m=use("TableFooterComponent"),v=o?s.a.createElement(h,{key:"TableHead",style:{zIndex:2,position:"sticky",top:0},ref:c,...sae(h,l)},o()):null,g=a?s.a.createElement(m,{key:"TableFoot",style:{zIndex:1,position:"sticky",bottom:0},ref:u,...sae(m,l)},a()):null;return s.a.createElement(d,{...e},s.a.createElement(f,null,s.a.createElement(p,{style:{borderSpacing:0,overflowAnchor:"none"},...sae(p,l)},[v,s.a.createElement(ise,{key:"TableBody"}),g])))})),{Component:lse,usePublisher:cse,useEmitterValue:use,useEmitter:dse}=aie(ese,{required:{},optional:{context:"context",followOutput:"followOutput",firstItemIndex:"firstItemIndex",itemContent:"itemContent",fixedHeaderContent:"fixedHeaderContent",fixedFooterContent:"fixedFooterContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",topItemCount:"topItemCount",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",groupCounts:"groupCounts",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},sse),fse=uae({usePublisher:cse,useEmitterValue:use,useEmitter:dse}),pse=dae({usePublisher:cse,useEmitterValue:use,useEmitter:dse}),hse=lse,mse=({isFolding:e,onFold:t})=>s.a.createElement("span",{className:"lakex-viewer-grid-group-fold"},s.a.createElement(YP,{type:"ReviewArrowDown",size:16,onClick:()=>{t&&t(!e)}}));var vse=Object.defineProperty,gse=Object.getOwnPropertyDescriptor,yse=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?gse(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&vse(t,r,o),o};let bse=class extends Zf{constructor(){super(...arguments),this.groupFolding=new Set,this._onGroupFoldingChange=this._register(new op),this.onGroupFoldingChange=this._onGroupFoldingChange.event}get FoldIcon(){return mse}setGroupFolding(e,t){t?this.groupFolding.add(e):this.groupFolding.delete(e),this._onGroupFoldingChange.emit(new Set(this.groupFolding))}clearGroupFolding(){this.groupFolding=new Set,this._onGroupFoldingChange.emit(new Set(this.groupFolding))}destroy(){super.destroy()}};function wse(e){const t=zA(Yte),[r,n]=Object(a.useState)(!1),[i,o]=Object(a.useState)(null);return Object(a.useEffect)((()=>{const r=null==t?void 0:t.onRefreshTooltipChange((({recordId:t,desc:r})=>{if(!t)return n(!1),void o(null);n(e===t),o(r)}));return()=>{null==r||r.destroy()}}),[t]),{isInRefresh:r,refreshDesc:i}}yse([Si()],bse.prototype,"destroy",1),bse=yse([eo()],bse);const _se=({record:e})=>{const{isInRefresh:t,refreshDesc:r}=wse(e.record_uuid);return t?s.a.createElement("div",{className:"lakex-viewer-grid-row-tooltip"},null==r?void 0:r.text,s.a.createElement(h.a,{placement:"top",title:null==r?void 0:r.ps},s.a.createElement("div",{className:"lakex-viewer-grid-row-tooltip-icon"},s.a.createElement(YP,{type:"Question",size:16})))):null},Cse=({index:e,record:t,viewRecords:r,viewFields:n,viewConfig:i,sticky:o=!0,hasBlank:l=!1,isDragging:c=!1,isGroupLast:u=!1,disableDrag:d=!1,listeners:f})=>{const p=zA(g3),h=n3(),{Record:m}=p,v=Object(a.useMemo)((()=>{const t=null==h?void 0:h.getRangeAt(0);return(null==t?void 0:t.start.row)===e}),[h]),g=Object(a.useMemo)((()=>{if(!h)return!1;const{anchor:e,focus:t}=h;return v&&e.row===t.row&&e.column===t.column}),[h,v]);return f?s.a.createElement("div",{className:GA("lakex-viewer-grid-row-container",{"is-dragging":c,sticky:o,normal:!o,"group-last":u,selected:v,"is-select-one":g})},o&&s.a.createElement(_se,{record:t}),m&&s.a.createElement(m,{index:e,record:t,records:r,fields:n,config:i,sticky:o,hasBlank:l,disableDrag:d,listeners:f})):s.a.createElement("div",{className:GA("lakex-viewer-grid-row-container",{sticky:o,normal:!o,"group-last":u,"is-select-one":g})},o&&s.a.createElement(_se,{record:t}),m&&s.a.createElement(m,{index:e,record:t,records:r,fields:n,config:i,sticky:o,hasBlank:l,disableDrag:d}))},Ese=Fi.defineToken("ContextMenuContribution");var xse=Object.defineProperty,Sse=Object.getOwnPropertyDescriptor,kse=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Sse(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&xse(t,r,o),o};let Ose=class{constructor(){this._items=new Map,this.isInit=!1}init(){var e;if(this.isInit)return;this.isInit=!0;const t=this.toolbarPluginProvider.getContributions();for(const r of t)try{null==(e=r.registerContextMenu)||e.call(r,this)}catch(e){console.error(e)}}registerItem(e){const{key:t}=e;if(this._items.has(t))throw new Error(`A contextmenu item is already registered with the '${t}'`);return this._items.set(t,e),e}getContextMenuItem(e){return"|"===e?e:this._items.get(e)}unregisterItem(e){const t="string"==typeof e?e:e.key;this.getContextMenuItem(t)&&this._items.delete(t)}get hasContextMenu(){return this._items.size>0}};kse([Eo(Ese)],Ose.prototype,"toolbarPluginProvider",2),Ose=kse([eo()],Ose);var Ise=Object.defineProperty,Rse=Object.getOwnPropertyDescriptor,Tse=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Rse(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ise(t,r,o),o};let Ase=class{getMenuItems(e){const t=(this._configurationService.getValue("contextMenu")||[]).map((e=>this._contextMenuRegistry.getContextMenuItem(e))).filter((e=>void 0!==e));return this.cleanMenuItems(t,e)}cleanMenuItems(e,t){const r=[];return e.forEach((e=>{if("|"===e){const t=r[r.length-1];(!t||"|"===t)&&r.pop(),r.push(e)}else{if(null==e.visible&&(e.visible=!0),!(es(e.visible)?e.visible(t):e.visible))return;r.push({...e,name:es(e.name)?e.name(t):e.name})}})),"|"===r[r.length-1]&&r.pop(),"|"===r[0]&&r.shift(),r}};Tse([to(qf)],Ase.prototype,"_configurationService",2),Tse([to(Ose)],Ase.prototype,"_contextMenuRegistry",2),Ase=Tse([eo()],Ase);class Nse extends SM{}Nse.activators=[{eventName:"onPointerDown",handler:({nativeEvent:e})=>function(e){return!(e.dataset&&e.dataset.noDnd)}(e.target)}];const Mse=({viewRecords:e=[],viewFields:t=[],group:r,filters:n,viewField:i,index:o,size:l,rootHeight:c})=>{var u,d;const f=s0(Nw.TABLE).canUpdate(),p=zA(e3),h=zA(_3),m=zA(ire),v=zA(tD),g=zA(Zj),{attributes:y,listeners:b,setNodeRef:w,over:_,active:C}=zP({id:i.uuid,disabled:!f}),[E,x]=Object(a.useState)(!1),S=s0(Nw.FIELD),k=i.field,O=Object(a.useMemo)((()=>n.find((e=>e.field_uuid===(null==k?void 0:k.uuid)))),[n,k]),I=({type:e})=>{const t=v.getFieldIcon(e);return t?s.a.createElement(t,{size:16}):null},R=({type:e})=>{const t=v.getFieldTagComponent(e);return t&&k?s.a.createElement(t,{field:k,position:"gridHeader"}):null},T=Object(a.useCallback)((()=>{if(!p)return;const n=r?e.map((e=>{var t;return(null==(t=e.records)?void 0:t.length)||0})).reduce(((e,t)=>e+t),0):e.length,i=p.createColumnGridSelectionByIndex(o,n,t.length);p.setSelection(i)}),[o,e,t,r]),A=mV(((e,t)=>{!S.canUpdate(t)||null==g||g.emitClickEvent({eventName:"gridHeader:doubleClick",data:{fieldId:t.uuid,event:e}})})),N=Object(a.useCallback)((({e:e,fieldId:t})=>{e.preventDefault(),e.stopPropagation(),T(),null==m||m.showContextMenu({e:e,from:nre.HEADER,fieldId:t})}),[o,e,t,r]);if(Object(a.useEffect)((()=>{if(E){const e=dA(window,"mousemove",function(e,t,r){var n=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return Va(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),RA(e,t,{leading:n,maxWait:t,trailing:i})}((e=>{h.emitResizing(e)}),16)),t=dA(window,"mouseup",(t=>{h.emitResizeEnd(t),x(!1),e.destroy()}));return()=>{e.destroy(),t.destroy()}}}),[E]),!k||!v.getFieldTargetPlugin(k.type))return null;const M=null==(u=null==C?void 0:C.data.current)?void 0:u.sortable.index,P=null==(d=null==_?void 0:_.data.current)?void 0:d.sortable.index;return s.a.createElement("div",{ref:w,className:GA("lakex-viewer-grid-header-column",{"in-filter":O}),"data-col-index":o,"data-field-id":k.uuid,style:{width:(l||h.defaultColWidth)+"px"},onClick:e=>T(),onContextMenu:e=>N({e:e,fieldId:k.uuid}),onDoubleClick:e=>A(e,k)},s.a.createElement("div",{className:"lakex-viewer-grid-header-column-content",...b,...y},s.a.createElement("div",{className:"lakex-viewer-grid-header-column-icon"},s.a.createElement(I,{type:k.type})),s.a.createElement("div",{className:"lakex-viewer-grid-header-column-name"},k.name),s.a.createElement(R,{type:k.type})),s.a.createElement("div",{className:"lakex-viewer-grid-header-column-dropdown",onClick:e=>N({e:e,fieldId:k.uuid})},s.a.createElement(YP,{type:"ReviewArrowDown",size:16})),s.a.createElement("div",{className:"lakex-viewer-grid-header-column-resizer",onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),h.emitResizeStart(e,t,o),x(!0)}}),(null==_?void 0:_.id)===i.uuid&&(null==_?void 0:_.id)!==(null==C?void 0:C.id)&&s.a.createElement("div",{className:GA("lakex-viewer-grid-dragger-line",{left:M>P,right:M<P}),style:{height:c}}))},Pse=({viewRecords:e,viewFields:t,group:r,filters:n,sticky:i,stickyColNum:o,rootHeight:a,hasBlank:l=!1})=>{const c=zA(g3).AddField,u=i?t.slice(0,o):t.slice(o);return s.a.createElement("div",{className:"lakex-viewer-grid-header-row"},i&&s.a.createElement("div",{className:"lakex-viewer-grid-header-index"}),null==u?void 0:u.map(((l,c)=>{const u=c+(i?0:o);return s.a.createElement(Mse,{key:l.uuid,viewFields:t,viewRecords:e,group:r,filters:n,viewField:l,index:u,size:l.size,rootHeight:a})})),l&&c&&s.a.createElement(c,null))},jse=({fieldGroups:e,viewFields:t,sticky:r,stickyColNum:n})=>{const i=zA(_3),o=zA(ire),l=zA(mne,{optional:!0}),c=Object(a.useMemo)((()=>r?t.slice(0,n):t.slice(n)),[t,r,n]),d=Object(a.useMemo)((()=>{const t={};return e.forEach((e=>{t[e.uuid]=e})),t}),[e]),[f,p]=Object(a.useState)(""),[h,m]=Object(a.useState)(""),v=Object(a.useRef)(null),g=Object(a.useCallback)((({e:e,fieldGroupId:t})=>{e.preventDefault(),e.stopPropagation(),null==o||o.showContextMenu({e:e,fieldGroupId:t,from:nre.GROUP_HEADER})}),[]),y=Object(a.useCallback)((e=>{null==l||l.updateFieldGroupName(f,h),p(""),m("")}),[f,h]);return Object(a.useEffect)((()=>{const e=null==l?void 0:l.onEditGroupName((({fieldGroupId:e})=>{const t=d[e];p(e),m(t.name)}));return()=>{null==e||e.destroy()}}),[d]),Object(a.useEffect)((()=>{var e;""!==f&&(null==(e=v.current)||e.focus())}),[f]),0===e.length?null:s.a.createElement("div",{className:"lakex-viewer-grid-header-group-row"},c.map(((e,t)=>{var n,o,a;const l=e.group_uuid&&d[e.group_uuid];if(l&&(null==(n=c[t-1])||!n.group_uuid||(null==(o=c[t-1])?void 0:o.group_uuid)!==e.group_uuid)){const n=[e];for(let r=t;r<c.length&&l&&(null==(a=c[r+1])?void 0:a.group_uuid)===e.group_uuid;r++)n.push(c[r+1]);const o=n.map((e=>e.size||i.defaultColWidth)).reduce(((e,t)=>e+t),0),b=r?i.indexColWidth:0;return s.a.createElement("div",{key:((null==e?void 0:e.group_uuid)||"")+t,className:"lakex-viewer-grid-header-group-column",style:{width:o+b+"px"},onDoubleClick:()=>{const t=e.group_uuid&&d[e.group_uuid];p(e.group_uuid||""),m(t.name)},onContextMenu:t=>g({e:t,fieldGroupId:e.group_uuid})},f===e.group_uuid?s.a.createElement(u.a,{ref:v,value:h,autoComplete:"off",onChange:e=>{const t=e.target.value;m(t)},onMouseDown:mA,onMouseMove:mA,onMouseUp:mA,onBlur:y,onKeyDown:e=>{var t;e.keyCode===Px.ENTER&&(null==(t=v.current)||t.blur())}}):l.name)}if(!l){const t=e.size||i.defaultColWidth,n=r?i.indexColWidth:0;return s.a.createElement("div",{key:e.field_uuid,className:"lakex-viewer-grid-header-group-column",style:{width:t+n+"px"}})}return null})))},Dse=({viewRecords:e,viewFields:t,group:r,fieldGroups:n,filters:i})=>{var o,l,c,u;const d=zA(Yre),f=zA(_3),p=zA(Uj),h=s0(Nw.FIELD).canCreate(),[m,v]=Object(a.useState)(null),g=Object(a.useRef)(null),y=TN(RN(Nse,{activationConstraint:{distance:8}})),b=Object(a.useMemo)((()=>t.findIndex((e=>e.uuid===m))),[m,t]),w=t[b];return s.a.createElement(aP,{sensors:y,modifiers:[UP],collisionDetection:LN,onDragStart:e=>{v(e.active.id),p.$root&&(g.current=p.$root.getBoundingClientRect())},onDragEnd:async e=>{var r,n;const{active:i,over:o}=e;if(v(null),i.id!==o.id){const e=null==(r=t.find((e=>e.uuid===i.id)))?void 0:r.field_uuid,a=null==(n=t.find((e=>e.uuid===o.id)))?void 0:n.field_uuid;await d.updateFieldOrder(e,a)}},autoScroll:{threshold:{x:.2,y:0}}},s.a.createElement(jP,{items:t.map((e=>({...e,id:e.uuid}))),strategy:RP},s.a.createElement("div",{className:GA("lakex-viewer-grid-header",{"has-group":n.length>0})},s.a.createElement("div",{className:"lakex-viewer-grid-header-left"},s.a.createElement("div",{className:"lakex-viewer-grid-header-main"},s.a.createElement(jse,{viewFields:t,viewRecords:e,group:r,fieldGroups:n,sticky:!0,stickyColNum:f.stickyColNum}),s.a.createElement(Pse,{viewFields:t,viewRecords:e,group:r,filters:i,sticky:!0,stickyColNum:f.stickyColNum,rootHeight:(null==(o=g.current)?void 0:o.height)||"100%"}))),s.a.createElement("div",{className:GA("lakex-viewer-grid-header-right",{"has-blank":h})},s.a.createElement("div",{className:"lakex-viewer-grid-header-main"},s.a.createElement(jse,{viewFields:t,viewRecords:e,group:r,fieldGroups:n,sticky:!1,stickyColNum:f.stickyColNum}),s.a.createElement(Pse,{viewFields:t,viewRecords:e,group:r,filters:i,sticky:!1,stickyColNum:f.stickyColNum,rootHeight:(null==(l=g.current)?void 0:l.height)||"100%",hasBlank:h})))),s.a.createElement(xP,{style:{height:null==(c=g.current)?void 0:c.height},dropAnimation:null},w?s.a.createElement("div",{className:"lakex-viewer-grid-header-drag-overlay"},s.a.createElement(Mse,{viewFields:t,viewRecords:e,group:r,filters:i,viewField:w,index:b,size:w.size,rootHeight:(null==(u=g.current)?void 0:u.height)||"100%"})):null)))},Fse=({cellNum:e})=>s.a.createElement("div",{className:"lakex-viewer-grid-footer-column-name"},kf("已选择 $1 个单元格",e)),Vse=({field:e,records:t})=>{const r=zA(g3).Statistics;return r?s.a.createElement(r,{field:e,records:t}):null},Lse=({width:e,field:t,records:r})=>{const n=t3(),i=null==n?void 0:n.getRangeAt(0),o=i?(i.end.column-i.start.column+1)*(i.end.row-i.start.row+1):0;return Object(a.useMemo)((()=>s.a.createElement("div",{className:"lakex-viewer-grid-footer-column",style:{width:e+"px"}},o>1?s.a.createElement(Fse,{cellNum:o}):s.a.createElement(Vse,{field:t,records:r}))),[o,t,r])},$se=({viewRecords:e,viewFields:t,indexColWidth:r,defaultColWidth:n,stickyColNum:i,sticky:o})=>{const a=o?t.slice(0,i):t.slice(i);return s.a.createElement(s.a.Fragment,null,null==a?void 0:a.map((({field:t,size:a},l)=>{if(!t)return null;const c=l+(o?0:i);return 0===c?s.a.createElement(Lse,{key:t.uuid+"_"+c,width:r+(a||n),field:t,records:e}):s.a.createElement("div",{key:t.uuid+"_"+c,className:"lakex-viewer-grid-footer-column",style:{width:(a||n)+"px"}},s.a.createElement(Vse,{field:t,records:e}))})))},Bse=({viewRecords:e,viewFields:t})=>{const r=zA(_3),{indexColWidth:n,defaultColWidth:i,stickyColNum:o}=r;return s.a.createElement("div",{className:"lakex-viewer-grid-footer"},s.a.createElement("div",{className:"lakex-viewer-grid-footer-left"},s.a.createElement($se,{viewRecords:e,viewFields:t,indexColWidth:n,defaultColWidth:i,stickyColNum:o,sticky:!0})),s.a.createElement("div",{className:"lakex-viewer-grid-footer-right"},s.a.createElement($se,{viewRecords:e,viewFields:t,indexColWidth:n,defaultColWidth:i,stickyColNum:o,sticky:!1})))},zse=({stickyPaneWidth:e,isUngroup:t,groupField:r,groupOption:n,records:i,fields:o,isFolding:a,onFold:l})=>{const c=zA(tD),u=zA(_3),d=zA(g3),f=zA(bse,{optional:!0}),p=null==c?void 0:c.getFieldComponent(null==r?void 0:r.type),h=d.Statistics,m=null==f?void 0:f.FoldIcon;return s.a.createElement("div",{className:GA("lakex-viewer-grid-group-header",{folded:a})},s.a.createElement("div",{className:"left",style:{width:e}},s.a.createElement("div",{className:GA("lakex-viewer-grid-group-header-index",{"no-sticky-col":0===u.stickyColNum})},m&&s.a.createElement(m,{isFolding:a,onFold:l}),t?kf("（空）"):p&&s.a.createElement("div",{className:"lakex-viewer-grid-group-field"},s.a.createElement(p,{readonly:!0,field:r,cell:n,checkCell:!1,writeable:!1}))),null==o?void 0:o.slice(0,u.stickyColNum).map((({field:e,size:t},r)=>s.a.createElement("div",{key:"group_"+(null==e?void 0:e.uuid)+"_"+r,className:GA("lakex-viewer-grid-group-header-column sticky"),style:{width:t+"px"}},h?s.a.createElement(h,{field:e,records:i}):null)))),s.a.createElement("div",{className:"right"},null==o?void 0:o.slice(u.stickyColNum).map((({field:e,size:t},r)=>s.a.createElement("div",{key:"group_"+(null==e?void 0:e.uuid)+"_"+r,className:GA("lakex-viewer-grid-group-header-column"),style:{width:t+"px"}},h?s.a.createElement(h,{field:e,records:i}):null)))))},Use=({isSameGroup:e,recordIndexMap:t,active:r,over:n,record:i})=>{var o,a,l,c;const u=null==(a=null==(o=null==r?void 0:r.data.current)?void 0:o.sortable)?void 0:a.index,d=null==(c=null==(l=null==n?void 0:n.data.current)?void 0:l.sortable)?void 0:c.index;if(!n||!r)return null;if(!e&&n.id===i.record_uuid&&n.id!==r.id){const e=t[n.id].isGroupFirst,r=t[n.id].isGroupLast;return s.a.createElement("div",{className:GA("lakex-viewer-grid-group-dragger-line",{top:u>d,bottom:u<d,first:e,last:r})})}return null},Hse=({stickyPaneWidth:e,index:t,record:r,viewRecords:n,viewFields:i,viewConfig:o,allRecords:a,recordIndexMap:l,groupFolding:c})=>{var u;const d=zA(g3),f=zA(bse,{optional:!0}),p=s0(Nw.TABLE).isReadonly(),{groupIndex:h,isGroupFirst:m,isGroupLast:v}=l[r.record_uuid],g=n[h],y=(null==(u=g.groupOption)?void 0:u.value)||d.UNGROUP_KEY,b=c.has(y),w=null==d?void 0:d.AddRecord;let _=null;const{attributes:C,listeners:E,setNodeRef:x,transform:S,transition:k,isDragging:O,over:I,active:R}=zP({id:r.record_uuid,disabled:p});if(!b){const e={transform:"",transition:k,opacity:O?0:1},n=!(!R||!I)&&l[R.id].groupIndex===l[I.id].groupIndex;n&&(e.transform=vN.Transform.toString(S)||""),_=s.a.createElement("div",{ref:p?void 0:x,className:"lakex-viewer-grid-group-row",style:e,...C},s.a.createElement(Cse,{key:(null==r?void 0:r.record_uuid)+"_sticky_"+t,index:t,record:r,viewRecords:a,viewFields:i,viewConfig:o,sticky:!0,isGroupLast:v,listeners:E}),s.a.createElement(Cse,{key:(null==r?void 0:r.record_uuid)+"_"+t,index:t,record:r,viewRecords:a,viewFields:i,viewConfig:o,sticky:!1,isGroupLast:v}),s.a.createElement(Use,{isSameGroup:n,recordIndexMap:l,allRecords:a,active:R,over:I,record:r}))}return s.a.createElement("td",null,m&&s.a.createElement(zse,{stickyPaneWidth:e,isUngroup:!g.groupOption,groupField:g.groupField,groupOption:g.groupOption,records:g.records,fields:i,isFolding:b,onFold:e=>{null==f||f.setGroupFolding(y,e)}}),_,!p&&v&&!b&&s.a.createElement("div",{className:"lakex-viewer-grid-row-container sticky",style:{width:e}},w?s.a.createElement(w,{inGroup:!0,index:t,viewGroupRecord:g,viewRecords:a,viewFields:i}):null))},Wse=({style:e,context:t,...r})=>{const{rootRect:n,useWindowScroll:i}=t;return s.a.createElement("table",{...r,style:{...e,width:i?"auto":"100%",minWidth:i?"750px":"auto",minHeight:i?0:null==n?void 0:n.height}})},Gse=s.a.forwardRef(((e,t)=>{const{style:r,...n}=e,i=zA(oD);return s.a.createElement("thead",{ref:t,...n,style:{...r,zIndex:null==i?void 0:i.zIndex.gridHeader}})})),Kse=s.a.forwardRef(((e,t)=>{const{style:r,...n}=e,i=zA(oD);return s.a.createElement("tfoot",{ref:t,...n,style:{...r,zIndex:null==i?void 0:i.zIndex.gridFooter}})})),qse=({style:e,...t})=>{const[r,n]=Object(a.useState)(0),i=t["data-known-size"],o={"--child-height":`${r}px`};return Object(a.useEffect)((()=>{n((e=>0===i?e:i))}),[i]),s.a.createElement("tr",{className:"height-preserving-tr",...t,style:{...e,...o}})},Yse=({viewRecords:e,viewFields:t,viewConfig:r,group:n,fieldGroups:i,filters:o,stickyPaneWidth:c,recordHeight:u,rootRect:d,useWindowScroll:f,customScrollParent:p,customModalContainer:h})=>{const m=zA(R3),g=zA(g3),y=zA(bse,{optional:!0}),b=null==g?void 0:g.AddRecord,{allRecords:w,recordIndexMap:_}=(e=>{const t={},r=[];let n=0;for(let i=0;i<e.length;i++){const o=e[i].records||[];i>0&&(n+=(e[i-1].records||[]).length);for(let e=0;e<o.length;e++){const a=o[e];t[a.record_uuid]={groupIndex:i,totalIndex:n+e,indexInGroup:e,isGroupFirst:0===e,isGroupLast:e===o.length-1},r.push({...a,id:a.record_uuid})}}return{recordIndexMap:t,allRecords:r}})(e),{activeId:C,sensors:E,onDragStart:x,onDragEnd:S}=((e,t,r,n)=>{const i=zA(R3),o=zA(Yre),s=zA(e3),l=zA(Dy),[c,u]=Object(a.useState)(null);return{activeId:c,sensors:TN(RN(SM,{activationConstraint:{distance:8}})),onDragStart:e=>{u(e.active.id),null==s||s.removeSelection()},onDragEnd:async r=>{var a,s,c,d;u(null);const{active:f,over:p}=r;if(f.id!==p.id){const r=f.id;let u=p.id;const{groupIndex:h}=e[r],{groupIndex:m}=e[u],g=t[h]||null,y=t[m]||null;if((null==n?void 0:n.keep_sort)&&g===y)return void v.a.warn(kf("取消排序后，可进行拖拽"));if(g&&y&&g!==y){const e=null==(a=f.data.current.sortable)?void 0:a.index,t=null==(s=p.data.current.sortable)?void 0:s.index,n=l.getOriginViewRecords(),i=n.findIndex((e=>e.record_uuid===r)),o=n.findIndex((e=>e.record_uuid===u));e<t&&i>o&&(u=null==(c=n[o+1])?void 0:c.record_uuid),e>t&&i<o&&(u=null==(d=n[o-1])?void 0:d.record_uuid)}if(await o.updateRecordOrder(r,u,g,y),null!=n&&n.keep_sort){const e=l.getFlatViewRecords(n.view_uuid).findIndex((e=>e.record_uuid===r));return i.scrollIntoView({index:e,align:"start"}),void v.a.warn(kf("当前处于保持排序状态，为您重新定位"))}}}}})(_,e,0,r),k=s0(Nw.RECORD).canCreate(),[O,I]=Object(a.useState)((null==y?void 0:y.groupFolding)||new Set),R=Object(a.useRef)(null),T=w.findIndex((e=>e.record_uuid===C)),A=w[T];return Object(a.useEffect)((()=>{null==y||y.clearGroupFolding()}),[null==n?void 0:n.uuid]),Object(a.useEffect)((()=>{const e=null==y?void 0:y.onGroupFoldingChange((e=>{I(e)}));return()=>{null==e||e.destroy()}}),[y]),Object(a.useEffect)((()=>{R.current&&(null==m||m.setTableVirtuosoRef(R.current))}),[m,R]),wV((()=>{null==y||y.clearGroupFolding(),null==m||m.destroy()})),0===w.length&&k?b?s.a.createElement(b,{inGroup:!0,index:-1,viewRecords:[],viewFields:t}):null:s.a.createElement(aP,{sensors:E,modifiers:[KP,GP],collisionDetection:LN,onDragStart:x,onDragEnd:S,autoScroll:{threshold:{x:0,y:.2}}},s.a.createElement(jP,{items:w,strategy:NP},s.a.createElement(s.a.Fragment,null,s.a.createElement(hse,{ref:R,useWindowScroll:f,customScrollParent:p,context:{rootRect:d,useWindowScroll:f},components:{Table:Wse,TableHead:Gse,TableFoot:Kse,TableRow:qse},isScrolling:e=>{null==m||m.isScrolling(e)},onScroll:()=>{null==m||m.onScroll()},data:w,defaultItemHeight:u,itemSize:t=>{var r;if(void 0===t.dataset.index)return u;const n=parseInt(t.dataset.index),i=w[n],{isGroupFirst:o,isGroupLast:a,groupIndex:s}=_[i.record_uuid],l=(null==(r=e[s].groupOption)?void 0:r.value)||g.UNGROUP_KEY,c=O.has(l);return(c?0:u)+(o?56:0)+(a&&!c&&k?40:0)+(n===w.length-1?20:0)},increaseViewportBy:360,style:{width:"100%",height:(null==d?void 0:d.height)||0,overflow:"overlay"},fixedHeaderContent:()=>s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement(Dse,{viewRecords:e,viewFields:t,viewConfig:r,group:n,fieldGroups:i,filters:o}))),fixedFooterContent:()=>s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement(Bse,{viewRecords:w,viewFields:t,group:n,stickyPaneWidth:c}))),itemContent:(n,i)=>s.a.createElement(s.a.Fragment,null,s.a.createElement(Hse,{key:i.record_uuid,stickyPaneWidth:c,index:n,record:i,viewRecords:e,viewFields:t,viewConfig:r,allRecords:w,recordIndexMap:_,groupFolding:O}),n===w.length-1?s.a.createElement("div",{className:"lakex-viewer-grid-group-gap-line"}):null)}),Object(l.createPortal)(s.a.createElement(xP,{dropAnimation:null,style:{width:`${d.width}px`,left:`${d.left}px`,overflow:"hidden"}},A?s.a.createElement("div",{className:"lakex-viewer-grid-group-row"},s.a.createElement(Cse,{index:T,record:A,viewRecords:w,viewFields:t,viewConfig:r,sticky:!0,isGroupLast:!1}),s.a.createElement(Cse,{index:T,record:A,viewRecords:w,viewFields:t,viewConfig:r,sticky:!1,isGroupLast:!1})):null),h))))},Xse=({index:e,record:t,viewRecords:r,viewFields:n,viewConfig:i,listeners:o={}})=>{const{canCreate:a}=s0(Nw.FIELD);return s.a.createElement("div",{className:"lakex-viewer-grid-list-row"},s.a.createElement(Cse,{index:e,record:t,viewRecords:r,viewFields:n,viewConfig:i,sticky:!0,listeners:o,disableDrag:!(null==i||!i.keep_sort)}),s.a.createElement(Cse,{index:e,record:t,viewRecords:r,viewFields:n,viewConfig:i,sticky:!1,hasBlank:a(),disableDrag:!(null==i||!i.keep_sort)}))},Zse=({index:e,record:t,viewRecords:r,viewFields:n,viewConfig:i})=>{const o=!s0(Nw.TABLE).canUpdate()||!(null==i||!i.keep_sort),{attributes:a,listeners:l,setNodeRef:c,transform:u,transition:d,isDragging:f}=zP({id:t.record_uuid,disabled:o}),p={transform:vN.Transform.toString(u),transition:d,zIndex:f?"100":"auto",opacity:f?0:1};return s.a.createElement("td",{ref:o?void 0:c,style:p,...a},s.a.createElement(Xse,{index:e,record:t,viewRecords:r,viewFields:n,viewConfig:i,listeners:l}))},Jse=({style:e,context:t,...r})=>{const{rootRect:n,useWindowScroll:i}=t;return s.a.createElement("table",{...r,style:{...e,width:i?"auto":"100%",minWidth:i?"750px":"auto",minHeight:i?0:null==n?void 0:n.height}})},Qse=s.a.forwardRef(((e,t)=>{const{style:r,...n}=e,i=zA(oD);return s.a.createElement("thead",{ref:t,...n,style:{...r,zIndex:null==i?void 0:i.zIndex.gridHeader}})})),ele=s.a.forwardRef(((e,t)=>{const{style:r,...n}=e,i=zA(oD);return s.a.createElement("tfoot",{ref:t,...n,style:{...r,zIndex:null==i?void 0:i.zIndex.gridFooter}})})),tle=({style:e,...t})=>{const[r,n]=Object(a.useState)(0),i=t["data-known-size"],o={"--child-height":`${r}px`};return Object(a.useEffect)((()=>{n((e=>0===i?e:i))}),[i]),s.a.createElement("tr",{className:"height-preserving-tr",...t,style:{...e,...o}})},rle=({viewRecords:e,viewFields:t,viewConfig:r,fieldGroups:n,filters:i,stickyPaneWidth:o,recordHeight:c,rootRect:u,useWindowScroll:d,customScrollParent:f,customModalContainer:p})=>{const h=s0(Nw.RECORD).canCreate(),m=zA(R3),v=zA(g3),g=null==v?void 0:v.AddRecord,y=Object(a.useRef)(null),{activeId:b,sensors:w,onDragStart:_,onDragEnd:C}=(()=>{const e=zA(Yre),t=zA(e3),[r,n]=Object(a.useState)(null);return{activeId:r,sensors:TN(RN(SM,{activationConstraint:{distance:8}})),onDragStart:e=>{n(e.active.id),null==t||t.removeSelection()},onDragEnd:async t=>{n(null);const{active:r,over:i}=t;if(r.id!==i.id){const t=r.id,n=i.id;await e.updateRecordOrder(t,n)}}}})(),E=e.findIndex((e=>e.record_uuid===b)),x=e[E],S=Object(a.useMemo)((()=>e.map((e=>({...e,id:e.record_uuid})))),[e]);return Object(a.useEffect)((()=>{y.current&&(null==m||m.setTableVirtuosoRef(y.current))}),[m,y]),wV((()=>{null==m||m.destroy()})),0===e.length&&h?g?s.a.createElement(g,{viewRecords:e,viewFields:t}):null:s.a.createElement(aP,{sensors:w,modifiers:[KP,GP],collisionDetection:LN,onDragStart:_,onDragEnd:C,autoScroll:{threshold:{x:0,y:.2}}},s.a.createElement(jP,{items:S,strategy:NP},s.a.createElement(s.a.Fragment,null,s.a.createElement(hse,{ref:y,useWindowScroll:d,customScrollParent:f,context:{rootRect:u,useWindowScroll:d},components:{Table:Jse,TableHead:Qse,TableFoot:ele,TableRow:tle},isScrolling:e=>{null==m||m.isScrolling(e)},onScroll:()=>{null==m||m.onScroll()},data:e,defaultItemHeight:c,itemSize:t=>{if(void 0===t.dataset.index)return c;const r=parseInt(t.dataset.index);return c+(r===e.length-1&&h?40:0)},increaseViewportBy:360,style:{width:"100%",height:(null==u?void 0:u.height)||0,overflow:"overlay"},fixedHeaderContent:()=>s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement(Dse,{viewRecords:e,viewFields:t,viewConfig:r,fieldGroups:n,filters:i}))),fixedFooterContent:()=>s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement(Bse,{viewRecords:e,viewFields:t,stickyPaneWidth:o}))),itemContent:(n,i)=>s.a.createElement(s.a.Fragment,null,s.a.createElement(Zse,{key:i.record_uuid,index:n,record:i,viewRecords:e,viewFields:t,viewConfig:r}),n===e.length-1&&s.a.createElement("td",null,s.a.createElement("div",{className:"lakex-viewer-grid-row-container sticky",style:{width:o}},h&&g?s.a.createElement(g,{viewRecords:e,viewFields:t}):null)))}),Object(l.createPortal)(s.a.createElement(xP,{dropAnimation:null,style:{width:`${u.width}px`,left:`${u.left}px`,overflow:"hidden"}},x?s.a.createElement(Xse,{index:E,record:x,viewRecords:e,viewFields:t,viewConfig:r}):null),p))))},nle=({viewRecords:e,viewFields:t,viewConfig:r,group:n,fieldGroups:i,filters:o})=>{const l=zA(S3),c=zA(_3),{rootRect:u,useWindowScroll:d,customScrollParent:f,customModalContainer:p}=(()=>{const e=zA(Uj),t=zA(R3),r=zA(qf),n=Object(a.useRef)(e.getRenderBoundingClientRect()),i=zA(qf),[o,s]=Object(a.useState)((null==i?void 0:i.getValue("view.useWindowScroll"))||!1),l=null==i?void 0:i.getValue("view.customScrollParent"),c=(null==i?void 0:i.getValue("modal.customModalContainer"))||document.body;return Object(a.useEffect)((()=>{const i=RA((()=>{if(null!=r&&r.getValue("view.useWindowScroll"))return;const i=e.getRenderBoundingClientRect();if(n.current=i,t.tableScroller){t.tableScroller.style.height=i.height+"px";const e=t.tableScroller.querySelector("table");e&&(e.style.width="100%",e.style.minWidth="auto",e.style.minHeight=i.height+"px")}}),300);return window.addEventListener("resize",i),window.addEventListener("lakex_table_view_resize",i),()=>{window.removeEventListener("resize",i),window.removeEventListener("lakex_table_view_resize",i)}}),[e]),Object(a.useEffect)((()=>{const t=null==i?void 0:i.onConfigurationChange((({key:t,value:r})=>{if("view.useWindowScroll"===t){const t=e.getRenderBoundingClientRect();n.current=t,s(r)}}));return()=>{null==t||t.destroy()}}),[]),{rootRect:n.current,useWindowScroll:o,customScrollParent:l,customModalContainer:c}})(),h=Object(a.useMemo)((()=>l.getRowHeight(null==r?void 0:r.record_height)),[l,null==r?void 0:r.record_height]),m=Object(a.useMemo)((()=>{const e=n?null==c?void 0:c.groupRowGap:0;return((null==c?void 0:c.getStickyPaneWidth(t||[]))||0)+e}),[c,t]);return Object(a.useEffect)((()=>{const e=e=>{("ResizeObserver loop completed with undelivered notifications."===e.message||"ResizeObserver loop limit exceeded"===e.message)&&e.stopImmediatePropagation()};return window.addEventListener("error",e),()=>{window.removeEventListener("error",e)}}),[]),s.a.createElement("div",{className:GA("lakex-viewer-grid-content",{"in-group":!!n})},n?s.a.createElement(Yse,{viewRecords:e,viewFields:t,viewConfig:r,group:n,fieldGroups:i,filters:o,stickyPaneWidth:m,recordHeight:h,rootRect:u,useWindowScroll:d,customScrollParent:f,customModalContainer:p}):s.a.createElement(rle,{viewRecords:e,viewFields:t,viewConfig:r,fieldGroups:i,filters:o,stickyPaneWidth:m,recordHeight:h,rootRect:u,useWindowScroll:d,customScrollParent:f,customModalContainer:p}))},ile=s.a.forwardRef(((e,t)=>{const r=zA(s3),n=u0(),{group:i,fieldGroups:o=[],viewRecords:a=[],viewFields:l=[],viewConfig:c,filters:u=[]}=n;if(!n)return null;const d=s.a.createElement("div",{ref:t,className:"lakex-viewer-grid"},s.a.createElement("div",{className:"lakex-viewer-grid-inner"},s.a.createElement(nle,{viewRecords:a,viewFields:l,viewConfig:c,group:i,fieldGroups:o,filters:u}))),f=null==r?void 0:r.SelectionContainer;return f?s.a.createElement(f,null,d):d}));class ole extends rV{constructor(){super(...arguments),this.viewType=Wh.GRID,this.title=kf("表格视图"),this.desc=kf("规范化存储和展示数据"),this.icon=e=>s.a.createElement(YP,{type:"GridView",size:16,...e}),this.colorCls="yuque-color-green-6",this.Component=ile}}var ale=Object.defineProperty,sle=Object.getOwnPropertyDescriptor,lle=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?sle(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ale(t,r,o),o};let cle=class{static pluginModule(){return bo().contribution(u3).contribution(d3).contribution(f3).contribution(p3).register(this).register(g3).register(M3).register(_3).register(S3).register(R3)}static registerConfiguration(e){e.registerConfiguration({id:"viewerGrid",type:"object",title:"表格视图",properties:{stickyColNum:{type:"number",description:"冻结列个数"}}}),e.registerDefaultValue({"viewerGrid.stickyColNum":1})}get _isReadonly(){return this._abilityService.isReadonly(Nw.TABLE)}get _currentViewType(){var e;return null==(e=this._readService.getActiveView())?void 0:e.type}_hasSelection(){var e;return null==(e=this._selectionService)?void 0:e.hasSelection()}init(){this._viewerGridService.init()}registerViewer(e){e.registerItem(new ole({onError:e.onError}))}registerHotkey(e){e.registerItem({id:"grid-field-move-up",hotkey:"up",name:"up 向上移动选区",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===Wh.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveUp()}}),e.registerItem({id:"grid-field-move-down",hotkey:"down",name:"down 向下移动选区",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===Wh.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveDown()}}),e.registerItem({id:"grid-field-move-left",hotkey:"left",name:"left 向左移动选区",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===Wh.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveLeft()}}),e.registerItem({id:"grid-field-move-right",hotkey:"right, tab",name:"right 向右移动选区",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===Wh.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveRight()}}),e.registerItem({id:"grid-field-move-top",hotkey:"⌘+up",name:"移动到第一行选区",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===Wh.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveTop()}}),e.registerItem({id:"grid-field-move-bottom",hotkey:"⌘+down",name:"移动到最后一行选区",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===Wh.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveBottom()}}),e.registerItem({id:"grid-field-move-first-left",hotkey:"⌘+left",name:"移动到第一列选区",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===Wh.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveFirstLeft()}}),e.registerItem({id:"grid-field-move-last-right",hotkey:"⌘+right",name:"移动到最后一列选区",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===Wh.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveLastRight()}}),e.registerItem({id:"grid-field-focus-move-up",hotkey:"shift+up",name:"选区终点上移",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===Wh.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveFocusUp()}}),e.registerItem({id:"grid-field-focus-move-down",hotkey:"shift+down",name:"选区终点下移",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===Wh.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveFocusDown()}}),e.registerItem({id:"grid-field-focus-move-left",hotkey:"shift+left",name:"选区终点左移",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===Wh.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveFocusLeft()}}),e.registerItem({id:"grid-field-focus-move-right",hotkey:"shift+right",name:"选区终点右移",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===Wh.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveFocusRight()}}),e.registerItem({id:"grid-field-select-all",hotkey:"⌘+A",name:"全选",enableOnInput:!1,isEnable:()=>this._currentViewType===Wh.GRID,onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.selectAll()}}),e.registerItem({id:"grid-add-record-before",hotkey:"⌘+shift+enter",name:"向上插入行",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===Wh.GRID,t=this._isReadonly,r=this._hasSelection();return!t&&e&&r},onHotKey:async e=>{var t,r,n,i;e.preventDefault();const o=this._readService.getFlatViewRecords(),a=null==(t=this._selectionService)?void 0:t.getFieldValue(),s=o.findIndex((e=>e.record_uuid===(null==a?void 0:a.recordId)));if(s<0)return;const l=this._readService.getViewFields(),c=o[s],u=(null==(r=this._selectionService)?void 0:r.getSelection()).anchor.column;await this._commandService.execCommand("addEmptyRecord",{sourceRecordId:c.record_uuid,direction:"before",groupItemKey:c.group_item_key});const d=null==(n=this._selectionService)?void 0:n.createGridSelectionByIndex(s,u,((null==o?void 0:o.length)||0)+1,(null==l?void 0:l.length)||0);null==(i=this._selectionService)||i.setSelection(d)}}),e.registerItem({id:"grid-add-record-after",hotkey:"shift+enter",name:"向下插入行",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===Wh.GRID,t=this._isReadonly,r=this._hasSelection();return!t&&e&&r},onHotKey:async e=>{var t,r,n,i;e.preventDefault();const o=this._readService.getFlatViewRecords(),a=null==(t=this._selectionService)?void 0:t.getFieldValue(),s=o.findIndex((e=>e.record_uuid===(null==a?void 0:a.recordId)));if(s<0)return;const l=this._readService.getViewFields(),c=o[s],u=(null==(r=this._selectionService)?void 0:r.getSelection()).anchor.column;await this._commandService.execCommand("addEmptyRecord",{sourceRecordId:c.record_uuid,direction:"after",groupItemKey:c.group_item_key});const d=null==(n=this._selectionService)?void 0:n.createGridSelectionByIndex(s+1,u,((null==o?void 0:o.length)||0)+1,(null==l?void 0:l.length)||0);null==(i=this._selectionService)||i.setSelection(d)}})}registerScrollService(e){e.setGridScrollService(this._scrollService)}};cle.pluginName="render-viewer-grid",lle([to(Dy)],cle.prototype,"_readService",2),lle([to(Hw)],cle.prototype,"_abilityService",2),lle([to(e3),Mx()],cle.prototype,"_selectionService",2),lle([to(Pb)],cle.prototype,"_commandService",2),lle([to(R3)],cle.prototype,"_scrollService",2),lle([to(g3)],cle.prototype,"_viewerGridService",2),cle=lle([eo({contrib:[Nj,W2,dj,Fj]})],cle);var ule=Object.defineProperty,dle=Object.getOwnPropertyDescriptor,fle=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?dle(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ule(t,r,o),o};let ple=class extends Zf{constructor(){super(...arguments),this._onEditingChange=this._register(new op),this.onEditingChange=this._onEditingChange.event}emitEditingChange({editing:e,recordId:t,fieldId:r}){this._onEditingChange.emit({recordId:t,fieldId:r,editing:e})}destroy(){super.destroy()}};fle([Si()],ple.prototype,"destroy",1),ple=fle([eo()],ple);const hle=Object(a.memo)((({fieldType:e,cell:t})=>{const r=zA(tD).getCellIsShowValidTip(e),n=t.errorMessage;return n&&r?s.a.createElement(h.a,{title:n,placement:"left"},s.a.createElement("span",{className:"lakex-table-grid-invalid-flag"})):null}),((e,t)=>e.cell.cellKey===t.cell.cellKey)),mle=e=>{const{fieldType:t,cell:r,field:n,isSelected:i,boxRect:o}=e,a=zA(tD).getFieldComponent(t);return a&&n?s.a.createElement(a,{field:n,cell:r,focus:!1,boxRect:o,isSelected:i}):null},vle=({cell:e,field:t,size:r,rowIndex:n,colIndex:i,rowCount:o,colCount:l,minHeight:c,isFrozen:u})=>{const d=null==e?void 0:e.recordId,f=null==t?void 0:t.uuid,p=zA(ire),h=zA(Zj),m=zA(e3),v=zA(oD),g=null==t?void 0:t.type,y=Object(a.useRef)(null),b=n3(),w=Wte({recordId:d,fieldId:f}),_=function(e,t){const r=zA(ple),[n,i]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{const n=r.onEditingChange((({recordId:r,fieldId:n,editing:o})=>{r===e&&n===t&&i(o)}));return()=>{n.destroy()}}),[r]),n}(d,f),C=Object(a.useMemo)((()=>null==m?void 0:m.isActiveCell(n,i)),[b]),E=Object(a.useMemo)((()=>null==m?void 0:m.isInSelect(n,i)),[b]),x=Object(a.useMemo)((()=>C&&u?null==v?void 0:v.zIndex.gridCellFrozenPreviewer:u?null==v?void 0:v.zIndex.gridCellFrozen:C?null==v?void 0:v.zIndex.gridCellPreviewer:null==v?void 0:v.zIndex.gridCell),[C,u]),[S,k]=Object(a.useState)(0),O=Object(a.useCallback)((({e:e,recordId:t,fieldId:r})=>{const a=null==m?void 0:m.getSelection();if(e.preventDefault(),a&&(null==m||!m.isSelectOneCell())&&(null==m?void 0:m.isInSelect(n,i)))return void(null==p||p.showContextMenu({from:nre.MULTI_CELL,e:e,selection:a}));const s=null==m?void 0:m.createGridSelectionByIndex(n,i,o,l);s&&(null==m||m.setSelection(s)),null==p||p.showContextMenu({from:nre.CELL,e:e,recordId:t,fieldId:r,selection:a})}),[m,p]),I=Object(a.useCallback)((e=>{null==m||m.scrollToAnchorPosition(null==m?void 0:m.getSelection(),e.clientY>window.innerHeight/2?"end":"start",(()=>{null==h||h.emitDoubleClickCell({fieldId:f,recordId:d,event:e,fieldType:g})}))}),[g,f,d]),R=Object(a.useCallback)((e=>{null==h||h.emitClickEvent({eventName:"activeCellClick",data:{fieldId:f,recordId:d,event:e,fieldType:g}})}),[g,f,d,C]),T=Object(a.useCallback)((e=>{if(2!==e.button&&!C){const e=null==m?void 0:m.createGridSelectionByIndex(n,i,o,l);e&&(null==m||m.setSelection(e),null==m||m.scrollToSelection(e))}}),[C]),A=Object(a.useMemo)((()=>({width:r?r-20:0,height:c-12})),[r,c]);return Object(a.useLayoutEffect)((()=>{var e;if(C&&g===Rh.TEXT){const t=null==(e=y.current)?void 0:e.getBoundingClientRect();t&&window.innerHeight-t.bottom<40?k(c-t.height):k(0)}else k(0)}),[C,c,g]),s.a.createElement("div",{ref:y,"data-col":i,"data-record-uuid":null==e?void 0:e.recordId,"data-field-uuid":null==t?void 0:t.uuid,className:GA("lakex-viewer-grid-cell",{"in-select":E&&!C,"in-highlight":w,selected:C,editing:_,[`height-${c}`]:c},g),style:{width:r+"px",minHeight:c,zIndex:x,transform:C?`translateY(${S}px)`:""},onContextMenu:e=>O({e:e,recordId:d,fieldId:f,from:nre.CELL}),onScrollCapture:e=>e.stopPropagation(),onDoubleClick:I,onClick:R,onMouseDown:T},s.a.createElement(mle,{key:e.cellKey,cell:e,field:t,fieldType:g,isSelected:!!C,boxRect:A}),e&&s.a.createElement(hle,{fieldType:g,cell:e}))},gle=({record:e,fields:t,records:r,config:n,index:i,sticky:o,hasBlank:l=!1,disableDrag:c=!1,listeners:u={}})=>{const d=zA(fre),f=zA(S3),p=zA(e3),h=zA(Yre),m=zA(Zj),v=zA(qf),g=zA(_3),y=d.ExpandRecordRecordHeaderIcon,b=null==h?void 0:h.OrderDragIcon,w=Object(a.useCallback)((()=>{(null==v?void 0:v.getValue("render.mode"))===Pj.MOBILE&&(null==m||m.emitClickRecord({recordId:e.record_uuid}))}),[e.record_uuid]),_=Object(a.useMemo)((()=>f.getRowHeight(null==n?void 0:n.record_height)),[f,null==n?void 0:n.record_height]),C=t.reduce(((e,t)=>(e[t.field_uuid]=t,e)),{}),E=Object(a.useMemo)((()=>{var t;return(null==(t=e.cells)?void 0:t.slice(0,g.stickyColNum).filter((e=>!!e)))||[]}),[e.cells,g.stickyColNum]),x=Object(a.useMemo)((()=>{var t;return(null==(t=e.cells)?void 0:t.slice(g.stickyColNum).filter((e=>!!e)))||[]}),[e.cells,g.stickyColNum]);return s.a.createElement("div",{className:"lakex-viewer-grid-row","data-row":i,"data-record-uuid":e.record_uuid,style:{height:_},onClick:w},o&&s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"lakex-viewer-grid-row-index",onClick:()=>{const e=null==p?void 0:p.createRowGridSelectionByIndex(i,r.length,t.length);null==p||p.setSelection(e)}},b&&s.a.createElement(b,{listeners:u,disable:c}),s.a.createElement("div",{className:"lakex-viewer-grid-row-number"},i+1),y&&s.a.createElement(y,{recordId:e.record_uuid})),E.map(((n,o)=>{const a=C[(null==n?void 0:n.fieldId)||""];return s.a.createElement(vle,{key:e.record_uuid+"_"+(null==n?void 0:n.fieldId)+"_"+o,rowIndex:i,colIndex:o,rowCount:r.length,colCount:t.length,cell:n,field:null==a?void 0:a.field,size:(null==a?void 0:a.size)||g.defaultColWidth,minHeight:_,isFrozen:!0})}))),!o&&s.a.createElement(s.a.Fragment,null,x.map(((n,o)=>{const a=C[(null==n?void 0:n.fieldId)||""];return s.a.createElement(vle,{key:e.record_uuid+"_"+(null==n?void 0:n.fieldId)+"_"+o,rowIndex:i,colIndex:o+g.stickyColNum,rowCount:r.length,colCount:t.length,cell:n,field:null==a?void 0:a.field,size:(null==a?void 0:a.size)||g.defaultColWidth,minHeight:_,isFrozen:!1})})),l&&s.a.createElement("div",{className:"lakex-viewer-grid-row-blank"})))};var yle=Object.defineProperty,ble=Object.getOwnPropertyDescriptor;let wle=class{static pluginModule(){return bo().contribution(lre).register(this).register(fre)}getRecordComponent(){return gle}};wle.pluginName="render-viewer-grid-record",wle=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?ble(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&yle(t,r,o),o})([eo({contrib:u3})],wle);var _le=Object.defineProperty,Cle=Object.getOwnPropertyDescriptor;let Ele=class{static pluginModule(){return bo().register(bse).register(this)}init(){}};Ele.pluginName="render-viewer-grid-group",Ele=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Cle(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&_le(t,r,o),o})([eo({contrib:Nj})],Ele);var xle=Object.defineProperty,Sle=Object.getOwnPropertyDescriptor;let kle=class{static pluginModule(){return bo().register(this).register(ple)}init(e){}};kle.pluginName="render-viewer-grid-cell-editor",kle=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Sle(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&xle(t,r,o),o})([eo({contrib:[Nj]})],kle);var Ole=Object.defineProperty,Ile=Object.getOwnPropertyDescriptor,Rle=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Ile(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ole(t,r,o),o};let Tle=class extends Zf{constructor(){super(...arguments),this.gridGap=20,this._onRefreshLayout=this._register(new op),this.onRefreshLayout=this._onRefreshLayout.event}_getViewRect(){return this._renderContext.getRenderBoundingClientRect()}_getColCount(e){let t=5;return e<1440&&(t=Math.max(5-Math.ceil((1440-e)/300),2)),t}_getRowCount(e,t){return Math.ceil(e/t)}_getCardWidth(e,t){return Math.floor(Math.floor(e-20*(t+1))/t)}getCoverHeight(e){return Math.round(e/1.6)}_getFieldNameHeight(){return 23}_getCardHeight(e,t,r){var n;let i=0;r.cover_field_uuid&&(i+=this.getCoverHeight(e));for(let e=0;e<t.length;e++){const o=t[e];if(o.hidden)continue;r.show_field_name&&(i+=this._getFieldNameHeight());const a=null==(n=o.field)?void 0:n.type;a===Rh.IMAGE?i+=48:a===Rh.TEXT?i+=20+(0===e?28:40):i+=48}return i+20}getLayout(e,t,r){const n=this._getViewRect(),i=this._getColCount(n.width),o=this._getRowCount(e.length,i),a=this._getCardWidth(n.width,i);return{viewRect:n,width:a,height:this._getCardHeight(a,t,r),colCount:i,rowCount:o}}refresh(){this._onRefreshLayout.emit()}destroy(){super.destroy()}};Rle([to(Uj)],Tle.prototype,"_renderContext",2),Rle([Si()],Tle.prototype,"destroy",1),Tle=Rle([eo()],Tle);var Ale=Object.defineProperty,Nle=Object.getOwnPropertyDescriptor;let Mle=class{constructor(){this._virtuosoRef=null}get virtuosoRef(){return this._virtuosoRef}setVirtuosoRef(e){this._virtuosoRef=e}scrollToIndex(e){var t;null==(t=this._virtuosoRef)||t.scrollToIndex(e)}scrollTo(e){var t;null==(t=this._virtuosoRef)||t.scrollTo(e)}};Mle=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Nle(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ale(t,r,o),o})([eo()],Mle);const Ple=({height:e})=>s.a.createElement("div",{className:"lakex-table-card-cover empty",style:{height:e}},s.a.createElement("img",{src:"https://gw.alipayobjects.com/zos/bmw-prod/94c60ed0-e53a-4ad1-9ffe-ec7fd1266b46.svg",draggable:"false"})),jle=({record:e,width:t})=>{const{getCoverHeight:r,cell:n,viewConfig:i,opener:o,imageService:l}=(({record:e,width:t})=>{const r=zA(Dy),n=zA(MD),i=zA(aZ),o=zA(Tle),s=null==r?void 0:r.getViewConfig();return{cell:Object(a.useMemo)((()=>null==r?void 0:r.getCell((null==s?void 0:s.cover_field_uuid)||"",e.record_uuid)),[null==s?void 0:s.cover_field_uuid,e]),opener:n,imageService:i,viewConfig:s,getCoverHeight:()=>null==o?void 0:o.getCoverHeight(t)}})({record:e,width:t});if(null==i||!i.cover_field_uuid)return null;if(null==n||!n.value)return s.a.createElement(Ple,{height:r()});const c=n.value[0];if(!c.src)return s.a.createElement(Ple,{height:r()});const u={height:r()},d=l.getThumbnailUrl(c.src,c.width,c.height,390);return u.backgroundImage=`url(${d})`,u.backgroundRepeat="no-repeat",u.backgroundPosition="center center","clip"===i.cover_display?u.backgroundSize="cover":u.backgroundSize="contain",s.a.createElement("div",{className:"lakex-table-card-image",style:u,onClick:e=>{e.preventDefault(),e.stopPropagation(),null==o||o.open("image",c.src,{width:c.width,height:c.height})}})};const Dle=({cell:e,field:t,viewConfig:r,index:n})=>{const i=zA(tD),o=i.getFieldComponent(null==t?void 0:t.type),a=function(e,t){t.value,Kh.isSelectLike(e.type)||Kh.isImage(e.type)||Kh.isSystemDate(e.type)}(t,e),l=null==i?void 0:i.getFieldIcon(t.type);let c=null;return 0===n&&null==(null==e?void 0:e.value)&&(c=s.a.createElement("div",{key:null==e?void 0:e.fieldId,className:GA("lakex-viewer-card-field-content first empty")},kf("未命名记录"))),s.a.createElement("div",{className:"lakex-viewer-card-cell-field"},r.show_field_name&&s.a.createElement("div",{className:"lakex-viewer-card-field-name"},s.a.createElement(s.a.Fragment,null,l&&s.a.createElement(l,{size:16}),null==t?void 0:t.name)),c,o&&!c&&s.a.createElement("div",{className:GA("lakex-viewer-card-field-content",`${t.type}`,{first:0===n})},s.a.createElement(o,{key:null==e?void 0:e.cellId,cell:e,field:t,fieldProps:a,readonly:!0})))},Fle=200,Vle=300,Lle=({fieldMap:e,cell:t,index:r,viewConfig:n})=>{const i=e.get(t.fieldId);return i?s.a.createElement(Dle,{cell:t,field:i,viewConfig:n,index:r}):null},$le=e=>{var t,r;const{className:n,record:i,width:o=Fle,height:l=Vle,viewConfig:c,fieldMap:u,disableDrag:d=!1}=e,{isSelected:f,isInHighlight:p,onShowRecord:h,onShowContextMenu:m}=(({record:e})=>{const t=zA(ire),r=zA(Zj),n=n3();return{isSelected:Object(a.useMemo)((()=>!!n&&n.getRangeAt(0).recordId===e.record_uuid),[n]),isInHighlight:Wte({recordId:e.record_uuid}),onShowRecord:Object(a.useCallback)((()=>{null==r||r.emitClickRecord({recordId:null==e?void 0:e.record_uuid})}),[e,r]),onShowContextMenu:Object(a.useCallback)((r=>{r.preventDefault(),null==t||t.showContextMenu({e:r,from:nre.CARD_RECORD,recordId:null==e?void 0:e.record_uuid})}),[e,t])}})({record:i}),v=GA("lakex-viewer-card-record-item",n,{selected:f,"in-highlight":p});if(d)return s.a.createElement("div",{className:v,onClick:h,onContextMenu:m,"data-record-uuid":null==i?void 0:i.record_uuid,style:{width:o,height:l}},s.a.createElement(jle,{record:i,width:o}),null==(t=i.cells)?void 0:t.map(((e,t)=>s.a.createElement(Lle,{key:e.fieldType+e.cellId,cell:e,index:t,viewConfig:c,fieldMap:u}))));const{attributes:g,listeners:y,setNodeRef:b,transform:w,transition:_,isDragging:C}=zP({id:i.record_uuid,disabled:d}),E={transform:vN.Transform.toString(w),transition:_,zIndex:C?"100":"auto",opacity:C?0:1};return s.a.createElement("div",{ref:b,className:v,onClick:h,onContextMenu:m,"data-record-uuid":null==i?void 0:i.record_uuid,style:{...E,width:o,height:l},...y,...g},s.a.createElement(jle,{record:i,width:o}),null==(r=i.cells)?void 0:r.map(((e,t)=>s.a.createElement(Lle,{key:e.fieldType+e.cellId,cell:e,index:t,viewConfig:c,fieldMap:u}))))};$le.defaultProps={isShowEmpty:!1,isShowField:!1};const Ble=s.a.forwardRef(((e,t)=>{const{style:r,context:n,...i}=e,{colCount:o,cardWidth:a,gridGap:l}=n;return s.a.createElement("div",{ref:t,...i,style:{...r,display:"grid",gridTemplateColumns:`repeat(${o}, ${a}px)`,columnGap:`${l}px`,padding:`0 ${l}px`}})})),zle=s.a.forwardRef(((e,t)=>{const{context:r,...n}=e,{colCount:i,gridGap:o}=r,a={};return e["data-index"]<i&&(a.paddingTop=`${o}px`),s.a.createElement("div",{...n,style:a})})),Ule=s.a.forwardRef(((e,t)=>{const{fields:r,viewRecords:n,viewFields:i,viewConfig:o}=e,{SelectionContainer:c}=zA(s3)||{},u=s0(Nw.TABLE).isReadonly(),{rootRect:d,cardWidth:f,cardHeight:p,colCount:h,gridGap:m,useWindowScroll:v,customScrollParent:g,customModalContainer:y}=(({viewRecords:e,viewFields:t,viewConfig:r})=>{const n=zA(Tle),i=zA(qf),[o,s]=Object(a.useState)(Fle),[l,c]=Object(a.useState)(Vle),[u,d]=Object(a.useState)(0),[f,p]=Object(a.useState)(),[h,m]=Object(a.useState)((null==i?void 0:i.getValue("view.useWindowScroll"))||!1),v=null==i?void 0:i.getValue("view.customScrollParent"),g=(null==i?void 0:i.getValue("modal.customModalContainer"))||document.body,y=Object(a.useCallback)((()=>{const i=null==n?void 0:n.getLayout(e,t,r);p(null==i?void 0:i.viewRect),s((null==i?void 0:i.width)||Fle),c((null==i?void 0:i.height)||Vle),d((null==i?void 0:i.colCount)||0)}),[e,t,r]);return Object(a.useEffect)((()=>{const e=null==i?void 0:i.onConfigurationChange((({key:e,value:t})=>{"view.useWindowScroll"===e&&(y(),m(t))}));return()=>{null==e||e.destroy()}}),[y]),Object(a.useEffect)((()=>{const e=RA((()=>{h||y()}),300);window.addEventListener("resize",e),window.addEventListener("lakex_table_view_resize",e);const t=null==n?void 0:n.onRefreshLayout((()=>{y()}));return()=>{window.removeEventListener("resize",e),window.removeEventListener("lakex_table_view_resize",e),null==t||t.destroy()}}),[h,y]),Object(a.useEffect)((()=>{y()}),[y]),{rootRect:f,gridGap:null==n?void 0:n.gridGap,cardWidth:o,cardHeight:l,colCount:u,useWindowScroll:h,customScrollParent:v,customModalContainer:g}})({viewRecords:n,viewFields:i,viewConfig:o}),{activeId:b,sensors:w,onDragStart:_,onDragEnd:C}=(()=>{const e=zA(Yre),[t,r]=Object(a.useState)(null);return{activeId:t,sensors:TN(RN(SM,{activationConstraint:{distance:8}})),onDragStart:e=>{r(e.active.id)},onDragEnd:async t=>{r(null);const{active:n,over:i}=t;if(n.id!==i.id){const t=n.id,r=i.id;await e.updateRecordOrder(t,r)}}}})(),E=(()=>{const e=zA(Mle),t=Object(a.useRef)(null);return Object(a.useEffect)((()=>{t.current&&(null==e||e.setVirtuosoRef(t.current))}),[e,t]),t})(),x=Object(a.useMemo)((()=>n.map((e=>({...e,id:e.record_uuid})))),[n]),S=Object(a.useMemo)((()=>n.find((e=>e.record_uuid===b))),[b,n]),k=Object(a.useMemo)((()=>new Map(r.map((e=>[e.uuid,e])))),[r]);if(!o||!n||0===n.length||!i)return null;const O=s.a.createElement("div",{ref:t,className:"lakex-viewer-card"},s.a.createElement("div",{className:"lakex-viewer-card-inner"},s.a.createElement("div",{className:"lakex-viewer-card-content"},s.a.createElement(aP,{sensors:w,modifiers:[GP],collisionDetection:LN,onDragStart:_,onDragEnd:C},s.a.createElement(s.a.Fragment,null,s.a.createElement(jP,{items:x,strategy:TP},s.a.createElement(Jae,{useWindowScroll:v,customScrollParent:g,ref:E,context:{gridGap:m,colCount:h,cardWidth:f,cardHeight:p},components:{List:Ble,Item:zle},style:{width:"100%",height:null==d?void 0:d.height},data:x,itemContent:(e,t)=>s.a.createElement($le,{key:t.record_uuid,record:t,fieldMap:k,viewConfig:o,width:f,height:p,disableDrag:u||!(null==o||!o.keep_sort)})})),Object(l.createPortal)(s.a.createElement(xP,{dropAnimation:null},S?s.a.createElement($le,{record:S,fieldMap:k,viewConfig:o,width:f,height:p}):null),y))))));return c?s.a.createElement(c,null,O):O})),Hle=s.a.forwardRef(((e,t)=>{const r=u0(),n=null==r?void 0:r.fields,i=null==r?void 0:r.viewRecords,o=null==r?void 0:r.viewFields,a=null==r?void 0:r.viewConfig;return s.a.createElement(Ule,{ref:t,fields:n,viewRecords:i,viewFields:o,viewConfig:a})}));class Wle extends rV{constructor(){super(...arguments),this.viewType=Wh.CARD,this.title=kf("画册视图"),this.desc=kf("适合展示图片类数据"),this.icon=e=>s.a.createElement(YP,{type:"CardView",size:16,...e}),this.colorCls="yuque-color-blue-5",this.Component=Hle}}var Gle=Object.defineProperty,Kle=Object.getOwnPropertyDescriptor,qle=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Kle(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Gle(t,r,o),o};let Yle=class{static pluginModule(){return bo().register(this).register(Tle).register(Mle)}init(){}registerViewer(e){e.registerItem(new Wle({onError:e.onError}))}registerScrollService(e){e.setCardScrollService(this._scrollService)}};Yle.pluginName="render-viewer-card",qle([to(Mle)],Yle.prototype,"_scrollService",2),Yle=qle([eo({contrib:[Nj,Fj,W2]})],Yle);const Xle=Fi.defineToken("ViewerKanbanPluginGroupContribution");var Zle=Object.defineProperty,Jle=Object.getOwnPropertyDescriptor,Qle=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Jle(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Zle(t,r,o),o};let ece=class{get Group(){return this._getGroupComponent()}_getGroupComponent(){var e,t;const r=this.viewerKanbanPluginGroupProvider.getContributions({cache:!1});return r[0]?null==(t=(e=r[0]).getGroupComponent)?void 0:t.call(e):null}};Qle([Eo(Xle)],ece.prototype,"viewerKanbanPluginGroupProvider",2),ece=Qle([eo()],ece);const tce=Fi.defineToken("ViewerKanbanGroupActionContribution");var rce=Object.defineProperty,nce=Object.getOwnPropertyDescriptor,ice=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?nce(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&rce(t,r,o),o};let oce=class{constructor(){this.getKanbanGroupActionComponents=()=>{const e=this._viewerKanbanGroupActionProvider.getContributions({cache:!1});if(e.length>0){let t=[];return e.forEach((e=>{var r;const n=null==(r=e.getKanbanGroupActionComponent)?void 0:r.call(e);!n||(Array.isArray(n)?t=t.concat(n):t.push(n))})),t}return null}}getGroup(){const e=this._readService.getActiveView();return e?this._readService.getViewGroup(null==e?void 0:e.uuid):null}getGroupField(){const e=this.getGroup();return null==e?void 0:e.field}getSupportGroupFields(){return this._readService.getAllFields().filter((e=>[Rh.SELECT,Rh.MENTION].includes(e.type)))}getGroupFieldOption(e,t){return e.type===Rh.SELECT?e.options.find((e=>e.uuid===t.value)):e.type===Rh.MENTION?t:null}createGroup(){var e;const t=this._readService.getAllFields(),r={field:{uuid:Io(32),name:Ph(Rh.SELECT,t),type:Rh.SELECT,color:!0,options:[]}};null==(e=this._commandService)||e.execCommand("addField",r)}};ice([Eo(tce)],oce.prototype,"_viewerKanbanGroupActionProvider",2),ice([to(Dy)],oce.prototype,"_readService",2),ice([to(Pb)],oce.prototype,"_commandService",2),oce=ice([eo()],oce);var ace=Object.defineProperty,sce=Object.getOwnPropertyDescriptor,lce=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?sce(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ace(t,r,o),o};let cce=class{constructor(){this.UNGROUP_KEY="ungroup"}toKanbanData(e){return e.map((e=>{var t,r;return{...e,id:(null==(t=e.groupOption)?void 0:t.uuid)||this.UNGROUP_KEY,records:(null==(r=e.records)?void 0:r.map((e=>({...e,id:e.record_uuid}))))||[]}}))}async addRecord(e,t){var r,n;const i=this._readService.getViewRecords();let o;if(o=t?i.find((e=>{var r;return(null==(r=e.groupOption)?void 0:r.uuid)===t.uuid})):i[0],!o)return;const a=o.records.length>0?o.records[0].record_uuid:"",s=await this._commandService.execCommand("addEmptyRecord",{sourceRecordId:a,groupItemKey:t?null==(r=this._readService)?void 0:r.keyValue(t):"",position:"after"}),l=null==s?void 0:s.result;l&&l[0]&&(null==(n=this._renderService)||n.emitClickRecord({recordId:l[0].uuid,isNewRecord:!0}))}};lce([to(Pb)],cce.prototype,"_commandService",2),lce([to(Dy)],cce.prototype,"_readService",2),lce([to(Zj)],cce.prototype,"_renderService",2),cce=lce([eo()],cce);var uce=Object.defineProperty,dce=Object.getOwnPropertyDescriptor,fce=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?dce(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&uce(t,r,o),o};let pce=class{constructor(){this._virtuosoRefs={},this._groupRefs={}}get virtuosoRefs(){return this._virtuosoRefs}get groupRefs(){return this._groupRefs}setVirtuosoRefs(e){this._virtuosoRefs=e}setGroupRefs(e){this._groupRefs=e}scrollIntoView(e,t){var r;null==(r=this._virtuosoRefs[e])||r.scrollIntoView(t)}scrollTo(e,t){var r;null==(r=this._virtuosoRefs[e])||r.scrollTo(t)}getKanbanGroupPositionByRecordId(e,t){var r;let n="",i=-1;for(let o=0;o<t.length;o++){const a=t[o].records||[];for(let s=0;s<a.length;s++)if(a[s].record_uuid===e){n=(null==(r=t[o].groupOption)?void 0:r.uuid)||this._dataServce.UNGROUP_KEY,i=s;break}}return{index:i,groupId:n}}};fce([to(cce)],pce.prototype,"_dataServce",2),pce=fce([eo()],pce);const hce=({groupField:e})=>{const{onAddGroup:t}=(({groupField:e})=>{const t=zA(N2);return{onAddGroup:r=>{null==t||t.showNewGroup(r.target.parentNode,e)}}})({groupField:e});return e?s.a.createElement("div",{className:"lakex-viewer-kanban-group"},s.a.createElement("div",{className:"lakex-table-kanban-group-title"},s.a.createElement("div",{className:"lakex-viewer-kanban-new-group"},s.a.createElement("button",{className:"lakex-table-button lakex-viewer-kanban-new-group-button",onClick:t},s.a.createElement(YP,{type:"Add"}),kf("新建分组"))))):null},mce=e=>{const t=s0(Nw.TABLE).isReadonly();return s.a.createElement("div",{className:"lakex-table-kanban-empty"},s.a.createElement("div",{className:"lakex-table-kanban-empty-body"},s.a.createElement("h1",null,kf("看板暂无分组")),s.a.createElement("p",null,kf("可以快速新建一个单选列进行分组")),s.a.createElement(b.a,{type:"primary",onClick:e.onCreate,disabled:t},kf("新建分组"))))};const vce=({record:e,fields:t,viewConfig:r})=>{var n;const i=zA(ire),o=zA(tD),l=zA(Zj),c=n3(),u=e.record_uuid,d=Object(a.useMemo)((()=>!!c&&c.getRangeAt(0).recordId===u),[c]),f=Wte({recordId:u}),p=Object(a.useCallback)((e=>{e.preventDefault(),null==i||i.showContextMenu({from:nre.KANBAN_RECORD,e:e,recordId:u})}),[u,i]),h=Object(a.useCallback)((()=>{null==l||l.emitClickRecord({recordId:u})}),[u,l]);return s.a.createElement("div",{key:u,className:GA("lakex-viewer-kanban-record",{selected:d,"in-highlight":f}),"data-record-uuid":u,onClick:h,onContextMenu:p},s.a.createElement("div",{className:"lakex-viewer-kanban-field-list"},null==(n=e.cells)?void 0:n.map(((e,n)=>{const i=null==t?void 0:t.find((t=>t.uuid===(null==e?void 0:e.fieldId)));if(!i)return null;const a=o.getFieldComponent(i.type),l=null==o?void 0:o.getFieldIcon(i.type);if(null==(null==e?void 0:e.value)||""==(null==e?void 0:e.value))return 0===n?s.a.createElement("div",{key:e.fieldType+e.cellId,className:"lakex-viewer-kanban-field empty first"},(null==r?void 0:r.show_field_name)&&s.a.createElement("div",{className:"lakex-viewer-kanban-field-name"},s.a.createElement(s.a.Fragment,null,l&&s.a.createElement(l,{size:16}),i.name)),s.a.createElement("div",{className:"lakex-viewer-kanban-field-content"},kf("未命名记录"))):" ";const c=function(e,t){t.value,Kh.isSelectLike(e.type)||Kh.isImage(e.type)||Kh.isSystemDate(e.type)}(i,e);return s.a.createElement("div",{key:e.fieldType+e.cellId,className:GA("lakex-viewer-kanban-field",{first:0===n})},(null==r?void 0:r.show_field_name)&&s.a.createElement("div",{className:"lakex-viewer-kanban-field-name"},l&&s.a.createElement(l,{size:16}),i.name),s.a.createElement("div",{className:"lakex-viewer-kanban-field-content"},a?s.a.createElement(a,{readonly:!0,key:n,cell:e,field:i,fieldProps:c}):null))}))))},gce=({record:e,fields:t,viewConfig:r})=>{const n=s0(Nw.TABLE).isReadonly(),{attributes:i,listeners:o,setNodeRef:a,transform:l,transition:c,isDragging:u}=zP({id:e.record_uuid,disabled:n}),d={transform:vN.Transform.toString(l),transition:c,zIndex:u?"100":"auto",opacity:u?0:1};return s.a.createElement("div",{ref:n?void 0:a,className:"lakex-viewer-kanban-record-container",style:d,...i,...o},s.a.createElement(vce,{key:e.uuid+e.updated_at,record:e,fields:t,viewConfig:r}))},yce=({children:e,...t})=>{const[r,n]=Object(a.useState)(0),i=t["data-known-size"],o={"--child-height":`${r}px`};return Object(a.useEffect)((()=>{n((e=>0===i?e:i))}),[i]),s.a.createElement("div",{...t,className:"height-preserving-kanban-record",style:o},e)};const bce=(e,t,r,n)=>{const i=zA(Dy),o=zA(Yre),s=zA(pce),l=Object(a.useMemo)((()=>Object.keys(t)),[t]),[c,u]=Object(a.useState)(null),d=Object(a.useRef)(null),f=Object(a.useRef)(!1),p=e=>e in t?e:Object.keys(t).find((r=>t[r].map((e=>e.id)).includes(e))),h=Object(a.useCallback)((e=>{var r;if(c&&c in t)return LN({...e,droppableContainers:e.droppableContainers.filter((e=>e.id in t))});const n=(e=>{let{droppableContainers:t,droppableRects:r,pointerCoordinates:n}=e;if(!n)return[];const i=[];for(const e of t){const{id:t}=e,o=r.get(t);if(o&&zN(n,o)){const r=DN(o).reduce(((e,t)=>e+NN(n,t)),0),a=Number((r/4).toFixed(4));i.push({id:t,data:{droppableContainer:e,value:a}})}}return i.sort(PN)})(e);let i=FN(n.length>0?n:BN(e),"id");if(null!=i){if(i in t){const n=t[i];n.length>0&&(i=null==(r=LN({...e,droppableContainers:e.droppableContainers.filter((e=>e.id!==i&&n.map((e=>e.id)).includes(e.id)))})[0])?void 0:r.id)}return d.current=i,[{id:i}]}return f.current&&(d.current=c),d.current?[{id:d.current}]:[]}),[c,t]),m=TN(RN(SM,{activationConstraint:{distance:8}}));return{activeId:c,containers:l,sensors:m,collisionDetectionStrategy:h,onDragStart:e=>{u(e.active.id)},onDragOver:({active:e,over:n})=>{const i=null==n?void 0:n.id;if(null==i||e.id in t)return;const o=p(i),a=p(e.id);!o||!a||a!==o&&r((t=>{const r=t[a],s=t[o],l=s.map((e=>e.id)).indexOf(i),c=r.map((e=>e.id)).indexOf(e.id);let u;if(i in t)u=s.length+1;else{const t=n&&e.rect.current.translated&&e.rect.current.translated.top>n.rect.top+n.rect.height?1:0;u=l>=0?l+t:s.length+1}return f.current=!0,{...t,[a]:t[a].filter((t=>t.id!==e.id)),[o]:[...t[o].slice(0,u),t[a][c],...t[o].slice(u,t[o].length)]}}))},onDragEnd:async({active:r,over:a})=>{var l,c,d,f,h,m;if(r.id in t&&(null==a?void 0:a.id)){if(0===(null==(l=a.data.current.sortable)?void 0:l.index)&&"ungroup"===(null==(c=null==a?void 0:a.data.current.sortable)?void 0:c.items[0]))return;const t=e.find((e=>{var t;return(null==(t=e.groupOption)?void 0:t.uuid)===r.id}));return void await o.updateFieldOptionOrder(t.groupOption.field_uuid,r.id,a.id)}let g;for(const t of e)if(t.records.find((e=>e.record_uuid===r.id))){g=t.id;break}if(!g)return void u(null);const y=null==a?void 0:a.id,b=p(y);if(null!=y){if(b){if((null==n?void 0:n.keep_sort)&&g===b)return void v.a.warn(kf("取消排序后，可进行拖拽"));const a=e.find((e=>e.id===g))||null,l=e.find((e=>e.id===b))||null,c=a.records.map((e=>e.id)).indexOf(r.id),u=t[b].map((e=>e.id)).indexOf(y),p=r.id;let w=null==(d=l.records[u])?void 0:d.record_uuid;if(g===b&&c===u)return;if(g!==b){const e=u===l.records.length,t=i.getOriginViewRecords();if(e)w=null==(f=l.records[u-1])?void 0:f.record_uuid;else if(w){const e=t.findIndex((e=>e.record_uuid===w));w=null==(h=t[e+1])?void 0:h.record_uuid}const r=t.findIndex((e=>e.record_uuid===p)),n=t.findIndex((e=>e.record_uuid===w));r<n&&(w=null==(m=t[n-1])?void 0:m.record_uuid)}if(await o.updateRecordOrder(p,w,a,l),null!=n&&n.keep_sort){const e=i.getViewRecords(n.view_uuid),{index:r,groupId:o}=s.getKanbanGroupPositionByRecordId(t[g].records[c].record_uuid,e);return s.scrollIntoView(o,{index:r,align:"start"}),void v.a.warn(kf("当前处于保持排序状态，为您重新定位"))}}u(null)}else u(null)},onDragCancel:()=>{u(null)},findContainer:p,getIndex:e=>{const r=p(e);return r?t[r].map((e=>e.id)).indexOf(e):-1}}},wce=s.a.forwardRef(((e,t)=>{const{isReadonly:r,kanbanService:n,kanbanGroupService:i,scrollService:o,fields:c,viewConfig:u,isEmpty:d,data:f,items:p,setItems:h,ungroupId:m,groupRef:v,SelectionContainer:g,useWindowScroll:y,customScrollParent:b,customModalContainer:w}=function(){const e=zA(ece),t=zA(oce),r=zA(cce),{SelectionContainer:n}=zA(s3)||{},i=zA(pce),o=zA(qf),s=s0(Nw.TABLE).isReadonly(),l=u0(),c=null==r?void 0:r.UNGROUP_KEY,u=l.viewRecords,d=(null==r?void 0:r.toKanbanData(u))||[],f=Object(a.useRef)({}),[p,h]=Object(a.useState)((()=>{const e={};return d.forEach((t=>{e[t.id]=t.records})),e})),[m,v]=Object(a.useState)(null==o?void 0:o.getValue("view.useWindowScroll")),g=null==o?void 0:o.getValue("view.customScrollParent"),y=(null==o?void 0:o.getValue("modal.customModalContainer"))||document.body;return Object(a.useEffect)((()=>{f.current&&(null==i||i.setGroupRefs(f.current))}),[i,f]),Object(a.useEffect)((()=>{const e=(null==r?void 0:r.toKanbanData(u))||[];h((()=>{const t={};return e.forEach((e=>{t[e.id]=e.records})),t}))}),[u]),Object(a.useEffect)((()=>{const e=null==o?void 0:o.onConfigurationChange((({key:e,value:t})=>{"view.useWindowScroll"===e&&v(t)}));return()=>{null==e||e.destroy()}}),[]),{isReadonly:s,ungroupId:c,fields:l.fields,viewConfig:l.viewConfig,group:l.group,isEmpty:!l.group,data:d,items:p,setItems:h,kanbanService:e,kanbanGroupService:t,scrollService:i,groupRef:f,SelectionContainer:n,useWindowScroll:m,customScrollParent:g,customModalContainer:y}}(),{activeId:_,containers:C,sensors:E,collisionDetectionStrategy:x,onDragStart:S,onDragOver:k,onDragEnd:O,onDragCancel:I}=bce(f,p,h,u),R=n.Group,T=Object(a.useRef)({}),A=Object(a.useMemo)((()=>{if(_&&!C.includes(_))for(const e of Object.values(p)){const t=e.find((e=>e.record_uuid===_));if(t)return t}return null}),[_,C,p]);if(Object(a.useEffect)((()=>{T.current&&(null==o||o.setVirtuosoRefs(T.current))}),[o,T]),!i)return null;let N;N=d?s.a.createElement("div",{className:"lakex-viewer-kanban-content empty"},s.a.createElement(mce,{onCreate:()=>null==i?void 0:i.createGroup()})):s.a.createElement("div",{className:"lakex-viewer-kanban-content"},s.a.createElement(aP,{sensors:E,modifiers:[GP],collisionDetection:x,measuring:{droppable:{strategy:PM.Always}},onDragStart:S,onDragOver:k,onDragEnd:O,onDragCancel:I},s.a.createElement(s.a.Fragment,null,s.a.createElement(jP,{items:C,strategy:RP},null==C?void 0:C.map((e=>{const t=f.find((t=>t.id===e));return t&&R?s.a.createElement(R,{key:e,ref:t=>{t&&(v.current[e]=t.getRecordsRef())},groupId:e,items:p[e],disableDrag:e===m,groupField:t.groupField,groupOption:t.groupOption},s.a.createElement(jP,{items:p[e],strategy:NP},s.a.createElement(Cae,{useWindowScroll:y,customScrollParent:b,ref:t=>{T.current[e]=t},components:{Item:yce},data:p[e],className:"lakex-viewer-kanban-group-scorller",itemContent:(e,t)=>s.a.createElement(gce,{key:t.record_uuid,record:t,fields:c,viewConfig:u})}))):null}))),Object(l.createPortal)(s.a.createElement(xP,{dropAnimation:null},A&&s.a.createElement(vce,{record:A,fields:c,viewConfig:u})),w))),!r&&s.a.createElement(hce,{groupField:i.getGroupField()}));const M=s.a.createElement("div",{ref:t,className:"lakex-viewer-kanban"},s.a.createElement("div",{className:"lakex-viewer-kanban-inner"},N));return g?s.a.createElement(g,null,M):M}));class _ce extends rV{constructor(){super(...arguments),this.viewType=Wh.KANBAN,this.title=kf("看板视图"),this.desc=kf("任务流转一目了然"),this.icon=e=>s.a.createElement(YP,{type:"KanbanView",size:16,...e}),this.colorCls="yuque-color-cyan-5",this.Component=wce}}var Cce=Object.defineProperty,Ece=Object.getOwnPropertyDescriptor,xce=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Ece(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Cce(t,r,o),o};let Sce=class{static pluginModule(){return bo().contribution(Xle).contribution(tce).register(this).register(ece).register(oce).register(cce).register(pce)}init(){}registerViewer(e){e.registerItem(new _ce({onError:e.onError}))}registerScrollService(e){e.setKanbanScrollService(this._scrollService)}};Sce.pluginName="render-viewer-kanban",xce([to(pce)],Sce.prototype,"_scrollService",2),Sce=xce([eo({contrib:[Nj,Fj,W2]})],Sce);const kce=e=>{var t;const{count:r=0,groupField:n,groupOption:i}=e,{isReadonly:o,getFieldComponent:l,getKanbanGroupActions:c,onOpenSetting:u}=function(e){const{groupField:t,groupOption:r}=e,n=zA(tD),i=zA(oce),o=zA(N2),s=s0(Nw.TABLE).isReadonly(),l=Object(a.useCallback)((e=>{if(s)return;const n=e.target.closest(".lakex-viewer-kanban-group-header");null==o||o.showEditGroup(n,t,r)}),[t,r]);return{isReadonly:s,onOpenSetting:l,getFieldComponent:e=>n.getFieldComponent(e),getKanbanGroupActions:()=>null==i?void 0:i.getKanbanGroupActionComponents()}}(e),d=l(n.type);return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"lakex-table-kanban-group-title"},s.a.createElement("div",{className:"lakex-table-kanban-group-title-content",onClick:u},d&&s.a.createElement(d,{readonly:!0,field:n,cell:i,checkCell:!1,writeable:!1,disableOpen:!0})),s.a.createElement("div",{className:"lakex-table-kanban-group-title-count"},r)),n&&i&&!o&&s.a.createElement("div",{className:"lakex-table-kanban-group-actions"},null==(t=c())?void 0:t.map(((e,t)=>e?s.a.createElement(e,{key:t,groupField:n,groupOption:i}):null))))},Oce=({count:e=0,groupField:t,groupOption:r})=>{const n=zA(cce),i=s0(Nw.TABLE).isReadonly();return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"lakex-table-kanban-group-title"},s.a.createElement("div",{className:"lakex-table-kanban-group-title-content"},kf("未分组")),s.a.createElement("div",{className:"lakex-table-kanban-group-title-count"},e)),s.a.createElement("div",{className:"lakex-table-kanban-group-actions"},!i&&s.a.createElement(h.a,{title:kf("添加记录"),placement:"bottom",overlayClassName:"lakex-table-toolbar-tooltip"},s.a.createElement("button",{className:"lakex-table-button",onClick:()=>null==n?void 0:n.addRecord(t,r)},s.a.createElement(YP,{type:"Add"})))))},Ice=s.a.forwardRef((({groupId:e,items:t,disableDrag:r,groupField:n,groupOption:i,children:o},l)=>{const c=s0(Nw.TABLE).isReadonly(),u=i&&n,d=t.length,f=Object(a.useRef)(null),{attributes:p,listeners:h,setNodeRef:m,transform:v,transition:g,isDragging:y}=zP({id:e,data:{type:"container",children:t},disabled:c||r}),b={transform:r?"":vN.Transform.toString(v),transition:y?g:"",zIndex:y?"100":"auto"};return Object(a.useImperativeHandle)(l,(()=>({getRecordsRef:()=>f.current}))),s.a.createElement("div",{ref:m,className:"lakex-viewer-kanban-group",style:b,...p},s.a.createElement("div",{className:GA("lakex-viewer-kanban-group-header",{"disable-drag":r}),...h},u?s.a.createElement(kce,{count:d,groupField:n,groupOption:i}):s.a.createElement(Oce,{count:d,groupField:n,groupOption:i})),s.a.createElement("div",{ref:f,className:"lakex-table-kanban-group-records"},o))})),Rce=({groupField:e,groupOption:t,name:r})=>{const n=zA(cce);return e&&t?s.a.createElement(h.a,{title:kf("添加记录"),placement:"card"===r?"bottomRight":"bottom",overlayClassName:"lakex-table-toolbar-tooltip"},s.a.createElement("button",{className:"lakex-table-button",onClick:()=>null==n?void 0:n.addRecord(e,t)},s.a.createElement(YP,{type:"Add"}))):null};var Tce=Object.defineProperty,Ace=Object.getOwnPropertyDescriptor,Nce=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Ace(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Tce(t,r,o),o};let Mce=class extends Zf{constructor(){super(...arguments),this._onAddGroupRecordClick=this._register(new op),this.onAddGroupRecordClick=this._onAddGroupRecordClick.event,this._onGroupSettingClick=this._register(new op),this.onGroupSettingClick=this._onGroupSettingClick.event}openSettingModal(e,t,r,n){this._onGroupSettingClick.emit({target:e.target,groupField:t,groupOption:r,$title:n})}destroy(){super.destroy()}};Nce([Si()],Mce.prototype,"destroy",1),Mce=Nce([eo()],Mce);const Pce=({groupField:e,groupOption:t})=>{const{onOpenSetting:r}=(({groupField:e,groupOption:t})=>{const r=zA(Mce);return{onOpenSetting:Object(a.useCallback)((n=>{const i=n.target.closest(".lakex-viewer-kanban-group-header");null==r||r.openSettingModal(n,e,t,i)}),[e,t])}})({groupField:e,groupOption:t});return e&&t?s.a.createElement("button",{className:"lakex-table-button",onClick:e=>r(e)},s.a.createElement(YP,{type:"MoreHorizontal"})):null};var jce=Object.defineProperty,Dce=Object.getOwnPropertyDescriptor;let Fce=class{static pluginModule(){return bo().register(this).register(Mce)}getKanbanGroupActionComponent(){return[Rce,Pce]}getGroupComponent(){return Ice}};Fce.pluginName="render-viewer-kanban-group",Fce=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Dce(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&jce(t,r,o),o})([eo({contrib:[Xle,tce]})],Fce);const Vce=[a0,E0,A0,L0,K0,t1,c1,m1,_1,O1,M1,B1,Y1,n2,d2,b2,I2,j2,U2,Ute,Qte,sre,gre,Ere,Ore,$re,Hre,Qre,nne,sne,dne,yne,cle,wle,Ele,kle,Yle,Sce,Fce],Lce=Object(a.forwardRef)(((e,t)=>{const r=zA(OJ),n=zA(qf),i=zA(s_),o=zA(Lj),l=r.Buttons,c=cj(),u=Object(a.useRef)(null),d=Object(a.useRef)(),f=Object(a.useRef)(0);Object(a.useEffect)((()=>{const e=i.onDataLoaded((()=>{c()})),t=i.onDataChanged((()=>{c()}));return()=>{e.destroy(),t.destroy()}}),[]),Object(a.useEffect)((()=>{const e=null==o?void 0:o.onStatusChange((()=>{c()}));return()=>{null==e||e.destroy()}}),[o]),Object(a.useEffect)((()=>{if(u.current)return d.current=new ResizeObserver((e=>{const t=e[0].contentRect.height;f.current!==t&&(f.current=e[0].contentRect.height,window.dispatchEvent(new CustomEvent("lakex_table_view_resize")))})),d.current.observe(u.current),()=>{var e;null==(e=d.current)||e.disconnect()}}),[]),Object(a.useImperativeHandle)(t,(()=>({refresh:c})));const p=r.filterVisibleButtons(n.getValue("toolbar.topLeft")),h=r.filterVisibleButtons(n.getValue("toolbar.topRight")),m=r.filterVisibleButtons(n.getValue("toolbar.left")),v=r.filterVisibleButtons(null!=o&&o.isActive?n.getValue("toolbar.right"):[]),g=n.getValue("toolbar.mode"),y=0!==p.length||0!==h.length;return s.a.createElement("div",{ref:u,className:"lakex-workbench-toolbar-container"},s.a.createElement("div",{className:GA("lakex-table-workbench-toolbar",{"lakex-table-workbench-toolbar-multi-row":y})},(p.length>0||h.length>0)&&s.a.createElement("div",{className:"lakex-table-workbench-toolbar-top-section"},s.a.createElement("div",{className:"lakex-table-workbench-toolbar-group lakex-table-workbench-toolbar-group-left"},p.length>0?s.a.createElement(l,{buttons:p,mode:g}):null),s.a.createElement("div",{className:"lakex-table-workbench-toolbar-group lakex-table-workbench-toolbar-group-right"},h.length>0?s.a.createElement(l,{buttons:h,mode:g}):null)),(m.length>0||v.length>0)&&s.a.createElement("div",{className:"lakex-table-workbench-toolbar-main-section"},s.a.createElement("div",{className:"lakex-table-workbench-toolbar-group lakex-table-workbench-toolbar-group-left"},m.length>0?s.a.createElement(l,{buttons:m,mode:g}):null),s.a.createElement("div",{className:"lakex-table-workbench-toolbar-group lakex-table-workbench-toolbar-group-right"},v.length>0?s.a.createElement(l,{buttons:v,mode:g}):null))))}));var $ce=Object.defineProperty,Bce=Object.getOwnPropertyDescriptor;let zce=class{static pluginModule(){return bo().register(this)}static registerConfiguration(e){e.registerConfiguration({id:"toolbar",type:"object",title:"工具栏",properties:{left:{type:"array",description:"左侧工具栏"},right:{type:"array",description:"右侧工具栏"},topLeft:{type:"array",description:"左上工具栏"},topRight:{type:"array",description:"右上工具栏"},mode:{type:"string",description:"展示模式",enum:Object.values(TJ)}}}),e.registerDefaultValue({"toolbar.mode":TJ.NORMAL})}init(){}registerToolbar(e){e.registerRender(Lce)}};zce.pluginName="workbench-toolbar",zce=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Bce(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&$ce(t,r,o),o})([eo({contrib:[PA,IJ]})],zce);var Uce=Object.defineProperty,Hce=Object.getOwnPropertyDescriptor,Wce=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Hce(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Uce(t,r,o),o};let Gce=class{getDefaultFilter(){const e=this._readService.getActiveView();if(!e)return;const t=this._readService.getViewFilters(e.uuid);let r;if(0===t.length){const t=this._readService.getViewFields(null==e?void 0:e.uuid);if(!t)return;r=t[0].field}else{const e=t[t.length-1].field_uuid;r=this._readService.getField(e)}if(!r)return;const n=this.getConditions(r.type);return{uuid:Io(32),field_uuid:r.uuid,func:n[0].func,expected:null,operator:t.length>0?t[t.length-1].operator:Vh.And}}getFilterByFieldId(e){const t=this._readService.getField(e);if(!t)return;const r=this.getConditions(t.type);return{uuid:Io(32),field_uuid:t.uuid,func:r[0].func,expected:null,operator:Vh.And}}getConditions(e){const t=Uh[e];return zh.filter((e=>e.type===t))}getMentionFieldValues(e){const t=this._readService.getFieldCells(e);let r=[];return null==t||t.forEach((e=>{Array.isArray(null==e?void 0:e.value)?r=r.concat(null==e?void 0:e.value):e.value&&r.push(e.value)})),xd(r,"uid")}};Wce([to(Dy)],Gce.prototype,"_readService",2),Gce=Wce([eo()],Gce);const Kce="lakex-table-filter-modal-empty",qce=()=>s.a.createElement("div",{className:Kce},s.a.createElement("div",{className:`${Kce}-desc`},kf("还未设置任何筛选"))),Yce=e=>{const t=zA(Dy),r=null==t?void 0:t.getActiveView(),n=null==t?void 0:t.getViewFields(null==r?void 0:r.uuid,!1),i=null==n?void 0:n.filter((t=>{var r,n;return!(!e.defaultValue||(null==(r=t.field)?void 0:r.uuid)!==e.defaultValue)||Kh.isFilter(null==(n=t.field)?void 0:n.type)})),o=null==t?void 0:t.getViewFieldGroups(null==r?void 0:r.uuid);return{filterFields:i,groupMap:Object(a.useMemo)((()=>{const e={};return null==o||o.forEach((t=>{e[t.uuid]=t})),e}),[o])}},Xce=({filter:e,bordered:t=!0,className:r,defaultValue:n="",onFieldChange:i=(()=>{})})=>{const{filterFields:o,groupMap:a}=Yce({defaultValue:n}),l=zA(tD);return s.a.createElement(x.a,{className:`lakex-table-filter-field-select ${r}`,defaultValue:n,dropdownClassName:"lakex-table-filter-field-select-dropdown",suffixIcon:s.a.createElement(YP,{type:"ArrowDown",size:12}),onChange:t=>{const r=null==o?void 0:o.find((e=>{var r;return(null==(r=e.field)?void 0:r.uuid)===t}));i(e,null==r?void 0:r.field)},bordered:t},null==o?void 0:o.map((e=>{var t,r,n,i,o;const c=null==l?void 0:l.getFieldIcon(null==(t=e.field)?void 0:t.type);return s.a.createElement(x.a.Option,{value:null==(r=e.field)?void 0:r.uuid,key:null==(n=e.field)?void 0:n.uuid},c&&s.a.createElement(c,null),s.a.createElement("div",{className:"lakex-table-filter-field-select-name"},e.group_uuid?`${a[e.group_uuid].name}-${null==(i=e.field)?void 0:i.name}`:null==(o=e.field)?void 0:o.name))})))},Zce=({filter:e,onFuncChange:t})=>{const r=zA(Gce),n=zA(Dy),i=null==n?void 0:n.getField(e.field_uuid),o=null==r?void 0:r.getConditions(null==i?void 0:i.type);return null!=o&&o.some((t=>t.func===e.func))||t(e,null==o?void 0:o[0].func),{conditions:o}},Jce=({filter:e,onFuncChange:t=(()=>{})})=>{const{conditions:r}=Zce({filter:e,onFuncChange:t});return s.a.createElement(x.a,{value:e.func||(null==r?void 0:r[0].func),dropdownClassName:"lakex-table-menu-item",suffixIcon:s.a.createElement(YP,{type:"ArrowDown",size:12}),style:{marginRight:5,width:110},onChange:r=>{t(e,r)}},null==r?void 0:r.map((e=>s.a.createElement(x.a.Option,{value:e.func,key:e.func},e.text))))},Qce=({filter:e})=>{const t=zA(Dy),r=zA(Gce);return{getMentionValues:()=>null==r?void 0:r.getMentionFieldValues(e.field_uuid),field:null==t?void 0:t.getField(e.field_uuid)}},eue=({filter:e,onExpectedChange:t=(()=>{})})=>{var r,n;const{getMentionValues:i,field:o}=Qce({filter:e}),a=null==o?void 0:o.type;if(a===Rh.DATE||Hh.includes(e.func))return null;let l;if(a===Rh.SELECT||a===Rh.MULTI_SELECT){let i=(null==e?void 0:e.expected)||[];"string"==typeof(null==e?void 0:e.expected)&&(i=null==e?void 0:e.expected.split(","));const c=null==(r=null==o?void 0:o.options)?void 0:r.filter((e=>i.includes(e.uuid))).map((e=>e.uuid));l=s.a.createElement(x.a,{value:c,dropdownClassName:"lakex-table-menu-item",suffixIcon:s.a.createElement(YP,{type:"ArrowDown",size:12}),onChange:r=>{var n,i;if(null==r||""===r||0===r.length)return void t(e,"");if("select"===a)return void t(e,r);const o=[];null==(i=null==(n=e.field)?void 0:n.options)||i.forEach((e=>{r.includes(e.uuid)&&o.push(e.uuid)})),t(e,o)},mode:"multiSelect"===a?"multiple":null},null==(n=null==o?void 0:o.options)?void 0:n.map(((e,t)=>s.a.createElement(x.a.Option,{key:t,value:e.uuid},e.name))))}else if("checkbox"===a)l=s.a.createElement("span",{className:"lakex-table-filter-checkbox"},s.a.createElement(p.a,{defaultChecked:!0===Boolean(e.expected),onChange:r=>{t(e,r.target.checked?"true":"false")}}));else if(Kh.isMentionLike(a)){const r=i()||[],n={};null==r||r.forEach((e=>{n[e.uid]=e}));const o=null!=e&&e.expected?e.expected.split(","):[];l=s.a.createElement(x.a,{value:o,dropdownClassName:"lakex-table-menu-item",suffixIcon:s.a.createElement(YP,{type:"ArrowDown",size:12}),onChange:r=>{const i=r.map((e=>n[e]));i.sort(((e,t)=>e.name.localeCompare(t.name))),t(e,0===r.length?"":i.map((e=>e.uid)).join(","))},mode:"multiple"},null==r?void 0:r.map(((e,t)=>s.a.createElement(x.a.Option,{key:t,value:e.uid+""},s.a.createElement("span",{className:"lakex-table-selector-avatar"},s.a.createElement("img",{src:e.icon})),e.name))))}else l=s.a.createElement(HA,{placeholder:kf("请输入"),defaultValue:e.expected,onChange:r=>{t(e,r.target.value)}});return s.a.createElement("div",{className:"lakex-table-select-expected"},l)},tue=({index:e,filter:t,onOperatorChange:r=(()=>{})})=>{if(0===e)return s.a.createElement("div",{className:"lakex-table-filter-where"},kf("当"));if(1===e)return s.a.createElement(x.a,{value:t.operator,dropdownClassName:"lakex-table-menu-item",suffixIcon:s.a.createElement(YP,{type:"ArrowDown",size:12}),onChange:e=>{r(t,e)},style:{width:"70px",marginRight:5}},s.a.createElement(x.a.Option,{value:Vh.And},kf("并且")),s.a.createElement(x.a.Option,{value:Vh.Or},kf("或者")));const n=t.operator===Vh.And?kf("并且"):kf("或者");return s.a.createElement("div",{className:"lakex-table-filter-where"},n)},rue=({filter:e,index:t=0,onRemove:r=(()=>{}),onFieldChange:n=(()=>{}),onExpectedChange:i=(()=>{}),onFuncChange:o=(()=>{}),onOperatorChange:a=(()=>{})})=>s.a.createElement("div",{className:"lakex-table-filter-item"},s.a.createElement(YP,{type:"Close",onClick:()=>{r(e)},size:14}),s.a.createElement(tue,{index:t,filter:e,onOperatorChange:a}),s.a.createElement(Xce,{filter:e,defaultValue:e.field_uuid,onFieldChange:n}),s.a.createElement(Jce,{filter:e,onFuncChange:o}),s.a.createElement(eue,{filter:e,onExpectedChange:i})),nue=({onAddFilter:e=(()=>{})})=>s.a.createElement("div",{className:"lakex-table-add-filter",onClick:e},s.a.createElement(YP,{type:"Add"}),kf("添加筛选")),iue=()=>{const e=zA(Pb),t=zA(Dy),r=zA(Gce),n=null==t?void 0:t.getActiveView(),i=null==t?void 0:t.getActiveViewData(["fields","viewConfig"]),o=null==t?void 0:t.getViewFilters(null==n?void 0:n.uuid,["field"]),s=null==i?void 0:i.viewConfig,[l,c]=Object(a.useState)(o||[]);return{state:{filters:l},fields:null==i?void 0:i.fields,onAddFilter(){const t=[...l],n=null==r?void 0:r.getDefaultFilter();!n||(t.push(n),null==e||e.execCommand("createFilter",{viewId:null==s?void 0:s.view_uuid,filter:n}).then((()=>{c(t)})))},onRemoveFilter(t){const r=[...l];yd(r,(e=>e.uuid===t.uuid)),null==e||e.execCommand("removeFilter",{filterId:t.uuid}).then((()=>{c(r)}))},onFieldChange(t,n){var i;const o=[...l];for(const a of o)if(a.uuid===t.uuid){a.field_uuid=n.uuid;const t=r.getConditions(null==n?void 0:n.type);a.func=null==(i=t[0])?void 0:i.func,a.expected=null,(null==n?void 0:n.type)===Rh.CHECKBOX&&(a.expected="true"),a.field=n,null==e||e.execCommand("updateFilter",{viewId:null==s?void 0:s.view_uuid,filter:a}).then((()=>{c(o)}));break}},onFuncChange(t,r){const n=[...l];for(const i of n)if(i.uuid===t.uuid){i.func=r,null==e||e.execCommand("updateFilter",{viewId:null==s?void 0:s.view_uuid,filter:i}).then((()=>{c(n)}));break}},onExpectedChange(t,r){const n=[...l];for(const i of n)if(i.uuid===t.uuid){Array.isArray(r)&&(r=r.join(",")),i.expected=r,null==e||e.execCommand("updateFilter",{viewId:null==s?void 0:s.view_uuid,filter:i}).then((()=>{c(n)}));break}},onOperatorChange(t,r){const n=[...l];for(const e of n)e.operator=r;null==e||e.execCommand("updateFilter",{viewId:null==s?void 0:s.view_uuid,filter:n}).then((()=>{c(n)}))}}},oue=()=>{const{state:e,onAddFilter:t,onRemoveFilter:r,onFieldChange:n,onFuncChange:i,onExpectedChange:o,onOperatorChange:a}=iue();let l;return l=0===e.filters.length?s.a.createElement(qce,null):e.filters.map(((e,t)=>s.a.createElement(rue,{key:e.field_uuid+"_"+t,index:t,filter:e,onRemove:r,onFieldChange:n,onFuncChange:i,onExpectedChange:o,onOperatorChange:a}))),s.a.createElement("div",{className:"lakex-table-filter-modal"},l,s.a.createElement(nue,{onAddFilter:t}))},aue=e=>e.showCloseIcon||e.title?s.a.createElement("div",{className:"lakex-table-ui-popup-header",onClick:e.onClose},e.title&&s.a.createElement("h1",{className:"lakex-table-ui-popup-header-title"},e.title),e.showCloseIcon&&s.a.createElement(YP,{className:"lakex-table-ui-popup-close-icon",type:"Close",size:18})):null,sue=({title:e,showCloseIcon:t,onClose:r,children:n})=>s.a.createElement("div",{className:GA("lakex-table-ui-popup")},s.a.createElement(aue,{title:e,onClose:r,showCloseIcon:!!t}),s.a.createElement("div",{className:GA("lakex-table-ui-popup-content")},n)),lue=e=>{const t={maxWidth:e.maxWidth,...e.style&&e.style};return s.a.createElement("span",{style:t,className:GA("lakex-table-ui-text-ellipsis",e.className)},e.children)},cue=e=>s.a.createElement(S.a,{...e,className:GA("lakex-table-h5-switch",e.className)}),uue=({options:e,className:t,style:r,onChange:n,defaultValue:i})=>{const[o,l]=Object(a.useState)(i),c={...r&&r};(!Array.isArray(e)||2!==e.length)&&console.error("options length is valid!");return s.a.createElement("div",{style:c,className:GA("lakex-table-h5-choose",t)},e.map((e=>s.a.createElement("div",{key:e.value,className:GA("lakex-table-h5-choose-item",o===e.value&&"active"),onClick:()=>(e=>{l(e.value),n(e)})(e)},s.a.createElement("span",{className:"lakex-table-h5-choose-item-desc"},e.label)))))},due=e=>{const[t,r]=Object(a.useState)(e.list);return s.a.createElement("ul",{className:"lakex-table-ui-list-switch"},t.map((n=>s.a.createElement("li",{className:"lakex-table-ui-item-switch",key:n.key},s.a.createElement("div",{className:"lakex-table-ui-item-left"},n.icon,s.a.createElement(lue,{className:"lakex-table-ui-item-name"},null==n?void 0:n.title)),s.a.createElement(cue,{disabled:n.disabled,checked:n.checked,onChange:i=>{n.checked=i,e.onSwitch(n,i),r([...t])}})))))},fue=e=>{const[t,r]=Object(a.useState)(e.defaultValue);return s.a.createElement("ul",{className:"lakex-table-ui-list-check"},e.list.map((n=>{const i=Array.isArray(t)?t.includes(n.key):n.key===t;return s.a.createElement("li",{className:"lakex-table-ui-item-check",key:n.key,onClick:()=>{if(e.multiple){const i=[...t],o=i.findIndex((e=>e===n.key));o>-1?i.splice(o,1):i.push(n.key),r(i),e.onCheck(e.list.filter((e=>i.includes(e.key))))}else r(n.key),e.onCheck(n)}},s.a.createElement("div",{className:"lakex-table-ui-item-left"},n.icon,s.a.createElement(lue,{className:"lakex-table-ui-item-name"},null==n?void 0:n.title)),i&&s.a.createElement(YP,{type:"Check",size:"16"}))})))},pue=e=>{const[t,r]=Object(a.useState)(e.list);return s.a.createElement("ul",{className:"lakex-table-ui-list-choose"},t.map((n=>s.a.createElement("li",{className:"lakex-table-ui-item-choose",key:n.key},s.a.createElement("div",{className:"lakex-table-ui-item-left"},s.a.createElement(lue,{className:"lakex-table-ui-item-name"},null==n?void 0:n.title)),s.a.createElement(uue,{defaultValue:n.defaultValue,options:n.options,onChange:i=>{n.defaultValue=i.value,e.onChoose(n,i),r([...t])}})))))},hue=e=>{const[t,r]=Object(a.useState)(e.list);return Object(a.useEffect)((()=>{r(e.list)}),[e.list]),s.a.createElement("ul",{className:"lakex-table-ui-list-select"},t.map((t=>{const r=t.options.find((e=>e.value===t.defaultValue));return s.a.createElement("li",{className:"lakex-table-ui-item-select",key:t.key},s.a.createElement("div",{className:"lakex-table-ui-item-left"},s.a.createElement(lue,{className:"lakex-table-ui-item-name"},t.title)),s.a.createElement("div",{className:"lakex-table-ui-item-right",onClick:()=>{e.onSelect(t)}},s.a.createElement(lue,{className:"lakex-table-ui-item-name"},(null==r?void 0:r.label)||""),s.a.createElement(YP,{type:"ArrowRight",size:18})))})))},mue=e=>{const t={...e.style&&e.style};return s.a.createElement("div",{className:GA("lakex-table-empty-no-data",e.className),style:t},s.a.createElement("div",{className:"intrinsic-aspect-ratio-container"},s.a.createElement("div",{className:"lakex-table-empty-no-data-inner"})),e.desc&&s.a.createElement("p",{className:"lakex-table-empty-no-data-desc"},e.desc),e.children&&e.children)},vue=e=>{const{text:t="",prefixIcon:r="",className:n,style:i={},border:o,children:a,autoWrap:l}=e;return s.a.createElement("div",{className:GA("lakex-table-select-bar",o&&"lakex-table-select-bar-has-border",l&&"lakex-table-select-bar-auto-wrap",n),onClick:e.onClick,style:i},r&&s.a.createElement("span",{className:"prefix-icon"},r),a||s.a.createElement(lue,{className:"lakex-table-select-bar-text"},t),s.a.createElement(YP,{type:"ArrowDown",className:"arrow-down"}))};vue.defaultProps={border:!0,autoWrap:!1};const gue=({option:e,style:t,className:r})=>{const n=zA(rk),i={...t&&t,...e.color?{background:n.getRenderColor(e.color),color:n.getRenderTextColor(e.color)}:{}};return s.a.createElement(lue,{className:GA("lakex-table-select-tag",r),style:i},e.value)},yue=({mention:e,style:t,className:r})=>{const n={...t&&t};return s.a.createElement("div",{className:GA("lakex-table-mention-tag",r),style:n},s.a.createElement("img",{className:"lakex-table-mention-tag-avatar",src:e.avatar_url,alt:"avatar"}),s.a.createElement(lue,{className:"lakex-table-mention-tag-name"},e.name))},bue=({onAddFilter:e=(()=>{})})=>s.a.createElement("div",{className:"lakex-table-h5-empty"},s.a.createElement(mue,{desc:kf("你还未进行任何筛选"),className:"no-data"}),s.a.createElement(b.a,{type:"primary",onClick:()=>e(),className:"no-data-btn"},s.a.createElement(YP,{type:"Add"}),kf("添加筛选条件"))),wue=({index:e,filter:t,onOperatorChange:r=(()=>{})})=>{const n=zA(qf),i=zA(tQ),o=n.getValue("modal.mode"),l=Object(a.useCallback)((()=>{i.close("filter-select-operator")}),[]);if(0===e)return s.a.createElement("div",{className:"lakex-table-h5-filter-where"},kf("当"));const c=t.operator===Vh.And?kf("并且"):kf("或者");return s.a.createElement("div",{className:"lakex-table-h5-filter-where"},s.a.createElement(vue,{className:"lakex-table-h5-filter-col",text:c,onClick:()=>{i.open("filter-select-operator",{initialState:{value:t.operator}})}}),s.a.createElement(PQ,{id:"filter-select-operator",mode:o,hasMask:o===eQ.DRAWER,hasAnimation:o===eQ.DRAWER,position:o===eQ.DRAWER?{placement:"bottom"}:void 0,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:({initialState:e})=>s.a.createElement(sue,{title:kf("请选择"),onClose:l,showCloseIcon:!0},s.a.createElement(fue,{defaultValue:e.value,list:[{key:Vh.And,title:kf("并且")},{key:Vh.Or,title:kf("或者")}],onCheck:e=>{l(),r(t,e.key)}}))}))},_ue=({filter:e,className:t="",defaultValue:r="",onFieldChange:n=(()=>{})})=>{const{filterFields:i,groupMap:o}=Yce({defaultValue:r}),l=zA(qf),c=zA(tQ),u=l.getValue("modal.mode"),d=zA(tD),f=Object(a.useCallback)((()=>{c.close("filter-field-select")}),[]),p=(null==e?void 0:e.field)||(null==i?void 0:i[0].field);if(!p)return null;const h=null==d?void 0:d.getFieldIcon(p.type);return s.a.createElement("div",{className:t},s.a.createElement(vue,{prefixIcon:h,className:"lakex-table-h5-filter-col",text:p.name,onClick:()=>{c.open("filter-field-select",{initialState:{value:r}})}}),s.a.createElement(PQ,{id:"filter-field-select",mode:u,hasMask:u===eQ.DRAWER,hasAnimation:u===eQ.DRAWER,position:u===eQ.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:({initialState:t})=>s.a.createElement(sue,{title:kf("请选择"),onClose:f,showCloseIcon:!0},s.a.createElement(fue,{defaultValue:t.value,list:i.map((e=>{var t;const r=null==d?void 0:d.getFieldIcon(null==(t=e.field)?void 0:t.type);return{key:e.field.uuid,title:e.group_uuid?`${o[e.group_uuid].name}-${e.field.name}`:e.field.name,icon:r&&s.a.createElement(r,null)}})),onCheck:t=>{const r=null==i?void 0:i.find((e=>{var r;return(null==(r=e.field)?void 0:r.uuid)===t.key}));n(e,null==r?void 0:r.field),f()}}))}))},Cue=({filter:e,className:t="",onFuncChange:r=(()=>{})})=>{var n;const{conditions:i}=Zce({filter:e,onFuncChange:r}),o=zA(qf),l=zA(tQ),c=o.getValue("modal.mode"),u=Object(a.useCallback)((()=>{l.close("filter-func-select")}),[]),d=e.func||(null==i?void 0:i[0].func),f=(null==(n=null==i?void 0:i.find((e=>e.func===d)))?void 0:n.text)||(null==i?void 0:i[0].text);return s.a.createElement("div",{className:t},s.a.createElement(vue,{className:"lakex-table-h5-filter-func",text:f,onClick:()=>{l.open("filter-func-select",{initialState:{value:d}})}}),s.a.createElement(PQ,{id:"filter-func-select",mode:c,hasMask:c===eQ.DRAWER,hasAnimation:c===eQ.DRAWER,position:c===eQ.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:({initialState:t})=>s.a.createElement(sue,{title:kf("请选择"),onClose:u,showCloseIcon:!0},s.a.createElement(fue,{defaultValue:t.value,list:i.map((e=>({key:e.func,title:e.text}))),onCheck:t=>{r(e,t.key),u()}}))}))},Eue=({filter:e,onExpectedChange:t=(()=>{})})=>{var r;const{getMentionValues:n,field:i}=Qce({filter:e}),o=zA(qf),a=zA(tQ),l=o.getValue("modal.mode"),c=null==i?void 0:i.type;if(c===Rh.DATE||Hh.includes(e.func))return null;let u;if(c===Rh.SELECT||c===Rh.MULTI_SELECT){let n=(null==e?void 0:e.expected)||[];"string"==typeof(null==e?void 0:e.expected)&&(n=null==e?void 0:e.expected.split(","));const o=null==(r=null==i?void 0:i.options)?void 0:r.filter((e=>n.includes(e.uuid))),d=o.map((e=>e.uuid));u=s.a.createElement(s.a.Fragment,null,s.a.createElement(vue,{className:"lakex-table-h5-filter-col",text:null==o?void 0:o.map((e=>e.name)).join(", "),onClick:()=>{a.open("filter-expected-select",{initialState:{value:d}})}},(!d||!d.length)&&s.a.createElement("span",{className:"lakex-table-h5-condition-placeholder"},kf("请选择"))),s.a.createElement(PQ,{id:"filter-expected-select",mode:l,hasMask:l===eQ.DRAWER,hasAnimation:l===eQ.DRAWER,position:l===eQ.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:({initialState:r})=>s.a.createElement(sue,{title:kf("请选择"),onClose:()=>{a.close("filter-expected-select")},showCloseIcon:!0},s.a.createElement(fue,{multiple:c===Rh.MULTI_SELECT,defaultValue:r.value,list:null==i?void 0:i.options.map(((e,t)=>({key:e.uuid,title:s.a.createElement(gue,{option:{color:e.color,value:e.name}})}))),onCheck:r=>{var n,i;if(null==r||""===r||0===r.length)return void t(e,"");if("select"===c)return t(e,r.key),void a.close("filter-expected-select");const o=[];null==(i=null==(n=e.field)?void 0:n.options)||i.forEach((e=>{r.some((t=>t.key===e.uuid))&&o.push(e.uuid)})),t(e,o)}}))}))}else if("checkbox"===c)u=s.a.createElement("span",{className:"lakex-table-h5-filter-checkbox"},s.a.createElement(p.a,{defaultChecked:!0===Boolean(e.expected),onChange:r=>{t(e,r.target.checked?"true":"false")}}));else if(Kh.isMentionLike(c)){const r=n()||[],i={};null==r||r.forEach((e=>{i[e.uid]=e}));const o=null!=e&&e.expected?e.expected.split(","):[];u=s.a.createElement(s.a.Fragment,null,s.a.createElement(vue,{className:"lakex-table-h5-filter-col",text:o.map((e=>i[e])).map((e=>e.name)).join(", "),onClick:()=>{a.open("filter-expected-mention",{initialState:{value:o}})}},(!o||!o.length)&&s.a.createElement("span",{className:"lakex-table-h5-condition-placeholder"},kf("请选择"))),s.a.createElement(PQ,{id:"filter-expected-mention",mode:l,hasMask:l===eQ.DRAWER,hasAnimation:l===eQ.DRAWER,position:l===eQ.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:({initialState:n})=>s.a.createElement(sue,{title:kf("请选择"),onClose:()=>{a.close("filter-expected-mention")},showCloseIcon:!0},r.length?s.a.createElement(fue,{multiple:!0,defaultValue:n.value,list:r.map(((e,t)=>({key:String(e.uid),title:s.a.createElement(yue,{mention:{avatar_url:e.icon,name:e.name}})}))),onCheck:r=>{null!=r&&""!==r&&0!==r.length?t(e,0===r.length?"":r.map((e=>e.key)).join(",")):t(e,"")}}):s.a.createElement(mue,{desc:kf("暂无人员")}))}))}else u=s.a.createElement(HA,{className:"lakex-table-h5-filter-expected-input",placeholder:kf("请输入"),defaultValue:e.expected,onChange:r=>{t(e,r.target.value)}});return s.a.createElement("div",{className:"lakex-table-h5-filter-expected"},u)},xue=e=>{const{filter:t,index:r,onRemove:n,onOperatorChange:i,onFieldChange:o,onFuncChange:a,onExpectedChange:l}=e;return s.a.createElement("div",{className:"lakex-table-h5-filter-item",key:r},s.a.createElement(wue,{index:r,filter:t,onOperatorChange:i}),s.a.createElement("div",{className:"lakex-table-h5-filter-item-content"},s.a.createElement("div",{className:"lakex-table-h5-filter-item-content-inner"},s.a.createElement("div",{className:"lakex-table-h5-filter-item-content-head"},s.a.createElement(_ue,{className:"lakex-table-h5-filter-item-field",filter:t,defaultValue:t.field_uuid,onFieldChange:o}),s.a.createElement(Cue,{className:"lakex-table-h5-filter-item-func",filter:t,onFuncChange:a})),s.a.createElement("div",null,s.a.createElement(Eue,{filter:t,onExpectedChange:l}))),s.a.createElement(YP,{type:"Delete",size:18,onClick:()=>{n(t)}})))},Sue=e=>{const{state:t,onRemoveFilter:r,onFieldChange:n,onFuncChange:i,onExpectedChange:o,onOperatorChange:a,onAddFilter:l}=iue(),c=zA(tQ);return s.a.createElement(sue,{title:kf("筛选"),onClose:()=>{null==c||c.close("filter")},showCloseIcon:!0},0===t.filters.length?s.a.createElement(bue,{onAddFilter:l}):s.a.createElement("div",{className:"lakex-table-h5-filter"},t.filters.map(((e,t)=>s.a.createElement(xue,{key:e.field_uuid+"_"+t,index:t,filter:e,onRemove:r,onFieldChange:n,onFuncChange:i,onExpectedChange:o,onOperatorChange:a}))),s.a.createElement(b.a,{className:"lakex-table-h5-filter-add",onClick:()=>l()},s.a.createElement(YP,{type:"Add"}),kf("添加筛选条件"))))};var kue=Object.defineProperty,Oue=Object.getOwnPropertyDescriptor,Iue=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Oue(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&kue(t,r,o),o};let Rue=class{constructor(){this._getTitle=()=>{const e=this._readService.getActiveView();if(!e)return kf("筛选");const t=this._readService.getViewFilters(e.uuid);return t&&0!==t.length?kf("$1个筛选",t.length):kf("筛选")},this._getActive=()=>{const e=this._readService.getActiveView();if(!e)return!1;const t=this._readService.getViewFilters(e.uuid);return t&&t.length>0}}static pluginModule(){return bo().register(Gce).register(this)}init(){}registerToolbar(e){e.registerItem({id:"filter",icon:"ViewerFilter",tooltip:this._getTitle,visible:()=>{var e;return(null==(e=this._readService.getActiveView())?void 0:e.type)!==Wh.FORM},active:this._getActive,onClick:e=>{const t=e.target;this._modalService.open("filter",{position:{origin:t,placement:"bottom"}})}})}registerModal(e){const t=this._configuration.getValue("modal.mode"),r=this._configuration.getValue("render.mode");e.registerItem({id:"filter",mode:t,hasMask:t===eQ.DRAWER,hasAnimation:t===eQ.DRAWER,position:t===eQ.DRAWER?{placement:"bottom"}:void 0,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:r===Pj.MOBILE?Sue:oue})}registerContextMenu(e){e.registerItem({key:"filterByField",name:({fieldId:e})=>{const t=this._readService.getActiveView();return this._readService.getViewFilters(null==t?void 0:t.uuid).find((t=>t.field_uuid===e))?kf("取消筛选"):kf("按本列筛选")},icon:"ViewerFilter",hotkey:"",visible:({from:e})=>e===nre.HEADER,onClick:async({initialState:e})=>{var t,r;const{fieldId:n}=e,i=this._readService.getActiveView(),o=this._readService.getViewFilters(null==i?void 0:i.uuid).find((e=>e.field_uuid===n));let a=null;if(o)a=await(null==(t=this._commandService)?void 0:t.execCommand("removeFilter",{filterId:o.uuid}));else{const e=this._filterService.getFilterByFieldId(n);a=await(null==(r=this._commandService)?void 0:r.execCommand("createFilter",{viewId:null==i?void 0:i.uuid,filter:e}));const t=this._workbenchContext.$root.querySelector("#filter");t&&this._modalService.open("filter",{position:{origin:t,placement:"bottom"}})}null!=a&&a.isSuccess?this._modalService.close("context-menu-modal"):null!=a&&a.error&&v.a.error(a.error.message)}})}};Rue.pluginName="workbench-filter",Iue([to(tQ)],Rue.prototype,"_modalService",2),Iue([to(Dy)],Rue.prototype,"_readService",2),Iue([to(Pb)],Rue.prototype,"_commandService",2),Iue([to(Gce)],Rue.prototype,"_filterService",2),Iue([to(LA)],Rue.prototype,"_workbenchContext",2),Iue([to(qf)],Rue.prototype,"_configuration",2),Rue=Iue([eo({contrib:[PA,IJ,rQ,Ese]})],Rue);const Tue=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{const{groupField:r,groupOption:n,color:i,onSubmit:o,defaultColor:l}=e,{inputRef:c,state:d,labelColor:p,onChange:h,onChangeColor:m,onPressEnter:v}=(({groupField:e,groupOption:t,defaultColor:r,onSubmit:n,ref:i})=>{const o=zA(rk),[s,l]=Object(a.useState)((null==t?void 0:t.color)||r||rk.getNextColor("")),[c,u]=Object(a.useState)(null==t?void 0:t.name),d=Object(a.useRef)(null);Object(a.useEffect)((()=>{var e;l((null==t?void 0:t.color)||r||rk.getNextColor("")),u(null==t?void 0:t.name),null==(e=d.current)||e.focus()}),[null==t?void 0:t.color,null==t?void 0:t.name]);const f=Object(a.useCallback)((()=>{n({fieldId:e.uuid,fieldOption:{name:c,color:s}})}),[e.uuid,c,s]);return Object(a.useImperativeHandle)(i,(()=>({onSubmit:()=>{f()}}))),{inputRef:d,state:{name:c,optionColor:s},labelColor:o,onPressEnter:f,onChange:e=>{u(e.target.value)},onChangeColor:e=>{l(e)}}})({groupField:r,groupOption:n,defaultColor:l,onSubmit:o,ref:t});let g=null;return i&&(g=s.a.createElement(f.a,{placement:"leftTop",overlayClassName:"lakex-table-colorpicker",content:s.a.createElement(UA,{colorSource:[...YS],activeColor:d.optionColor,onSelect:m})},s.a.createElement("span",{className:"lakex-table-group-item-option-color",style:{background:p.getRenderColor(d.optionColor)}}))),s.a.createElement("div",{className:"lakex-table-group-item-input"},s.a.createElement("span",{className:"lakex-table-group-item-input-content"},g,s.a.createElement(u.a,{ref:c,value:d.name,onChange:e=>{h(e)},onPressEnter:()=>{v()},autoFocus:!0})))}))),Aue=({groupField:e,groupOption:t={},onSubmit:r})=>s.a.createElement("div",{className:"lakex-table-group-item-mention"},s.a.createElement(ZZ,{id:e.uuid,defaultValue:(null==t?void 0:t.value)||[],onChange:n=>{const i=n.map((e=>e.uid)).join(",");null==r||r({fieldId:e.uuid,fieldOption:{...t,uuid:i,name:i,value:i,users:n}})}})),Nue=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{var r;const{groupField:n}=e.initialState||{},i=f0(n.uuid),o=zA(Pb),l=zA(tQ),c=Object(a.useRef)(null),u=Object(a.useCallback)((({fieldId:e,fieldOption:t})=>{(async({fieldId:e,fieldOption:t})=>{const r=await o.execCommand("createFieldOption",{fieldId:e,fieldOption:t});null!=r&&r.isSuccess?l.close("addGroupItem"):null!=r&&r.error&&v.a.error(r.error.message)})({fieldId:e,fieldOption:t})}),[]),d=Object(a.useCallback)((({fieldId:e,fieldOption:t})=>{(async({fieldId:e,fieldOption:t})=>{if(!t.name)return;const r=await o.execCommand("createFieldOption",{fieldId:e,fieldOption:t});null!=r&&r.isSuccess?l.close("addGroupItem"):null!=r&&r.error&&v.a.error(r.error.message)})({fieldId:e,fieldOption:t})}),[]);if(Object(a.useImperativeHandle)(t,(()=>({onCloseByClickAwayOrScroll:()=>{var e;i.type===Rh.SELECT&&(null==(e=c.current)||e.onSubmit())}}))),i.type===Rh.MENTION)return s.a.createElement(Aue,{groupField:i,onSubmit:u});const f=rk.getNextColor((null==(r=i.options[i.options.length-1])?void 0:r.color)||"");return s.a.createElement(Tue,{ref:c,groupField:i,color:null==n?void 0:n.color,defaultColor:f,onSubmit:d})}))),Mue=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{const{groupField:r,groupOption:n}=e.initialState||{},i=zA(Pb),o=zA(tQ),l=Object(a.useRef)(null),c=Object(a.useCallback)((({fieldId:e,fieldOption:t})=>{(async({fieldId:e,fieldOption:t})=>{const r=await i.execCommand("updateFieldOption",{optionId:n.uuid,fieldOption:t});null!=r&&r.isSuccess&&o.close("editGroupItem"),null!=r&&r.error&&v.a.error(r.error.message)})({fieldId:e,fieldOption:t})}),[]),u=Object(a.useCallback)((({fieldId:e,fieldOption:t})=>{(async({fieldId:e,fieldOption:t})=>{if(t.name===n.name&&t.color===n.color)return void o.close("editGroupItem");const r=await i.execCommand("updateFieldOption",{optionId:n.uuid,fieldOption:t});null!=r&&r.isSuccess?o.close("editGroupItem"):null!=r&&r.error&&v.a.error(r.error.message)})({fieldId:e,fieldOption:t})}),[]);return Object(a.useImperativeHandle)(t,(()=>({onCloseByClickAwayOrScroll:()=>{var e;r.type===Rh.SELECT&&(null==(e=l.current)||e.onSubmit())}}))),r.type===Rh.MENTION?s.a.createElement(Aue,{groupField:r,groupOption:n,onSubmit:c}):s.a.createElement(Tue,{ref:l,groupField:r,groupOption:n,color:null==r?void 0:r.color,onSubmit:u})})));var Pue=Object.defineProperty,jue=Object.getOwnPropertyDescriptor,Due=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?jue(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Pue(t,r,o),o};let Fue=class{static pluginModule(){return bo().register(this)}init(){var e,t;null==(e=this._groupItemService)||e.onShowEditGroup((({target:e,groupField:t,groupOption:r})=>{var n;null==(n=this._modalService)||n.open("editGroupItem",{position:{origin:e,placement:"cover"},initialState:{groupField:t,groupOption:r}})})),null==(t=this._groupItemService)||t.onShowNewGroup((({target:e,groupField:t})=>{var r;null==(r=this._modalService)||r.open("addGroupItem",{position:{origin:e,placement:"cover"},initialState:{groupField:t}})}))}registerModal(e){e.registerItem({id:"addGroupItem",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:Nue}),e.registerItem({id:"editGroupItem",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:Mue})}registerContextMenu(e){e.registerItem({key:"groupByField",name:({fieldId:e})=>{const t=this._readService.getActiveView(),r=this._readService.getViewGroup(null==t?void 0:t.uuid);return r&&r.field_uuid===e?kf("取消分组"):kf("按本列分组")},icon:"ViewerGroup",hotkey:"",visible:({from:e})=>e===nre.HEADER,onClick:async({initialState:e})=>{var t,r,n;const i=this._readService.getActiveView(),{fieldId:o}=e;if(!i)return;const a=this._readService.getViewGroup(i.uuid),s=a&&a.field_uuid===o;let l=null;l=a?s?await(null==(r=this._commandService)?void 0:r.execCommand("removeGridGroup",{viewId:i.uuid})):await(null==(n=this._commandService)?void 0:n.execCommand("updateGridGroup",{viewId:i.uuid,group:{field_uuid:o,type:Ux.ASC}})):await(null==(t=this._commandService)?void 0:t.execCommand("createGridGroup",{viewId:i.uuid,group:{field_uuid:o,type:Ux.ASC}})),null!=l&&l.isSuccess?this._modalService.close("context-menu-modal"):null!=l&&l.error&&v.a.error(l.error.message)}})}};Fue.pluginName="workbench-group",Due([to(N2),Mx()],Fue.prototype,"_groupItemService",2),Due([to(tQ)],Fue.prototype,"_modalService",2),Due([to(Dy)],Fue.prototype,"_readService",2),Due([to(Pb)],Fue.prototype,"_commandService",2),Fue=Due([eo({contrib:[PA,rQ,Ese]})],Fue);const Vue=({className:e,defaultValue:t="",onFieldSelect:r=(()=>{})})=>{const{sortFields:n,groupMap:i}=(e=>{const t=zA(Dy),r=null==t?void 0:t.getActiveView(),n=null==t?void 0:t.getViewFields(null==r?void 0:r.uuid,!1),i=null==n?void 0:n.filter((t=>{var r,n;return!(!e.defaultValue||(null==(r=t.field)?void 0:r.uuid)!==e.defaultValue)||Kh.isSort(null==(n=t.field)?void 0:n.type)})),o=null==t?void 0:t.getViewFieldGroups(null==r?void 0:r.uuid);return{sortFields:i,groupMap:Object(a.useMemo)((()=>{const e={};return null==o||o.forEach((t=>{e[t.uuid]=t})),e}),[o])}})({defaultValue:t}),o=zA(tD);return s.a.createElement(x.a,{className:`lakex-table-sort-field-select ${e}`,defaultValue:t,dropdownClassName:"lakex-table-sort-field-select-dropdown",suffixIcon:s.a.createElement(YP,{type:"ArrowDown",size:12}),onChange:e=>{const t=null==n?void 0:n.find((t=>{var r;return(null==(r=t.field)?void 0:r.uuid)===e}));r(null==t?void 0:t.field)},bordered:!1},null==n?void 0:n.map((e=>{var t,r,n,a,l;const c=null==o?void 0:o.getFieldIcon(null==(t=e.field)?void 0:t.type);return s.a.createElement(x.a.Option,{value:null==(r=e.field)?void 0:r.uuid,key:null==(n=e.field)?void 0:n.uuid},c&&s.a.createElement(c,null),s.a.createElement("div",{className:"lakex-table-sort-field-select-name"},e.group_uuid?`${i[e.group_uuid].name}-${null==(a=e.field)?void 0:a.name}`:null==(l=e.field)?void 0:l.name))})))},Lue="lakex-table-sort-modal-empty",$ue=({onAddOption:e=(()=>{})})=>s.a.createElement("div",{className:Lue},s.a.createElement("div",{className:`${Lue}-empty-desc`},kf("还未设置任何排序")),s.a.createElement(Vue,{defaultValue:kf("选择一列进行排序"),onFieldSelect:e})),Bue=({auto:e=!1,onUpdateAuto:t=(()=>{})})=>s.a.createElement("div",{className:"lakex-table-sort-setting"},s.a.createElement("h2",{className:"lakex-table-sort-setting-title"},kf("排序设置")),s.a.createElement("div",{className:"lakex-table-sort-setting-action"},s.a.createElement("span",null,kf("保持排序")),s.a.createElement(S.a,{checked:e,onChange:t,size:"small"}))),zue=e=>{switch(e){case"select":case"multiSelect":return{asc:kf("选项顺序"),desc:kf("选项倒序")};case"number":case"phone":return{asc:kf("从小到大"),desc:kf("从大到小")};default:return{asc:kf("升序"),desc:kf("降序"),style:{padding:"0 16px"}}}},Uue=({sort:e,field:t,onUpdateType:r=(()=>{})})=>{if(!t)return null;if(Kh.isCheckbox(t.type))return s.a.createElement(m.a.Group,{defaultValue:e.type,onChange:e=>{r(e.target.value)}},s.a.createElement(m.a.Button,{value:"asc"},s.a.createElement("span",{className:"lakex-table-sort-field-order-radio"},s.a.createElement(p.a,{checked:!1},s.a.createElement(YP,{type:"RightArrow"})),s.a.createElement(p.a,{checked:!0}))),s.a.createElement(m.a.Button,{value:"desc"},s.a.createElement("span",{className:"lakex-table-sort-field-order-radio"},s.a.createElement(p.a,{checked:!0},s.a.createElement(YP,{type:"RightArrow"})),s.a.createElement(p.a,{checked:!1}))));const n=zue(t.type);return s.a.createElement(m.a.Group,{defaultValue:e.type,onChange:e=>{r(e.target.value)}},s.a.createElement(m.a.Button,{value:"asc"},s.a.createElement("span",{style:n.style},n.asc)),s.a.createElement(m.a.Button,{value:"desc"},s.a.createElement("span",{style:n.style},n.desc)))},Hue=({sort:e,field:t,onRemove:r=(()=>{}),onChange:n=(()=>{}),onUpdateType:i=(()=>{})})=>{const{state:o,onFieldSelect:l}=(({field:e,onChange:t})=>{const[r,n]=Object(a.useState)(e);return{state:{activeField:r},onFieldSelect(e){t(e),n(e)}}})({field:t,onChange:n});return s.a.createElement("div",{className:"lakex-table-sort-item"},s.a.createElement(YP,{type:"Close",onClick:()=>{r(e)}}),s.a.createElement(Vue,{defaultValue:null==t?void 0:t.uuid,onFieldSelect:l,className:"lakex-table-sort-item-select"}),s.a.createElement(Uue,{sort:e,field:o.activeField,onUpdateType:i}))},Wue=({onCancel:e=(()=>{}),onSubmit:t=(()=>{})})=>s.a.createElement("div",{className:"lakex-table-sort-footer"},s.a.createElement(b.a,{onClick:e},kf("取消")),s.a.createElement(b.a,{type:"primary",onClick:t},kf("确定"))),Gue=e=>{const t=zA(tQ),r=zA(Pb),n=zA(Dy),i=u0(),o=(null==i?void 0:i.sort)||(null==e?void 0:e.sort),s=null==i?void 0:i.viewConfig,l=null==i?void 0:i.view,[c,u]=Object(a.useState)(o),[d,f]=Object(a.useState)(!(null==s||!s.keep_sort)),p=e=>{if(l)return e?o?null==r?void 0:r.execCommand("updateSort",{viewId:null==s?void 0:s.view_uuid,sort:e,auto:d}):null==r?void 0:r.execCommand("createSort",{viewId:null==s?void 0:s.view_uuid,sort:e}):null==r?void 0:r.execCommand("removeSort",{viewId:null==s?void 0:s.view_uuid})},h=Object(a.useCallback)((()=>{var e;return c?null==(e=null==i?void 0:i.fields)?void 0:e.find((e=>e.uuid===c.field_uuid)):null}),[c,i]);return{state:{sort:c,auto:d},fields:null==i?void 0:i.fields,getCurrnetSortField:h,onAddOption(e){var t,r;e||(e=null==(t=null==n?void 0:n.getViewFields())?void 0:t[0].field);const i={field_uuid:null==e?void 0:e.uuid,type:Hx.ASC};if(d)return null==(r=p(i))?void 0:r.then((()=>{u(i)}));u(i)},onRemoveOption(){var e;if(d)return null==(e=p(null))?void 0:e.then((()=>{u(null)}));u(null)},onUpdateOption(e){var t;const r={field_uuid:null==e?void 0:e.uuid,type:(null==c?void 0:c.type)||Hx.ASC};if(d)return null==(t=p(r))?void 0:t.then((()=>{u(r)}));u(r)},onUpdateType(e){var t;const r={field_uuid:null==c?void 0:c.field_uuid,type:e};if(d)return null==(t=p(r))?void 0:t.then((()=>{u(r)}));u(r)},onUpdateAuto(e){if(d!==e)return null==r?void 0:r.execCommand("updateSort",{viewId:null==s?void 0:s.view_uuid,sort:c,auto:e}).then((()=>{f(e)}));f(e)},onCancel(){t.close("sort")},onSubmit(){p(c),t.close("sort")}}},Kue=()=>{const{state:e,fields:t,onCancel:r,onSubmit:n,onAddOption:i,onUpdateOption:o,onRemoveOption:a,onUpdateType:l,onUpdateAuto:c}=Gue();let u;if(e.sort){const i=null==t?void 0:t.find((t=>{var r;return t.uuid===(null==(r=e.sort)?void 0:r.field_uuid)}));u=s.a.createElement(s.a.Fragment,null,s.a.createElement(Bue,{auto:e.auto,onUpdateAuto:c}),s.a.createElement(Hue,{field:i,sort:e.sort,onRemove:a,onChange:o,onUpdateType:l}),!e.auto&&s.a.createElement(Wue,{onCancel:r,onSubmit:n}))}else u=s.a.createElement(s.a.Fragment,null,s.a.createElement($ue,{onAddOption:i}),!e.auto&&s.a.createElement(Wue,{onCancel:r,onSubmit:n}));return s.a.createElement("div",{className:"lakex-table-sort-modal"},u)},que=({onAddOption:e=(()=>{})})=>s.a.createElement("div",{className:"lakex-table-h5-empty"},s.a.createElement(mue,{desc:kf("你还未进行任何排序"),className:"no-data"}),s.a.createElement(b.a,{type:"primary",onClick:()=>e(),className:"no-data-btn"},s.a.createElement(YP,{type:"Add"}),kf("添加排序条件"))),Yue=e=>{const{state:t,onCancel:r,onSubmit:n,onAddOption:i,onUpdateOption:o,onRemoveOption:l,onUpdateType:c,onUpdateAuto:u,getCurrnetSortField:d}=Gue(),f=zA(qf),p=zA(tQ),h=f.getValue("modal.mode"),m=zA(Dy),v=zA(tD),g=Object(a.useMemo)((()=>null==m?void 0:m.getViewFields()),[]);return s.a.createElement(sue,{title:kf("排序"),onClose:r,showCloseIcon:!0},(()=>{if(!t.sort)return s.a.createElement(que,{onAddOption:i});const e=d(),r=zue(null==e?void 0:e.type),a=null==v?void 0:v.getFieldIcon(null==e?void 0:e.type);return s.a.createElement("div",{className:"lakex-table-h5-sort"},s.a.createElement("div",{className:"lakex-table-h5-sort-tip"},kf("按以下选项进行排序")),s.a.createElement(vue,{prefixIcon:a,className:"lakex-table-h5-filter-col",text:null==e?void 0:e.name,onClick:()=>{null==p||p.open("sort-select",{initialState:{sort:t.sort}})}}),s.a.createElement(PQ,{id:"sort-select",mode:h,hasMask:h===eQ.DRAWER,hasAnimation:h===eQ.DRAWER,position:h===eQ.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:({initialState:e})=>{var t;return s.a.createElement(sue,{title:kf("请选择"),onClose:()=>{null==p||p.close("sort-select")},showCloseIcon:!0},s.a.createElement(fue,{defaultValue:null==(t=e.sort)?void 0:t.field_uuid,list:g.map((e=>{var t;const r=null==v?void 0:v.getFieldIcon(null==(t=e.field)?void 0:t.type);return{key:e.field.uuid,title:e.field.name,icon:r&&s.a.createElement(r,null)}})),onCheck:e=>{null==p||p.close("sort-select"),o({uuid:e.key})}}))}}),s.a.createElement(uue,{className:"lakex-table-h5-sort-display-radio",options:[{label:r.asc,value:"asc"},{label:r.desc,value:"desc"}],onChange:e=>c(e.value),defaultValue:t.sort.type}),s.a.createElement(due,{className:"lakex-table-h5-sort-auto",list:[{key:"auto",checked:t.auto,title:kf("保持排序")}],onSwitch:(e,t)=>{u(t)}}),s.a.createElement(b.a,{type:"primary",className:"lakex-table-h5-sort-confirm",onClick:()=>n(),style:{opacity:t.auto?0:1}},kf("确定")),s.a.createElement(b.a,{className:"lakex-table-h5-sort-del",onClick:()=>l()},s.a.createElement(YP,{type:"Delete",className:"del-icon"}),kf("删除该条件")))})())};var Xue=Object.defineProperty,Zue=Object.getOwnPropertyDescriptor,Jue=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Zue(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Xue(t,r,o),o};let Que=class{constructor(){this._getActive=()=>{const e=this._readService.getActiveView();if(!e)return!1;const t=this._readService.getViewConfig(e.uuid);return!(null==t||!t.keep_sort)}}static pluginModule(){return bo().register(this)}init(){}registerToolbar(e){e.registerItem({id:"sort",icon:"ViewerSort",tooltip:kf("排序"),visible:()=>{var e;return(null==(e=this._readService.getActiveView())?void 0:e.type)!==Wh.FORM},active:this._getActive,onClick:e=>{const t=e.target;this._modalService.open("sort",{position:{origin:t,placement:"bottom"}})}})}registerModal(e){const t=this._configuration.getValue("modal.mode"),r=this._configuration.getValue("render.mode");e.registerItem({id:"sort",mode:t,hasMask:t===eQ.DRAWER,hasAnimation:t===eQ.DRAWER,position:t===eQ.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:r===Pj.MOBILE?Yue:Kue})}registerContextMenu(e){e.registerItem({key:"sortByAsc",name:kf("升序"),hotkey:"",visible:({from:e})=>e===nre.HEADER,onClick:async({initialState:e})=>{var t,r;const{fieldId:n}=e,i=this._readService.getActiveView();if(!i)return;const o=this._readService.getViewSort(i.uuid),a=this._readService.getViewConfig(null==i?void 0:i.uuid);let s=null;s=o?await(null==(r=this._commandService)?void 0:r.execCommand("updateSort",{viewId:i.uuid,sort:{field_uuid:n,type:"asc"},auto:!(null==a||!a.keep_sort)})):await(null==(t=this._commandService)?void 0:t.execCommand("createSort",{viewId:i.uuid,sort:{field_uuid:n,type:"asc"}})),null!=s&&s.isSuccess?this._modalService.close("context-menu-modal"):null!=s&&s.error&&v.a.error(s.error.message)}}),e.registerItem({key:"sortByDesc",name:kf("降序"),hotkey:"",visible:({from:e})=>e===nre.HEADER,onClick:async({initialState:e})=>{var t,r;const{fieldId:n}=e,i=this._readService.getActiveView();if(!i)return;const o=this._readService.getViewSort(i.uuid),a=this._readService.getViewConfig(null==i?void 0:i.uuid);let s=null;s=o?await(null==(r=this._commandService)?void 0:r.execCommand("updateSort",{viewId:i.uuid,sort:{field_uuid:n,type:"desc"},auto:!(null==a||!a.keep_sort)})):await(null==(t=this._commandService)?void 0:t.execCommand("createSort",{viewId:i.uuid,sort:{field_uuid:n,type:"desc"}})),null!=s&&s.isSuccess?this._modalService.close("context-menu-modal"):null!=s&&s.error&&v.a.error(s.error.message)}})}};Que.pluginName="workbench-sort",Jue([to(tQ)],Que.prototype,"_modalService",2),Jue([to(Dy)],Que.prototype,"_readService",2),Jue([to(Pb)],Que.prototype,"_commandService",2),Jue([to(qf)],Que.prototype,"_configuration",2),Que=Jue([eo({contrib:[PA,IJ,rQ,Ese]})],Que);const ede=e=>{const{initialState:t}=e,{items:r,disableDel:n}=t,i=Object(a.useRef)(null);return s.a.createElement("div",{ref:i,className:"lakex-grid-context-menu"},s.a.createElement(d.a,{mode:"vertical"},r.map(((t,r)=>"|"===t?s.a.createElement(k.a,{key:r}):s.a.createElement(d.a.Item,{className:GA({disable:"deleteField"===t.key&&n}),key:t.key,icon:es(t.icon)?t.icon({}):s.a.createElement(YP,{type:t.icon}),onClick:r=>{var n;null==(n=t.onClick)||n.call(t,e,r)}},t.name,s.a.createElement("span",{className:"lakex-grid-context-menu-item-hotkey"},t.hotkey))))))};var tde=Object.defineProperty,rde=Object.getOwnPropertyDescriptor,nde=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?rde(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&tde(t,r,o),o};let ide=class{constructor(){this._contextMenuModalId="context-menu-modal",this._destroyList=new ep}static pluginModule(){return bo().contribution(Ese).register(Ase).register(Ose).register(this)}static registerConfiguration(e){e.registerConfiguration({id:"contextMenu",type:"array",title:"右键菜单"}),e.registerDefaultValue({contextMenu:[]})}get isReadonly(){return this._abilityService.isReadonly(Nw.TABLE)}get currentViewType(){var e;return null==(e=this._readService.getActiveView())?void 0:e.type}init(){var e;this._contextMenuRegistry.init(),this._destroyList.push(this._contextMenuService.onContextMenu((({e:e,from:t,...r})=>{const n=this._readService.getViewFields()||[],i=e.currentTarget,o=e.clientX,a=e.clientY,s={height:0,width:0,left:o,right:o,top:a,bottom:a};this._modalService.open(this._contextMenuModalId,{position:{origin:s,placement:"right"},initialState:{items:this._contextMenuWorkbenchService.getMenuItems({from:t,fieldId:r.fieldId}),originRect:i.getBoundingClientRect(),disableDel:1===n.length,...r}})})));const t=null==(e=this._selectionService)?void 0:e.onAnchorChange((e=>{var t;null!=(t=this._selectionService)&&t.hasSelection()||this._modalService.close(this._contextMenuModalId);const r=e.fieldValue,n=this._contextMenuService.contextMenuInfo;((null==r?void 0:r.fieldId)!==(null==n?void 0:n.fieldId)||(null==r?void 0:r.recordId)!==(null==n?void 0:n.recordId))&&this._modalService.close(this._contextMenuModalId)}));t&&this._destroyList.push(t)}destroy(){this._destroyList.destroy()}registerModal(e){e.registerItem({id:this._contextMenuModalId,hasMask:!1,scrollStrategy:"close",zIndex:"modalFromRender",disableClickAwayClose:!0,disableEscClose:!0,RenderComponent:ede})}};ide.pluginName="workbench-context-menu",nde([to(tQ)],ide.prototype,"_modalService",2),nde([to(ire)],ide.prototype,"_contextMenuService",2),nde([to(Ase)],ide.prototype,"_contextMenuWorkbenchService",2),nde([to(e3),Mx()],ide.prototype,"_selectionService",2),nde([to(Dy)],ide.prototype,"_readService",2),nde([to(Ose)],ide.prototype,"_contextMenuRegistry",2),nde([to(Hw)],ide.prototype,"_abilityService",2),ide=nde([eo({contrib:[PA,rQ,Ese]})],ide);var ode=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,r=[],n=0;n<e.rangeCount;n++)r.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||r.forEach((function(t){e.addRange(t)})),t&&t.focus()}},ade={"text/plain":"Text","text/html":"Url",default:"Text"};var sde=function(e,t){var r,n,i,o,a,s,l=!1;t||(t={}),r=t.debug||!1;try{if(i=ode(),o=document.createRange(),a=document.getSelection(),(s=document.createElement("span")).textContent=e,s.ariaHidden="true",s.style.all="unset",s.style.position="fixed",s.style.top=0,s.style.clip="rect(0, 0, 0, 0)",s.style.whiteSpace="pre",s.style.webkitUserSelect="text",s.style.MozUserSelect="text",s.style.msUserSelect="text",s.style.userSelect="text",s.addEventListener("copy",(function(n){if(n.stopPropagation(),t.format)if(n.preventDefault(),typeof n.clipboardData>"u"){r&&console.warn("unable to use e.clipboardData"),r&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var i=ade[t.format]||ade.default;window.clipboardData.setData(i,e)}else n.clipboardData.clearData(),n.clipboardData.setData(t.format,e);t.onCopy&&(n.preventDefault(),t.onCopy(n.clipboardData))})),document.body.appendChild(s),o.selectNodeContents(s),a.addRange(o),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");l=!0}catch(i){r&&console.error("unable to copy using execCommand: ",i),r&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),l=!0}catch(i){r&&console.error("unable to copy using clipboardData: ",i),r&&console.error("falling back to prompt"),n=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(n,e)}}finally{a&&("function"==typeof a.removeRange?a.removeRange(o):a.removeAllRanges()),s&&document.body.removeChild(s),i()}return l};const lde=Fi.defineToken("ExpandRecordContribution");var cde=(e=>(e.NORMAL="normal",e.LITE="lite",e))(cde||{}),ude=Object.defineProperty,dde=Object.getOwnPropertyDescriptor,fde=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?dde(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ude(t,r,o),o};let pde=class{constructor(){this._recordProviders=[],this._tooltipComponent=null}init(){var e;const t=this.expendRecordProvider.getContributions();for(const r of t)try{null==(e=r.registerExpandRecord)||e.call(r,this)}catch(e){console.error(e)}}getProviders(){return this._recordProviders}getTooltipComponent(){return this._tooltipComponent}registerRecordProvider(e){this._recordProviders.push(e)}registerRecordTooltip(e){this._tooltipComponent=e}};fde([Eo(lde)],pde.prototype,"expendRecordProvider",2),pde=fde([eo()],pde);const hde=Object(a.memo)((({recordId:e,field:t})=>{const r=m0(e,t.uuid),n=t.type||"",i=zA(tD).getFieldComponent(n);return n&&i?jo(null==r?void 0:r.value)?s.a.createElement("div",{className:"lakex-cell-field-in-expand-record"},s.a.createElement("span",{className:"lakex-cell-field-in-expand-record cell-empty"},kf("(空)"))):s.a.createElement("div",{className:"lakex-cell-field-in-expand-record"},i&&s.a.createElement(i,{key:null==r?void 0:r.cellId,cell:r,field:t})):null})),mde=Object(a.memo)((({recordId:e,field:t,renderMode:r=Dj.NORMAL})=>{const n=m0(e,t.uuid),i=t.type||"",o=zA(tD),l=zA(pde).getTooltipComponent(),[c,u]=Object(a.useState)(""),d=gV((e=>{const t=o.cellValueChecker(i,e);u(t),null==n||n.setCell(e)}),100);if(!n)return null;const f=o.getFieldEditComponent(i)||o.getFieldComponent(i);if(!f)return s.a.createElement("h1",null,"尚未注册FieldEditComponent");const p={...Kh.isLink(i)&&{useLinkEditor:!0},...Kh.isSelectLike(i)&&{viewField:{display_type:"dropdown"}}};if(Kh.isSystemType(i))return s.a.createElement("div",{className:"lakex-cell-field-in-expand-record"},s.a.createElement(f,{key:n.cellId,field:t,recordId:e,cell:n,readonly:!1,focus:!1}));const h=s.a.createElement(f,{key:n.cellId,defaultValue:n.value,field:t,cell:n,renderMode:r,recordId:e,onCellChange:d,...p});return s.a.createElement("div",{className:"lakex-cell-field-in-expand-record"},l?s.a.createElement(l,{cell:n,field:t},h):h,s.a.createElement("p",{className:GA("lakex-table-expand-item-error",{show:c})},c))})),vde=Object(a.memo)((({type:e})=>{const t=zA(tD).getFieldIcon(e);return s.a.createElement("div",{className:"lakex-cell-field-in-expand-record-icon"},t&&s.a.createElement(t,{size:16}))})),gde=Object(a.memo)((({field:e,position:t})=>{const r=zA(tD).getFieldTagComponent(e.type);return r?s.a.createElement(r,{field:e,position:t}):null})),yde=({field:e,isReadonly:t})=>{const r=f0((null==e?void 0:e.uuid)||""),n=null==r?void 0:r.type,i=null==r?void 0:r.name,o=zA(tQ),l=Object(a.useCallback)((e=>{t||o.open("addOrUpdateField",{position:{origin:e.currentTarget,placement:"bottom"},initialState:{fieldId:null==r?void 0:r.uuid}})}),[t]);return r?s.a.createElement("div",{className:"lakex-table-expand-record-form-item-label",onClick:l},s.a.createElement(vde,{type:n}),s.a.createElement("div",{className:"lakex-table-expand-record-form-item-label-name"},i),!t&&s.a.createElement(YP,{type:"ReviewArrowDown"}),s.a.createElement(gde,{field:r,position:"expandRecord"})):null},bde=({recordId:e,field:t,isReadonly:r})=>{const n=zA(qf);return t?s.a.createElement(s.a.Fragment,null,s.a.createElement(yde,{isReadonly:r,field:t}),s.a.createElement("div",{className:"lakex-table-expand-record-form-item-content"},r?s.a.createElement(hde,{key:t.type+t.uuid,recordId:e,field:t}):s.a.createElement(mde,{key:t.type+t.uuid,recordId:e,field:t,renderMode:(null==n?void 0:n.getValue("expandRecord.fieldRenderMode"))||Dj.NORMAL}))):null};function wde(e){const{recordId:t,showAddNext:r}=e,n=zA(qf),i=s0(Nw.TABLE).isReadonly(),{ids:o}=function(e){const t=zA(Dy),[r,n]=Object(a.useState)((()=>t.getVisibleRecordIdsInActiveView()));return{ids:r}}(),s=l3(),l=Object(a.useMemo)((()=>t||(null==s?void 0:s.recordId)),[null==s?void 0:s.recordId,t]),[c,u]=Object(a.useState)(l),{isInRefresh:d,refreshDesc:f}=wse(c),[p,h]=Object(a.useState)(null),m=function(e){const t=zA(Pb),r=zA(Dy),n=zA(Fv),i=Object(a.useMemo)((()=>r.getRecordById(e)),[r,e]),[o,s]=Object(a.useState)((()=>r.getPrimaryCellInRecord(e)));Object(a.useEffect)((()=>{s(r.getPrimaryCellInRecord(e))}),[r,e]),Object(a.useEffect)((()=>{const t=null==n?void 0:n.onCellChange((t=>{s(r.getPrimaryCellInRecord(e))}));return()=>{null==t||t.destroy()}}),[t,e]);const l=Object(a.useMemo)((()=>(null==i?void 0:i.values)||[]),[i]),c=l.map((e=>null==e?void 0:e.field_uuid))||[],u=Object(a.useCallback)((e=>l.find((t=>(null==t?void 0:t.field_uuid)===e))),[l]);return{id:(null==i?void 0:i.record_uuid)||"",fieldIds:c,title:(null==o?void 0:o.formattedValue)||"",getCell:u}}(c),v=h0(),g=Object(a.useMemo)((()=>{const e=o[0];return c===e}),[c,o]),y=Object(a.useMemo)((()=>{const e=o[o.length-1];return c===e}),[c,o]),b=zA(Pb),w=e=>{if(!o)return;const t=null!==p?p:c;let r=null,n=o.findIndex((e=>e===t));"up"!==e||g?"down"===e&&!y&&(null!==p?n=o.findIndex((e=>e===p)):n++,r=o[n]):(n--,r=o[n]),r&&(u(r),h(null))},_=mV((async()=>{var e;const t=await(null==b?void 0:b.execCommand("addEmptyRecord")),r=null==t?void 0:t.result,n=null==(e=null==r?void 0:r[0])?void 0:e.uuid;u(n)}));return{showAddNext:r,isReadonly:i,layoutMode:null==n?void 0:n.getValue("expandRecord.fieldLayoutMode"),record:m,title:null==m?void 0:m.title,fields:(null==v?void 0:v.map((e=>e.field)))||[],disableUp:g,disableDown:y,rowId:null==m?void 0:m.id,isInRefresh:d,refreshDesc:f,onShowNextRecord:()=>{w("down")},onShowPrevRecord:()=>{w("up")},onAddNextRecord:_}}const _de=()=>{const e=zA(tQ),t=Object(a.useCallback)((t=>{e.open("addOrUpdateField",{position:{origin:t.currentTarget,placement:"bottom"}})}),[]);return s.a.createElement("div",{id:"lark-table-expand-record-add-column",className:"add-column-button",onClick:t},s.a.createElement(YP,{type:"Add"}),s.a.createElement("div",{className:"title"},kf("新增字段")))},Cde=({focus:e=!1,children:t,className:r})=>{const n=Object(a.useRef)(null);return Object(a.useLayoutEffect)((()=>{if(e&&n.current){n.current.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"});const e=n.current.querySelector("input")||n.current.querySelector("textarea");setTimeout((()=>{const t=null==e?void 0:e.value.length;t&&(null==e||e.setSelectionRange(t,t)),null==e||e.focus()}),300)}}),[e]),s.a.createElement("div",{className:r,ref:n},t)},Ede=({desc:e})=>s.a.createElement("div",{className:"lakex-table-expand-record-refresh-tooltip"},s.a.createElement(O.a,{message:null==e?void 0:e.text,type:"warning",showIcon:!0,closable:!0})),xde=({mode:e,initialState:t})=>{const r=zA(tQ),n=zA(pde),{showAddNext:i,isReadonly:o,title:l,layoutMode:c,rowId:u,fields:d,disableUp:f,disableDown:p,isInRefresh:m,refreshDesc:g,onShowNextRecord:y,onShowPrevRecord:w,onAddNextRecord:_}=wde({recordId:(null==t?void 0:t.recordId)||"",showAddNext:!(null==t||!t.showAddNext)}),C=zA(MD),[E,x]=Object(a.useState)(e===eQ.MODAL?"calc(100vh - 200px)":void 0),S=Object(a.useRef)(null),k=(null==t?void 0:t.showAddNext)||e!==eQ.DRAWER;vV("⌘+shift+,",(()=>{w()})),vV("⌘+shift+.",(()=>{y()})),Object(a.useEffect)((()=>{if(S.current){if(e===eQ.DRAWER)return;const t=S.current.getBoundingClientRect();x(t.height)}}),[k]);const O=()=>{r.close("expandRecord")},I=n.getProviders(),R=E&&"number"==typeof E?`${E}px`:E;return s.a.createElement("div",{className:`lakex-expand-record lakex-table-expand-record lakex-table-input lakex-ui-modal-mode-${e} lakex-table-input lakex-table-expand-record-layout-${c} `},m&&s.a.createElement(Ede,{desc:g}),s.a.createElement("div",{className:"lakex-table-expand-record-head"},s.a.createElement("div",{className:"lakex-table-expand-record-head-action"},s.a.createElement("h1",{className:"lakex-table-expand-record-title"},l||s.a.createElement("span",{className:"lakex-table-expand-record-empty-title"},kf("未命名记录"))),s.a.createElement("div",{className:"lakex-table-expand-record-head-aciton-wrap"},s.a.createElement(h.a,{placement:"top",title:s.a.createElement("span",null,kf("复制链接"))},s.a.createElement("span",{className:"lakex-table-expand-record-more-action",onClick:e=>{e.stopPropagation();const t=null==C?void 0:C.getOpenLink("record",u);!t||(sde(t),v.a.success({content:kf("复制成功"),style:{zIndex:1050}}))}},s.a.createElement(YP,{type:"Addlink",size:16}))),s.a.createElement("span",{className:"lakex-table-expand-record-action-split"}),s.a.createElement("span",{className:"lakex-table-expand-record-direction"},s.a.createElement(h.a,{placement:"top",title:s.a.createElement("div",{className:"lakex-table-expand-record-direction-tip"},kf("上一条记录"),s.a.createElement("br",null),Oj.adapterHotKey("⌘+shift+,"))},s.a.createElement(b.a,{className:"lakex-table-expand-record-up",disabled:f,onClick:w,type:"text"},s.a.createElement(YP,{type:"ArrowUp",size:16}))),s.a.createElement(h.a,{placement:"top",title:s.a.createElement("div",{className:"lakex-table-expand-record-direction-tip"},kf("下一条记录"),s.a.createElement("br",null),Oj.adapterHotKey("⌘+shift+."))},s.a.createElement(b.a,{className:"lakex-table-expand-record-down",disabled:p,onClick:y,type:"text"},s.a.createElement(YP,{type:"ArrowDown",size:16})))),s.a.createElement("span",{className:"lakex-table-expand-record-action-split"}),s.a.createElement(h.a,{placement:"top",title:kf("关闭弹窗 (ESC)")},s.a.createElement(YP,{type:"RowCollpse",size:16,onClick:O}))))),s.a.createElement("div",{ref:S,className:"lakex-table-expand-record-form",style:{height:R}},null==d?void 0:d.map(((e,t)=>{const r=`${u}-${null==e?void 0:e.uuid}`;return s.a.createElement(Cde,{className:"lakex-table-expand-record-form-item",key:r},s.a.createElement(bde,{recordId:u,field:e,isReadonly:o}))})),!o&&s.a.createElement(_de,null),I.map((e=>{const r=e.RenderComponent;return s.a.createElement(r,{key:u,recordId:u,isReadonly:o,isNewRecord:null==t?void 0:t.isNewRecord})}))),!o&&k&&s.a.createElement("div",{className:"lakex-table-expand-record-operation-button"},s.a.createElement("div",{className:"create-row-footer"},i&&s.a.createElement(b.a,{onClick:_},kf("添加下一个")),s.a.createElement(b.a,{onClick:O},kf("完成")))))},Sde={[Rh.IMAGE]:zZ,[Rh.FILE]:BZ},kde=e=>{const t=e.initialState||{},{fieldType:r,recordId:n,fieldId:i}=t,o=zA(tQ),l=zA(Pb),{fieldUriModel:c}=zA(Ov),u=m0(n,i),d=null==u?void 0:u.value,f=Object(a.useMemo)((()=>r===Rh.IMAGE?kf("图片列表"):r===Rh.FILE?kf("附件列表"):null),[r]),p={style:{width:520},defaultValue:d,onChange:e=>{null==l||l.execCommand("setCell",{...u,value:e})},onOrderChange:({targetUid:e,sourceUid:t})=>{var o,a;const s=null==(o=c.findOne({uid:e}))?void 0:o.uuid,u=null==(a=c.findOne({uid:t}))?void 0:a.uuid;null==l||l.execCommand("updateValueOrder",{fieldId:i,fieldType:r,recordId:n,targetValueId:s,sourceValueId:u})}};if(![Rh.IMAGE,Rh.FILE].includes(r))return null;const h=Sde[r];return s.a.createElement("div",{className:"lakex-table-cell-file-uploader"},s.a.createElement("div",{className:"file-uploader-header"},s.a.createElement("h4",{className:"file-uploader-header-title"},f),s.a.createElement(YP,{type:"Close",className:"file-uploader-close",onClick:e=>{null==o||o.close("expandRecordFileEditable")}})),s.a.createElement(h,{...p}))};var Ode=Object.defineProperty,Ide=Object.getOwnPropertyDescriptor,Rde=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Ide(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ode(t,r,o),o};let Tde=class{constructor(){this._toDestroyCollection=new ep,this._handleExpandRecord=({initialState:e})=>{const{recordId:t}=e;this._openExpandRecord(t),this._modalService.close("context-menu-modal")}}static pluginModule(){return bo().contribution(lde).register(pde).register(this)}static registerConfiguration(e){e.registerConfiguration({id:"expandRecord",type:"object",title:"行展开",properties:{fieldRenderMode:{type:"string",description:"字段渲染模式",enum:Object.values(Dj)},fieldLayoutMode:{type:"string",description:"字段排版模式",enum:Object.values(cde)},modalDrawerModeViews:{type:"array",description:"使用侧边栏打开的视图列表"}}}),e.registerDefaultValue({"expandRecord.fieldRenderMode":Dj.LITE,"expandRecord.fieldLayouteMode":cde.LITE,"expandRecord.modalDrawerModeViews":[Wh.GRID]})}get isReadonly(){return this._abilityService.isReadonly(Nw.TABLE)}get currentViewType(){var e;return null==(e=this._readService.getActiveView())?void 0:e.type}_hasSelection(){var e;return null==(e=this._selectionService)?void 0:e.hasSelection()}init(){this._expandRecordRegistry.init(),this._toDestroyCollection.push(this._renderService.onClickRecord((e=>{const{recordId:t,isNewRecord:r}=e;this.currentViewType!==Wh.FORM&&(this._modalService.close("viewerGridCellEditor"),this._openExpandRecord(t,r))})))}destroy(){this._toDestroyCollection.destroy()}_openExpandRecord(e,t){var r;const n=null!=(r=this._configuration.getValue("expandRecord.modalDrawerModeViews"))&&r.includes(this.currentViewType)?eQ.DRAWER:eQ.MODAL;this._modalService.open("expandRecord",{mode:n,hasMask:n!==eQ.DRAWER,initialState:{recordId:e,isNewRecord:t}})}registerModal(e){e.registerItem({id:"expandRecord",hasMask:!0,scrollStrategy:"block",zIndex:"expandRecord",position:{left:"50%",top:"50%"},hasAnimation:!0,RenderComponent:xde}),e.registerItem({id:"expandRecordFileEditable",hasMask:!1,scrollStrategy:"block",zIndex:"expandRecord",RenderComponent:kde})}registerHotkey(e){e.registerItem({id:"expandRecord",hotkey:"space",name:"行展开",enableOnInput:!1,isEnable:()=>{const e=this.currentViewType===Wh.GRID;return this._hasSelection()&&e},onHotKey:e=>{e.preventDefault(),this._modalService.close("viewerGridCellEditor"),this._modalService.open("expandRecord"),this._openExpandRecord()}})}registerContextMenu(e){e.registerItem({key:"expandRecord",name:()=>this.currentViewType===Wh.GRID?kf("展开行"):kf("展开记录"),icon:"RowExpand",hotkey:Oj.adapterHotKey("Space"),visible:({from:e})=>e===nre.CELL||e===nre.CARD_RECORD||e===nre.KANBAN_RECORD,onClick:this._handleExpandRecord})}};Tde.pluginName="workbench-expand-record",Rde([to(Zj)],Tde.prototype,"_renderService",2),Rde([to(Dy)],Tde.prototype,"_readService",2),Rde([to(Hw)],Tde.prototype,"_abilityService",2),Rde([to(tQ)],Tde.prototype,"_modalService",2),Rde([to(qf)],Tde.prototype,"_configuration",2),Rde([to(e3),Mx()],Tde.prototype,"_selectionService",2),Rde([to(pde)],Tde.prototype,"_expandRecordRegistry",2),Tde=Rde([eo({contrib:[PA,rQ,H2,lde,Ese]})],Tde);var Ade=Object.defineProperty,Nde=Object.getOwnPropertyDescriptor,Mde=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Nde(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ade(t,r,o),o};let Pde=class{static pluginModule(){return bo().contribution(H2).register(this)}init(){this._workbenchHotkeyPluginProvider.getContributions({cache:!1}).forEach((e=>{e.registerHotkey(this._hotkeyRegistry)}))}registerHotkey(e){e.registerItem({id:"save",hotkey:"⌘+S",name:kf("保存"),enableOnInput:!1,isEnable:()=>{var e;return(null==(e=this._readService.getActiveView())?void 0:e.type)!==Wh.FORM},onHotKey:e=>{e.preventDefault(),v.a.success(kf("文档已保存"))}})}};Pde.pluginName="workbench-hotkey",Mde([Eo(H2)],Pde.prototype,"_workbenchHotkeyPluginProvider",2),Mde([to(Aj)],Pde.prototype,"_hotkeyRegistry",2),Mde([to(Dy)],Pde.prototype,"_readService",2),Pde=Mde([eo({contrib:[PA,H2]})],Pde);const jde=["none","-","count","filled","empty","checked","unchecked","unique","-","percentFilled","percentEmpty","percentUnique","-","sum","average","max","min","earliestDate","latestDate","dateRange","monthRange","percentChecked","percentUnchecked"],Dde=({initialState:e})=>{const t=e.stat,r=(null==t?void 0:t.type)||"none",{menus:n,onChange:i}=(({field:e,view:t,stat:r})=>{const n=zA(Pb),i=zA(tQ),o=[];for(const t of jde){const r=jre[t];if("-"!==t){if(r){if(!r.types){o.push({...r,type:t});continue}r.types.includes(e.type)&&o.push({...r,type:t})}}else o.push(t)}return"-"===o[o.length-1]&&o.splice(o.length-1,1),{menus:o,onChange(r,o){"none"===r&&o?null==n||n.execCommand("removeStat",{viewId:t.uuid,fieldId:e.uuid}):null==n||n.execCommand("updateStat",{viewId:t.uuid,fieldId:e.uuid,type:r}),null==i||i.close("stat-option")}}})(e);return s.a.createElement("div",{className:"lakex-table-stats-option-list"},n.map(((e,n)=>{if("-"===e)return s.a.createElement("div",{key:n,className:"lakex-table-stats-option-seperator"});const o=e.type,a=e.text;return o?s.a.createElement("div",{key:o,className:"lakex-table-stats-option-item",onClick:()=>{i(o,t)}},o===r?s.a.createElement(YP,{type:"Check",size:14}):s.a.createElement("span",{className:"lakex-table-stats-empty"}),a):null})))};var Fde=Object.defineProperty,Vde=Object.getOwnPropertyDescriptor,Lde=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Vde(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Fde(t,r,o),o};let $de=class{static pluginModule(){return bo().register(this)}init(){this._statControllerService.onClick((({view:e,field:t,stat:r,target:n})=>{this._modalService.open("stat-option",{position:{placement:"top",origin:n},initialState:{view:e,field:t,stat:r}})}))}registerModal(e){e.registerItem({id:"stat-option",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:Dde})}};$de.pluginName="workbench-statistics",Lde([to(tQ)],$de.prototype,"_modalService",2),Lde([to(Nre)],$de.prototype,"_statControllerService",2),$de=Lde([eo({contrib:[PA,rQ]})],$de);var Bde=Object.defineProperty,zde=Object.getOwnPropertyDescriptor,Ude=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?zde(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Bde(t,r,o),o};let Hde=class{constructor(){this._handleInsertRecordBefore=async({initialState:e})=>{var t,r;const{recordId:n}=e,i=this._readService.getOriginViewRecords(),o=i.findIndex((e=>e.record_uuid===n));if(o<0)return;const a=this._readService.getViewFields(),s=i[o],l=await this._commandService.execCommand("addEmptyRecord",{sourceRecordId:s.record_uuid,direction:"before",groupItemKey:s.group_item_key}),c=this._readService.getActiveView(),u=null==l?void 0:l.result;if((null==c?void 0:c.type)===Wh.GRID){const e=null==(t=this._selectionService)?void 0:t.createGridSelectionByIndex(o,0,((null==i?void 0:i.length)||0)+1,(null==a?void 0:a.length)||0);null==(r=this._selectionService)||r.setSelection(e)}else u&&u[0]&&this._modalService.open("expandRecord",{initialState:{recordId:u[0].uuid}});this._modalService.close("context-menu-modal")},this._handleInsertRecordAfter=async({initialState:e})=>{var t,r;const{recordId:n}=e,i=this._readService.getOriginViewRecords(),o=i.findIndex((e=>e.record_uuid===n));if(o<0)return;const a=this._readService.getViewFields(),s=i[o],l=await this._commandService.execCommand("addEmptyRecord",{sourceRecordId:s.record_uuid,direction:"after",groupItemKey:s.group_item_key}),c=this._readService.getActiveView(),u=null==l?void 0:l.result;if((null==c?void 0:c.type)===Wh.GRID){const e=null==(t=this._selectionService)?void 0:t.createGridSelectionByIndex(o+1,0,((null==i?void 0:i.length)||0)+1,(null==a?void 0:a.length)||0);null==(r=this._selectionService)||r.setSelection(e)}else u&&u[0]&&this._modalService.open("expandRecord",{initialState:{recordId:u[0].uuid}});this._modalService.close("context-menu-modal")},this._handleRemoveRecord=async({initialState:e})=>{var t;const{recordId:r}=e;await this._commandService.execCommand("removeRecords",{recordIds:[r]}),null==(t=this._selectionService)||t.removeSelection(),this._modalService.close("context-menu-modal")},this._handleRemoveRecords=async({initialState:e})=>{var t;const{selection:r}=e;if(r){if(r.isAllSelect)await this._commandService.execCommand("removeRecords",{all:!0});else{const e=r.getRangeAt(0).start.row,t=r.getRangeAt(0).end.row,n=this._readService.getFlatViewRecords().slice(e,t+1).map((e=>e.record_uuid));await this._commandService.execCommand("removeRecords",{recordIds:n})}null==(t=this._selectionService)||t.removeSelection(),this._modalService.close("context-menu-modal")}}}static pluginModule(){return bo().register(this)}get isReadonly(){return this._abilityService.isReadonly(Nw.TABLE)}get currentViewType(){var e;return null==(e=this._readService.getActiveView())?void 0:e.type}init(){}registerToolbar(e){e.registerItem({id:"add-record",icon:"Add",iconSize:14,tooltip:kf("添加记录"),visible:()=>this.currentViewType!==Wh.FORM,showTitle:!0,showTooltip:!1,onClick:async()=>{var e;const t=(await this._commandService.execCommand("addEmptyRecord")).result,r=null==(e=null==t?void 0:t[0])?void 0:e.uuid;r&&So((()=>{var e;null==(e=this._selectionService)||e.moveToRecord(r),this._modalService.open("expandRecord",{initialState:{recordId:r,showAddNext:!0,isNewRecord:!0}})}))}})}registerContextMenu(e){e.registerItem({key:"insertRecordUp",name:()=>this.currentViewType===Wh.GRID?kf("向上插入行"):kf("向上插入记录"),icon:"UpArrow",hotkey:Oj.adapterHotKey("⌘+⇧+Enter"),visible:({from:e})=>!this.isReadonly&&(e===nre.CELL||e===nre.KANBAN_RECORD),onClick:e=>{this.currentViewType===Wh.KANBAN?this._handleInsertRecordAfter(e):this._handleInsertRecordBefore(e)}}),e.registerItem({key:"insertRecordDown",name:()=>this.currentViewType===Wh.GRID?kf("向下插入行"):kf("向下插入记录"),icon:"DownArrow",hotkey:Oj.adapterHotKey("⇧+Enter"),visible:({from:e})=>!this.isReadonly&&(e===nre.CELL||e===nre.KANBAN_RECORD),onClick:e=>{this.currentViewType===Wh.KANBAN?this._handleInsertRecordBefore(e):this._handleInsertRecordAfter(e)}}),e.registerItem({key:"insertRecordLeft",name:kf("向左插入记录"),icon:"LeftArrow",hotkey:"",visible:({from:e})=>!this.isReadonly&&e===nre.CARD_RECORD,onClick:this._handleInsertRecordBefore}),e.registerItem({key:"insertRecordRight",name:kf("向右插入记录"),icon:"RightArrow",hotkey:"",visible:({from:e})=>!this.isReadonly&&e===nre.CARD_RECORD,onClick:this._handleInsertRecordAfter}),e.registerItem({key:"copyRecord",name:kf("复制记录"),hotkey:"",visible:({from:e})=>e===nre.KANBAN_RECORD,onClick:async({initialState:e})=>{const{recordId:t}=e,r=this._readService.getOriginViewRecords(),n=r.findIndex((e=>e.record_uuid===t)),i=r[n];await this._commandService.execCommand("copyRecord",{sourceRecordId:i.record_uuid}),this._modalService.close("context-menu-modal")}}),e.registerItem({key:"removeRecord",name:()=>this.currentViewType===Wh.GRID?kf("删除行"):kf("删除记录"),icon:"Delete",hotkey:"",visible:({from:e})=>!this.isReadonly&&e!==nre.HEADER&&e!==nre.GROUP_HEADER,onClick:async e=>{const{initialState:t}=e,{selection:r}=t;r&&!r.isCollapsed?this._handleRemoveRecords(e):this._handleRemoveRecord(e)}})}};Hde.pluginName="workbench-add-record",Ude([to(tQ)],Hde.prototype,"_modalService",2),Ude([to(Dy)],Hde.prototype,"_readService",2),Ude([to(Pb)],Hde.prototype,"_commandService",2),Ude([to(e3),Mx()],Hde.prototype,"_selectionService",2),Ude([to(Hw)],Hde.prototype,"_abilityService",2),Hde=Ude([eo({contrib:[PA,IJ,Ese]})],Hde);var Wde=Object.defineProperty,Gde=Object.getOwnPropertyDescriptor,Kde=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Gde(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Wde(t,r,o),o};let qde=class extends Zf{constructor(){super(...arguments),this.isInSearching=!1,this._onSearching=this._register(new op),this.onSearching=this._onSearching.event,this._onExitSearching=this._register(new op),this.onExitSearching=this._onExitSearching.event}_getViewSearchResult(e,t=""){const r=this._readService.isGroup(e),n=this._readService.getViewRecords(e),i=this._readService.getViewFields(e),o=[];if(!i||0===i.length)return o;if(r)for(const e of n){const r=e.records;if(r)for(const e of r)for(const r of i){const n=this._getMatch(t,r.field_uuid,e.record_uuid);n&&o.push(n)}}else for(const e of n)for(const r of i){const n=this._getMatch(t,r.field_uuid,e.record_uuid);n&&o.push(n)}return o}_getMatch(e,t,r){const n=this._readService.getCellFormattedValue(t,r);if(n&&n.includes(e))return{fieldId:t,recordId:r}}getSearchResult(e){const t=this._readService.getActiveView();if(!t)return[];const r=this._getViewSearchResult(t.uuid,e);return(null==t?void 0:t.type)!==Wh.GRID?xd(r.map((e=>({recordId:e.recordId}))),"recordId"):r}emitSearchingEvent(){this.isInSearching=!0,this._onSearching.emit()}emitExitSearchingEvent(){this.isInSearching=!1,this._onExitSearching.emit()}destroy(){super.destroy()}};Kde([to(Dy)],qde.prototype,"_readService",2),Kde([Si()],qde.prototype,"destroy",1),qde=Kde([eo()],qde);const Yde=()=>{const e=zA(tQ),t=zA(qde),r=zA($2),n=zA(e3),i=zA(Dy),[o,s]=Object(a.useState)(null),[l,c]=Object(a.useState)(0),[u,d]=Object(a.useState)(0),[f,p]=Object(a.useState)([]),h=Object(a.useRef)(null),m=Object(a.useRef)(null),v=Object(a.useRef)(!1);Object(a.useLayoutEffect)((()=>{const e=setTimeout((()=>{var e;null==(e=m.current)||e.focus()}),50);return()=>{clearTimeout(e)}}));const g=()=>{var e;s(null),p([]),c(0),d(0),null==r||r.clearHighlights(),(null==(e=null==i?void 0:i.getActiveView())?void 0:e.type)!==Wh.GRID&&(null==n||n.removeSelection())},y=gV((()=>{var e,n,i;if(null!=v&&v.current)return;const o=null==(i=(null==(e=m.current)?void 0:e.input)||(null==(n=m.current)?void 0:n.nativeElement))?void 0:i.value;if(!o)return void g();const a=(null==t?void 0:t.getSearchResult(o))||[];s(o),c(a.length),p(a),d(0),a.length>0?null==r||r.setHighlights(a):null==r||r.clearHighlights()}),300);return Object(a.useEffect)((()=>{const e=f[u];if(!e)return;const t=null==n?void 0:n.createSelectionById(e.recordId,e.fieldId);null==n||n.scrollToSelection(t,"center")}),[u,f]),Object(a.useEffect)((()=>{const t=e.onBeforeClose((({modalId:e})=>{"search"===e&&g()}));return()=>{t.destroy()}}),[]),{state:{query:o,count:l,current:u},onCloseSearch:()=>{e.close("search"),g()},onCompositionStart:()=>{v.current=!0},onCompositionEnd:()=>{v.current=!1,y()},searchBox:h,onChangeQuery:y,onClear:()=>{s(null)},searchInput:m,composition:v,onSearchPrev:()=>{d(u>0?u-1:l-1)},onSearchNext:()=>{d(u<l-1?u+1:0)}}},{TabPane:Xde}=I.a,Zde={x:0,y:0},Jde=({top:e=0,left:t=0})=>{var r,n;const{state:i,onCloseSearch:o,searchInput:a,onChangeQuery:l,onCompositionStart:c,onCompositionEnd:d,onSearchPrev:f,onSearchNext:p}=Yde(),{attributes:h,listeners:m,setNodeRef:v,transform:g}=uP({id:"search"});return s.a.createElement("div",{className:"lakex-table-search grid",ref:v,...m,...h,style:{top:e,right:10-t,"--translate-x":`${null!=(r=null==g?void 0:g.x)?r:0}px`,"--translate-y":`${null!=(n=null==g?void 0:g.y)?n:0}px`}},s.a.createElement(YP,{className:"lakex-search-close-action",type:"Close",size:14,onClick:o}),s.a.createElement(I.a,{defaultActiveKey:"search",animated:!1},s.a.createElement(Xde,{tab:kf("查找"),key:"search"},s.a.createElement("div",{className:"search-input"},s.a.createElement(u.a,{ref:a,className:"lakex-table-search-input",defaultValue:i.query,onChange:l,onCompositionStart:c,onCompositionEnd:d,autoFocus:!0,onPressEnter:p}),i.query&&s.a.createElement("span",{className:"search-result"},Math.min(i.current+1,i.count)," / ",i.count)),s.a.createElement("div",{className:"search-foot"},s.a.createElement(b.a,{size:"small",onClick:f},kf("上一个")),s.a.createElement(b.a,{size:"small",onClick:p},kf("下一个"))))))},Qde=()=>{const[{x:e,y:t},r]=Object(a.useState)(Zde),n=TN(RN(IM,{activationConstraint:{distance:8}}));return s.a.createElement(aP,{sensors:n,onDragEnd:({delta:e})=>{r((({x:t,y:r})=>({x:t+e.x,y:r+e.y})))}},s.a.createElement(Jde,{top:t,left:e}))},efe=()=>{const{searchInput:e,onClear:t,composition:r,onCloseSearch:n,onChangeQuery:i}=Yde();return Object(a.useEffect)((()=>{r.current=!1}),[]),s.a.createElement("div",{className:GA("lakex-table-h5-search-bar")},s.a.createElement(u.a,{ref:e,prefix:s.a.createElement(YP,{type:"Search",size:"16",className:"lakex-table-h5-search-icon"}),className:"lakex-table-h5-search-input",placeholder:kf("请输入关键词搜索"),clearable:!0,onClear:t,onChange:i}),s.a.createElement("span",{className:"lakex-table-h5-search-cancel",onClick:n},kf("取消")))},tfe=()=>{const e=zA(qde),t=zA(qf),r=zA(tQ),n=zA(NQ),{state:i,searchBox:o,onCloseSearch:l,searchInput:c,onChangeQuery:d,onCompositionStart:f,onCompositionEnd:p,onSearchNext:m}=Yde(),[v,g]=Object(a.useState)(!1),y=(null==t?void 0:t.getValue("toolbar.mode"))===TJ.NORMAL,b=Object(a.useCallback)((()=>{g(!1),l(),null==e||e.emitExitSearchingEvent()}),[l]),w=Object(a.useCallback)((e=>{e.keyCode===Px.ESC&&b()}),[b]);return Object(a.useEffect)((()=>{const t=null==e?void 0:e.onSearching((()=>{g(!0)}));return()=>{null==t||t.destroy()}}),[]),y?s.a.createElement("button",{className:"lakex-workbench-toolbar-button",onClick:()=>{const e=null==n?void 0:n.getRenderViewPort();!e||null==r||r.open("search",{initialState:{searchParams:{openFrom:"toolbar"}},position:{left:e.right,top:e.top}})},tabIndex:-1},s.a.createElement(YP,{type:"Search"}),s.a.createElement("span",{className:"toolbar-button-title"},kf("搜索"))):v?s.a.createElement("div",{className:"lakex-search-toolbar-btn",ref:o.current},s.a.createElement(u.a,{ref:c,className:"lakex-table-search-input",defaultValue:i.query,placeholder:kf("请输入关键词..."),onChange:d,onCompositionStart:f,onCompositionEnd:p,autoFocus:!0,allowClear:!0,bordered:!1,onPressEnter:m,onKeyDown:w,onBlur:b})):s.a.createElement(h.a,{title:kf("搜索")},s.a.createElement("button",{className:"lakex-workbench-toolbar-button",onClick:()=>{g(!0),null==e||e.emitSearchingEvent()},tabIndex:-1},s.a.createElement(YP,{type:"Search"})))};var rfe=Object.defineProperty,nfe=Object.getOwnPropertyDescriptor,ife=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?nfe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&rfe(t,r,o),o};let ofe=class{static pluginModule(){return bo().register(this).register(qde)}_getSearchPosition(){const e=this._viewportService.getRenderViewPort();return{left:e.right,top:e.top}}get _isLiteMode(){return this._configuration.getValue("toolbar.mode")===TJ.LITE}init(){}registerToolbar(e){const t=this._configuration.getValue("render.mode");this._isLiteMode&&t!==Pj.MOBILE?e.registerItem({id:"search",RenderComponent:tfe}):e.registerItem({id:"search",icon:"Search",tooltip:kf("搜索"),visible:()=>{var e;return(null==(e=this._readService.getActiveView())?void 0:e.type)!==Wh.FORM},onClick:e=>{let r;r=t===Pj.MOBILE?{placement:"cover",origin:this._toolbarService.getDom()}:this._getSearchPosition(),this._modalService.open("search",{initialState:{searchParams:{openFrom:"toolbar"}},position:r})}})}registerModal(e){const t=this._configuration.getValue("render.mode");e.registerItem({id:"search",hasMask:!1,scrollStrategy:"block",zIndex:"modalFromToolbar",RenderComponent:t===Pj.MOBILE?efe:Qde})}registerHotkey(e){e.registerItem({id:"search",hotkey:"⌘+F",name:kf("查找"),enableOnInput:!1,isEnable:()=>{var e;return(null==(e=this._readService.getActiveView())?void 0:e.type)!==Wh.FORM},onHotKey:e=>{e.preventDefault(),this._isLiteMode?this._searchService.emitSearchingEvent():this._modalService.open("search",{initialState:{searchParams:{openFrom:"hotkey"}},position:this._getSearchPosition()})}})}};ofe.pluginName="workbench-search",ife([to(tQ)],ofe.prototype,"_modalService",2),ife([to(Dy)],ofe.prototype,"_readService",2),ife([to(NQ)],ofe.prototype,"_viewportService",2),ife([to(OJ)],ofe.prototype,"_toolbarService",2),ife([to(qf)],ofe.prototype,"_configuration",2),ife([to(qde)],ofe.prototype,"_searchService",2),ofe=ife([eo({contrib:[PA,IJ,rQ,H2]})],ofe);var afe=Object.defineProperty,sfe=Object.getOwnPropertyDescriptor,lfe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?sfe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&afe(t,r,o),o};let cfe=class{constructor(){this._handleCopy=()=>{this._copyCutService.copy(),this._modalService.close("context-menu-modal")},this._handlePaste=()=>{this._pasteService.paste(),this._modalService.close("context-menu-modal")}}static pluginModule(){return bo().register(this)}get isReadonly(){return this._abilityService.isReadonly(Nw.TABLE)}get currentViewType(){var e;return null==(e=this._readService.getActiveView())?void 0:e.type}init(){}registerContextMenu(e){e.registerItem({key:"copy",name:kf("复制"),hotkey:Oj.adapterHotKey("⌘+C"),visible:({from:e})=>e===nre.CELL||e===nre.MULTI_CELL,onClick:this._handleCopy}),e.registerItem({key:"paste",name:kf("粘贴"),hotkey:Oj.adapterHotKey("⌘+V"),visible:({from:e})=>!this.isReadonly&&(e===nre.CELL||e===nre.MULTI_CELL),onClick:this._handlePaste})}};cfe.pluginName="workbench-clipboard",lfe([to(tQ)],cfe.prototype,"_modalService",2),lfe([to(Dy)],cfe.prototype,"_readService",2),lfe([to(Hw)],cfe.prototype,"_abilityService",2),lfe([to(jte)],cfe.prototype,"_copyCutService",2),lfe([to(Lte)],cfe.prototype,"_pasteService",2),cfe=lfe([eo({contrib:[PA,Ese]})],cfe);const ufe=()=>{const e=s0(Nw.TABLE).isReadonly(),[t,r]=Object(a.useState)(!1),n=zA(Pb),i=zA(tQ),o=zA(Lj),l=zA(Zj),c=null==l?void 0:l.getViewNodes(),d=Object(a.useRef)(null),f=l0(),[p,h]=Object(a.useState)((null==f?void 0:f.name)||"");Object(a.useEffect)((()=>{h((null==f?void 0:f.name)||"")}),[f]);const m=Object(a.useMemo)((()=>{let e=0;for(let t=0;t<p.length;t++)e+=p.charCodeAt(t)>255?14:7;return e+16}),[p]),v=async e=>{var t,i;const o=((null==(t=e.target)?void 0:t.value)||"").trim()||kf("表格视图");await n.execCommand("updateViewName",{viewId:null==f?void 0:f.uuid,name:o}),r(!1),null==(i=d.current)||i.blur()},g=Array.from(c).map((e=>e[1])).find((e=>e.viewType===(null==f?void 0:f.type)));return g?s.a.createElement("div",{className:"view-manage-signal-toolbar-item"},s.a.createElement("div",{onClick:()=>{e||r(!0)},id:"lakex-table-toolbar-view-manage",className:GA("view-manage",!t&&"view-manage-normal")},g.icon({className:g.colorCls,size:16}),s.a.createElement(u.a,{ref:d,onClick:()=>{var e;null==(e=d.current)||e.focus()},onMouseDown:e=>{e.stopPropagation()},value:p,style:{width:m},onChange:e=>{const t=e.target.value;h(t)},onBlur:v,onPressEnter:v,bordered:!1,className:GA("input-name",e&&"input-name-disable"),placeholder:kf("视图名称")})),!e&&(null==o?void 0:o.isActive)&&s.a.createElement("button",{className:"lakex-workbench-toolbar-button",onClick:e=>{const t=e.currentTarget;null==i||i.open("add-view",{position:{origin:t,placement:"bottom"}})}},s.a.createElement(YP,{type:"Add"}),s.a.createElement("span",{className:"toolbar-button-title"},kf("新建视图")))):null},dfe=({onCommand:e})=>{const t=c0(),r=l0(),n=zA(Zj),i=null==n?void 0:n.getViewNodes();if(Object(a.useMemo)((()=>1===t.length),[t]))return s.a.createElement(ufe,null);const o=Array.from(i).map((e=>e[1])).find((e=>e.viewType===(null==r?void 0:r.type)));return o?s.a.createElement(s.a.Fragment,null,s.a.createElement("button",{className:"lakex-workbench-toolbar-button view-manage-multiple-toolbar-item",onClick:e,tabIndex:-1},o.icon({className:o.colorCls,size:16}),s.a.createElement("span",{className:"lakex-table-view-manage-title"},null==r?void 0:r.name),s.a.createElement(YP,{type:"ArrowDown"}))):null},ffe=e=>{const t=zA(tQ),r=zA(Pb),n=zA(MD),i=zA(qf),o=zA(Zj),l=s0(Nw.TABLE).isReadonly(),c=null==o?void 0:o.getViewNodes(),u=Object(a.useMemo)((()=>{if(c){const e=i.getValue("viewerManage.viewTypes"),t=Array.from(c).map((e=>e[1]));return e.map((e=>{const r=t.find((t=>t.viewType===e));return r?{key:e,icon:r.icon({className:r.colorCls,size:16}),title:r.title,desc:r.desc}:null})).filter((e=>!!e))}return[]}),[c]),d=Object(a.useMemo)((()=>e.hasTitle?[{icon:s.a.createElement(YP,{type:"Add"}),title:s.a.createElement("span",null,kf("新建视图")),children:u}]:u),[e.hasTitle]);return s.a.createElement(tj,{menuKey:"addView",configs:d,onClick:async e=>{const i=Io(32);await r.execCommand("addView",{uuid:i,type:e.key}),null==n||n.open("view",i),t.close("add-view"),t.close("view-manage")},className:GA({"lakex-table-menu-container":!0,"lakex-table-view-create":!0,"lakex-table-view-create-no-title":!e.hasTitle}),onDoubleClick:()=>{},onInputBlur:()=>{},readonly:l})};ffe.defaultProps={hasTitle:!1};const pfe=[{key:"rename",title:kf("重命名视图")},{key:"copy",title:kf("复制视图")},{key:"remove",title:kf("删除视图")}],hfe=()=>{const e=zA(tQ),t=zA(Pb),r=zA(MD),n=zA(Yre),i=zA(Zj),o=zA(qf),s=s0(Nw.TABLE).isReadonly(),l=c0(),c=l0(),[u,d]=Object(a.useState)(null),f=i.getViewNodes(),p=Object(a.useMemo)((()=>{const e=o.getValue("viewerManage.viewTypes");return l.filter((t=>e.includes(t.type)))}),[l]),h=async(r,n)=>{var i;const o=r.key,a=n.key;switch(null==(i=n.domEvent)||i.stopPropagation(),a){case"rename":d(o);break;case"copy":await t.execCommand("copyView",{viewId:o}),e.close("view-manage");break;case"remove":if(p.length<=1)return;t.execCommand("removeView",{viewId:o}),e.close("view-manage")}},m=()=>{d(null)},v=async(e,r)=>{e.stopPropagation(),await t.execCommand("updateViewName",{viewId:r.key,name:e.target.value}),m()},g=Object(a.useCallback)(((e={unActiveViewColor:!1})=>p.map((t=>{const r=Array.from(f).map((e=>e[1])).find((e=>e.viewType===t.type));if(!r)return null;let n;return n=e.unActiveViewColor&&(null==c?void 0:c.uuid)!==t.uuid?"":r.colorCls,{key:t.uuid,title:t.name,icon:r.icon({className:n,size:16}),onSettingClick:h,onTitleChange:v,settings:pfe,draggable:!0}})).filter((e=>!!e))),[l]);return{views:l,isReadonly:s,activeView:c,onModalClose:()=>{e.close("view-manage")},onChooseView:async t=>{if(u)return;const n=t.key,i=p.find((e=>e.uuid===n));i&&(null==r||r.open("view",i.uuid),e.close("view-manage"))},onRenameView:e=>{d(e.key)},editingKey:u,onDragEnd:async e=>{const{active:t,over:r}=e;t.id!==r.id&&await n.updateViewOrder(t.id,r.id)},onCancelEditing:m,onViewNameChange:v,onHandleSetting:h,getChooseConfigs:g}},mfe=()=>{const{views:e,getChooseConfigs:t,onChooseView:r,onRenameView:n,onCancelEditing:i,onDragEnd:o,isReadonly:a,editingKey:l,activeView:c}=hfe();if(e.length<=1)return null;const u=t();return s.a.createElement("div",{className:"lakex-table-menu-container lakex-table-view-manage"},s.a.createElement(tj,{menuKey:u.map((e=>null==e?void 0:e.title)).join(","),configs:u,onClick:r,onDoubleClick:()=>!a&&n,defaultSelectedKeys:[(null==c?void 0:c.uuid)||""],onInputBlur:i,editingKey:l,className:"lakex-table-view-manage-inner",readonly:a,onDragEnd:o,draggable:!a}),!a&&s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"lakex-table-view-manage-hr"}),s.a.createElement(ffe,{hasTitle:!0})))},vfe=e=>{const{getChooseConfigs:t,onChooseView:r,onModalClose:n,activeView:i}=hfe();return s.a.createElement(sue,{title:kf("切换视图"),onClose:n,showCloseIcon:!0},s.a.createElement(fue,{defaultValue:i.uuid,list:t(),onCheck:e=>r(e)}))};var gfe=(e=>(e.MENU="menu",e.TAB="tab",e))(gfe||{});const yfe=Object(a.createContext)(null);var bfe=a.forwardRef((function(e,t){var r=e.prefixCls,n=e.className,i=e.style,o=e.id,s=e.active,l=e.tabKey,c=e.children;return a.createElement("div",{id:o&&"".concat(o,"-panel-").concat(l),role:"tabpanel",tabIndex:s?0:-1,"aria-labelledby":o&&"".concat(o,"-tab-").concat(l),"aria-hidden":!s,style:i,className:GA(r,s&&"".concat(r,"-active"),n),ref:t},c)}));"production"!==Ti.exports.env.NODE_ENV&&(bfe.displayName="TabPane");var wfe=["key","forceRender","style","className"];function _fe(e){var t=e.id,r=e.activeKey,n=e.animated,i=e.tabPosition,o=e.destroyInactiveTabPane,s=a.useContext(yfe),l=s.prefixCls,c=s.tabs,u=n.tabPane,d="".concat(l,"-tabpane");return a.createElement("div",{className:GA("".concat(l,"-content-holder"))},a.createElement("div",{className:GA("".concat(l,"-content"),"".concat(l,"-content-").concat(i),sL({},"".concat(l,"-content-animated"),u))},c.map((function(e){var i=e.key,s=e.forceRender,l=e.style,c=e.className,f=gL(e,wfe),p=i===r;return a.createElement(sz,iL({key:i,visible:p,forceRender:s,removeOnLeave:!!o,leavedClassName:"".concat(d,"-hidden")},n.tabPaneMotion),(function(e,r){var n=e.style,o=e.className;return a.createElement(bfe,iL({},f,{prefixCls:d,id:t,tabKey:i,animated:u,active:p,style:hL(hL({},l),n),className:GA(c,o),ref:r}))}))}))))}var Cfe=new Map;var Efe=new xY((function(e){e.forEach((function(e){var t,r=e.target;null===(t=Cfe.get(r))||void 0===t||t.forEach((function(e){return e(r)}))}))}));Ti.exports.env.NODE_ENV,Ti.exports.env.NODE_ENV;var xfe=function(e){SL(r,e);var t=OL(r);function r(){return wL(this,r),t.apply(this,arguments)}return CL(r,[{key:"render",value:function(){return this.props.children}}]),r}(a.Component),Sfe=a.createContext(null);function kfe(e,t){var r=e.children,n=e.disabled,i=a.useRef(null),o=a.useRef(null),s=a.useContext(Sfe),l="function"==typeof r,c=l?r(i):r,u=a.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),d=!l&&a.isValidElement(c)&&wB(c),f=d?c.ref:null,p=a.useMemo((function(){return yB(f,i)}),[f,i]),h=function(){return vB(i.current)||vB(o.current)};a.useImperativeHandle(t,(function(){return h()}));var m=a.useRef(e);m.current=e;var v=a.useCallback((function(e){var t=m.current,r=t.onResize,n=t.data,i=e.getBoundingClientRect(),o=i.width,a=i.height,l=e.offsetWidth,c=e.offsetHeight,d=Math.floor(o),f=Math.floor(a);if(u.current.width!==d||u.current.height!==f||u.current.offsetWidth!==l||u.current.offsetHeight!==c){var p={width:d,height:f,offsetWidth:l,offsetHeight:c};u.current=p;var h=l===Math.round(o)?o:l,v=c===Math.round(a)?a:c,g=hL(hL({},p),{},{offsetWidth:h,offsetHeight:v});null==s||s(g,e,n),r&&Promise.resolve().then((function(){r(g,e)}))}}),[]);return a.useEffect((function(){var e=h();return e&&!n&&function(e,t){Cfe.has(e)||(Cfe.set(e,new Set),Efe.observe(e)),Cfe.get(e).add(t)}(e,v),function(){return function(e,t){Cfe.has(e)&&(Cfe.get(e).delete(t),Cfe.get(e).size||(Efe.unobserve(e),Cfe.delete(e)))}(e,v)}}),[i.current,n]),a.createElement(xfe,{ref:o},d?a.cloneElement(c,{ref:p}):c)}var Ofe=a.forwardRef(kfe);"production"!==Ti.exports.env.NODE_ENV&&(Ofe.displayName="SingleObserver");function Ife(e,t){var r=e.children,n="function"==typeof r?[r]:RL(r);return"production"!==Ti.exports.env.NODE_ENV&&(n.length>1?NL(!1,"Find more than one child node with `children` in ResizeObserver. Please use ResizeObserver.Collection instead."):0===n.length&&NL(!1,"`children` of ResizeObserver is empty. Nothing is in observe.")),n.map((function(r,n){var i=(null==r?void 0:r.key)||"".concat("rc-observer-key","-").concat(n);return a.createElement(Ofe,iL({},e,{key:i,ref:0===n?t:void 0}),r)}))}var Rfe=a.forwardRef(Ife);"production"!==Ti.exports.env.NODE_ENV&&(Rfe.displayName="ResizeObserver"),Rfe.Collection=function(e){var t=e.children,r=e.onBatchResize,n=a.useRef(0),i=a.useRef([]),o=a.useContext(Sfe),s=a.useCallback((function(e,t,a){n.current+=1;var s=n.current;i.current.push({size:e,element:t,data:a}),Promise.resolve().then((function(){s===n.current&&(null==r||r(i.current),i.current=[])})),null==o||o(e,t,a)}),[r,o]);return a.createElement(Sfe.Provider,{value:s},t)};var Tfe={width:0,height:0,left:0,top:0};function Afe(e,t){var r=a.useRef(e),n=fL(a.useState({}),2)[1];return[r.current,function(e){var i="function"==typeof e?e(r.current):e;i!==r.current&&t(i,r.current),r.current=i,n({})}]}var Nfe=.1,Mfe=.01,Pfe=20,jfe=Math.pow(.995,Pfe);function Dfe(e){var t=fL(Object(a.useState)(0),2),r=t[0],n=t[1],i=Object(a.useRef)(0),o=Object(a.useRef)();return o.current=e,gG((function(){var e;null===(e=o.current)||void 0===e||e.call(o)}),[r]),function(){i.current===r&&(i.current+=1,n(i.current))}}var Ffe={width:0,height:0,left:0,top:0,right:0};function Vfe(e){var t;return e instanceof Map?(t={},e.forEach((function(e,r){t[r]=e}))):t=e,JSON.stringify(t)}var Lfe="TABS_DQ";function $fe(e){return String(e).replace(/"/g,Lfe)}function Bfe(e,t,r,n){return!(!r||n||!1===e||void 0===e&&(!1===t||null===t))}function zfe(e,t){var r=e.prefixCls,n=e.editable,i=e.locale,o=e.style;return n&&!1!==n.showAdd?a.createElement("button",{ref:t,type:"button",className:"".concat(r,"-nav-add"),style:o,"aria-label":(null==i?void 0:i.addAriaLabel)||"Add tab",onClick:function(e){n.onEdit("add",{event:e})}},n.addIcon||"+"):null}const Ufe=a.forwardRef(zfe);var Hfe=a.forwardRef((function(e,t){var r=e.position,n=e.prefixCls,i=e.extra;if(!i)return null;var o,s={};return"object"!==oL(i)||a.isValidElement(i)?s.right=i:s=i,"right"===r&&(o=s.right),"left"===r&&(o=s.left),o?a.createElement("div",{className:"".concat(n,"-extra-content"),ref:t},o):null}));"production"!==Ti.exports.env.NODE_ENV&&(Hfe.displayName="ExtraContent");var Wfe,Gfe=a.createContext(null),Kfe=[];function qfe(e){var t=e.match(/^(.*)px$/),r=Number(null==t?void 0:t[1]);return Number.isNaN(r)?function(e){if(typeof document>"u")return 0;if(e||void 0===Wfe){var t=document.createElement("div");t.style.width="100%",t.style.height="200px";var r=document.createElement("div"),n=r.style;n.position="absolute",n.top="0",n.left="0",n.pointerEvents="none",n.visibility="hidden",n.width="200px",n.height="150px",n.overflow="hidden",r.appendChild(t),document.body.appendChild(r);var i=t.offsetWidth;r.style.overflow="scroll";var o=t.offsetWidth;i===o&&(o=r.clientWidth),document.body.removeChild(r),Wfe=i-o}return Wfe}():r}var Yfe="rc-util-locker-".concat(Date.now()),Xfe=0;function Zfe(e){var t=!!e,r=fL(a.useState((function(){return Xfe+=1,"".concat(Yfe,"_").concat(Xfe)})),1)[0];vG((function(){if(t){var e=function(e){if(typeof document>"u"||!e||!(e instanceof Element))return{width:0,height:0};var t=getComputedStyle(e,"::-webkit-scrollbar"),r=t.width,n=t.height;return{width:qfe(r),height:qfe(n)}}(document.body).width,n=document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth;oU("\nhtml body {\n  overflow-y: hidden;\n  ".concat(n?"width: calc(100% - ".concat(e,"px);"):"","\n}"),r)}else iU(r);return function(){iU(r)}}),[t,r])}var Jfe=!1;var Qfe=function(e){return!1!==e&&(PB()&&e?"string"==typeof e?document.querySelector(e):"function"==typeof e?e():e:null)},epe=a.forwardRef((function(e,t){var r=e.open,n=e.autoLock,i=e.getContainer,o=e.debug,s=e.autoDestroy,c=void 0===s||s,u=e.children,d=fL(a.useState(r),2),f=d[0],p=d[1],h=f||r;"production"!==Ti.exports.env.NODE_ENV&&jL(PB()||!r,"Portal only work in client side. Please call 'useEffect' to show Portal instead default render in SSR."),a.useEffect((function(){(c||r)&&p(r)}),[r,c]);var m=fL(a.useState((function(){return Qfe(i)})),2),v=m[0],g=m[1];a.useEffect((function(){var e=Qfe(i);g(null!=e?e:null)}));var y=function(e,t){var r=fL(a.useState((function(){if(!PB())return null;var e=document.createElement("div");return"production"!==Ti.exports.env.NODE_ENV&&t&&e.setAttribute("data-debug",t),e})),1)[0],n=a.useRef(!1),i=a.useContext(Gfe),o=fL(a.useState(Kfe),2),s=o[0],l=o[1],c=i||(n.current?void 0:function(e){l((function(t){return[e].concat(bL(t))}))});function u(){r.parentElement||document.body.appendChild(r),n.current=!0}function d(){var e;null===(e=r.parentElement)||void 0===e||e.removeChild(r),n.current=!1}return vG((function(){return e?i?i(u):u():d(),d}),[e]),vG((function(){s.length&&(s.forEach((function(e){return e()})),l(Kfe))}),[s]),[r,c]}(h&&!v,o),b=fL(y,2),w=b[0],_=b[1],C=null!=v?v:w;Zfe(n&&r&&PB()&&(C===w||C===document.body));var E=null;u&&wB(u)&&t&&(E=u.ref);var x=bB(E,t);if(!h||!PB()||void 0===v)return null;var S=!1===C||function(e){return"boolean"==typeof e&&(Jfe=e),Jfe}(),k=u;return t&&(k=a.cloneElement(u,{ref:x})),a.createElement(Gfe.Provider,{value:_},S?k:Object(l.createPortal)(k,C))}));function tpe(e){var t;return null==e||null===(t=e.getRootNode)||void 0===t?void 0:t.call(e)}function rpe(e){return function(e){return tpe(e)instanceof ShadowRoot}(e)?tpe(e):null}"production"!==Ti.exports.env.NODE_ENV&&(epe.displayName="Portal");var npe=0;function ipe(e){var t=fL(a.useState("ssr-id"),2),r=t[0],n=t[1],i=hL({},a).useId,o=null==i?void 0:i();return a.useEffect((function(){if(!i){var e=npe;npe+=1,n("rc_unique_".concat(e))}}),[]),e||("test"===Ti.exports.env.NODE_ENV?"test-id":o||r)}var ope=a.createContext(null);function ape(e){return e?Array.isArray(e)?e:[e]:[]}function spe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(arguments.length>2?arguments[2]:void 0)?e[0]===t[0]:e[0]===t[0]&&e[1]===t[1]}function lpe(e,t,r,n){return t||(r?{motionName:"".concat(e,"-").concat(r)}:n?{motionName:n}:null)}function cpe(e){return e.ownerDocument.defaultView}function upe(e){for(var t=[],r=null==e?void 0:e.parentElement,n=["hidden","scroll","clip","auto"];r;){var i=cpe(r).getComputedStyle(r);[i.overflowX,i.overflowY,i.overflow].some((function(e){return n.includes(e)}))&&t.push(r),r=r.parentElement}return t}function dpe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Number.isNaN(e)?t:e}function fpe(e){return dpe(parseFloat(e),0)}function ppe(e,t){var r=hL({},e);return(t||[]).forEach((function(e){if(!(e instanceof HTMLBodyElement||e instanceof HTMLHtmlElement)){var t=cpe(e).getComputedStyle(e),n=t.overflow,i=t.overflowClipMargin,o=t.borderTopWidth,a=t.borderBottomWidth,s=t.borderLeftWidth,l=t.borderRightWidth,c=e.getBoundingClientRect(),u=e.offsetHeight,d=e.clientHeight,f=e.offsetWidth,p=e.clientWidth,h=fpe(o),m=fpe(a),v=fpe(s),g=fpe(l),y=dpe(Math.round(c.width/f*1e3)/1e3),b=dpe(Math.round(c.height/u*1e3)/1e3),w=(f-p-v-g)*y,_=(u-d-h-m)*b,C=h*b,E=m*b,x=v*y,S=g*y,k=0,O=0;if("clip"===n){var I=fpe(i);k=I*y,O=I*b}var R=c.x+x-k,T=c.y+C-O,A=R+c.width+2*k-x-S-w,N=T+c.height+2*O-C-E-_;r.left=Math.max(r.left,R),r.top=Math.max(r.top,T),r.right=Math.min(r.right,A),r.bottom=Math.min(r.bottom,N)}})),r}function hpe(e){var t="".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0),r=t.match(/^(.*)\%$/);return r?e*(parseFloat(r[1])/100):parseFloat(t)}function mpe(e,t){var r=fL(t||[],2),n=r[0],i=r[1];return[hpe(e.width,n),hpe(e.height,i)]}function vpe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return[e[0],e[1]]}function gpe(e,t){var r,n=t[0],i=t[1];return r="t"===n?e.y:"b"===n?e.y+e.height:e.y+e.height/2,{x:"l"===i?e.x:"r"===i?e.x+e.width:e.x+e.width/2,y:r}}function ype(e,t){var r={t:"b",b:"t",l:"r",r:"l"};return e.map((function(e,n){return n===t?r[e]||"c":e})).join("")}function bpe(e){var t=e.prefixCls,r=e.align,n=e.arrow,i=e.arrowPos,o=n||{},s=o.className,l=o.content,c=i.x,u=void 0===c?0:c,d=i.y,f=void 0===d?0:d,p=a.useRef();if(!r||!r.points)return null;var h={position:"absolute"};if(!1!==r.autoArrow){var m=r.points[0],v=r.points[1],g=m[0],y=m[1],b=v[0],w=v[1];g!==b&&["t","b"].includes(g)?"t"===g?h.top=0:h.bottom=0:h.top=f,y!==w&&["l","r"].includes(y)?"l"===y?h.left=0:h.right=0:h.left=u}return a.createElement("div",{ref:p,className:GA("".concat(t,"-arrow"),s),style:h},l)}function wpe(e){var t=e.prefixCls,r=e.open,n=e.zIndex,i=e.mask,o=e.motion;return i?a.createElement(sz,iL({},o,{motionAppear:!0,visible:r,removeOnLeave:!0}),(function(e){var r=e.className;return a.createElement("div",{style:{zIndex:n},className:GA("".concat(t,"-mask"),r)})})):null}var _pe=a.memo((function(e){return e.children}),(function(e,t){return t.cache}));"production"!==Ti.exports.env.NODE_ENV&&(_pe.displayName="PopupContent");var Cpe=a.forwardRef((function(e,t){var r=e.popup,n=e.className,i=e.prefixCls,o=e.style,s=e.target,l=e.onVisibleChanged,c=e.open,u=e.keepDom,d=e.onClick,f=e.mask,p=e.arrow,h=e.arrowPos,m=e.align,v=e.motion,g=e.maskMotion,y=e.forceRender,b=e.getPopupContainer,w=e.autoDestroy,_=e.portal,C=e.zIndex,E=e.onMouseEnter,x=e.onMouseLeave,S=e.onPointerEnter,k=e.ready,O=e.offsetX,I=e.offsetY,R=e.offsetR,T=e.offsetB,A=e.onAlign,N=e.onPrepare,M=e.stretch,P=e.targetWidth,j=e.targetHeight,D="function"==typeof r?r():r,F=c||u,V=(null==b?void 0:b.length)>0,L=fL(a.useState(!b||!V),2),$=L[0],B=L[1];if(vG((function(){!$&&V&&s&&B(!0)}),[$,V,s]),!$)return null;var z="auto",U={left:"-1000vw",top:"-1000vh",right:z,bottom:z};if(k||!c){var H=m.points,W=m._experimental,G=null==W?void 0:W.dynamicInset,K=G&&"r"===H[0][1],q=G&&"b"===H[0][0];K?(U.right=R,U.left=z):(U.left=O,U.right=z),q?(U.bottom=T,U.top=z):(U.top=I,U.bottom=z)}var Y={};return M&&(M.includes("height")&&j?Y.height=j:M.includes("minHeight")&&j&&(Y.minHeight=j),M.includes("width")&&P?Y.width=P:M.includes("minWidth")&&P&&(Y.minWidth=P)),c||(Y.pointerEvents="none"),a.createElement(_,{open:y||F,getContainer:b&&function(){return b(s)},autoDestroy:w},a.createElement(wpe,{prefixCls:i,open:c,zIndex:C,mask:f,motion:g}),a.createElement(Rfe,{onResize:A,disabled:!c},(function(e){return a.createElement(sz,iL({motionAppear:!0,motionEnter:!0,motionLeave:!0,removeOnLeave:!1,forceRender:y,leavedClassName:"".concat(i,"-hidden")},v,{onAppearPrepare:N,onEnterPrepare:N,visible:c,onVisibleChanged:function(e){var t;null==v||null===(t=v.onVisibleChanged)||void 0===t||t.call(v,e),l(e)}}),(function(r,s){var l=r.className,u=r.style,f=GA(i,l,n);return a.createElement("div",{ref:yB(e,t,s),className:f,style:hL(hL(hL(hL({"--arrow-x":"".concat(h.x||0,"px"),"--arrow-y":"".concat(h.y||0,"px")},U),Y),u),{},{boxSizing:"border-box",zIndex:C},o),onMouseEnter:E,onMouseLeave:x,onPointerEnter:S,onClick:d},p&&a.createElement(bpe,{prefixCls:i,arrow:p,arrowPos:h,align:m}),a.createElement(_pe,{cache:!c},D))}))})))}));"production"!==Ti.exports.env.NODE_ENV&&(Cpe.displayName="Popup");var Epe=a.forwardRef((function(e,t){var r=e.children,n=e.getTriggerDOMNode,i=wB(r),o=bB(a.useCallback((function(e){gB(t,n?n(e):e)}),[n]),r.ref);return i?a.cloneElement(r,{ref:o}):r}));"production"!==Ti.exports.env.NODE_ENV&&(Epe.displayName="TriggerWrapper");var xpe=["prefixCls","children","action","showAction","hideAction","popupVisible","defaultPopupVisible","onPopupVisibleChange","afterPopupVisibleChange","mouseEnterDelay","mouseLeaveDelay","focusDelay","blurDelay","mask","maskClosable","getPopupContainer","forceRender","autoDestroy","destroyPopupOnHide","popup","popupClassName","popupStyle","popupPlacement","builtinPlacements","popupAlign","zIndex","stretch","getPopupClassNameFromAlign","alignPoint","onPopupClick","onPopupAlign","arrow","popupMotion","maskMotion","popupTransitionName","popupAnimation","maskTransitionName","maskAnimation","className","getTriggerDOMNode"];const Spe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:epe,t=a.forwardRef((function(t,r){var n=t.prefixCls,i=void 0===n?"rc-trigger-popup":n,o=t.children,s=t.action,c=void 0===s?"hover":s,u=t.showAction,d=t.hideAction,f=t.popupVisible,p=t.defaultPopupVisible,h=t.onPopupVisibleChange,m=t.afterPopupVisibleChange,v=t.mouseEnterDelay,g=t.mouseLeaveDelay,y=void 0===g?.1:g,b=t.focusDelay,w=t.blurDelay,_=t.mask,C=t.maskClosable,E=void 0===C||C,x=t.getPopupContainer,S=t.forceRender,k=t.autoDestroy,O=t.destroyPopupOnHide,I=t.popup,R=t.popupClassName,T=t.popupStyle,A=t.popupPlacement,N=t.builtinPlacements,M=void 0===N?{}:N,P=t.popupAlign,j=t.zIndex,D=t.stretch,F=t.getPopupClassNameFromAlign,V=t.alignPoint,L=t.onPopupClick,$=t.onPopupAlign,B=t.arrow,z=t.popupMotion,U=t.maskMotion,H=t.popupTransitionName,W=t.popupAnimation,G=t.maskTransitionName,K=t.maskAnimation,q=t.className,Y=t.getTriggerDOMNode,X=gL(t,xpe),Z=k||O||!1,J=fL(a.useState(!1),2),Q=J[0],ee=J[1];vG((function(){ee(qK())}),[]);var te=a.useRef({}),re=a.useContext(ope),ne=a.useMemo((function(){return{registerSubPopup:function(e,t){te.current[e]=t,null==re||re.registerSubPopup(e,t)}}}),[re]),ie=ipe(),oe=fL(a.useState(null),2),ae=oe[0],se=oe[1],le=hG((function(e){mB(e)&&ae!==e&&se(e),null==re||re.registerSubPopup(ie,e)})),ce=fL(a.useState(null),2),ue=ce[0],de=ce[1],fe=hG((function(e){mB(e)&&ue!==e&&de(e)})),pe=a.Children.only(o),he=(null==pe?void 0:pe.props)||{},me={},ve=hG((function(e){var t,r,n=ue;return(null==n?void 0:n.contains(e))||(null===(t=rpe(n))||void 0===t?void 0:t.host)===e||e===n||(null==ae?void 0:ae.contains(e))||(null===(r=rpe(ae))||void 0===r?void 0:r.host)===e||e===ae||Object.values(te.current).some((function(t){return(null==t?void 0:t.contains(e))||e===t}))})),ge=lpe(i,z,W,H),ye=lpe(i,U,K,G),be=fL(a.useState(p||!1),2),we=be[0],_e=be[1],Ce=null!=f?f:we,Ee=hG((function(e){void 0===f&&_e(e)}));vG((function(){_e(f||!1)}),[f]);var xe=a.useRef(Ce);xe.current=Ce;var Se=hG((function(e){Object(l.flushSync)((function(){Ce!==e&&(Ee(e),null==h||h(e))}))})),ke=a.useRef(),Oe=function(){clearTimeout(ke.current)},Ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Oe(),0===t?Se(e):ke.current=setTimeout((function(){Se(e)}),1e3*t)};a.useEffect((function(){return Oe}),[]);var Re=fL(a.useState(!1),2),Te=Re[0],Ae=Re[1];vG((function(e){(!e||Ce)&&Ae(!0)}),[Ce]);var Ne=fL(a.useState(null),2),Me=Ne[0],Pe=Ne[1],je=fL(a.useState([0,0]),2),De=je[0],Fe=je[1],Ve=function(e){Fe([e.clientX,e.clientY])},Le=function(e,t,r,n,i,o,s){var l=fL(a.useState({ready:!1,offsetX:0,offsetY:0,offsetR:0,offsetB:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:i[n]||{}}),2),c=l[0],u=l[1],d=a.useRef(0),f=a.useMemo((function(){return t?upe(t):[]}),[t]),p=a.useRef({});e||(p.current={});var h=hG((function(){if(t&&r&&e){let e=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:G,n=k.x+e,i=k.y+t,o=n+j,a=i+P,s=Math.max(n,r.left),l=Math.max(i,r.top),c=Math.min(o,r.right),u=Math.min(a,r.bottom);return Math.max(0,(c-s)*(u-l))},at=function(){oe=k.y+ge,ae=oe+P,se=k.x+ve,le=se+j};var a,l,c,d=t,h=d.ownerDocument,m=cpe(d).getComputedStyle(d),v=m.width,g=m.height,y=m.position,b=d.style.left,w=d.style.top,_=d.style.right,C=d.style.bottom,E=hL(hL({},i[n]),o),x=h.createElement("div");if(null===(a=d.parentElement)||void 0===a||a.appendChild(x),x.style.left="".concat(d.offsetLeft,"px"),x.style.top="".concat(d.offsetTop,"px"),x.style.position=y,x.style.height="".concat(d.offsetHeight,"px"),x.style.width="".concat(d.offsetWidth,"px"),d.style.left="0",d.style.top="0",d.style.right="auto",d.style.bottom="auto",Array.isArray(r))c={x:r[0],y:r[1],width:0,height:0};else{var S=r.getBoundingClientRect();c={x:S.x,y:S.y,width:S.width,height:S.height}}var k=d.getBoundingClientRect(),O=h.documentElement,I=O.clientWidth,R=O.clientHeight,T=O.scrollWidth,A=O.scrollHeight,N=O.scrollTop,M=O.scrollLeft,P=k.height,j=k.width,D=c.height,F=c.width,V={left:0,top:0,right:I,bottom:R},L={left:-M,top:-N,right:T-M,bottom:A-N},$=E.htmlRegion,B="visible",z="visibleFirst";"scroll"!==$&&$!==z&&($=B);var U=$===z,H=ppe(L,f),W=ppe(V,f),G=$===B?W:H,K=U?W:G;d.style.left="auto",d.style.top="auto",d.style.right="0",d.style.bottom="0";var q=d.getBoundingClientRect();d.style.left=b,d.style.top=w,d.style.right=_,d.style.bottom=C,null===(l=d.parentElement)||void 0===l||l.removeChild(x);var Y=dpe(Math.round(j/parseFloat(v)*1e3)/1e3),X=dpe(Math.round(P/parseFloat(g)*1e3)/1e3);if(0===Y||0===X||mB(r)&&!NG(r))return;var Z=E.offset,J=E.targetOffset,Q=fL(mpe(k,Z),2),ee=Q[0],te=Q[1],re=fL(mpe(c,J),2),ne=re[0],ie=re[1];c.x-=ne,c.y-=ie;var oe,ae,se,le,ce=fL(E.points||[],2),ue=ce[0],de=vpe(ce[1]),fe=vpe(ue),pe=gpe(c,de),he=gpe(k,fe),me=hL({},E),ve=pe.x-he.x+ee,ge=pe.y-he.y+te,ye=e(ve,ge),be=e(ve,ge,W),we=gpe(c,["t","l"]),_e=gpe(k,["t","l"]),Ce=gpe(c,["b","r"]),Ee=gpe(k,["b","r"]),xe=E.overflow||{},Se=xe.adjustX,ke=xe.adjustY,Oe=xe.shiftX,Ie=xe.shiftY,Re=function(e){return"boolean"==typeof e?e:e>=0};at();var Te=Re(ke),Ae=fe[0]===de[0];if(Te&&"t"===fe[0]&&(ae>K.bottom||p.current.bt)){var Ne=ge;Ae?Ne-=P-D:Ne=we.y-Ee.y-te;var Me=e(ve,Ne),Pe=e(ve,Ne,W);Me>ye||Me===ye&&(!U||Pe>=be)?(p.current.bt=!0,ge=Ne,te=-te,me.points=[ype(fe,0),ype(de,0)]):p.current.bt=!1}if(Te&&"b"===fe[0]&&(oe<K.top||p.current.tb)){var je=ge;Ae?je+=P-D:je=Ce.y-_e.y-te;var De=e(ve,je),Fe=e(ve,je,W);De>ye||De===ye&&(!U||Fe>=be)?(p.current.tb=!0,ge=je,te=-te,me.points=[ype(fe,0),ype(de,0)]):p.current.tb=!1}var Ve=Re(Se),Le=fe[1]===de[1];if(Ve&&"l"===fe[1]&&(le>K.right||p.current.rl)){var $e=ve;Le?$e-=j-F:$e=we.x-Ee.x-ee;var Be=e($e,ge),ze=e($e,ge,W);Be>ye||Be===ye&&(!U||ze>=be)?(p.current.rl=!0,ve=$e,ee=-ee,me.points=[ype(fe,1),ype(de,1)]):p.current.rl=!1}if(Ve&&"r"===fe[1]&&(se<K.left||p.current.lr)){var Ue=ve;Le?Ue+=j-F:Ue=Ce.x-_e.x-ee;var He=e(Ue,ge),We=e(Ue,ge,W);He>ye||He===ye&&(!U||We>=be)?(p.current.lr=!0,ve=Ue,ee=-ee,me.points=[ype(fe,1),ype(de,1)]):p.current.lr=!1}at();var Ge=!0===Oe?0:Oe;"number"==typeof Ge&&(se<W.left&&(ve-=se-W.left-ee,c.x+F<W.left+Ge&&(ve+=c.x-W.left+F-Ge)),le>W.right&&(ve-=le-W.right-ee,c.x>W.right-Ge&&(ve+=c.x-W.right+Ge)));var Ke=!0===Ie?0:Ie;"number"==typeof Ke&&(oe<W.top&&(ge-=oe-W.top-te,c.y+D<W.top+Ke&&(ge+=c.y-W.top+D-Ke)),ae>W.bottom&&(ge-=ae-W.bottom-te,c.y>W.bottom-Ke&&(ge+=c.y-W.bottom+Ke)));var qe=k.x+ve,Ye=qe+j,Xe=k.y+ge,Ze=Xe+P,Je=c.x,Qe=Je+F,et=c.y,tt=et+D,rt=(Math.max(qe,Je)+Math.min(Ye,Qe))/2-qe,nt=(Math.max(Xe,et)+Math.min(Ze,tt))/2-Xe;null==s||s(t,me);var it=q.right-k.x-(ve+k.width),ot=q.bottom-k.y-(ge+k.height);u({ready:!0,offsetX:ve/Y,offsetY:ge/X,offsetR:it/Y,offsetB:ot/X,arrowX:rt/Y,arrowY:nt/X,scaleX:Y,scaleY:X,align:me})}})),m=function(){u((function(e){return hL(hL({},e),{},{ready:!1})}))};return vG(m,[n]),vG((function(){e||m()}),[e]),[c.ready,c.offsetX,c.offsetY,c.offsetR,c.offsetB,c.arrowX,c.arrowY,c.scaleX,c.scaleY,c.align,function(){d.current+=1;var e=d.current;Promise.resolve().then((function(){d.current===e&&h()}))}]}(Ce,ae,V?De:ue,A,M,P,$),$e=fL(Le,11),Be=$e[0],ze=$e[1],Ue=$e[2],He=$e[3],We=$e[4],Ge=$e[5],Ke=$e[6],qe=$e[7],Ye=$e[8],Xe=$e[9],Ze=$e[10],Je=function(e,t,r,n){return a.useMemo((function(){var i=ape(null!=r?r:t),o=ape(null!=n?n:t),a=new Set(i),s=new Set(o);return e&&(a.has("hover")&&(a.delete("hover"),a.add("click")),s.has("hover")&&(s.delete("hover"),s.add("click"))),[a,s]}),[e,t,r,n])}(Q,c,u,d),Qe=fL(Je,2),et=Qe[0],tt=Qe[1],rt=et.has("click"),nt=tt.has("click")||tt.has("contextMenu"),it=hG((function(){Te||Ze()}));(function(e,t,r,n,i){vG((function(){if(e&&t&&r){let e=function(){n(),i()};var o=r,a=upe(t),s=upe(o),l=cpe(o),c=new Set([l].concat(bL(a),bL(s)));return c.forEach((function(t){t.addEventListener("scroll",e,{passive:!0})})),l.addEventListener("resize",e,{passive:!0}),n(),function(){c.forEach((function(t){t.removeEventListener("scroll",e),l.removeEventListener("resize",e)}))}}}),[e,t,r])})(Ce,ue,ae,it,(function(){xe.current&&V&&nt&&Ie(!1)})),vG((function(){it()}),[De,A]),vG((function(){Ce&&(null==M||!M[A])&&it()}),[JSON.stringify(P)]);var ot=a.useMemo((function(){var e=function(e,t,r,n){for(var i=r.points,o=Object.keys(e),a=0;a<o.length;a+=1){var s,l=o[a];if(spe(null===(s=e[l])||void 0===s?void 0:s.points,i,n))return"".concat(t,"-placement-").concat(l)}return""}(M,i,Xe,V);return GA(e,null==F?void 0:F(Xe))}),[Xe,F,M,i,V]);a.useImperativeHandle(r,(function(){return{forceAlign:it}}));var at=fL(a.useState(0),2),st=at[0],lt=at[1],ct=fL(a.useState(0),2),ut=ct[0],dt=ct[1],ft=function(){if(D&&ue){var e=ue.getBoundingClientRect();lt(e.width),dt(e.height)}};function pt(e,t,r,n){me[e]=function(i){var o;null==n||n(i),Ie(t,r);for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];null===(o=he[e])||void 0===o||o.call.apply(o,[he,i].concat(s))}}vG((function(){Me&&(Ze(),Me(),Pe(null))}),[Me]),(rt||nt)&&(me.onClick=function(e){var t;xe.current&&nt?Ie(!1):!xe.current&&rt&&(Ve(e),Ie(!0));for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];null===(t=he.onClick)||void 0===t||t.call.apply(t,[he,e].concat(n))}),function(e,t,r,n,i,o,s,l){var c=a.useRef(e),u=a.useRef(!1);c.current!==e&&(u.current=!0,c.current=e),a.useEffect((function(){var e=ez((function(){u.current=!1}));return function(){ez.cancel(e)}}),[e]),a.useEffect((function(){if(t&&n&&(!i||o)){var e=function(){var e=!1;return[function(t){var r=t.target;e=s(r)},function(t){var r=t.target;!u.current&&c.current&&!e&&!s(r)&&l(!1)}]},a=fL(e(),2),d=a[0],f=a[1],p=fL(e(),2),h=p[0],m=p[1],v=cpe(n);v.addEventListener("mousedown",d,!0),v.addEventListener("click",f,!0),v.addEventListener("contextmenu",f,!0);var g,y,b=rpe(r);return b&&(b.addEventListener("mousedown",h,!0),b.addEventListener("click",m,!0),b.addEventListener("contextmenu",m,!0)),"production"!==Ti.exports.env.NODE_ENV&&jL((null==r||null===(g=r.getRootNode)||void 0===g?void 0:g.call(r))===(null===(y=n.getRootNode)||void 0===y?void 0:y.call(n)),"trigger element and popup element should in same shadow root."),function(){v.removeEventListener("mousedown",d,!0),v.removeEventListener("click",f,!0),v.removeEventListener("contextmenu",f,!0),b&&(b.removeEventListener("mousedown",h,!0),b.removeEventListener("click",m,!0),b.removeEventListener("contextmenu",m,!0))}}}),[t,r,n,i,o])}(Ce,nt,ue,ae,_,E,ve,Ie);var ht,mt,vt=et.has("hover"),gt=tt.has("hover");vt&&(pt("onMouseEnter",!0,v,(function(e){Ve(e)})),pt("onPointerEnter",!0,v,(function(e){Ve(e)})),ht=function(){(Ce||Te)&&Ie(!0,v)},V&&(me.onMouseMove=function(e){var t;null===(t=he.onMouseMove)||void 0===t||t.call(he,e)})),gt&&(pt("onMouseLeave",!1,y),pt("onPointerLeave",!1,y),mt=function(){Ie(!1,y)}),et.has("focus")&&pt("onFocus",!0,b),tt.has("focus")&&pt("onBlur",!1,w),et.has("contextMenu")&&(me.onContextMenu=function(e){var t;xe.current&&tt.has("contextMenu")?Ie(!1):(Ve(e),Ie(!0)),e.preventDefault();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];null===(t=he.onContextMenu)||void 0===t||t.call.apply(t,[he,e].concat(n))}),q&&(me.className=GA(he.className,q));var yt=hL(hL({},he),me),bt={};["onContextMenu","onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"].forEach((function(e){X[e]&&(bt[e]=function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];null===(t=yt[e])||void 0===t||t.call.apply(t,[yt].concat(n)),X[e].apply(X,n)})}));var wt=a.cloneElement(pe,hL(hL({},yt),bt)),_t={x:Ge,y:Ke},Ct=B?hL({},!0!==B?B:{}):null;return a.createElement(a.Fragment,null,a.createElement(Rfe,{disabled:!Ce,ref:fe,onResize:function(){ft(),it()}},a.createElement(Epe,{getTriggerDOMNode:Y},wt)),a.createElement(ope.Provider,{value:ne},a.createElement(Cpe,{portal:e,ref:le,prefixCls:i,popup:I,className:GA(R,ot),style:T,target:ue,onMouseEnter:ht,onMouseLeave:mt,onPointerEnter:ht,zIndex:j,open:Ce,keepDom:Te,onClick:L,mask:_,motion:ge,maskMotion:ye,onVisibleChanged:function(e){Ae(!1),Ze(),null==m||m(e)},onPrepare:function(){return new Promise((function(e){ft(),Pe((function(){return e}))}))},forceRender:S,autoDestroy:Z,getPopupContainer:x,align:Xe,arrow:Ct,arrowPos:_t,ready:Be,offsetX:ze,offsetY:Ue,offsetR:He,offsetB:We,onAlign:it,stretch:D,targetWidth:st/qe,targetHeight:ut/Ye})))}));return"production"!==Ti.exports.env.NODE_ENV&&(t.displayName="Trigger"),t}(epe);var kpe=wG.ESC,Ope=wG.TAB;var Ipe=Object(a.forwardRef)((function(e,t){var r=e.overlay,n=e.arrow,i=e.prefixCls,o=Object(a.useMemo)((function(){return"function"==typeof r?r():r}),[r]),l=yB(t,null==o?void 0:o.ref);return s.a.createElement(s.a.Fragment,null,n&&s.a.createElement("div",{className:"".concat(i,"-arrow")}),s.a.cloneElement(o,{ref:wB(o)?l:void 0}))})),Rpe={adjustX:1,adjustY:1},Tpe=[0,0],Ape={topLeft:{points:["bl","tl"],overflow:Rpe,offset:[0,-4],targetOffset:Tpe},top:{points:["bc","tc"],overflow:Rpe,offset:[0,-4],targetOffset:Tpe},topRight:{points:["br","tr"],overflow:Rpe,offset:[0,-4],targetOffset:Tpe},bottomLeft:{points:["tl","bl"],overflow:Rpe,offset:[0,4],targetOffset:Tpe},bottom:{points:["tc","bc"],overflow:Rpe,offset:[0,4],targetOffset:Tpe},bottomRight:{points:["tr","br"],overflow:Rpe,offset:[0,4],targetOffset:Tpe}},Npe=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus","overlay","children","onVisibleChange"];function Mpe(e,t){var r,n=e.arrow,i=void 0!==n&&n,o=e.prefixCls,l=void 0===o?"rc-dropdown":o,c=e.transitionName,u=e.animation,d=e.align,f=e.placement,p=void 0===f?"bottomLeft":f,h=e.placements,m=void 0===h?Ape:h,v=e.getPopupContainer,g=e.showAction,y=e.hideAction,b=e.overlayClassName,w=e.overlayStyle,_=e.visible,C=e.trigger,E=void 0===C?["hover"]:C,x=e.autoFocus,S=e.overlay,k=e.children,O=e.onVisibleChange,I=gL(e,Npe),R=fL(s.a.useState(),2),T=R[0],A=R[1],N="visible"in e?_:T,M=s.a.useRef(null),P=s.a.useRef(null),j=s.a.useRef(null);s.a.useImperativeHandle(t,(function(){return M.current}));var D=function(e){A(e),null==O||O(e)};!function(e){var t=e.visible,r=e.triggerRef,n=e.onVisibleChange,i=e.autoFocus,o=e.overlayRef,s=a.useRef(!1),l=function(){var e,i;t&&(null===(e=r.current)||void 0===e||null===(i=e.focus)||void 0===i||i.call(e),null==n||n(!1))},c=function(){var e;return!(null===(e=o.current)||void 0===e||!e.focus||(o.current.focus(),s.current=!0,0))},u=function(e){switch(e.keyCode){case kpe:l();break;case Ope:var t=!1;s.current||(t=c()),t?e.preventDefault():l()}};a.useEffect((function(){return t?(window.addEventListener("keydown",u),i&&ez(c,3),function(){window.removeEventListener("keydown",u),s.current=!1}):function(){s.current=!1}}),[t])}({visible:N,triggerRef:j,onVisibleChange:D,autoFocus:x,overlayRef:P});var F,V=function(){return s.a.createElement(Ipe,{ref:P,overlay:S,prefixCls:l,arrow:i})},L=s.a.cloneElement(k,{className:GA(null===(r=k.props)||void 0===r?void 0:r.className,N&&(F=e.openClassName,void 0!==F?F:"".concat(l,"-open"))),ref:wB(k)?yB(j,k.ref):void 0}),$=y;return!$&&-1!==E.indexOf("contextMenu")&&($=["click"]),s.a.createElement(Spe,iL({builtinPlacements:m},I,{prefixCls:l,ref:M,popupClassName:GA(b,sL({},"".concat(l,"-show-arrow"),i)),popupStyle:w,action:E,showAction:g,hideAction:$,popupPlacement:p,popupAlign:d,popupTransitionName:c,popupAnimation:u,popupVisible:N,stretch:function(){var t=e.minOverlayWidthMatchTrigger,r=e.alignPoint;return"minOverlayWidthMatchTrigger"in e?t:!r}()?"minWidth":"",popup:"function"==typeof S?V:V(),onPopupVisibleChange:D,onPopupClick:function(t){var r=e.onOverlayClick;A(!1),r&&r(t)},getPopupContainer:v}),L)}const Ppe=s.a.forwardRef(Mpe);var jpe=["prefixCls","invalidate","item","renderItem","responsive","responsiveDisabled","registerSize","itemKey","className","style","children","display","order","component"],Dpe=void 0;function Fpe(e,t){var r=e.prefixCls,n=e.invalidate,i=e.item,o=e.renderItem,s=e.responsive,l=e.responsiveDisabled,c=e.registerSize,u=e.itemKey,d=e.className,f=e.style,p=e.children,h=e.display,m=e.order,v=e.component,g=void 0===v?"div":v,y=gL(e,jpe),b=s&&!h;function w(e){c(u,e)}a.useEffect((function(){return function(){w(null)}}),[]);var _,C=o&&i!==Dpe?o(i):p;n||(_={opacity:b?0:1,height:b?0:Dpe,overflowY:b?"hidden":Dpe,order:s?m:Dpe,pointerEvents:b?"none":Dpe,position:b?"absolute":Dpe});var E={};b&&(E["aria-hidden"]=!0);var x=a.createElement(g,iL({className:GA(!n&&r,d),style:hL(hL({},_),f)},E,y,{ref:t}),C);return s&&(x=a.createElement(Rfe,{onResize:function(e){w(e.offsetWidth)},disabled:l},x)),x}var Vpe=a.forwardRef(Fpe);function Lpe(){var e=a.useRef(null);return function(t){e.current||(e.current=[],function(e){if(typeof MessageChannel>"u")ez(e);else{var t=new MessageChannel;t.port1.onmessage=function(){return e()},t.port2.postMessage(void 0)}}((function(){Object(l.unstable_batchedUpdates)((function(){e.current.forEach((function(e){e()})),e.current=null}))}))),e.current.push(t)}}function $pe(e,t){var r=fL(a.useState(t),2),n=r[0],i=r[1];return[n,hG((function(t){e((function(){i(t)}))}))]}Vpe.displayName="Item";var Bpe=s.a.createContext(null),zpe=["component"],Upe=["className"],Hpe=["className"],Wpe=function(e,t){var r=a.useContext(Bpe);if(!r){var n=e.component,i=void 0===n?"div":n,o=gL(e,zpe);return a.createElement(i,iL({},o,{ref:t}))}var s=r.className,l=gL(r,Upe),c=e.className,u=gL(e,Hpe);return a.createElement(Bpe.Provider,{value:null},a.createElement(Vpe,iL({ref:t,className:GA(s,c)},l,u)))},Gpe=a.forwardRef(Wpe);Gpe.displayName="RawItem";var Kpe=["prefixCls","data","renderItem","renderRawItem","itemKey","itemWidth","ssr","style","className","maxCount","renderRest","renderRawRest","suffix","component","itemComponent","onVisibleChange"],qpe="responsive",Ype="invalidate";function Xpe(e){return"+ ".concat(e.length," ...")}function Zpe(e,t){var r=e.prefixCls,n=void 0===r?"rc-overflow":r,i=e.data,o=void 0===i?[]:i,s=e.renderItem,l=e.renderRawItem,c=e.itemKey,u=e.itemWidth,d=void 0===u?10:u,f=e.ssr,p=e.style,h=e.className,m=e.maxCount,v=e.renderRest,g=e.renderRawRest,y=e.suffix,b=e.component,w=void 0===b?"div":b,_=e.itemComponent,C=e.onVisibleChange,E=gL(e,Kpe),x="full"===f,S=Lpe(),k=fL($pe(S,null),2),O=k[0],I=k[1],R=O||0,T=fL($pe(S,new Map),2),A=T[0],N=T[1],M=fL($pe(S,0),2),P=M[0],j=M[1],D=fL($pe(S,0),2),F=D[0],V=D[1],L=fL($pe(S,0),2),$=L[0],B=L[1],z=fL(Object(a.useState)(null),2),U=z[0],H=z[1],W=fL(Object(a.useState)(null),2),G=W[0],K=W[1],q=a.useMemo((function(){return null===G&&x?Number.MAX_SAFE_INTEGER:G||0}),[G,O]),Y=fL(Object(a.useState)(!1),2),X=Y[0],Z=Y[1],J="".concat(n,"-item"),Q=Math.max(P,F),ee=m===qpe,te=o.length&&ee,re=m===Ype,ne=te||"number"==typeof m&&o.length>m,ie=Object(a.useMemo)((function(){var e=o;return te?e=null===O&&x?o:o.slice(0,Math.min(o.length,R/d)):"number"==typeof m&&(e=o.slice(0,m)),e}),[o,d,O,m,te]),oe=Object(a.useMemo)((function(){return te?o.slice(q+1):o.slice(ie.length)}),[o,ie,te,q]),ae=Object(a.useCallback)((function(e,t){var r;return"function"==typeof c?c(e):null!==(r=c&&(null==e?void 0:e[c]))&&void 0!==r?r:t}),[c]),se=Object(a.useCallback)(s||function(e){return e},[s]);function le(e,t,r){G===e&&(void 0===t||t===U)||(K(e),r||(Z(e<o.length-1),null==C||C(e)),void 0!==t&&H(t))}function ce(e,t){N((function(r){var n=new Map(r);return null===t?n.delete(e):n.set(e,t),n}))}function ue(e){return A.get(ae(ie[e],e))}vG((function(){if(R&&"number"==typeof Q&&ie){var e=$,t=ie.length,r=t-1;if(!t)return void le(0,null);for(var n=0;n<t;n+=1){var i=ue(n);if(x&&(i=i||0),void 0===i){le(n-1,void 0,!0);break}if(e+=i,0===r&&e<=R||n===r-1&&e+ue(r)<=R){le(r,null);break}if(e+Q>R){le(n-1,e-i-$+F);break}}y&&ue(0)+$>R&&H(null)}}),[R,A,F,$,ae,ie]);var de=X&&!!oe.length,fe={};null!==U&&te&&(fe={position:"absolute",left:U,top:0});var pe,he={prefixCls:J,responsive:te,component:_,invalidate:re},me=l?function(e,t){var r=ae(e,t);return a.createElement(Bpe.Provider,{key:r,value:hL(hL({},he),{},{order:t,item:e,itemKey:r,registerSize:ce,display:t<=q})},l(e,t))}:function(e,t){var r=ae(e,t);return a.createElement(Vpe,iL({},he,{order:t,key:r,item:e,renderItem:se,itemKey:r,registerSize:ce,display:t<=q}))},ve={order:de?q:Number.MAX_SAFE_INTEGER,className:"".concat(J,"-rest"),registerSize:function(e,t){V(t),j(F)},display:de};if(g)g&&(pe=a.createElement(Bpe.Provider,{value:hL(hL({},he),ve)},g(oe)));else{var ge=v||Xpe;pe=a.createElement(Vpe,iL({},he,ve),"function"==typeof ge?ge(oe):ge)}var ye=a.createElement(w,iL({className:GA(!re&&n,h),style:p,ref:t},E),ie.map(me),ne?pe:null,y&&a.createElement(Vpe,iL({},he,{responsive:ee,responsiveDisabled:!te,order:q,className:"".concat(J,"-suffix"),registerSize:function(e,t){B(t)},display:!0,style:fe}),y));return ee&&(ye=a.createElement(Rfe,{onResize:function(e,t){I(t.clientWidth)},disabled:!te},ye)),ye}var Jpe=a.forwardRef(Zpe);Jpe.displayName="Overflow",Jpe.Item=Gpe,Jpe.RESPONSIVE=qpe,Jpe.INVALIDATE=Ype;var Qpe=a.createContext(null);function ehe(e,t){return void 0===e?null:"".concat(e,"-").concat(t)}function the(e){return ehe(a.useContext(Qpe),e)}var rhe=["children","locked"],nhe=a.createContext(null);function ihe(e){var t=e.children,r=e.locked,n=gL(e,rhe),i=a.useContext(nhe),o=X$((function(){return function(e,t){var r=hL({},e);return Object.keys(t).forEach((function(e){var n=t[e];void 0!==n&&(r[e]=n)})),r}(i,n)}),[i,n],(function(e,t){return!(r||e[0]===t[0]&&rY(e[1],t[1],!0))}));return a.createElement(nhe.Provider,{value:o},t)}var ohe=[],ahe=a.createContext(null);function she(){return a.useContext(ahe)}var lhe=a.createContext(ohe);function che(e){var t=a.useContext(lhe);return a.useMemo((function(){return void 0!==e?[].concat(bL(t),[e]):t}),[t,e])}var uhe=a.createContext(null),dhe=a.createContext({});function fhe(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(NG(e)){var r=e.nodeName.toLowerCase(),n=["input","select","textarea","button"].includes(r)||e.isContentEditable||"a"===r&&!!e.getAttribute("href"),i=e.getAttribute("tabindex"),o=Number(i),a=null;return i&&!Number.isNaN(o)?a=o:n&&null===a&&(a=0),n&&e.disabled&&(a=null),null!==a&&(a>=0||t&&a<0)}return!1}var phe=wG.LEFT,hhe=wG.RIGHT,mhe=wG.UP,vhe=wG.DOWN,ghe=wG.ENTER,yhe=wG.ESC,bhe=wG.HOME,whe=wG.END,_he=[mhe,vhe,phe,hhe];function Che(e,t){var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=bL(e.querySelectorAll("*")).filter((function(e){return fhe(e,t)}));return fhe(e,t)&&r.unshift(e),r}(e,!0);return r.filter((function(e){return t.has(e)}))}function Ehe(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!e)return null;var i=Che(e,t),o=i.length,a=i.findIndex((function(e){return r===e}));return n<0?-1===a?a=o-1:a-=1:n>0&&(a+=1),i[a=(a+o)%o]}function xhe(e,t,r,n,i,o,s,l,c,u){var d=a.useRef(),f=a.useRef();f.current=t;var p=function(){ez.cancel(d.current)};return a.useEffect((function(){return function(){p()}}),[]),function(a){var h=a.which;if([].concat(_he,[ghe,yhe,bhe,whe]).includes(h)){var m,v,g,y=function(){return m=new Set,v=new Map,g=new Map,o().forEach((function(e){var t=document.querySelector("[data-menu-id='".concat(ehe(n,e),"']"));t&&(m.add(t),g.set(t,e),v.set(e,t))})),m};y();var b=function(e,t){for(var r=e||document.activeElement;r;){if(t.has(r))return r;r=r.parentElement}return null}(v.get(t),m),w=g.get(b),_=function(e,t,r,n){var i,o,a,s,l="prev",c="next",u="children",d="parent";if("inline"===e&&n===ghe)return{inlineTrigger:!0};var f=(sL(i={},mhe,l),sL(i,vhe,c),i),p=(sL(o={},phe,r?c:l),sL(o,hhe,r?l:c),sL(o,vhe,u),sL(o,ghe,u),o),h=(sL(a={},mhe,l),sL(a,vhe,c),sL(a,ghe,u),sL(a,yhe,d),sL(a,phe,r?u:d),sL(a,hhe,r?d:u),a);switch(null===(s={inline:f,horizontal:p,vertical:h,inlineSub:f,horizontalSub:h,verticalSub:h}["".concat(e).concat(t?"":"Sub")])||void 0===s?void 0:s[n]){case l:return{offset:-1,sibling:!0};case c:return{offset:1,sibling:!0};case d:return{offset:-1,sibling:!1};case u:return{offset:1,sibling:!1};default:return null}}(e,1===s(w,!0).length,r,h);if(!_&&h!==bhe&&h!==whe)return;(_he.includes(h)||[bhe,whe].includes(h))&&a.preventDefault();var C=function(e){if(e){var t=e,r=e.querySelector("a");null!=r&&r.getAttribute("href")&&(t=r);var n=g.get(e);l(n),p(),d.current=ez((function(){f.current===n&&t.focus()}))}};if([bhe,whe].includes(h)||_.sibling||!b){var E;E=b&&"inline"!==e?function(e){for(var t=e;t;){if(t.getAttribute("data-menu-list"))return t;t=t.parentElement}return null}(b):i.current;var x,S=Che(E,m);x=h===bhe?S[0]:h===whe?S[S.length-1]:Ehe(E,m,b,_.offset),C(x)}else if(_.inlineTrigger)c(w);else if(_.offset>0)c(w,!0),p(),d.current=ez((function(){y();var e=b.getAttribute("aria-controls"),t=Ehe(document.getElementById(e),m);C(t)}),5);else if(_.offset<0){var k=s(w,!0),O=k[k.length-2],I=v.get(O);c(O,!1),C(I)}}null==u||u(a)}}var She="__RC_UTIL_PATH_SPLIT__",khe=function(e){return e.join(She)},Ohe="rc-menu-more";function Ihe(){var e=fL(a.useState({}),2)[1],t=Object(a.useRef)(new Map),r=Object(a.useRef)(new Map),n=fL(a.useState([]),2),i=n[0],o=n[1],s=Object(a.useRef)(0),l=Object(a.useRef)(!1),c=Object(a.useCallback)((function(n,i){"production"!==Ti.exports.env.NODE_ENV&&jL(!t.current.has(n),"Duplicated key '".concat(n,"' used in Menu by path [").concat(i.join(" > "),"]"));var o=khe(i);r.current.set(o,n),t.current.set(n,o),s.current+=1;var a=s.current;!function(e){Promise.resolve().then(e)}((function(){a===s.current&&(l.current||e({}))}))}),[]),u=Object(a.useCallback)((function(e,n){var i=khe(n);r.current.delete(i),t.current.delete(e)}),[]),d=Object(a.useCallback)((function(e){o(e)}),[]),f=Object(a.useCallback)((function(e,r){var n=function(e){return e.split(She)}(t.current.get(e)||"");return r&&i.includes(n[0])&&n.unshift(Ohe),n}),[i]),p=Object(a.useCallback)((function(e,t){return e.some((function(e){return f(e,!0).includes(t)}))}),[f]),h=Object(a.useCallback)((function(e){var n="".concat(t.current.get(e)).concat(She),i=new Set;return bL(r.current.keys()).forEach((function(e){e.startsWith(n)&&i.add(r.current.get(e))})),i}),[]);return a.useEffect((function(){return function(){l.current=!0}}),[]),{registerPath:c,unregisterPath:u,refreshOverflowKeys:d,isSubPathKey:p,getKeyPath:f,getKeys:function(){var e=bL(t.current.keys());return i.length&&e.push(Ohe),e},getSubPathKeys:h}}function Rhe(e){var t=a.useRef(e);t.current=e;var r=a.useCallback((function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return null===(e=t.current)||void 0===e?void 0:e.call.apply(e,[t].concat(n))}),[]);return e?r:void 0}var The=Math.random().toFixed(5).toString().slice(2),Ahe=0;function Nhe(e,t,r,n){var i=a.useContext(nhe),o=i.activeKey,s=i.onActive,l=i.onInactive,c={active:o===e};return t||(c.onMouseEnter=function(t){null==r||r({key:e,domEvent:t}),s(e)},c.onMouseLeave=function(t){null==n||n({key:e,domEvent:t}),l(e)}),c}function Mhe(e){var t=a.useContext(nhe),r=t.mode,n=t.rtl,i=t.inlineIndent;if("inline"!==r)return null;return n?{paddingRight:e*i}:{paddingLeft:e*i}}function Phe(e){var t,r=e.icon,n=e.props,i=e.children;return null===r||!1===r?null:("function"==typeof r?t=a.createElement(r,hL({},n)):"boolean"!=typeof r&&(t=r),t||i||null)}var jhe=["item"];function Dhe(e){var t=e.item,r=gL(e,jhe);return Object.defineProperty(r,"item",{get:function(){return jL(!1,"`info.item` is deprecated since we will move to function component that not provides React Node instance in future."),t}}),r}var Fhe=["title","attribute","elementRef"],Vhe=["style","className","eventKey","warnKey","disabled","itemIcon","children","role","onMouseEnter","onMouseLeave","onClick","onKeyDown","onFocus"],Lhe=["active"],$he=function(e){SL(r,e);var t=OL(r);function r(){return wL(this,r),t.apply(this,arguments)}return CL(r,[{key:"render",value:function(){var e=this.props,t=e.title,r=e.attribute,n=e.elementRef,i=mL(gL(e,Fhe),["eventKey","popupClassName","popupOffset","onTitleClick"]);return jL(!r,"`attribute` of Menu.Item is deprecated. Please pass attribute directly."),a.createElement(Jpe.Item,iL({},r,{title:"string"==typeof t?t:void 0},i,{ref:n}))}}]),r}(a.Component),Bhe=a.forwardRef((function(e,t){var r,n=e.style,i=e.className,o=e.eventKey,s=e.warnKey,l=e.disabled,c=e.itemIcon,u=e.children,d=e.role,f=e.onMouseEnter,p=e.onMouseLeave,h=e.onClick,m=e.onKeyDown,v=e.onFocus,g=gL(e,Vhe),y=the(o),b=a.useContext(nhe),w=b.prefixCls,_=b.onItemClick,C=b.disabled,E=b.overflowDisabled,x=b.itemIcon,S=b.selectedKeys,k=b.onActive,O=a.useContext(dhe)._internalRenderMenuItem,I="".concat(w,"-item"),R=a.useRef(),T=a.useRef(),A=C||l,N=bB(t,T),M=che(o);"production"!==Ti.exports.env.NODE_ENV&&s&&jL(!1,"MenuItem should not leave undefined `key`.");var P=function(e){return{key:o,keyPath:bL(M).reverse(),item:R.current,domEvent:e}},j=c||x,D=Nhe(o,A,f,p),F=D.active,V=gL(D,Lhe),L=S.includes(o),$=Mhe(M.length),B={};"option"===e.role&&(B["aria-selected"]=L);var z=a.createElement($he,iL({ref:R,elementRef:N,role:null===d?"none":d||"menuitem",tabIndex:l?null:-1,"data-menu-id":E&&y?null:y},g,V,B,{component:"li","aria-disabled":l,style:hL(hL({},$),n),className:GA(I,(r={},sL(r,"".concat(I,"-active"),F),sL(r,"".concat(I,"-selected"),L),sL(r,"".concat(I,"-disabled"),A),r),i),onClick:function(e){if(!A){var t=P(e);null==h||h(Dhe(t)),_(t)}},onKeyDown:function(e){if(null==m||m(e),e.which===wG.ENTER){var t=P(e);null==h||h(Dhe(t)),_(t)}},onFocus:function(e){k(o),null==v||v(e)}}),u,a.createElement(Phe,{props:hL(hL({},e),{},{isSelected:L}),icon:j}));return O&&(z=O(z,e,{selected:L})),z}));function zhe(e,t){var r=e.eventKey,n=she(),i=che(r);return a.useEffect((function(){if(n)return n.registerPath(r,i),function(){n.unregisterPath(r,i)}}),[i]),n?null:a.createElement(Bhe,iL({},e,{ref:t}))}const Uhe=a.forwardRef(zhe);var Hhe=["className","children"],Whe=function(e,t){var r=e.className,n=e.children,i=gL(e,Hhe),o=a.useContext(nhe),s=o.prefixCls,l=o.mode,c=o.rtl;return a.createElement("ul",iL({className:GA(s,c&&"".concat(s,"-rtl"),"".concat(s,"-sub"),"".concat(s,"-").concat("inline"===l?"inline":"vertical"),r),role:"menu"},i,{"data-menu-list":!0,ref:t}),n)},Ghe=a.forwardRef(Whe);function Khe(e,t){return RL(e).map((function(e,r){if(a.isValidElement(e)){var n,i,o=e.key,s=null!==(n=null===(i=e.props)||void 0===i?void 0:i.eventKey)&&void 0!==n?n:o,l=null==s;l&&(s="tmp_key-".concat([].concat(bL(t),[r]).join("-")));var c={key:s,eventKey:s};return"production"!==Ti.exports.env.NODE_ENV&&l&&(c.warnKey=!0),a.cloneElement(e,c)}return e}))}Ghe.displayName="SubMenuList";var qhe={adjustX:1,adjustY:1},Yhe={topLeft:{points:["bl","tl"],overflow:qhe},topRight:{points:["br","tr"],overflow:qhe},bottomLeft:{points:["tl","bl"],overflow:qhe},bottomRight:{points:["tr","br"],overflow:qhe},leftTop:{points:["tr","tl"],overflow:qhe},leftBottom:{points:["br","bl"],overflow:qhe},rightTop:{points:["tl","tr"],overflow:qhe},rightBottom:{points:["bl","br"],overflow:qhe}},Xhe={topLeft:{points:["bl","tl"],overflow:qhe},topRight:{points:["br","tr"],overflow:qhe},bottomLeft:{points:["tl","bl"],overflow:qhe},bottomRight:{points:["tr","br"],overflow:qhe},rightTop:{points:["tr","tl"],overflow:qhe},rightBottom:{points:["br","bl"],overflow:qhe},leftTop:{points:["tl","tr"],overflow:qhe},leftBottom:{points:["bl","br"],overflow:qhe}};function Zhe(e,t,r){return t||(r?r[e]||r.other:void 0)}var Jhe={horizontal:"bottomLeft",vertical:"rightTop","vertical-left":"rightTop","vertical-right":"leftTop"};function Qhe(e){var t=e.prefixCls,r=e.visible,n=e.children,i=e.popup,o=e.popupStyle,s=e.popupClassName,l=e.popupOffset,c=e.disabled,u=e.mode,d=e.onVisibleChange,f=a.useContext(nhe),p=f.getPopupContainer,h=f.rtl,m=f.subMenuOpenDelay,v=f.subMenuCloseDelay,g=f.builtinPlacements,y=f.triggerSubMenuAction,b=f.forceSubMenuRender,w=f.rootClassName,_=f.motion,C=f.defaultMotions,E=fL(a.useState(!1),2),x=E[0],S=E[1],k=hL(hL({},h?Xhe:Yhe),g),O=Jhe[u],I=Zhe(u,_,C),R=a.useRef(I);"inline"!==u&&(R.current=I);var T=hL(hL({},R.current),{},{leavedClassName:"".concat(t,"-hidden"),removeOnLeave:!1,motionAppear:!0}),A=a.useRef();return a.useEffect((function(){return A.current=ez((function(){S(r)})),function(){ez.cancel(A.current)}}),[r]),a.createElement(Spe,{prefixCls:t,popupClassName:GA("".concat(t,"-popup"),sL({},"".concat(t,"-rtl"),h),s,w),stretch:"horizontal"===u?"minWidth":null,getPopupContainer:p,builtinPlacements:k,popupPlacement:O,popupVisible:x,popup:i,popupStyle:o,popupAlign:l&&{offset:l},action:c?[]:[y],mouseEnterDelay:m,mouseLeaveDelay:v,onPopupVisibleChange:d,forceRender:b,popupMotion:T},n)}function eme(e){var t=e.id,r=e.open,n=e.keyPath,i=e.children,o="inline",s=a.useContext(nhe),l=s.prefixCls,c=s.forceSubMenuRender,u=s.motion,d=s.defaultMotions,f=s.mode,p=a.useRef(!1);p.current=f===o;var h=fL(a.useState(!p.current),2),m=h[0],v=h[1],g=!!p.current&&r;a.useEffect((function(){p.current&&v(!1)}),[f]);var y=hL({},Zhe(o,u,d));n.length>1&&(y.motionAppear=!1);var b=y.onVisibleChanged;return y.onVisibleChanged=function(e){return!p.current&&!e&&v(!0),null==b?void 0:b(e)},m?null:a.createElement(ihe,{mode:o,locked:!p.current},a.createElement(sz,iL({visible:g},y,{forceRender:c,removeOnLeave:!1,leavedClassName:"".concat(l,"-hidden")}),(function(e){var r=e.className,n=e.style;return a.createElement(Ghe,{id:t,className:r,style:n},i)})))}var tme=["style","className","title","eventKey","warnKey","disabled","internalPopupClose","children","itemIcon","expandIcon","popupClassName","popupOffset","popupStyle","onClick","onMouseEnter","onMouseLeave","onTitleClick","onTitleMouseEnter","onTitleMouseLeave"],rme=["active"],nme=function(e){var t,r=e.style,n=e.className,i=e.title,o=e.eventKey,s=e.warnKey,l=e.disabled,c=e.internalPopupClose,u=e.children,d=e.itemIcon,f=e.expandIcon,p=e.popupClassName,h=e.popupOffset,m=e.popupStyle,v=e.onClick,g=e.onMouseEnter,y=e.onMouseLeave,b=e.onTitleClick,w=e.onTitleMouseEnter,_=e.onTitleMouseLeave,C=gL(e,tme),E=the(o),x=a.useContext(nhe),S=x.prefixCls,k=x.mode,O=x.openKeys,I=x.disabled,R=x.overflowDisabled,T=x.activeKey,A=x.selectedKeys,N=x.itemIcon,M=x.expandIcon,P=x.onItemClick,j=x.onOpenChange,D=x.onActive,F=a.useContext(dhe)._internalRenderSubMenuItem,V=a.useContext(uhe).isSubPathKey,L=che(),$="".concat(S,"-submenu"),B=I||l,z=a.useRef(),U=a.useRef();"production"!==Ti.exports.env.NODE_ENV&&s&&jL(!1,"SubMenu should not leave undefined `key`.");var H=null!=d?d:N,W=null!=f?f:M,G=O.includes(o),K=!R&&G,q=V(A,o),Y=Nhe(o,B,w,_),X=Y.active,Z=gL(Y,rme),J=fL(a.useState(!1),2),Q=J[0],ee=J[1],te=function(e){B||ee(e)},re=a.useMemo((function(){return X||"inline"!==k&&(Q||V([T],o))}),[k,X,T,Q,o,V]),ne=Mhe(L.length),ie=Rhe((function(e){null==v||v(Dhe(e)),P(e)})),oe=E&&"".concat(E,"-popup"),ae=a.createElement("div",iL({role:"menuitem",style:ne,className:"".concat($,"-title"),tabIndex:B?null:-1,ref:z,title:"string"==typeof i?i:null,"data-menu-id":R&&E?null:E,"aria-expanded":K,"aria-haspopup":!0,"aria-controls":oe,"aria-disabled":B,onClick:function(e){B||(null==b||b({key:o,domEvent:e}),"inline"===k&&j(o,!G))},onFocus:function(){D(o)}},Z),i,a.createElement(Phe,{icon:"horizontal"!==k?W:void 0,props:hL(hL({},e),{},{isOpen:K,isSubMenu:!0})},a.createElement("i",{className:"".concat($,"-arrow")}))),se=a.useRef(k);if("inline"!==k&&L.length>1?se.current="vertical":se.current=k,!R){var le=se.current;ae=a.createElement(Qhe,{mode:le,prefixCls:$,visible:!c&&K&&"inline"!==k,popupClassName:p,popupOffset:h,popupStyle:m,popup:a.createElement(ihe,{mode:"horizontal"===le?"vertical":le},a.createElement(Ghe,{id:oe,ref:U},u)),disabled:B,onVisibleChange:function(e){"inline"!==k&&j(o,e)}},ae)}var ce=a.createElement(Jpe.Item,iL({role:"none"},C,{component:"li",style:r,className:GA($,"".concat($,"-").concat(k),n,(t={},sL(t,"".concat($,"-open"),K),sL(t,"".concat($,"-active"),re),sL(t,"".concat($,"-selected"),q),sL(t,"".concat($,"-disabled"),B),t)),onMouseEnter:function(e){te(!0),null==g||g({key:o,domEvent:e})},onMouseLeave:function(e){te(!1),null==y||y({key:o,domEvent:e})}}),ae,!R&&a.createElement(eme,{id:oe,open:K,keyPath:L},u));return F&&(ce=F(ce,e,{selected:q,active:re,open:K,disabled:B})),a.createElement(ihe,{onItemClick:ie,mode:"horizontal"===k?"vertical":k,itemIcon:H,expandIcon:W},ce)};function ime(e){var t,r=e.eventKey,n=e.children,i=che(r),o=Khe(n,i),s=she();return a.useEffect((function(){if(s)return s.registerPath(r,i),function(){s.unregisterPath(r,i)}}),[i]),t=s?o:a.createElement(nme,e,o),a.createElement(lhe.Provider,{value:i},t)}var ome=["className","title","eventKey","children"],ame=["children"],sme=function(e){var t=e.className,r=e.title;e.eventKey;var n=e.children,i=gL(e,ome),o=a.useContext(nhe).prefixCls,s="".concat(o,"-item-group");return a.createElement("li",iL({role:"presentation"},i,{onClick:function(e){return e.stopPropagation()},className:GA(s,t)}),a.createElement("div",{role:"presentation",className:"".concat(s,"-title"),title:"string"==typeof r?r:void 0},r),a.createElement("ul",{role:"group",className:"".concat(s,"-list")},n))};function lme(e){var t=e.children,r=gL(e,ame),n=Khe(t,che(r.eventKey));return she()?n:a.createElement(sme,mL(r,["warnKey"]),n)}function cme(e){var t=e.className,r=e.style,n=a.useContext(nhe).prefixCls;return she()?null:a.createElement("li",{role:"separator",className:GA("".concat(n,"-item-divider"),t),style:r})}var ume=["label","children","key","type"];function dme(e){return(e||[]).map((function(e,t){if(e&&"object"===oL(e)){var r=e,n=r.label,i=r.children,o=r.key,s=r.type,l=gL(r,ume),c=null!=o?o:"tmp-".concat(t);return i||"group"===s?"group"===s?a.createElement(lme,iL({key:c},l,{title:n}),dme(i)):a.createElement(ime,iL({key:c},l,{title:n}),dme(i)):"divider"===s?a.createElement(cme,iL({key:c},l)):a.createElement(Uhe,iL({key:c},l),n)}return null})).filter((function(e){return e}))}function fme(e,t,r){var n=e;return t&&(n=dme(t)),Khe(n,r)}var pme=["prefixCls","rootClassName","style","className","tabIndex","items","children","direction","id","mode","inlineCollapsed","disabled","disabledOverflow","subMenuOpenDelay","subMenuCloseDelay","forceSubMenuRender","defaultOpenKeys","openKeys","activeKey","defaultActiveFirst","selectable","multiple","defaultSelectedKeys","selectedKeys","onSelect","onDeselect","inlineIndent","motion","defaultMotions","triggerSubMenuAction","builtinPlacements","itemIcon","expandIcon","overflowedIndicator","overflowedIndicatorPopupClassName","getPopupContainer","onClick","onOpenChange","onKeyDown","openAnimation","openTransitionName","_internalRenderMenuItem","_internalRenderSubMenuItem"],hme=[],mme=a.forwardRef((function(e,t){var r,n,i=e,o=i.prefixCls,s=void 0===o?"rc-menu":o,c=i.rootClassName,u=i.style,d=i.className,f=i.tabIndex,p=void 0===f?0:f,h=i.items,m=i.children,v=i.direction,g=i.id,y=i.mode,b=void 0===y?"vertical":y,w=i.inlineCollapsed,_=i.disabled,C=i.disabledOverflow,E=i.subMenuOpenDelay,x=void 0===E?.1:E,S=i.subMenuCloseDelay,k=void 0===S?.1:S,O=i.forceSubMenuRender,I=i.defaultOpenKeys,R=i.openKeys,T=i.activeKey,A=i.defaultActiveFirst,N=i.selectable,M=void 0===N||N,P=i.multiple,j=void 0!==P&&P,D=i.defaultSelectedKeys,F=i.selectedKeys,V=i.onSelect,L=i.onDeselect,$=i.inlineIndent,B=void 0===$?24:$,z=i.motion,U=i.defaultMotions,H=i.triggerSubMenuAction,W=void 0===H?"hover":H,G=i.builtinPlacements,K=i.itemIcon,q=i.expandIcon,Y=i.overflowedIndicator,X=void 0===Y?"...":Y,Z=i.overflowedIndicatorPopupClassName,J=i.getPopupContainer,Q=i.onClick,ee=i.onOpenChange,te=i.onKeyDown,re=i.openAnimation,ne=i.openTransitionName,ie=i._internalRenderMenuItem,oe=i._internalRenderSubMenuItem,ae=gL(i,pme),se=a.useMemo((function(){return fme(m,h,hme)}),[m,h]),le=fL(a.useState(!1),2),ce=le[0],ue=le[1],de=a.useRef(),fe=function(e){var t=fL(bG(e,{value:e}),2),r=t[0],n=t[1];return a.useEffect((function(){Ahe+=1;var e="test"===Ti.exports.env.NODE_ENV?"test":"".concat(The,"-").concat(Ahe);n("rc-menu-uuid-".concat(e))}),[]),r}(g),pe="rtl"===v;"production"!==Ti.exports.env.NODE_ENV&&jL(!re&&!ne,"`openAnimation` and `openTransitionName` is removed. Please use `motion` or `defaultMotion` instead.");var he=fL(bG(I,{value:R,postState:function(e){return e||hme}}),2),me=he[0],ve=he[1],ge=function(e){function t(){ve(e),null==ee||ee(e)}arguments.length>1&&void 0!==arguments[1]&&arguments[1]?Object(l.flushSync)(t):t()},ye=fL(a.useState(me),2),be=ye[0],we=ye[1],_e=a.useRef(!1),Ce=fL(a.useMemo((function(){return"inline"!==b&&"vertical"!==b||!w?[b,!1]:["vertical",w]}),[b,w]),2),Ee=Ce[0],xe=Ce[1],Se="inline"===Ee,ke=fL(a.useState(Ee),2),Oe=ke[0],Ie=ke[1],Re=fL(a.useState(xe),2),Te=Re[0],Ae=Re[1];a.useEffect((function(){Ie(Ee),Ae(xe),_e.current&&(Se?ve(be):ge(hme))}),[Ee,xe]);var Ne=fL(a.useState(0),2),Me=Ne[0],Pe=Ne[1],je=Me>=se.length-1||"horizontal"!==Oe||C;a.useEffect((function(){Se&&we(me)}),[me]),a.useEffect((function(){return _e.current=!0,function(){_e.current=!1}}),[]);var De=Ihe(),Fe=De.registerPath,Ve=De.unregisterPath,Le=De.refreshOverflowKeys,$e=De.isSubPathKey,Be=De.getKeyPath,ze=De.getKeys,Ue=De.getSubPathKeys,He=a.useMemo((function(){return{registerPath:Fe,unregisterPath:Ve}}),[Fe,Ve]),We=a.useMemo((function(){return{isSubPathKey:$e}}),[$e]);a.useEffect((function(){Le(je?hme:se.slice(Me+1).map((function(e){return e.key})))}),[Me,je]);var Ge=fL(bG(T||A&&(null===(r=se[0])||void 0===r?void 0:r.key),{value:T}),2),Ke=Ge[0],qe=Ge[1],Ye=Rhe((function(e){qe(e)})),Xe=Rhe((function(){qe(void 0)}));Object(a.useImperativeHandle)(t,(function(){return{list:de.current,focus:function(e){var t,r,n,i,o=null!=Ke?Ke:null===(t=se.find((function(e){return!e.props.disabled})))||void 0===t?void 0:t.key;o&&(null===(r=de.current)||void 0===r||null===(n=r.querySelector("li[data-menu-id='".concat(ehe(fe,o),"']")))||void 0===n||null===(i=n.focus)||void 0===i||i.call(n,e))}}}));var Ze=fL(bG(D||[],{value:F,postState:function(e){return Array.isArray(e)?e:null==e?hme:[e]}}),2),Je=Ze[0],Qe=Ze[1],et=Rhe((function(e){null==Q||Q(Dhe(e)),function(e){if(M){var t,r=e.key,n=Je.includes(r);t=j?n?Je.filter((function(e){return e!==r})):[].concat(bL(Je),[r]):[r],Qe(t);var i=hL(hL({},e),{},{selectedKeys:t});n?null==L||L(i):null==V||V(i)}!j&&me.length&&"inline"!==Oe&&ge(hme)}(e)})),tt=Rhe((function(e,t){var r=me.filter((function(t){return t!==e}));if(t)r.push(e);else if("inline"!==Oe){var n=Ue(e);r=r.filter((function(e){return!n.has(e)}))}rY(me,r,!0)||ge(r,!0)})),rt=xhe(Oe,Ke,pe,fe,de,ze,Be,qe,(function(e,t){var r=null!=t?t:!me.includes(e);tt(e,r)}),te);a.useEffect((function(){ue(!0)}),[]);var nt=a.useMemo((function(){return{_internalRenderMenuItem:ie,_internalRenderSubMenuItem:oe}}),[ie,oe]),it="horizontal"!==Oe||C?se:se.map((function(e,t){return a.createElement(ihe,{key:e.key,overflowDisabled:t>Me},e)})),ot=a.createElement(Jpe,iL({id:g,ref:de,prefixCls:"".concat(s,"-overflow"),component:"ul",itemComponent:Uhe,className:GA(s,"".concat(s,"-root"),"".concat(s,"-").concat(Oe),d,(n={},sL(n,"".concat(s,"-inline-collapsed"),Te),sL(n,"".concat(s,"-rtl"),pe),n),c),dir:v,style:u,role:"menu",tabIndex:p,data:it,renderRawItem:function(e){return e},renderRawRest:function(e){var t=e.length,r=t?se.slice(-t):null;return a.createElement(ime,{eventKey:Ohe,title:X,disabled:je,internalPopupClose:0===t,popupClassName:Z},r)},maxCount:"horizontal"!==Oe||C?Jpe.INVALIDATE:Jpe.RESPONSIVE,ssr:"full","data-menu-list":!0,onVisibleChange:function(e){Pe(e)},onKeyDown:rt},ae));return a.createElement(dhe.Provider,{value:nt},a.createElement(Qpe.Provider,{value:fe},a.createElement(ihe,{prefixCls:s,rootClassName:c,mode:Oe,openKeys:me,rtl:pe,disabled:_,motion:ce?z:null,defaultMotions:ce?U:null,activeKey:Ke,onActive:Ye,onInactive:Xe,selectedKeys:Je,inlineIndent:B,subMenuOpenDelay:x,subMenuCloseDelay:k,forceSubMenuRender:O,builtinPlacements:G,triggerSubMenuAction:W,getPopupContainer:J,itemIcon:K,expandIcon:q,onItemClick:et,onOpenChange:tt},a.createElement(uhe.Provider,{value:We},ot),a.createElement("div",{style:{display:"none"},"aria-hidden":!0},a.createElement(ahe.Provider,{value:He},se)))))})),vme=mme;function gme(e,t){var r=e.prefixCls,n=e.id,i=e.tabs,o=e.locale,s=e.mobile,l=e.moreIcon,c=void 0===l?"More":l,u=e.moreTransitionName,d=e.style,f=e.className,p=e.editable,h=e.tabBarGutter,m=e.rtl,v=e.removeAriaLabel,g=e.onTabClick,y=e.getPopupContainer,b=e.popupClassName,w=fL(Object(a.useState)(!1),2),_=w[0],C=w[1],E=fL(Object(a.useState)(null),2),x=E[0],S=E[1],k="".concat(n,"-more-popup"),O="".concat(r,"-dropdown"),I=null!==x?"".concat(k,"-").concat(x):null,R=null==o?void 0:o.dropdownAriaLabel;var T=a.createElement(vme,{onClick:function(e){var t=e.key,r=e.domEvent;g(t,r),C(!1)},prefixCls:"".concat(O,"-menu"),id:k,tabIndex:-1,role:"listbox","aria-activedescendant":I,selectedKeys:[x],"aria-label":void 0!==R?R:"expanded dropdown"},i.map((function(e){var t=e.closable,r=e.disabled,i=e.closeIcon,o=e.key,s=e.label,l=Bfe(t,i,p,r);return a.createElement(Uhe,{key:o,id:"".concat(k,"-").concat(o),role:"option","aria-controls":n&&"".concat(n,"-panel-").concat(o),disabled:r},a.createElement("span",null,s),l&&a.createElement("button",{type:"button","aria-label":v||"remove",tabIndex:0,className:"".concat(O,"-menu-item-remove"),onClick:function(e){e.stopPropagation(),function(e,t){e.preventDefault(),e.stopPropagation(),p.onEdit("remove",{key:t,event:e})}(e,o)}},i||p.removeIcon||"×"))})));function A(e){for(var t=i.filter((function(e){return!e.disabled})),r=t.findIndex((function(e){return e.key===x}))||0,n=t.length,o=0;o<n;o+=1){var a=t[r=(r+e+n)%n];if(!a.disabled)return void S(a.key)}}Object(a.useEffect)((function(){var e=document.getElementById(I);e&&e.scrollIntoView&&e.scrollIntoView(!1)}),[x]),Object(a.useEffect)((function(){_||S(null)}),[_]);var N=sL({},m?"marginRight":"marginLeft",h);i.length||(N.visibility="hidden",N.order=1);var M=GA(sL({},"".concat(O,"-rtl"),m)),P=s?null:a.createElement(Ppe,{prefixCls:O,overlay:T,trigger:["hover"],visible:!!i.length&&_,transitionName:u,onVisibleChange:C,overlayClassName:GA(M,b),mouseEnterDelay:.1,mouseLeaveDelay:.1,getPopupContainer:y},a.createElement("button",{type:"button",className:"".concat(r,"-nav-more"),style:N,tabIndex:-1,"aria-hidden":"true","aria-haspopup":"listbox","aria-controls":k,id:"".concat(n,"-more"),"aria-expanded":_,onKeyDown:function(e){var t=e.which;if(_)switch(t){case wG.UP:A(-1),e.preventDefault();break;case wG.DOWN:A(1),e.preventDefault();break;case wG.ESC:C(!1);break;case wG.SPACE:case wG.ENTER:null!==x&&g(x,e)}else[wG.DOWN,wG.SPACE,wG.ENTER].includes(t)&&(C(!0),e.preventDefault())}},c));return a.createElement("div",{className:GA("".concat(r,"-nav-operations"),f),style:d,ref:t},P,a.createElement(Ufe,{prefixCls:r,locale:o,editable:p}))}vme.Item=Uhe,vme.SubMenu=ime,vme.ItemGroup=lme,vme.Divider=cme;const yme=a.memo(a.forwardRef(gme),(function(e,t){return t.tabMoving}));function bme(e){var t,r=e.prefixCls,n=e.id,i=e.active,o=e.tab,s=o.key,l=o.label,c=o.disabled,u=o.closeIcon,d=e.closable,f=e.renderWrapper,p=e.removeAriaLabel,h=e.editable,m=e.onClick,v=e.onFocus,g=e.style,y="".concat(r,"-tab"),b=Bfe(d,u,h,c);function w(e){c||m(e)}var _=a.createElement("div",{key:s,"data-node-key":$fe(s),className:GA(y,(t={},sL(t,"".concat(y,"-with-remove"),b),sL(t,"".concat(y,"-active"),i),sL(t,"".concat(y,"-disabled"),c),t)),style:g,onClick:w},a.createElement("div",{role:"tab","aria-selected":i,id:n&&"".concat(n,"-tab-").concat(s),className:"".concat(y,"-btn"),"aria-controls":n&&"".concat(n,"-panel-").concat(s),"aria-disabled":c,tabIndex:c?null:0,onClick:function(e){e.stopPropagation(),w(e)},onKeyDown:function(e){[wG.SPACE,wG.ENTER].includes(e.which)&&(e.preventDefault(),w(e))},onFocus:v},l),b&&a.createElement("button",{type:"button","aria-label":p||"remove",tabIndex:0,className:"".concat(y,"-remove"),onClick:function(e){e.stopPropagation(),function(e){e.preventDefault(),e.stopPropagation(),h.onEdit("remove",{key:s,event:e})}(e)}},u||h.removeIcon||"×"));return f?f(_):_}var wme=function(e){var t=e.current||{},r=t.offsetWidth,n=void 0===r?0:r,i=t.offsetHeight;return[n,void 0===i?0:i]},_me=function(e,t){return e[t?0:1]};function Cme(e,t){var r,n=a.useContext(yfe),i=n.prefixCls,o=n.tabs,s=e.className,l=e.style,c=e.id,u=e.animated,d=e.activeKey,f=e.rtl,p=e.extra,h=e.editable,m=e.locale,v=e.tabPosition,g=e.tabBarGutter,y=e.children,b=e.onTabClick,w=e.onTabScroll,_=e.indicatorSize,C=Object(a.useRef)(),E=Object(a.useRef)(),x=Object(a.useRef)(),S=Object(a.useRef)(),k=Object(a.useRef)(),O=Object(a.useRef)(),I=Object(a.useRef)(),R="top"===v||"bottom"===v,T=fL(Afe(0,(function(e,t){R&&w&&w({direction:e>t?"left":"right"})})),2),A=T[0],N=T[1],M=fL(Afe(0,(function(e,t){!R&&w&&w({direction:e>t?"top":"bottom"})})),2),P=M[0],j=M[1],D=fL(Object(a.useState)([0,0]),2),F=D[0],V=D[1],L=fL(Object(a.useState)([0,0]),2),$=L[0],B=L[1],z=fL(Object(a.useState)([0,0]),2),U=z[0],H=z[1],W=fL(Object(a.useState)([0,0]),2),G=W[0],K=W[1],q=function(e){var t=Object(a.useRef)([]),r=fL(Object(a.useState)({}),2)[1],n=Object(a.useRef)("function"==typeof e?e():e),i=Dfe((function(){var e=n.current;t.current.forEach((function(t){e=t(e)})),t.current=[],n.current=e,r({})}));return[n.current,function(e){t.current.push(e),i()}]}(new Map),Y=fL(q,2),X=Y[0],Z=Y[1],J=function(e,t,r){return Object(a.useMemo)((function(){for(var r,n=new Map,i=t.get(null===(r=e[0])||void 0===r?void 0:r.key)||Tfe,o=i.left+i.width,a=0;a<e.length;a+=1){var s,l=e[a].key,c=t.get(l);c||(c=t.get(null===(s=e[a-1])||void 0===s?void 0:s.key)||Tfe);var u=n.get(l)||hL({},c);u.right=o-u.left-u.width,n.set(l,u)}return n}),[e.map((function(e){return e.key})).join("_"),t,r])}(o,X,$[0]),Q=_me(F,R),ee=_me($,R),te=_me(U,R),re=_me(G,R),ne=Q<ee+te,ie=ne?Q-re:Q-te,oe="".concat(i,"-nav-operations-hidden"),ae=0,se=0;function le(e){return e<ae?ae:e>se?se:e}R&&f?(ae=0,se=Math.max(0,ee-ie)):(ae=Math.min(0,ie-ee),se=0);var ce=Object(a.useRef)(),ue=fL(Object(a.useState)(),2),de=ue[0],fe=ue[1];function pe(){fe(Date.now())}function he(){window.clearTimeout(ce.current)}(function(e,t){var r=fL(Object(a.useState)(),2),n=r[0],i=r[1],o=fL(Object(a.useState)(0),2),s=o[0],l=o[1],c=fL(Object(a.useState)(0),2),u=c[0],d=c[1],f=fL(Object(a.useState)(),2),p=f[0],h=f[1],m=Object(a.useRef)(),v=Object(a.useRef)(),g=Object(a.useRef)(null);g.current={onTouchStart:function(e){var t=e.touches[0],r=t.screenX,n=t.screenY;i({x:r,y:n}),window.clearInterval(m.current)},onTouchMove:function(e){if(n){e.preventDefault();var r=e.touches[0],o=r.screenX,a=r.screenY;i({x:o,y:a});var c=o-n.x,u=a-n.y;t(c,u);var f=Date.now();l(f),d(f-s),h({x:c,y:u})}},onTouchEnd:function(){if(n&&(i(null),h(null),p)){var e=p.x/u,r=p.y/u,o=Math.abs(e),a=Math.abs(r);if(Math.max(o,a)<Nfe)return;var s=e,l=r;m.current=window.setInterval((function(){Math.abs(s)<Mfe&&Math.abs(l)<Mfe?window.clearInterval(m.current):t((s*=jfe)*Pfe,(l*=jfe)*Pfe)}),Pfe)}},onWheel:function(e){var r=e.deltaX,n=e.deltaY,i=0,o=Math.abs(r),a=Math.abs(n);o===a?i="x"===v.current?r:n:o>a?(i=r,v.current="x"):(i=n,v.current="y"),t(-i,-i)&&e.preventDefault()}},a.useEffect((function(){function t(e){g.current.onTouchMove(e)}function r(e){g.current.onTouchEnd(e)}return document.addEventListener("touchmove",t,{passive:!1}),document.addEventListener("touchend",r,{passive:!1}),e.current.addEventListener("touchstart",(function(e){g.current.onTouchStart(e)}),{passive:!1}),e.current.addEventListener("wheel",(function(e){g.current.onWheel(e)})),function(){document.removeEventListener("touchmove",t),document.removeEventListener("touchend",r)}}),[])})(S,(function(e,t){function r(e,t){e((function(e){return le(e+t)}))}return!!ne&&(R?r(N,e):r(j,t),he(),pe(),!0)})),Object(a.useEffect)((function(){return he(),de&&(ce.current=window.setTimeout((function(){fe(0)}),100)),he}),[de]);var me=function(e,t,r,n,i,o,s){var l,c,u,d=s.tabs,f=s.tabPosition,p=s.rtl;return["top","bottom"].includes(f)?(l="width",c=p?"right":"left",u=Math.abs(r)):(l="height",c="top",u=-r),Object(a.useMemo)((function(){if(!d.length)return[0,0];for(var r=d.length,n=r,i=0;i<r;i+=1){var o=e.get(d[i].key)||Ffe;if(o[c]+o[l]>u+t){n=i-1;break}}for(var a=0,s=r-1;s>=0;s-=1)if((e.get(d[s].key)||Ffe)[c]<u){a=s+1;break}return a>=n?[0,0]:[a,n]}),[e,t,n,i,o,u,f,d.map((function(e){return e.key})).join("_"),p])}(J,ie,R?A:P,ee,te,re,hL(hL({},e),{},{tabs:o})),ve=fL(me,2),ge=ve[0],ye=ve[1],be=hG((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=J.get(e)||{width:0,height:0,left:0,right:0,top:0};if(R){var r=A;f?t.right<A?r=t.right:t.right+t.width>A+ie&&(r=t.right+t.width-ie):t.left<-A?r=-t.left:t.left+t.width>-A+ie&&(r=-(t.left+t.width-ie)),j(0),N(le(r))}else{var n=P;t.top<-P?n=-t.top:t.top+t.height>-P+ie&&(n=-(t.top+t.height-ie)),N(0),j(le(n))}})),we={};"top"===v||"bottom"===v?we[f?"marginRight":"marginLeft"]=g:we.marginTop=g;var _e=o.map((function(e,t){var r=e.key;return a.createElement(bme,{id:c,prefixCls:i,key:r,tab:e,style:0===t?void 0:we,closable:e.closable,editable:h,active:r===d,renderWrapper:y,removeAriaLabel:null==m?void 0:m.removeAriaLabel,onClick:function(e){b(r,e)},onFocus:function(){be(r),pe(),S.current&&(f||(S.current.scrollLeft=0),S.current.scrollTop=0)}})})),Ce=function(){return Z((function(){var e=new Map;return o.forEach((function(t){var r,n=t.key,i=null===(r=k.current)||void 0===r?void 0:r.querySelector('[data-node-key="'.concat($fe(n),'"]'));i&&e.set(n,{width:i.offsetWidth,height:i.offsetHeight,left:i.offsetLeft,top:i.offsetTop})})),e}))};Object(a.useEffect)((function(){Ce()}),[o.map((function(e){return e.key})).join("_")]);var Ee=Dfe((function(){var e=wme(C),t=wme(E),r=wme(x);V([e[0]-t[0]-r[0],e[1]-t[1]-r[1]]);var n=wme(I);H(n);var i=wme(O);K(i);var o=wme(k);B([o[0]-n[0],o[1]-n[1]]),Ce()})),xe=o.slice(0,ge),Se=o.slice(ye+1),ke=[].concat(bL(xe),bL(Se)),Oe=J.get(d),Ie=function(e){var t=e.activeTabOffset,r=e.horizontal,n=e.rtl,i=e.indicatorSize,o=fL(Object(a.useState)(),2),s=o[0],l=o[1],c=Object(a.useRef)(),u=function(e){return"function"==typeof i?i(e):"number"==typeof i?i:e};function d(){ez.cancel(c.current)}return Object(a.useEffect)((function(){var e={};return t&&(r?(n?(e.right=t.right+t.width/2,e.transform="translateX(50%)"):(e.left=t.left+t.width/2,e.transform="translateX(-50%)"),e.width=u(t.width)):(e.top=t.top+t.height/2,e.transform="translateY(-50%)",e.height=u(t.height))),d(),c.current=ez((function(){l(e)})),d}),[t,r,n,i]),{style:s}}({activeTabOffset:Oe,horizontal:R,rtl:f,indicatorSize:_}),Re=Ie.style;Object(a.useEffect)((function(){be()}),[d,ae,se,Vfe(Oe),Vfe(J),R]),Object(a.useEffect)((function(){Ee()}),[f]);var Te,Ae,Ne,Me,Pe=!!ke.length,je="".concat(i,"-nav-wrap");return R?f?(Ae=A>0,Te=A!==se):(Te=A<0,Ae=A!==ae):(Ne=P<0,Me=P!==ae),a.createElement(Rfe,{onResize:Ee},a.createElement("div",{ref:bB(t,C),role:"tablist",className:GA("".concat(i,"-nav"),s),style:l,onKeyDown:function(){pe()}},a.createElement(Hfe,{ref:E,position:"left",extra:p,prefixCls:i}),a.createElement(Rfe,{onResize:Ee},a.createElement("div",{className:GA(je,(r={},sL(r,"".concat(je,"-ping-left"),Te),sL(r,"".concat(je,"-ping-right"),Ae),sL(r,"".concat(je,"-ping-top"),Ne),sL(r,"".concat(je,"-ping-bottom"),Me),r)),ref:S},a.createElement(Rfe,{onResize:Ee},a.createElement("div",{ref:k,className:"".concat(i,"-nav-list"),style:{transform:"translate(".concat(A,"px, ").concat(P,"px)"),transition:de?"none":void 0}},_e,a.createElement(Ufe,{ref:I,prefixCls:i,locale:m,editable:h,style:hL(hL({},0===_e.length?void 0:we),{},{visibility:Pe?"hidden":null})}),a.createElement("div",{className:GA("".concat(i,"-ink-bar"),sL({},"".concat(i,"-ink-bar-animated"),u.inkBar)),style:Re}))))),a.createElement(yme,iL({},e,{removeAriaLabel:null==m?void 0:m.removeAriaLabel,ref:O,prefixCls:i,tabs:ke,className:!Pe&&oe,tabMoving:!!de})),a.createElement(Hfe,{ref:x,position:"right",extra:p,prefixCls:i})))}const Eme=a.forwardRef(Cme);var xme=["renderTabBar"],Sme=["label","key"];function kme(e){var t=e.renderTabBar,r=gL(e,xme),n=a.useContext(yfe).tabs;return t?t(hL(hL({},r),{},{panes:n.map((function(e){var t=e.label,r=e.key,n=gL(e,Sme);return a.createElement(bfe,iL({tab:t,key:r,tabKey:r},n))}))}),Eme):a.createElement(Eme,r)}var Ome=["id","prefixCls","className","items","direction","activeKey","defaultActiveKey","editable","animated","tabPosition","tabBarGutter","tabBarStyle","tabBarExtraContent","locale","moreIcon","moreTransitionName","destroyInactiveTabPane","renderTabBar","onChange","onTabClick","onTabScroll","getPopupContainer","popupClassName","indicatorSize"],Ime=0;function Rme(e,t){var r,n=e.id,i=e.prefixCls,o=void 0===i?"rc-tabs":i,s=e.className,l=e.items,c=e.direction,u=e.activeKey,d=e.defaultActiveKey,f=e.editable,p=e.animated,h=e.tabPosition,m=void 0===h?"top":h,v=e.tabBarGutter,g=e.tabBarStyle,y=e.tabBarExtraContent,b=e.locale,w=e.moreIcon,_=e.moreTransitionName,C=e.destroyInactiveTabPane,E=e.renderTabBar,x=e.onChange,S=e.onTabClick,k=e.onTabScroll,O=e.getPopupContainer,I=e.popupClassName,R=e.indicatorSize,T=gL(e,Ome),A=a.useMemo((function(){return(l||[]).filter((function(e){return e&&"object"===oL(e)&&"key"in e}))}),[l]),N="rtl"===c,M=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{inkBar:!0,tabPane:!1};return(e=!1===t?{inkBar:!1,tabPane:!1}:!0===t?{inkBar:!0,tabPane:!1}:hL({inkBar:!0},"object"===oL(t)?t:{})).tabPaneMotion&&void 0===e.tabPane&&(e.tabPane=!0),!e.tabPaneMotion&&e.tabPane&&("production"!==Ti.exports.env.NODE_ENV&&jL(!1,"`animated.tabPane` is true but `animated.tabPaneMotion` is not provided. Motion will not work."),e.tabPane=!1),e}(p),P=fL(Object(a.useState)(!1),2),j=P[0],D=P[1];Object(a.useEffect)((function(){D(qK())}),[]);var F=fL(bG((function(){var e;return null===(e=A[0])||void 0===e?void 0:e.key}),{value:u,defaultValue:d}),2),V=F[0],L=F[1],$=fL(Object(a.useState)((function(){return A.findIndex((function(e){return e.key===V}))})),2),B=$[0],z=$[1];Object(a.useEffect)((function(){var e,t=A.findIndex((function(e){return e.key===V}));-1===t&&(t=Math.max(0,Math.min(B,A.length-1)),L(null===(e=A[t])||void 0===e?void 0:e.key));z(t)}),[A.map((function(e){return e.key})).join("_"),V,B]);var U=fL(bG(null,{value:n}),2),H=U[0],W=U[1];Object(a.useEffect)((function(){n||(W("rc-tabs-".concat("test"===Ti.exports.env.NODE_ENV?"test":Ime)),Ime+=1)}),[]);var G={id:H,activeKey:V,animated:M,tabPosition:m,rtl:N,mobile:j},K=hL(hL({},G),{},{editable:f,locale:b,moreIcon:w,moreTransitionName:_,tabBarGutter:v,onTabClick:function(e,t){null==S||S(e,t);var r=e!==V;L(e),r&&(null==x||x(e))},onTabScroll:k,extra:y,style:g,panes:null,getPopupContainer:O,popupClassName:I,indicatorSize:R});return a.createElement(yfe.Provider,{value:{tabs:A,prefixCls:o}},a.createElement("div",iL({ref:t,id:n,className:GA(o,"".concat(o,"-").concat(m),(r={},sL(r,"".concat(o,"-mobile"),j),sL(r,"".concat(o,"-editable"),f),sL(r,"".concat(o,"-rtl"),N),r),s)},T),a.createElement(kme,iL({},K,{renderTabBar:E})),a.createElement(_fe,iL({destroyInactiveTabPane:C},G,{animated:M}))))}var Tme=a.forwardRef(Rme);"production"!==Ti.exports.env.NODE_ENV&&(Tme.displayName="Tabs");const Ame=({className:e,...t})=>{const{attributes:r,listeners:n,setNodeRef:i,transform:o,transition:a}=zP({id:t["data-node-key"],disabled:t.disabled}),l={...t.style,transform:vN.Transform.toString(o&&{...o,scaleX:1}),transition:a};return s.a.cloneElement(t.children,{ref:i,style:l,...r,...n})},Nme=()=>{const{getChooseConfigs:e,onChooseView:t,onCancelEditing:r,onViewNameChange:n,onHandleSetting:i,editingKey:o,activeView:l,onDragEnd:c,isReadonly:p}=hfe(),m=zA(tQ),[v,g]=Object(a.useState)(""),y=(e,t)=>{g(e?t.key:"")},b=TN(RN(SM,{activationConstraint:{distance:8}})),w=(e,t,r)=>{"add"===t&&(e=>{const t=e.currentTarget;null==m||m.open("add-view",{position:{origin:t,placement:"bottom"}})})(e)},_=e=>s.a.createElement("span",{onDoubleClick:()=>{p||i({key:l.uuid},pfe.find((e=>"rename"===e.key)))},className:"lakex-table-viewer-manage-tab-title"},e.title),C=e({unActiveViewColor:!0}).map((e=>e?{key:e.key,label:s.a.createElement("div",{className:"lakex-table-viewer-manage-tab-item"},e.icon,e.key===o&&s.a.createElement(u.a,{className:"lakex-table-menu-configs-input",defaultValue:e.title,autoFocus:!0,onKeyDown:t=>{t.stopPropagation();const i=t.keyCode;27!==i?13===i&&n(t,e):r()},onClick:e=>e.stopPropagation(),onBlur:t=>n(t,e)}),e.key!==o&&e.title.length>10&&s.a.createElement(h.a,{placement:"top",title:e.title,arrow:!0},_(e)),e.key!==o&&e.title.length<=10&&_(e)),closable:!p,closeIcon:e.key===l.uuid?s.a.createElement(f.a,{overlayClassName:"lakex-table-menu-container lakex-table-toolbar-tab-menu",content:s.a.createElement(d.a,{onClick:e=>{i({key:l.uuid},e),y(!1,e)}},pfe.map((e=>s.a.createElement(d.a.Item,{key:e.key},e.title)))),visible:v===e.key,trigger:"click",placement:"bottomLeft",onClick:e=>e.stopPropagation(),onVisibleChange:t=>y(t,e)},s.a.createElement(YP,{type:"MoreHorizontal",size:14})):s.a.createElement("span",null)}:null)).filter((e=>!!e));return s.a.createElement(Tme,{className:"lakex-table-viewer-manage-tab",prefixCls:"ant-tabs",activeKey:null==l?void 0:l.uuid,onChange:e=>t({key:e}),items:C,editable:{onEdit:(e,{key:t,event:r})=>{null==w||w("add"===e?r:t,e)},removeIcon:s.a.createElement("span",null),showAdd:!p,addIcon:s.a.createElement(YP,{type:"Add",size:14})},popupClassName:"lakex-table-viewer-manage-tab-more-popup",moreIcon:s.a.createElement(YP,{type:"MoreHorizontal",size:14}),renderTabBar:(e,t)=>s.a.createElement(aP,{sensors:b,modifiers:[UP,WP],collisionDetection:LN,onDragEnd:c},s.a.createElement(jP,{items:C.map((e=>({id:e.key}))),strategy:RP},s.a.createElement(t,{...e},(e=>s.a.createElement(Ame,{"data-node-key":String(e.key)||"",disabled:!!o},e)))))})};var Mme=Object.defineProperty,Pme=Object.getOwnPropertyDescriptor,jme=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Pme(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Mme(t,r,o),o};let Dme=class{static pluginModule(){return bo().register(this)}static registerConfiguration(e){e.registerConfiguration({id:"viewerManage",type:"object",title:"视图管理",properties:{type:{type:"string",description:"组件类型",enum:Object.values(gfe)},viewTypes:{type:"array",description:"可操作的视图列表"}}}),e.registerDefaultValue({"viewerManage.type":gfe.TAB,"viewerManage.viewTypes":[Wh.GRID,Wh.CARD,Wh.KANBAN]})}init(){}registerToolbar(e){const t=this._configuration.getValue("viewerManage.type");e.registerItem({id:"view-manage",RenderComponent:t===gfe.MENU?dfe:Nme,onClick:e=>{if(t===gfe.TAB)return;const r={position:{placement:"bottom",origin:e.target}};this._modalService.open("view-manage",r)}})}registerModal(e){const t=this._configuration.getValue("modal.mode"),r=this._configuration.getValue("render.mode");e.registerItem({id:"view-manage",mode:t,hasMask:t===eQ.DRAWER,hasAnimation:t===eQ.DRAWER,position:t===eQ.DRAWER&&{placement:"bottom"},scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:r===Pj.MOBILE?vfe:mfe}),e.registerItem({id:"add-view",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:ffe})}};Dme.pluginName="workbench-viewer-manage",jme([to(tQ)],Dme.prototype,"_modalService",2),jme([to(qf)],Dme.prototype,"_configuration",2),Dme=jme([eo({contrib:[PA,IJ,rQ]})],Dme);const Fme=Fi.defineToken("AddFieldPluginConfigContribution"),Vme=Fi.defineToken("AddFieldPluginColConfigNameContribution");var Lme=Object.defineProperty,$me=Object.getOwnPropertyDescriptor,Bme=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?$me(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Lme(t,r,o),o};let zme=class{constructor(){this.getConfigComponents=()=>{const e=this.addFieldPluginConfigProvider.getContributions({cache:!1});return e.length>0?e.map((e=>e.getConfigComponent())):[]},this.getColConfigNameComponent=()=>{var e,t;const r=this.AddFieldPluginColConfigNameaddFieldPluginConfigProvider.getContributions({cache:!1});return r[0]?null==(t=(e=r[0]).getColConfigNameComponent)?void 0:t.call(e):null}}};Bme([Eo(Fme)],zme.prototype,"addFieldPluginConfigProvider",2),Bme([Eo(Vme)],zme.prototype,"AddFieldPluginColConfigNameaddFieldPluginConfigProvider",2),zme=Bme([eo()],zme);const Ume=e=>{var t,r;if(!Kh.isSelectLike(e.type))return null;const n={type:e.type,options:(null==(t=e.property)?void 0:t.options)||[],color:(null==(r=e.property)?void 0:r.color)||!1};return s.a.createElement("div",{className:"select-input lakex-table-col-options"},s.a.createElement(bJ,{title:s.a.createElement("span",{style:{color:"#8c8c8c"}},kf("选项设置")),onChange:e.onChange,onChangeOrder:e.onChangeOrder,multiple:e.type===Rh.MULTI_SELECT,configs:n}))},Hme=({initialState:e})=>{const{fieldId:t,showFieldTypes:r,sourceFieldId:n,direction:i="after"}=e||{},o=f0(t||""),l=zA(Dy),c=zA(Pb),d=zA(Hw),f=zA(tD),p=zA(tQ),m=zA(rk),v=zA(zme),g=null==f?void 0:f.getFieldIcon(null==o?void 0:o.type),y=(null==v?void 0:v.getConfigComponents())||[],w=jo(o),[_,C]=Object(a.useState)(null),E=Object(a.useMemo)((()=>{if(w){return(e=>{let t;const r=[];for(e.forEach((e=>{r.push(e.uuid)}));!t||r.includes(t);)t=Io(32);return{id:t,name:Ph(Rh.TEXT,e),type:Rh.TEXT,options:null}})(l.getAllFields())}return{id:o.id,name:o.name||"",type:o.type||Rh.TEXT,options:o.options||[]}}),[o]),[x,S]=Object(a.useState)(E.name),[k,O]=Object(a.useState)(E.type),I=Object(a.useRef)(null),[R,T]=Object(a.useState)((()=>Kh.isSelectLike(k)?{options:E.options,color:Boolean(null==o?void 0:o.color)}:null)),A=Object(a.useCallback)((()=>{p.close("addOrUpdateField")}),[p]),N=Object(a.useCallback)((e=>e?l.getAllFields().some((t=>t.uuid!==E.id&&t.name===e))?kf("不能与其他列重名"):null:kf("列名不能为空")),[]),M=Object(a.useCallback)((e=>{const t=N(e);C(t)}),[]),P=Object(a.useCallback)((e=>{const{ctrlKey:t,metaKey:r}=e;if(13===e.keyCode&&!t&&!r){const t=e.target.value.trim();M(t)}}),[]),j=Object(a.useCallback)((async e=>{const r=N(x);if(C(r),M(x),!r)if(w){const t={field:{uuid:e||Io(32),name:x,type:k},sourceFieldId:n,direction:i};R&&(t.field.color=R.color,t.field.options=R.options),await(null==c?void 0:c.execCommand("addField",t)),A()}else{const e={uuid:t,name:x,type:k};R&&(e.color=R.color,e.options=R.options),await(null==o?void 0:o.updateProperty(e)),A()}}),[N,o,w,t,n,i,x,k,M,R]),D=Object(a.useCallback)((e=>xd(l.getFieldCells(e.fieldId),"formatValue").filter((e=>!!e.formatValue)).map(((e,t)=>({color:null==m?void 0:m.getByIndex(t),name:e.formatValue,uuid:Io(6)})))),[]),F=Object(a.useCallback)((e=>{var r;const n=e.key,i=l.getAllFields();if(new RegExp(`${jh(k)}(\\s\\d)*`).test(x)&&w){const e=Ph(n,i);S(e),null==(r=I.current)||r.setValue(e)}if(!Kh.isSelectLike(k)&&Kh.isSelectLike(n)){if(!R||!R.options||0===R.options.length){const e={options:t?D({fieldId:t,type:k,color:!0}):[],color:!0};T(e),p.emitUpdatePosition("addOrUpdateField")}}else Kh.isDate(n)||Kh.isSystemDate(n);O(n)}),[E,l,k,R,t,w]);if(!w&&!o)return console.warn("FieldId is valid in FieldConfigModal"),null;let V=Mh.filter((e=>{if(w){if(Kh.isCreateDisable(e.type))return!1}else if(Kh.isTransformDisable(e.type))return!1;return!0}));r&&(V=Mh.filter((e=>r.includes(e.type))));const L=null==f?void 0:f.getFieldIcon(k),$=[{key:k,title:s.a.createElement("span",null,jh(k)),icon:L?s.a.createElement(L,{size:16}):null,groupBy:"subType",children:V.map((e=>{const t=null==f?void 0:f.getFieldIcon(e.type),r=null==v?void 0:v.getColConfigNameComponent();return{key:e.type,title:r?s.a.createElement(r,{fieldType:e.type,fieldName:e.name}):e.name,icon:t?s.a.createElement(t,{size:16}):null,subType:e.isAdvanced?kf("高级"):kf("基础"),showActiveIcon:!0}}))}];return s.a.createElement("div",{className:"lakex-table-col-configs"},s.a.createElement("p",{className:"lakex-table-col-title"},kf("数据表列名")),s.a.createElement("div",{className:"lakex-table-col-name"},s.a.createElement(u.a,{defaultValue:x,onChange:e=>{const t=e.target.value.trim();S(t)},ref:I,maxLength:128,onKeyDown:P,onBlur:e=>{M(e.target.value.trim())},autoFocus:!0,className:GA({error:_})}),_&&s.a.createElement("div",{className:"lakex-table-col-error"},_)),s.a.createElement("p",{className:"lakex-table-col-title"},kf("列类型"),s.a.createElement(h.a,{title:kf("设置该列内容类型，支持文本、日期、数字、单选、多选等")},s.a.createElement(YP,{type:"Question",size:14,style:{marginLeft:4}}))),w||d.can(Aw.TRANSFORM,Nw.FIELD,o)?s.a.createElement(tj,{key:null==o?void 0:o.type,menuKey:(null==o?void 0:o.type)||"",className:"lakex-table-col-types",defaultSelectedKeys:[k],onClick:F,configs:$}):s.a.createElement("div",{className:"lakex-table-col-readonly"},g&&s.a.createElement(g,null),s.a.createElement("span",{className:"lakex-table-col-readonly-text"},jh(null==o?void 0:o.type))),s.a.createElement(Ume,{name:x,type:k,property:R,onChange:e=>{T(e)},onChangeOrder:async(e,t)=>{}}),y.length>0&&y.map((e=>s.a.createElement(e,{key:null,originField:o,fieldType:k,fieldName:x,fieldProperty:R,onFieldSubmitConfirm:j}))),s.a.createElement("div",{className:"lakex-table-col-configs-footer"},s.a.createElement(b.a,{style:{marginRight:12},onClick:A},kf("取消")),s.a.createElement(b.a,{type:"primary",disabled:_,onClick:()=>j()},kf("确定"))))};var Wme=Object.defineProperty,Gme=Object.getOwnPropertyDescriptor,Kme=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Gme(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Wme(t,r,o),o};let qme=class{constructor(){this._toDestroyCollection=new ep}static pluginModule(){return bo().contribution(Fme).contribution(Vme).register(this).register(zme)}get isReadonly(){return this._abilityService.isReadonly(Nw.TABLE)}init(){this._toDestroyCollection.push(this._renderService.onClickIcon((e=>{"grid-field-config"===e.iconName&&this._handleOpenFieldConfigCreateModal(e.event.currentTarget)}))),this._toDestroyCollection.push(this._renderService.onClickEvent((e=>{if("gridHeader:doubleClick"===e.eventName){const{event:t,fieldId:r}=e.data;this._modalService.open("addOrUpdateField",{position:{origin:t.currentTarget,placement:"bottom"},initialState:{fieldId:r}})}})))}destroy(){this._toDestroyCollection.destroy()}registerModal(e){e.registerItem({id:"addOrUpdateField",hasMask:!1,scrollStrategy:"block",zIndex:"expandRecord",RenderComponent:Hme})}registerContextMenu(e){e.registerItem({key:"updateField",name:kf("编辑列"),icon:"Edit",hotkey:"",visible:({from:e})=>!this.isReadonly&&e===nre.HEADER,onClick:({initialState:e,position:t})=>{const{recordId:r,fieldId:n}=e;if(!t)return;const i=this._workbenchContext.$root.querySelector(`.lakex-viewer-grid-header-column[data-field-id="${n}"]`);this._modalService.open("addOrUpdateField",{initialState:{recordId:r,fieldId:n},position:{origin:i,placement:"bottom"}}),this._modalService.close("context-menu-modal")}}),e.registerItem({key:"insertFieldLeft",name:kf("向左插入列"),icon:"LeftArrow",hotkey:"",visible:({from:e})=>!this.isReadonly&&e===nre.HEADER,onClick:({initialState:e,position:t})=>{const r=this._readService.getActiveView(),{fieldId:n,originRect:i}=e;if(!t||!r)return;const o=(this._readService.getViewFields(r.uuid)||[]).find((e=>e.field_uuid===n));this._modalService.open("addOrUpdateField",{position:{origin:i,placement:"bottom"},initialState:{sourceFieldId:null==o?void 0:o.field_uuid,direction:"before"}}),this._modalService.close("context-menu-modal")}}),e.registerItem({key:"insertFieldRight",name:kf("向右插入列"),icon:"RightArrow",hotkey:"",visible:({from:e})=>!this.isReadonly&&e===nre.HEADER,onClick:({initialState:e,position:t})=>{const r=this._readService.getActiveView(),{fieldId:n,originRect:i}=e;if(!t||!r)return;const o=(this._readService.getViewFields(r.uuid)||[]).find((e=>e.field_uuid===n));this._modalService.open("addOrUpdateField",{position:{origin:i,placement:"bottom"},initialState:{sourceFieldId:null==o?void 0:o.field_uuid,direction:"after"}}),this._modalService.close("context-menu-modal")}}),e.registerItem({key:"removeField",name:kf("删除列"),icon:"Delete",hotkey:"",visible:({from:e,fieldId:t})=>{if(!t)return!1;const r=this._readService.getField(t);return!this.isReadonly&&e===nre.HEADER&&!Kh.isDeleteDisable(null==r?void 0:r.type)},onClick:async({initialState:e})=>{const{fieldId:t,disableDel:r}=e;r||(await this._commandService.execCommand("removeField",{fieldId:t}),this._modalService.close("context-menu-modal"))}})}_handleOpenFieldConfigCreateModal(e){this.isReadonly||this._modalService.open("addOrUpdateField",{position:{origin:e,placement:"bottom"}})}};qme.pluginName="workbench-add-field",Kme([to(tQ)],qme.prototype,"_modalService",2),Kme([to(Zj)],qme.prototype,"_renderService",2),Kme([to(Hw)],qme.prototype,"_abilityService",2),Kme([to(LA)],qme.prototype,"_workbenchContext",2),Kme([to(Dy)],qme.prototype,"_readService",2),Kme([to(Pb)],qme.prototype,"_commandService",2),qme=Kme([eo({contrib:[PA,rQ,Ese]})],qme);const Yme=()=>{const e=zA(Dy),t=zA(Pb),r=null==e?void 0:e.getAllViewFields(),n=(null==r?void 0:r.filter((e=>{var t;return(null==(t=e.field)?void 0:t.type)===Rh.IMAGE})))||[],i=null==e?void 0:e.getViewConfig();return{options:[{label:kf("无封面"),value:null,icon:s.a.createElement(YP,{type:"Clear",size:14})},...n.map((e=>{const t=e.field;return{label:null==t?void 0:t.name,value:null==t?void 0:t.uuid,icon:s.a.createElement(YP,{type:"FieldImage"})}}))],defaultValue:(null==i?void 0:i.cover_field_uuid)||null,onCoverSourceChange:r=>{var n;null==t||t.execCommand("updateCoverSource",{viewId:null==(n=null==e?void 0:e.getActiveView())?void 0:n.uuid,coverFieldId:r})}}},Xme=()=>{const{options:e,defaultValue:t,onCoverSourceChange:r}=Yme();return s.a.createElement("div",{className:"lakex-table-view-setting-wrap lakex-table-view-setting-cover-source"},s.a.createElement("span",{className:"lakex-table-view-setting-title"},kf("封面来源")),s.a.createElement(x.a,{defaultValue:t,dropdownClassName:"lakex-table-menu-container lakex-table-view-setting",onChange:r,suffixIcon:s.a.createElement(YP,{type:"ArrowDown",size:14})},e.map((e=>s.a.createElement(x.a.Option,{value:e.value,key:e.value,className:"column-select-option"},e.icon,e.label)))))},Zme=()=>{const e=zA(Dy),t=zA(Pb);return{options:[{label:kf("适应"),value:"fit"},{label:kf("裁剪"),value:"clip"}],coverDisplay:null==e?void 0:e.getViewConfig().cover_display,viewFields:(null==e?void 0:e.getViewFields())||[],onCoverDisplayChange:r=>{var n;null==t||t.execCommand("updateCoverDisplay",{viewId:null==(n=null==e?void 0:e.getActiveView())?void 0:n.uuid,coverDisplay:r})}}},Jme=()=>{const{options:e,onCoverDisplayChange:t,coverDisplay:r}=Zme();return s.a.createElement("div",{className:"lakex-table-view-setting-wrap lakex-table-view-setting-cover-display"},s.a.createElement("span",{className:"lakex-table-view-setting-title"},kf("封面效果")),s.a.createElement(m.a.Group,{options:e,onChange:e=>t(e.target.value),defaultValue:r,optionType:"button"}))},Qme=()=>{const e=zA(Dy),t=zA(Pb);return{viewConfig:null==e?void 0:e.getViewConfig(),onShowFieldChange:r=>{var n;null==t||t.execCommand("updateShowFieldName",{viewId:null==(n=null==e?void 0:e.getActiveView())?void 0:n.uuid,showFieldName:r})}}},eve=()=>{const{viewConfig:e,onShowFieldChange:t}=Qme();return s.a.createElement("div",{className:"lakex-table-view-setting-wrap lakex-table-view-setting-show-name"},s.a.createElement("span",{className:"lakex-table-view-setting-title"},kf("显示字段名")),s.a.createElement(S.a,{defaultChecked:null==e?void 0:e.show_field_name,onChange:t,size:"small"}))},tve=()=>{const e=zA(tD),t=zA(Pb),r=zA(tQ),n=h0()||[];return{readonly:s0(Nw.TABLE).isReadonly(),viewFields:n,onFieldHiddenChange:(e,r,n)=>{null==t||t.execCommand("updateFieldHidden",{viewId:e,fieldId:r,hidden:n})},openConfigMenu:(e,t,n)=>{null==r||r.open("view-field-action",{position:{origin:e.target,placement:"right"},initialState:{fieldId:t.field_uuid,fieldName:t.field.name,target:e.target,disableDel:n}})},fieldService:e}},rve=({readonly:e,viewField:t,disable:r,OrderDragIcon:n,onFieldHiddenChange:i,openConfigMenu:o})=>{const a=zA(Dy),l=zA(tD),{field:c,hidden:u,group_uuid:d}=t,{attributes:f,listeners:p,setNodeRef:h,transform:m,transition:v,isDragging:g}=zP({id:t.field_uuid}),y=c?null==l?void 0:l.getFieldIcon(c.type):null,b=c?null==l?void 0:l.getFieldTagComponent(c.type):null,w={transform:vN.Transform.toString(m),transition:v,zIndex:g?"100":"auto",opacity:g?.3:1},_=d?null==a?void 0:a.getViewFieldGroups(t.view_uuid).find((e=>e.uuid===d)):null;return c?s.a.createElement("div",{ref:e?void 0:h,className:"lakex-table-view-setting-field-item "+(u?"lakex-table-view-setting-disable":""),...f,style:w},n&&!e&&s.a.createElement("span",{className:"lakex-table-view-setting-drag-icon"},s.a.createElement(n,{listeners:p})),y?s.a.createElement(y,{className:"lakex-table-view-setting-field-icon"}):null,s.a.createElement("div",{className:"lakex-table-view-setting-field-name"},s.a.createElement("span",{className:"lakex-table-view-setting-field-name-content"},_?`${_.name}-${c.name}`:c.name),b?s.a.createElement(b,{field:c,position:"viewerSetting"}):null),s.a.createElement("span",{className:"lakex-table-view-setting-operation-icon"},!r&&s.a.createElement(YP,{type:u?"IconHide":"Preview",onClick:()=>i(t.view_uuid,t.field_uuid,!u)})),!e&&s.a.createElement(YP,{className:"lakex-table-config-container lakex-table-view-setting-operation-icon",type:"MoreHorizontal",onClick:e=>o(e,t,r)})):null},nve=()=>{const{readonly:e,viewFields:t,onFieldHiddenChange:r,openConfigMenu:n}=tve(),{onDragEnd:i,OrderDragIcon:o}=(e=>{const t=zA(Yre),{OrderDragIcon:r}=t,n=Object(a.useCallback)((async e=>{const{active:r,over:n}=e;r.id!==n.id&&await t.updateFieldOrder(r.id,n.id)}),[t,e]);return{OrderDragIcon:r,onDragEnd:n}})(t),l=TN(RN(SM,{activationConstraint:{distance:8}})),c=Object(a.useMemo)((()=>t.map((e=>({...e,id:e.field_uuid})))),[t]),u=t.filter((e=>!e.hidden));let d;return 1===u.length&&(d=u[0]),s.a.createElement("div",{className:"lakex-table-view-setting-fields"},s.a.createElement(aP,{sensors:l,modifiers:[KP,WP],collisionDetection:LN,onDragEnd:i},s.a.createElement(jP,{items:c,strategy:NP},t.map((t=>{const i=t.field;let a=(null==d?void 0:d.uuid)===t.uuid;return i?(Kh.isDeleteDisable(i.type)&&(a=!0),s.a.createElement(rve,{key:t.field_uuid,readonly:!!e,viewField:t,disable:a,OrderDragIcon:o,onFieldHiddenChange:r,openConfigMenu:n})):null})))))},ive=({settings:e=["fields"]})=>s.a.createElement("div",{className:"lakex-table-menu-container lakex-table-view-setting"},(null==e?void 0:e.includes("cover"))&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Xme,null),s.a.createElement(Jme,null),s.a.createElement("div",{className:"lakex-table-view-setting-hr"})),(null==e?void 0:e.includes("showField"))&&s.a.createElement(s.a.Fragment,null,s.a.createElement(eve,null),s.a.createElement("div",{className:"lakex-table-view-setting-hr"})),e.includes("fields")&&s.a.createElement(nve,null)),ove=({initialState:e})=>s.a.createElement("div",{className:"lakex-table-view-setting-modal"},s.a.createElement(ive,{settings:e.settings})),ave=({initialState:e})=>{const{items:t}=(({fieldId:e,fieldName:t,target:r,disableDel:n})=>{const i=zA(tQ),o=zA(Pb);return{items:[{key:"field-edit",icon:"Edit",name:kf("编辑"),onClick:()=>{null==i||i.close("view-field-action"),null==i||i.open("addOrUpdateField",{position:{origin:r,placement:"right"},initialState:{fieldId:e}})}},{key:"field-del",icon:"Delete",name:kf("删除"),onClick:()=>{n||(null==o||o.execCommand("removeField",{fieldId:e}),null==i||i.close("view-field-action"))}}]}})({fieldId:e.fieldId,fieldName:e.fieldName,target:e.target,disableDel:e.disableDel});return s.a.createElement(d.a,{mode:"vertical",className:"lakex-table-field-action"},t.map(((t,r)=>s.a.createElement(d.a.Item,{className:GA({disable:"field-del"===t.key&&e.disableDel}),key:t.key,icon:s.a.createElement("span",null,s.a.createElement(YP,{type:t.icon})),onClick:e=>{var r;null==(r=t.onClick)||r.call(t,e)}},kf(t.name)))))},sve=()=>{const{options:e,defaultValue:t}=Yme(),r=zA(tQ),n=Object(a.useMemo)((()=>[{key:"cover-source",title:kf("封面来源"),options:e,defaultValue:t}]),[e,t]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(hue,{list:n,onSelect:e=>{r.open("view-field-cover-source",{position:{placement:"bottom"},initialState:{options:e.options,defaultValue:e.defaultValue}})}}))},lve=()=>{const{options:e,onCoverDisplayChange:t,coverDisplay:r}=Zme(),n=Object(a.useMemo)((()=>[{key:"cover-display",title:kf("封面效果"),options:e,defaultValue:r||"clip"}]),[e,r]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(pue,{list:n,onChoose:(e,r)=>{t(r.value)}}))},cve=()=>{const{viewConfig:e,onShowFieldChange:t}=Qme(),r=Object(a.useMemo)((()=>[{key:e.uuid,title:kf("显示字段名"),checked:!!e.show_field_name}]),[e]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(due,{list:r,onSwitch:(e,r)=>{t(r)}}))},uve=()=>{const{viewFields:e,onFieldHiddenChange:t,fieldService:r}=tve(),n=e.filter((e=>!e.hidden));let i;1===n.length&&(i=n[0]);const o=Object(a.useMemo)((()=>e.map((e=>{const t=e.field;if(!t)return null;const n=(null==r?void 0:r.getFieldIcon(t.type))||null,o=e.hidden;let a=(null==i?void 0:i.uuid)===e.uuid;return Kh.isDeleteDisable(t.type)&&(a=!0),{key:e.uuid,title:t.name,checked:!o,icon:n?s.a.createElement(n,null):null,disabled:a}})).filter((e=>!!e))),[e]);return s.a.createElement("div",{className:"lakex-table-view-setting-fields"},s.a.createElement(due,{list:o,onSwitch:(r,n)=>{const i=e.find((e=>e.uuid==r.key));i&&t(i.view_uuid,i.field_uuid,!n)}}))},dve=({settings:e=["fields"]})=>s.a.createElement("div",{className:"lakex-table-h5-viewer-setting"},(null==e?void 0:e.includes("cover"))&&s.a.createElement(s.a.Fragment,null,s.a.createElement(sve,null),s.a.createElement(lve,null)),(null==e?void 0:e.includes("showField"))&&s.a.createElement(s.a.Fragment,null,s.a.createElement(cve,null)),e.includes("fields")&&s.a.createElement(uve,null)),fve=({initialState:e})=>{const t=zA(tQ);return s.a.createElement(s.a.Fragment,null,s.a.createElement(sue,{title:e.title,onClose:()=>{t.close("view-field-setting")},showCloseIcon:!0},s.a.createElement(dve,{settings:e.settings})))},pve=({initialState:e})=>{const{onCoverSourceChange:t}=Yme(),r=zA(tQ),n=()=>{r.close("view-field-cover-source")},i=Object(a.useMemo)((()=>e.options.map((e=>({key:e.value||"",icon:e.icon,title:e.label||""})))),[e.options]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(sue,{title:kf("请选择"),onClose:n,showCloseIcon:!0},s.a.createElement(fue,{defaultValue:e.defaultValue||"",list:i,onCheck:e=>{t(e.key),n()}})))};var hve=Object.defineProperty,mve=Object.getOwnPropertyDescriptor,vve=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?mve(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&hve(t,r,o),o};let gve=class{constructor(){this._getTitlte=()=>{const e=this._readService.getActiveView();return(null==e?void 0:e.type)===Wh.GRID?kf("表格配置"):(null==e?void 0:e.type)===Wh.CARD?kf("画册配置"):(null==e?void 0:e.type)===Wh.KANBAN?kf("看板配置"):""}}static pluginModule(){return bo().register(this)}init(){}registerToolbar(e){e.registerItem({id:"view-field-setting",icon:"Setting",tooltip:this._getTitlte,visible:()=>{const e=this._readService.getActiveView();return[Wh.GRID,Wh.CARD,Wh.KANBAN].includes(null==e?void 0:e.type)},onClick:e=>{const t=e.target;this._modalService.open("view-field-setting",{position:{origin:t,placement:"bottom"},initialState:this._getInitstate()})}})}registerModal(e){const t=this._configuration.getValue("modal.mode"),r=this._configuration.getValue("render.mode");e.registerItem({id:"view-field-setting",mode:t,hasMask:t===eQ.DRAWER,hasAnimation:t===eQ.DRAWER,position:t===eQ.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:r===Pj.MOBILE?fve:ove}),r===Pj.MOBILE&&e.registerItem({id:"view-field-cover-source",mode:eQ.DRAWER,hasMask:!0,hasAnimation:!0,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:pve}),e.registerItem({id:"view-field-action",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:ave})}_getInitstate(){const e=this._readService.getActiveView();return(null==e?void 0:e.type)===Wh.GRID?{settings:["fields"],title:this._getTitlte()}:(null==e?void 0:e.type)===Wh.CARD?{settings:["cover","showField","fields"],title:this._getTitlte()}:(null==e?void 0:e.type)===Wh.KANBAN?{settings:["showField","fields"],title:this._getTitlte()}:{}}};gve.pluginName="workbench-viewer-field-setting",vve([to(Dy)],gve.prototype,"_readService",2),vve([to(tQ)],gve.prototype,"_modalService",2),vve([to(qf)],gve.prototype,"_configuration",2),gve=vve([eo({contrib:[PA,IJ,rQ]})],gve);var yve=Object.defineProperty,bve=Object.getOwnPropertyDescriptor,wve=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?bve(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&yve(t,r,o),o};let _ve=class{static pluginModule(){return bo().register(this)}get isReadonly(){return this._abilityService.isReadonly(Nw.TABLE)}init(){}registerContextMenu(e){e.registerItem({key:"editFieldGroup",name:kf("修改分组名称"),hotkey:"",visible:({from:e})=>!this.isReadonly&&e===nre.GROUP_HEADER,onClick:({initialState:e})=>{this._fieldGroupService.emitEdit(e.fieldGroupId),this._modalService.close("context-menu-modal")}}),e.registerItem({key:"removeFieldGroup",name:kf("取消分组"),hotkey:"",visible:({from:e})=>!this.isReadonly&&e===nre.GROUP_HEADER,onClick:({initialState:e})=>{this._commandService.execCommand("removeFieldGroup",{fieldGroupId:e.fieldGroupId}),this._modalService.close("context-menu-modal")}}),e.registerItem({key:"addFieldGroup",name:kf("合并为分组"),hotkey:"",visible:({from:e})=>!this.isReadonly&&e===nre.MULTI_CELL,onClick:({initialState:e})=>{const{selection:t}=e;if(!t)return;const{start:r,end:n}=t.getRangeAt(0),i=this._readService.getViewFields(),o=null==i?void 0:i.slice(r.column,n.column+1).map((e=>e.field_uuid));this._commandService.execCommand("addFieldGroup",{fieldIds:o}),this._modalService.close("context-menu-modal")}})}};_ve.pluginName="workbench-field-group",wve([to(tQ)],_ve.prototype,"_modalService",2),wve([to(Pb)],_ve.prototype,"_commandService",2),wve([to(Hw)],_ve.prototype,"_abilityService",2),wve([to(Dy)],_ve.prototype,"_readService",2),wve([to(mne)],_ve.prototype,"_fieldGroupService",2),_ve=wve([eo({contrib:[PA,Ese]})],_ve);const Cve=({initialState:e})=>{const t=zA(Uj),r=zA(_3),[n,i]=Object(a.useState)(e.x),[o,l]=Object(a.useState)(0);return Object(a.useEffect)((()=>{const e=r.onResize((({x:e})=>{i(e)}));return()=>{e.destroy()}}),[]),Object(a.useEffect)((()=>{const e=t.$root.getBoundingClientRect().height;l(e||"100%")}),[t]),s.a.createElement("div",{className:"lakex-grid-column-resize-line",style:{transform:`translateX(${n}px)`,height:o}})};var Eve=Object.defineProperty,xve=Object.getOwnPropertyDescriptor,Sve=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?xve(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Eve(t,r,o),o};let kve=class{constructor(){this._columnControllerModalId="grid-column-controller"}static pluginModule(){return bo().register(this)}get isReadonly(){return this._abilityService.isReadonly(Nw.TABLE)}init(){this._columnControllerService.onResizeStart((({x:e})=>{const{left:t,top:r}=this._renderContext.$root.getBoundingClientRect();this._modalService.open(this._columnControllerModalId,{position:{left:t,top:r},initialState:{x:e}})})),this._columnControllerService.onResizeEnd((()=>{this._modalService.close(this._columnControllerModalId)}))}registerModal(e){e.registerItem({id:this._columnControllerModalId,hasMask:!1,scrollStrategy:"close",zIndex:"modalFromRender",RenderComponent:Cve})}};kve.pluginName="workbench-viewer-grid",Sve([to(tQ)],kve.prototype,"_modalService",2),Sve([to(_3)],kve.prototype,"_columnControllerService",2),Sve([to(Uj)],kve.prototype,"_renderContext",2),Sve([to(Hw)],kve.prototype,"_abilityService",2),kve=Sve([eo({contrib:[PA,rQ]})],kve);const Ove=e=>{const t=Object(a.useRef)(null);Object(a.useEffect)((()=>{var e;const r=e=>{e.preventDefault(),e.stopPropagation()};return null==(e=t.current)||e.addEventListener("wheel",r,{passive:!1}),()=>{var e;null==(e=t.current)||e.removeEventListener("wheel",r)}}),[e.visible]);const r=t=>{t.preventDefault(),e.onBeforeEndEdit(t)};return e.visible?s.a.createElement("div",{className:"lakex-mask-in-cell-editor",onClick:r,ref:t,onContextMenu:r}):null},Ive=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{const{editing:r,style:n,fieldType:i,isMultiText:o,onBlur:l,onChange:c,onSave:u}=e,d=Object(a.useRef)(null),f=zA(S3),p=zA(M3),h=zA(e3),[m,v]=Object(a.useState)(!1);Object(a.useImperativeHandle)(t,(()=>({focus:()=>{var e;null==(e=d.current)||e.focus()},blur:()=>{var e;null==(e=d.current)||e.blur()},onEndEdit:async e=>{await g(e)},onStartEdit:e=>{b(e)},getValue:()=>{var e;return null==(e=d.current)?void 0:e.getValue()}})));const g=async e=>{var t,r;if(!e){const e=String(null==(t=d.current)?void 0:t.getValue()),n=null==(r=null==e?void 0:e.trim)?void 0:r.call(e);await(null==u?void 0:u(n))}setTimeout((()=>{var e,t;null==(e=d.current)||e.focus(),null==(t=d.current)||t.clearValue()}),30)},y=Object(a.useCallback)((t=>{e.toggleEditing(!1);const r=null==p?void 0:p.getCellIndexesByClientXY(t.clientX,t.clientY);r&&So((()=>{const e=null==h?void 0:h.createGridSelectionByIndex(r[0],r[1]);e&&(null==h||h.setSelection(e))}))}),[r]),b=t=>{var r,n,i;if(void 0===t)return;const o=(null==(r=e.getFormattedValue)?void 0:r.call(e,t))||t;null==(n=d.current)||n.setValue(o),null==(i=d.current)||i.setCursorToEnd(),So((()=>{null==p||p.updateCellCoordsInViewPort()}))},w=Object(a.useMemo)((()=>{if(!o){const e=null==f?void 0:f.rowHeightSize;return{...n,minHeight:e,height:e}}return n}),[o,n]),_={className:`textarea-cell ${i}`,ref:d,onKeyDown:t=>{var n;const o=t.shiftKey,a=t.key,s=a===jx.ENTER;if(!m){if(s)if(r&&o)document.execCommand("insertText",!1,"\n"),null==(n=d.current)||n.blur(),setTimeout((()=>{var e;null==(e=d.current)||e.focus()}),0);else if(!o){if(i===Rh.LINK&&!r)return;e.toggleEditing(!0)}a===jx.TAB&&r&&(t.preventDefault(),e.toggleEditing(!1))}},onCompositionStart:()=>{v(!0)},onCompositionEnd:()=>{v(!1)},onChange:e=>{const t=e.target.value;c&&c(t)},readOnly:!1,onBlur:()=>{l&&l()},maxRows:6};return s.a.createElement(s.a.Fragment,null,s.a.createElement(Ove,{visible:r,onBeforeEndEdit:y}),s.a.createElement("div",{className:"lakex-table-text-editor",style:{...w}},s.a.createElement(YA,{allowEnter:o,..._})))})));function Rve(e){const{editing:t}=e,r=zA(NQ),n=c3(t),i=Object(a.useRef)(null),[o,s,l]=yV();return Object(a.useLayoutEffect)((()=>{t&&i.current?s(i.current):l()}),[i,t]),{editorRelativeLayout:Object(a.useMemo)((()=>{const e={position:"absolute",left:0};if(!n)return e.width=0,e;const t=Math.round((null==o?void 0:o.height)||0),i=Math.floor((null==r?void 0:r.getRenderViewPort().height)||0);return Math.floor(n.top+t+4)>i?e.bottom=0:e.top=n.height+4,e}),[t,o,n]),editorWrapperRef:i}}const Tve=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{const{editing:r,style:n,fieldType:i,inputObserverRef:o}=e,l=m0(e.recordId,e.fieldId),c=f0(e.fieldId),u=s0(Nw.FIELD).canUpdate(c),d=Object(a.useMemo)((()=>i===Rh.MULTI_SELECT),[i]),f=zA(Zj),p=Object(a.useMemo)((()=>{const e=(null==l?void 0:l.value)||[];return Array.isArray(e)?e:[e]}),[d,null==l?void 0:l.value]),h=(null==c?void 0:c.options)||[],{editorRelativeLayout:m,editorWrapperRef:v}=Rve({editing:r});Object(a.useImperativeHandle)(t,(()=>({focus:()=>{var e;null==(e=o.current)||e.focus()},blur:()=>{var e;null==(e=o.current)||e.blur()},onEndEdit:async e=>{var t;null==(t=o.current)||t.focus()}}))),Object(a.useEffect)((()=>{const t=null==f?void 0:f.onClickCellIcon((t=>{"cellSelectIcon"===t.iconName&&e.toggleEditing()}));return()=>{null==t||t.destroy()}}),[]);const g=async e=>{const t=p.includes(e.uuid);if(d){const r=t?p.filter((t=>t!==e.uuid)):p.concat(e.uuid);return await(null==l?void 0:l.setCell(r.map((e=>({value:e})))))}return await(null==l?void 0:l.setCell(t?"":e.uuid))},y=mV((async t=>{!r||(await g(t),d||e.toggleEditing())})),b=mV((e=>{const t=h.filter((t=>t.uuid!==e));null==c||c.updateProperty({options:t})})),w=mV((async t=>{if(!r)return;const n=h.concat(t);await(null==c?void 0:c.updateProperty({options:n})),g(t),d||e.toggleEditing()})),_=mV((e=>{const t=h.map((t=>t.uuid===e.uuid?e:t));null==c||c.updateProperty({options:t})}));return c&&Kh.isSelectLike(i)?s.a.createElement("div",{className:"lakex-grid-cell-editor-keyboard-input",ref:v,style:{...n,...m,maxWidth:"fit-content"},onKeyDown:t=>{t.key===jx.ENTER&&!t.shiftKey&&!r&&e.toggleEditing(!0)}},s.a.createElement(cJ,{inputRef:o,visible:r,focus:!1,colorable:!!c.color,options:c.options||[],activeId:null==p?void 0:p[0],editable:!0,optionEditable:u,selectedIds:p,onOptionCreate:w,onOptionChange:_,onOptionDelete:b,onOptionSelect:y})):null}))),Ave=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{const{editing:r,style:n,inputObserverRef:i}=e,o=e.cellValue||[],l=m0(e.recordId,e.fieldId),c=zA(Zj),{editorRelativeLayout:u,editorWrapperRef:d}=Rve({editing:r});Object(a.useImperativeHandle)(t,(()=>({focus:()=>{var e;null==(e=i.current)||e.focus()},blur:()=>{var e;null==(e=i.current)||e.blur()},onEndEdit:async e=>{var t;null==(t=i.current)||t.focus()}})));const f=mV((async e=>{if(r)return await(null==l?void 0:l.setCell(e.map((e=>e))))}));Object(a.useEffect)((()=>{const t=null==c?void 0:c.onClickCellIcon((t=>{"cellMentionIcon"===t.iconName&&e.toggleEditing()}));return()=>{null==t||t.destroy()}}),[]);return s.a.createElement("div",{className:"lakex-grid-cell-editor-keyboard-input",ref:d,style:{...n,...u,maxWidth:"fit-content"},onKeyDown:t=>{t.key===jx.ENTER&&!t.shiftKey&&!r&&e.toggleEditing(!0)}},s.a.createElement(YZ,{focus:!1,visible:r,inputRef:i,selected:o,onSelect:e=>{const t=o.concat(e);f(t)},onUnselect:e=>{const t=o.filter((t=>t.uid!==e.uid));f(t)}}))}))),Nve={width:0,height:1,border:"none",padding:0,boxShadow:"none",overflowX:"hidden",overflowY:"hidden"};const Mve=["viewerGridCellEditor","tooltip","ai-writing-autofill-cell"],Pve=(e=>t=>{const r=l3(),n=t3();return s.a.createElement(e,{selection:n,activeCell:r})})(Object(a.memo)((e=>{const{activeCell:t,selection:r}=e,n=f0((null==t?void 0:t.fieldId)||""),i=zA(Zj),o=zA(uj),l=zA(tQ),c=zA(ple),u=zA(e3),d=zA(g3),f=zA(bse,{optional:!0}),[p,h]=Object(a.useState)(!1),m=null==n?void 0:n.type,g=null==t?void 0:t.recordId,y=null==t?void 0:t.fieldId,b=m0(g,y),w=Object(a.useRef)(null),_=null==b?void 0:b.value,C=Object(a.useRef)(null),E=zA(tD),x=zA(qde),S=zA(Dy),k=c3(p),O=function(e){const{editing:t,width:r,height:n}=e;return Object(a.useMemo)((()=>t?r&&n?{width:r,minHeight:n}:{}:Nve),[t,r,n])}({editing:p,width:(null==k?void 0:k.width)||0,height:(null==k?void 0:k.height)||0}),I=Object(a.useMemo)((()=>{const e=(null==l?void 0:l.visibleList)||[];return!((e.length||0)>Mve.length)&&!(e.some((e=>!Mve.includes(e)))||null!=x&&x.isInSearching)}),[null==l?void 0:l.visibleList]),R=Object(a.useCallback)((()=>{var e;const t=w.current;!t||!I||null==(e=t.focus)||e.call(t)}),[I]),T=mV((()=>{(Kh.isString(m)||Kh.isSelectLike(m)||Kh.isNumber(m)||Kh.isMention(m))&&A(!0)}));Object(a.useEffect)((()=>{const e=null==i?void 0:i.onDoubleClickCell((e=>{T()})),t=null==i?void 0:i.onClickEvent((e=>{"activeCellClick"===e.eventName&&R()}));return()=>{null==e||e.destroy(),null==t||t.destroy()}}),[]),Object(a.useEffect)((()=>{null==c||c.emitEditingChange({recordId:g,fieldId:y,editing:p})}),[p]);const A=Object(a.useCallback)(((e=!1)=>{var t;const r=w.current;!r||p||!I||(h(!0),null==(t=r.onStartEdit)||t.call(r,e?_:void 0),R())}),[_,w,R,p,I]),N=mV(((e=!1)=>{var t,r;const n=w.current;if(!p||!n)return;const i=null==(t=null==n?void 0:n.getValue)?void 0:t.call(n);let o="",a=e;if(i){o=E.cellValueChecker(m,i),o&&L(o);const e=E.getFieldIsStrictValidatedValue(m)&&o;a||(a=e)}null==(r=null==n?void 0:n.onEndEdit)||r.call(n,a),h(!1)}));Object(a.useEffect)((()=>{const e=null==i?void 0:i.onScroll((e=>{null==l||l.close("tooltip"),N()}));return()=>{null==e||e.destroy()}}),[N]);const M=Object(a.useCallback)((e=>{var t;if(p)N();else if(e){if(S.getViewGroup()){const e=(null==(t=S.getRecordById(g||""))?void 0:t.group_item_key)||(null==d?void 0:d.UNGROUP_KEY),r=null==f?void 0:f.groupFolding;e&&(null==r?void 0:r.has(e))&&(null==f||f.setGroupFolding(e,!1))}u?null==u||u.scrollToAnchorPosition(u.getSelection(),"start",(()=>{A(!0)})):requestAnimationFrame((()=>{A(!0)}))}else A(!0)}),[p,A,N]);Object(a.useEffect)((()=>{const e=()=>N();return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)}),[N]),Object(a.useEffect)((()=>{const e=setTimeout((()=>{1===(null==r?void 0:r.rangeCount)&&(h(!1),R())}),50);return()=>{clearTimeout(e)}}),[r]);const P=Object(a.useCallback)((e=>m===Rh.LINK?(null==e?void 0:e.name)||"":m===Rh.DATE?Td(e||"").format("YYYY-MM-DD"):""),[m]),j=Object(a.useCallback)((e=>{p||(e.persist(),null==o||o.fireEventByEditable(e,"copy"))}),[p]),D=Object(a.useCallback)((e=>{p||(e.persist(),null==o||o.fireEventByEditable(e,"paste"))}),[p]),F=Object(a.useCallback)((e=>{p||(e.persist(),null==o||o.fireEventByEditable(e,"cut"))}),[p]),V=Object(a.useCallback)((async e=>{!p||od(e,_)||await(null==b?void 0:b.setCell(e))}),[p,_]),L=mV((e=>{!k||null==l||l.showTooltip(e,{origin:k,placement:"top"})}));return t&&n&&m&&y&&g?s.a.createElement("div",{className:"lakex-table-cell-editor-container lakex-grid-cell-editor-keyboard-input",style:{position:"absolute",left:(null==k?void 0:k.left)||0,top:(null==k?void 0:k.top)||0},onKeyDown:async e=>{const t=e.keyCode||e.which;p?(mA(e),e.key==jx.ESC&&N(!1),83===t&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&(e.preventDefault(),await N(!1),v.a.success(kf("文档已保存")))):function(e){const{metaKey:t,ctrlKey:r}=e,{keyCode:n}=e;return!t&&!r&&32!==n&&(n>=65&&n<=90||n>=48&&n<=57||n>=96&&n<=105||n>=186&&n<=192||n>=219&&n<=222||n>=106&&n<=111||32===n||61===n||173===n||(229===n||0===n)&&"Shift"!==e.key)}(e)?A():null==o||o.fireEventByEditable(e.nativeEvent)},onMouseDown:mA,onMouseUp:mA,onMouseMove:mA,onCopy:j,onCut:F,onPaste:D},function(){if(!(t&&n&&m&&y&&g))return null;const e={onSave:V,fieldType:m,editing:p,style:O,inputObserverRef:C};switch(m){case Rh.TITLE:case Rh.TEXT:return s.a.createElement(Ive,{isMultiText:m===Rh.TEXT,ref:w,toggleEditing:M,...e});case Rh.NUMBER:case Rh.PHONE:case Rh.EMAIL:return s.a.createElement(Ive,{isMultiText:!1,ref:w,toggleEditing:M,...e});case Rh.LINK:return s.a.createElement(Ive,{isMultiText:!1,getFormattedValue:P,ref:w,...e,onSave:async e=>{var t;const r={src:(null==(t=null==b?void 0:b.value)?void 0:t.src)||`http://${e}`,name:e};await V(r)},toggleEditing:M});case Rh.SELECT:case Rh.MULTI_SELECT:return s.a.createElement(Tve,{ref:w,fieldId:y,recordId:g,toggleEditing:M,...e});case Rh.MENTION:return s.a.createElement(Ave,{ref:w,fieldId:y,recordId:g,toggleEditing:M,cellValue:_,...e});case Rh.DATE:return s.a.createElement(Ive,{isMultiText:!1,getFormattedValue:P,ref:w,...e,onSave:async e=>{const t=(e=>{let t=e;return""===e?"":(Mo(e)&&4===e.length&&/^(0[1-9]|1[0-2]).*(0[1-9]|[12][0-9]|3[01])/g.test(e)&&(t=Td().year()+e),Td(t).format("YYYY-MM-DD"))})(e||"");await V(t)},toggleEditing:M});default:return null}}()):null}))),jve={[Rh.IMAGE]:zZ,[Rh.FILE]:BZ},Dve=e=>{const t=e.initialState||{},{fieldType:r,recordId:n,fieldId:i}=t,o=zA(tQ),l=zA(Pb),{fieldUriModel:c}=zA(Ov),u=m0(n,i),d=null==u?void 0:u.value,f=Object(a.useMemo)((()=>r===Rh.IMAGE?kf("图片列表"):r===Rh.FILE?kf("附件列表"):null),[r]),p={style:{width:520},defaultValue:d,onChange:e=>{null==l||l.execCommand("setCell",{...u,value:e})},onOrderChange:({targetUid:e,sourceUid:t})=>{var o,a;const s=null==(o=c.findOne({uid:e}))?void 0:o.uuid,u=null==(a=c.findOne({uid:t}))?void 0:a.uuid;null==l||l.execCommand("updateValueOrder",{fieldId:i,fieldType:r,recordId:n,targetValueId:s,sourceValueId:u})}};if(![Rh.IMAGE,Rh.FILE].includes(r))return null;const h=jve[r];return s.a.createElement("div",{className:"lakex-table-cell-file-uploader"},s.a.createElement("div",{className:"file-uploader-header"},s.a.createElement("h4",{className:"file-uploader-header-title"},f),s.a.createElement(YP,{type:"Close",className:"file-uploader-close",onClick:e=>{null==o||o.close("fileOrImageManageModal")}})),s.a.createElement(h,{...p}))},Fve=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{const r=l3(),n=m0(null==r?void 0:r.recordId,null==r?void 0:r.fieldId),i=zA(tQ),o=Object(a.useRef)(null);Object(a.useImperativeHandle)(t,(()=>({onCloseByClickAwayOrScroll:()=>{var e;const t=null==(e=o.current)?void 0:e.getValues();t&&(null==n||n.setCell(t))}})));const l=()=>{null==i||i.close("cellLinkDropDownEditor")};return(null==n?void 0:n.fieldType)!==Rh.LINK?null:s.a.createElement(SJ,{ref:o,defaultValue:n.value,onSubmit:e=>{null==n||n.setCell(e),setTimeout((()=>{l()}),100)},onBlur:l})}))),Vve=e=>{const t=l3(),r=c3(!0),n=m0(null==t?void 0:t.recordId,null==t?void 0:t.fieldId),i=zA(tQ),[o,l]=Object(a.useState)(null==t?void 0:t.value);return s.a.createElement(YX,{className:"cell-date-dropdown-editor",focus:!0,open:!0,defaultValue:o||"",onChange:async e=>{l(e),await(null==n?void 0:n.setCell(e)),null==i||i.close("cellDateDropDownEditor")},rectStyle:{width:null==r?void 0:r.width,height:null==r?void 0:r.height}})};var Lve=Object.defineProperty,$ve=Object.getOwnPropertyDescriptor,Bve=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?$ve(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Lve(t,r,o),o};let zve=class{constructor(){this._gridCellEditorId="viewerGridCellEditor",this._toDestroyCollection=new ep}static pluginModule(){return bo().register(this)}get isGridView(){var e;return(null==(e=this._readService.getActiveView())?void 0:e.type)===Wh.GRID}get isReadonly(){return this._abilityService.isReadonly(Nw.TABLE)}_hasSelection(){var e;return null==(e=this._selectionService)?void 0:e.hasSelection()}init(){var e;if(this.isReadonly)return;const t=null==(e=this._selectionService)?void 0:e.onChange((()=>{this._hasSelection()&&this.isGridView?this._modalService.isModalVisible(this._gridCellEditorId)||this._modalService.open(this._gridCellEditorId,{position:{left:0,top:0}}):this._modalService.close(this._gridCellEditorId)}));t&&this._toDestroyCollection.push(t),this._toDestroyCollection.push(this._renderService.onClickCellIcon((e=>{var t,r;if("cellLinkIcon"===e.iconName)this._handleOpenCellLinkDropdownEditor();else if("cellImageIcon"===e.iconName){const e=null==(t=this._selectionService)?void 0:t.getFieldValue();this._handleOpenCellFileEditor(Rh.IMAGE,null==e?void 0:e.recordId,null==e?void 0:e.fieldId)}else if("cellFileIcon"===e.iconName){const e=null==(r=this._selectionService)?void 0:r.getFieldValue();this._handleOpenCellFileEditor(Rh.FILE,null==e?void 0:e.recordId,null==e?void 0:e.fieldId)}}))),this._toDestroyCollection.push(this._renderService.onDoubleClickCell((e=>{var t;if(e.fieldType===Rh.LINK)this._handleOpenCellLinkDropdownEditor();else if(e.fieldType===Rh.DATE)this._handleOpenCellDateDropdownEditor();else if(e.fieldType===Rh.IMAGE||e.fieldType===Rh.FILE){const r=null==(t=this._selectionService)?void 0:t.getFieldValue();this._handleOpenCellFileEditor(e.fieldType,null==r?void 0:r.recordId,null==r?void 0:r.fieldId)}})))}registerModal(e){e.registerItem({id:this._gridCellEditorId,hasMask:!1,scrollStrategy:"close",zIndex:"modalRenderBase",disableClickAwayClose:!0,disableEscClose:!0,RenderComponent:Pve}),e.registerItem({id:"fileOrImageManageModal",hasMask:!0,hasAnimation:!0,scrollStrategy:"block",zIndex:"modalFromRender",position:{left:"50%",top:"50%"},RenderComponent:Dve}),e.registerItem({id:"cellLinkDropDownEditor",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromRender",RenderComponent:Fve}),e.registerItem({id:"cellDateDropDownEditor",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromRender",RenderComponent:Vve})}registerHotkey(e){e.registerItem({id:"enterToCellEditor",hotkey:"enter",name:"enter进入单元格编辑",enableOnInput:!1,isEnable:()=>!this.isReadonly&&this._hasSelection()&&this.isGridView,onHotKey:e=>{var t,r,n;e.preventDefault();const i=null==(t=this._selectionService)?void 0:t.getFieldValue(),o=(null==i?void 0:i.fieldId)||"",a=(null==i?void 0:i.recordId)||"",s=null==(r=this._readService.getField(o))?void 0:r.type;if(s===Rh.CHECKBOX){const e=null==(n=this._readService.getCell(o,a))?void 0:n.value,t={...i,value:!e};(async()=>{var e,r,n;const i=this._readService.getActiveView(),a=null==(e=this._refreshEventService)?void 0:e.getRefreshType((null==i?void 0:i.uuid)||"",o);a?null==(r=this._commandService)||r.execDeferCommand("setCell",t,a):await(null==(n=this._commandService)?void 0:n.execCommand("setCell",t))})()}[Rh.IMAGE,Rh.FILE].includes(s)&&this._handleOpenCellFileEditor(s,null==i?void 0:i.recordId,null==i?void 0:i.fieldId),s===Rh.LINK&&this._handleOpenCellLinkDropdownEditor()}}),e.registerItem({id:"deleteCell",hotkey:"del, backspace",name:"清空单元格",enableOnInput:!1,isEnable:()=>this._hasSelection()&&this.isGridView&&!this.isReadonly,onHotKey:async e=>{var t,r;e.preventDefault();const n=((null==(t=this._selectionService)?void 0:t.getFieldValues())||[]).map((e=>({...e,value:""})));await(null==(r=this._commandService)?void 0:r.execCommand("removeCells",{cells:n}))}}),e.registerItem({id:"openCellLinkEditor",hotkey:"⌘+K",name:"打开单元格链接编辑器",enableOnInput:!0,isEnable:()=>this._hasSelection()&&this.isGridView&&!this.isReadonly,onHotKey:async e=>{var t,r;e.preventDefault();const n=null==(t=this._selectionService)?void 0:t.getFieldValue(),i=(null==n?void 0:n.fieldId)||"";(null==(r=this._readService.getField(i))?void 0:r.type)===Rh.LINK&&this._handleOpenCellLinkDropdownEditor()}})}_handleOpenCellLinkDropdownEditor(){var e;const t=null==(e=this._selectionService)?void 0:e.getSelectFocusTarget();this._modalService.open("cellLinkDropDownEditor",{position:{origin:t,placement:"bottom"}})}_handleOpenCellFileEditor(e,t,r){this._modalService.open("fileOrImageManageModal",{initialState:{fieldType:e,recordId:t,fieldId:r}})}_handleOpenCellDateDropdownEditor(){var e;const t=null==(e=this._selectionService)?void 0:e.getSelectAnchorTarget();this._modalService.open("cellDateDropDownEditor",{position:{origin:t,placement:"cover"}})}destroy(){this._toDestroyCollection.destroy()}};zve.pluginName="workbench-viewer-grid-cell-editor",Bve([to(e3),Mx()],zve.prototype,"_selectionService",2),Bve([to(Dy)],zve.prototype,"_readService",2),Bve([to(Hw)],zve.prototype,"_abilityService",2),Bve([to(tQ)],zve.prototype,"_modalService",2),Bve([to(Zj)],zve.prototype,"_renderService",2),Bve([to(Pb)],zve.prototype,"_commandService",2),Bve([to(By)],zve.prototype,"_refreshEventService",2),zve=Bve([eo({contrib:[PA,rQ,H2]})],zve);const Uve=({className:e,defaultValue:t="",onFieldSelect:r=(()=>{})})=>{const{groupFields:n,groupMap:i}=(e=>{const t=zA(Dy),r=null==t?void 0:t.getActiveView(),n=null==t?void 0:t.getViewFields(null==r?void 0:r.uuid,!1),i=null==n?void 0:n.filter((t=>{var r,n;return!(!e.defaultValue||(null==(r=t.field)?void 0:r.uuid)!==e.defaultValue)||Kh.isGroup(null==(n=t.field)?void 0:n.type)})),o=null==t?void 0:t.getViewFieldGroups(null==r?void 0:r.uuid);return{groupFields:i,groupMap:Object(a.useMemo)((()=>{const e={};return null==o||o.forEach((t=>{e[t.uuid]=t})),e}),[o])}})({defaultValue:t}),o=zA(tD);return s.a.createElement(x.a,{className:`lakex-table-group-field-select ${e}`,defaultValue:t,dropdownClassName:"lakex-table-group-field-select-dropdown",suffixIcon:s.a.createElement(YP,{type:"ArrowDown",size:14}),onChange:e=>{const t=null==n?void 0:n.find((t=>{var r;return(null==(r=t.field)?void 0:r.uuid)===e}));r(null==t?void 0:t.field)},bordered:!1},null==n?void 0:n.map((e=>{var t,r,n,a,l;const c=null==o?void 0:o.getFieldIcon(null==(t=e.field)?void 0:t.type);return s.a.createElement(x.a.Option,{value:null==(r=e.field)?void 0:r.uuid,key:null==(n=e.field)?void 0:n.uuid},c&&s.a.createElement(c,null),s.a.createElement("div",{className:"lakex-table-group-field-select-name"},e.group_uuid?`${i[e.group_uuid].name}-${null==(a=e.field)?void 0:a.name}`:null==(l=e.field)?void 0:l.name))})))},Hve="lakex-table-group-modal-empty",Wve=({onAddOption:e=(()=>{})})=>s.a.createElement("div",{className:Hve},s.a.createElement("div",{className:`${Hve}-empty-desc`},kf("还未设置任何分组")),s.a.createElement(Uve,{defaultValue:kf("选择一列进行分组"),onFieldSelect:e})),Gve=e=>{switch(e){case"select":case"multiSelect":return{asc:kf("选项顺序"),desc:kf("选项倒序")};case"number":case"phone":return{asc:kf("从小到大"),desc:kf("从大到小")};default:return{asc:kf("升序"),desc:kf("降序"),style:{padding:"0 16px"}}}},Kve=({group:e,field:t,onUpdateType:r=(()=>{})})=>{if(!t)return null;if(Kh.isCheckbox(t.type))return s.a.createElement(m.a.Group,{defaultValue:e.type,onChange:e=>{r(e.target.value)}},s.a.createElement(m.a.Button,{value:"asc"},s.a.createElement("span",{className:"lakex-table-group-field-order-radio"},s.a.createElement(p.a,{checked:!1},s.a.createElement(YP,{type:"RightArrow"})),s.a.createElement(p.a,{checked:!0}))),s.a.createElement(m.a.Button,{value:"desc"},s.a.createElement("span",{className:"lakex-table-group-field-order-radio"},s.a.createElement(p.a,{checked:!0},s.a.createElement(YP,{type:"RightArrow"})),s.a.createElement(p.a,{checked:!1}))));const n=Gve(t.type);return s.a.createElement(m.a.Group,{defaultValue:e.type,onChange:e=>{r(e.target.value)}},s.a.createElement(m.a.Button,{value:"asc"},s.a.createElement("span",{style:n.style},n.asc)),s.a.createElement(m.a.Button,{value:"desc"},s.a.createElement("span",{style:n.style},n.desc)))},qve=({group:e,field:t,onRemove:r=(()=>{}),onChange:n=(()=>{}),onUpdateType:i=(()=>{})})=>{const{state:o,onFieldSelect:l}=(({field:e,onChange:t})=>{const[r,n]=Object(a.useState)(e);return{state:{activeField:r},onFieldSelect(e){t(e),n(e)}}})({field:t,onChange:n});return s.a.createElement("div",{className:"lakex-table-group-item"},s.a.createElement(YP,{type:"Close",onClick:()=>{r(e)}}),s.a.createElement(Uve,{defaultValue:null==t?void 0:t.uuid,onFieldSelect:l,className:"lakex-table-group-item-select"}),s.a.createElement(Kve,{group:e,field:o.activeField,onUpdateType:i}))},Yve=()=>{const e=zA(tQ),t=zA(Pb),r=zA(Dy),n=null==r?void 0:r.getActiveViewData(["fields","viewConfig","group"]),i=null==n?void 0:n.group,o=null==n?void 0:n.viewConfig,[s,l]=Object(a.useState)(i),c=e=>{const n=null==r?void 0:r.getActiveView();if(!n)return;const i=null==r?void 0:r.getViewGroup(null==n?void 0:n.uuid);return e?i?null==t?void 0:t.execCommand("updateGridGroup",{viewId:null==o?void 0:o.view_uuid,group:e}):null==t?void 0:t.execCommand("createGridGroup",{viewId:null==o?void 0:o.view_uuid,group:e}):null==t?void 0:t.execCommand("removeGridGroup",{viewId:null==o?void 0:o.view_uuid})};return{state:{group:s},fields:null==n?void 0:n.fields,onAddOption(e){var t,n;e||(e=null==(t=null==r?void 0:r.getViewFields())?void 0:t[0].field);const i={field_uuid:null==e?void 0:e.uuid,type:Ux.ASC};null==(n=c(i))||n.then((()=>{l(i)}))},onRemoveOption(){var e;null==(e=c(null))||e.then((()=>{l(null)}))},onUpdateOption(e){var t;const r={field_uuid:null==e?void 0:e.uuid,type:(null==s?void 0:s.type)||Ux.ASC};null==(t=c(r))||t.then((()=>{l(r)}))},onUpdateType(e){var t;s&&(s.type=e),null==(t=c(s))||t.then((()=>{l(s)}))},onClose(){e.close("grid-group")}}},Xve=()=>{const{state:e,fields:t,onAddOption:r,onUpdateOption:n,onRemoveOption:i,onUpdateType:o}=Yve();let a;if(e.group){const r=null==t?void 0:t.find((t=>{var r;return t.uuid===(null==(r=e.group)?void 0:r.field_uuid)}));a=s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"lakex-table-group-setting"},s.a.createElement("h2",{className:"lakex-table-group-setting-title"},kf("分组设置"))),s.a.createElement(qve,{field:r,group:e.group,onRemove:i,onChange:n,onUpdateType:o}))}else a=s.a.createElement(Wve,{onAddOption:r});return s.a.createElement("div",{className:"lakex-table-group-modal"},a)},Zve=({onAddOption:e=(()=>{})})=>s.a.createElement("div",{className:"lakex-table-h5-empty"},s.a.createElement(mue,{desc:kf("你还未进行任何分组"),className:"no-data"}),s.a.createElement(b.a,{type:"primary",onClick:()=>e(),className:"no-data-btn"},s.a.createElement(YP,{type:"Add"}),kf("添加分组条件"))),Jve=e=>{const{state:t,fields:r,onClose:n,onAddOption:i,onUpdateOption:o,onRemoveOption:l,onUpdateType:c}=Yve(),u=zA(qf),d=zA(tQ),f=u.getValue("modal.mode"),p=zA(Dy),h=zA(tD),m=Object(a.useMemo)((()=>null==p?void 0:p.getViewFields()),[]);return s.a.createElement(sue,{title:kf("分组"),onClose:n,showCloseIcon:!0},(()=>{if(!t.group)return s.a.createElement(Zve,{onAddOption:i});const e=null==r?void 0:r.find((e=>{var r;return e.uuid===(null==(r=t.group)?void 0:r.field_uuid)})),n=Gve(null==e?void 0:e.type),a=null==h?void 0:h.getFieldIcon(null==e?void 0:e.type);return s.a.createElement("div",{className:"lakex-table-h5-group"},s.a.createElement("div",{className:"lakex-table-h5-group-tip"},kf("按以下选项进行分组")),s.a.createElement(vue,{prefixIcon:a,className:"lakex-table-h5-filter-col",text:null==e?void 0:e.name,onClick:()=>{null==d||d.open("group-select",{initialState:{group:t.group}})}}),s.a.createElement(PQ,{id:"group-select",mode:f,hasMask:f===eQ.DRAWER,hasAnimation:f===eQ.DRAWER,position:f===eQ.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:({initialState:e})=>{var t;return s.a.createElement(sue,{title:kf("请选择"),onClose:()=>{null==d||d.close("group-select")},showCloseIcon:!0},s.a.createElement(fue,{defaultValue:null==(t=e.group)?void 0:t.field_uuid,list:m.map((e=>{var t;const r=null==h?void 0:h.getFieldIcon(null==(t=e.field)?void 0:t.type);return{key:e.field.uuid,title:e.field.name,icon:r&&s.a.createElement(r,null)}})),onCheck:e=>{null==d||d.close("group-select"),o({uuid:e.key})}}))}}),s.a.createElement(uue,{className:"lakex-table-h5-group-display-radio",options:[{label:n.asc,value:"asc"},{label:n.desc,value:"desc"}],onChange:e=>c(e.value),defaultValue:t.group.type}),s.a.createElement(b.a,{className:"lakex-table-h5-group-del",onClick:()=>l()},s.a.createElement(YP,{type:"Delete",className:"del-icon"}),kf("删除该条件")))})())};var Qve=Object.defineProperty,ege=Object.getOwnPropertyDescriptor,tge=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ege(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Qve(t,r,o),o};let rge=class{constructor(){this._getActive=()=>{const e=this._readService.getActiveView();return!!e&&!!this._readService.getViewGroup(e.uuid)}}static pluginModule(){return bo().register(this)}init(){}registerToolbar(e){e.registerItem({id:"grid-group",icon:"ViewerGroup",tooltip:kf("分组"),visible:()=>{var e;return(null==(e=this._readService.getActiveView())?void 0:e.type)===Wh.GRID},active:this._getActive,onClick:e=>{const t=e.target;this._modalService.open("grid-group",{position:{origin:t,placement:"bottom"}})}})}registerModal(e){const t=this._configuration.getValue("modal.mode"),r=this._configuration.getValue("render.mode");e.registerItem({id:"grid-group",mode:t,hasMask:t===eQ.DRAWER,hasAnimation:t===eQ.DRAWER,position:t===eQ.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:r===Pj.MOBILE?Jve:Xve})}};rge.pluginName="workbench-viewer-grid-group",tge([to(tQ)],rge.prototype,"_modalService",2),tge([to(Dy)],rge.prototype,"_readService",2),tge([to(qf)],rge.prototype,"_configuration",2),rge=tge([eo({contrib:[PA,IJ,rQ]})],rge);const nge=()=>{const e=zA(Pb),t=zA(tQ),r=zA(Dy),n=null==r?void 0:r.getActiveViewData(["view","viewConfig"]),{view:i,viewConfig:o}=n||{};return o&&!o.record_height&&(o.record_height="low"),{viewConfig:o,onConfirm(r){null==e||e.execCommand("updateGridRecordHeight",{viewId:i.uuid,recordHeight:r.key}),t.close("grid-record-height")},onModalClose(){t.close("grid-record-height")}}},ige=[{type:"low",name:kf("低")},{type:"middle",name:kf("中")},{type:"high",name:kf("高")}],oge="lakex-table-row-height",age=()=>{const{viewConfig:e,onConfirm:t}=nge();return e?s.a.createElement("div",{className:oge},s.a.createElement(d.a,{defaultSelectedKeys:[e.record_height],mode:"vertical",onClick:t},ige.map((t=>s.a.createElement(d.a.Item,{key:t.type,icon:s.a.createElement("span",null,t.type===e.record_height&&s.a.createElement("span",{className:`${oge}-checked`},s.a.createElement(YP,{type:"Check"})),s.a.createElement(YP,{type:`RowHeight${xA(t.type)}`}))},kf(t.name)))))):null},sge=e=>{const{viewConfig:t,onConfirm:r,onModalClose:n}=nge();return t?s.a.createElement(sue,{title:kf("行高"),onClose:n,showCloseIcon:!0},s.a.createElement(fue,{defaultValue:t.record_height,list:ige.map((e=>({key:e.type,title:e.name}))),onCheck:e=>r(e)})):null};var lge=Object.defineProperty,cge=Object.getOwnPropertyDescriptor,uge=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?cge(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&lge(t,r,o),o};let dge=class{static pluginModule(){return bo().register(this)}init(){}registerToolbar(e){e.registerItem({id:"grid-record-height",icon:"RowHeightLow",tooltip:kf("行高"),visible:()=>{const e=this._readService.getActiveView();return(null==e?void 0:e.type)===Wh.GRID},onClick:e=>{const t=e.target;this._modalService.open("grid-record-height",{position:{origin:t,placement:"bottom"}})}})}registerModal(e){const t=this._configuration.getValue("modal.mode"),r=this._configuration.getValue("render.mode");e.registerItem({id:"grid-record-height",mode:t,hasMask:t===eQ.DRAWER,hasAnimation:t===eQ.DRAWER,position:t===eQ.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:r===Pj.MOBILE?sge:age})}};dge.pluginName="workbench-viewer-grid-record-height",uge([to(tQ)],dge.prototype,"_modalService",2),uge([to(Dy)],dge.prototype,"_readService",2),uge([to(qf)],dge.prototype,"_configuration",2),dge=uge([eo({contrib:[PA,IJ,rQ]})],dge);const fge=({initialState:e})=>{const{groupField:t,groupOption:r}=e,{settings:n}=(({groupField:e,groupOption:t,$title:r})=>{const n=zA(Pb),i=zA(tQ),o=zA(N2),l=zA(oce);return{settings:Object(a.useMemo)((()=>[{key:"edit",name:Kh.isMention(null==e?void 0:e.type)?kf("修改分组人员"):kf("修改分组"),icon:s.a.createElement(YP,{type:"Edit"}),onClick:(n,a)=>{null==i||i.close("viewKanbanGroupSetting"),null==o||o.showEditGroup(r,e,t)}},{key:"remove",name:kf("删除分组"),icon:s.a.createElement(YP,{type:"Delete"}),onClick:(r,o)=>{null==i||i.close("viewKanbanGroupSetting");const a=null==l?void 0:l.getGroupFieldOption(e,t);!a||(null==i||i.close("viewKanbanGroupSetting"),null==n||n.execCommand("removeFieldOption",{optionId:a.uuid}))}}]),[null==e?void 0:e.type])}})(e);return t&&r?s.a.createElement("div",{className:"lakex-table-kanban-group-setting"},s.a.createElement(d.a,null,n.map((e=>s.a.createElement(d.a.Item,{key:e.key,icon:e.icon,onClick:t=>e.onClick(t,e)},e.name))))):null};var pge=Object.defineProperty,hge=Object.getOwnPropertyDescriptor,mge=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?hge(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&pge(t,r,o),o};let vge=class{static pluginModule(){return bo().register(this)}init(){this._kanbanGroupActionService.onGroupSettingClick((({target:e,groupField:t,groupOption:r,$title:n})=>{var i;null==(i=this._modalService)||i.open("viewKanbanGroupSetting",{position:{origin:e,placement:"bottom"},initialState:{groupField:t,groupOption:r,$title:n}})}))}registerModal(e){e.registerItem({id:"viewKanbanGroupSetting",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:fge})}};vge.pluginName="workbench-viewer-kanban-group",mge([to(Mce)],vge.prototype,"_kanbanGroupActionService",2),mge([to(tQ)],vge.prototype,"_modalService",2),vge=mge([eo({contrib:[PA,rQ]})],vge);const gge=()=>{const e=zA(tD),t=zA(Pb),r=zA(tQ),n=zA(Dy),i=zA(oce),o=null==n?void 0:n.getActiveView(),[s,l]=Object(a.useState)(null==i?void 0:i.getGroup());return{state:{group:s},fields:(null==i?void 0:i.getSupportGroupFields())||[],onChange(e){l(e);const n={field_uuid:e.uuid};null==t||t.execCommand("updateKanbanGroup",{viewId:null==o?void 0:o.uuid,group:n}),r.close("kanban-group-setting")},onModalClose(){r.close("kanban-group-setting")},fieldService:e}},yge=()=>{const{state:e,fields:t,onChange:r,fieldService:n}=gge();return e.group?s.a.createElement("div",{className:"lakex-table-menu-container lakex-table-menu-kanban-group lakex-table-menu-kanban-group-modal"},s.a.createElement("div",{className:"lakex-table-menu-kanban-group-options"},t.map((t=>{var i;const o=null==n?void 0:n.getFieldIcon(t.type);return s.a.createElement("div",{key:t.uuid,className:"lakex-table-menu-kanban-group-option",onClick:()=>{r(t)}},s.a.createElement("span",{className:"lakex-table-menu-kanban-group-option-title"},o?s.a.createElement(o,{className:"lakex-table-icon-col-type"}):null,t.name),t.uuid===(null==(i=e.group)?void 0:i.field_uuid)?s.a.createElement(YP,{type:"Check"}):s.a.createElement("span",{className:"lakex-table-menu-kanban-group-empty"}))})))):null},bge=({field:e})=>{const t=zA(tD),r=null==t?void 0:t.getFieldIcon(e.type);return s.a.createElement("span",{className:"lakex-table-kanban-group-setting-title"},kf("按"),r?s.a.createElement(r,{className:"lakex-table-icon-col-type",size:14}):null,e.name,kf("分组"))},wge=()=>{var e;const{state:t,fields:r,onChange:n,onModalClose:i,fieldService:o}=gge();if(!t.group)return null;const a=r.map((e=>{const t=null==o?void 0:o.getFieldIcon(e.type);return{key:e.uuid,icon:t?s.a.createElement(t,{className:"lakex-table-icon-col-type"}):null,title:e.name}}));return s.a.createElement(sue,{title:kf("选择分组字段"),onClose:i,showCloseIcon:!0},s.a.createElement(fue,{defaultValue:null==(e=t.group)?void 0:e.field_uuid,list:a,onCheck:e=>n(r.find((t=>t.uuid===e.key)))}))};var _ge=Object.defineProperty,Cge=Object.getOwnPropertyDescriptor,Ege=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Cge(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&_ge(t,r,o),o};let xge=class{static pluginModule(){return bo().register(this)}init(){}registerToolbar(e){e.registerItem({id:"kanban-group-setting",tooltip:()=>{const e=this._readService.getActiveView();if(!e)return null;const t=this._readService.getViewGroup(null==e?void 0:e.uuid);return null!=t&&t.field?s.a.createElement(bge,{field:null==t?void 0:t.field}):null},visible:()=>{const e=this._readService.getActiveView();if(!e||e.type!==Wh.KANBAN)return!1;const t=this._readService.getViewGroup(e.uuid);return!(null==t||!t.field)},showTitle:!0,showTooltip:!1,onClick:e=>{this._modalService.open("kanban-group-setting",{position:{origin:e.target,placement:"bottom"}})}})}registerModal(e){const t=this._configuration.getValue("modal.mode"),r=this._configuration.getValue("render.mode");e.registerItem({id:"kanban-group-setting",mode:t,hasMask:t===eQ.DRAWER,hasAnimation:t===eQ.DRAWER,position:t===eQ.DRAWER&&{placement:"bottom"},scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:r===Pj.MOBILE?wge:yge})}};xge.pluginName="workbench-viewer-kanban-group-setting",Ege([to(tQ)],xge.prototype,"_modalService",2),Ege([to(Dy)],xge.prototype,"_readService",2),Ege([to(qf)],xge.prototype,"_configuration",2),xge=Ege([eo({contrib:[PA,IJ,rQ]})],xge);const Sge=[zce,Rue,Fue,Que,ide,Tde,Pde,$de,Hde,ofe,cfe,Dme,qme,gve,_ve,kve,zve,rge,dge,vge,xge],kge=({webSdk:e,settings:t})=>({settings:Object.assign({},{"model.frozenTable":["ability","user"],"toolbar.topLeft":["view-manage"],"toolbar.left":["kanban-group-setting","view-field-setting","filter","grid-group","sort","grid-record-height","search","|","add-record"],contextMenu:["updateField","|","insertFieldLeft","insertFieldRight","|","groupByField","filterByField","sortByAsc","sortByDesc","|","addFieldGroup","editFieldGroup","removeFieldGroup","|","copy","paste","|","insertRecordUp","insertRecordDown","insertRecordLeft","insertRecordRight","|","copyRecord","expandRecord","removeRecord","removeField"]},t),webSdk:e}),Oge=[],Ige=KQ.filter((e=>!Oge.includes(e.pluginName))),Rge=[],Tge=Vce.filter((e=>!Rge.includes(e.pluginName))),Age=["workbench-full-width","workbench-full-screen"],Nge=Sge.filter((e=>!Age.includes(e.pluginName))),Mge=[],Pge=[],jge=[],Dge=e=>{var t;const r=kge({webSdk:e.webSdk,settings:e.settings||{}});let n;try{n=new WQ({...e,...r,workbenchPlugins:[...Nge,...e.workbenchPlugins||[]],renderPlugins:[...Tge,...e.renderPlugins||[]],kernelPlugins:[...Ige,...e.kernelPlugins||[]],workbenchContribs:[...Mge,...e.workbenchContribs||[]],renderContribs:[...Pge,...e.renderContribs||[]],kernelContribs:[...jge,...e.kernelContribs||[]],onDataLoaded(t){var r;null==(r=e.onDataLoaded)||r.call(e,t)}}),e.onCellChange&&n.getService(Fv).onCellChange((t=>{var r;return null==(r=e.onCellChange)?void 0:r.call(e,t.cellValue)}))}catch(r){console.error(r),null==(t=e.onError)||t.call(e,r)}return n},Fge=["kernel-history","kernel-add-record"],Vge=KQ.filter((e=>!Fge.includes(e.pluginName))),Lge=["render-history"],$ge=Vce.filter((e=>!Lge.includes(e.pluginName))),Bge=["workbench-add-record","workbench-grid-cell-editor"],zge=Sge.filter((e=>!Bge.includes(e.pluginName)));function Uge(e){return function(...t){return new Promise((function(r,n){const i=e.apply(this,t);i?r(i):n(i)}))}}var Hge={exports:{}},Wge={},Gge={},Kge={},qge={},Yge={},Xge={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends t{constructor(t){if(super(),!e.IDENTIFIER.test(t))throw new Error("CodeGen: name must be a valid identifier");this.str=t}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=r;class n extends t{constructor(e){super(),this._items="string"==typeof e?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const e=this._items[0];return""===e||'""'===e}get str(){var e;return null!==(e=this._str)&&void 0!==e?e:this._str=this._items.reduce(((e,t)=>`${e}${t}`),"")}get names(){var e;return null!==(e=this._names)&&void 0!==e?e:this._names=this._items.reduce(((e,t)=>(t instanceof r&&(e[t.str]=(e[t.str]||0)+1),e)),{})}}function i(e,...t){const r=[e[0]];let i=0;for(;i<t.length;)s(r,t[i]),r.push(e[++i]);return new n(r)}e._Code=n,e.nil=new n(""),e._=i;const o=new n("+");function a(e,...t){const r=[c(e[0])];let i=0;for(;i<t.length;)r.push(o),s(r,t[i]),r.push(o,c(e[++i]));return function(e){let t=1;for(;t<e.length-1;){if(e[t]===o){const r=l(e[t-1],e[t+1]);if(void 0!==r){e.splice(t-1,3,r);continue}e[t++]="+"}t++}}(r),new n(r)}function s(e,t){t instanceof n?e.push(...t._items):t instanceof r?e.push(t):e.push(function(e){return"number"==typeof e||"boolean"==typeof e||null===e?e:c(Array.isArray(e)?e.join(","):e)}(t))}function l(e,t){return'""'===t?e:'""'===e?t:"string"==typeof e?t instanceof r||'"'!==e[e.length-1]?void 0:"string"!=typeof t?`${e.slice(0,-1)}${t}"`:'"'===t[0]?e.slice(0,-1)+t.slice(1):void 0:"string"!=typeof t||'"'!==t[0]||e instanceof r?void 0:`"${e}${t.slice(1)}`}function c(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.str=a,e.addCodeArg=s,e.strConcat=function(e,t){return t.emptyStr()?e:e.emptyStr()?t:a`${e}${t}`},e.stringify=function(e){return new n(c(e))},e.safeStringify=c,e.getProperty=function(t){return"string"==typeof t&&e.IDENTIFIER.test(t)?new n(`.${t}`):i`[${t}]`},e.getEsmExportName=function(t){if("string"==typeof t&&e.IDENTIFIER.test(t))return new n(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)},e.regexpCode=function(e){return new n(e.toString())}}(Xge);var Zge={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=Xge;class r extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}}var n,i;(i=n=e.UsedValueState||(e.UsedValueState={}))[i.Started=0]="Started",i[i.Completed=1]="Completed",e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class o{constructor({prefixes:e,parent:t}={}){this._names={},this._prefixes=e,this._parent=t}toName(e){return e instanceof t.Name?e:this.name(e)}name(e){return new t.Name(this._newName(e))}_newName(e){return`${e}${(this._names[e]||this._nameGroup(e)).index++}`}_nameGroup(e){var t,r;if((null===(r=null===(t=this._parent)||void 0===t?void 0:t._prefixes)||void 0===r?void 0:r.has(e))||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}}e.Scope=o;class a extends t.Name{constructor(e,t){super(t),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=t._`.${new t.Name(r)}[${n}]`}}e.ValueScopeName=a;const s=t._`\n`;e.ValueScope=class extends o{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?s:t.nil}}get(){return this._scope}name(e){return new a(e,this._newName(e))}value(e,t){var r;if(void 0===t.ref)throw new Error("CodeGen: ref must be passed in value");const n=this.toName(e),{prefix:i}=n,o=null!==(r=t.key)&&void 0!==r?r:t.ref;let a=this._values[i];if(a){const e=a.get(o);if(e)return e}else a=this._values[i]=new Map;a.set(o,n);const s=this._scope[i]||(this._scope[i]=[]),l=s.length;return s[l]=t.ref,n.setValue(t,{property:i,itemIndex:l}),n}getValue(e,t){const r=this._values[e];if(r)return r.get(t)}scopeRefs(e,r=this._values){return this._reduceValues(r,(r=>{if(void 0===r.scopePath)throw new Error(`CodeGen: name "${r}" has no value`);return t._`${e}${r.scopePath}`}))}scopeCode(e=this._values,t,r){return this._reduceValues(e,(e=>{if(void 0===e.value)throw new Error(`CodeGen: name "${e}" has no value`);return e.value.code}),t,r)}_reduceValues(i,o,a={},s){let l=t.nil;for(const c in i){const u=i[c];if(!u)continue;const d=a[c]=a[c]||new Map;u.forEach((i=>{if(d.has(i))return;d.set(i,n.Started);let a=o(i);if(a){const r=this.opts.es5?e.varKinds.var:e.varKinds.const;l=t._`${l}${r} ${i} = ${a};${this.opts._n}`}else{if(!(a=null==s?void 0:s(i)))throw new r(i);l=t._`${l}${a}${this.opts._n}`}d.set(i,n.Completed)}))}return l}}}(Zge),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=Xge,r=Zge;var n=Xge;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return n.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return n.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return n.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return n.Name}});var i=Zge;Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return i.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return i.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return i.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return i.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class o{optimizeNodes(){return this}optimizeNames(e,t){return this}}class a extends o{constructor(e,t,r){super(),this.varKind=e,this.name=t,this.rhs=r}render({es5:e,_n:t}){const n=e?r.varKinds.var:this.varKind,i=void 0===this.rhs?"":` = ${this.rhs}`;return`${n} ${this.name}${i};`+t}optimizeNames(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=R(this.rhs,e,t)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class s extends o{constructor(e,t,r){super(),this.lhs=e,this.rhs=t,this.sideEffects=r}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof t.Name)||e[this.lhs.str]||this.sideEffects)return this.rhs=R(this.rhs,e,r),this}get names(){return I(this.lhs instanceof t.Name?{}:{...this.lhs.names},this.rhs)}}class l extends s{constructor(e,t,r,n){super(e,r,n),this.op=t}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}}class c extends o{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}}class u extends o{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}}class d extends o{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}}class f extends o{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,t){return this.code=R(this.code,e,t),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class p extends o{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce(((t,r)=>t+r.render(e)),"")}optimizeNodes(){const{nodes:e}=this;let t=e.length;for(;t--;){const r=e[t].optimizeNodes();Array.isArray(r)?e.splice(t,1,...r):r?e[t]=r:e.splice(t,1)}return e.length>0?this:void 0}optimizeNames(e,t){const{nodes:r}=this;let n=r.length;for(;n--;){const i=r[n];i.optimizeNames(e,t)||(T(e,i.names),r.splice(n,1))}return r.length>0?this:void 0}get names(){return this.nodes.reduce(((e,t)=>O(e,t.names)),{})}}class h extends p{render(e){return"{"+e._n+super.render(e)+"}"+e._n}}class m extends p{}class v extends h{}v.kind="else";class g extends h{constructor(e,t){super(t),this.condition=e}render(e){let t=`if(${this.condition})`+super.render(e);return this.else&&(t+="else "+this.else.render(e)),t}optimizeNodes(){super.optimizeNodes();const e=this.condition;if(!0===e)return this.nodes;let t=this.else;if(t){const e=t.optimizeNodes();t=this.else=Array.isArray(e)?new v(e):e}return t?!1===e?t instanceof g?t:t.nodes:this.nodes.length?this:new g(A(e),t instanceof g?[t]:t.nodes):!1!==e&&this.nodes.length?this:void 0}optimizeNames(e,t){var r;if(this.else=null===(r=this.else)||void 0===r?void 0:r.optimizeNames(e,t),super.optimizeNames(e,t)||this.else)return this.condition=R(this.condition,e,t),this}get names(){const e=super.names;return I(e,this.condition),this.else&&O(e,this.else.names),e}}g.kind="if";class y extends h{}y.kind="for";class b extends y{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iteration=R(this.iteration,e,t),this}get names(){return O(super.names,this.iteration.names)}}class w extends y{constructor(e,t,r,n){super(),this.varKind=e,this.name=t,this.from=r,this.to=n}render(e){const t=e.es5?r.varKinds.var:this.varKind,{name:n,from:i,to:o}=this;return`for(${t} ${n}=${i}; ${n}<${o}; ${n}++)`+super.render(e)}get names(){const e=I(super.names,this.from);return I(e,this.to)}}class _ extends y{constructor(e,t,r,n){super(),this.loop=e,this.varKind=t,this.name=r,this.iterable=n}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iterable=R(this.iterable,e,t),this}get names(){return O(super.names,this.iterable.names)}}class C extends h{constructor(e,t,r){super(),this.name=e,this.args=t,this.async=r}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}}C.kind="func";class E extends p{render(e){return"return "+super.render(e)}}E.kind="return";class x extends h{render(e){let t="try"+super.render(e);return this.catch&&(t+=this.catch.render(e)),this.finally&&(t+=this.finally.render(e)),t}optimizeNodes(){var e,t;return super.optimizeNodes(),null===(e=this.catch)||void 0===e||e.optimizeNodes(),null===(t=this.finally)||void 0===t||t.optimizeNodes(),this}optimizeNames(e,t){var r,n;return super.optimizeNames(e,t),null===(r=this.catch)||void 0===r||r.optimizeNames(e,t),null===(n=this.finally)||void 0===n||n.optimizeNames(e,t),this}get names(){const e=super.names;return this.catch&&O(e,this.catch.names),this.finally&&O(e,this.finally.names),e}}class S extends h{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}}S.kind="catch";class k extends h{render(e){return"finally"+super.render(e)}}k.kind="finally";function O(e,t){for(const r in t)e[r]=(e[r]||0)+(t[r]||0);return e}function I(e,r){return r instanceof t._CodeOrName?O(e,r.names):e}function R(e,r,n){return e instanceof t.Name?o(e):(i=e)instanceof t._Code&&i._items.some((e=>e instanceof t.Name&&1===r[e.str]&&void 0!==n[e.str]))?new t._Code(e._items.reduce(((e,r)=>(r instanceof t.Name&&(r=o(r)),r instanceof t._Code?e.push(...r._items):e.push(r),e)),[])):e;var i;function o(e){const t=n[e.str];return void 0===t||1!==r[e.str]?e:(delete r[e.str],t)}}function T(e,t){for(const r in t)e[r]=(e[r]||0)-(t[r]||0)}function A(e){return"boolean"==typeof e||"number"==typeof e||null===e?!e:t._`!${j(e)}`}e.CodeGen=class{constructor(e,t={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...t,_n:t.lines?"\n":""},this._extScope=e,this._scope=new r.Scope({parent:e}),this._nodes=[new m]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,t){const r=this._extScope.value(e,t);return(this._values[r.prefix]||(this._values[r.prefix]=new Set)).add(r),r}getScopeValue(e,t){return this._extScope.getValue(e,t)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,t,r,n){const i=this._scope.toName(t);return void 0!==r&&n&&(this._constants[i.str]=r),this._leafNode(new a(e,i,r)),i}const(e,t,n){return this._def(r.varKinds.const,e,t,n)}let(e,t,n){return this._def(r.varKinds.let,e,t,n)}var(e,t,n){return this._def(r.varKinds.var,e,t,n)}assign(e,t,r){return this._leafNode(new s(e,t,r))}add(t,r){return this._leafNode(new l(t,e.operators.ADD,r))}code(e){return"function"==typeof e?e():e!==t.nil&&this._leafNode(new f(e)),this}object(...e){const r=["{"];for(const[n,i]of e)r.length>1&&r.push(","),r.push(n),(n!==i||this.opts.es5)&&(r.push(":"),(0,t.addCodeArg)(r,i));return r.push("}"),new t._Code(r)}if(e,t,r){if(this._blockNode(new g(e)),t&&r)this.code(t).else().code(r).endIf();else if(t)this.code(t).endIf();else if(r)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new g(e))}else(){return this._elseNode(new v)}endIf(){return this._endBlockNode(g,v)}_for(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this}for(e,t){return this._for(new b(e),t)}forRange(e,t,n,i,o=(this.opts.es5?r.varKinds.var:r.varKinds.let)){const a=this._scope.toName(e);return this._for(new w(o,a,t,n),(()=>i(a)))}forOf(e,n,i,o=r.varKinds.const){const a=this._scope.toName(e);if(this.opts.es5){const e=n instanceof t.Name?n:this.var("_arr",n);return this.forRange("_i",0,t._`${e}.length`,(r=>{this.var(a,t._`${e}[${r}]`),i(a)}))}return this._for(new _("of",o,a,n),(()=>i(a)))}forIn(e,n,i,o=(this.opts.es5?r.varKinds.var:r.varKinds.const)){if(this.opts.ownProperties)return this.forOf(e,t._`Object.keys(${n})`,i);const a=this._scope.toName(e);return this._for(new _("in",o,a,n),(()=>i(a)))}endFor(){return this._endBlockNode(y)}label(e){return this._leafNode(new c(e))}break(e){return this._leafNode(new u(e))}return(e){const t=new E;if(this._blockNode(t),this.code(e),1!==t.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(E)}try(e,t,r){if(!t&&!r)throw new Error('CodeGen: "try" without "catch" and "finally"');const n=new x;if(this._blockNode(n),this.code(e),t){const e=this.name("e");this._currNode=n.catch=new S(e),t(e)}return r&&(this._currNode=n.finally=new k,this.code(r)),this._endBlockNode(S,k)}throw(e){return this._leafNode(new d(e))}block(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this}endBlock(e){const t=this._blockStarts.pop();if(void 0===t)throw new Error("CodeGen: not in self-balancing block");const r=this._nodes.length-t;if(r<0||void 0!==e&&r!==e)throw new Error(`CodeGen: wrong number of nodes: ${r} vs ${e} expected`);return this._nodes.length=t,this}func(e,r=t.nil,n,i){return this._blockNode(new C(e,r,n)),i&&this.code(i).endFunc(),this}endFunc(){return this._endBlockNode(C)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,t){const r=this._currNode;if(r instanceof e||t&&r instanceof t)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${t?`${e.kind}/${t.kind}`:e.kind}"`)}_elseNode(e){const t=this._currNode;if(!(t instanceof g))throw new Error('CodeGen: "else" without "if"');return this._currNode=t.else=e,this}get _root(){return this._nodes[0]}get _currNode(){const e=this._nodes;return e[e.length-1]}set _currNode(e){const t=this._nodes;t[t.length-1]=e}},e.not=A;const N=P(e.operators.AND);e.and=function(...e){return e.reduce(N)};const M=P(e.operators.OR);function P(e){return(r,n)=>r===t.nil?n:n===t.nil?r:t._`${j(r)} ${e} ${j(n)}`}function j(e){return e instanceof t.Name?e:t._`(${e})`}e.or=function(...e){return e.reduce(M)}}(Yge);var Jge={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.checkStrictMode=e.getErrorPath=e.Type=e.useFunc=e.setEvaluated=e.evaluatedPropsToName=e.mergeEvaluated=e.eachItem=e.unescapeJsonPointer=e.escapeJsonPointer=e.escapeFragment=e.unescapeFragment=e.schemaRefOrVal=e.schemaHasRulesButRef=e.schemaHasRules=e.checkUnknownRules=e.alwaysValidSchema=e.toHash=void 0;const t=Yge,r=Xge;function n(e,t=e.schema){const{opts:r,self:n}=e;if(!r.strictSchema||"boolean"==typeof t)return;const i=n.RULES.keywords;for(const r in t)i[r]||p(e,`unknown keyword: "${r}"`)}function i(e,t){if("boolean"==typeof e)return!e;for(const r in e)if(t[r])return!0;return!1}function o(e){return"number"==typeof e?`${e}`:e.replace(/~/g,"~0").replace(/\//g,"~1")}function a(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function s({mergeNames:e,mergeToName:r,mergeValues:n,resultToName:i}){return(o,a,s,l)=>{const c=void 0===s?a:s instanceof t.Name?(a instanceof t.Name?e(o,a,s):r(o,a,s),s):a instanceof t.Name?(r(o,s,a),a):n(a,s);return l!==t.Name||c instanceof t.Name?c:i(o,c)}}function l(e,r){if(!0===r)return e.var("props",!0);const n=e.var("props",t._`{}`);return void 0!==r&&c(e,n,r),n}function c(e,r,n){Object.keys(n).forEach((n=>e.assign(t._`${r}${(0,t.getProperty)(n)}`,!0)))}e.toHash=function(e){const t={};for(const r of e)t[r]=!0;return t},e.alwaysValidSchema=function(e,t){return"boolean"==typeof t?t:0===Object.keys(t).length||(n(e,t),!i(t,e.self.RULES.all))},e.checkUnknownRules=n,e.schemaHasRules=i,e.schemaHasRulesButRef=function(e,t){if("boolean"==typeof e)return!e;for(const r in e)if("$ref"!==r&&t.all[r])return!0;return!1},e.schemaRefOrVal=function({topSchemaRef:e,schemaPath:r},n,i,o){if(!o){if("number"==typeof n||"boolean"==typeof n)return n;if("string"==typeof n)return t._`${n}`}return t._`${e}${r}${(0,t.getProperty)(i)}`},e.unescapeFragment=function(e){return a(decodeURIComponent(e))},e.escapeFragment=function(e){return encodeURIComponent(o(e))},e.escapeJsonPointer=o,e.unescapeJsonPointer=a,e.eachItem=function(e,t){if(Array.isArray(e))for(const r of e)t(r);else t(e)},e.mergeEvaluated={props:s({mergeNames:(e,r,n)=>e.if(t._`${n} !== true && ${r} !== undefined`,(()=>{e.if(t._`${r} === true`,(()=>e.assign(n,!0)),(()=>e.assign(n,t._`${n} || {}`).code(t._`Object.assign(${n}, ${r})`)))})),mergeToName:(e,r,n)=>e.if(t._`${n} !== true`,(()=>{!0===r?e.assign(n,!0):(e.assign(n,t._`${n} || {}`),c(e,n,r))})),mergeValues:(e,t)=>!0===e||{...e,...t},resultToName:l}),items:s({mergeNames:(e,r,n)=>e.if(t._`${n} !== true && ${r} !== undefined`,(()=>e.assign(n,t._`${r} === true ? true : ${n} > ${r} ? ${n} : ${r}`))),mergeToName:(e,r,n)=>e.if(t._`${n} !== true`,(()=>e.assign(n,!0===r||t._`${n} > ${r} ? ${n} : ${r}`))),mergeValues:(e,t)=>!0===e||Math.max(e,t),resultToName:(e,t)=>e.var("items",t)})},e.evaluatedPropsToName=l,e.setEvaluated=c;const u={};var d,f;function p(e,t,r=e.opts.strictSchema){if(r){if(t=`strict mode: ${t}`,!0===r)throw new Error(t);e.self.logger.warn(t)}}e.useFunc=function(e,t){return e.scopeValue("func",{ref:t,code:u[t.code]||(u[t.code]=new r._Code(t.code))})},(f=d=e.Type||(e.Type={}))[f.Num=0]="Num",f[f.Str=1]="Str",e.getErrorPath=function(e,r,n){if(e instanceof t.Name){const i=r===d.Num;return n?i?t._`"[" + ${e} + "]"`:t._`"['" + ${e} + "']"`:i?t._`"/" + ${e}`:t._`"/" + ${e}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return n?(0,t.getProperty)(e).toString():"/"+o(e)},e.checkStrictMode=p}(Jge);var Qge={};Object.defineProperty(Qge,"__esModule",{value:!0});const eye=Yge,tye={data:new eye.Name("data"),valCxt:new eye.Name("valCxt"),instancePath:new eye.Name("instancePath"),parentData:new eye.Name("parentData"),parentDataProperty:new eye.Name("parentDataProperty"),rootData:new eye.Name("rootData"),dynamicAnchors:new eye.Name("dynamicAnchors"),vErrors:new eye.Name("vErrors"),errors:new eye.Name("errors"),this:new eye.Name("this"),self:new eye.Name("self"),scope:new eye.Name("scope"),json:new eye.Name("json"),jsonPos:new eye.Name("jsonPos"),jsonLen:new eye.Name("jsonLen"),jsonPart:new eye.Name("jsonPart")};Qge.default=tye,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=Yge,r=Jge,n=Qge;function i(e,r){const i=e.const("err",r);e.if(t._`${n.default.vErrors} === null`,(()=>e.assign(n.default.vErrors,t._`[${i}]`)),t._`${n.default.vErrors}.push(${i})`),e.code(t._`${n.default.errors}++`)}function o(e,r){const{gen:n,validateName:i,schemaEnv:o}=e;o.$async?n.throw(t._`new ${e.ValidationError}(${r})`):(n.assign(t._`${i}.errors`,r),n.return(!1))}e.keywordError={message:({keyword:e})=>t.str`must pass "${e}" keyword validation`},e.keyword$DataError={message:({keyword:e,schemaType:r})=>r?t.str`"${e}" keyword must be ${r} ($data)`:t.str`"${e}" keyword is invalid ($data)`},e.reportError=function(r,n=e.keywordError,a,l){const{it:c}=r,{gen:u,compositeRule:d,allErrors:f}=c,p=s(r,n,a);(null!=l?l:d||f)?i(u,p):o(c,t._`[${p}]`)},e.reportExtraError=function(t,r=e.keywordError,a){const{it:l}=t,{gen:c,compositeRule:u,allErrors:d}=l;i(c,s(t,r,a)),u||d||o(l,n.default.vErrors)},e.resetErrorsCount=function(e,r){e.assign(n.default.errors,r),e.if(t._`${n.default.vErrors} !== null`,(()=>e.if(r,(()=>e.assign(t._`${n.default.vErrors}.length`,r)),(()=>e.assign(n.default.vErrors,null)))))},e.extendErrors=function({gen:e,keyword:r,schemaValue:i,data:o,errsCount:a,it:s}){if(void 0===a)throw new Error("ajv implementation error");const l=e.name("err");e.forRange("i",a,n.default.errors,(a=>{e.const(l,t._`${n.default.vErrors}[${a}]`),e.if(t._`${l}.instancePath === undefined`,(()=>e.assign(t._`${l}.instancePath`,(0,t.strConcat)(n.default.instancePath,s.errorPath)))),e.assign(t._`${l}.schemaPath`,t.str`${s.errSchemaPath}/${r}`),s.opts.verbose&&(e.assign(t._`${l}.schema`,i),e.assign(t._`${l}.data`,o))}))};const a={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function s(e,r,i){const{createErrors:o}=e.it;return!1===o?t._`{}`:function(e,r,i={}){const{gen:o,it:s}=e,u=[l(s,i),c(e,i)];return function(e,{params:r,message:i},o){const{keyword:s,data:l,schemaValue:c,it:u}=e,{opts:d,propertyName:f,topSchemaRef:p,schemaPath:h}=u;o.push([a.keyword,s],[a.params,"function"==typeof r?r(e):r||t._`{}`]),d.messages&&o.push([a.message,"function"==typeof i?i(e):i]),d.verbose&&o.push([a.schema,c],[a.parentSchema,t._`${p}${h}`],[n.default.data,l]),f&&o.push([a.propertyName,f])}(e,r,u),o.object(...u)}(e,r,i)}function l({errorPath:e},{instancePath:i}){const o=i?t.str`${e}${(0,r.getErrorPath)(i,r.Type.Str)}`:e;return[n.default.instancePath,(0,t.strConcat)(n.default.instancePath,o)]}function c({keyword:e,it:{errSchemaPath:n}},{schemaPath:i,parentSchema:o}){let s=o?n:t.str`${n}/${e}`;return i&&(s=t.str`${s}${(0,r.getErrorPath)(i,r.Type.Str)}`),[a.schemaPath,s]}}(qge),Object.defineProperty(Kge,"__esModule",{value:!0}),Kge.boolOrEmptySchema=Kge.topBoolOrEmptySchema=void 0;const rye=qge,nye=Yge,iye=Qge,oye={message:"boolean schema is false"};function aye(e,t){const{gen:r,data:n}=e,i={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};(0,rye.reportError)(i,oye,void 0,t)}Kge.topBoolOrEmptySchema=function(e){const{gen:t,schema:r,validateName:n}=e;!1===r?aye(e,!1):"object"==typeof r&&!0===r.$async?t.return(iye.default.data):(t.assign(nye._`${n}.errors`,null),t.return(!0))},Kge.boolOrEmptySchema=function(e,t){const{gen:r,schema:n}=e;!1===n?(r.var(t,!1),aye(e)):r.var(t,!0)};var sye={},lye={};Object.defineProperty(lye,"__esModule",{value:!0}),lye.getRules=lye.isJSONType=void 0;const cye=new Set(["string","number","integer","boolean","null","object","array"]);lye.isJSONType=function(e){return"string"==typeof e&&cye.has(e)},lye.getRules=function(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}};var uye={};function dye(e,t){return t.rules.some((t=>fye(e,t)))}function fye(e,t){var r;return void 0!==e[t.keyword]||(null===(r=t.definition.implements)||void 0===r?void 0:r.some((t=>void 0!==e[t])))}Object.defineProperty(uye,"__esModule",{value:!0}),uye.shouldUseRule=uye.shouldUseGroup=uye.schemaHasRulesForType=void 0,uye.schemaHasRulesForType=function({schema:e,self:t},r){const n=t.RULES.types[r];return n&&!0!==n&&dye(e,n)},uye.shouldUseGroup=dye,uye.shouldUseRule=fye,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.reportTypeError=e.checkDataTypes=e.checkDataType=e.coerceAndCheckDataType=e.getJSONTypes=e.getSchemaTypes=e.DataType=void 0;const t=lye,r=uye,n=qge,i=Yge,o=Jge;var a,s;function l(e){const r=Array.isArray(e)?e:e?[e]:[];if(r.every(t.isJSONType))return r;throw new Error("type must be JSONType or JSONType[]: "+r.join(","))}(s=a=e.DataType||(e.DataType={}))[s.Correct=0]="Correct",s[s.Wrong=1]="Wrong",e.getSchemaTypes=function(e){const t=l(e.type);if(t.includes("null")){if(!1===e.nullable)throw new Error("type: null contradicts nullable: false")}else{if(!t.length&&void 0!==e.nullable)throw new Error('"nullable" cannot be used without "type"');!0===e.nullable&&t.push("null")}return t},e.getJSONTypes=l,e.coerceAndCheckDataType=function(e,t){const{gen:n,data:o,opts:s}=e,l=function(e,t){return t?e.filter((e=>c.has(e)||"array"===t&&"array"===e)):[]}(t,s.coerceTypes),u=t.length>0&&!(0===l.length&&1===t.length&&(0,r.schemaHasRulesForType)(e,t[0]));if(u){const r=d(t,o,s.strictNumbers,a.Wrong);n.if(r,(()=>{l.length?function(e,t,r){const{gen:n,data:o,opts:a}=e,s=n.let("dataType",i._`typeof ${o}`),l=n.let("coerced",i._`undefined`);"array"===a.coerceTypes&&n.if(i._`${s} == 'object' && Array.isArray(${o}) && ${o}.length == 1`,(()=>n.assign(o,i._`${o}[0]`).assign(s,i._`typeof ${o}`).if(d(t,o,a.strictNumbers),(()=>n.assign(l,o))))),n.if(i._`${l} !== undefined`);for(const e of r)(c.has(e)||"array"===e&&"array"===a.coerceTypes)&&u(e);function u(e){switch(e){case"string":return void n.elseIf(i._`${s} == "number" || ${s} == "boolean"`).assign(l,i._`"" + ${o}`).elseIf(i._`${o} === null`).assign(l,i._`""`);case"number":return void n.elseIf(i._`${s} == "boolean" || ${o} === null
              || (${s} == "string" && ${o} && ${o} == +${o})`).assign(l,i._`+${o}`);case"integer":return void n.elseIf(i._`${s} === "boolean" || ${o} === null
              || (${s} === "string" && ${o} && ${o} == +${o} && !(${o} % 1))`).assign(l,i._`+${o}`);case"boolean":return void n.elseIf(i._`${o} === "false" || ${o} === 0 || ${o} === null`).assign(l,!1).elseIf(i._`${o} === "true" || ${o} === 1`).assign(l,!0);case"null":return n.elseIf(i._`${o} === "" || ${o} === 0 || ${o} === false`),void n.assign(l,null);case"array":n.elseIf(i._`${s} === "string" || ${s} === "number"
              || ${s} === "boolean" || ${o} === null`).assign(l,i._`[${o}]`)}}n.else(),p(e),n.endIf(),n.if(i._`${l} !== undefined`,(()=>{n.assign(o,l),function({gen:e,parentData:t,parentDataProperty:r},n){e.if(i._`${t} !== undefined`,(()=>e.assign(i._`${t}[${r}]`,n)))}(e,l)}))}(e,t,l):p(e)}))}return u};const c=new Set(["string","number","integer","boolean","null"]);function u(e,t,r,n=a.Correct){const o=n===a.Correct?i.operators.EQ:i.operators.NEQ;let s;switch(e){case"null":return i._`${t} ${o} null`;case"array":s=i._`Array.isArray(${t})`;break;case"object":s=i._`${t} && typeof ${t} == "object" && !Array.isArray(${t})`;break;case"integer":s=l(i._`!(${t} % 1) && !isNaN(${t})`);break;case"number":s=l();break;default:return i._`typeof ${t} ${o} ${e}`}return n===a.Correct?s:(0,i.not)(s);function l(e=i.nil){return(0,i.and)(i._`typeof ${t} == "number"`,e,r?i._`isFinite(${t})`:i.nil)}}function d(e,t,r,n){if(1===e.length)return u(e[0],t,r,n);let a;const s=(0,o.toHash)(e);if(s.array&&s.object){const e=i._`typeof ${t} != "object"`;a=s.null?e:i._`!${t} || ${e}`,delete s.null,delete s.array,delete s.object}else a=i.nil;s.number&&delete s.integer;for(const e in s)a=(0,i.and)(a,u(e,t,r,n));return a}e.checkDataType=u,e.checkDataTypes=d;const f={message:({schema:e})=>`must be ${e}`,params:({schema:e,schemaValue:t})=>"string"==typeof e?i._`{type: ${e}}`:i._`{type: ${t}}`};function p(e){const t=function(e){const{gen:t,data:r,schema:n}=e,i=(0,o.schemaRefOrVal)(e,n,"type");return{gen:t,keyword:"type",data:r,schema:n.type,schemaCode:i,schemaValue:i,parentSchema:n,params:{},it:e}}(e);(0,n.reportError)(t,f)}e.reportTypeError=p}(sye);var pye={};Object.defineProperty(pye,"__esModule",{value:!0}),pye.assignDefaults=void 0;const hye=Yge,mye=Jge;function vye(e,t,r){const{gen:n,compositeRule:i,data:o,opts:a}=e;if(void 0===r)return;const s=hye._`${o}${(0,hye.getProperty)(t)}`;if(i)return void(0,mye.checkStrictMode)(e,`default is ignored for: ${s}`);let l=hye._`${s} === undefined`;"empty"===a.useDefaults&&(l=hye._`${l} || ${s} === null || ${s} === ""`),n.if(l,hye._`${s} = ${(0,hye.stringify)(r)}`)}pye.assignDefaults=function(e,t){const{properties:r,items:n}=e.schema;if("object"===t&&r)for(const t in r)vye(e,t,r[t].default);else"array"===t&&Array.isArray(n)&&n.forEach(((t,r)=>vye(e,r,t.default)))};var gye={},yye={};Object.defineProperty(yye,"__esModule",{value:!0}),yye.validateUnion=yye.validateArray=yye.usePattern=yye.callValidateCode=yye.schemaProperties=yye.allSchemaProperties=yye.noPropertyInData=yye.propertyInData=yye.isOwnProperty=yye.hasPropFunc=yye.reportMissingProp=yye.checkMissingProp=yye.checkReportMissingProp=void 0;const bye=Yge,wye=Jge,_ye=Qge,Cye=Jge;function Eye(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:bye._`Object.prototype.hasOwnProperty`})}function xye(e,t,r){return bye._`${Eye(e)}.call(${t}, ${r})`}function Sye(e,t,r,n){const i=bye._`${t}${(0,bye.getProperty)(r)} === undefined`;return n?(0,bye.or)(i,(0,bye.not)(xye(e,t,r))):i}function kye(e){return e?Object.keys(e).filter((e=>"__proto__"!==e)):[]}yye.checkReportMissingProp=function(e,t){const{gen:r,data:n,it:i}=e;r.if(Sye(r,n,t,i.opts.ownProperties),(()=>{e.setParams({missingProperty:bye._`${t}`},!0),e.error()}))},yye.checkMissingProp=function({gen:e,data:t,it:{opts:r}},n,i){return(0,bye.or)(...n.map((n=>(0,bye.and)(Sye(e,t,n,r.ownProperties),bye._`${i} = ${n}`))))},yye.reportMissingProp=function(e,t){e.setParams({missingProperty:t},!0),e.error()},yye.hasPropFunc=Eye,yye.isOwnProperty=xye,yye.propertyInData=function(e,t,r,n){const i=bye._`${t}${(0,bye.getProperty)(r)} !== undefined`;return n?bye._`${i} && ${xye(e,t,r)}`:i},yye.noPropertyInData=Sye,yye.allSchemaProperties=kye,yye.schemaProperties=function(e,t){return kye(t).filter((r=>!(0,wye.alwaysValidSchema)(e,t[r])))},yye.callValidateCode=function({schemaCode:e,data:t,it:{gen:r,topSchemaRef:n,schemaPath:i,errorPath:o},it:a},s,l,c){const u=c?bye._`${e}, ${t}, ${n}${i}`:t,d=[[_ye.default.instancePath,(0,bye.strConcat)(_ye.default.instancePath,o)],[_ye.default.parentData,a.parentData],[_ye.default.parentDataProperty,a.parentDataProperty],[_ye.default.rootData,_ye.default.rootData]];a.opts.dynamicRef&&d.push([_ye.default.dynamicAnchors,_ye.default.dynamicAnchors]);const f=bye._`${u}, ${r.object(...d)}`;return l!==bye.nil?bye._`${s}.call(${l}, ${f})`:bye._`${s}(${f})`};const Oye=bye._`new RegExp`;yye.usePattern=function({gen:e,it:{opts:t}},r){const n=t.unicodeRegExp?"u":"",{regExp:i}=t.code,o=i(r,n);return e.scopeValue("pattern",{key:o.toString(),ref:o,code:bye._`${"new RegExp"===i.code?Oye:(0,Cye.useFunc)(e,i)}(${r}, ${n})`})},yye.validateArray=function(e){const{gen:t,data:r,keyword:n,it:i}=e,o=t.name("valid");if(i.allErrors){const e=t.let("valid",!0);return a((()=>t.assign(e,!1))),e}return t.var(o,!0),a((()=>t.break())),o;function a(i){const a=t.const("len",bye._`${r}.length`);t.forRange("i",0,a,(r=>{e.subschema({keyword:n,dataProp:r,dataPropType:wye.Type.Num},o),t.if((0,bye.not)(o),i)}))}},yye.validateUnion=function(e){const{gen:t,schema:r,keyword:n,it:i}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some((e=>(0,wye.alwaysValidSchema)(i,e)))&&!i.opts.unevaluated)return;const o=t.let("valid",!1),a=t.name("_valid");t.block((()=>r.forEach(((r,i)=>{const s=e.subschema({keyword:n,schemaProp:i,compositeRule:!0},a);t.assign(o,bye._`${o} || ${a}`),e.mergeValidEvaluated(s,a)||t.if((0,bye.not)(o))})))),e.result(o,(()=>e.reset()),(()=>e.error(!0)))},Object.defineProperty(gye,"__esModule",{value:!0}),gye.validateKeywordUsage=gye.validSchemaType=gye.funcKeywordCode=gye.macroKeywordCode=void 0;const Iye=Yge,Rye=Qge,Tye=yye,Aye=qge;function Nye(e){const{gen:t,data:r,it:n}=e;t.if(n.parentData,(()=>t.assign(r,Iye._`${n.parentData}[${n.parentDataProperty}]`)))}function Mye(e,t,r){if(void 0===r)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword","function"==typeof r?{ref:r}:{ref:r,code:(0,Iye.stringify)(r)})}gye.macroKeywordCode=function(e,t){const{gen:r,keyword:n,schema:i,parentSchema:o,it:a}=e,s=t.macro.call(a.self,i,o,a),l=Mye(r,n,s);!1!==a.opts.validateSchema&&a.self.validateSchema(s,!0);const c=r.name("valid");e.subschema({schema:s,schemaPath:Iye.nil,errSchemaPath:`${a.errSchemaPath}/${n}`,topSchemaRef:l,compositeRule:!0},c),e.pass(c,(()=>e.error(!0)))},gye.funcKeywordCode=function(e,t){var r;const{gen:n,keyword:i,schema:o,parentSchema:a,$data:s,it:l}=e;!function({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}(l,t);const c=!s&&t.compile?t.compile.call(l.self,o,a,l):t.validate,u=Mye(n,i,c),d=n.let("valid");function f(r=(t.async?Iye._`await `:Iye.nil)){const i=l.opts.passContext?Rye.default.this:Rye.default.self,o=!("compile"in t&&!s||!1===t.schema);n.assign(d,Iye._`${r}${(0,Tye.callValidateCode)(e,u,i,o)}`,t.modifying)}function p(e){var r;n.if((0,Iye.not)(null!==(r=t.valid)&&void 0!==r?r:d),e)}e.block$data(d,(function(){if(!1===t.errors)f(),t.modifying&&Nye(e),p((()=>e.error()));else{const r=t.async?function(){const e=n.let("ruleErrs",null);return n.try((()=>f(Iye._`await `)),(t=>n.assign(d,!1).if(Iye._`${t} instanceof ${l.ValidationError}`,(()=>n.assign(e,Iye._`${t}.errors`)),(()=>n.throw(t))))),e}():function(){const e=Iye._`${u}.errors`;return n.assign(e,null),f(Iye.nil),e}();t.modifying&&Nye(e),p((()=>function(e,t){const{gen:r}=e;r.if(Iye._`Array.isArray(${t})`,(()=>{r.assign(Rye.default.vErrors,Iye._`${Rye.default.vErrors} === null ? ${t} : ${Rye.default.vErrors}.concat(${t})`).assign(Rye.default.errors,Iye._`${Rye.default.vErrors}.length`),(0,Aye.extendErrors)(e)}),(()=>e.error()))}(e,r)))}})),e.ok(null!==(r=t.valid)&&void 0!==r?r:d)},gye.validSchemaType=function(e,t,r=!1){return!t.length||t.some((t=>"array"===t?Array.isArray(e):"object"===t?e&&"object"==typeof e&&!Array.isArray(e):typeof e==t||r&&typeof e>"u"))},gye.validateKeywordUsage=function({schema:e,opts:t,self:r,errSchemaPath:n},i,o){if(Array.isArray(i.keyword)?!i.keyword.includes(o):i.keyword!==o)throw new Error("ajv implementation error");const a=i.dependencies;if(null!=a&&a.some((t=>!Object.prototype.hasOwnProperty.call(e,t))))throw new Error(`parent schema must have dependencies of ${o}: ${a.join(",")}`);if(i.validateSchema&&!i.validateSchema(e[o])){const e=`keyword "${o}" value is invalid at path "${n}": `+r.errorsText(i.validateSchema.errors);if("log"!==t.validateSchema)throw new Error(e);r.logger.error(e)}};var Pye={};Object.defineProperty(Pye,"__esModule",{value:!0}),Pye.extendSubschemaMode=Pye.extendSubschemaData=Pye.getSubschema=void 0;const jye=Yge,Dye=Jge;Pye.getSubschema=function(e,{keyword:t,schemaProp:r,schema:n,schemaPath:i,errSchemaPath:o,topSchemaRef:a}){if(void 0!==t&&void 0!==n)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==t){const n=e.schema[t];return void 0===r?{schema:n,schemaPath:jye._`${e.schemaPath}${(0,jye.getProperty)(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:n[r],schemaPath:jye._`${e.schemaPath}${(0,jye.getProperty)(t)}${(0,jye.getProperty)(r)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${(0,Dye.escapeFragment)(r)}`}}if(void 0!==n){if(void 0===i||void 0===o||void 0===a)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:i,topSchemaRef:a,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')},Pye.extendSubschemaData=function(e,t,{dataProp:r,dataPropType:n,data:i,dataTypes:o,propertyName:a}){if(void 0!==i&&void 0!==r)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:s}=t;if(void 0!==r){const{errorPath:i,dataPathArr:o,opts:a}=t;l(s.let("data",jye._`${t.data}${(0,jye.getProperty)(r)}`,!0)),e.errorPath=jye.str`${i}${(0,Dye.getErrorPath)(r,n,a.jsPropertySyntax)}`,e.parentDataProperty=jye._`${r}`,e.dataPathArr=[...o,e.parentDataProperty]}if(void 0!==i){l(i instanceof jye.Name?i:s.let("data",i,!0)),void 0!==a&&(e.propertyName=a)}function l(r){e.data=r,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,r]}o&&(e.dataTypes=o)},Pye.extendSubschemaMode=function(e,{jtdDiscriminator:t,jtdMetadata:r,compositeRule:n,createErrors:i,allErrors:o}){void 0!==n&&(e.compositeRule=n),void 0!==i&&(e.createErrors=i),void 0!==o&&(e.allErrors=o),e.jtdDiscriminator=t,e.jtdMetadata=r};var Fye={},Vye=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,i,o;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(i=n;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,o[i]))return!1;for(i=n;0!=i--;){var a=o[i];if(!e(t[a],r[a]))return!1}return!0}return t!=t&&r!=r},Lye={exports:{}},$ye=Lye.exports=function(e,t,r){"function"==typeof t&&(r=t,t={}),Bye(t,"function"==typeof(r=t.cb||r)?r:r.pre||function(){},r.post||function(){},e,"",e)};function Bye(e,t,r,n,i,o,a,s,l,c){if(n&&"object"==typeof n&&!Array.isArray(n)){for(var u in t(n,i,o,a,s,l,c),n){var d=n[u];if(Array.isArray(d)){if(u in $ye.arrayKeywords)for(var f=0;f<d.length;f++)Bye(e,t,r,d[f],i+"/"+u+"/"+f,o,i,u,n,f)}else if(u in $ye.propsKeywords){if(d&&"object"==typeof d)for(var p in d)Bye(e,t,r,d[p],i+"/"+u+"/"+zye(p),o,i,u,n,p)}else(u in $ye.keywords||e.allKeys&&!(u in $ye.skipKeywords))&&Bye(e,t,r,d,i+"/"+u,o,i,u,n)}r(n,i,o,a,s,l,c)}}function zye(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}$ye.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},$ye.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},$ye.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},$ye.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0},Object.defineProperty(Fye,"__esModule",{value:!0}),Fye.getSchemaRefs=Fye.resolveUrl=Fye.normalizeId=Fye._getFullPath=Fye.getFullPath=Fye.inlineRef=void 0;const Uye=Jge,Hye=Vye,Wye=Lye.exports,Gye=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);Fye.inlineRef=function(e,t=!0){return"boolean"==typeof e||(!0===t?!qye(e):!!t&&Yye(e)<=t)};const Kye=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function qye(e){for(const t in e){if(Kye.has(t))return!0;const r=e[t];if(Array.isArray(r)&&r.some(qye)||"object"==typeof r&&qye(r))return!0}return!1}function Yye(e){let t=0;for(const r in e)if("$ref"===r||(t++,!Gye.has(r)&&("object"==typeof e[r]&&(0,Uye.eachItem)(e[r],(e=>t+=Yye(e))),t===1/0)))return 1/0;return t}function Xye(e,t="",r){!1!==r&&(t=Qye(t));const n=e.parse(t);return Zye(e,n)}function Zye(e,t){return e.serialize(t).split("#")[0]+"#"}Fye.getFullPath=Xye,Fye._getFullPath=Zye;const Jye=/#\/?$/;function Qye(e){return e?e.replace(Jye,""):""}Fye.normalizeId=Qye,Fye.resolveUrl=function(e,t,r){return r=Qye(r),e.resolve(t,r)};const ebe=/^[a-z_][-a-z0-9._]*$/i;Fye.getSchemaRefs=function(e,t){if("boolean"==typeof e)return{};const{schemaId:r,uriResolver:n}=this.opts,i=Qye(e[r]||t),o={"":i},a=Xye(n,i,!1),s={},l=new Set;return Wye(e,{allKeys:!0},((e,t,n,i)=>{if(void 0===i)return;const d=a+t;let f=o[i];function p(t){const r=this.opts.uriResolver.resolve;if(t=Qye(f?r(f,t):t),l.has(t))throw u(t);l.add(t);let n=this.refs[t];return"string"==typeof n&&(n=this.refs[n]),"object"==typeof n?c(e,n.schema,t):t!==Qye(d)&&("#"===t[0]?(c(e,s[t],t),s[t]=e):this.refs[t]=d),t}function h(e){if("string"==typeof e){if(!ebe.test(e))throw new Error(`invalid anchor "${e}"`);p.call(this,`#${e}`)}}"string"==typeof e[r]&&(f=p.call(this,e[r])),h.call(this,e.$anchor),h.call(this,e.$dynamicAnchor),o[t]=f})),s;function c(e,t,r){if(void 0!==t&&!Hye(e,t))throw u(r)}function u(e){return new Error(`reference "${e}" resolves to more than one schema`)}},Object.defineProperty(Gge,"__esModule",{value:!0}),Gge.getData=Gge.KeywordCxt=Gge.validateFunctionCode=void 0;const tbe=Kge,rbe=sye,nbe=uye,ibe=sye,obe=pye,abe=gye,sbe=Pye,lbe=Yge,cbe=Qge,ube=Fye,dbe=Jge,fbe=qge;function pbe({gen:e,validateName:t,schema:r,schemaEnv:n,opts:i},o){i.code.es5?e.func(t,lbe._`${cbe.default.data}, ${cbe.default.valCxt}`,n.$async,(()=>{e.code(lbe._`"use strict"; ${hbe(r,i)}`),function(e,t){e.if(cbe.default.valCxt,(()=>{e.var(cbe.default.instancePath,lbe._`${cbe.default.valCxt}.${cbe.default.instancePath}`),e.var(cbe.default.parentData,lbe._`${cbe.default.valCxt}.${cbe.default.parentData}`),e.var(cbe.default.parentDataProperty,lbe._`${cbe.default.valCxt}.${cbe.default.parentDataProperty}`),e.var(cbe.default.rootData,lbe._`${cbe.default.valCxt}.${cbe.default.rootData}`),t.dynamicRef&&e.var(cbe.default.dynamicAnchors,lbe._`${cbe.default.valCxt}.${cbe.default.dynamicAnchors}`)}),(()=>{e.var(cbe.default.instancePath,lbe._`""`),e.var(cbe.default.parentData,lbe._`undefined`),e.var(cbe.default.parentDataProperty,lbe._`undefined`),e.var(cbe.default.rootData,cbe.default.data),t.dynamicRef&&e.var(cbe.default.dynamicAnchors,lbe._`{}`)}))}(e,i),e.code(o)})):e.func(t,lbe._`${cbe.default.data}, ${function(e){return lbe._`{${cbe.default.instancePath}="", ${cbe.default.parentData}, ${cbe.default.parentDataProperty}, ${cbe.default.rootData}=${cbe.default.data}${e.dynamicRef?lbe._`, ${cbe.default.dynamicAnchors}={}`:lbe.nil}}={}`}(i)}`,n.$async,(()=>e.code(hbe(r,i)).code(o)))}function hbe(e,t){const r="object"==typeof e&&e[t.schemaId];return r&&(t.code.source||t.code.process)?lbe._`/*# sourceURL=${r} */`:lbe.nil}function mbe(e,t){gbe(e)&&(ybe(e),vbe(e))?function(e,t){const{schema:r,gen:n,opts:i}=e;i.$comment&&r.$comment&&wbe(e),function(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,ube.resolveUrl)(e.opts.uriResolver,e.baseId,t))}(e),function(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}(e);const o=n.const("_errs",cbe.default.errors);bbe(e,o),n.var(t,lbe._`${o} === ${cbe.default.errors}`)}(e,t):(0,tbe.boolOrEmptySchema)(e,t)}function vbe({schema:e,self:t}){if("boolean"==typeof e)return!e;for(const r in e)if(t.RULES.all[r])return!0;return!1}function gbe(e){return"boolean"!=typeof e.schema}function ybe(e){(0,dbe.checkUnknownRules)(e),function(e){const{schema:t,errSchemaPath:r,opts:n,self:i}=e;t.$ref&&n.ignoreKeywordsWithRef&&(0,dbe.schemaHasRulesButRef)(t,i.RULES)&&i.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}(e)}function bbe(e,t){if(e.opts.jtd)return _be(e,[],!1,t);const r=(0,rbe.getSchemaTypes)(e.schema);_be(e,r,!(0,rbe.coerceAndCheckDataType)(e,r),t)}function wbe({gen:e,schemaEnv:t,schema:r,errSchemaPath:n,opts:i}){const o=r.$comment;if(!0===i.$comment)e.code(lbe._`${cbe.default.self}.logger.log(${o})`);else if("function"==typeof i.$comment){const r=lbe.str`${n}/$comment`,i=e.scopeValue("root",{ref:t.root});e.code(lbe._`${cbe.default.self}.opts.$comment(${o}, ${r}, ${i}.schema)`)}}function _be(e,t,r,n){const{gen:i,schema:o,data:a,allErrors:s,opts:l,self:c}=e,{RULES:u}=c;function d(c){!(0,nbe.shouldUseGroup)(o,c)||(c.type?(i.if((0,ibe.checkDataType)(c.type,a,l.strictNumbers)),Cbe(e,c),1===t.length&&t[0]===c.type&&r&&(i.else(),(0,ibe.reportTypeError)(e)),i.endIf()):Cbe(e,c),s||i.if(lbe._`${cbe.default.errors} === ${n||0}`))}!o.$ref||!l.ignoreKeywordsWithRef&&(0,dbe.schemaHasRulesButRef)(o,u)?(l.jtd||function(e,t){e.schemaEnv.meta||!e.opts.strictTypes||(function(e,t){if(t.length){if(!e.dataTypes.length)return void(e.dataTypes=t);t.forEach((t=>{xbe(e.dataTypes,t)||Sbe(e,`type "${t}" not allowed by context "${e.dataTypes.join(",")}"`)})),function(e,t){const r=[];for(const n of e.dataTypes)xbe(t,n)?r.push(n):t.includes("integer")&&"number"===n&&r.push("integer");e.dataTypes=r}(e,t)}}(e,t),e.opts.allowUnionTypes||function(e,t){t.length>1&&(2!==t.length||!t.includes("null"))&&Sbe(e,"use allowUnionTypes to allow union type keyword")}(e,t),function(e,t){const r=e.self.RULES.all;for(const n in r){const i=r[n];if("object"==typeof i&&(0,nbe.shouldUseRule)(e.schema,i)){const{type:r}=i.definition;r.length&&!r.some((e=>Ebe(t,e)))&&Sbe(e,`missing type "${r.join(",")}" for keyword "${n}"`)}}}(e,e.dataTypes))}(e,t),i.block((()=>{for(const e of u.rules)d(e);d(u.post)}))):i.block((()=>Obe(e,"$ref",u.all.$ref.definition)))}function Cbe(e,t){const{gen:r,schema:n,opts:{useDefaults:i}}=e;i&&(0,obe.assignDefaults)(e,t.type),r.block((()=>{for(const r of t.rules)(0,nbe.shouldUseRule)(n,r)&&Obe(e,r.keyword,r.definition,t.type)}))}function Ebe(e,t){return e.includes(t)||"number"===t&&e.includes("integer")}function xbe(e,t){return e.includes(t)||"integer"===t&&e.includes("number")}function Sbe(e,t){t+=` at "${e.schemaEnv.baseId+e.errSchemaPath}" (strictTypes)`,(0,dbe.checkStrictMode)(e,t,e.opts.strictTypes)}Gge.validateFunctionCode=function(e){gbe(e)&&(ybe(e),vbe(e))?function(e){const{schema:t,opts:r,gen:n}=e;pbe(e,(()=>{r.$comment&&t.$comment&&wbe(e),function(e){const{schema:t,opts:r}=e;void 0!==t.default&&r.useDefaults&&r.strictSchema&&(0,dbe.checkStrictMode)(e,"default is ignored in the schema root")}(e),n.let(cbe.default.vErrors,null),n.let(cbe.default.errors,0),r.unevaluated&&function(e){const{gen:t,validateName:r}=e;e.evaluated=t.const("evaluated",lbe._`${r}.evaluated`),t.if(lbe._`${e.evaluated}.dynamicProps`,(()=>t.assign(lbe._`${e.evaluated}.props`,lbe._`undefined`))),t.if(lbe._`${e.evaluated}.dynamicItems`,(()=>t.assign(lbe._`${e.evaluated}.items`,lbe._`undefined`)))}(e),bbe(e),function(e){const{gen:t,schemaEnv:r,validateName:n,ValidationError:i,opts:o}=e;r.$async?t.if(lbe._`${cbe.default.errors} === 0`,(()=>t.return(cbe.default.data)),(()=>t.throw(lbe._`new ${i}(${cbe.default.vErrors})`))):(t.assign(lbe._`${n}.errors`,cbe.default.vErrors),o.unevaluated&&function({gen:e,evaluated:t,props:r,items:n}){r instanceof lbe.Name&&e.assign(lbe._`${t}.props`,r),n instanceof lbe.Name&&e.assign(lbe._`${t}.items`,n)}(e),t.return(lbe._`${cbe.default.errors} === 0`))}(e)}))}(e):pbe(e,(()=>(0,tbe.topBoolOrEmptySchema)(e)))};class kbe{constructor(e,t,r){if((0,abe.validateKeywordUsage)(e,t,r),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=r,this.data=e.data,this.schema=e.schema[r],this.$data=t.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,dbe.schemaRefOrVal)(e,this.schema,r,this.$data),this.schemaType=t.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=t,this.$data)this.schemaCode=e.gen.const("vSchema",Tbe(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,abe.validSchemaType)(this.schema,t.schemaType,t.allowUndefined))throw new Error(`${r} value must be ${JSON.stringify(t.schemaType)}`);("code"in t?t.trackErrors:!1!==t.errors)&&(this.errsCount=e.gen.const("_errs",cbe.default.errors))}result(e,t,r){this.failResult((0,lbe.not)(e),t,r)}failResult(e,t,r){this.gen.if(e),r?r():this.error(),t?(this.gen.else(),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,t){this.failResult((0,lbe.not)(e),void 0,t)}fail(e){if(void 0===e)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:t}=this;this.fail(lbe._`${t} !== undefined && (${(0,lbe.or)(this.invalid$data(),e)})`)}error(e,t,r){if(t)return this.setParams(t),this._error(e,r),void this.setParams({});this._error(e,r)}_error(e,t){(e?fbe.reportExtraError:fbe.reportError)(this,this.def.error,t)}$dataError(){(0,fbe.reportError)(this,this.def.$dataError||fbe.keyword$DataError)}reset(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');(0,fbe.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,t){t?Object.assign(this.params,e):this.params=e}block$data(e,t,r=lbe.nil){this.gen.block((()=>{this.check$data(e,r),t()}))}check$data(e=lbe.nil,t=lbe.nil){if(!this.$data)return;const{gen:r,schemaCode:n,schemaType:i,def:o}=this;r.if((0,lbe.or)(lbe._`${n} === undefined`,t)),e!==lbe.nil&&r.assign(e,!0),(i.length||o.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),e!==lbe.nil&&r.assign(e,!1)),r.else()}invalid$data(){const{gen:e,schemaCode:t,schemaType:r,def:n,it:i}=this;return(0,lbe.or)(function(){if(r.length){if(!(t instanceof lbe.Name))throw new Error("ajv implementation error");const e=Array.isArray(r)?r:[r];return lbe._`${(0,ibe.checkDataTypes)(e,t,i.opts.strictNumbers,ibe.DataType.Wrong)}`}return lbe.nil}(),function(){if(n.validateSchema){const r=e.scopeValue("validate$data",{ref:n.validateSchema});return lbe._`!${r}(${t})`}return lbe.nil}())}subschema(e,t){const r=(0,sbe.getSubschema)(this.it,e);(0,sbe.extendSubschemaData)(r,this.it,e),(0,sbe.extendSubschemaMode)(r,e);const n={...this.it,...r,items:void 0,props:void 0};return mbe(n,t),n}mergeEvaluated(e,t){const{it:r,gen:n}=this;!r.opts.unevaluated||(!0!==r.props&&void 0!==e.props&&(r.props=dbe.mergeEvaluated.props(n,e.props,r.props,t)),!0!==r.items&&void 0!==e.items&&(r.items=dbe.mergeEvaluated.items(n,e.items,r.items,t)))}mergeValidEvaluated(e,t){const{it:r,gen:n}=this;if(r.opts.unevaluated&&(!0!==r.props||!0!==r.items))return n.if(t,(()=>this.mergeEvaluated(e,lbe.Name))),!0}}function Obe(e,t,r,n){const i=new kbe(e,r,t);"code"in r?r.code(i,n):i.$data&&r.validate?(0,abe.funcKeywordCode)(i,r):"macro"in r?(0,abe.macroKeywordCode)(i,r):(r.compile||r.validate)&&(0,abe.funcKeywordCode)(i,r)}Gge.KeywordCxt=kbe;const Ibe=/^\/(?:[^~]|~0|~1)*$/,Rbe=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Tbe(e,{dataLevel:t,dataNames:r,dataPathArr:n}){let i,o;if(""===e)return cbe.default.rootData;if("/"===e[0]){if(!Ibe.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);i=e,o=cbe.default.rootData}else{const a=Rbe.exec(e);if(!a)throw new Error(`Invalid JSON-pointer: ${e}`);const s=+a[1];if(i=a[2],"#"===i){if(s>=t)throw new Error(l("property/index",s));return n[t-s]}if(s>t)throw new Error(l("data",s));if(o=r[t-s],!i)return o}let a=o;const s=i.split("/");for(const e of s)e&&(o=lbe._`${o}${(0,lbe.getProperty)((0,dbe.unescapeJsonPointer)(e))}`,a=lbe._`${a} && ${o}`);return a;function l(e,r){return`Cannot access ${e} ${r} levels up, current level is ${t}`}}Gge.getData=Tbe;var Abe={};Object.defineProperty(Abe,"__esModule",{value:!0});class Nbe extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}}Abe.default=Nbe;var Mbe={};Object.defineProperty(Mbe,"__esModule",{value:!0});const Pbe=Fye;class jbe extends Error{constructor(e,t,r,n){super(n||`can't resolve reference ${r} from id ${t}`),this.missingRef=(0,Pbe.resolveUrl)(e,t,r),this.missingSchema=(0,Pbe.normalizeId)((0,Pbe.getFullPath)(e,this.missingRef))}}Mbe.default=jbe;var Dbe={};Object.defineProperty(Dbe,"__esModule",{value:!0}),Dbe.resolveSchema=Dbe.getCompilingSchema=Dbe.resolveRef=Dbe.compileSchema=Dbe.SchemaEnv=void 0;const Fbe=Yge,Vbe=Abe,Lbe=Qge,$be=Fye,Bbe=Jge,zbe=Gge;class Ube{constructor(e){var t;let r;this.refs={},this.dynamicAnchors={},"object"==typeof e.schema&&(r=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=null!==(t=e.baseId)&&void 0!==t?t:(0,$be.normalizeId)(null==r?void 0:r[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=null==r?void 0:r.$async,this.refs={}}}function Hbe(e){const t=Gbe.call(this,e);if(t)return t;const r=(0,$be.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:n,lines:i}=this.opts.code,{ownProperties:o}=this.opts,a=new Fbe.CodeGen(this.scope,{es5:n,lines:i,ownProperties:o});let s;e.$async&&(s=a.scopeValue("Error",{ref:Vbe.default,code:Fbe._`require("ajv/dist/runtime/validation_error").default`}));const l=a.scopeName("validate");e.validateName=l;const c={gen:a,allErrors:this.opts.allErrors,data:Lbe.default.data,parentData:Lbe.default.parentData,parentDataProperty:Lbe.default.parentDataProperty,dataNames:[Lbe.default.data],dataPathArr:[Fbe.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:a.scopeValue("schema",!0===this.opts.code.source?{ref:e.schema,code:(0,Fbe.stringify)(e.schema)}:{ref:e.schema}),validateName:l,ValidationError:s,schema:e.schema,schemaEnv:e,rootId:r,baseId:e.baseId||r,schemaPath:Fbe.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:Fbe._`""`,opts:this.opts,self:this};let u;try{this._compilations.add(e),(0,zbe.validateFunctionCode)(c),a.optimize(this.opts.code.optimize);const t=a.toString();u=`${a.scopeRefs(Lbe.default.scope)}return ${t}`,this.opts.code.process&&(u=this.opts.code.process(u,e));const r=new Function(`${Lbe.default.self}`,`${Lbe.default.scope}`,u)(this,this.scope.get());if(this.scope.value(l,{ref:r}),r.errors=null,r.schema=e.schema,r.schemaEnv=e,e.$async&&(r.$async=!0),!0===this.opts.code.source&&(r.source={validateName:l,validateCode:t,scopeValues:a._values}),this.opts.unevaluated){const{props:e,items:t}=c;r.evaluated={props:e instanceof Fbe.Name?void 0:e,items:t instanceof Fbe.Name?void 0:t,dynamicProps:e instanceof Fbe.Name,dynamicItems:t instanceof Fbe.Name},r.source&&(r.source.evaluated=(0,Fbe.stringify)(r.evaluated))}return e.validate=r,e}catch(t){throw delete e.validate,delete e.validateName,u&&this.logger.error("Error compiling schema, function code:",u),t}finally{this._compilations.delete(e)}}function Wbe(e){return(0,$be.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:Hbe.call(this,e)}function Gbe(e){for(const t of this._compilations)if(Kbe(t,e))return t}function Kbe(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function qbe(e,t){let r;for(;"string"==typeof(r=this.refs[t]);)t=r;return r||this.schemas[t]||Ybe.call(this,e,t)}function Ybe(e,t){const r=this.opts.uriResolver.parse(t),n=(0,$be._getFullPath)(this.opts.uriResolver,r);let i=(0,$be.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&n===i)return Zbe.call(this,r,e);const o=(0,$be.normalizeId)(n),a=this.refs[o]||this.schemas[o];if("string"==typeof a){const t=Ybe.call(this,e,a);return"object"!=typeof(null==t?void 0:t.schema)?void 0:Zbe.call(this,r,t)}if("object"==typeof(null==a?void 0:a.schema)){if(a.validate||Hbe.call(this,a),o===(0,$be.normalizeId)(t)){const{schema:t}=a,{schemaId:r}=this.opts,n=t[r];return n&&(i=(0,$be.resolveUrl)(this.opts.uriResolver,i,n)),new Ube({schema:t,schemaId:r,root:e,baseId:i})}return Zbe.call(this,r,a)}}Dbe.SchemaEnv=Ube,Dbe.compileSchema=Hbe,Dbe.resolveRef=function(e,t,r){var n;r=(0,$be.resolveUrl)(this.opts.uriResolver,t,r);const i=e.refs[r];if(i)return i;let o=qbe.call(this,e,r);if(void 0===o){const i=null===(n=e.localRefs)||void 0===n?void 0:n[r],{schemaId:a}=this.opts;i&&(o=new Ube({schema:i,schemaId:a,root:e,baseId:t}))}return void 0!==o?e.refs[r]=Wbe.call(this,o):void 0},Dbe.getCompilingSchema=Gbe,Dbe.resolveSchema=Ybe;const Xbe=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Zbe(e,{baseId:t,schema:r,root:n}){var i;if("/"!==(null===(i=e.fragment)||void 0===i?void 0:i[0]))return;for(const n of e.fragment.slice(1).split("/")){if("boolean"==typeof r)return;const e=r[(0,Bbe.unescapeFragment)(n)];if(void 0===e)return;const i="object"==typeof(r=e)&&r[this.opts.schemaId];!Xbe.has(n)&&i&&(t=(0,$be.resolveUrl)(this.opts.uriResolver,t,i))}let o;if("boolean"!=typeof r&&r.$ref&&!(0,Bbe.schemaHasRulesButRef)(r,this.RULES)){const e=(0,$be.resolveUrl)(this.opts.uriResolver,t,r.$ref);o=Ybe.call(this,n,e)}const{schemaId:a}=this.opts;return o=o||new Ube({schema:r,schemaId:a,root:n,baseId:t}),o.schema!==o.root.schema?o:void 0}const Jbe={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1};var Qbe={},ewe={exports:{}};(function(e){function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1){t[0]=t[0].slice(0,-1);for(var n=t.length-1,i=1;i<n;++i)t[i]=t[i].slice(1,-1);return t[n]=t[n].slice(1),t.join("")}return t[0]}function r(e){return"(?:"+e+")"}function n(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function i(e){return e.toUpperCase()}function o(e){return null!=e?e instanceof Array?e:"number"!=typeof e.length||e.split||e.setInterval||e.call?[e]:Array.prototype.slice.call(e):[]}function a(e,t){var r=e;if(t)for(var n in t)r[n]=t[n];return r}function s(e){var n="[A-Za-z]",i="[0-9]",o=t(i,"[A-Fa-f]"),a=r(r("%[EFef]"+o+"%"+o+o+"%"+o+o)+"|"+r("%[89A-Fa-f]"+o+"%"+o+o)+"|"+r("%"+o+o)),s="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",l=t("[\\:\\/\\?\\#\\[\\]\\@]",s),c=e?"[\\uE000-\\uF8FF]":"[]",u=t(n,i,"[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]");r(n+t(n,i,"[\\+\\-\\.]")+"*"),r(r(a+"|"+t(u,s,"[\\:]"))+"*");var d=r(r("25[0-5]")+"|"+r("2[0-4]"+i)+"|"+r("1"+i+i)+"|"+r("0?[1-9]"+i)+"|0?0?"+i),f=r(d+"\\."+d+"\\."+d+"\\."+d),p=r(o+"{1,4}"),h=r(r(p+"\\:"+p)+"|"+f),m=r(r(p+"\\:")+"{6}"+h),v=r("\\:\\:"+r(p+"\\:")+"{5}"+h),g=r(r(p)+"?\\:\\:"+r(p+"\\:")+"{4}"+h),y=r(r(r(p+"\\:")+"{0,1}"+p)+"?\\:\\:"+r(p+"\\:")+"{3}"+h),b=r(r(r(p+"\\:")+"{0,2}"+p)+"?\\:\\:"+r(p+"\\:")+"{2}"+h),w=r(r(r(p+"\\:")+"{0,3}"+p)+"?\\:\\:"+p+"\\:"+h),_=r(r(r(p+"\\:")+"{0,4}"+p)+"?\\:\\:"+h),C=r(r(r(p+"\\:")+"{0,5}"+p)+"?\\:\\:"+p),E=r(r(r(p+"\\:")+"{0,6}"+p)+"?\\:\\:"),x=r([m,v,g,y,b,w,_,C,E].join("|")),S=r(r(u+"|"+a)+"+");r("[vV]"+o+"+\\."+t(u,s,"[\\:]")+"+"),r(r(a+"|"+t(u,s))+"*");var k=r(a+"|"+t(u,s,"[\\:\\@]"));return r(r(a+"|"+t(u,s,"[\\@]"))+"+"),r(r(k+"|"+t("[\\/\\?]",c))+"*"),{NOT_SCHEME:new RegExp(t("[^]",n,i,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",u,s),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",u,s),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",u,s),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",u,s),"g"),NOT_QUERY:new RegExp(t("[^\\%]",u,s,"[\\:\\@\\/\\?]",c),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",u,s,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",u,s),"g"),UNRESERVED:new RegExp(u,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",u,l),"g"),PCT_ENCODED:new RegExp(a,"g"),IPV4ADDRESS:new RegExp("^("+f+")$"),IPV6ADDRESS:new RegExp("^\\[?("+x+")"+r(r("\\%25|\\%(?!"+o+"{2})")+"("+S+")")+"?\\]?$")}}var l=s(!1),c=s(!0),u=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},f=2147483647,p=36,h=1,m=26,v=38,g=700,y=72,b=128,w="-",_=/^xn--/,C=/[^\0-\x7E]/,E=/[\x2E\u3002\uFF0E\uFF61]/g,x={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},S=p-h,k=Math.floor,O=String.fromCharCode;function I(e){throw new RangeError(x[e])}function R(e,t){for(var r=[],n=e.length;n--;)r[n]=t(e[n]);return r}function T(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+R((e=e.replace(E,".")).split("."),t).join(".")}function A(e){for(var t=[],r=0,n=e.length;r<n;){var i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){var o=e.charCodeAt(r++);56320==(64512&o)?t.push(((1023&i)<<10)+(1023&o)+65536):(t.push(i),r--)}else t.push(i)}return t}var N=function(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:p},M=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},P=function(e,t,r){var n=0;for(e=r?k(e/g):e>>1,e+=k(e/t);e>S*m>>1;n+=p)e=k(e/S);return k(n+(S+1)*e/(e+v))},j=function(e){var t=[],r=e.length,n=0,i=b,o=y,a=e.lastIndexOf(w);a<0&&(a=0);for(var s=0;s<a;++s)e.charCodeAt(s)>=128&&I("not-basic"),t.push(e.charCodeAt(s));for(var l=a>0?a+1:0;l<r;){for(var c=n,u=1,d=p;;d+=p){l>=r&&I("invalid-input");var v=N(e.charCodeAt(l++));(v>=p||v>k((f-n)/u))&&I("overflow"),n+=v*u;var g=d<=o?h:d>=o+m?m:d-o;if(v<g)break;var _=p-g;u>k(f/_)&&I("overflow"),u*=_}var C=t.length+1;o=P(n-c,C,0==c),k(n/C)>f-i&&I("overflow"),i+=k(n/C),n%=C,t.splice(n++,0,i)}return String.fromCodePoint.apply(String,t)},D=function(e){var t=[],r=(e=A(e)).length,n=b,i=0,o=y,a=!0,s=!1,l=void 0;try{for(var c,u=e[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var d=c.value;d<128&&t.push(O(d))}}catch(e){s=!0,l=e}finally{try{!a&&u.return&&u.return()}finally{if(s)throw l}}var v=t.length,g=v;for(v&&t.push(w);g<r;){var _=f,C=!0,E=!1,x=void 0;try{for(var S,R=e[Symbol.iterator]();!(C=(S=R.next()).done);C=!0){var T=S.value;T>=n&&T<_&&(_=T)}}catch(e){E=!0,x=e}finally{try{!C&&R.return&&R.return()}finally{if(E)throw x}}var N=g+1;_-n>k((f-i)/N)&&I("overflow"),i+=(_-n)*N,n=_;var j=!0,D=!1,F=void 0;try{for(var V,L=e[Symbol.iterator]();!(j=(V=L.next()).done);j=!0){var $=V.value;if($<n&&++i>f&&I("overflow"),$==n){for(var B=i,z=p;;z+=p){var U=z<=o?h:z>=o+m?m:z-o;if(B<U)break;var H=B-U,W=p-U;t.push(O(M(U+H%W,0))),B=k(H/W)}t.push(O(M(B,0))),o=P(i,N,g==v),i=0,++g}}}catch(e){D=!0,F=e}finally{try{!j&&L.return&&L.return()}finally{if(D)throw F}}++i,++n}return t.join("")},F=function(e){return T(e,(function(e){return _.test(e)?j(e.slice(4).toLowerCase()):e}))},V=function(e){return T(e,(function(e){return C.test(e)?"xn--"+D(e):e}))},L={version:"2.1.0",ucs2:{decode:A,encode:function(e){return String.fromCodePoint.apply(String,d(e))}},decode:j,encode:D,toASCII:V,toUnicode:F},$={};function B(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function z(e){for(var t="",r=0,n=e.length;r<n;){var i=parseInt(e.substr(r+1,2),16);if(i<128)t+=String.fromCharCode(i),r+=3;else if(i>=194&&i<224){if(n-r>=6){var o=parseInt(e.substr(r+4,2),16);t+=String.fromCharCode((31&i)<<6|63&o)}else t+=e.substr(r,6);r+=6}else if(i>=224){if(n-r>=9){var a=parseInt(e.substr(r+4,2),16),s=parseInt(e.substr(r+7,2),16);t+=String.fromCharCode((15&i)<<12|(63&a)<<6|63&s)}else t+=e.substr(r,9);r+=9}else t+=e.substr(r,3),r+=3}return t}function U(e,t){function r(e){var r=z(e);return r.match(t.UNRESERVED)?r:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,r).replace(t.NOT_USERINFO,B).replace(t.PCT_ENCODED,i)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_HOST,B).replace(t.PCT_ENCODED,i)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,r).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,B).replace(t.PCT_ENCODED,i)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,r).replace(t.NOT_QUERY,B).replace(t.PCT_ENCODED,i)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,r).replace(t.NOT_FRAGMENT,B).replace(t.PCT_ENCODED,i)),e}function H(e){return e.replace(/^0*(.*)/,"$1")||"0"}function W(e,t){var r=e.match(t.IPV4ADDRESS)||[],n=u(r,2)[1];return n?n.split(".").map(H).join("."):e}function G(e,t){var r=e.match(t.IPV6ADDRESS)||[],n=u(r,3),i=n[1],o=n[2];if(i){for(var a=i.toLowerCase().split("::").reverse(),s=u(a,2),l=s[0],c=s[1],d=c?c.split(":").map(H):[],f=l.split(":").map(H),p=t.IPV4ADDRESS.test(f[f.length-1]),h=p?7:8,m=f.length-h,v=Array(h),g=0;g<h;++g)v[g]=d[g]||f[m+g]||"";p&&(v[h-1]=W(v[h-1],t));var y=v.reduce((function(e,t,r){if(!t||"0"===t){var n=e[e.length-1];n&&n.index+n.length===r?n.length++:e.push({index:r,length:1})}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],b=void 0;if(y&&y.length>1){var w=v.slice(0,y.index),_=v.slice(y.index+y.length);b=w.join(":")+"::"+_.join(":")}else b=v.join(":");return o&&(b+="%"+o),b}return e}var K=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,q=void 0==="".match(/(){0}/)[1];function Y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},n=!1!==t.iri?c:l;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var i=e.match(K);if(i){q?(r.scheme=i[1],r.userinfo=i[3],r.host=i[4],r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=i[7],r.fragment=i[8],isNaN(r.port)&&(r.port=i[5])):(r.scheme=i[1]||void 0,r.userinfo=-1!==e.indexOf("@")?i[3]:void 0,r.host=-1!==e.indexOf("//")?i[4]:void 0,r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=-1!==e.indexOf("?")?i[7]:void 0,r.fragment=-1!==e.indexOf("#")?i[8]:void 0,isNaN(r.port)&&(r.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?i[4]:void 0)),r.host&&(r.host=G(W(r.host,n),n)),void 0!==r.scheme||void 0!==r.userinfo||void 0!==r.host||void 0!==r.port||r.path||void 0!==r.query?void 0===r.scheme?r.reference="relative":void 0===r.fragment?r.reference="absolute":r.reference="uri":r.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==r.reference&&(r.error=r.error||"URI is not a "+t.reference+" reference.");var o=$[(t.scheme||r.scheme||"").toLowerCase()];if(t.unicodeSupport||o&&o.unicodeSupport)U(r,n);else{if(r.host&&(t.domainHost||o&&o.domainHost))try{r.host=L.toASCII(r.host.replace(n.PCT_ENCODED,z).toLowerCase())}catch(e){r.error=r.error||"Host's domain name can not be converted to ASCII via punycode: "+e}U(r,l)}o&&o.parse&&o.parse(r,t)}else r.error=r.error||"URI can not be parsed.";return r}function X(e,t){var r=!1!==t.iri?c:l,n=[];return void 0!==e.userinfo&&(n.push(e.userinfo),n.push("@")),void 0!==e.host&&n.push(G(W(String(e.host),r),r).replace(r.IPV6ADDRESS,(function(e,t,r){return"["+t+(r?"%25"+r:"")+"]"}))),("number"==typeof e.port||"string"==typeof e.port)&&(n.push(":"),n.push(String(e.port))),n.length?n.join(""):void 0}var Z=/^\.\.?\//,J=/^\/\.(\/|$)/,Q=/^\/\.\.(\/|$)/,ee=/^\/?(?:.|\n)*?(?=\/|$)/;function te(e){for(var t=[];e.length;)if(e.match(Z))e=e.replace(Z,"");else if(e.match(J))e=e.replace(J,"/");else if(e.match(Q))e=e.replace(Q,"/"),t.pop();else if("."===e||".."===e)e="";else{var r=e.match(ee);if(!r)throw new Error("Unexpected dot segment condition");var n=r[0];e=e.slice(n.length),t.push(n)}return t.join("")}function re(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.iri?c:l,n=[],i=$[(t.scheme||e.scheme||"").toLowerCase()];if(i&&i.serialize&&i.serialize(e,t),e.host&&!r.IPV6ADDRESS.test(e.host)&&(t.domainHost||i&&i.domainHost))try{e.host=t.iri?L.toUnicode(e.host):L.toASCII(e.host.replace(r.PCT_ENCODED,z).toLowerCase())}catch(r){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+r}U(e,r),"suffix"!==t.reference&&e.scheme&&(n.push(e.scheme),n.push(":"));var o=X(e,t);if(void 0!==o&&("suffix"!==t.reference&&n.push("//"),n.push(o),e.path&&"/"!==e.path.charAt(0)&&n.push("/")),void 0!==e.path){var a=e.path;!t.absolutePath&&(!i||!i.absolutePath)&&(a=te(a)),void 0===o&&(a=a.replace(/^\/\//,"/%2F")),n.push(a)}return void 0!==e.query&&(n.push("?"),n.push(e.query)),void 0!==e.fragment&&(n.push("#"),n.push(e.fragment)),n.join("")}function ne(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={};return arguments[3]||(e=Y(re(e,r),r),t=Y(re(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(n.scheme=t.scheme,n.userinfo=t.userinfo,n.host=t.host,n.port=t.port,n.path=te(t.path||""),n.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(n.userinfo=t.userinfo,n.host=t.host,n.port=t.port,n.path=te(t.path||""),n.query=t.query):(t.path?("/"===t.path.charAt(0)?n.path=te(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?n.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:n.path=t.path:n.path="/"+t.path,n.path=te(n.path)),n.query=t.query):(n.path=e.path,void 0!==t.query?n.query=t.query:n.query=e.query),n.userinfo=e.userinfo,n.host=e.host,n.port=e.port),n.scheme=e.scheme),n.fragment=t.fragment,n}function ie(e,t,r){var n=a({scheme:"null"},r);return re(ne(Y(e,n),Y(t,n),n,!0),n)}function oe(e,t){return"string"==typeof e?e=re(Y(e,t),t):"object"===n(e)&&(e=Y(re(e,t),t)),e}function ae(e,t,r){return"string"==typeof e?e=re(Y(e,r),r):"object"===n(e)&&(e=re(e,r)),"string"==typeof t?t=re(Y(t,r),r):"object"===n(t)&&(t=re(t,r)),e===t}function se(e,t){return e&&e.toString().replace(t&&t.iri?c.ESCAPE:l.ESCAPE,B)}function le(e,t){return e&&e.toString().replace(t&&t.iri?c.PCT_ENCODED:l.PCT_ENCODED,z)}var ce={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){var r="https"===String(e.scheme).toLowerCase();return(e.port===(r?443:80)||""===e.port)&&(e.port=void 0),e.path||(e.path="/"),e}},ue={scheme:"https",domainHost:ce.domainHost,parse:ce.parse,serialize:ce.serialize};function de(e){return"boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}var fe={scheme:"ws",domainHost:!0,parse:function(e,t){var r=e;return r.secure=de(r),r.resourceName=(r.path||"/")+(r.query?"?"+r.query:""),r.path=void 0,r.query=void 0,r},serialize:function(e,t){if((e.port===(de(e)?443:80)||""===e.port)&&(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){var r=e.resourceName.split("?"),n=u(r,2),i=n[0],o=n[1];e.path=i&&"/"!==i?i:void 0,e.query=o,e.resourceName=void 0}return e.fragment=void 0,e}},pe={scheme:"wss",domainHost:fe.domainHost,parse:fe.parse,serialize:fe.serialize},he={},me="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",ve="[0-9A-Fa-f]",ge=r(r("%[EFef]"+ve+"%"+ve+ve+"%"+ve+ve)+"|"+r("%[89A-Fa-f]"+ve+"%"+ve+ve)+"|"+r("%"+ve+ve)),ye="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",be=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),we="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",_e=new RegExp(me,"g"),Ce=new RegExp(ge,"g"),Ee=new RegExp(t("[^]",ye,"[\\.]",'[\\"]',be),"g"),xe=new RegExp(t("[^]",me,we),"g"),Se=xe;function ke(e){var t=z(e);return t.match(_e)?t:e}var Oe={scheme:"mailto",parse:function(e,t){var r=e,n=r.to=r.path?r.path.split(","):[];if(r.path=void 0,r.query){for(var i=!1,o={},a=r.query.split("&"),s=0,l=a.length;s<l;++s){var c=a[s].split("=");switch(c[0]){case"to":for(var u=c[1].split(","),d=0,f=u.length;d<f;++d)n.push(u[d]);break;case"subject":r.subject=le(c[1],t);break;case"body":r.body=le(c[1],t);break;default:i=!0,o[le(c[0],t)]=le(c[1],t)}}i&&(r.headers=o)}r.query=void 0;for(var p=0,h=n.length;p<h;++p){var m=n[p].split("@");if(m[0]=le(m[0]),t.unicodeSupport)m[1]=le(m[1],t).toLowerCase();else try{m[1]=L.toASCII(le(m[1],t).toLowerCase())}catch(e){r.error=r.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}n[p]=m.join("@")}return r},serialize:function(e,t){var r=e,n=o(e.to);if(n){for(var a=0,s=n.length;a<s;++a){var l=String(n[a]),c=l.lastIndexOf("@"),u=l.slice(0,c).replace(Ce,ke).replace(Ce,i).replace(Ee,B),d=l.slice(c+1);try{d=t.iri?L.toUnicode(d):L.toASCII(le(d,t).toLowerCase())}catch(e){r.error=r.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e}n[a]=u+"@"+d}r.path=n.join(",")}var f=e.headers=e.headers||{};e.subject&&(f.subject=e.subject),e.body&&(f.body=e.body);var p=[];for(var h in f)f[h]!==he[h]&&p.push(h.replace(Ce,ke).replace(Ce,i).replace(xe,B)+"="+f[h].replace(Ce,ke).replace(Ce,i).replace(Se,B));return p.length&&(r.query=p.join("&")),r}},Ie=/^([^\:]+)\:(.*)/,Re={scheme:"urn",parse:function(e,t){var r=e.path&&e.path.match(Ie),n=e;if(r){var i=t.scheme||n.scheme||"urn",o=r[1].toLowerCase(),a=r[2],s=i+":"+(t.nid||o),l=$[s];n.nid=o,n.nss=a,n.path=void 0,l&&(n=l.parse(n,t))}else n.error=n.error||"URN can not be parsed.";return n},serialize:function(e,t){var r=t.scheme||e.scheme||"urn",n=e.nid,i=r+":"+(t.nid||n),o=$[i];o&&(e=o.serialize(e,t));var a=e,s=e.nss;return a.path=(n||t.nid)+":"+s,a}},Te=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Ae={scheme:"urn:uuid",parse:function(e,t){var r=e;return r.uuid=r.nss,r.nss=void 0,!t.tolerant&&(!r.uuid||!r.uuid.match(Te))&&(r.error=r.error||"UUID is not valid."),r},serialize:function(e,t){var r=e;return r.nss=(e.uuid||"").toLowerCase(),r}};$[ce.scheme]=ce,$[ue.scheme]=ue,$[fe.scheme]=fe,$[pe.scheme]=pe,$[Oe.scheme]=Oe,$[Re.scheme]=Re,$[Ae.scheme]=Ae,e.SCHEMES=$,e.pctEncChar=B,e.pctDecChars=z,e.parse=Y,e.removeDotSegments=te,e.serialize=re,e.resolveComponents=ne,e.resolve=ie,e.normalize=oe,e.equal=ae,e.escapeComponent=se,e.unescapeComponent=le,Object.defineProperty(e,"__esModule",{value:!0})})(ewe.exports),Object.defineProperty(Qbe,"__esModule",{value:!0});const twe=ewe.exports;twe.code='require("ajv/dist/runtime/uri").default',Qbe.default=twe,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=Gge;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var r=Yge;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const n=Abe,i=Mbe,o=lye,a=Dbe,s=Yge,l=Fye,c=sye,u=Jge,d=Jbe,f=Qbe,p=(e,t)=>new RegExp(e,t);p.code="new RegExp";const h=["removeAdditional","useDefaults","coerceTypes"],m=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),v={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},g={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};function y(e){var t,r,n,i,o,a,s,l,c,u,d,h,m,v,g,y,b,w,_,C,E,x,S,k,O;const I=e.strict,R=null===(t=e.code)||void 0===t?void 0:t.optimize,T=!0===R||void 0===R?1:R||0,A=null!==(n=null===(r=e.code)||void 0===r?void 0:r.regExp)&&void 0!==n?n:p,N=null!==(i=e.uriResolver)&&void 0!==i?i:f.default;return{strictSchema:null===(a=null!==(o=e.strictSchema)&&void 0!==o?o:I)||void 0===a||a,strictNumbers:null===(l=null!==(s=e.strictNumbers)&&void 0!==s?s:I)||void 0===l||l,strictTypes:null!==(u=null!==(c=e.strictTypes)&&void 0!==c?c:I)&&void 0!==u?u:"log",strictTuples:null!==(h=null!==(d=e.strictTuples)&&void 0!==d?d:I)&&void 0!==h?h:"log",strictRequired:null!==(v=null!==(m=e.strictRequired)&&void 0!==m?m:I)&&void 0!==v&&v,code:e.code?{...e.code,optimize:T,regExp:A}:{optimize:T,regExp:A},loopRequired:null!==(g=e.loopRequired)&&void 0!==g?g:200,loopEnum:null!==(y=e.loopEnum)&&void 0!==y?y:200,meta:null===(b=e.meta)||void 0===b||b,messages:null===(w=e.messages)||void 0===w||w,inlineRefs:null===(_=e.inlineRefs)||void 0===_||_,schemaId:null!==(C=e.schemaId)&&void 0!==C?C:"$id",addUsedSchema:null===(E=e.addUsedSchema)||void 0===E||E,validateSchema:null===(x=e.validateSchema)||void 0===x||x,validateFormats:null===(S=e.validateFormats)||void 0===S||S,unicodeRegExp:null===(k=e.unicodeRegExp)||void 0===k||k,int32range:null===(O=e.int32range)||void 0===O||O,uriResolver:N}}class b{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...y(e)};const{es5:t,lines:r}=this.opts.code;this.scope=new s.ValueScope({scope:{},prefixes:m,es5:t,lines:r}),this.logger=function(e){if(!1===e)return k;if(void 0===e)return console;if(e.log&&e.warn&&e.error)return e;throw new Error("logger must implement log, warn and error methods")}(e.logger);const n=e.validateFormats;e.validateFormats=!1,this.RULES=(0,o.getRules)(),w.call(this,v,e,"NOT SUPPORTED"),w.call(this,g,e,"DEPRECATED","warn"),this._metaOpts=S.call(this),e.formats&&E.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&x.call(this,e.keywords),"object"==typeof e.meta&&this.addMetaSchema(e.meta),C.call(this),e.validateFormats=n}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:e,meta:t,schemaId:r}=this.opts;let n=d;"id"===r&&(n={...d},n.id=n.$id,delete n.$id),t&&e&&this.addMetaSchema(n,n[r],!1)}defaultMeta(){const{meta:e,schemaId:t}=this.opts;return this.opts.defaultMeta="object"==typeof e?e[t]||e:void 0}validate(e,t){let r;if("string"==typeof e){if(r=this.getSchema(e),!r)throw new Error(`no schema with key or ref "${e}"`)}else r=this.compile(e);const n=r(t);return"$async"in r||(this.errors=r.errors),n}compile(e,t){const r=this._addSchema(e,t);return r.validate||this._compileSchemaEnv(r)}compileAsync(e,t){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");const{loadSchema:r}=this.opts;return n.call(this,e,t);async function n(e,t){await o.call(this,e.$schema);const r=this._addSchema(e,t);return r.validate||a.call(this,r)}async function o(e){e&&!this.getSchema(e)&&await n.call(this,{$ref:e},!0)}async function a(e){try{return this._compileSchemaEnv(e)}catch(t){if(!(t instanceof i.default))throw t;return s.call(this,t),await l.call(this,t.missingSchema),a.call(this,e)}}function s({missingSchema:e,missingRef:t}){if(this.refs[e])throw new Error(`AnySchema ${e} is loaded but ${t} cannot be resolved`)}async function l(e){const r=await c.call(this,e);this.refs[e]||await o.call(this,r.$schema),this.refs[e]||this.addSchema(r,e,t)}async function c(e){const t=this._loading[e];if(t)return t;try{return await(this._loading[e]=r(e))}finally{delete this._loading[e]}}}addSchema(e,t,r,n=this.opts.validateSchema){if(Array.isArray(e)){for(const t of e)this.addSchema(t,void 0,r,n);return this}let i;if("object"==typeof e){const{schemaId:t}=this.opts;if(i=e[t],void 0!==i&&"string"!=typeof i)throw new Error(`schema ${t} must be string`)}return t=(0,l.normalizeId)(t||i),this._checkUnique(t),this.schemas[t]=this._addSchema(e,r,t,n,!0),this}addMetaSchema(e,t,r=this.opts.validateSchema){return this.addSchema(e,t,!0,r),this}validateSchema(e,t){if("boolean"==typeof e)return!0;let r;if(r=e.$schema,void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(r=r||this.opts.defaultMeta||this.defaultMeta(),!r)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const n=this.validate(r,e);if(!n&&t){const e="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(e);this.logger.error(e)}return n}getSchema(e){let t;for(;"string"==typeof(t=_.call(this,e));)e=t;if(void 0===t){const{schemaId:r}=this.opts,n=new a.SchemaEnv({schema:{},schemaId:r});if(t=a.resolveSchema.call(this,n,e),!t)return;this.refs[e]=t}return t.validate||this._compileSchemaEnv(t)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const t=_.call(this,e);return"object"==typeof t&&this._cache.delete(t.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{const t=e;this._cache.delete(t);let r=e[this.opts.schemaId];return r&&(r=(0,l.normalizeId)(r),delete this.schemas[r],delete this.refs[r]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(const t of e)this.addKeyword(t);return this}addKeyword(e,t){let r;if("string"==typeof e)r=e,"object"==typeof t&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=r);else{if("object"!=typeof e||void 0!==t)throw new Error("invalid addKeywords parameters");if(r=(t=e).keyword,Array.isArray(r)&&!r.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if(I.call(this,r,t),!t)return(0,u.eachItem)(r,(e=>R.call(this,e))),this;A.call(this,t);const n={...t,type:(0,c.getJSONTypes)(t.type),schemaType:(0,c.getJSONTypes)(t.schemaType)};return(0,u.eachItem)(r,0===n.type.length?e=>R.call(this,e,n):e=>n.type.forEach((t=>R.call(this,e,n,t)))),this}getKeyword(e){const t=this.RULES.all[e];return"object"==typeof t?t.definition:!!t}removeKeyword(e){const{RULES:t}=this;delete t.keywords[e],delete t.all[e];for(const r of t.rules){const t=r.rules.findIndex((t=>t.keyword===e));t>=0&&r.rules.splice(t,1)}return this}addFormat(e,t){return"string"==typeof t&&(t=new RegExp(t)),this.formats[e]=t,this}errorsText(e=this.errors,{separator:t=", ",dataVar:r="data"}={}){return e&&0!==e.length?e.map((e=>`${r}${e.instancePath} ${e.message}`)).reduce(((e,r)=>e+t+r)):"No errors"}$dataMetaSchema(e,t){const r=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(const n of t){const t=n.split("/").slice(1);let i=e;for(const e of t)i=i[e];for(const e in r){const t=r[e];if("object"!=typeof t)continue;const{$data:n}=t.definition,o=i[e];n&&o&&(i[e]=M(o))}}return e}_removeAllSchemas(e,t){for(const r in e){const n=e[r];(!t||t.test(r))&&("string"==typeof n?delete e[r]:n&&!n.meta&&(this._cache.delete(n.schema),delete e[r]))}}_addSchema(e,t,r,n=this.opts.validateSchema,i=this.opts.addUsedSchema){let o;const{schemaId:s}=this.opts;if("object"==typeof e)o=e[s];else{if(this.opts.jtd)throw new Error("schema must be object");if("boolean"!=typeof e)throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(void 0!==c)return c;r=(0,l.normalizeId)(o||r);const u=l.getSchemaRefs.call(this,e,r);return c=new a.SchemaEnv({schema:e,schemaId:s,meta:t,baseId:r,localRefs:u}),this._cache.set(c.schema,c),i&&!r.startsWith("#")&&(r&&this._checkUnique(r),this.refs[r]=c),n&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):a.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){const t=this.opts;this.opts=this._metaOpts;try{a.compileSchema.call(this,e)}finally{this.opts=t}}}function w(e,t,r,n="error"){for(const i in e){const o=i;o in t&&this.logger[n](`${r}: option ${i}. ${e[o]}`)}}function _(e){return e=(0,l.normalizeId)(e),this.schemas[e]||this.refs[e]}function C(){const e=this.opts.schemas;if(e)if(Array.isArray(e))this.addSchema(e);else for(const t in e)this.addSchema(e[t],t)}function E(){for(const e in this.opts.formats){const t=this.opts.formats[e];t&&this.addFormat(e,t)}}function x(e){if(Array.isArray(e))this.addVocabulary(e);else{this.logger.warn("keywords option as map is deprecated, pass array");for(const t in e){const r=e[t];r.keyword||(r.keyword=t),this.addKeyword(r)}}}function S(){const e={...this.opts};for(const t of h)delete e[t];return e}e.default=b,b.ValidationError=n.default,b.MissingRefError=i.default;const k={log(){},warn(){},error(){}};const O=/^[a-z_$][a-z0-9_$:-]*$/i;function I(e,t){const{RULES:r}=this;if((0,u.eachItem)(e,(e=>{if(r.keywords[e])throw new Error(`Keyword ${e} is already defined`);if(!O.test(e))throw new Error(`Keyword ${e} has invalid name`)})),t&&t.$data&&!("code"in t)&&!("validate"in t))throw new Error('$data keyword must have "code" or "validate" function')}function R(e,t,r){var n;const i=null==t?void 0:t.post;if(r&&i)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:o}=this;let a=i?o.post:o.rules.find((({type:e})=>e===r));if(a||(a={type:r,rules:[]},o.rules.push(a)),o.keywords[e]=!0,!t)return;const s={keyword:e,definition:{...t,type:(0,c.getJSONTypes)(t.type),schemaType:(0,c.getJSONTypes)(t.schemaType)}};t.before?T.call(this,a,s,t.before):a.rules.push(s),o.all[e]=s,null===(n=t.implements)||void 0===n||n.forEach((e=>this.addKeyword(e)))}function T(e,t,r){const n=e.rules.findIndex((e=>e.keyword===r));n>=0?e.rules.splice(n,0,t):(e.rules.push(t),this.logger.warn(`rule ${r} is not defined`))}function A(e){let{metaSchema:t}=e;void 0!==t&&(e.$data&&this.opts.$data&&(t=M(t)),e.validateSchema=this.compile(t,!0))}const N={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function M(e){return{anyOf:[e,N]}}}(Wge);var rwe={},nwe={},iwe={};Object.defineProperty(iwe,"__esModule",{value:!0});const owe={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};iwe.default=owe;var awe={};Object.defineProperty(awe,"__esModule",{value:!0}),awe.callRef=awe.getValidate=void 0;const swe=Mbe,lwe=yye,cwe=Yge,uwe=Qge,dwe=Dbe,fwe=Jge,pwe={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:r,it:n}=e,{baseId:i,schemaEnv:o,validateName:a,opts:s,self:l}=n,{root:c}=o;if(("#"===r||"#/"===r)&&i===c.baseId)return function(){if(o===c)return mwe(e,a,o,o.$async);const r=t.scopeValue("root",{ref:c});return mwe(e,cwe._`${r}.validate`,c,c.$async)}();const u=dwe.resolveRef.call(l,c,i,r);if(void 0===u)throw new swe.default(n.opts.uriResolver,i,r);return u instanceof dwe.SchemaEnv?function(t){const r=hwe(e,t);mwe(e,r,t,t.$async)}(u):function(n){const i=t.scopeValue("schema",!0===s.code.source?{ref:n,code:(0,cwe.stringify)(n)}:{ref:n}),o=t.name("valid"),a=e.subschema({schema:n,dataTypes:[],schemaPath:cwe.nil,topSchemaRef:i,errSchemaPath:r},o);e.mergeEvaluated(a),e.ok(o)}(u)}};function hwe(e,t){const{gen:r}=e;return t.validate?r.scopeValue("validate",{ref:t.validate}):cwe._`${r.scopeValue("wrapper",{ref:t})}.validate`}function mwe(e,t,r,n){const{gen:i,it:o}=e,{allErrors:a,schemaEnv:s,opts:l}=o,c=l.passContext?uwe.default.this:cwe.nil;function u(e){const t=cwe._`${e}.errors`;i.assign(uwe.default.vErrors,cwe._`${uwe.default.vErrors} === null ? ${t} : ${uwe.default.vErrors}.concat(${t})`),i.assign(uwe.default.errors,cwe._`${uwe.default.vErrors}.length`)}function d(e){var t;if(!o.opts.unevaluated)return;const n=null===(t=null==r?void 0:r.validate)||void 0===t?void 0:t.evaluated;if(!0!==o.props)if(n&&!n.dynamicProps)void 0!==n.props&&(o.props=fwe.mergeEvaluated.props(i,n.props,o.props));else{const t=i.var("props",cwe._`${e}.evaluated.props`);o.props=fwe.mergeEvaluated.props(i,t,o.props,cwe.Name)}if(!0!==o.items)if(n&&!n.dynamicItems)void 0!==n.items&&(o.items=fwe.mergeEvaluated.items(i,n.items,o.items));else{const t=i.var("items",cwe._`${e}.evaluated.items`);o.items=fwe.mergeEvaluated.items(i,t,o.items,cwe.Name)}}n?function(){if(!s.$async)throw new Error("async schema referenced by sync schema");const r=i.let("valid");i.try((()=>{i.code(cwe._`await ${(0,lwe.callValidateCode)(e,t,c)}`),d(t),a||i.assign(r,!0)}),(e=>{i.if(cwe._`!(${e} instanceof ${o.ValidationError})`,(()=>i.throw(e))),u(e),a||i.assign(r,!1)})),e.ok(r)}():e.result((0,lwe.callValidateCode)(e,t,c),(()=>d(t)),(()=>u(t)))}awe.getValidate=hwe,awe.callRef=mwe,awe.default=pwe,Object.defineProperty(nwe,"__esModule",{value:!0});const vwe=awe,gwe=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",iwe.default,vwe.default];nwe.default=gwe;var ywe={},bwe={};Object.defineProperty(bwe,"__esModule",{value:!0});const wwe=Yge,_we=wwe.operators,Cwe={maximum:{okStr:"<=",ok:_we.LTE,fail:_we.GT},minimum:{okStr:">=",ok:_we.GTE,fail:_we.LT},exclusiveMaximum:{okStr:"<",ok:_we.LT,fail:_we.GTE},exclusiveMinimum:{okStr:">",ok:_we.GT,fail:_we.LTE}},Ewe={message:({keyword:e,schemaCode:t})=>wwe.str`must be ${Cwe[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>wwe._`{comparison: ${Cwe[e].okStr}, limit: ${t}}`},xwe={keyword:Object.keys(Cwe),type:"number",schemaType:"number",$data:!0,error:Ewe,code(e){const{keyword:t,data:r,schemaCode:n}=e;e.fail$data(wwe._`${r} ${Cwe[t].fail} ${n} || isNaN(${r})`)}};bwe.default=xwe;var Swe={};Object.defineProperty(Swe,"__esModule",{value:!0});const kwe=Yge,Owe={message:({schemaCode:e})=>kwe.str`must be multiple of ${e}`,params:({schemaCode:e})=>kwe._`{multipleOf: ${e}}`},Iwe={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:Owe,code(e){const{gen:t,data:r,schemaCode:n,it:i}=e,o=i.opts.multipleOfPrecision,a=t.let("res"),s=o?kwe._`Math.abs(Math.round(${a}) - ${a}) > 1e-${o}`:kwe._`${a} !== parseInt(${a})`;e.fail$data(kwe._`(${n} === 0 || (${a} = ${r}/${n}, ${s}))`)}};Swe.default=Iwe;var Rwe={},Twe={};function Awe(e){const t=e.length;let r,n=0,i=0;for(;i<t;)n++,r=e.charCodeAt(i++),r>=55296&&r<=56319&&i<t&&(r=e.charCodeAt(i),56320==(64512&r)&&i++);return n}Object.defineProperty(Twe,"__esModule",{value:!0}),Twe.default=Awe,Awe.code='require("ajv/dist/runtime/ucs2length").default',Object.defineProperty(Rwe,"__esModule",{value:!0});const Nwe=Yge,Mwe=Jge,Pwe=Twe,jwe={message:({keyword:e,schemaCode:t})=>Nwe.str`must NOT have ${"maxLength"===e?"more":"fewer"} than ${t} characters`,params:({schemaCode:e})=>Nwe._`{limit: ${e}}`},Dwe={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:jwe,code(e){const{keyword:t,data:r,schemaCode:n,it:i}=e,o="maxLength"===t?Nwe.operators.GT:Nwe.operators.LT,a=!1===i.opts.unicode?Nwe._`${r}.length`:Nwe._`${(0,Mwe.useFunc)(e.gen,Pwe.default)}(${r})`;e.fail$data(Nwe._`${a} ${o} ${n}`)}};Rwe.default=Dwe;var Fwe={};Object.defineProperty(Fwe,"__esModule",{value:!0});const Vwe=yye,Lwe=Yge,$we={message:({schemaCode:e})=>Lwe.str`must match pattern "${e}"`,params:({schemaCode:e})=>Lwe._`{pattern: ${e}}`},Bwe={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:$we,code(e){const{data:t,$data:r,schema:n,schemaCode:i,it:o}=e,a=o.opts.unicodeRegExp?"u":"",s=r?Lwe._`(new RegExp(${i}, ${a}))`:(0,Vwe.usePattern)(e,n);e.fail$data(Lwe._`!${s}.test(${t})`)}};Fwe.default=Bwe;var zwe={};Object.defineProperty(zwe,"__esModule",{value:!0});const Uwe=Yge,Hwe={message:({keyword:e,schemaCode:t})=>Uwe.str`must NOT have ${"maxProperties"===e?"more":"fewer"} than ${t} properties`,params:({schemaCode:e})=>Uwe._`{limit: ${e}}`},Wwe={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:Hwe,code(e){const{keyword:t,data:r,schemaCode:n}=e,i="maxProperties"===t?Uwe.operators.GT:Uwe.operators.LT;e.fail$data(Uwe._`Object.keys(${r}).length ${i} ${n}`)}};zwe.default=Wwe;var Gwe={};Object.defineProperty(Gwe,"__esModule",{value:!0});const Kwe=yye,qwe=Yge,Ywe=Jge,Xwe={message:({params:{missingProperty:e}})=>qwe.str`must have required property '${e}'`,params:({params:{missingProperty:e}})=>qwe._`{missingProperty: ${e}}`},Zwe={keyword:"required",type:"object",schemaType:"array",$data:!0,error:Xwe,code(e){const{gen:t,schema:r,schemaCode:n,data:i,$data:o,it:a}=e,{opts:s}=a;if(!o&&0===r.length)return;const l=r.length>=s.loopRequired;if(a.allErrors?function(){if(l||o)e.block$data(qwe.nil,c);else for(const t of r)(0,Kwe.checkReportMissingProp)(e,t)}():function(){const a=t.let("missing");if(l||o){const r=t.let("valid",!0);e.block$data(r,(()=>function(r,o){e.setParams({missingProperty:r}),t.forOf(r,n,(()=>{t.assign(o,(0,Kwe.propertyInData)(t,i,r,s.ownProperties)),t.if((0,qwe.not)(o),(()=>{e.error(),t.break()}))}),qwe.nil)}(a,r))),e.ok(r)}else t.if((0,Kwe.checkMissingProp)(e,r,a)),(0,Kwe.reportMissingProp)(e,a),t.else()}(),s.strictRequired){const t=e.parentSchema.properties,{definedProperties:n}=e.it;for(const e of r)if(void 0===(null==t?void 0:t[e])&&!n.has(e)){const t=a.schemaEnv.baseId+a.errSchemaPath;(0,Ywe.checkStrictMode)(a,`required property "${e}" is not defined at "${t}" (strictRequired)`,a.opts.strictRequired)}}function c(){t.forOf("prop",n,(r=>{e.setParams({missingProperty:r}),t.if((0,Kwe.noPropertyInData)(t,i,r,s.ownProperties),(()=>e.error()))}))}}};Gwe.default=Zwe;var Jwe={};Object.defineProperty(Jwe,"__esModule",{value:!0});const Qwe=Yge,e_e={message:({keyword:e,schemaCode:t})=>Qwe.str`must NOT have ${"maxItems"===e?"more":"fewer"} than ${t} items`,params:({schemaCode:e})=>Qwe._`{limit: ${e}}`},t_e={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:e_e,code(e){const{keyword:t,data:r,schemaCode:n}=e,i="maxItems"===t?Qwe.operators.GT:Qwe.operators.LT;e.fail$data(Qwe._`${r}.length ${i} ${n}`)}};Jwe.default=t_e;var r_e={},n_e={};Object.defineProperty(n_e,"__esModule",{value:!0});const i_e=Vye;i_e.code='require("ajv/dist/runtime/equal").default',n_e.default=i_e,Object.defineProperty(r_e,"__esModule",{value:!0});const o_e=sye,a_e=Yge,s_e=Jge,l_e=n_e,c_e={message:({params:{i:e,j:t}})=>a_e.str`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>a_e._`{i: ${e}, j: ${t}}`},u_e={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:c_e,code(e){const{gen:t,data:r,$data:n,schema:i,parentSchema:o,schemaCode:a,it:s}=e;if(!n&&!i)return;const l=t.let("valid"),c=o.items?(0,o_e.getSchemaTypes)(o.items):[];function u(n,i){const o=t.name("item"),a=(0,o_e.checkDataTypes)(c,o,s.opts.strictNumbers,o_e.DataType.Wrong),u=t.const("indices",a_e._`{}`);t.for(a_e._`;${n}--;`,(()=>{t.let(o,a_e._`${r}[${n}]`),t.if(a,a_e._`continue`),c.length>1&&t.if(a_e._`typeof ${o} == "string"`,a_e._`${o} += "_"`),t.if(a_e._`typeof ${u}[${o}] == "number"`,(()=>{t.assign(i,a_e._`${u}[${o}]`),e.error(),t.assign(l,!1).break()})).code(a_e._`${u}[${o}] = ${n}`)}))}function d(n,i){const o=(0,s_e.useFunc)(t,l_e.default),a=t.name("outer");t.label(a).for(a_e._`;${n}--;`,(()=>t.for(a_e._`${i} = ${n}; ${i}--;`,(()=>t.if(a_e._`${o}(${r}[${n}], ${r}[${i}])`,(()=>{e.error(),t.assign(l,!1).break(a)}))))))}e.block$data(l,(function(){const n=t.let("i",a_e._`${r}.length`),i=t.let("j");e.setParams({i:n,j:i}),t.assign(l,!0),t.if(a_e._`${n} > 1`,(()=>(c.length>0&&!c.some((e=>"object"===e||"array"===e))?u:d)(n,i)))}),a_e._`${a} === false`),e.ok(l)}};r_e.default=u_e;var d_e={};Object.defineProperty(d_e,"__esModule",{value:!0});const f_e=Yge,p_e=Jge,h_e=n_e,m_e={message:"must be equal to constant",params:({schemaCode:e})=>f_e._`{allowedValue: ${e}}`},v_e={keyword:"const",$data:!0,error:m_e,code(e){const{gen:t,data:r,$data:n,schemaCode:i,schema:o}=e;n||o&&"object"==typeof o?e.fail$data(f_e._`!${(0,p_e.useFunc)(t,h_e.default)}(${r}, ${i})`):e.fail(f_e._`${o} !== ${r}`)}};d_e.default=v_e;var g_e={};Object.defineProperty(g_e,"__esModule",{value:!0});const y_e=Yge,b_e=Jge,w_e=n_e,__e={message:"must be equal to one of the allowed values",params:({schemaCode:e})=>y_e._`{allowedValues: ${e}}`},C_e={keyword:"enum",schemaType:"array",$data:!0,error:__e,code(e){const{gen:t,data:r,$data:n,schema:i,schemaCode:o,it:a}=e;if(!n&&0===i.length)throw new Error("enum must have non-empty array");const s=i.length>=a.opts.loopEnum;let l;const c=()=>null!=l?l:l=(0,b_e.useFunc)(t,w_e.default);let u;if(s||n)u=t.let("valid"),e.block$data(u,(function(){t.assign(u,!1),t.forOf("v",o,(e=>t.if(y_e._`${c()}(${r}, ${e})`,(()=>t.assign(u,!0).break()))))}));else{if(!Array.isArray(i))throw new Error("ajv implementation error");const e=t.const("vSchema",o);u=(0,y_e.or)(...i.map(((t,n)=>function(e,t){const n=i[t];return"object"==typeof n&&null!==n?y_e._`${c()}(${r}, ${e}[${t}])`:y_e._`${r} === ${n}`}(e,n))))}e.pass(u)}};g_e.default=C_e,Object.defineProperty(ywe,"__esModule",{value:!0});const E_e=Swe,x_e=Rwe,S_e=Fwe,k_e=zwe,O_e=Gwe,I_e=Jwe,R_e=r_e,T_e=d_e,A_e=g_e,N_e=[bwe.default,E_e.default,x_e.default,S_e.default,k_e.default,O_e.default,I_e.default,R_e.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},T_e.default,A_e.default];ywe.default=N_e;var M_e={},P_e={};Object.defineProperty(P_e,"__esModule",{value:!0}),P_e.validateAdditionalItems=void 0;const j_e=Yge,D_e=Jge,F_e={message:({params:{len:e}})=>j_e.str`must NOT have more than ${e} items`,params:({params:{len:e}})=>j_e._`{limit: ${e}}`},V_e={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:F_e,code(e){const{parentSchema:t,it:r}=e,{items:n}=t;Array.isArray(n)?L_e(e,n):(0,D_e.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas')}};function L_e(e,t){const{gen:r,schema:n,data:i,keyword:o,it:a}=e;a.items=!0;const s=r.const("len",j_e._`${i}.length`);if(!1===n)e.setParams({len:t.length}),e.pass(j_e._`${s} <= ${t.length}`);else if("object"==typeof n&&!(0,D_e.alwaysValidSchema)(a,n)){const n=r.var("valid",j_e._`${s} <= ${t.length}`);r.if((0,j_e.not)(n),(()=>function(n){r.forRange("i",t.length,s,(t=>{e.subschema({keyword:o,dataProp:t,dataPropType:D_e.Type.Num},n),a.allErrors||r.if((0,j_e.not)(n),(()=>r.break()))}))}(n))),e.ok(n)}}P_e.validateAdditionalItems=L_e,P_e.default=V_e;var $_e={},B_e={};Object.defineProperty(B_e,"__esModule",{value:!0}),B_e.validateTuple=void 0;const z_e=Yge,U_e=Jge,H_e=yye,W_e={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:r}=e;if(Array.isArray(t))return G_e(e,"additionalItems",t);r.items=!0,!(0,U_e.alwaysValidSchema)(r,t)&&e.ok((0,H_e.validateArray)(e))}};function G_e(e,t,r=e.schema){const{gen:n,parentSchema:i,data:o,keyword:a,it:s}=e;(function(e){const{opts:n,errSchemaPath:i}=s,o=r.length,l=o===e.minItems&&(o===e.maxItems||!1===e[t]);if(n.strictTuples&&!l){const e=`"${a}" is ${o}-tuple, but minItems or maxItems/${t} are not specified or different at path "${i}"`;(0,U_e.checkStrictMode)(s,e,n.strictTuples)}})(i),s.opts.unevaluated&&r.length&&!0!==s.items&&(s.items=U_e.mergeEvaluated.items(n,r.length,s.items));const l=n.name("valid"),c=n.const("len",z_e._`${o}.length`);r.forEach(((t,r)=>{(0,U_e.alwaysValidSchema)(s,t)||(n.if(z_e._`${c} > ${r}`,(()=>e.subschema({keyword:a,schemaProp:r,dataProp:r},l))),e.ok(l))}))}B_e.validateTuple=G_e,B_e.default=W_e,Object.defineProperty($_e,"__esModule",{value:!0});const K_e=B_e,q_e={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,K_e.validateTuple)(e,"items")};$_e.default=q_e;var Y_e={};Object.defineProperty(Y_e,"__esModule",{value:!0});const X_e=Yge,Z_e=Jge,J_e=yye,Q_e=P_e,eCe={message:({params:{len:e}})=>X_e.str`must NOT have more than ${e} items`,params:({params:{len:e}})=>X_e._`{limit: ${e}}`},tCe={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:eCe,code(e){const{schema:t,parentSchema:r,it:n}=e,{prefixItems:i}=r;n.items=!0,!(0,Z_e.alwaysValidSchema)(n,t)&&(i?(0,Q_e.validateAdditionalItems)(e,i):e.ok((0,J_e.validateArray)(e)))}};Y_e.default=tCe;var rCe={};Object.defineProperty(rCe,"__esModule",{value:!0});const nCe=Yge,iCe=Jge,oCe={message:({params:{min:e,max:t}})=>void 0===t?nCe.str`must contain at least ${e} valid item(s)`:nCe.str`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>void 0===t?nCe._`{minContains: ${e}}`:nCe._`{minContains: ${e}, maxContains: ${t}}`},aCe={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:oCe,code(e){const{gen:t,schema:r,parentSchema:n,data:i,it:o}=e;let a,s;const{minContains:l,maxContains:c}=n;o.opts.next?(a=void 0===l?1:l,s=c):a=1;const u=t.const("len",nCe._`${i}.length`);if(e.setParams({min:a,max:s}),void 0===s&&0===a)return void(0,iCe.checkStrictMode)(o,'"minContains" == 0 without "maxContains": "contains" keyword ignored');if(void 0!==s&&a>s)return(0,iCe.checkStrictMode)(o,'"minContains" > "maxContains" is always invalid'),void e.fail();if((0,iCe.alwaysValidSchema)(o,r)){let t=nCe._`${u} >= ${a}`;return void 0!==s&&(t=nCe._`${t} && ${u} <= ${s}`),void e.pass(t)}o.items=!0;const d=t.name("valid");function f(){const e=t.name("_valid"),r=t.let("count",0);p(e,(()=>t.if(e,(()=>function(e){t.code(nCe._`${e}++`),void 0===s?t.if(nCe._`${e} >= ${a}`,(()=>t.assign(d,!0).break())):(t.if(nCe._`${e} > ${s}`,(()=>t.assign(d,!1).break())),1===a?t.assign(d,!0):t.if(nCe._`${e} >= ${a}`,(()=>t.assign(d,!0))))}(r)))))}function p(r,n){t.forRange("i",0,u,(t=>{e.subschema({keyword:"contains",dataProp:t,dataPropType:iCe.Type.Num,compositeRule:!0},r),n()}))}void 0===s&&1===a?p(d,(()=>t.if(d,(()=>t.break())))):0===a?(t.let(d,!0),void 0!==s&&t.if(nCe._`${i}.length > 0`,f)):(t.let(d,!1),f()),e.result(d,(()=>e.reset()))}};rCe.default=aCe;var sCe={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=Yge,r=Jge,n=yye;e.error={message:({params:{property:e,depsCount:r,deps:n}})=>t.str`must have ${1===r?"property":"properties"} ${n} when property ${e} is present`,params:({params:{property:e,depsCount:r,deps:n,missingProperty:i}})=>t._`{property: ${e},
    missingProperty: ${i},
    depsCount: ${r},
    deps: ${n}}`};const i={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(e){const[t,r]=function({schema:e}){const t={},r={};for(const n in e){if("__proto__"===n)continue;(Array.isArray(e[n])?t:r)[n]=e[n]}return[t,r]}(e);o(e,t),a(e,r)}};function o(e,r=e.schema){const{gen:i,data:o,it:a}=e;if(0===Object.keys(r).length)return;const s=i.let("missing");for(const l in r){const c=r[l];if(0===c.length)continue;const u=(0,n.propertyInData)(i,o,l,a.opts.ownProperties);e.setParams({property:l,depsCount:c.length,deps:c.join(", ")}),a.allErrors?i.if(u,(()=>{for(const t of c)(0,n.checkReportMissingProp)(e,t)})):(i.if(t._`${u} && (${(0,n.checkMissingProp)(e,c,s)})`),(0,n.reportMissingProp)(e,s),i.else())}}function a(e,t=e.schema){const{gen:i,data:o,keyword:a,it:s}=e,l=i.name("valid");for(const c in t)(0,r.alwaysValidSchema)(s,t[c])||(i.if((0,n.propertyInData)(i,o,c,s.opts.ownProperties),(()=>{const t=e.subschema({keyword:a,schemaProp:c},l);e.mergeValidEvaluated(t,l)}),(()=>i.var(l,!0))),e.ok(l))}e.validatePropertyDeps=o,e.validateSchemaDeps=a,e.default=i}(sCe);var lCe={};Object.defineProperty(lCe,"__esModule",{value:!0});const cCe=Yge,uCe=Jge,dCe={message:"property name must be valid",params:({params:e})=>cCe._`{propertyName: ${e.propertyName}}`},fCe={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:dCe,code(e){const{gen:t,schema:r,data:n,it:i}=e;if((0,uCe.alwaysValidSchema)(i,r))return;const o=t.name("valid");t.forIn("key",n,(r=>{e.setParams({propertyName:r}),e.subschema({keyword:"propertyNames",data:r,dataTypes:["string"],propertyName:r,compositeRule:!0},o),t.if((0,cCe.not)(o),(()=>{e.error(!0),i.allErrors||t.break()}))})),e.ok(o)}};lCe.default=fCe;var pCe={};Object.defineProperty(pCe,"__esModule",{value:!0});const hCe=yye,mCe=Yge,vCe=Qge,gCe=Jge,yCe={message:"must NOT have additional properties",params:({params:e})=>mCe._`{additionalProperty: ${e.additionalProperty}}`},bCe={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:yCe,code(e){const{gen:t,schema:r,parentSchema:n,data:i,errsCount:o,it:a}=e;if(!o)throw new Error("ajv implementation error");const{allErrors:s,opts:l}=a;if(a.props=!0,"all"!==l.removeAdditional&&(0,gCe.alwaysValidSchema)(a,r))return;const c=(0,hCe.allSchemaProperties)(n.properties),u=(0,hCe.allSchemaProperties)(n.patternProperties);function d(e){t.code(mCe._`delete ${i}[${e}]`)}function f(n){if("all"===l.removeAdditional||l.removeAdditional&&!1===r)d(n);else{if(!1===r)return e.setParams({additionalProperty:n}),e.error(),void(s||t.break());if("object"==typeof r&&!(0,gCe.alwaysValidSchema)(a,r)){const r=t.name("valid");"failing"===l.removeAdditional?(p(n,r,!1),t.if((0,mCe.not)(r),(()=>{e.reset(),d(n)}))):(p(n,r),s||t.if((0,mCe.not)(r),(()=>t.break())))}}}function p(t,r,n){const i={keyword:"additionalProperties",dataProp:t,dataPropType:gCe.Type.Str};!1===n&&Object.assign(i,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(i,r)}t.forIn("key",i,(r=>{c.length||u.length?t.if(function(r){let i;if(c.length>8){const e=(0,gCe.schemaRefOrVal)(a,n.properties,"properties");i=(0,hCe.isOwnProperty)(t,e,r)}else i=c.length?(0,mCe.or)(...c.map((e=>mCe._`${r} === ${e}`))):mCe.nil;return u.length&&(i=(0,mCe.or)(i,...u.map((t=>mCe._`${(0,hCe.usePattern)(e,t)}.test(${r})`)))),(0,mCe.not)(i)}(r),(()=>f(r))):f(r)})),e.ok(mCe._`${o} === ${vCe.default.errors}`)}};pCe.default=bCe;var wCe={};Object.defineProperty(wCe,"__esModule",{value:!0});const _Ce=Gge,CCe=yye,ECe=Jge,xCe=pCe,SCe={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,parentSchema:n,data:i,it:o}=e;"all"===o.opts.removeAdditional&&void 0===n.additionalProperties&&xCe.default.code(new _Ce.KeywordCxt(o,xCe.default,"additionalProperties"));const a=(0,CCe.allSchemaProperties)(r);for(const e of a)o.definedProperties.add(e);o.opts.unevaluated&&a.length&&!0!==o.props&&(o.props=ECe.mergeEvaluated.props(t,(0,ECe.toHash)(a),o.props));const s=a.filter((e=>!(0,ECe.alwaysValidSchema)(o,r[e])));if(0===s.length)return;const l=t.name("valid");for(const r of s)c(r)?u(r):(t.if((0,CCe.propertyInData)(t,i,r,o.opts.ownProperties)),u(r),o.allErrors||t.else().var(l,!0),t.endIf()),e.it.definedProperties.add(r),e.ok(l);function c(e){return o.opts.useDefaults&&!o.compositeRule&&void 0!==r[e].default}function u(t){e.subschema({keyword:"properties",schemaProp:t,dataProp:t},l)}}};wCe.default=SCe;var kCe={};Object.defineProperty(kCe,"__esModule",{value:!0});const OCe=yye,ICe=Yge,RCe=Jge,TCe=Jge,ACe={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,data:n,parentSchema:i,it:o}=e,{opts:a}=o,s=(0,OCe.allSchemaProperties)(r),l=s.filter((e=>(0,RCe.alwaysValidSchema)(o,r[e])));if(0===s.length||l.length===s.length&&(!o.opts.unevaluated||!0===o.props))return;const c=a.strictSchema&&!a.allowMatchingProperties&&i.properties,u=t.name("valid");!0!==o.props&&!(o.props instanceof ICe.Name)&&(o.props=(0,TCe.evaluatedPropsToName)(t,o.props));const{props:d}=o;function f(e){for(const t in c)new RegExp(e).test(t)&&(0,RCe.checkStrictMode)(o,`property ${t} matches pattern ${e} (use allowMatchingProperties)`)}function p(r){t.forIn("key",n,(n=>{t.if(ICe._`${(0,OCe.usePattern)(e,r)}.test(${n})`,(()=>{const i=l.includes(r);i||e.subschema({keyword:"patternProperties",schemaProp:r,dataProp:n,dataPropType:TCe.Type.Str},u),o.opts.unevaluated&&!0!==d?t.assign(ICe._`${d}[${n}]`,!0):!i&&!o.allErrors&&t.if((0,ICe.not)(u),(()=>t.break()))}))}))}!function(){for(const e of s)c&&f(e),o.allErrors?p(e):(t.var(u,!0),p(e),t.if(u))}()}};kCe.default=ACe;var NCe={};Object.defineProperty(NCe,"__esModule",{value:!0});const MCe=Jge,PCe={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:r,it:n}=e;if((0,MCe.alwaysValidSchema)(n,r))return void e.fail();const i=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},i),e.failResult(i,(()=>e.reset()),(()=>e.error()))},error:{message:"must NOT be valid"}};NCe.default=PCe;var jCe={};Object.defineProperty(jCe,"__esModule",{value:!0});const DCe={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:yye.validateUnion,error:{message:"must match a schema in anyOf"}};jCe.default=DCe;var FCe={};Object.defineProperty(FCe,"__esModule",{value:!0});const VCe=Yge,LCe=Jge,$Ce={message:"must match exactly one schema in oneOf",params:({params:e})=>VCe._`{passingSchemas: ${e.passing}}`},BCe={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:$Ce,code(e){const{gen:t,schema:r,parentSchema:n,it:i}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(i.opts.discriminator&&n.discriminator)return;const o=r,a=t.let("valid",!1),s=t.let("passing",null),l=t.name("_valid");e.setParams({passing:s}),t.block((function(){o.forEach(((r,n)=>{let o;(0,LCe.alwaysValidSchema)(i,r)?t.var(l,!0):o=e.subschema({keyword:"oneOf",schemaProp:n,compositeRule:!0},l),n>0&&t.if(VCe._`${l} && ${a}`).assign(a,!1).assign(s,VCe._`[${s}, ${n}]`).else(),t.if(l,(()=>{t.assign(a,!0),t.assign(s,n),o&&e.mergeEvaluated(o,VCe.Name)}))}))})),e.result(a,(()=>e.reset()),(()=>e.error(!0)))}};FCe.default=BCe;var zCe={};Object.defineProperty(zCe,"__esModule",{value:!0});const UCe=Jge,HCe={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:r,it:n}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");const i=t.name("valid");r.forEach(((t,r)=>{if((0,UCe.alwaysValidSchema)(n,t))return;const o=e.subschema({keyword:"allOf",schemaProp:r},i);e.ok(i),e.mergeEvaluated(o)}))}};zCe.default=HCe;var WCe={};Object.defineProperty(WCe,"__esModule",{value:!0});const GCe=Yge,KCe=Jge,qCe={message:({params:e})=>GCe.str`must match "${e.ifClause}" schema`,params:({params:e})=>GCe._`{failingKeyword: ${e.ifClause}}`},YCe={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:qCe,code(e){const{gen:t,parentSchema:r,it:n}=e;void 0===r.then&&void 0===r.else&&(0,KCe.checkStrictMode)(n,'"if" without "then" and "else" is ignored');const i=XCe(n,"then"),o=XCe(n,"else");if(!i&&!o)return;const a=t.let("valid",!0),s=t.name("_valid");if(function(){const t=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},s);e.mergeEvaluated(t)}(),e.reset(),i&&o){const r=t.let("ifClause");e.setParams({ifClause:r}),t.if(s,l("then",r),l("else",r))}else i?t.if(s,l("then")):t.if((0,GCe.not)(s),l("else"));function l(r,n){return()=>{const i=e.subschema({keyword:r},s);t.assign(a,s),e.mergeValidEvaluated(i,a),n?t.assign(n,GCe._`${r}`):e.setParams({ifClause:r})}}e.pass(a,(()=>e.error(!0)))}};function XCe(e,t){const r=e.schema[t];return void 0!==r&&!(0,KCe.alwaysValidSchema)(e,r)}WCe.default=YCe;var ZCe={};Object.defineProperty(ZCe,"__esModule",{value:!0});const JCe=Jge,QCe={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:r}){void 0===t.if&&(0,JCe.checkStrictMode)(r,`"${e}" without "if" is ignored`)}};ZCe.default=QCe,Object.defineProperty(M_e,"__esModule",{value:!0});const eEe=P_e,tEe=$_e,rEe=B_e,nEe=Y_e,iEe=rCe,oEe=sCe,aEe=lCe,sEe=pCe,lEe=wCe,cEe=kCe,uEe=NCe,dEe=jCe,fEe=FCe,pEe=zCe,hEe=WCe,mEe=ZCe;M_e.default=function(e=!1){const t=[uEe.default,dEe.default,fEe.default,pEe.default,hEe.default,mEe.default,aEe.default,sEe.default,oEe.default,lEe.default,cEe.default];return e?t.push(tEe.default,nEe.default):t.push(eEe.default,rEe.default),t.push(iEe.default),t};var vEe={},gEe={};Object.defineProperty(gEe,"__esModule",{value:!0});const yEe=Yge,bEe={message:({schemaCode:e})=>yEe.str`must match format "${e}"`,params:({schemaCode:e})=>yEe._`{format: ${e}}`},wEe={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:bEe,code(e,t){const{gen:r,data:n,$data:i,schema:o,schemaCode:a,it:s}=e,{opts:l,errSchemaPath:c,schemaEnv:u,self:d}=s;l.validateFormats&&(i?function(){const i=r.scopeValue("formats",{ref:d.formats,code:l.code.formats}),o=r.const("fDef",yEe._`${i}[${a}]`),s=r.let("fType"),c=r.let("format");r.if(yEe._`typeof ${o} == "object" && !(${o} instanceof RegExp)`,(()=>r.assign(s,yEe._`${o}.type || "string"`).assign(c,yEe._`${o}.validate`)),(()=>r.assign(s,yEe._`"string"`).assign(c,o))),e.fail$data((0,yEe.or)(!1===l.strictSchema?yEe.nil:yEe._`${a} && !${c}`,function(){const e=u.$async?yEe._`(${o}.async ? await ${c}(${n}) : ${c}(${n}))`:yEe._`${c}(${n})`,r=yEe._`(typeof ${c} == "function" ? ${e} : ${c}.test(${n}))`;return yEe._`${c} && ${c} !== true && ${s} === ${t} && !${r}`}()))}():function(){const i=d.formats[o];if(!i)return void function(){if(!1===l.strictSchema)return void d.logger.warn(e());throw new Error(e());function e(){return`unknown format "${o}" ignored in schema at path "${c}"`}}();if(!0===i)return;const[a,s,f]=function(e){const t=e instanceof RegExp?(0,yEe.regexpCode)(e):l.code.formats?yEe._`${l.code.formats}${(0,yEe.getProperty)(o)}`:void 0,n=r.scopeValue("formats",{key:o,ref:e,code:t});return"object"!=typeof e||e instanceof RegExp?["string",e,n]:[e.type||"string",e.validate,yEe._`${n}.validate`]}(i);a===t&&e.pass(function(){if("object"==typeof i&&!(i instanceof RegExp)&&i.async){if(!u.$async)throw new Error("async format in sync schema");return yEe._`await ${f}(${n})`}return"function"==typeof s?yEe._`${f}(${n})`:yEe._`${f}.test(${n})`}())}())}};gEe.default=wEe,Object.defineProperty(vEe,"__esModule",{value:!0});const _Ee=[gEe.default];vEe.default=_Ee;var CEe={};Object.defineProperty(CEe,"__esModule",{value:!0}),CEe.contentVocabulary=CEe.metadataVocabulary=void 0,CEe.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],CEe.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"],Object.defineProperty(rwe,"__esModule",{value:!0});const EEe=ywe,xEe=M_e,SEe=vEe,kEe=CEe,OEe=[nwe.default,EEe.default,(0,xEe.default)(),SEe.default,kEe.metadataVocabulary,kEe.contentVocabulary];rwe.default=OEe;var IEe={},REe={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DiscrError=void 0,function(e){e.Tag="tag",e.Mapping="mapping"}(e.DiscrError||(e.DiscrError={}))}(REe),Object.defineProperty(IEe,"__esModule",{value:!0});const TEe=Yge,AEe=REe,NEe=Dbe,MEe=Jge,PEe={message:({params:{discrError:e,tagName:t}})=>e===AEe.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:r}})=>TEe._`{error: ${e}, tag: ${r}, tagValue: ${t}}`},jEe={keyword:"discriminator",type:"object",schemaType:"object",error:PEe,code(e){const{gen:t,data:r,schema:n,parentSchema:i,it:o}=e,{oneOf:a}=i;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");const s=n.propertyName;if("string"!=typeof s)throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!a)throw new Error("discriminator: requires oneOf keyword");const l=t.let("valid",!1),c=t.const("tag",TEe._`${r}${(0,TEe.getProperty)(s)}`);function u(r){const n=t.name("valid"),i=e.subschema({keyword:"oneOf",schemaProp:r},n);return e.mergeEvaluated(i,TEe.Name),n}t.if(TEe._`typeof ${c} == "string"`,(()=>function(){const r=function(){var e;const t={},r=l(i);let n=!0;for(let t=0;t<a.length;t++){let i=a[t];(null==i?void 0:i.$ref)&&!(0,MEe.schemaHasRulesButRef)(i,o.self.RULES)&&(i=NEe.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,null==i?void 0:i.$ref),i instanceof NEe.SchemaEnv&&(i=i.schema));const u=null===(e=null==i?void 0:i.properties)||void 0===e?void 0:e[s];if("object"!=typeof u)throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${s}"`);n=n&&(r||l(i)),c(u,t)}if(!n)throw new Error(`discriminator: "${s}" must be required`);return t;function l({required:e}){return Array.isArray(e)&&e.includes(s)}function c(e,t){if(e.const)u(e.const,t);else{if(!e.enum)throw new Error(`discriminator: "properties/${s}" must have "const" or "enum"`);for(const r of e.enum)u(r,t)}}function u(e,r){if("string"!=typeof e||e in t)throw new Error(`discriminator: "${s}" values must be unique strings`);t[e]=r}}();t.if(!1);for(const e in r)t.elseIf(TEe._`${c} === ${e}`),t.assign(l,u(r[e]));t.else(),e.error(!1,{discrError:AEe.DiscrError.Mapping,tag:c,tagName:s}),t.endIf()}()),(()=>e.error(!1,{discrError:AEe.DiscrError.Tag,tag:c,tagName:s}))),e.ok(l)}};IEe.default=jEe;const DEe={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;const r=Wge,n=rwe,i=IEe,o=DEe,a=["/properties"],s="http://json-schema.org/draft-07/schema";class l extends r.default{_addVocabularies(){super._addVocabularies(),n.default.forEach((e=>this.addVocabulary(e))),this.opts.discriminator&&this.addKeyword(i.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const e=this.opts.$data?this.$dataMetaSchema(o,a):o;this.addMetaSchema(e,s,!1),this.refs["http://json-schema.org/schema"]=s}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(s)?s:void 0)}}e.exports=t=l,Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var c=Gge;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return c.KeywordCxt}});var u=Yge;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return u._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return u.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return u.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return u.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return u.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return u.CodeGen}});var d=Abe;Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return d.default}});var f=Mbe;Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return f.default}})}(Hge,Hge.exports);var FEe={exports:{}},VEe={exports:{}},LEe={exports:{}},$Ee={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=Yge,n=["undefined","string","number","object","function","boolean","symbol"];function i(){return{keyword:"typeof",schemaType:["string","array"],code(e){const{data:t,schema:n,schemaValue:i}=e;e.fail("string"==typeof n?r._`typeof ${t} != ${n}`:r._`${i}.indexOf(typeof ${t}) < 0`)},metaSchema:{anyOf:[{type:"string",enum:n},{type:"array",items:{type:"string",enum:n}}]}}}t.default=i,e.exports=i}($Ee,$Ee.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r($Ee.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(LEe,LEe.exports);for(var BEe={exports:{}},zEe={},UEe={byteLength:function(e){var t=YEe(e),r=t[0],n=t[1];return 3*(r+n)/4-n},toByteArray:function(e){var t,r,n=YEe(e),i=n[0],o=n[1],a=new GEe(function(e,t,r){return 3*(t+r)/4-r}(0,i,o)),s=0,l=o>0?i-4:i;for(r=0;r<l;r+=4)t=WEe[e.charCodeAt(r)]<<18|WEe[e.charCodeAt(r+1)]<<12|WEe[e.charCodeAt(r+2)]<<6|WEe[e.charCodeAt(r+3)],a[s++]=t>>16&255,a[s++]=t>>8&255,a[s++]=255&t;return 2===o&&(t=WEe[e.charCodeAt(r)]<<2|WEe[e.charCodeAt(r+1)]>>4,a[s++]=255&t),1===o&&(t=WEe[e.charCodeAt(r)]<<10|WEe[e.charCodeAt(r+1)]<<4|WEe[e.charCodeAt(r+2)]>>2,a[s++]=t>>8&255,a[s++]=255&t),a},fromByteArray:function(e){for(var t,r=e.length,n=r%3,i=[],o=16383,a=0,s=r-n;a<s;a+=o)i.push(ZEe(e,a,a+o>s?s:a+o));return 1===n?(t=e[r-1],i.push(HEe[t>>2]+HEe[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(HEe[t>>10]+HEe[t>>4&63]+HEe[t<<2&63]+"=")),i.join("")}},HEe=[],WEe=[],GEe=typeof Uint8Array<"u"?Uint8Array:Array,KEe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",qEe=0;qEe<64;++qEe)HEe[qEe]=KEe[qEe],WEe[KEe.charCodeAt(qEe)]=qEe;function YEe(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function XEe(e){return HEe[e>>18&63]+HEe[e>>12&63]+HEe[e>>6&63]+HEe[63&e]}function ZEe(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(XEe(n));return i.join("")}WEe["-".charCodeAt(0)]=62,WEe["_".charCodeAt(0)]=63;var JEe={read:function(e,t,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,c=l>>1,u=-7,d=r?i-1:0,f=r?-1:1,p=e[t+d];for(d+=f,o=p&(1<<-u)-1,p>>=-u,u+=s;u>0;o=256*o+e[t+d],d+=f,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=n;u>0;a=256*a+e[t+d],d+=f,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=c}return(p?-1:1)*a*Math.pow(2,o-n)},write:function(e,t,r,n,i,o){var a,s,l,c=8*o-i-1,u=(1<<c)-1,d=u>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,h=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+d>=1?f/l:f*Math.pow(2,1-d))*l>=2&&(a++,l/=2),a+d>=u?(s=0,a=u):a+d>=1?(s=(t*l-1)*Math.pow(2,i),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),a=0));i>=8;e[r+p]=255&s,p+=h,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+p]=255&a,p+=h,a/=256,c-=8);e[r+p-h]|=128*m}};!function(e){var t=UEe,r=JEe,n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=a,e.SlowBuffer=function(e){return+e!=e&&(e=0),a.alloc(+e)},e.INSPECT_MAX_BYTES=50;var i=2147483647;function o(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,a.prototype),t}function a(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return c(e)}return s(e,t,r)}function s(e,t,r){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!a.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|p(e,t),n=o(r),i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(L(e,Uint8Array)){var t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(L(e,ArrayBuffer)||e&&L(e.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(L(e,SharedArrayBuffer)||e&&L(e.buffer,SharedArrayBuffer)))return d(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return a.from(n,t,r);var i=function(e){if(a.isBuffer(e)){var t=0|f(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||$(e.length)?o(0):u(e);if("Buffer"===e.type&&Array.isArray(e.data))return u(e.data)}(e);if(i)return i;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return l(e),o(e<0?0:0|f(e))}function u(e){for(var t=e.length<0?0:0|f(e.length),r=o(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function d(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,a.prototype),n}function f(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function p(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||L(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return D(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return F(e).length;default:if(i)return n?-1:D(e).length;t=(""+t).toLowerCase(),i=!0}}function h(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0)||(r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,r);case"utf8":case"utf-8":return x(this,t,r);case"ascii":return k(this,t,r);case"latin1":case"binary":return O(this,t,r);case"base64":return E(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function m(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function v(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),$(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=a.from(t,n)),a.isBuffer(t))return 0===t.length?-1:g(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):g(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function g(e,t,r,n,i){var o,a=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var u=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*a}else-1!==u&&(o-=o-u),u=-1}else for(r+l>s&&(r=s-l),o=r;o>=0;o--){for(var d=!0,f=0;f<l;f++)if(c(e,o+f)!==c(t,f)){d=!1;break}if(d)return o}return-1}function y(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if($(s))return a;e[r+a]=s}return a}function b(e,t,r,n){return V(D(t,e.length-r),e,r,n)}function w(e,t,r,n){return V(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function _(e,t,r,n){return V(F(t),e,r,n)}function C(e,t,r,n){return V(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function E(e,r,n){return 0===r&&n===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(r,n))}function x(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,l,c=e[i],u=null,d=c>239?4:c>223?3:c>191?2:1;if(i+d<=r)switch(d){case 1:c<128&&(u=c);break;case 2:128==(192&(o=e[i+1]))&&((l=(31&c)<<6|63&o)>127&&(u=l));break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&((l=(15&c)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(u=l));break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((l=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(u=l))}null===u?(u=65533,d=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),i+=d}return function(e){var t=e.length;if(t<=S)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=S));return r}(n)}e.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch{return!1}}(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(e,t,r){return s(e,t,r)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(e,t,r){return function(e,t,r){return l(e),e<=0?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},a.allocUnsafe=function(e){return c(e)},a.allocUnsafeSlow=function(e){return c(e)},a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if(L(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),L(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=a.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(L(o,Uint8Array))i+o.length>n.length?a.from(o).copy(n,i):Uint8Array.prototype.set.call(n,o,i);else{if(!a.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i)}i+=o.length}return n},a.byteLength=p,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},a.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?x(this,0,e):h.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(e,t,r,n,i){if(L(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),l=Math.min(o,s),c=this.slice(n,i),u=e.slice(t,r),d=0;d<l;++d)if(c[d]!==u[d]){o=c[d],s=u[d];break}return o<s?-1:s<o?1:0},a.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},a.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},a.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},a.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return y(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":case"latin1":case"binary":return w(this,e,t,r);case"base64":return _(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function k(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function O(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function I(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=B[e[o]];return i}function R(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function T(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function A(e,t,r,n,i,o){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function N(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function M(e,t,n,i,o){return t=+t,n>>>=0,o||N(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function P(e,t,n,i,o){return t=+t,n>>>=0,o||N(e,0,n,8),r.write(e,t,n,i,52,8),n+8}a.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,a.prototype),n},a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||T(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||T(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e>>>=0,t||T(e,1,this.length),this[e]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||T(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||T(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||T(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||T(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||T(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},a.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||T(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},a.prototype.readInt8=function(e,t){return e>>>=0,t||T(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||T(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(e,t){e>>>=0,t||T(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||T(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||T(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return e>>>=0,t||T(e,4,this.length),r.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||T(e,4,this.length),r.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||T(e,8,this.length),r.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||T(e,8,this.length),r.read(this,e,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||A(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||A(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);A(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},a.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);A(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},a.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeFloatLE=function(e,t,r){return M(this,e,t,!0,r)},a.prototype.writeFloatBE=function(e,t,r){return M(this,e,t,!1,r)},a.prototype.writeDoubleLE=function(e,t,r){return P(this,e,t,!0,r)},a.prototype.writeDoubleBE=function(e,t,r){return P(this,e,t,!1,r)},a.prototype.copy=function(e,t,r,n){if(!a.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),!n&&0!==n&&(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r||0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},a.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=a.isBuffer(e)?e:a.from(e,n),l=s.length;if(0===l)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<r-t;++o)this[o+t]=s[o%l]}return this};var j=/[^+/0-9A-Za-z-_]/g;function D(e,t){t=t||1/0;for(var r,n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function F(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(j,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function L(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function $(e){return e!=e}var B=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}()}(zEe);var QEe={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r={Object:Object,Array:Array,Function:Function,Number:Number,String:String,Date:Date,RegExp:RegExp};typeof zEe.Buffer<"u"&&(r.Buffer=zEe.Buffer),typeof Promise<"u"&&(r.Promise=Promise);const n=Object.assign((function(){return{keyword:"instanceof",schemaType:["string","array"],compile(e){if("string"==typeof e){const t=i(e);return e=>e instanceof t}if(Array.isArray(e)){const t=e.map(i);return e=>{for(const r of t)if(e instanceof r)return!0;return!1}}throw new Error("ajv implementation error")},metaSchema:{anyOf:[{type:"string"},{type:"array",items:{type:"string"}}]}}}),{CONSTRUCTORS:r});function i(e){const t=r[e];if(t)return t;throw new Error(`invalid "instanceof" keyword value ${e}`)}t.default=n,e.exports=n}(QEe,QEe.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(QEe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(BEe,BEe.exports);var exe={exports:{}},txe={exports:{}},rxe={};Object.defineProperty(rxe,"__esModule",{value:!0}),rxe.default=function(e){return()=>({keyword:e,type:"number",schemaType:"array",macro:function([t,r]){return function(t,r){if(t>r||"exclusiveRange"===e&&t===r)throw new Error("There are no numbers in range")}(t,r),"range"===e?{minimum:t,maximum:r}:{exclusiveMinimum:t,exclusiveMaximum:r}},metaSchema:{type:"array",minItems:2,maxItems:2,items:{type:"number"}}})},function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=(0,r(rxe).default)("range");t.default=n,e.exports=n}(txe,txe.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(txe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(exe,exe.exports);var nxe={exports:{}},ixe={exports:{}};!function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=(0,r(rxe).default)("exclusiveRange");t.default=n,e.exports=n}(ixe,ixe.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(ixe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(nxe,nxe.exports);var oxe={exports:{}},axe={exports:{}},sxe={};Object.defineProperty(sxe,"__esModule",{value:!0}),sxe.usePattern=sxe.metaSchemaRef=void 0;const lxe=Yge;sxe.metaSchemaRef=function({defaultMeta:e}={}){return!1===e?{}:{$ref:e||"http://json-schema.org/schema"}},sxe.usePattern=function({gen:e,it:{opts:t}},r,n=(t.unicodeRegExp?"u":"")){const i=new RegExp(r,n);return e.scopeValue("pattern",{key:i.toString(),ref:i,code:lxe._`new RegExp(${r}, ${n})`})},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=Yge,n=sxe,i={type:"object",properties:{pattern:{type:"string"},flags:{type:"string",nullable:!0}},required:["pattern"],additionalProperties:!1},o=/^\/(.*)\/([gimuy]*)$/;function a(){return{keyword:"regexp",type:"string",schemaType:["string","object"],code(e){const{data:t,schema:i}=e,a=function(t){if("object"==typeof t)return(0,n.usePattern)(e,t.pattern,t.flags);const r=o.exec(t);if(r)return(0,n.usePattern)(e,r[1],r[2]);throw new Error("cannot parse string into RegExp")}(i);e.pass(r._`${a}.test(${t})`)},metaSchema:{anyOf:[{type:"string"},i]}}}t.default=a,e.exports=a}(axe,axe.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(axe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(oxe,oxe.exports);var cxe={exports:{}},uxe={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=Yge,n={trimStart:e=>e.trimStart(),trimEnd:e=>e.trimEnd(),trimLeft:e=>e.trimStart(),trimRight:e=>e.trimEnd(),trim:e=>e.trim(),toLowerCase:e=>e.toLowerCase(),toUpperCase:e=>e.toUpperCase(),toEnumCase:(e,t)=>(null==t?void 0:t.hash[o(e)])||e},i=Object.assign((function(){return{keyword:"transform",schemaType:"array",before:"enum",code(e){const{gen:t,data:i,schema:a,parentSchema:s,it:l}=e,{parentData:c,parentDataProperty:u}=l,d=a;if(!d.length)return;let f;if(d.includes("toEnumCase")){const e=function(e){const t={hash:{}};if(!e.enum)throw new Error('transform: "toEnumCase" requires "enum"');for(const r of e.enum){if("string"!=typeof r)continue;const e=o(r);if(t.hash[e])throw new Error('transform: "toEnumCase" requires all lowercased "enum" values to be unique');t.hash[e]=r}return t}(s);f=t.scopeValue("obj",{ref:e,code:(0,r.stringify)(e)})}function p(e){if(!e.length)return i;const o=e.pop();if(!(o in n))throw new Error(`transform: unknown transformation ${o}`);const a=t.scopeValue("func",{ref:n[o],code:r._`require("ajv-keywords/dist/definitions/transform").transform${(0,r.getProperty)(o)}`}),s=p(e);return f&&"toEnumCase"===o?r._`${a}(${s}, ${f})`:r._`${a}(${s})`}t.if(r._`typeof ${i} == "string" && ${c} !== undefined`,(()=>{t.assign(i,p(d.slice())),t.assign(r._`${c}[${u}]`,i)}))},metaSchema:{type:"array",items:{type:"string",enum:Object.keys(n)}}}}),{transform:n});function o(e){return e.toLowerCase()}t.default=i,e.exports=i}(uxe,uxe.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(uxe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(cxe,cxe.exports);var dxe={exports:{}},fxe={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=Vye,n=["number","integer","string","boolean","null"];function i(){return{keyword:"uniqueItemProperties",type:"array",schemaType:"array",compile(e,t){const i=function(e,t){return e.map((e=>{var r,i,o;const a=null===(o=null===(i=null===(r=t.items)||void 0===r?void 0:r.properties)||void 0===i?void 0:i[e])||void 0===o?void 0:o.type;return Array.isArray(a)?!a.includes("object")&&!a.includes("array"):n.includes(a)}))}(e,t);return t=>{if(t.length<=1)return!0;for(let n=0;n<e.length;n++){const o=e[n];if(i[n]){const e={};for(const r of t){if(!r||"object"!=typeof r)continue;let t=r[o];if(!t||"object"!=typeof t){if("string"==typeof t&&(t='"'+t),e[t])return!1;e[t]=!0}}}else for(let e=t.length;e--;){const n=t[e];if(n&&"object"==typeof n)for(let i=e;i--;){const e=t[i];if(e&&"object"==typeof e&&r(n[o],e[o]))return!1}}}return!0}},metaSchema:{type:"array",items:{type:"string"}}}}t.default=i,e.exports=i}(fxe,fxe.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(fxe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(dxe,dxe.exports);var pxe={exports:{}},hxe={exports:{}};!function(e,t){function r(){return{keyword:"allRequired",type:"object",schemaType:"boolean",macro(e,t){if(!e)return!0;const r=Object.keys(t.properties);return 0===r.length||{required:r}},dependencies:["properties"]}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=r}(hxe,hxe.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(hxe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(pxe,pxe.exports);var mxe={exports:{}},vxe={exports:{}},gxe={};Object.defineProperty(gxe,"__esModule",{value:!0}),gxe.default=function(e){return()=>({keyword:e,type:"object",schemaType:"array",macro:t=>0===t.length||(1===t.length?{required:t}:{["anyRequired"===e?"anyOf":"oneOf"]:t.map((e=>({required:[e]})))}),metaSchema:{type:"array",items:{type:"string"}}})},function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=(0,r(gxe).default)("anyRequired");t.default=n,e.exports=n}(vxe,vxe.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(vxe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(mxe,mxe.exports);var yxe={exports:{}},bxe={exports:{}};!function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=(0,r(gxe).default)("oneRequired");t.default=n,e.exports=n}(bxe,bxe.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(bxe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(yxe,yxe.exports);var wxe={exports:{}},_xe={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=Yge,n=sxe,i={message:({params:{missingPattern:e}})=>r.str`should have property matching pattern '${e}'`,params:({params:{missingPattern:e}})=>r._`{missingPattern: ${e}}`};function o(){return{keyword:"patternRequired",type:"object",schemaType:"array",error:i,code(e){const{gen:t,schema:i,data:o}=e;if(0===i.length)return;const a=t.let("valid",!0);for(const e of i)s(e);function s(i){const s=t.let("matched",!1);t.forIn("key",o,(o=>{t.assign(s,r._`${(0,n.usePattern)(e,i)}.test(${o})`),t.if(s,(()=>t.break()))})),e.setParams({missingPattern:i}),t.assign(a,(0,r.and)(a,s)),e.pass(a)}},metaSchema:{type:"array",items:{type:"string",format:"regex"},uniqueItems:!0}}}t.default=o,e.exports=o}(_xe,_xe.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(_xe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(wxe,wxe.exports);var Cxe={exports:{}},Exe={exports:{}};!function(e,t){function r(){return{keyword:"prohibited",type:"object",schemaType:"array",macro:function(e){return 0===e.length||(1===e.length?{not:{required:e}}:{not:{anyOf:e.map((e=>({required:[e]})))}})},metaSchema:{type:"array",items:{type:"string"}}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=r}(Exe,Exe.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(Exe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(Cxe,Cxe.exports);var xxe={exports:{}},Sxe={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=sxe;function n(e){return{keyword:"deepProperties",type:"object",schemaType:"object",macro:function(e){const t=[];for(const r in e)t.push(i(r,e[r]));return{allOf:t}},metaSchema:{type:"object",propertyNames:{type:"string",format:"json-pointer"},additionalProperties:(0,r.metaSchemaRef)(e)}}}function i(e,t){const r=e.split("/"),n={};let i=n;for(let e=1;e<r.length;e++){let n=r[e];const a=e===r.length-1;n=o(n);const s=i.properties={};let l;if(/[0-9]+/.test(n)){let e=+n;for(l=i.items=[],i.type=["object","array"];e--;)l.push({})}else i.type="object";i=a?t:{},s[n]=i,l&&l.push(i)}return n}function o(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}t.default=n,e.exports=n}(Sxe,Sxe.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(Sxe.exports),i=(e,t)=>e.addKeyword((0,n.default)(t));t.default=i,e.exports=i}(xxe,xxe.exports);var kxe={exports:{}},Oxe={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=Yge;function n(){return{keyword:"deepRequired",type:"object",schemaType:"array",code(e){const{schema:t,data:n}=e,i=t.map((e=>r._`(${function(e){if(""===e)throw new Error("empty JSON pointer not allowed");const t=e.split("/");let i=n;const o=t.map(((e,t)=>t?i=r._`${i}${(0,r.getProperty)(function(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}(e))}`:i));return(0,r.and)(...o)}(e)}) === undefined`));e.fail((0,r.or)(...i))},metaSchema:{type:"array",items:{type:"string",format:"json-pointer"}}}}t.default=n,e.exports=n}(Oxe,Oxe.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(Oxe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(kxe,kxe.exports);var Ixe={exports:{}},Rxe={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r={},n={timestamp:()=>()=>Date.now(),datetime:()=>()=>(new Date).toISOString(),date:()=>()=>(new Date).toISOString().slice(0,10),time:()=>()=>(new Date).toISOString().slice(11),random:()=>()=>Math.random(),randomint:e=>{var t;const r=null!==(t=null==e?void 0:e.max)&&void 0!==t?t:2;return()=>Math.floor(Math.random()*r)},seq:e=>{var t;const n=null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"";return r[n]||(r[n]=0),()=>r[n]++}},i=Object.assign((function(){return{keyword:"dynamicDefaults",type:"object",schemaType:["string","object"],modifying:!0,valid:!0,compile(e,t,r){if(!r.opts.useDefaults||r.compositeRule)return()=>!0;const n={};for(const t in e)n[t]=o(e[t]);const i="empty"===r.opts.useDefaults;return t=>{for(const r in e)(void 0===t[r]||i&&(null===t[r]||""===t[r]))&&(t[r]=n[r]());return!0}},metaSchema:{type:"object",additionalProperties:{anyOf:[{type:"string"},{type:"object",additionalProperties:!1,required:["func","args"],properties:{func:{type:"string"},args:{type:"object"}}}]}}}}),{DEFAULTS:n});function o(e){return"object"==typeof e?function({func:e,args:t}){const r=n[e];return a(e,r),r(t)}(e):function(e=""){const t=n[e];return a(e,t),t()}(e)}function a(e,t){if(!t)throw new Error(`invalid "dynamicDefaults" keyword property value: ${e}`)}t.default=i,e.exports=i}(Rxe,Rxe.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(Rxe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(Ixe,Ixe.exports);var Txe={exports:{}},Axe={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=Yge,n=sxe,i={message:({params:{schemaProp:e}})=>e?r.str`should match case "${e}" schema`:r.str`should match default case schema`,params:({params:{schemaProp:e}})=>e?r._`{failingCase: ${e}}`:r._`{failingDefault: true}`};function o(e){const t=(0,n.metaSchemaRef)(e);return[{keyword:"select",schemaType:["string","number","boolean","null"],$data:!0,error:i,dependencies:["selectCases"],code(e){const{gen:t,schemaCode:n,parentSchema:i}=e;e.block$data(r.nil,(()=>{const o=t.let("valid",!0),a=t.name("_valid"),s=t.const("value",r._`${n} === null ? "null" : ${n}`);t.if(!1);for(const n in i.selectCases){e.setParams({schemaProp:n}),t.elseIf(r._`"" + ${s} == ${n}`);const i=e.subschema({keyword:"selectCases",schemaProp:n},a);e.mergeEvaluated(i,r.Name),t.assign(o,a)}if(t.else(),void 0!==i.selectDefault){e.setParams({schemaProp:void 0});const n=e.subschema({keyword:"selectDefault"},a);e.mergeEvaluated(n,r.Name),t.assign(o,a)}t.endIf(),e.pass(o)}))}},{keyword:"selectCases",dependencies:["select"],metaSchema:{type:"object",additionalProperties:t}},{keyword:"selectDefault",dependencies:["select","selectCases"],metaSchema:t}]}t.default=o,e.exports=o}(Axe,Axe.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(Axe.exports),i=(e,t)=>((0,n.default)(t).forEach((t=>e.addKeyword(t))),e);t.default=i,e.exports=i}(Txe,Txe.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(LEe.exports),i=r(BEe.exports),o=r(exe.exports),a=r(nxe.exports),s=r(oxe.exports),l=r(cxe.exports),c=r(dxe.exports),u=r(pxe.exports),d=r(mxe.exports),f=r(yxe.exports),p=r(wxe.exports),h=r(Cxe.exports),m=r(xxe.exports),v=r(kxe.exports),g=r(Ixe.exports),y=r(Txe.exports),b={typeof:n.default,instanceof:i.default,range:o.default,exclusiveRange:a.default,regexp:s.default,transform:l.default,uniqueItemProperties:c.default,allRequired:u.default,anyRequired:d.default,oneRequired:f.default,patternRequired:p.default,prohibited:h.default,deepProperties:m.default,deepRequired:v.default,dynamicDefaults:g.default,select:y.default};t.default=b,e.exports=b}(VEe,VEe.exports),function(e,t){var r=ki&&ki.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(VEe.exports),i=(e,t)=>{if(Array.isArray(t)){for(const r of t)o(r)(e);return e}if(t)return o(t)(e),e;for(t in n.default)o(t)(e);return e};function o(e){const t=n.default[e];if(!t)throw new Error("Unknown keyword "+e);return t}i.get=o,t.default=i,e.exports=i,e.exports.default=i}(FEe,FEe.exports);const Nxe=Fi.defineToken("ContentEditorContribution"),Mxe=Fi.defineToken("ContentViewerContribution"),Pxe=Fi.defineToken("ContentDatasourceContribution"),jxe=Fi.defineToken("ContentDatasourceServiceToken"),Dxe=Fi.defineToken("ContentServiceToken"),Fxe=Fi.defineToken("ContentEditorServiceToken"),Vxe=Fi.defineToken("ContentViewerServiceToken");var Lxe=(e=>(e[e.FULL_SCREEN=0]="FULL_SCREEN",e[e.NORMAL=1]="NORMAL",e))(Lxe||{}),$xe=Object.defineProperty,Bxe=Object.getOwnPropertyDescriptor,zxe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Bxe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&$xe(t,r,o),o};let Uxe=class{constructor(){this._onStatusChange=new op,this.onStatusChange=this._onStatusChange.event,this.status=Lxe.NORMAL}get isFullScreen(){return this.status===Lxe.FULL_SCREEN}emitStatusChange(){this.status===Lxe.NORMAL?this.status=Lxe.FULL_SCREEN:this.status=Lxe.NORMAL,this._onStatusChange.emit(this.status)}enterFullScreen(e){var t;let r=["view-manage","|","kanban-group-setting","view-field-setting","filter","grid-group","sort","grid-record-height","search"];this.status=Lxe.FULL_SCREEN,e&&(r=r.concat(["|","add-record"])),this._configuration.setValue("toolbar.left",r),this._configuration.setValue("toolbar.right",[]),this._configuration.setValue("toolbar.mode",TJ.NORMAL),this._configuration.setValue("view.customScrollParent",void 0),this._configuration.setValue("view.useWindowScroll",!1),this._configuration.setValue("render.autoActive",!0),null==(t=this._activeTableService)||t.active(),this._toolbarService.rerender()}exitFullScreen(e,t){var r;let n=["kanban-group-setting","view-field-setting","filter","grid-group","sort","grid-record-height","full-width","full-screen","search"];this.status=Lxe.NORMAL,e&&(n=n.concat(["|","add-record"])),this._configuration.setValue("toolbar.left",["view-manage"]),this._configuration.setValue("toolbar.right",n),this._configuration.setValue("toolbar.mode",TJ.LITE),this._configuration.setValue("view.customScrollParent",t),this._configuration.setValue("view.useWindowScroll",!0),this._configuration.setValue("render.autoActive",!1),null==(r=this._activeTableService)||r.active(),this._toolbarService.rerender()}};zxe([to(qf)],Uxe.prototype,"_configuration",2),zxe([to(Lj)],Uxe.prototype,"_activeTableService",2),zxe([to(OJ)],Uxe.prototype,"_toolbarService",2),Uxe=zxe([eo()],Uxe);var Hxe=(e=>(e.NORMAL="normal",e.CONTAIN="contain",e))(Hxe||{}),Wxe=Object.defineProperty,Gxe=Object.getOwnPropertyDescriptor,Kxe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Gxe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Wxe(t,r,o),o};const qxe=750;let Yxe=class{constructor(){this._cardWidthMode=null,this._getMaxWidth=null,this._$card=null,this._onModeUIChange=new op,this.onModeUIChange=this._onModeUIChange.event,this._onModeChange=new op,this.onModeChange=this._onModeChange.event,this._onCardWidthChange=new op,this.onCardWidthChange=this._onCardWidthChange.event,this.initCardWidth=e=>{if(this._getMaxWidth&&this._$card){if(this._fullScreenService.isFullScreen)this._setCardWidth("100%");else{const t=Math.min(this._getMaxWidth(),e);this._updateCardWidth(t)}e>qxe?this.syncWidthMode(Hxe.CONTAIN):this.syncWidthMode(Hxe.NORMAL),this.bindEvent()}else console.error("[lakex-table-next] FullWidthService.initCardWidth is not ready, please apply getMaxWidtFunction and cardRef.")},this._updateCardWidth=e=>{var t;null==(t=this._setCardWidth)||t.call(this,e),this._onCardWidthChange.emit(e)},this._setCardWidth=e=>{this._$card&&(this._$card.style.width="string"==typeof e?e:`${e}px`)},this._addCardShadow=()=>{this._$card&&this._$card.classList.add("right-shadow")},this._removeCardShadow=()=>{this._$card&&this._$card.classList.remove("right-shadow")},this._handleCardViewWidth=()=>{if(!this._getMaxWidth)return;const e=this._getMaxWidth();this.isNormalMode&&this._updateCardWidth(Math.min(qxe,e)),this.isContainMode&&this._updateCardWidth(e),this._removeCardShadow(),this._viewerCardLayoutService.refresh()},this._handleKanbanViewWidth=()=>{if(!this._getMaxWidth)return;const e=this._readService.getViewGroup(),t=this._getMaxWidth();if(!e)return this._updateCardWidth(Math.min(qxe,t)),void this._removeCardShadow();const r=this._renderContextService.$root.querySelector(".lakex-viewer-kanban-content");if(r){const e=r.getBoundingClientRect().width,n=Math.max(e,qxe),i=t<qxe?t:Math.min(n,t);this._updateCardWidth(i),e>i?this._addCardShadow():this._removeCardShadow()}},this._handleGridViewWidth=()=>{if(!this._getMaxWidth)return;const e=this._renderContextService.$root.querySelector("table");if(e){const t=e.getBoundingClientRect().width,r=Math.max(t,qxe),n=this._getMaxWidth(),i=n<qxe?n:Math.min(r,n);this._updateCardWidth(i),t>i?this._addCardShadow():this._removeCardShadow()}}}get isDisable(){return this._fullScreenService.status===Lxe.FULL_SCREEN}get isNormalMode(){return this._cardWidthMode===Hxe.NORMAL}get isContainMode(){return this._cardWidthMode===Hxe.CONTAIN}get cardWidthMode(){return this._cardWidthMode}setWidthMode(e){this.syncWidthMode(e),this._onModeChange.emit(e)}applyGetMaxWidthFunction(e){this._getMaxWidth=e}applyCardRef(e){this._$card=e}resetWidth(){this._handleUpdateWidth()}setCardWidth(e){var t;null==(t=this._setCardWidth)||t.call(this,e)}syncWidthMode(e){this._cardWidthMode=e,this._onModeUIChange.emit(e)}_handleUpdateWidth(){if(this._getMaxWidth)if(oa.isMobile)this._updateCardWidth(this._getMaxWidth());else{if(this.isDisable)return null;switch(this._readService.getActiveViewType()){case Wh.KANBAN:this._handleKanbanViewWidth();break;case Wh.GRID:this._handleGridViewWidth();break;case Wh.CARD:this._handleCardViewWidth();break;default:return}}}bindEvent(){this._commandService.onDidExecuteCommand((({context:e})=>{const{commandName:t}=e;if(this.isDisable)return null;("addView"===t||"removeView"===t||"switchView"===t||"changeColWidth"===t||"updateFieldHidden"===t||"addField"===t||"removeField"===t||"undo"===t||"redo"===t)&&this.resetWidth()}))}};Kxe([to(Uxe)],Yxe.prototype,"_fullScreenService",2),Kxe([to(Dy)],Yxe.prototype,"_readService",2),Kxe([to(Uj)],Yxe.prototype,"_renderContextService",2),Kxe([to(Tle)],Yxe.prototype,"_viewerCardLayoutService",2),Kxe([to(Pb)],Yxe.prototype,"_commandService",2),Yxe=Kxe([eo()],Yxe);const Xxe=null,Zxe=Fi.defineToken("CommentContribution"),Jxe={"AI 智能填写":"AI autofill","上传失败":"Upload failure","下拉":"Dropdown","为必填项":"Is required","今天":"Today","使用钉钉扫码$1":"Use Dingding to scan the code to $1","停止收集":"Stop collection","像问卷一样收集信息":"collect information like a questionnaire","全宽":"Full width","全屏":"Full screen","关闭":"Off","其他数据更新时同步更新":"Update when data changes","内容总结":"Summary","内容规则：":"Prompt type:","分享":"Share","列表":"List","单选":"Select","取消":"Cancel","取消添加":"remove","可用于问卷调查、活动组织、登记报名等信息收集与整理场景。":"The data table is a new type of table for more convenient multi-person collaboration and data management through multiple views.","向上移动":"Move up","向下移动":"Move down","回复":"","复制填写链接":"Copy and fill in the link","复制成功":"Copy successfully","复制表单项":"Clone this item","多选":"Multi-select","将自动对每条记录进行总结":"Summarize each record automatically","已停止填写":"Autofill Stopped","已重新填写":"Autofill Done","布局方式":"Layout","开启收集":"Start form collect","开始自动填写":"Start autofill","当前文档中此文件类型不支持预览和下载":"This file is not supported for preview and download","必填":"Required","所有列":"all the columns","打开":"Open","提交":"Submit","收集中":"Collecting","数据表中所有列":"All the columns in table","明天":"Tomorrow","昨天":"Yesterday","智能填写":"Autofill","未命名问题":"Untitled question","查看表单视图需要编辑权限":"Viewing form view requires edit permission","标宽":"Standard width","正在填写中...":"Autofilling...","此处由填写者输入":"This field is for form user","添加":"Add","点击「开启收集」按钮获得表单填写链接":"Click「Start form collect」button to get then form link","点击修改字段":"Click and change field","点击左侧列表添加已有列 或 点击下方按钮添加新表单项":"Click a field or the button above to add an item","生成新表单":"Create new form","移除表单项":"Remove this item","自定义":"Custom","获得链接的所有人，可填写并提交表单":"Anyone who gets the link can fill out and submit the form","表单为空":"This form is empty","表单提交失败，请稍后重试":"Form submission failed, please try again later","表单提交成功":"Form submitted successfully","表单收集未开启":"Form collection is not turned on","表单视图":"Form view","要点提取":"Extract","规则不能为空":"Rules can't be null","规则最长支持255字符":"Rules maximun length limit 255","评论":"Comment","请输入必填项":"Please enter required fields","请输入表单描述":"please input form descriptor","请输入表单标题":"please input form title","请输入问题":"Enter a question","输入智能填写规则\n如：为每个商品生成 50 字的宣传文案":"Please input autofill rules\n","输入要点提取规则\n如：提取每天记录中出现的人名":"Please input extract rules\n","重新填写":"Re-autofill","重新填写本列内容":"Re-autofill current col"};function Qxe(e,t){const r=globalThis.appData;return r&&void 0!==r[e]?r[e]:t}Sf.setData(Jxe);const eSe=jo(navigator)?"":navigator.userAgent,tSe=/yuque-desktop\/[\d.]+/i.test(eSe),rSe=/YuqueMobileApp\/[\d.]+/i.test(eSe);class nSe{static get locale(){return Qxe("locale","zh-cn")}static get isYuque(){return Qxe("isYuque",!1)}static get isEnterprise(){return Qxe("isEnterprise",!1)}static get isPublicCloud(){return Qxe("isPublicCloud",!1)}static get isOrganization(){return!!Qxe("organization")}static get isUIATest(){const e=jo(navigator)?"":navigator.userAgent;return/Macaca UI Robot/.test(e)}static get isYuqueMobile(){return rSe}static get isDesktop(){return tSe||Qxe("isDesktopApp",!1)}static get isYuqueMobileApp(){return Qxe("isYuqueMobileApp",!1)}static get imageServiceDomains(){return Qxe("imageServiceDomains",[])}static get docId(){return Ut()(globalThis.appData||{},"doc.id")}static get group(){return Qxe("group",void 0)}static get me(){return Qxe("me",void 0)}static get doc(){return Qxe("doc",void 0)}static get organization(){return Qxe("organization",void 0)}static get env(){return Qxe("env","prod")}static get settings(){return Qxe("settings",{})}static get isOfficialTemplate(){return Qxe("isOfficialTemplate",!1)}static get themeManager(){return Qxe("themeManager")}}const iSe=({webSdk:e})=>({"record.maxCount":5e3,"view.maxCount":1e3,"toolbar.topLeft":["view-manage"],"toolbar.left":["kanban-group-setting","view-field-setting","filter","grid-group","sort","grid-record-height","search","|","add-record","expandRecord"],contextMenu:["updateField","autofillField","|","insertFieldLeft","insertFieldRight","|","groupByField","filterByField","sortByAsc","sortByDesc","|","copy","paste","|","insertRecordUp","insertRecordDown","insertRecordLeft","insertRecordRight","|","copyRecord","expandRecord","removeRecord","removeField"],"comment.actions":["reply","emoji","edit","delete"],"monitor.startAt":+new Date,"server.webSdk":e,"clipboard.clipboardApi.disable":nSe.isUIATest,"collab.spellBlacklist":["table","ability"],"collab.spellSilentList":["comment","comment-emoji"],"expandRecord.fieldRenderMode":"lite","expandRecord.fieldLayoutMode":"lite","expandRecord.modalDrawerModeViews":["GRID"],"viewerManage.type":"tab","viewerManage.viewTypes":["GRID","CARD","KANBAN","FORM"]}),oSe=Fi.defineToken("CollaborationKernelPluginContribution");var aSe=Object.defineProperty,sSe=Object.getOwnPropertyDescriptor,lSe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?sSe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&aSe(t,r,o),o};const cSe=Wo.Plugin("collaboration");let uSe=class{constructor(){this.isBindedEvent=!1,this._spells=[],this.startTask=Wt()((()=>{this._spells.length>0&&(this.collabDoc.submitCommand({spells:this._spells,user:this._readService.currentUser}),this._spells=[])}),1e3)}init(){const e=this._configuration.getValue("collab.emitter");!e||(e.docReady?this.collabDoc=e.doc:e.on("docReady",(e=>{this.collabDoc=e,setTimeout((()=>{this.isRendered&&!this.isBindedEvent&&this.bindCollabEvent()}),1e3)})),this._lifecycleService.when(gf.Rendered,(()=>{!this.collabDoc||setTimeout((()=>{this.isRendered=!0,this.bindCollabEvent()}),1e3)})))}bindCollabEvent(){const e=this._configuration.getValue("collab.spellBlacklist"),t=this._configuration.getValue("collab.spellSilentList");this._configuration.getValue("collab.disable")||(this.collabDoc.on("command",(r=>{var n,i;const{user:o}=r[0],a=r[0].spells;let s=!1;for(const r of a){if(!r||(null==e?void 0:e.includes(r.table))||(cSe("on command %j",r),r.isRemote=!0,this._contentService.setUsers([o]),this._driver.execute(r),null!=t&&t.includes(r.table)))return;if(["field_boolean","field_date","field_number","field_select","field_string","field_uri"].includes(r.table)){const e=null==(n=r.where)?void 0:n.field_uuid;let t=null==(i=r.where)?void 0:i.record_uuid;Array.isArray(t)||(t=[t]);for(const r of t)e&&r&&this._eventService._onCellChange.emit({fieldId:e,recordId:r,cellValue:this._readService.getCell(e,r)});s=!0}}s&&this._writeService.refreshView(),this._kernelService._onDataChanged.emit("spell-execute")})),this._modelEvent.onChange((({spell:t})=>{t.isRemote||(null==e?void 0:e.includes(t.table))||this.collabSpell(t)})),this.isBindedEvent=!0)}collabSpell(e){this._spells.push(e),this.startTask()}};lSe([to(Dy)],uSe.prototype,"_readService",2),lSe([to(Wy)],uSe.prototype,"_writeService",2),lSe([to(s_)],uSe.prototype,"_kernelService",2),lSe([to(yf)],uSe.prototype,"_lifecycleService",2),lSe([to(qf)],uSe.prototype,"_configuration",2),lSe([to(Rf)],uSe.prototype,"_modelEvent",2),lSe([to(Of)],uSe.prototype,"_driver",2),lSe([to(Yy)],uSe.prototype,"_contentService",2),lSe([to(Fv)],uSe.prototype,"_eventService",2),uSe=lSe([eo()],uSe);var dSe=Object.defineProperty,fSe=Object.getOwnPropertyDescriptor,pSe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?fSe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&dSe(t,r,o),o};let hSe=class{static pluginModule(){return bo().contribution(oSe).register(uSe).register(this)}static registerConfiguration(e){e.registerConfiguration({id:"collab",type:"object",properties:{disable:{type:"boolean"},emitter:{typeof:"function"},spellBlacklist:{type:"array",description:"spll黑名单"},spellSilentList:{type:"array",description:"spll静默名单"}}})}init(){this._collabService.init()}};hSe.pluginName="kernel-collaboration",pSe([to(uSe)],hSe.prototype,"_collabService",2),hSe=pSe([eo({contrib:Tw})],hSe);class mSe extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return Promise.resolve(!0)}}class vSe extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.upsertShareView(e.viewId,{src:e.src,status:e.status}),Promise.resolve(!0)}}class gSe extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.removeViewField(e.viewId,e.fieldId),Promise.resolve(!0)}}class ySe extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.insertViewField(e.viewId,e.fieldId),Promise.resolve(!0)}}class bSe extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.updateViewDesc(e.viewId,e.desc),Promise.resolve(!0)}}bSe.commandName="updateViewDesc";class wSe extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.updateViewFieldDisplayType(e.viewId,e.fieldId,e.displayType),Promise.resolve(!0)}}wSe.commandName="updateViewFieldDisplayType";class _Se extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.updateViewFieldRequired(e.viewId,e.fieldId,e.required),Promise.resolve(!0)}}_Se.commandName="updateViewFieldRequired";class CSe extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}async execute(e){return await this.context.job.updateViewFieldName(e.viewId,e.fieldId,e.name),Promise.resolve(!0)}}CSe.commandName="updateViewFieldName";class ESe extends Ib{constructor(){super(...arguments),this.jobType=jb.User}destroy(){}beforeExecute(e){return e.newFieldId||(e.newFieldId=Io(32)),e}async execute(e){return await this.context.job.cloneViewField(e.viewId,e.fieldId,e.newFieldId),Promise.resolve(!0)}}ESe.commandName="cloneViewField";const xSe=Fi.defineToken("ViewerFormContribution");var SSe=(e=>(e.PENDING="pending",e.COLLECTING="collecting",e))(SSe||{});const kSe=Fi.defineToken("ViewerFormKernelPluginContribution");var OSe=Object.defineProperty,ISe=Object.getOwnPropertyDescriptor,RSe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ISe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&OSe(t,r,o),o};let TSe=class{getProvider(){const e=this.formProvider.getContributions();return e[e.length-1].registerForm()}getForm(e){return this.getProvider().getForm(e)}};RSe([Eo(xSe)],TSe.prototype,"formProvider",2),TSe=RSe([eo()],TSe);var ASe=Object.defineProperty,NSe=Object.getOwnPropertyDescriptor,MSe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?NSe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ASe(t,r,o),o};let PSe=class{async initForm(e){const t=this._readService.getView(e);if(!t||this.getShare(e))return;const r=await this._formRegistry.getForm(t.id);return r&&this._writeService.upsertViewShare(t.uuid,r),r}getShare(e){if(e)return this._readService.getViewShare(e)}getForm(e){if(!this._readService.getView(e))return;const t=this._readService.getViewData(e);return null==t?void 0:t.view}getFormEditData(e){var t,r;const n=this.getForm(e),i=this._readService.getViewData(null==n?void 0:n.uuid,["view","viewConfig","viewFields","fields"]);if(i)return i.fields&&(i.fields=null==(t=i.fields)?void 0:t.filter((e=>!Kh.isSystemType(e.type)))),i.viewFields&&(i.viewFields=null==(r=i.viewFields)?void 0:r.filter((e=>{var t;return!Kh.isSystemType(null==(t=e.field)?void 0:t.type)}))),i}};MSe([to(Dy)],PSe.prototype,"_readService",2),MSe([to(Wy)],PSe.prototype,"_writeService",2),MSe([to(TSe)],PSe.prototype,"_formRegistry",2),PSe=MSe([eo()],PSe);var jSe=Object.defineProperty,DSe=Object.getOwnPropertyDescriptor,FSe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?DSe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&jSe(t,r,o),o};let VSe=class{static pluginModule(){return bo().contribution(kSe).register(PSe).contribution(xSe).register(TSe).register(PSe).register(this)}init(e){this.commandService.registerCommand("addFormRecord",mSe),this.commandService.registerCommand("removeViewField",gSe),this.commandService.registerCommand("insertViewField",ySe),this.commandService.registerCommand(bSe.commandName,bSe),this.commandService.registerCommand(wSe.commandName,wSe),this.commandService.registerCommand(_Se.commandName,_Se),this.commandService.registerCommand(CSe.commandName,CSe),this.commandService.registerCommand(ESe.commandName,ESe),this.commandService.registerCommand("upsertViewShare",vSe)}};VSe.pluginName="kernel-viewer-form",FSe([to(Pb)],VSe.prototype,"commandService",2),VSe=FSe([eo({contrib:Tw})],VSe);var LSe=Object.defineProperty,$Se=Object.getOwnPropertyDescriptor;let BSe=class{constructor(){this._onCommandHook=new op,this.onCommandHook=this._onCommandHook.event}emitHook(e){this._onCommandHook.emit(e)}};BSe=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?$Se(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&LSe(t,r,o),o})([eo()],BSe);var zSe=Object.defineProperty,USe=Object.getOwnPropertyDescriptor,HSe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?USe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&zSe(t,r,o),o};const WSe=Wo.Plugin("monitor");let GSe=class{constructor(){this._commandLogs=[],this._startTaskWithDebounce=Wt()((async()=>{const e=this._commandLogs;0!==this._commandLogs.length&&(this._queueTask.addJob((async t=>{try{await this._startTask(e)}catch(e){return console.error(e),t.onError(e)}t.onSuccess()})),this._commandLogs=[])}),3e3)}startMainPerfLog(){const e={};e.startAt=this._configuration.getValue("monitor.startAt"),e.initAt=this._lifeCycleService.getStatusChangedAt(gf.Inited),e.initAt||this._lifeCycleService.when(gf.Inited,(()=>{e.initAt=this._lifeCycleService.getStatusChangedAt(gf.Inited)})),e.readyAt=this._lifeCycleService.getStatusChangedAt(gf.Ready),e.readyAt||this._lifeCycleService.when(gf.Ready,(()=>{e.readyAt=this._lifeCycleService.getStatusChangedAt(gf.Ready)})),e.recordInitAt=this._lifeCycleService.getStatusChangedAt(gf.RecordInit),e.recordInitAt||this._lifeCycleService.when(gf.RecordInit,(()=>{e.recordInitAt=this._lifeCycleService.getStatusChangedAt(gf.RecordInit)})),e.recordReadyAt=this._lifeCycleService.getStatusChangedAt(gf.RecordReady),e.recordReadyAt||this._lifeCycleService.when(gf.RecordReady,(()=>{e.recordReadyAt=this._lifeCycleService.getStatusChangedAt(gf.RecordReady)})),e.renderAt=this._lifeCycleService.getStatusChangedAt(gf.Rendered),e.renderAt?this._sendMainPerfLog(e):this._lifeCycleService.when(gf.Rendered,(()=>{e.renderAt=this._lifeCycleService.getStatusChangedAt(gf.Rendered),this._sendMainPerfLog(e)}))}_sendMainPerfLog(e){const t=this._configuration.getValue("monitor.sendLog"),r={msg:"新数据表性能上报",m1:e.initAt-e.startAt,m2:e.readyAt-e.initAt,m3:e.recordInitAt-e.readyAt,m4:e.recordReadyAt-e.recordInitAt,m5:e.renderAt-e.recordReadyAt,m6:e.renderAt-e.startAt,c1:this._readService.getRecords().length,c2:this._readService.getAllFields().length};r.m5>5e3||r.m6>2e4||(WSe("main perf: %j",r),null==t||t(59,r))}startCommandPerfLog(){this._queueTask=new fb({name:"指令性能同步任务",parallel:1}),this._commandHook.onCommandHook((e=>{this._logCommandPerf(e)}))}async _logCommandPerf(e){this._commandLogs.push(e),this._startTaskWithDebounce()}_getCommandPerfData(e){const t={msg:"新数据表指令性能上报"},r={m1:0,m2:0,m3:0,m4:0,m5:0,m6:0,m7:0};for(const n of e)"setCell"===n.commandName?(t.m1=t.m1||0,r.m1+=1,t.m1=(t.m1+n.time)/r.m1):"switchView"===n.commandName?(t.m2=t.m2||0,r.m2+=1,t.m2=(t.m2+n.time)/r.m2):"addView"===n.commandName?(t.m3=t.m3||0,r.m3+=1,t.m3=(t.m3+n.time)/r.m3):"createFilter"===n.commandName||"updateFilter"===n.commandName||"removeFilter"===n.commandName?(t.m4=t.m4||0,r.m4+=1,t.m4=(t.m4+n.time)/r.m4):"createGridGroup"===n.commandName||"updateGridGroup"===n.commandName||"removeGridGroup"===n.commandName?(t.m5=t.m5||0,r.m5+=1,t.m5=(t.m5+n.time)/r.m5):"createSort"===n.commandName||"updateSort"===n.commandName||"removeSort"===n.commandName?(t.m6=t.m6||0,r.m6+=1,t.m6=(t.m6+n.time)/r.m6):"addEmptyRecord"===n.commandName&&(t.m7=t.m7||0,r.m7+=1,t.m7=(t.m7+n.time)/r.m7);return t.m1||t.m2||t.m3||t.m4||t.m5||t.m6||t.m7?(t.c1=this._readService.getRecords().length,t.c2=this._readService.getAllFields().length,t):null}_startTask(e){const t=this._configuration.getValue("monitor.sendLog"),r=this._getCommandPerfData(e);!r||(WSe("command perf: %j",r),null==t||t(61,r))}};HSe([to(qf)],GSe.prototype,"_configuration",2),HSe([to(yf)],GSe.prototype,"_lifeCycleService",2),HSe([to(Dy)],GSe.prototype,"_readService",2),HSe([to(BSe)],GSe.prototype,"_commandHook",2),GSe=HSe([eo()],GSe);var KSe="named",qSe="name",YSe="unmanaged",XSe="optional",ZSe="inject",JSe="multi_inject",QSe="inversify:paramtypes",eke="design:paramtypes",tke="post_construct";var rke=[ZSe,JSe,qSe,YSe,KSe,XSe],nke="Request",ike="Singleton",oke="Transient",ake={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},ske={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},lke=0;function cke(){return lke++}var uke=function(){function e(e,t){this.id=cke(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=ake.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===ike&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.cache=this.cache,t},e}(),dke="Cannot apply @injectable decorator multiple times.",fke="NULL argument",pke="Key Not Found",hke="Ambiguous match found for serviceIdentifier:",mke="No matching bindings found for serviceIdentifier:",vke="Missing required @injectable annotation in:",gke="Missing required @inject or @multiInject annotation in:",yke="Circular dependency found:",bke=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},wke=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"@postConstruct error in class "+e[0]+": "+e[1]},_ke="Maximum call stack size exceeded",Cke=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(QSe,e),userGeneratedMetadata:Reflect.getMetadata("inversify:tagged",e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata("inversify:tagged_props",e)||[]},e}(),Eke={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function xke(e){return e instanceof RangeError||e.message===_ke}function Ske(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function kke(e,t,r){var n="",i=r(e,t);return 0!==i.length&&(n="\nRegistered bindings:",i.forEach((function(e){var t="Object";null!==e.implementationType&&(t=Rke(e.implementationType)),n=n+"\n "+t,e.constraint.metaData&&(n=n+" - "+e.constraint.metaData)}))),n}function Oke(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||Oke(e.parentRequest,t))}function Ike(e){e.childRequests.forEach((function(e){if(Oke(e,e.serviceIdentifier)){var t=function(e){var t=function e(t,r){void 0===r&&(r=[]);var n=Ske(t.serviceIdentifier);return r.push(n),null!==t.parentRequest?e(t.parentRequest,r):r}(e);return t.reverse().join(" --\x3e ")}(e);throw new Error(yke+" "+t)}Ike(e)}))}function Rke(e){if(e.name)return e.name;var t=e.toString(),r=t.match(/^function\s*([^\s(]+)/);return r?r[1]:"Anonymous function: "+t}var Tke=function(){function e(e){this.id=cke(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}(),Ake=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===KSe?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},e}(),Nke=function(e,t){this.parentContext=e,this.rootRequest=t},Mke=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}(),Pke=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,r=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},r)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}(),jke=function(){function e(e,t,r,n){this.id=cke(),this.type=e,this.serviceIdentifier=r,this.name=new Pke(t||""),this.metadata=new Array;var i=null;"string"==typeof n?i=new Ake(KSe,n):n instanceof Ake&&(i=n),null!==i&&this.metadata.push(i)}return e.prototype.hasTag=function(e){for(var t=0,r=this.metadata;t<r.length;t++){if(r[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(JSe)},e.prototype.matchesArray=function(e){return this.matchesTag(JSe)(e)},e.prototype.isNamed=function(){return this.hasTag(KSe)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return rke.every((function(t){return e.key!==t}))}))},e.prototype.isOptional=function(){return this.matchesTag(XSe)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===KSe}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return rke.every((function(t){return e.key!==t}))})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(KSe)(e)},e.prototype.matchesTag=function(e){var t=this;return function(r){for(var n=0,i=t.metadata;n<i.length;n++){var o=i[n];if(o.key===e&&o.value===r)return!0}return!1}},e}(),Dke=globalThis&&globalThis.__spreadArray||function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e};function Fke(e,t,r,n){var i=e.getConstructorMetadata(r),o=i.compilerGeneratedMetadata;if(void 0===o)throw new Error(vke+" "+t+".");var a=i.userGeneratedMetadata,s=Object.keys(a),l=0===r.length&&s.length>0,c=s.length>r.length,u=function(e,t,r,n,i){for(var o=[],a=0;a<i;a++){var s=Vke(a,e,t,r,n);null!==s&&o.push(s)}return o}(n,t,o,a,l||c?s.length:r.length),d=Lke(e,r);return Dke(Dke([],u),d)}function Vke(e,t,r,n,i){var o=i[e.toString()]||[],a=Bke(o),s=!0!==a.unmanaged,l=n[e];if((l=a.inject||a.multiInject||l)instanceof Mke&&(l=l.unwrap()),s){if(!t&&(l===Object||l===Function||void 0===l))throw new Error(gke+" argument "+e+" in class "+r+".");var c=new jke(ske.ConstructorArgument,a.targetName,l);return c.metadata=o,c}return null}function Lke(e,t){for(var r=e.getPropertiesMetadata(t),n=[],i=0,o=Object.keys(r);i<o.length;i++){var a=o[i],s=r[a],l=Bke(r[a]),c=l.targetName||a,u=l.inject||l.multiInject,d=new jke(ske.ClassProperty,c,u);d.metadata=s,n.push(d)}var f=Object.getPrototypeOf(t.prototype).constructor;if(f!==Object){var p=Lke(e,f);n=Dke(Dke([],n),p)}return n}function $ke(e,t){var r=Object.getPrototypeOf(t.prototype).constructor;if(r!==Object){var n=Fke(e,Rke(r),r,!0),i=n.map((function(e){return e.metadata.filter((function(e){return e.key===YSe}))})),o=[].concat.apply([],i).length,a=n.length-o;return a>0?a:$ke(e,r)}return 0}function Bke(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[ZSe],multiInject:t[JSe],targetName:t[qSe],unmanaged:t[YSe]}}var zke=function(){function e(e,t,r,n,i){this.id=cke(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=r,this.target=i,this.childRequests=[],this.bindings=Array.isArray(n)?n:[n],this.requestScope=null===r?new Map:null}return e.prototype.addChildRequest=function(t,r,n){var i=new e(t,this.parentContext,this,r,n);return this.childRequests.push(i),i},e}();function Uke(e){return e._bindingDictionary}function Hke(e,t,r,n,i){var o=Gke(r.container,i.serviceIdentifier),a=[];return o.length===Eke.NoBindingsAvailable&&r.container.options.autoBindInjectable&&"function"==typeof i.serviceIdentifier&&e.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(r.container.bind(i.serviceIdentifier).toSelf(),o=Gke(r.container,i.serviceIdentifier)),a=t?o:o.filter((function(e){var t=new zke(e.serviceIdentifier,r,n,e,i);return e.constraint(t)})),function(e,t,r,n){switch(t.length){case Eke.NoBindingsAvailable:if(r.isOptional())return t;var i=Ske(e),o=mke;throw o+=function(e,t){if(t.isTagged()||t.isNamed()){var r="",n=t.getNamedTag(),i=t.getCustomTags();return null!==n&&(r+=n.toString()+"\n"),null!==i&&i.forEach((function(e){r+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+r}return" "+e}(i,r),o+=kke(n,i,Gke),new Error(o);case Eke.OnlyOneBindingAvailable:if(!r.isArray())return t;case Eke.MultipleBindingsAvailable:default:if(r.isArray())return t;i=Ske(e),o=hke+" "+i;throw o+=kke(n,i,Gke),new Error(o)}}(i.serviceIdentifier,a,i,r.container),a}function Wke(e,t,r,n,i,o){var a,s;if(null===i){a=Hke(e,t,n,null,o),s=new zke(r,n,null,a,o);var l=new Nke(n,s);n.addPlan(l)}else a=Hke(e,t,n,i,o),s=i.addChildRequest(o.serviceIdentifier,a,o);a.forEach((function(t){var r=null;if(o.isArray())r=s.addChildRequest(t.serviceIdentifier,t,o);else{if(t.cache)return;r=s}if(t.type===ake.Instance&&null!==t.implementationType){var i=function(e,t){return Fke(e,Rke(t),t,!1)}(e,t.implementationType);if(!n.container.options.skipBaseClassChecks){var a=$ke(e,t.implementationType);if(i.length<a){var l=bke(Rke(t.implementationType));throw new Error(l)}}i.forEach((function(t){Wke(e,!1,t.serviceIdentifier,n,r,t)}))}}))}function Gke(e,t){var r=[],n=Uke(e);return n.hasKey(t)?r=n.get(t):null!==e.parent&&(r=Gke(e.parent,t)),r}function Kke(e,t,r,n,i,o,a,s){void 0===s&&(s=!1);var l=new Tke(t),c=function(e,t,r,n,i,o){var a=new Ake(e?JSe:ZSe,r),s=new jke(t,n,r,a);if(void 0!==i){var l=new Ake(i,o);s.metadata.push(l)}return s}(r,n,i,"",o,a);try{return Wke(e,s,i,l,null,c),l}catch(e){throw xke(e)&&l.plan&&Ike(l.plan.rootRequest),e}}var qke=globalThis&&globalThis.__spreadArray||function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e};function Yke(e,t,r){var n=null;t.length>0?(n=function(e,t){return new(e.bind.apply(e,qke([void 0],t)))}(e,t.filter((function(e){return null!==e.target&&e.target.type===ske.ConstructorArgument})).map(r)),n=function(e,t,r){var n=t.filter((function(e){return null!==e.target&&e.target.type===ske.ClassProperty})),i=n.map(r);return n.forEach((function(t,r){var n;n=t.target.name.value();var o=i[r];e[n]=o})),e}(n,t,r)):n=new e;return function(e,t){if(Reflect.hasMetadata(tke,e)){var r=Reflect.getMetadata(tke,e);try{t[r.value]()}catch(t){throw new Error(wke(e.name,t.message))}}}(e,n),n}var Xke=function(e,t,r){try{return r()}catch(r){throw xke(r)?new Error(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"It looks like there is a circular dependency in one of the '"+e[0]+"' bindings. Please investigate bindings withservice identifier '"+e[1]+"'."}(e,t.toString())):r}},Zke=function(e){return function(t){t.parentContext.setCurrentRequest(t);var r=t.bindings,n=t.childRequests,i=t.target&&t.target.isArray(),o=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(i&&o)return n.map((function(t){return Zke(e)(t)}));var a=null;if(!t.target.isOptional()||0!==r.length){var s=r[0],l=s.scope===ike,c=s.scope===nke;if(l&&s.activated)return s.cache;if(c&&null!==e&&e.has(s.id))return e.get(s.id);if(s.type===ake.ConstantValue)a=s.cache,s.activated=!0;else if(s.type===ake.Function)a=s.cache,s.activated=!0;else if(s.type===ake.Constructor)a=s.implementationType;else if(s.type===ake.DynamicValue&&null!==s.dynamicValue)a=Xke("toDynamicValue",s.serviceIdentifier,(function(){return s.dynamicValue(t.parentContext)}));else if(s.type===ake.Factory&&null!==s.factory)a=Xke("toFactory",s.serviceIdentifier,(function(){return s.factory(t.parentContext)}));else if(s.type===ake.Provider&&null!==s.provider)a=Xke("toProvider",s.serviceIdentifier,(function(){return s.provider(t.parentContext)}));else{if(s.type!==ake.Instance||null===s.implementationType){var u=Ske(t.serviceIdentifier);throw new Error("Invalid binding type: "+u)}a=Yke(s.implementationType,n,Zke(e))}return"function"==typeof s.onActivation&&(a=s.onActivation(t.parentContext,a)),l&&(s.cache=a,s.activated=!0),c&&null!==e&&!e.has(s.id)&&e.set(s.id,a),a}}};var Jke,Qke,eOe,tOe=function(e,t){var r=e.parentRequest;return null!==r&&(!!t(r)||tOe(r,t))},rOe=function(e){return function(t){var r=function(r){return null!==r&&null!==r.target&&r.target.matchesTag(e)(t)};return r.metaData=new Ake(e,t),r}},nOe=rOe(KSe),iOe=function(e){return function(t){var r=null;if(null!==t){if(r=t.bindings[0],"string"==typeof e)return r.serviceIdentifier===e;var n=t.bindings[0].implementationType;return e===n}return!1}},oOe=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new aOe(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=nOe(e),new aOe(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e.target&&!e.target.isNamed()&&!e.target.isTagged()},new aOe(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=rOe(e)(t),new aOe(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return iOe(e)(t.parentRequest)},new aOe(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return nOe(e)(t.parentRequest)},new aOe(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(r){return rOe(e)(t)(r.parentRequest)},new aOe(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return tOe(t,iOe(e))},new aOe(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return!tOe(t,iOe(e))},new aOe(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return tOe(t,nOe(e))},new aOe(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return!tOe(t,nOe(e))},new aOe(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(r){return tOe(r,rOe(e)(t))},new aOe(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(r){return!tOe(r,rOe(e)(t))},new aOe(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return tOe(t,e)},new aOe(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return!tOe(t,e)},new aOe(this._binding)},e}(),aOe=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new oOe(this._binding)},e}(),sOe=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new oOe(this._binding),this._bindingOnSyntax=new aOe(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}(),lOe=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=nke,new sOe(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=ike,new sOe(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=oke,new sOe(this._binding)},e}(),cOe=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new oOe(this._binding),this._bindingOnSyntax=new aOe(this._binding),this._bindingInSyntax=new lOe(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}(),uOe=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=ake.Instance,this._binding.implementationType=e,new cOe(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error("The toSelf function can only be applied when a constructor is used as service identifier");var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=ake.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=ike,new sOe(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=ake.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new cOe(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=ake.Constructor,this._binding.implementationType=e,this._binding.scope=ike,new sOe(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=ake.Factory,this._binding.factory=e,this._binding.scope=ike,new sOe(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error("Value provided to function binding must be a function!");var t=this.toConstantValue(e);return this._binding.type=ake.Function,this._binding.scope=ike,t},e.prototype.toAutoFactory=function(e){return this._binding.type=ake.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},this._binding.scope=ike,new sOe(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=ake.Provider,this._binding.provider=e,this._binding.scope=ike,new sOe(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}(),dOe=function(){function e(){}return e.of=function(t,r){var n=new e;return n.bindings=t,n.middleware=r,n},e}(),fOe=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(fke);if(null==t)throw new Error(fke);var r=this._map.get(e);void 0!==r?(r.push(t),this._map.set(e,r)):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(fke);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(pke)},e.prototype.remove=function(e){if(null==e)throw new Error(fke);if(!this._map.delete(e))throw new Error(pke)},e.prototype.removeByCondition=function(e){var t=this;this._map.forEach((function(r,n){var i=r.filter((function(t){return!e(t)}));i.length>0?t._map.set(n,i):t._map.delete(n)}))},e.prototype.hasKey=function(e){if(null==e)throw new Error(fke);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,r){e.forEach((function(e){return t.add(r,e.clone())}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,r){e(r,t)}))},e}(),pOe=globalThis&&globalThis.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(a,s)}l((n=n.apply(e,t||[])).next())}))},hOe=globalThis&&globalThis.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},mOe=globalThis&&globalThis.__spreadArray||function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e},vOe=function(){function e(e){this._appliedMiddleware=[];var t=e||{};if("object"!=typeof t)throw new Error("Invalid Container constructor argument. Container options must be an object.");if(void 0===t.defaultScope)t.defaultScope=oke;else if(t.defaultScope!==ike&&t.defaultScope!==oke&&t.defaultScope!==nke)throw new Error("Invalid Container option. Default scope must be a string ('singleton' or 'transient').");if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error("Invalid Container option. Auto bind injectable must be a boolean");if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error("Invalid Container option. Skip base check must be a boolean");this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=cke(),this._bindingDictionary=new fOe,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new Cke}return e.merge=function(t,r){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=new e,a=mOe([t,r],n).map((function(e){return Uke(e)})),s=Uke(o);return a.forEach((function(e){!function(e,t){e.traverse((function(e,r){r.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))}(e,s)})),o},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=this._getContainerModuleHelpersFactory(),n=0,i=e;n<i.length;n++){var o=i[n],a=r(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return pOe(this,void 0,void 0,(function(){var t,r,n,i,o;return hOe(this,(function(a){switch(a.label){case 0:t=this._getContainerModuleHelpersFactory(),r=0,n=e,a.label=1;case 1:return r<n.length?(i=n[r],o=t(i.id),[4,i.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction)]):[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.forEach((function(t){var r=function(e){return function(t){return t.moduleId===e}}(t.id);e._bindingDictionary.removeByCondition(r)}))},e.prototype.bind=function(e){var t=this.options.defaultScope||oke,r=new uke(e,t);return this._bindingDictionary.add(e,r),new uOe(r)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.unbind=function(e){try{this._bindingDictionary.remove(e)}catch{throw new Error("Could not unbind serviceIdentifier: "+Ske(e))}},e.prototype.unbindAll=function(){this._bindingDictionary=new fOe},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,KSe,t)},e.prototype.isBoundTagged=function(e,t,r){var n=!1;if(this._bindingDictionary.hasKey(e)){var i=this._bindingDictionary.get(e),o=function(e,t,r,n){var i=new jke(ske.Variable,"",t,new Ake(r,n)),o=new Tke(e);return new zke(t,o,null,[],i)}(this,e,t,r);n=i.some((function(e){return e.constraint(o)}))}return!n&&this.parent&&(n=this.parent.isBoundTagged(e,t,r)),n},e.prototype.snapshot=function(){this._snapshots.push(dOe.of(this._bindingDictionary.clone(),this._middleware))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error("No snapshot available to restore.");this._bindingDictionary=e.bindings,this._middleware=e.middleware},e.prototype.createChild=function(t){var r=new e(t||this.options);return r.parent=this,r},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._appliedMiddleware=this._appliedMiddleware.concat(e);var r=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),r)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){return this._get(!1,!1,ske.Variable,e)},e.prototype.getTagged=function(e,t,r){return this._get(!1,!1,ske.Variable,e,t,r)},e.prototype.getNamed=function(e,t){return this.getTagged(e,KSe,t)},e.prototype.getAll=function(e){return this._get(!0,!0,ske.Variable,e)},e.prototype.getAllTagged=function(e,t,r){return this._get(!1,!0,ske.Variable,e,t,r)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,KSe,t)},e.prototype.resolve=function(e){var t=this.createChild();return t.bind(e).toSelf(),this._appliedMiddleware.forEach((function(e){t.applyMiddleware(e)})),t.get(e)},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},r=function(r){return function(n){var i=e.bind.bind(e)(n);return t(i,r),i}},n=function(r){return function(n){var i=e.rebind.bind(e)(n);return t(i,r),i}};return function(t){return{bindFunction:r(t),isboundFunction:function(t){return e.isBound.bind(e)(t)},rebindFunction:n(t),unbindFunction:function(t){e.unbind.bind(e)(t)}}}},e.prototype._get=function(e,t,r,n,i,o){var a=null,s={avoidConstraints:e,contextInterceptor:function(e){return e},isMultiInject:t,key:i,serviceIdentifier:n,targetType:r,value:o};if(this._middleware){if(null==(a=this._middleware(s)))throw new Error("Invalid return type in middleware. Middleware must return!")}else a=this._planAndResolve()(s);return a},e.prototype._planAndResolve=function(){var e=this;return function(t){var r=Kke(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints),n=function(e){return Zke(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}(r=t.contextInterceptor(r));return n}},e}();function gOe(e){return gOe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gOe(e)}function yOe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bOe(e,t,r){return t&&yOe(e.prototype,t),r&&yOe(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wOe(e){return wOe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wOe(e)}function _Oe(e,t){return t.lifecycle===Qke.Lifecycle.singleton?function(e){return e.inSingletonScope()}(e):function(e){return e.inTransientScope()}(e)}function COe(e,t){e.whenTargetNamed(SOe(t))}function EOe(e,t){return t.bind(kOe(e))}function xOe(e,t){if(t.isBound(kOe(e)))try{return t.rebind(kOe(e))}catch{return t.bind(kOe(e))}return t.bind(kOe(e))}function SOe(e){return eOe.isDefinedToken(e)?e.symbol:e}function kOe(e){return eOe.isDefinedToken(e)?e.symbol:e}!function(e){!function(t){var r="object"==typeof Qt?Qt:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=i(e);function i(e,t){return function(r,n){"function"!=typeof e[r]&&Object.defineProperty(e,r,{configurable:!0,writable:!0,value:n}),t&&t(r,n)}}typeof r.Reflect>"u"?r.Reflect=e:n=i(r.Reflect,n),function(e){var t=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,n=r&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",i=r&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,a={__proto__:[]}instanceof Array,s=!o&&!a,l={create:o?function(){return ne(Object.create(null))}:a?function(){return ne({__proto__:null})}:function(){return ne({})},has:s?function(e,r){return t.call(e,r)}:function(e,t){return t in e},get:s?function(e,r){return t.call(e,r)?e[r]:void 0}:function(e,t){return e[t]}},c=Object.getPrototypeOf(Function),u="object"==typeof er.exports&&er.exports.env&&"true"===er.exports.env.REFLECT_METADATA_USE_MAP_POLYFILL,d=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,f=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,p=new(u||"function"!=typeof WeakMap?re():WeakMap);function h(e,t,r,n){if(j(r)){if(!H(e))throw new TypeError;if(!G(t))throw new TypeError;return x(e,t)}if(!H(e))throw new TypeError;if(!V(t))throw new TypeError;if(!V(n)&&!j(n)&&!D(n))throw new TypeError;return D(n)&&(n=void 0),S(e,t,r=U(r),n)}function m(e,t){function r(r,n){if(!V(r))throw new TypeError;if(!j(n)&&!K(n))throw new TypeError;A(e,t,r,n)}return r}function v(e,t,r,n){if(!V(r))throw new TypeError;return j(n)||(n=U(n)),A(e,t,r,n)}function g(e,t,r){if(!V(t))throw new TypeError;return j(r)||(r=U(r)),O(e,t,r)}function y(e,t,r){if(!V(t))throw new TypeError;return j(r)||(r=U(r)),I(e,t,r)}function b(e,t,r){if(!V(t))throw new TypeError;return j(r)||(r=U(r)),R(e,t,r)}function w(e,t,r){if(!V(t))throw new TypeError;return j(r)||(r=U(r)),T(e,t,r)}function _(e,t){if(!V(e))throw new TypeError;return j(t)||(t=U(t)),N(e,t)}function C(e,t){if(!V(e))throw new TypeError;return j(t)||(t=U(t)),M(e,t)}function E(e,t,r){if(!V(t))throw new TypeError;j(r)||(r=U(r));var n=k(t,r,!1);if(j(n)||!n.delete(e))return!1;if(n.size>0)return!0;var i=p.get(t);return i.delete(r),i.size>0||p.delete(t),!0}function x(e,t){for(var r=e.length-1;r>=0;--r){var n=(0,e[r])(t);if(!j(n)&&!D(n)){if(!G(n))throw new TypeError;t=n}}return t}function S(e,t,r,n){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,r,n);if(!j(o)&&!D(o)){if(!V(o))throw new TypeError;n=o}}return n}function k(e,t,r){var n=p.get(e);if(j(n)){if(!r)return;n=new d,p.set(e,n)}var i=n.get(t);if(j(i)){if(!r)return;i=new d,n.set(t,i)}return i}function O(e,t,r){if(I(e,t,r))return!0;var n=Q(t);return!D(n)&&O(e,n,r)}function I(e,t,r){var n=k(t,r,!1);return!j(n)&&B(n.has(e))}function R(e,t,r){if(I(e,t,r))return T(e,t,r);var n=Q(t);return D(n)?void 0:R(e,n,r)}function T(e,t,r){var n=k(t,r,!1);if(!j(n))return n.get(e)}function A(e,t,r,n){k(r,n,!0).set(e,t)}function N(e,t){var r=M(e,t),n=Q(e);if(null===n)return r;var i=N(n,t);if(i.length<=0)return r;if(r.length<=0)return i;for(var o=new f,a=[],s=0,l=r;s<l.length;s++){var c=l[s];o.has(c)||(o.add(c),a.push(c))}for(var u=0,d=i;u<d.length;u++){c=d[u];o.has(c)||(o.add(c),a.push(c))}return a}function M(e,t){var r=[],n=k(e,t,!1);if(j(n))return r;for(var i=Y(n.keys()),o=0;;){var a=Z(i);if(!a)return r.length=o,r;var s=X(a);try{r[o]=s}catch(e){try{J(i)}finally{throw e}}o++}}function P(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function j(e){return void 0===e}function D(e){return null===e}function F(e){return"symbol"==typeof e}function V(e){return"object"==typeof e?null!==e:"function"==typeof e}function L(e,t){switch(P(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",i=q(e,n);if(void 0!==i){var o=i.call(e,r);if(V(o))throw new TypeError;return o}return $(e,"default"===r?"number":r)}function $(e,t){if("string"===t){var r=e.toString;if(W(r))if(!V(i=r.call(e)))return i;if(W(n=e.valueOf))if(!V(i=n.call(e)))return i}else{var n;if(W(n=e.valueOf))if(!V(i=n.call(e)))return i;var i,o=e.toString;if(W(o))if(!V(i=o.call(e)))return i}throw new TypeError}function B(e){return!!e}function z(e){return""+e}function U(e){var t=L(e,3);return F(t)?t:z(t)}function H(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function W(e){return"function"==typeof e}function G(e){return"function"==typeof e}function K(e){switch(P(e)){case 3:case 4:return!0;default:return!1}}function q(e,t){var r=e[t];if(null!=r){if(!W(r))throw new TypeError;return r}}function Y(e){var t=q(e,i);if(!W(t))throw new TypeError;var r=t.call(e);if(!V(r))throw new TypeError;return r}function X(e){return e.value}function Z(e){var t=e.next();return!t.done&&t}function J(e){var t=e.return;t&&t.call(e)}function Q(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===c||t!==c)return t;var r=e.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return t;var i=n.constructor;return"function"!=typeof i||i===e?t:i}function ee(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var n=this._keys.length,i=r+1;i<n;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,n)},t.prototype.values=function(){return new r(this._keys,this._values,o)},t.prototype.entries=function(){return new r(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function n(e,t){return e}function o(e,t){return t}function a(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new d}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}()}function re(){var e=16,r=l.create(),n=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&l.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?l.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+c()}while(l.has(r,e));return r[e]=!0,e}function o(e,r){if(!t.call(e,n)){if(!r)return;Object.defineProperty(e,n,{value:l.create()})}return e[n]}function a(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function s(e){return"function"==typeof Uint8Array?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(e)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(e)):a(new Uint8Array(e),e):a(new Array(e),e)}function c(){var t=s(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",n=0;n<e;++n){var i=t[n];(4===n||6===n||8===n)&&(r+="-"),i<16&&(r+="0"),r+=i.toString(16).toLowerCase()}return r}}function ne(e){return e.__=void 0,delete e.__,e}e("decorate",h),e("metadata",m),e("defineMetadata",v),e("hasMetadata",g),e("hasOwnMetadata",y),e("getMetadata",b),e("getOwnMetadata",w),e("getMetadataKeys",_),e("getOwnMetadataKeys",C),e("deleteMetadata",E)}(n)}()}(Jke||(Jke={})),function(e){e.defineToken=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{multiple:!0};return new e.DefinedToken(t,r)};var t,r=bOe((function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.prototype={},this.name=void 0,this.multiple=void 0,this.symbol=void 0;var n=r.multiple,i=void 0!==n&&n;this.name=t,this.symbol=Symbol(this.name),this.multiple=i}));e.DefinedToken=r,e.isModule=function(e){return!!e&&"object"===gOe(e)&&"id"in e},function(e){e.singleton="singleton",e.transient="transient"}(t=e.Lifecycle||(e.Lifecycle={})),e.ClassOptionSymbol=Symbol("SyringeClassOptionSymbol"),e.DefaultOption={lifecycle:t.transient}}(Qke||(Qke={})),function(e){e.toArray=function(e){return Array.isArray(e)?e:void 0===e?[]:[e]},e.isClass=function(e){return!(!e||"function"!=typeof e||!("prototype"in e))},e.isDefinedToken=function(e){return!!(e&&"object"===gOe(e)&&"symbol"in e&&"multiple"in e)},e.isInjectOption=function(e){return!(!e||"object"!==gOe(e)||!("token"in e))},e.isNamedToken=function(e){return!!(e&&"object"===gOe(e)&&"token"in e&&"named"in e)},e.isMultipleEnabled=function(t){return e.isDefinedToken(t)&&t.multiple}}(eOe||(eOe={}));var OOe=new vOe;function IOe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ROe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?IOe(Object(r),!0).forEach((function(t){TOe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IOe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function TOe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var AOe=Symbol("SyringeOptionSymbol");function NOe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function MOe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?NOe(Object(r),!0).forEach((function(t){POe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NOe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function POe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jOe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var DOe=function(){function e(t,r,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.token=void 0,this.rawToken=void 0,this.named=void 0,this.generalToken=void 0,this.option=void 0,this.register=void 0,this.mutiple=void 0,this.register=t,this.token=r,this.option=n,this.rawToken=eOe.isNamedToken(r)?r.token:r,this.named=eOe.isNamedToken(r)?r.named:void 0,this.mutiple=!!this.named||eOe.isMultipleEnabled(this.rawToken),this.generalToken=this.rawToken}return function(e,t,r){t&&jOe(e.prototype,t),r&&jOe(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"resolve",value:function(){var e=this,t=this.register;!function(e){return e&&"object"===wOe(e)&&"bind"in e&&"unbind"in e&&"rebind"in e&&"isBound"in e}(t)||(this.mutiple?this.resolveMutilple(t):(this.resolveMono(t),!this.named&&this.option.contrib.length>0&&this.option.contrib.forEach((function(r){eOe.isMultipleEnabled(r)?EOe(r,t).toService(e.generalToken):xOe(r,t).toService(e.generalToken)}))))}},{key:"resolveMono",value:function(e){if("useValue"in this.option)return xOe(this.generalToken,e).toConstantValue(this.option.useValue);if(this.option.useDynamic.length>0){var t=this.option.useDynamic[this.option.useDynamic.length-1];return _Oe(xOe(this.generalToken,e).toDynamicValue((function(e){var r=XOe.getContainer(e.container);return t({container:r})})),this.option)}if(this.option.useFactory.length>0){var r=this.option.useFactory[this.option.useFactory.length-1];return xOe(this.generalToken,e).toFactory((function(e){var t=XOe.getContainer(e.container);return r({container:t})}))}if(this.option.useClass.length>0){var n=this.option.useClass[this.option.useClass.length-1];return _Oe(xOe(this.generalToken,e).to(n),this.option)}}},{key:"resolveMutilple",value:function(e){var t=this,r=this.option.useClass.map((function(r){return _Oe(EOe(t.generalToken,e).to(r),t.option)})),n=this.option.useDynamic.map((function(r){return _Oe(EOe(t.generalToken,e).toDynamicValue((function(e){var t=XOe.getContainer(e.container);return r({container:t})})),t.option)})),i=this.option.useFactory.map((function(r){return EOe(t.generalToken,e).toFactory((function(e){var t=XOe.getContainer(e.container);return r({container:t})}))})),o="useValue"in this.option?EOe(this.generalToken,e).toConstantValue(this.option.useValue):void 0;this.named&&(r.forEach((function(e){return t.named&&COe(e,t.named)})),n.forEach((function(e){return t.named&&COe(e,t.named)})),i.forEach((function(e){return t.named&&COe(e,t.named)})),o&&COe(o,this.named))}}],[{key:"resolveTarget",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{try{var i=Reflect.getMetadata(AOe,r);i&&e.resolveOption(t,i)}catch{}if(eOe.isClass(r))if(n.useClass){var o=eOe.toArray(n.useClass);o.unshift(r),n.useClass=o}else n.useClass=[r];var a;try{a=Reflect.getMetadata(Qke.ClassOptionSymbol,r)}catch{}if((a=MOe(MOe({},a||{}),n)).token){var s=eOe.toArray(a.token);s.unshift(r),a.token=s}else a.token=[r];e.resolveOption(t,a)}catch{}}},{key:"resolveOption",value:function(t,r){var n=function(e){var t=eOe.toArray(e.token),r=eOe.toArray(e.useClass),n=eOe.toArray(e.useDynamic),i=eOe.toArray(e.useFactory),o=eOe.toArray(e.contrib),a=e.lifecycle||Qke.Lifecycle.transient,s={token:t,useClass:r,lifecycle:o.length>0?Qke.Lifecycle.singleton:a,contrib:o,useDynamic:n,useFactory:i};return"useValue"in e&&(s.useValue=e.useValue),s}(MOe(MOe({},e.globalConfig),r));0===n.useClass.length&&0===n.useDynamic.length&&0===n.useFactory.length&&!("useValue"in n)||n.token.forEach((function(r){new e(t,r,MOe({},n)).resolve()}))}}]),e}();DOe.globalConfig=Qke.DefaultOption;var FOe=Qke.defineToken("ContributionProvider");function VOe(e){return function(e){if(Array.isArray(e))return LOe(e)}(e)||function(e){if(typeof Symbol<"u"&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return LOe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LOe(e,t)}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function LOe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $Oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function BOe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$Oe(Object(r),!0).forEach((function(t){zOe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$Oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function zOe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UOe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var HOe=function(){function e(t,r,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.option={recursive:!1,cache:!0},this.services=void 0,this.serviceIdentifier=void 0,this.container=void 0,this.container=r,this.serviceIdentifier=t,n&&(this.option=BOe(BOe({},this.option),n))}return function(e,t,r){t&&UOe(e.prototype,t),r&&UOe(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"setServices",value:function(e){for(var t=[],r=this.container;r;){if(r.isBound(this.serviceIdentifier)){var n=r.getAll(this.serviceIdentifier);t.push.apply(t,VOe(n))}r=e?r.parent:void 0}return t}},{key:"getContributions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=BOe(BOe({},this.option),e),r=t.cache,n=t.recursive;return(!r||void 0===this.services)&&(this.services=this.setServices(!!n)),this.services}}]),e}();function WOe(e,t,r){e({token:{token:FOe,named:t},useDynamic:function(e){return new HOe(t,e.container,r)},lifecycle:Qke.Lifecycle.singleton})}function GOe(e){return e&&"inversifyModule"in e}function KOe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var qOe,YOe=new Map,XOe=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.loadedModules=[],this.container=void 0,this.inversify=!0,this.parent=void 0,this.container=t||new vOe,e.setContainer(this.container,this)}return function(e,t,r){t&&KOe(e.prototype,t),r&&KOe(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"load",value:function(e,t){var r=this;return t||!this.loadedModules.includes(e.id)?(GOe(e)?this.container.load(e.inversifyModule):console.warn("Unsupported module.",e),this.loadedModules.push(e.id),{dispose:function(){r.unload(e)}}):{dispose:function(){}}}},{key:"unload",value:function(e){GOe(e)&&(this.container.unload(e.inversifyModule),this.loadedModules=this.loadedModules.filter((function(t){return t!==e.id})))}},{key:"remove",value:function(e){return this.container.unbind(kOe(e))}},{key:"get",value:function(e){return this.container.get(kOe(e))}},{key:"getNamed",value:function(e,t){return this.container.getNamed(kOe(e),SOe(t))}},{key:"getAll",value:function(e){return this.container.getAll(kOe(e))}},{key:"getAllNamed",value:function(e,t){return this.container.getAllNamed(kOe(e),SOe(t))}},{key:"isBound",value:function(e){return this.container.isBound(kOe(e))}},{key:"isBoundNamed",value:function(e,t){return this.container.isBoundNamed(kOe(e),SOe(t))}},{key:"createChild",value:function(){var t=new e(this.container.createChild());return t.parent=this,t}},{key:"register",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};eOe.isInjectOption(e)?DOe.resolveOption(this.container,e):DOe.resolveTarget(this.container,e,t)}}],[{key:"setContainer",value:function(e,t){return YOe.set(e.id,t)}},{key:"getContainer",value:function(t){var r=YOe.get(t.id);if(!r){var n=new e(t);return e.setContainer(t,n),n}return r}},{key:"config",value:function(e){DOe.globalConfig=e}}]),e}(),ZOe=new XOe(OOe);ZOe.register.bind(ZOe),function(e){e.Provider=FOe,e.register=WOe}(qOe||(qOe={}));var JOe=Object.defineProperty,QOe=Object.getOwnPropertyDescriptor;let eIe=class{constructor(){this.commandName=""}beforeExecute(e){return e._executeAt=Vx(),e}afterExecute(e,t){this.commandHook.emitHook({commandName:this.commandName,time:Lx(t._executeAt,Vx())})}};eIe=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?QOe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&JOe(t,r,o),o})([function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(e){if(Reflect.hasOwnMetadata(QSe,e))throw new Error(dke);var t=Reflect.getMetadata(eke,e)||[];return Reflect.defineMetadata(QSe,t,e),e};return function(r){Reflect.defineMetadata(Qke.ClassOptionSymbol,ROe(ROe({},e),{},{target:r}),r),t(r)}}()],eIe);var tIe=Object.defineProperty,rIe=Object.getOwnPropertyDescriptor,nIe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?rIe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&tIe(t,r,o),o};let iIe=class extends eIe{constructor(){super(...arguments),this.commandName="setCell"}};nIe([to(BSe)],iIe.prototype,"commandHook",2),iIe=nIe([eo()],iIe);var oIe=Object.defineProperty,aIe=Object.getOwnPropertyDescriptor,sIe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?aIe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&oIe(t,r,o),o};let lIe=class extends eIe{constructor(){super(...arguments),this.commandName="switchView"}};sIe([to(BSe)],lIe.prototype,"commandHook",2),lIe=sIe([eo()],lIe);var cIe=Object.defineProperty,uIe=Object.getOwnPropertyDescriptor,dIe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?uIe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&cIe(t,r,o),o};let fIe=class extends eIe{constructor(){super(...arguments),this.commandName="createFilter"}};dIe([to(BSe)],fIe.prototype,"commandHook",2),fIe=dIe([eo()],fIe);var pIe=Object.defineProperty,hIe=Object.getOwnPropertyDescriptor,mIe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?hIe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&pIe(t,r,o),o};let vIe=class extends eIe{constructor(){super(...arguments),this.commandName="removeFilter"}};mIe([to(BSe)],vIe.prototype,"commandHook",2),vIe=mIe([eo()],vIe);var gIe=Object.defineProperty,yIe=Object.getOwnPropertyDescriptor,bIe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?yIe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&gIe(t,r,o),o};let wIe=class extends eIe{constructor(){super(...arguments),this.commandName="updateFilter"}};bIe([to(BSe)],wIe.prototype,"commandHook",2),wIe=bIe([eo()],wIe);var _Ie=Object.defineProperty,CIe=Object.getOwnPropertyDescriptor,EIe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?CIe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&_Ie(t,r,o),o};let xIe=class extends eIe{constructor(){super(...arguments),this.commandName="createGridGroup"}};EIe([to(BSe)],xIe.prototype,"commandHook",2),xIe=EIe([eo()],xIe);var SIe=Object.defineProperty,kIe=Object.getOwnPropertyDescriptor,OIe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?kIe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&SIe(t,r,o),o};let IIe=class extends eIe{constructor(){super(...arguments),this.commandName="removeGridGroup"}};OIe([to(BSe)],IIe.prototype,"commandHook",2),IIe=OIe([eo()],IIe);var RIe=Object.defineProperty,TIe=Object.getOwnPropertyDescriptor,AIe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?TIe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&RIe(t,r,o),o};let NIe=class extends eIe{constructor(){super(...arguments),this.commandName="updateGridGroup"}};AIe([to(BSe)],NIe.prototype,"commandHook",2),NIe=AIe([eo()],NIe);var MIe=Object.defineProperty,PIe=Object.getOwnPropertyDescriptor,jIe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?PIe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&MIe(t,r,o),o};let DIe=class extends eIe{constructor(){super(...arguments),this.commandName="createSort"}};jIe([to(BSe)],DIe.prototype,"commandHook",2),DIe=jIe([eo()],DIe);var FIe=Object.defineProperty,VIe=Object.getOwnPropertyDescriptor,LIe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?VIe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&FIe(t,r,o),o};let $Ie=class extends eIe{constructor(){super(...arguments),this.commandName="removeSort"}};LIe([to(BSe)],$Ie.prototype,"commandHook",2),$Ie=LIe([eo()],$Ie);var BIe=Object.defineProperty,zIe=Object.getOwnPropertyDescriptor,UIe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?zIe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&BIe(t,r,o),o};let HIe=class extends eIe{constructor(){super(...arguments),this.commandName="updateSort"}};UIe([to(BSe)],HIe.prototype,"commandHook",2),HIe=UIe([eo()],HIe);var WIe=Object.defineProperty,GIe=Object.getOwnPropertyDescriptor,KIe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?GIe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&WIe(t,r,o),o};let qIe=class extends eIe{constructor(){super(...arguments),this.commandName="addView"}};KIe([to(BSe)],qIe.prototype,"commandHook",2),qIe=KIe([eo()],qIe);var YIe=Object.defineProperty,XIe=Object.getOwnPropertyDescriptor,ZIe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?XIe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&YIe(t,r,o),o};let JIe=class extends eIe{constructor(){super(...arguments),this.commandName="addEmptyRecord"}};ZIe([to(BSe)],JIe.prototype,"commandHook",2),JIe=ZIe([eo()],JIe);var QIe=Object.defineProperty,eRe=Object.getOwnPropertyDescriptor,tRe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?eRe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&QIe(t,r,o),o};let rRe=class{static pluginModule(){return bo().register(GSe).register(BSe).register(iIe).register(qIe).register(lIe).register(fIe).register(vIe).register(wIe).register(xIe).register(IIe).register(NIe).register(DIe).register($Ie).register(HIe).register(JIe).register(this)}static registerConfiguration(e){e.registerConfiguration({id:"monitor",type:"object",properties:{sendLog:{typeof:"function",description:"外部传入的日志处理对象"},startAt:{type:"number",description:"编辑器开始加载时间"}}})}init(){this._initHooks(),this._monitorService.startMainPerfLog(),this._monitorService.startCommandPerfLog()}_initHooks(){this._commandRegistry.registerCommandHook(this._setCellCommandHook.commandName,this._setCellCommandHook),this._commandRegistry.registerCommandHook(this._switchViewCommandHook.commandName,this._switchViewCommandHook),this._commandRegistry.registerCommandHook(this._addViewCommandHook.commandName,this._addViewCommandHook),this._commandRegistry.registerCommandHook(this._createFilterCellCommandHook.commandName,this._createFilterCellCommandHook),this._commandRegistry.registerCommandHook(this._removeFilterCellCommandHook.commandName,this._removeFilterCellCommandHook),this._commandRegistry.registerCommandHook(this._updateFilterCellCommandHook.commandName,this._updateFilterCellCommandHook),this._commandRegistry.registerCommandHook(this._createGroupCellCommandHook.commandName,this._createGroupCellCommandHook),this._commandRegistry.registerCommandHook(this._removeGroupCellCommandHook.commandName,this._removeGroupCellCommandHook),this._commandRegistry.registerCommandHook(this._updateGroupCellCommandHook.commandName,this._updateGroupCellCommandHook),this._commandRegistry.registerCommandHook(this._createSortCellCommandHook.commandName,this._createSortCellCommandHook),this._commandRegistry.registerCommandHook(this._removeSortCellCommandHook.commandName,this._removeSortCellCommandHook),this._commandRegistry.registerCommandHook(this._updateSortCellCommandHook.commandName,this._updateSortCellCommandHook),this._commandRegistry.registerCommandHook(this._addEmptyRecordCommandHook.commandName,this._addEmptyRecordCommandHook)}};rRe.pluginName="kernel-monitor",tRe([to(GSe)],rRe.prototype,"_monitorService",2),tRe([to(Rb)],rRe.prototype,"_commandRegistry",2),tRe([to(iIe)],rRe.prototype,"_setCellCommandHook",2),tRe([to(lIe)],rRe.prototype,"_switchViewCommandHook",2),tRe([to(qIe)],rRe.prototype,"_addViewCommandHook",2),tRe([to(fIe)],rRe.prototype,"_createFilterCellCommandHook",2),tRe([to(vIe)],rRe.prototype,"_removeFilterCellCommandHook",2),tRe([to(wIe)],rRe.prototype,"_updateFilterCellCommandHook",2),tRe([to(xIe)],rRe.prototype,"_createGroupCellCommandHook",2),tRe([to(IIe)],rRe.prototype,"_removeGroupCellCommandHook",2),tRe([to(NIe)],rRe.prototype,"_updateGroupCellCommandHook",2),tRe([to(DIe)],rRe.prototype,"_createSortCellCommandHook",2),tRe([to($Ie)],rRe.prototype,"_removeSortCellCommandHook",2),tRe([to(HIe)],rRe.prototype,"_updateSortCellCommandHook",2),tRe([to(JIe)],rRe.prototype,"_addEmptyRecordCommandHook",2),rRe=tRe([eo({contrib:[Tw]})],rRe);const nRe="object"==typeof pr&&pr&&pr.Object===Object&&pr;var iRe="object"==typeof self&&self&&self.Object===Object&&self;const oRe=nRe||iRe||Function("return this")();const aRe=oRe.Symbol;var sRe=Object.prototype,lRe=sRe.hasOwnProperty,cRe=sRe.toString,uRe=aRe?aRe.toStringTag:void 0;var dRe=Object.prototype.toString;var fRe="[object Null]",pRe="[object Undefined]",hRe=aRe?aRe.toStringTag:void 0;function mRe(e){return null==e?void 0===e?pRe:fRe:hRe&&hRe in Object(e)?function(e){var t=lRe.call(e,uRe),r=e[uRe];try{e[uRe]=void 0;var n=!0}catch{}var i=cRe.call(e);return n&&(t?e[uRe]=r:delete e[uRe]),i}(e):function(e){return dRe.call(e)}(e)}function vRe(e){return null!=e&&"object"==typeof e}var gRe="[object Symbol]";function yRe(e){return"symbol"==typeof e||vRe(e)&&mRe(e)==gRe}const bRe=Array.isArray;var wRe=1/0,_Re=aRe?aRe.prototype:void 0,CRe=_Re?_Re.toString:void 0;function ERe(e){if("string"==typeof e)return e;if(bRe(e))return function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}(e,ERe)+"";if(yRe(e))return CRe?CRe.call(e):"";var t=e+"";return"0"==t&&1/e==-wRe?"-0":t}var xRe=/\s/;var SRe=/^\s+/;function kRe(e){return e&&e.slice(0,function(e){for(var t=e.length;t--&&xRe.test(e.charAt(t)););return t}(e)+1).replace(SRe,"")}function ORe(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var IRe=NaN,RRe=/^[-+]0x[0-9a-f]+$/i,TRe=/^0b[01]+$/i,ARe=/^0o[0-7]+$/i,NRe=parseInt;function MRe(e){if("number"==typeof e)return e;if(yRe(e))return IRe;if(ORe(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ORe(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=kRe(e);var r=TRe.test(e);return r||ARe.test(e)?NRe(e.slice(2),r?2:8):RRe.test(e)?IRe:+e}function PRe(e){return e}var jRe="[object AsyncFunction]",DRe="[object Function]",FRe="[object GeneratorFunction]",VRe="[object Proxy]";function LRe(e){if(!ORe(e))return!1;var t=mRe(e);return t==DRe||t==FRe||t==jRe||t==VRe}const $Re=oRe["__core-js_shared__"];var BRe=function(){var e=/[^.]+$/.exec($Re&&$Re.keys&&$Re.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var zRe=Function.prototype.toString;function URe(e){if(null!=e){try{return zRe.call(e)}catch{}try{return e+""}catch{}}return""}var HRe=/^\[object .+?Constructor\]$/,WRe=Function.prototype,GRe=Object.prototype,KRe=WRe.toString,qRe=GRe.hasOwnProperty,YRe=RegExp("^"+KRe.call(qRe).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function XRe(e){return!(!ORe(e)||function(e){return!!BRe&&BRe in e}(e))&&(LRe(e)?YRe:HRe).test(URe(e))}function ZRe(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return XRe(r)?r:void 0}const JRe=ZRe(oRe,"WeakMap");function QRe(e){return e!=e}function eTe(e,t){return!!(null==e?0:e.length)&&function(e,t,r){return t==t?function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(e,t,r):function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}(e,QRe,r)}(e,t,0)>-1}var tTe=9007199254740991,rTe=/^(?:0|[1-9]\d*)$/;function nTe(e,t){var r=typeof e;return!!(t=null==t?tTe:t)&&("number"==r||"symbol"!=r&&rTe.test(e))&&e>-1&&e%1==0&&e<t}function iTe(e,t){return e===t||e!=e&&t!=t}var oTe=9007199254740991;function aTe(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=oTe}var sTe=Object.prototype;function lTe(e){return vRe(e)&&"[object Arguments]"==mRe(e)}var cTe=Object.prototype,uTe=cTe.hasOwnProperty,dTe=cTe.propertyIsEnumerable,fTe=lTe(function(){return arguments}())?lTe:function(e){return vRe(e)&&uTe.call(e,"callee")&&!dTe.call(e,"callee")};const pTe=fTe;var hTe="object"==typeof exports&&exports&&!exports.nodeType&&exports,mTe=hTe&&"object"==typeof n&&n&&!n.nodeType&&n,vTe=mTe&&mTe.exports===hTe?oRe.Buffer:void 0;const gTe=(vTe?vTe.isBuffer:void 0)||function(){return!1};var yTe={};yTe["[object Float32Array]"]=yTe["[object Float64Array]"]=yTe["[object Int8Array]"]=yTe["[object Int16Array]"]=yTe["[object Int32Array]"]=yTe["[object Uint8Array]"]=yTe["[object Uint8ClampedArray]"]=yTe["[object Uint16Array]"]=yTe["[object Uint32Array]"]=!0,yTe["[object Arguments]"]=yTe["[object Array]"]=yTe["[object ArrayBuffer]"]=yTe["[object Boolean]"]=yTe["[object DataView]"]=yTe["[object Date]"]=yTe["[object Error]"]=yTe["[object Function]"]=yTe["[object Map]"]=yTe["[object Number]"]=yTe["[object Object]"]=yTe["[object RegExp]"]=yTe["[object Set]"]=yTe["[object String]"]=yTe["[object WeakMap]"]=!1;var bTe="object"==typeof exports&&exports&&!exports.nodeType&&exports,wTe=bTe&&"object"==typeof n&&n&&!n.nodeType&&n,_Te=wTe&&wTe.exports===bTe&&nRe.process,CTe=function(){try{return wTe&&wTe.require&&wTe.require("util").types||_Te&&_Te.binding&&_Te.binding("util")}catch{}}();var ETe=CTe&&CTe.isTypedArray,xTe=ETe?function(e){return function(t){return e(t)}}(ETe):function(e){return vRe(e)&&aTe(e.length)&&!!yTe[mRe(e)]};const STe=xTe;var kTe=Object.prototype.hasOwnProperty;function OTe(e,t){var r=bRe(e),n=!r&&pTe(e),i=!r&&!n&&gTe(e),o=!r&&!n&&!i&&STe(e),a=r||n||i||o,s=a?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],l=s.length;for(var c in e)(t||kTe.call(e,c))&&(!a||!("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||nTe(c,l)))&&s.push(c);return s}var ITe=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object);const RTe=ITe;var TTe=Object.prototype.hasOwnProperty;function ATe(e){if(!function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||sTe)}(e))return RTe(e);var t=[];for(var r in Object(e))TTe.call(e,r)&&"constructor"!=r&&t.push(r);return t}function NTe(e){return function(e){return null!=e&&aTe(e.length)&&!LRe(e)}(e)?OTe(e):ATe(e)}var MTe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,PTe=/^\w*$/;function jTe(e,t){if(bRe(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!yRe(e))||(PTe.test(e)||!MTe.test(e)||null!=t&&e in Object(t))}const DTe=ZRe(Object,"create");var FTe=Object.prototype.hasOwnProperty;var VTe=Object.prototype.hasOwnProperty;function LTe(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function $Te(e,t){for(var r=e.length;r--;)if(iTe(e[r][0],t))return r;return-1}LTe.prototype.clear=function(){this.__data__=DTe?DTe(null):{},this.size=0},LTe.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},LTe.prototype.get=function(e){var t=this.__data__;if(DTe){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return FTe.call(t,e)?t[e]:void 0},LTe.prototype.has=function(e){var t=this.__data__;return DTe?void 0!==t[e]:VTe.call(t,e)},LTe.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=DTe&&void 0===t?"__lodash_hash_undefined__":t,this};var BTe=Array.prototype.splice;function zTe(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}zTe.prototype.clear=function(){this.__data__=[],this.size=0},zTe.prototype.delete=function(e){var t=this.__data__,r=$Te(t,e);return!(r<0)&&(r==t.length-1?t.pop():BTe.call(t,r,1),--this.size,!0)},zTe.prototype.get=function(e){var t=this.__data__,r=$Te(t,e);return r<0?void 0:t[r][1]},zTe.prototype.has=function(e){return $Te(this.__data__,e)>-1},zTe.prototype.set=function(e,t){var r=this.__data__,n=$Te(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};const UTe=ZRe(oRe,"Map");function HTe(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function WTe(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}WTe.prototype.clear=function(){this.size=0,this.__data__={hash:new LTe,map:new(UTe||zTe),string:new LTe}},WTe.prototype.delete=function(e){var t=HTe(this,e).delete(e);return this.size-=t?1:0,t},WTe.prototype.get=function(e){return HTe(this,e).get(e)},WTe.prototype.has=function(e){return HTe(this,e).has(e)},WTe.prototype.set=function(e,t){var r=HTe(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};var GTe="Expected a function";function KTe(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(GTe);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(KTe.Cache||WTe),r}KTe.Cache=WTe;var qTe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,YTe=/\\(\\)?/g,XTe=function(e){var t=KTe(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(qTe,(function(e,r,n,i){t.push(n?i.replace(YTe,"$1"):r||e)})),t}));const ZTe=XTe;function JTe(e,t){return bRe(e)?e:jTe(e,t)?[e]:ZTe(function(e){return null==e?"":ERe(e)}(e))}var QTe=1/0;function eAe(e){if("string"==typeof e||yRe(e))return e;var t=e+"";return"0"==t&&1/e==-QTe?"-0":t}function tAe(e,t){for(var r=0,n=(t=JTe(t,e)).length;null!=e&&r<n;)e=e[eAe(t[r++])];return r&&r==n?e:void 0}function rAe(e){var t=this.__data__=new zTe(e);this.size=t.size}rAe.prototype.clear=function(){this.__data__=new zTe,this.size=0},rAe.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},rAe.prototype.get=function(e){return this.__data__.get(e)},rAe.prototype.has=function(e){return this.__data__.has(e)},rAe.prototype.set=function(e,t){var r=this.__data__;if(r instanceof zTe){var n=r.__data__;if(!UTe||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new WTe(n)}return r.set(e,t),this.size=r.size,this};var nAe=Object.prototype.propertyIsEnumerable,iAe=Object.getOwnPropertySymbols,oAe=iAe?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o}(iAe(e),(function(t){return nAe.call(e,t)})))}:function(){return[]};const aAe=oAe;function sAe(e){return function(e,t,r){var n=t(e);return bRe(e)?n:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(n,r(e))}(e,NTe,aAe)}const lAe=ZRe(oRe,"DataView");const cAe=ZRe(oRe,"Promise");const uAe=ZRe(oRe,"Set");var dAe="[object Map]",fAe="[object Promise]",pAe="[object Set]",hAe="[object WeakMap]",mAe="[object DataView]",vAe=URe(lAe),gAe=URe(UTe),yAe=URe(cAe),bAe=URe(uAe),wAe=URe(JRe),_Ae=mRe;(lAe&&_Ae(new lAe(new ArrayBuffer(1)))!=mAe||UTe&&_Ae(new UTe)!=dAe||cAe&&_Ae(cAe.resolve())!=fAe||uAe&&_Ae(new uAe)!=pAe||JRe&&_Ae(new JRe)!=hAe)&&(_Ae=function(e){var t=mRe(e),r="[object Object]"==t?e.constructor:void 0,n=r?URe(r):"";if(n)switch(n){case vAe:return mAe;case gAe:return dAe;case yAe:return fAe;case bAe:return pAe;case wAe:return hAe}return t});const CAe=_Ae;const EAe=oRe.Uint8Array;function xAe(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new WTe;++t<r;)this.add(e[t])}function SAe(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function kAe(e,t){return e.has(t)}xAe.prototype.add=xAe.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},xAe.prototype.has=function(e){return this.__data__.has(e)};var OAe=1,IAe=2;function RAe(e,t,r,n,i,o){var a=r&OAe,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=o.get(e),u=o.get(t);if(c&&u)return c==t&&u==e;var d=-1,f=!0,p=r&IAe?new xAe:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var h=e[d],m=t[d];if(n)var v=a?n(m,h,d,t,e,o):n(h,m,d,e,t,o);if(void 0!==v){if(v)continue;f=!1;break}if(p){if(!SAe(t,(function(e,t){if(!kAe(p,t)&&(h===e||i(h,e,r,n,o)))return p.push(t)}))){f=!1;break}}else if(h!==m&&!i(h,m,r,n,o)){f=!1;break}}return o.delete(e),o.delete(t),f}function TAe(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function AAe(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var NAe=1,MAe=2,PAe="[object Boolean]",jAe="[object Date]",DAe="[object Error]",FAe="[object Map]",VAe="[object Number]",LAe="[object RegExp]",$Ae="[object Set]",BAe="[object String]",zAe="[object Symbol]",UAe="[object ArrayBuffer]",HAe="[object DataView]",WAe=aRe?aRe.prototype:void 0,GAe=WAe?WAe.valueOf:void 0;var KAe=1,qAe=Object.prototype.hasOwnProperty;var YAe=1,XAe="[object Arguments]",ZAe="[object Array]",JAe="[object Object]",QAe=Object.prototype.hasOwnProperty;function eNe(e,t,r,n,i,o){var a=bRe(e),s=bRe(t),l=a?ZAe:CAe(e),c=s?ZAe:CAe(t),u=(l=l==XAe?JAe:l)==JAe,d=(c=c==XAe?JAe:c)==JAe,f=l==c;if(f&&gTe(e)){if(!gTe(t))return!1;a=!0,u=!1}if(f&&!u)return o||(o=new rAe),a||STe(e)?RAe(e,t,r,n,i,o):function(e,t,r,n,i,o,a){switch(r){case HAe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case UAe:return!(e.byteLength!=t.byteLength||!o(new EAe(e),new EAe(t)));case PAe:case jAe:case VAe:return iTe(+e,+t);case DAe:return e.name==t.name&&e.message==t.message;case LAe:case BAe:return e==t+"";case FAe:var s=TAe;case $Ae:var l=n&NAe;if(s||(s=AAe),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;n|=MAe,a.set(e,t);var u=RAe(s(e),s(t),n,i,o,a);return a.delete(e),u;case zAe:if(GAe)return GAe.call(e)==GAe.call(t)}return!1}(e,t,l,r,n,i,o);if(!(r&YAe)){var p=u&&QAe.call(e,"__wrapped__"),h=d&&QAe.call(t,"__wrapped__");if(p||h){var m=p?e.value():e,v=h?t.value():t;return o||(o=new rAe),i(m,v,r,n,o)}}return!!f&&(o||(o=new rAe),function(e,t,r,n,i,o){var a=r&KAe,s=sAe(e),l=s.length;if(l!=sAe(t).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in t:qAe.call(t,u)))return!1}var d=o.get(e),f=o.get(t);if(d&&f)return d==t&&f==e;var p=!0;o.set(e,t),o.set(t,e);for(var h=a;++c<l;){var m=e[u=s[c]],v=t[u];if(n)var g=a?n(v,m,u,t,e,o):n(m,v,u,e,t,o);if(!(void 0===g?m===v||i(m,v,r,n,o):g)){p=!1;break}h||(h="constructor"==u)}if(p&&!h){var y=e.constructor,b=t.constructor;y!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(p=!1)}return o.delete(e),o.delete(t),p}(e,t,r,n,i,o))}function tNe(e,t,r,n,i){return e===t||(null==e||null==t||!vRe(e)&&!vRe(t)?e!=e&&t!=t:eNe(e,t,r,n,tNe,i))}var rNe=1,nNe=2;function iNe(e){return e==e&&!ORe(e)}function oNe(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}function aNe(e){var t=function(e){for(var t=NTe(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,iNe(i)]}return t}(e);return 1==t.length&&t[0][2]?oNe(t[0][0],t[0][1]):function(r){return r===e||function(e,t,r,n){var i=r.length,o=i,a=!n;if(null==e)return!o;for(e=Object(e);i--;){var s=r[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var l=(s=r[i])[0],c=e[l],u=s[1];if(a&&s[2]){if(void 0===c&&!(l in e))return!1}else{var d=new rAe;if(n)var f=n(c,u,l,e,t,d);if(!(void 0===f?tNe(u,c,rNe|nNe,n,d):f))return!1}}return!0}(r,e,t)}}function sNe(e,t){return null!=e&&t in Object(e)}function lNe(e,t){return null!=e&&function(e,t,r){for(var n=-1,i=(t=JTe(t,e)).length,o=!1;++n<i;){var a=eAe(t[n]);if(!(o=null!=e&&r(e,a)))break;e=e[a]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&aTe(i)&&nTe(a,i)&&(bRe(e)||pTe(e))}(e,t,sNe)}var cNe=1,uNe=2;function dNe(e,t){return jTe(e)&&iNe(t)?oNe(eAe(e),t):function(r){var n=function(e,t,r){var n=null==e?void 0:tAe(e,t);return void 0===n?r:n}(r,e);return void 0===n&&n===t?lNe(r,e):tNe(t,n,cNe|uNe)}}function fNe(e){return jTe(e)?function(e){return function(t){return null==t?void 0:t[e]}}(eAe(e)):function(e){return function(t){return tAe(t,e)}}(e)}const pNe=function(){return oRe.Date.now()};var hNe=Math.max,mNe=Math.min;function vNe(e,t,r){var n,i,o,a,s,l,c=0,u=!1,d=!1,f=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var r=n,o=i;return n=i=void 0,c=t,a=e.apply(o,r)}function h(e){var r=e-l;return void 0===l||r>=t||r<0||d&&e-c>=o}function m(){var e=pNe();if(h(e))return v(e);s=setTimeout(m,function(e){var r=t-(e-l);return d?mNe(r,o-(e-c)):r}(e))}function v(e){return s=void 0,f&&n?p(e):(n=i=void 0,a)}function g(){var e=pNe(),r=h(e);if(n=arguments,i=this,l=e,r){if(void 0===s)return function(e){return c=e,s=setTimeout(m,t),u?p(e):a}(l);if(d)return clearTimeout(s),s=setTimeout(m,t),p(l)}return void 0===s&&(s=setTimeout(m,t)),a}return t=MRe(t)||0,ORe(r)&&(u=!!r.leading,o=(d="maxWait"in r)?hNe(MRe(r.maxWait)||0,t):o,f="trailing"in r?!!r.trailing:f),g.cancel=function(){void 0!==s&&clearTimeout(s),c=0,n=l=i=s=void 0},g.flush=function(){return void 0===s?a:v(pNe())},g}function gNe(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}var yNe=uAe&&1/AAe(new uAe([,-0]))[1]==1/0?function(e){return new uAe(e)}:function(){};const bNe=yNe;var wNe=200;function _Ne(e,t){return e&&e.length?function(e,t,r){var n=-1,i=eTe,o=e.length,a=!0,s=[],l=s;if(r)a=!1,i=gNe;else if(o>=wNe){var c=t?null:bNe(e);if(c)return AAe(c);a=!1,i=kAe,l=new xAe}else l=t?[]:s;e:for(;++n<o;){var u=e[n],d=t?t(u):u;if(u=r||0!==u?u:0,a&&d==d){for(var f=l.length;f--;)if(l[f]===d)continue e;t&&l.push(d),s.push(u)}else i(l,d,r)||(l!==s&&l.push(d),s.push(u))}return s}(e,function(e){return"function"==typeof e?e:null==e?PRe:"object"==typeof e?bRe(e)?dNe(e[0],e[1]):aNe(e):fNe(e)}(t)):[]}var CNe=(e=>(e.SUMMARY="summary",e.EXTRACT="extract",e.CUSTOM="custom",e))(CNe||{});const ENe=Fi.defineToken("AiWritingServiceToken"),xNe=Fi.defineToken("AiWritingTaskServiceToken"),SNe=Fi.defineToken("AiWritingDatasourceContribution"),kNe=Fi.defineToken("AiWritingDatasourceToken");var ONe=Object.defineProperty,INe=Object.getOwnPropertyDescriptor,RNe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?INe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ONe(t,r,o),o};let TNe=class{getAiWritingConfig(e){const t=this._modelService.getModel("ai_writing").findOne({field_uuid:e}),r=this._readService.getField(e||"");return(null==t?void 0:t.open)&&r&&r.type!==Rh.TEXT?{open:!1,type:CNe.SUMMARY,prompt:"",auto:!1}:t}};RNe([to(Wp)],TNe.prototype,"_modelService",2),RNe([to(Dy)],TNe.prototype,"_readService",2),TNe=RNe([eo({token:ENe})],TNe);const ANe=[{uuid:CNe.SUMMARY,name:kf("内容总结"),placeholder:kf("将自动对每条记录进行总结")},{uuid:CNe.CUSTOM,name:kf("自定义"),placeholder:kf("输入智能填写规则\n如：为每个商品生成 50 字的宣传文案")}],NNe=Fi.defineToken("ServerContribution"),MNe=Fi.defineToken("SyncQueueToken");var PNe=(e=>(e.RUNNING="running",e.SUCCESS="success",e))(PNe||{}),jNe=Object.defineProperty,DNe=Object.getOwnPropertyDescriptor,FNe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?DNe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&jNe(t,r,o),o};let VNe=class{getProvider(){const e=this.serverProvider.getContributions(),t=e[e.length-1];return null==t?void 0:t.registerServer()}hasProvider(){return this.serverProvider.getContributions().length>0}};FNe([Eo(NNe)],VNe.prototype,"serverProvider",2),VNe=FNe([eo()],VNe);var LNe=Object.defineProperty,$Ne=Object.getOwnPropertyDescriptor,BNe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?$Ne(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&LNe(t,r,o),o};let zNe=class{getCommonParams(e){var t;const r=e?this._readService.getView(e):this._readService.getActiveView();let n={sheetId:this._readService.getTable().uuid,type:null==r?void 0:r.type,viewId:(null==r?void 0:r.uuid)||e};const i=null==(t=this._serverRegistry.getProvider())?void 0:t.processParams;return i&&(n=i(n)),n}getSdk(){var e;return null==(e=this._serverRegistry.getProvider())?void 0:e.apiSdk}setActiveView(){const e=this._readService.getTable(),t=this.getCommonParams(e.active_view_uuid);this._syncQueue.addJob((async()=>{await this.getSdk().TableViewController.setActive(t)}))}updateCell(e){const t=this.getCommonParams();t.records=[];for(const r of e){const e=this._readService.getOriginRecord(r.recordId),n=this._readService.getCell(r.fieldId,r.recordId);!n||t.records.push({data:this._toProcess.toValue(n),fieldId:n.fieldId,recordId:n.recordId,record:this._toProcess.toRecord(e)})}this._syncQueue.addJob((async()=>{await this.getSdk().TableRecordValueController.bulkUpdate(t)}))}addRecord(e){const t=this.getCommonParams();t.data=e.map((e=>({id:e}))),this._syncQueue.addJob((async()=>{await this.getSdk().TableRecordController.create(t)}))}removeRecord(e){const t=this.getCommonParams();t.recordIds=e,this._syncQueue.addJob((async()=>{await this.getSdk().TableRecordController.remove(t)}))}addField(e){const t=this.getCommonParams();t.field=this._toProcess.toColumn(e),this._syncQueue.addJob((async()=>{await this.getSdk().TableFieldController.create(t)}))}updateField(e,t){const r=this._readService.getField(e),n=this._aiWritingService.getAiWritingConfig(e),i=this.getCommonParams();i.field=this._toProcess.toColumn(r),n&&(i.field.enableAI=n.open,i.field.aiWritingType=n.type,i.field.aiPrompt=n.prompt,i.field.enableAutoAIGC=n.auto),this._syncQueue.addJob((async()=>{await this.getSdk().TableFieldController.update(i)})),t&&this._updateFieldRecord()}_updateFieldRecord(){const e=this.getCommonParams(),t=this._readService.getRecords();e.data=t.map((e=>{const t=this._readService.getOriginRecord(e.uuid);return{id:e.uuid,data:JSON.stringify(this._toProcess.toRecord(t))}})),this._syncQueue.addJob((async()=>{await this.getSdk().TableRecordController.update(e)}))}removeField(e){const t=this.getCommonParams();t.fieldId=e,this._syncQueue.addJob((async()=>{await this.getSdk().TableFieldController.remove(t)}))}addView(e){const t=this._readService.getViewData(e),r=this.getCommonParams(e);r.data=this._toProcess.toView(t),this._syncQueue.addJob((async()=>{var e,t;const n=await this.getSdk().TableViewController.create(r);this._model.viewModel.upsert({uuid:null==(e=n.data)?void 0:e.view_id},{id:null==(t=n.data)?void 0:t.data.iid},{slient:!0})}))}updateView(e){const t=this._readService.getViewData(e),r=this.getCommonParams(e);r.data=this._toProcess.toView(t),this._syncQueue.addJob((async()=>{await this.getSdk().TableViewController.update(r)}))}updateViewOrder(e,t){const r=this.getCommonParams(e);r.targetViewId=t,this._syncQueue.addJob((async()=>{await this.getSdk().TableViewController.moveAfter(r)}))}removeView(e){const t=this.getCommonParams(e);this._syncQueue.addJob((async()=>{await this.getSdk().TableViewController.remove(t)}))}updateForm(e,t){this._syncQueue.addJob((async()=>{var r;const n=this._model.viewModel.findOne({uuid:e});let i={type:"form",status:t,viewId:e,target_id:n.id,target_type:"Skythings.View"};const o=null==(r=this._serverRegistry.getProvider())?void 0:r.processParams;o&&(i=o(i)),await this.getSdk().TableShareController.update(i)}))}updateContent(e,t){const r=this._readService.getTable().uuid;this._syncQueue.addJob((async()=>{await this._contentDatasource.handlePut(e,r,t)}))}};BNe([to(Dy)],zNe.prototype,"_readService",2),BNe([to(p_)],zNe.prototype,"_toProcess",2),BNe([to(VNe)],zNe.prototype,"_serverRegistry",2),BNe([to(MNe)],zNe.prototype,"_syncQueue",2),BNe([to(ENe)],zNe.prototype,"_aiWritingService",2),BNe([to(jxe)],zNe.prototype,"_contentDatasource",2),BNe([to(Ov)],zNe.prototype,"_model",2),zNe=BNe([eo()],zNe);var UNe=Object.defineProperty,HNe=Object.getOwnPropertyDescriptor,WNe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?HNe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&UNe(t,r,o),o};const GNe=Wo.Plugin("server");let KNe=class{constructor(){this._spells=[],this.isSync=!1,this.startTaskWithDebounce=vNe((()=>{const e=this._spells;this.startTask(e),this._spells=[]}),300)}init(){this._syncQueue.init(),this._kernelService.onDataLoaded((e=>{"loadedRecords"===e&&setTimeout((()=>{this._hasInited||(this.bindModelEvent(),this._hasInited=!0)}),1e3)}))}destroy(){this._syncQueue.destroy()}bindModelEvent(){this._modelEvent.onChange((({spell:e})=>{e.isRemote||!this._abilityService.canUpdate(Nw.TABLE)||(GNe("spell %j",e),this.syncSpell(e))}))}syncSpell(e){if(this._spells.push(e),this.isSync)return this.startTask(this._spells),void(this._spells=[]);this.startTaskWithDebounce()}startTask(e){if(e.length>0){this.addField(e),this.updateField(e),this.removeField(e),this.addRecord(e);const t=this.removeRecord(e);this.updateCell(e,t),this.addView(e),this.updateView(e),this.removeView(e),this.updateContent(e),this.updateForm(e),this.updateTable(e)}}updateTable(e){let t=!1;for(const r of e)["table"].includes(r.table)&&(t=!0);t&&this._syncHelper.setActiveView()}updateCell(e,t){const r=[];for(const n of e)if(["field_boolean","field_date","field_number","field_select","field_string","field_uri"].includes(n.table))if(n.command===Af.UPSERT||n.command===Af.DELETE){let e=this._getValueByKey(n,"record_uuid");e||(e=this._readService.getRecords().map((e=>e.uuid))),Array.isArray(e)||(e=[e]);for(const i of e){if(null!=t&&t.includes(i))continue;const e=this._getValueByKey(n,"field_uuid");r.push({fieldId:e,recordId:i})}}else n.command===Af.BULK_INSERT&&n.sets.forEach((e=>{null!=t&&t.includes(e.record_uuid)||r.push({fieldId:e.field_uuid,recordId:e.record_uuid})}));r.length>0&&this._syncHelper.updateCell(_Ne(r,(e=>e.fieldId+":"+e.recordId)))}addRecord(e){let t=[];for(const r of e)"record"===r.table&&(r.command===Af.INSERT||r.command===Af.INSERT_AFTER||r.command===Af.INSERT_BEFORE?t.push(r.sets.uuid):r.command===Af.BULK_INSERT&&(t=t.concat(r.sets.map((e=>e.uuid)))));t.length>0&&this._syncHelper.addRecord(t)}removeRecord(e){let t=[];for(const r of e)if("record"===r.table&&r.command===Af.DELETE){const e=this._getValueByKey(r,"uuid");t=t.concat(e||[])}return t.length>0&&this._syncHelper.removeRecord(t),t}addField(e){for(const t of e)"field"===t.table&&(t.command===Af.INSERT||t.command===Af.INSERT_AFTER||t.command===Af.INSERT_BEFORE)&&this._syncHelper.addField(t.sets)}updateField(e){const t={};for(const r of e)if("field"===r.table&&(r.command===Af.DELETE||r.command===Af.INSERT||r.command===Af.INSERT_AFTER||r.command===Af.INSERT_BEFORE)){t[this._getValueByKey(r,"uuid")]=!0}const r={};for(const n of e){let e;"field"===n.table&&n.command===Af.UPDATE?e=this._getValueByKey(n,"uuid"):("field_option"===n.table||"ai_writing"===n.table)&&(e=this._getValueByKey(n,"field_uuid")),!t[e]&&e&&(r[e]||(r[e]=n),r[e].sets.type||(r[e]=n))}const n=Object.keys(r);for(const e of n)r[e].sets.type?this._syncHelper.updateField(e,!0):this._syncHelper.updateField(e)}async removeField(e){for(const t of e)if("field"===t.table&&t.command===Af.DELETE){const e=this._getValueByKey(t,"uuid");this._syncHelper.removeField(e)}}async addView(e){for(const t of e)"view"===t.table&&(t.command===Af.INSERT||t.command===Af.INSERT_AFTER||t.command===Af.INSERT_BEFORE)&&this._syncHelper.addView(t.sets.uuid)}async updateContent(e){for(const t of e)if("content"===t.table&&t.command===Af.UPSERT){const e=t.where.target_uuid;if("record"!==t.where.target_type)continue;this._syncHelper.updateContent(e,{format:t.sets.format,html:t.sets.html,source:t.sets.source})}}async updateView(e){const t={},r={};for(const n of e){if("view"===n.table&&(n.command===Af.DELETE||n.command===Af.INSERT||n.command===Af.INSERT_AFTER||n.command===Af.INSERT_BEFORE)){const e=this._getValueByKey(n,"uuid");r[e]=!0,delete t[e]}if("view"===n.table&&n.command===Af.UPDATE){const e=this._getValueByKey(n,"uuid");if(r[e])continue;t[e]=!0}else if(["view_config","view_field","view_record","sort","group","filter","stat"].includes(n.table)){const e=this._getValueByKey(n,"view_uuid");if(r[e])continue;t[e]=!0}if("view"===n.table&&(n.command===Af.MOVE_AFTER||n.command===Af.MOVE_BEFORE)){const e=n.sets.uuid,t=this._readService.getViews(),r=t.findIndex((t=>t.uuid===e));let i;return r>0&&(i=t[r-1].uuid),void await this._syncHelper.updateViewOrder(e,i)}}const n=Object.keys(t);for(const e of n)await this._syncHelper.updateView(e)}async removeView(e){for(const t of e)if("view"===t.table&&t.command===Af.DELETE){const e=this._getValueByKey(t,"uuid");this._syncHelper.removeView(e)}}async updateForm(e){for(const t of e)if("view_share"===t.table&&t.command===Af.UPSERT){if(t.sets.status===Dh.ACTIVE)return;this._syncHelper.updateForm(t.sets.view_uuid,t.sets.status)}}_getValueByKey(e,t,r){var n;let i;return e.command===Af.INSERT||e.command===Af.INSERT_AFTER||e.command===Af.INSERT_BEFORE||e.command===Af.UPSERT?(i=e.sets[t],r&&(i=e.sets.uuid)):e.command===Af.BULK_INSERT?i=e.sets[0][t]:(e.command===Af.DELETE||e.command===Af.UPDATE||e.command===Af.MOVE_AFTER||e.command===Af.MOVE_BEFORE)&&(i=null==(n=e.where)?void 0:n[t],i||(i=e.sets[t])),i}};WNe([to(Rf)],KNe.prototype,"_modelEvent",2),WNe([to(Dy)],KNe.prototype,"_readService",2),WNe([to(zNe)],KNe.prototype,"_syncHelper",2),WNe([to(s_)],KNe.prototype,"_kernelService",2),WNe([to(Hw)],KNe.prototype,"_abilityService",2),WNe([to(MNe)],KNe.prototype,"_syncQueue",2),KNe=WNe([eo()],KNe);var qNe=Object.defineProperty,YNe=Object.getOwnPropertyDescriptor;let XNe=class{constructor(){this._onSyncChange=new op,this.onSyncChange=this._onSyncChange.event}init(){this._queueTask=new fb({name:"服务端接口同步任务队列",parallel:1}),this._queueTask.onDidStatusChange((e=>{e.status===ub.PENDING?this._onSyncChange.emit({status:PNe.RUNNING}):e.status===ub.WAITING&&this._onSyncChange.emit({status:PNe.SUCCESS})})),this.timerId=setInterval((()=>{var e;null==(e=this._queueTask)||e.resume()}),1e3)}destroy(){var e;null==(e=this._queueTask)||e.destroy(),this._queueTask=null,clearInterval(this.timerId),this.timerId=null}addJob(e){var t;null==(t=this._queueTask)||t.addJob((async t=>{try{await e()}catch(e){return console.error(e),t.onError(e)}t.onSuccess()}))}};XNe=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?YNe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&qNe(t,r,o),o})([eo({token:MNe})],XNe);var ZNe=Object.defineProperty,JNe=Object.getOwnPropertyDescriptor,QNe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?JNe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ZNe(t,r,o),o};let eMe=class{static pluginModule(){return bo().contribution(NNe).register(VNe).register(zNe).register(KNe).register(XNe).register(this)}init(){!this._serverRegistry.hasProvider()||this._syncServer.init()}destroy(){this._syncServer.destroy()}};eMe.pluginName="kernel-server",QNe([to(KNe)],eMe.prototype,"_syncServer",2),QNe([to(VNe)],eMe.prototype,"_serverRegistry",2),eMe=QNe([eo({contrib:Tw})],eMe);class tMe extends xw{updateAiWritingOpen(e,t){this.modelService.getModel("ai_writing").upsert({field_uuid:e},{field_uuid:e,open:t,type:CNe.SUMMARY,prompt:"",auto:!1})}updateAiWritingType(e,t){const r=this.modelService.getModel("ai_writing"),n={field_uuid:e,type:t};t!==CNe.SUMMARY&&(n.prompt=""),r.upsert({field_uuid:e},n)}updateAiWritingPrompt(e,t){this.modelService.getModel("ai_writing").upsert({field_uuid:e},{field_uuid:e,prompt:t})}updateAiWritingAuto(e,t){this.modelService.getModel("ai_writing").upsert({field_uuid:e},{field_uuid:e,auto:t})}}class rMe extends Ib{constructor(){super(...arguments),this.jobType=jb.User,this.customJob=tMe}destroy(){}async execute(e){return await this.context.job.updateAiWritingOpen(e.fieldId,e.open),!0}}rMe.commandName="updateAiWritingOpen";class nMe extends Ib{constructor(){super(...arguments),this.jobType=jb.User,this.customJob=tMe}destroy(){}async execute(e){return await this.context.job.updateAiWritingType(e.fieldId,e.type),!0}}nMe.commandName="updateAiWritingType";class iMe extends Ib{constructor(){super(...arguments),this.jobType=jb.User,this.customJob=tMe}destroy(){}async execute(e){return await this.context.job.updateAiWritingPrompt(e.fieldId,e.prompt),!0}}iMe.commandName="updateAiWritingPrompt";class oMe extends Ib{constructor(){super(...arguments),this.jobType=jb.User,this.customJob=tMe}destroy(){}async execute(e){return await this.context.job.updateAiWritingAuto(e.fieldId,e.auto),!0}}oMe.commandName="updateAiWritingAuto";class aMe extends Ib{constructor(e,t,r){super(e,t,r),this.kernel=e,this.plugin=t,this.jobType=jb.User,this.customJob=tMe,this.aiWritingDatasource=null,this.aiWritingService=null,this.aiWritingTaskService=null,this.commandService=null,this._queueTask=null,this.aiWritingDatasource=t.aiWritingDatasource,this.aiWritingService=t.aiWritingService,this.aiWritingTaskService=t.aiWritingTaskService,this.commandService=t.commandService,this._queueTask=t.queueTask}destroy(){}generatePrompt(e,t,r){let n="",i="";for(const[e,n]of t.entries())i+=`${r.get(n.fieldId)||""}是${n.formatValue||""}`,e<t.length-1&&(i+="，");switch(e.type){case CNe.SUMMARY:n=`帮我给以下内容生成摘要，尽可能简洁：${i}`;break;case CNe.EXTRACT:n=`帮我总结出以下内容里的${e.prompt}：${i}`;break;case CNe.CUSTOM:n=`帮我给以下内容${e.prompt}：${i}`}return n}async getAiWritingData(e,t,r,n){var i;try{const o=this.generatePrompt(e,n.filter((e=>e.fieldId!==t)),r),a=await(null==(i=this.aiWritingDatasource)?void 0:i.handlePost({content:o,type:"custom"}));return(null==a?void 0:a.data.result)||""}catch(e){return console.error(e),""}}async autofillCell(e,t,r,n,i=!0){var o;const a=this.readService.getRecordCells(r),s=a.find((e=>e.fieldId===t)),l=await this.getAiWritingData(e,t,n,a);if(!l||!s)return;const c={...s,value:l};if(!i)return null==(o=this.commandService)?void 0:o.execCommand("setCell",c);this.context.job.setCell(c)}async execute({fieldId:e,recordId:t}){var r,n,i;if(!e)return!1;const o=this.readService.getField(e),a=null==(r=this.aiWritingService)?void 0:r.getAiWritingConfig(e);if((null==o?void 0:o.type)!==Rh.TEXT||null==a||!a.open)return!1;const s=this.readService.getAllFields(),l=new Map;if(null==s||s.forEach((e=>{l.set(e.uuid,e.name)})),t)await this.autofillCell(a,e,t,l,!0);else{const t=this.readService.getRecords();null==(n=this.aiWritingTaskService)||n.emitStartAiWritingTask(e),null==(i=this._queueTask)||i.destroy(),t.forEach((t=>{var r;const n=`${e}-${t.uuid}`;null==(r=this._queueTask)||r.addJob(n,(async r=>{var i;try{await this.autofillCell(a,e,t.uuid,l,!1)}catch(e){return console.error(e),r.onError(e)}r.onSuccess(),null==(i=this._queueTask)||i.removeSuccessJob(n)}))}))}return!0}}aMe.commandName="startAiWriting";class sMe extends Ib{constructor(e,t,r){super(e,t,r),this.kernel=e,this.plugin=t,this.jobType=jb.User,this.customJob=tMe,this.aiWritingTaskService=null,this._queueTask=null,this.aiWritingTaskService=t.aiWritingTaskService,this._queueTask=t.queueTask}destroy(){}async execute({fieldId:e}){var t,r;return!!e&&(null==(t=this._queueTask)||t.destroy(),null==(r=this.aiWritingTaskService)||r.emitStopAiWritingTask(e),!0)}}sMe.commandName="stopAiWriting";var lMe=Object.defineProperty,cMe=Object.getOwnPropertyDescriptor,uMe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?cMe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&lMe(t,r,o),o};class dMe extends qp{}dMe.table="ai_writing",dMe.indexes=["field_uuid"],uMe([Kp()],dMe.prototype,"field_uuid",2),uMe([Kp()],dMe.prototype,"open",2),uMe([Kp()],dMe.prototype,"type",2),uMe([Kp()],dMe.prototype,"prompt",2),uMe([Kp()],dMe.prototype,"auto",2);var fMe=Object.defineProperty,pMe=Object.getOwnPropertyDescriptor,hMe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?pMe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&fMe(t,r,o),o};let mMe=class{init(){var e;const t=this.aiWritingDatasourceProvider.getContributions();for(const r of t){const t=null==(e=r.registerAiWritingDatasourcePost)?void 0:e.call(r);t&&(this._datasourcePost=t)}}get Post(){return this._datasourcePost}};hMe([Eo(SNe),Mx()],mMe.prototype,"aiWritingDatasourceProvider",2),mMe=hMe([eo()],mMe);var vMe=Object.defineProperty,gMe=Object.getOwnPropertyDescriptor,yMe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?gMe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&vMe(t,r,o),o};let bMe=class{handlePost(e){return this._aiWritingDatasourceRegistry.Post(e)}};yMe([to(mMe)],bMe.prototype,"_aiWritingDatasourceRegistry",2),bMe=yMe([eo({token:kNe})],bMe);var wMe=Object.defineProperty,_Me=Object.getOwnPropertyDescriptor;let CMe=class{constructor(){this._onAiWritingStatusChange=new op,this.onAiWritingStatusChange=this._onAiWritingStatusChange.event,this.queueTask=null,this.taskListener=null,this.isGenerating=!1,this.generateFieldId=null}init(e){this.queueTask=e,this.bindEvent()}destroy(){var e;null==(e=this.taskListener)||e.destroy()}bindEvent(){this.queueTask&&(this.taskListener=this.queueTask.onDidStatusChange((({status:e})=>{var t,r;e===ub.WAITING&&(null==(t=this.queueTask)||!t.hasPenddingJob())&&(null==(r=this.queueTask)||!r.hasRuningJob())&&(this.isGenerating=!1,this._onAiWritingStatusChange.emit({isGenerating:this.isGenerating,fieldId:this.generateFieldId,type:"auto"}),this.generateFieldId=null,v.a.success(kf("已重新填写")))})))}emitStartAiWritingTask(e){this.isGenerating=!0,this.generateFieldId=e,this._onAiWritingStatusChange.emit({isGenerating:this.isGenerating,fieldId:this.generateFieldId,type:"manual"})}emitStopAiWritingTask(e){this.isGenerating=!1,this.generateFieldId=null,this._onAiWritingStatusChange.emit({isGenerating:this.isGenerating,fieldId:e,type:"manual"})}isFieldGenerating(e){return this.isGenerating&&e===this.generateFieldId}};CMe=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?_Me(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&wMe(t,r,o),o})([eo({token:xNe})],CMe);var EMe=Object.defineProperty,xMe=Object.getOwnPropertyDescriptor,SMe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?xMe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&EMe(t,r,o),o};let kMe=class{constructor(){this.queueTask=null,this._listener=null}static pluginModule(){return bo().contribution(SNe).register(mMe).register(bMe).register(TNe).register(CMe).register(this)}static registerConfiguration(e){e.registerConfiguration({id:"aiWriting",type:"object",properties:{disable:{type:"boolean"}}}),e.registerDefaultValue({"aiWriting.disable":!0})}get isAiWritingEnable(){return!!this._configurationService.getValue("aiWriting.enable")}init(){this.commandService.registerCommand(rMe.commandName,rMe),this.commandService.registerCommand(nMe.commandName,nMe),this.commandService.registerCommand(iMe.commandName,iMe),this.commandService.registerCommand(oMe.commandName,oMe),this.commandService.registerCommand(aMe.commandName,aMe,this),this.commandService.registerCommand(sMe.commandName,sMe,this),this.aiWritingDatasourceRegistry.init(),this.queueTask=new fb({name:"智能填写任务队列",parallel:3}),this.aiWritingTaskService.init(this.queueTask),this.isAiWritingEnable&&(this._listener=this.commandService.onDidExecuteCommand((async({context:e})=>{if("updateField"===e.commandName){const t=e.argArray[0],{field:r,newFieldProperty:n}=t,i=r.uuid;n.type!==Rh.TEXT&&await this.commandService.execCommand("updateAiWritingOpen",{fieldId:i,open:!1})}})))}destroy(){var e,t;this.aiWritingTaskService.destroy(),null==(e=this._listener)||e.destroy(),null==(t=this.queueTask)||t.destroy(),this.queueTask=null}registerModel(){return dMe}registerProcessTableMiddleware(){return(e,t)=>{const r=e.sheet.columns;if(r&&r.length>0){const e=r.map((e=>({uuid:Io(32),field_uuid:e.uuid||e.id,open:e.enableAI||!1,type:e.aiWritingType||CNe.SUMMARY,prompt:e.aiPrompt||"",auto:e.enableAutoAIGC||!1})));t.setData("ai_writing",e)}return e}}};kMe.pluginName="kernel-ai-writing",SMe([to(Pb)],kMe.prototype,"commandService",2),SMe([to(mMe)],kMe.prototype,"aiWritingDatasourceRegistry",2),SMe([to(kNe)],kMe.prototype,"aiWritingDatasource",2),SMe([to(TNe)],kMe.prototype,"aiWritingService",2),SMe([to(CMe)],kMe.prototype,"aiWritingTaskService",2),SMe([to(qf)],kMe.prototype,"_configurationService",2),kMe=SMe([eo({contrib:[Tw,xp,Ex]})],kMe);class OMe{constructor(e){this._detail={...e}}destroy(){}get detail(){return{...this._detail}}async redo(e){const{recordId:t,content:r}=this._detail;await e.updateContent(t,r)}async undo(e){const{recordId:t,oldContent:r}=this._detail;await e.updateContent(t,r)}}class IMe extends xw{updateContent(e,t){const r=this.modelService.getModel("content"),n=r.findOne({target_uuid:e,target_type:"record"});r.upsert({target_uuid:e,target_type:"record"},{format:t.format,html:t.html,source:t.source,target_uuid:e,target_type:"record"}),this.transaction.addOperation(new OMe({recordId:e,content:t,oldContent:n}))}}class RMe extends Ib{constructor(){super(...arguments),this.jobType=jb.User,this.customJob=IMe}destroy(){}async execute(e){return await this.context.job.updateContent(e.recordId,e.content),!0}}RMe.commandName="updateContent";var TMe=Object.defineProperty,AMe=Object.getOwnPropertyDescriptor,NMe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?AMe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&TMe(t,r,o),o};class MMe extends qp{}MMe.table="content",MMe.indexes=["target_type","target_uuid"],NMe([Kp()],MMe.prototype,"target_uuid",2),NMe([Kp()],MMe.prototype,"target_type",2),NMe([Kp()],MMe.prototype,"format",2),NMe([Kp()],MMe.prototype,"html",2),NMe([Kp()],MMe.prototype,"source",2);var PMe=Object.defineProperty,jMe=Object.getOwnPropertyDescriptor,DMe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?jMe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&PMe(t,r,o),o};let FMe=class{init(){var e,t;const r=this.contentDatasourceProvider.getContributions();for(const n of r){const r=null==(e=n.registerContentDatasourceGet)?void 0:e.call(n);r&&(this._datasourceGet=r);const i=null==(t=n.registerContentDatasourcePut)?void 0:t.call(n);i&&(this._datasourcePut=i)}}get Get(){return this._datasourceGet}get Put(){return this._datasourcePut}};DMe([Eo(Pxe),Mx()],FMe.prototype,"contentDatasourceProvider",2),FMe=DMe([eo()],FMe);var VMe=Object.defineProperty,LMe=Object.getOwnPropertyDescriptor,$Me=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?LMe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&VMe(t,r,o),o};let BMe=class{getContent(e,t){return this._modelService.getModel("content").findOne({target_uuid:e,target_type:t})}setContentWithSlient(e,t,r){this._modelService.getModel("content").upsert({target_uuid:e,target_type:t},{format:r.format,html:r.html,source:r.source,target_uuid:e,target_type:t},{slient:!0})}};$Me([to(Wp)],BMe.prototype,"_modelService",2),BMe=$Me([eo({token:Dxe})],BMe);var zMe=Object.defineProperty,UMe=Object.getOwnPropertyDescriptor,HMe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?UMe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&zMe(t,r,o),o};let WMe=class{handleGet(e,t){return this._contentDatasourceRegistry.Get(e,t)}handlePut(e,t,r){return this._contentDatasourceRegistry.Put(e,t,r)}};HMe([to(FMe)],WMe.prototype,"_contentDatasourceRegistry",2),WMe=HMe([eo({token:jxe})],WMe);var GMe=Object.defineProperty,KMe=Object.getOwnPropertyDescriptor,qMe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?KMe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&GMe(t,r,o),o};let YMe=class{static pluginModule(){return bo().contribution(Pxe).register(FMe).register(WMe).register(BMe).register(this)}init(){this.commandService.registerCommand(RMe.commandName,RMe),this.contentDatasourceRegistry.init()}registerModel(){return MMe}registerProcessTableMiddleware(){return e=>{const t=e.records;if(t)for(const e of t)!e.content||this.contentService.setContentWithSlient(e.uuid,"record",e.content);return e}}};YMe.pluginName="kernel-content",qMe([to(Pb)],YMe.prototype,"commandService",2),qMe([to(FMe)],YMe.prototype,"contentDatasourceRegistry",2),qMe([to(BMe)],YMe.prototype,"contentService",2),YMe=qMe([eo({contrib:[Tw,xp,Ex]})],YMe);const XMe=[rRe,hSe,VSe,eMe,kMe,YMe],ZMe=({docId:e,docType:t,webSdk:r})=>({token:Pxe,useValue:{registerContentDatasourceGet:()=>async(n,i)=>{var o,a;const s={docId:e,docType:t,sheetId:i,recordId:n};let l=(await(null==(a=(o=r.TableRecordController).getContent)?void 0:a.call(o,s))).content;return l||(l={format:"lake",html:"",source:""}),l},registerContentDatasourcePut:()=>async(n,i,o)=>{const a={docId:e,docType:t,sheetId:i,recordId:n,content:o};await r.TableRecordController.putContent(a)}}});function JMe(e,t){if(void 0===e||!t)return"";let r=""+e,n="";const i=r.indexOf(".")>=0;if("-"===r[0]&&(r=r.substr(1),n="-"),r.length>=t)return n+r;let o=t-r.length;for(;o--;)r=i?r+"0":"0"+r;return n+r}const QMe="1899-12-30",ePe="YYYY-MM-DD";qt.a.extend(Xt.a),function(e){qt.a.utc(e)}(QMe);const tPe=[/^([1-9]\d{3,4})(.{1})(0?[1-9]|1[0-2])(.{1})(0?[1-9]|[1-2][0-9]|3[0-1])(日?)$/,/^(0?[1-9]|1[0-2])(.{1})(0?[1-9]|[1-2][0-9]|3[0-1])(.{1})([1-9]\d{3,4})$/],rPe=/^(20|21|22|23|[0-1]\d):[0-5]\d$/,nPe=/^(20|21|22|23|[0-1]\d):[0-5]\d:[0-5]\d$/,iPe=/^([A-Za-z]{3,8})\s(0?[1-9]|[1-2][0-9]|3[0-1]),(([1-9]\d{3,4}))$/,oPe={zh:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],zhNum:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],en:["January","February","March","April","May","June","July","August","September","October","November","December"],enShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"]},aPe={mmdd:/^(0?[1-9]|1[0-2])(\-|\/|月)(0?[1-9]|[1-2][0-9]|3[0-1])(日?)$/,ddmm:/^(0?[1-9]|[1-2][0-9]|3[0-1])(\-|\/)(0?[1-9]|1[0-2])$/,yymm:/^(\d{2})(\-|\/)(0?[1-9]|1[0-2])$/,yymmdd:/^(\d{2})(\-|\/)(0?[1-9]|1[0-2])(\-|\/)(0?[1-9]|[1-2][0-9]|3[0-1])$/,yyyymm:/^([1-9]\d{3,4})(\-|\/|年)(0?[1-9]|1[0-2])(月?)$/};function sPe(e){const t=function(e){let t,r,n,i="";if(function(e){return nPe.test(e)||rPe.test(e)}(e))return function(e){return qt()(`${QMe} ${e}`).diff(qt.a.utc(QMe),"seconds")}(e);let o=e.match(/ (20|21|22|23|[0-1]\d):[0-5]\d(:([0-5]\d))?$/);return o&&(i=o[0],e=e.slice(0,-i.length)),o=e.match(tPe[0]),o?(t=o[1],r=o[3],n=o[5]):(o=e.match(tPe[1]),o?(t=o[5],r=o[1],n=o[3]):(o=e.match(iPe),o&&(t=o[3],r=oPe.en.indexOf(o[1])+1,r=0===r?NaN:r,n=o[2]))),isNaN(t)||isNaN(r)||isNaN(n)?(e+=i,function(e){if(!e)return!1;let t,r,n,i="sheet-en";for(const n in aPe){const i=e.match(aPe[n]);if(i){t=n,r=i[2];break}}if(!t||["年","月","-","/"].indexOf(r)<0)return!1;switch(t){case"mmdd":"月"===r?(i="sheet-cn",n="M月D日"):n="MM/DD";break;case"ddmm":n="MM/DD";break;case"yymm":n="YYYY-MM";break;case"yymmdd":n=`YYYY${r}MM${r}DD`;break;case"yyyymm":"年"===r?(n="YYYY年M月",i="sheet-cn"):n="YYYY-MM"}return{name:"date",formatter:n,lang:i}}(e)?function(e){const t=qt()(),r=1*+t.format("YY"),n=t.format("YYYY");for(const t in aPe){const i=e.match(aPe[t]);if(i){let o="";switch(t){case"yymm":o=(1*i[1]>r?"19":"20")+JMe(i[1],2)+"-"+JMe(i[3],2)+"-01";break;case"yyyymm":o=i[1]+"-"+JMe(i[3],2)+"-01";break;case"mmdd":o=n+"-"+JMe(i[1],2)+"-"+JMe(i[3],2);break;case"ddmm":o=n+"-"+JMe(i[3],2)+"-"+JMe(i[1],2);break;case"yymmdd":o=(1*i[1]>r?"19":"20")+i[1]+"-"+JMe(i[3],2)+"-"+JMe(i[5],2);break;default:o=e}return qt.a.utc(o).diff(qt.a.utc(QMe),"seconds")}}return 0}(e):e):dPe(`${t}-${JMe(r,2)}-${JMe(n,2)}${i}`)}(e);return isNaN(t)?"":{seconds:t,text:lPe({seconds:t})}}function lPe(e){const t=qt.a.utc(QMe).add(e.seconds,"seconds");return"Invalid date"!==t.toString()?(e.text=t.format(ePe),e.text):(e.text="","")}function cPe(e){const t=qt()(e.time);return"Invalid date"!==t.toString()?(e.text=t.format("YYYY-MM-DD HH:mm:ss"),e.text):(e.text="","")}function uPe(e){if(e>=31708800){e+=qt()("1901-01-01").diff("1900-12-31 23:59:59","seconds")-1}return qt()(QMe).add(e,"seconds").format("YYYY-MM-DDTHH:mm:ssZ")}function dPe(e){return qt.a.utc(e).diff(qt.a.utc(QMe),"seconds")}class fPe{toFieldModel(e,t){const r=e.type,n=e.options;return"textarea"===r||"input"===r||"text"===r?this.toTextareaModel(t):"checkbox"===r?this.toCheckboxModel(t):"date"===r?this.toDate(t):"email"===r?this.toEmailModel(t):"file"===r?this.toFileModel(t):"image"===r?this.toImageModel(t):"link"===r||"link"===r?this.toLinkModel(t):"mention"===r?this.toMentionModel(t):"select"===r?this.toSelectModel(t,n):"multiSelect"===r?this.toMultiSelectModel(t,n):"number"===r?this.toNumberModel(t):"phone"===r?this.toPhoneModel(t):t}toTextareaModel(e){return e&&"boolean"!=typeof e?Array.isArray(e)?e.map((e=>e?e.name?e.name:e:"")).join(","):e.seconds?lPe(e):e.time?cPe(e):e.name?e.name:e+"":""}toCheckboxModel(e){return!(!e||!["1","true","是","yes","✅"].includes(String(e).toLowerCase()))}toDate(e){if(!e||"boolean"==typeof e)return"";if(Array.isArray(e)&&(e=e[0]),void 0!==e.time||void 0!==e.seconds){const t={seconds:e.seconds||dPe(e.time),time:e.time||uPe(e.seconds)};return t.text=lPe(t),"Invalid Date"===t.text?"":t}return!isNaN(e)||"string"==typeof e&&-1!==e.indexOf("\n")?"":(e.name&&(e=e.name),sPe(e))}toEmailModel(e){return!e||"boolean"==typeof e||Array.isArray(e)&&!(e=e[0])||(e.name&&(e=e.name),"string"!=typeof e)?"":e=e.replace(/\n/g,"")}toFileModel(e){if(!e)return[];Array.isArray(e)||(e=[e]);return e.map((e=>(e=>"error"===e.status||"progress"===e.status?e:void 0!==e.src&&e.uid&&(e.fileKey=Gt.FileUtils.getFileKey(e.src),e.fileKey)?(e.name||(e.name=e.src),e.src=Fd(e.src),e):"")(e)))}toImageModel(e){if(!e)return[];Array.isArray(e)||(e=[e]);const t=e=>e?(e.login&&(e.src=e.avatar_url),"error"===e.status||"progress"===e.status?e:void 0!==e.src&&(e=>{try{const t=new URL(e);return Gt.FileUtils.isImage(t.origin+t.pathname)}catch{return!1}})(e.src)?(e.name||(e.name=e.src),e.src=Fd(e.src),e):""):"";return e.map((e=>t(e)))}toLinkModel(e){if(!e||e.seconds||e.time||"boolean"==typeof e)return"";if(e.src)return e.src=String(Fd(e.src)),e.name=String(e.name)||"",e;if(Array.isArray(e)&&!(e=e[0]))return"";if(e.login)return{name:e.name,src:`/${e.login}`};e.name&&(e=e.name);let t=Fd(e=(e=String(e)).replace(/\n/gi,""));return Id(e)&&(t="mailto:"+e),t?{src:t,name:e}:{name:e,src:"http://"+e}}toMentionModel(e){var t,r;return Array.isArray(e)&&0!==e.length&&null!=(t=e[0])&&t.login&&null!=(r=e[0])&&r.name?e.map((e=>(e.work_id&&!e.avatar_url&&(e.avatar_url=`/__workers/r/avatar_buc/${e.work_id}`),e))):""}toSelectModel(e,t){if(!e)return"";let r=e;if(Array.isArray(e))r=e[0];else if(void 0!==e.seconds)r=e.text||lPe(e);else if(void 0!==e.time)r=e.text||cPe(e);else{if(e&&"boolean"==typeof e)return"";isNaN(e)||(r=e+"")}if(!r)return"";r.name&&(r=r.name);const n=t.find((e=>e.uuid===r||e.name===r));return n?[n.uuid]:null}toMultiSelectModel(e,t){if(!e)return"";let r=e;if(Array.isArray(e)){const r=[];return e.forEach((e=>{if(!e)return;e=e.name||e;const n=null==t?void 0:t.find((t=>t.uuid===e||t.name===e));n&&r.push(n.uuid)})),0!==r.length?r:""}if(void 0!==e.seconds)r=e.text||lPe(e);else if(void 0!==e.time)r=e.text||cPe(e);else{if("boolean"==typeof e)return"";isNaN(e)||(r=e+"")}e.name&&(r=e.name);const n=t.find((e=>e.uuid===r||e.name===r));return n?[n.uuid]:null}toNumberModel(e){return e?"boolean"==typeof e?Vd(e?"1":"0"):Array.isArray(e)&&!(e=e[0])?"":(e.name&&(e=e.name),Vd(e)):""}toPhoneModel(e){return!e||"boolean"==typeof e||Array.isArray(e)&&!(e=e[0])||(e.name&&(e=e.name),"string"!=typeof e&&"number"!=typeof e)?"":e=(e=String(e)).replace(/\n/g,"")}}const pPe={token:Ex,useValue:{registerProcess(){const e=new fPe;return{processFieldModel:(t,r)=>e.toFieldModel(t,r)}}}},hPe=({docId:e,docType:t,webSdk:r,webProxy:n})=>({token:NNe,useValue:{registerServer:()=>(r.TableShareController={update:async e=>await n.shares.update(e)},{apiSdk:r,processParams:r=>(r.docId=e,r.docType=t,r)})}}),mPe=({docId:e,docType:t,webProxy:r,currentUser:n})=>({token:yb,useValue:{registerUser:()=>({searchUser:async e=>(await r.users.complete({q:e})).map((e=>({uid:String(e.id||e.uid),name:e.name,login:e.login,icon:e.avatar||e.avatar_url||e.icon,work_id:e.work_id}))),async contextUsers(){if("Doc"!==t)return[];let n=await r.users.listDocContextUsers({id:e})||[];const i=this.getCurrentUser();return i&&n.push(i),n=Jt()(n.map((e=>({uid:String(e.id||e.uid),name:e.membership?e.membership.name:e.name,login:e.login,icon:e.membership&&e.membership.avatar||e.avatar_url||e.icon,work_id:e.work_id}))),"uid"),n},getCurrentUser:()=>n||(nSe.me?{uid:String(nSe.me.id),work_id:nSe.me.work_id,login:nSe.me.login,name:nSe.me.name,icon:nSe.me.avatar_url}:null)})}});const vPe=({docId:e,webSdk:t})=>({token:SNe,useValue:{registerAiWritingDatasourcePost:()=>async({content:r,type:n})=>await async function(e,t,r={}){return e.post("/api/ai/table/completion",t,r)}(t.req,{content:r,type:n,context_id:e})}}),gPe=({docId:e,docType:t,webProxy:r})=>({token:xSe,useValue:{registerForm:()=>({async getForm(e){if("Doclet"===t)return;const n=await r.shares.findOne({target_id:e,target_type:"Skythings.View",type:"form"});return n&&n.token?{src:`/forms/share/${n.token}`,status:n.status}:void 0}})}}),yPe=({docId:e,docType:t,webSdk:r,webProxy:n,currentUser:i})=>[pPe,hPe({docId:e,docType:t,webSdk:r,webProxy:n}),mPe({docId:e,docType:t,webProxy:n,currentUser:i}),gPe({docId:e,docType:t,webProxy:n}),ZMe({docId:e,docType:t,webSdk:r}),vPe({docId:e,webSdk:r})],bPe="ctoken",wPe="yuque_ctoken",_Pe=Array.isArray;function CPe(e,t,r,n){let i,o,a;const s=/\[\]$/;if(_Pe(t))for(o=0;t&&o<t.length;o++)a=t[o],r||s.test(e)?n(e,a):CPe(e+"["+("object"==typeof a?o:"")+"]",a,r,n);else if(t&&"[object Object]"===t.toString())for(i in t)t.hasOwnProperty(i)&&CPe(e+"["+i+"]",t[i],r,n);else n(e,t)}function EPe(e,t){return e+(/\?/.test(e)?"&":"?")+t}function xPe(e,t){let r,n;const i=t||!1,o=[],a=encodeURIComponent;function s(e,t){let r=t;"function"==typeof t?r=t():null==t&&(r=""),o[o.length]=a(e)+"="+a(r)}if(_Pe(e))for(n=0;e&&n<e.length;n++)s(e[n].name,e[n].value);else for(r in e)e.hasOwnProperty(r)&&CPe(r,e[r],i,s);return o.join("&").replace(/%20/g,"+")}function SPe(e){return typeof FormData<"u"&&e instanceof FormData}const kPe=window,OPe=document,{head:IPe}=document,RPe=/^http/,TPe=/(^\w+):\/\//,APe=/^20\d$/,NPe="readyState",MPe="Content-Type",PPe="X-Requested-With",jPe="reqwest_"+ +new Date;let DPe,FPe=0;function VPe(){}const LPe={traditional:!1,contentType:"application/x-www-form-urlencoded",requestedWith:"XMLHttpRequest",accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"},dataFilter:e=>e};function $Pe(e,t,r){return()=>e._aborted?r("Request is aborted",e.request):e._timedOut?r("Request is aborted: timeout",e.request):void(e.request&&4===e.request[NPe]&&(e.request.onreadystatechange=VPe,function(e){const t=TPe.exec(e.url);let r="";return t&&(r=t[1]),r||(r=(e.o.context||kPe).location.protocol),RPe.test(r)?APe.test(e.request.status):!!e.request.response}(e)?t(e.request):r(e.request.statusText,e.request)))}function BPe(e){DPe=e}function zPe(e,t,r,n){let i=n;const o=FPe++,a=e.jsonpCallback||"callback";let s=e.jsonpCallbackName||function(e){return jPe+"_"+e}(o);const l=new RegExp("((^|\\?|&)"+a+")=([^&]+)"),c=i.match(l),u=OPe.createElement("script");let d=0;return c?"?"===c[3]?i=i.replace(l,"$1="+s):s=c[3]:i=EPe(i,a+"="+s),kPe[s]=BPe,u.type="text/javascript",u.src=i,u.async=!0,u.onload=u.onreadystatechange=()=>{if(u[NPe]&&"complete"!==u[NPe]&&"loaded"!==u[NPe]||d)return!1;u.onload=u.onreadystatechange=null,u.onclick&&u.onclick(),t(DPe),DPe=void 0,IPe.removeChild(u),d=1},IPe.appendChild(u),{abort(){u.onload=u.onreadystatechange=null,r("Request is aborted: timeout"),DPe=void 0,IPe.removeChild(u),d=1}}}function UPe(e,t){const r=this.o,n=(r.method||"GET").toUpperCase();let i="string"==typeof r?r:r.url,o=!1!==r.processData&&r.data&&"string"!=typeof r.data&&!SPe(r.data)?xPe(r.data,r.traditional||LPe.traditional):r.data||null;if(("jsonp"===r.type||"GET"===n)&&o&&(i=EPe(i,o),o=null),"jsonp"===r.type)return zPe(r,e,t,i);const a=r.xhr&&r.xhr(r)||function(e){const t=new XMLHttpRequest;if(!0===e.crossOrigin&&!("withCredentials"in t))throw new Error("Browser does not support cross-origin requests");return t}(r);return a.open(n,i,!1!==r.async),function(e,t){const r=t.headers||{};let n;for(n in r.Accept=r.Accept||LPe.accept[t.type]||LPe.accept["*"],!t.crossOrigin&&!r[PPe]&&(r[PPe]=LPe.requestedWith),!r[MPe]&&!SPe(t.data)&&(r[MPe]=t.contentType||LPe.contentType),r)r.hasOwnProperty(n)&&"setRequestHeader"in e&&e.setRequestHeader(n,r[n])}(a,r),function(e,t){typeof t.withCredentials<"u"&&typeof e.withCredentials<"u"&&(e.withCredentials=!!t.withCredentials)}(a,r),a.onreadystatechange=$Pe(this,e,t),r.before&&r.before(a),a.send(o),a}function HPe(){this.initPromise()}function WPe(){return new HPe}function GPe(e){const t=this;this.url="string"==typeof e?e:e.url,this.timeout&&clearTimeout(this.timeout),this.timeout=null,e.timeout&&(this.timeout=setTimeout((function(){t._timedOut=!0,t.request.abort()}),e.timeout)),this.request=UPe.call(this,(function(e){t.triggerSuccess(e)}),(function(e,r){t.triggerError(e,r)}))}HPe.prototype={triggerSuccess(e){const t=this.o;let r=t.type;const n=(t.dataFilter||LPe.dataFilter)(e.responseText,r);if(r||(r=e&&function(e){if(e){if(e.match("json"))return"json";if(e.match("javascript"))return"js";if(e.match("text"))return"html";if(e.match("xml"))return"xml"}}(e.getResponseHeader("Content-Type"))),e="jsonp"!==r?this.request:e,n)switch(r){case"json":try{e=kPe.JSON.parse(n)}catch{return this.triggerError("Could not parse JSON in response",e)}break;case"html":e=n;break;case"xml":e=e.responseXML&&e.responseXML.parseError&&e.responseXML.parseError.errorCode&&e.responseXML.parseError.reason?null:e.responseXML}t.success&&t.success(e),this.triggerComplete(e),this.__resolve(e)},triggerError(e,t){const r=this.o,n=new Error(e);n.xhr=t,r.error&&r.error(n),this.triggerComplete(n),this.__reject(n)},triggerComplete(e){const t=this.o;t.timeout&&clearTimeout(this.timeout),this.timeout=null,t.complete&&t.complete(e)},initPromise(){const e=this;e.promise=new Promise(((t,r)=>{e.__resolve=t,e.__reject=r}))},abort(){this._aborted=!0,this.request.abort()},retry(){this.initPromise(),GPe.call(this,this.o)},then(e,t){return this.promise.then(e,t)},always(e){return this.promise.then(e,e)},fail(e){return this.promise.then(void 0,e)},catch(e){return this.fail(e)},setup(e){this.o={...LPe,...e}},start(e){this.setup(e),GPe.call(this,this.o)}},WPe.ajaxSetup=(e={})=>{for(const t in e)e.hasOwnProperty(t)&&LPe.hasOwnProperty(t)&&(LPe[t]=e[t])};const KPe="_ts",qPe="_input_charset",YPe="utf-8",XPe={withCToken:!0,withInputCharset:!0,cache:!0};function ZPe(e,t=window){const r={...XPe,...e},n=XPe.cache||"post"===r.method,i=function(e){const t=e.document.cookie.split(/;\s/g);for(let e=0,r=t.length;e<r;e++){const r=t[e].match(/([^=]+)=/i);if(r&&r[1]===wPe)return t[e].substring(r[1].length+1)}}(t),{withCToken:o,withInputCharset:a}=r;let s;return r.data=r.data||{},Array.isArray(r.data)?(s=[],o&&i&&s.push({name:bPe,value:encodeURIComponent(i)}),a&&s.push({name:qPe,value:YPe}),n||s.push({name:KPe,value:Date.now()}),r.data=r.data.concat(s)):"string"==typeof r.data?(a&&-1===r.data.indexOf(qPe)&&(r.data+="&"+qPe+"="+YPe),o&&i&&-1===r.data.indexOf(bPe)&&(r.data+="&"+bPe+"="+encodeURIComponent(i)),n||(r.data+="&"+KPe+"="+Date.now())):SPe(r.data)?(a&&!r.data.get(qPe)&&r.data.append(qPe,YPe),r.url&&o&&i&&(r.url=EPe(r.url,xPe({[bPe]:i})))):(a&&(r.data[qPe]=YPe),n||(r.data[KPe]=Date.now()),o&&i&&!r.data[bPe]&&(r.data[bPe]=i)),r}function JPe(e,t){let r;r="string"==typeof e?{url:e,success:t}:e,e=r.url;const n=WPe();return e.startsWith("//")&&(e=location.protocol+e),function(e){return!/^https?:\/\/\w+\.alipayobjects\.com\//g.test(e)}(e)&&(r=ZPe(r)),n.start(r),n}JPe.ajaxSetup=e=>{for(const t in e)e.hasOwnProperty(t)&&XPe.hasOwnProperty(t)&&(XPe[t]=e[t]);WPe.ajaxSetup(e)},JPe.ajaxSetup({withInputCharset:!1});const QPe=new class{constructor(e={}){this.options={ajaxOptions:{progress(){},error(){},success(){},data:{},method:"post",url:""},...e}}ajax(e){(e={...this.options.ajaxOptions,...e}).url=function(e){var t,r,n,i;if(e.startsWith("http"))return e;const o=(null==(r=null==(t=globalThis.nebulaMobileApp)?void 0:t.envInfo)?void 0:r.origin)||(null==(i=null==(n=globalThis.yqWebApp)?void 0:n.globalServiceEnv)?void 0:i.host);return o?`${o}${e}`:e}(e.url);const t=e.success,r=e.error,n=new Promise((n=>{e.success=e=>{t(e),n(e)},e.error=e=>{r(e),n(e)}}));return{xhr:JPe(e),promise:n}}},eje=e=>{if(globalThis.__ajaxProxy){const t=globalThis.__ajaxProxy(e);if(t)return t}return QPe.ajax(e)};var tje=Object.defineProperty,rje=Object.getOwnPropertyDescriptor,nje=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?rje(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&tje(t,r,o),o};let ije=class{getConfig(e){return this._configuration.getValue(`upload.${e}`)}async tryQuickUpload(e,t){const r=this.getConfig(t);if(!r.quickUrl)return!1;const n=await Object(Gt.fileMd5)(e),i=e.size,o=e.name,a=e.type;let s;return await eje({xhr:()=>new window.XMLHttpRequest,url:r.quickUrl,data:{md5:n,filesize:i,filename:o,filetype:a,type:t},dataType:"json",success:e=>{e&&!1===e.data.success||(s=e)},error:e=>{console.error(e)},method:"POST",processData:!0}).xhr.promise,!(!s||!1===s.success)&&s}async uploadFile(e,t,r){const n=this.getConfig(t),i=new FormData;i.append("file",e,e.name);const o=(n.url||"").replace(/ctoken=[^&]+&/,"");eje({xhr:()=>{const t=new window.XMLHttpRequest;return t.upload.addEventListener("progress",(t=>{t.lengthComputable&&r({id:e.uid,status:"running",file:e,percent:parseInt(String(t.loaded/t.total*100),10)})}),!1),t},url:o,data:i,dataType:"json",success:({data:t})=>{t?(e.src=t.url,r({id:e.uid,status:"success",file:e})):r({id:e.uid,status:"error",message:kf("上传失败"),file:e})},error:t=>{let n,i="";if(t&&t.xhr&&t.xhr.response)try{n=JSON.parse(t.xhr.response),i=n.message||""}catch{i=""}else i=t.message;i||(i=kf("上传失败")),r({id:e.uid,status:"error",file:e,message:i})},method:"POST",processData:!0})}async upload(e,t,r){try{const n=await this.tryQuickUpload(e,t);n?(e.src=n.data.url,r({id:e.uid,status:"success",file:e})):await this.uploadFile(e,t,r)}catch(n){console.error(n),await this.uploadFile(e,t,r)}}};nje([to(qf)],ije.prototype,"_configuration",2),ije=nje([eo()],ije);var oje=Object.defineProperty,aje=Object.getOwnPropertyDescriptor,sje=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?aje(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&oje(t,r,o),o};let lje=class{static pluginModule(){return bo().register(ije).register(this)}static registerConfiguration(e){e.registerConfiguration({id:"upload",type:"object",properties:{image:{type:"object",properties:{url:{type:"string",description:"图片上传接口"},quickUrl:{type:"string",description:"图片秒传接口"}}},file:{type:"object",properties:{url:{type:"string",description:"文件上传接口"},quickUrl:{type:"string",description:"文件秒传接口"}}}}}),e.registerDefaultValue({"upload.image.url":"/api/upload/attach?&type=image","upload.image.quickUrl":"/api/upload/upload_by_digset?&type=image","upload.file.url":"/api/upload/attach?&type=attach","upload.file.quickUrl":"/api/upload/upload_by_digset?&type=attach"})}init(){}registerUpload(){return{upload:(e,t,r)=>this._uploadService.upload(e,t,r),checkSize:(e,t)=>{try{if(window.__member_message_ref){const{msg:r,alwaysOpen:n,level:i,callback:o}=window.__member_message_ref.current.getMessageWithFile({filesize:e.size},t)||{};if(r)return o(v.a[i||"error"](r,n?0:void 0)),!1}}catch(e){return console.error(e),!1}return!0}}}};lje.pluginName="render-upload",sje([to(ije)],lje.prototype,"_uploadService",2),lje=sje([eo({contrib:[Nj,fZ]})],lje);const cje=({field:e,position:t})=>{const r=zA(TNe),n=zA(CMe),i=zA(Pb),o=zA(qf),l=null==r?void 0:r.getAiWritingConfig(e.uuid),c=null==o?void 0:o.getValue("aiWriting.enable"),[u,d]=Object(a.useState)((null==n?void 0:n.isFieldGenerating(e.uuid))||!1),f=(null==l?void 0:l.open)&&c;return Object(a.useLayoutEffect)((()=>{if(!f||"gridHeader"!==t)return void d(!1);const r=null==n?void 0:n.onAiWritingStatusChange((({isGenerating:t,fieldId:r})=>{r===e.uuid&&t?d(!0):d(!1)}));return()=>{null==r||r.destroy()}}),[n,f,t,e.uuid]),f?s.a.createElement(s.a.Fragment,null,s.a.createElement(Ft.default,{className:"lakex-table-grid-header-ai-writing-icon",width:16,height:16}),u&&s.a.createElement(Vt.default,{className:"lakex-table-ai-writing-loading-icon","data-no-dnd":"true",width:16,height:16,onClick:async()=>{await(null==i?void 0:i.execCommand("stopAiWriting",{fieldId:e.uuid})),v.a.success(kf("已停止填写"))}})):null};var uje=Object.defineProperty,dje=Object.getOwnPropertyDescriptor;let fje=class{static pluginModule(){return bo().register(this)}init(){}getTextFieldTagComponent(){return cje}};fje.pluginName="render-ai-writing",fje=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?dje(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&uje(t,r,o),o})([eo({contrib:[Nj,JQ]})],fje);const pje=({fields:e,view:t,viewFields:r})=>{const{viewFieldIds:n,onInsert:i,onRemove:o}=(({view:e,viewFields:t})=>{const r=zA(Pb);return{viewFieldIds:Object(a.useMemo)((()=>t.map((e=>{var t;return null==(t=e.field)?void 0:t.uuid}))),[t]),onInsert:t=>{null==r||r.execCommand("insertViewField",{viewId:e.uuid,fieldId:t.uuid})},onRemove:t=>{null==r||r.execCommand("removeViewField",{viewId:e.uuid,fieldId:t.uuid})}}})({view:t,viewFields:r}),l=zA(tD);return s.a.createElement("div",{className:"lakex-form-col-container"},s.a.createElement("div",{className:"lakex-form-col-intro"},kf("所有列"),s.a.createElement(h.a,{title:kf("数据表中所有列")},s.a.createElement(YP,{type:"Question"}))),s.a.createElement("div",{className:"lakex-form-col-items"},e.map(((e,t)=>{const r=n.includes(e.uuid),a=n.findIndex((t=>t===e.uuid)),c=l.getFieldIcon(e.type);return s.a.createElement("div",{className:"lakex-form-col "+(r?"active":"deactive"),key:e.uuid,onClick:()=>{i(e)}},s.a.createElement("div",{className:"lakex-form-col-name"},c&&s.a.createElement(c,null),e.name),r&&s.a.createElement("span",{className:"lakex-form-col-state"},kf("添加")),r&&s.a.createElement("span",{className:"lakex-form-col-state-remove",onClick:t=>{t.stopPropagation(),t.preventDefault(),o(e)}},kf("取消添加")),!r&&s.a.createElement("span",{className:"lakex-form-col-state add"},kf("添加")," ",s.a.createElement(YP,{type:"ArrowRight",style:{marginLeft:4}})),s.a.createElement("div",{className:"lakex-form-col-fields"},function(e,t){return e?s.a.createElement("span",null,null!=t?`${t+1}.`:"",e.name):s.a.createElement("span",{className:"lakex-form-col-untitled"},kf("未命名问题"))}(e,a)))}))))},hje=({view:e,defaultValue:t})=>{const r=zA(Pb),n=zA(Rf),i=Object(a.useRef)(null);return Object(a.useEffect)((()=>{null==n||n.onChange((({spell:t})=>{var r;"view"===t.table&&t.command===Af.UPDATE&&e.uuid===t.where.uuid&&null!=t.sets.name&&(null==(r=i.current)||r.setValue(t.sets.name))}))}),[]),s.a.createElement(u.a,{ref:i,className:"lakex-form-title",autoFocus:""===t,autoSize:!0,defaultValue:t,onBlur:t=>{null==r||r.execCommand("updateViewName",{viewId:null==e?void 0:e.uuid,name:t.target.value})},onClick:e=>{e.stopPropagation()},placeholder:kf("请输入表单标题")})},mje=({view:e,defaultValue:t,maxLength:r=255})=>{const n=zA(Pb);return s.a.createElement(u.a.TextArea,{autoSize:!0,className:"lakex-form-desc",maxLength:r,defaultValue:t,onBlur:t=>{null==n||n.execCommand("updateViewDesc",{viewId:null==e?void 0:e.uuid,desc:t.target.value})},size:"small",onClick:e=>{e.stopPropagation()},placeholder:kf("请输入表单描述")})},vje=({view:e})=>{const t=zA(Dy),r=zA(Pb);return s.a.createElement("div",{className:"lakex-form-empty-field"},s.a.createElement("img",{className:"lakex-form-empty-field-img",src:"https://mdn.alipayobjects.com/huamei_0prmtq/afts/img/A*oG_ZTrK2ylsAAAAAAAAAAAAADvuFAQ/original"}),s.a.createElement("p",null,kf("表单为空")),s.a.createElement("span",{className:"lakex-form-empty-field-tip"},kf("点击左侧列表添加已有列 或 点击下方按钮添加新表单项")),s.a.createElement("br",null),s.a.createElement(b.a,{type:"primary",onClick:()=>{const n=t.getAllFields(),i=Ph(Rh.TEXT,n);r.execCommand("addField",{viewId:e.uuid,field:{uuid:Io(32),name:i,type:Rh.TEXT}})}},s.a.createElement(YP,{type:"Add"}),kf("添加")))},gje=e=>{const{defaultValue:t}=e,r=!t;return s.a.createElement("div",{className:"lake-form-item-ui-container "+(r?"lake-form-item-ui-show-tooltip":"")},s.a.createElement(u.a,{autoFocus:!0,placeholder:kf("请输入问题"),...e,maxLength:128}),r&&s.a.createElement(h.a,{title:kf("当问题为空时，会使用列名作为问题；如未重命名列，所填写的问题会自动同步给列名。")},s.a.createElement(YP,{className:"lake-form-item-input-tooltip",type:"Question"})))},yje=({viewField:e})=>{const{getFormComponent:t}=(()=>{const e=zA(tD);return{getFormComponent:t=>e.getFieldFormComponent(t)}})();if(!e||!e.field)return null;const r=t(e.field.type);return r?s.a.createElement(h.a,{placement:"bottom",title:kf("此处由填写者输入")},s.a.createElement("div",{className:"lakex-form-item-field"},s.a.createElement("div",{className:"lakex-form-item-field-mask"}),s.a.createElement(r,{viewField:e}))):null},bje=({viewField:e})=>{var t,r;const{getFormComponent:n,onChange:i,onChangeOrder:o}=(({viewField:e})=>{const t=zA(tD),r=zA(Pb),n=zA(Yre);return{getFormComponent:e=>t.getFieldFormComponent(e),onChange(t){null==r||r.execCommand("updateFieldProperty",{uuid:e.field.uuid,...t})},onChangeOrder(t,r){null==n||n.updateFieldOptionOrder(e.field.uuid,t,r)}}})({viewField:e});if(!e||!e.field)return null;const a=e.field.type,l=n(a);if(!l)return null;const c=l.OptionEditable;return c?s.a.createElement("div",{className:"lakex-table-form-designer-option-wrap"},s.a.createElement(c,{type:a,options:null==(t=e.field)?void 0:t.options,color:null==(r=e.field)?void 0:r.color,onChange:i,onChangeOrder:o,autoFocus:!1})):null},wje=({view:e,viewField:t,viewFields:r})=>{const{onMoveUp:n,onMoveDown:i,onClone:o,onRemove:a,onChangeRequired:l,onChangeName:c,onCreateAfter:u,onChangeDisplayType:d,openFieldConfigModal:f,Icon:m}=(({view:e,viewField:t,viewFields:r})=>{const n=zA(Dy),i=zA(Pb),o=zA(Zj),a=zA(tD);return{onMoveUp:t=>{var n;const o=r.findIndex((e=>e.uuid===t.uuid));if(0===o)return;const a=null==(n=r[o-1])?void 0:n.field_uuid;null==i||i.execCommand("changeFieldOrder",{viewId:e.uuid,sourceFieldId:t.field_uuid,targetFieldId:a})},onMoveDown:t=>{var n;const o=r.findIndex((e=>e.uuid===t.uuid)),a=null==(n=r[o+1])?void 0:n.field_uuid;!a||null==i||i.execCommand("changeFieldOrder",{viewId:e.uuid,sourceFieldId:t.field_uuid,targetFieldId:a})},onClone:t=>{null==i||i.execCommand(ESe.commandName,{viewId:e.uuid,fieldId:t.field_uuid})},onRemove:e=>{null==i||i.execCommand("removeViewField",{viewId:e.view_uuid,fieldId:e.field.uuid})},onChangeRequired:(t,r)=>{null==i||i.execCommand(_Se.commandName,{viewId:e.uuid,fieldId:t.field_uuid,required:r.target.checked})},onChangeDisplayType:(t,r)=>{null==i||i.execCommand(wSe.commandName,{viewId:e.uuid,fieldId:t.field_uuid,displayType:r})},onChangeName:Wt()(((t,r)=>{(t.name||t.field.name)!==r&&(null==i||i.execCommand(CSe.commandName,{viewId:e.uuid,fieldId:t.field_uuid,name:r}))}),1e3),onCreateAfter:t=>{const r=n.getAllFields(),o=Ph(Rh.TEXT,r);null==i||i.execCommand("addField",{viewId:e.uuid,field:{uuid:Io(32),name:o,type:Rh.TEXT},sourceFieldId:t.field_uuid})},openFieldConfigModal(e,t){null==o||o.emitClickEvent({eventName:"fieldConfigClick",data:{viewField:e,e:t}})},Icon:({type:e})=>{const t=null==a?void 0:a.getFieldIcon(e);return t?s.a.createElement(t,{size:16}):null}}})({view:e,viewField:t,viewFields:r});if(!t.field)return null;const v=t.field.type;return s.a.createElement("div",{className:"lakex-form-item active"},s.a.createElement("div",{className:"lakex-form-item-inner"},s.a.createElement("div",{className:"lakex-form-item-inner-sidebar",onClick:e=>{e.stopPropagation()}},s.a.createElement(h.a,{placement:"left",title:kf("向上移动")},s.a.createElement(YP,{type:"ArrowUp",onClick:()=>{n(t)}})),s.a.createElement(h.a,{placement:"left",title:kf("向下移动")},s.a.createElement(YP,{type:"ArrowDown",onClick:()=>{i(t)}})),s.a.createElement(h.a,{placement:"left",title:kf("复制表单项")},s.a.createElement(YP,{type:"Copy",onClick:()=>{o(t)}})),s.a.createElement(h.a,{placement:"left",title:kf("移除表单项")},s.a.createElement(YP,{type:"Clear",onClick:()=>{a(t)}}))),s.a.createElement("div",{className:"lakex-form-item-inner-container"},s.a.createElement("div",{className:"lakex-form-item-inner-column-configs"},s.a.createElement("div",{className:"lakex-form-item-inner-column-name"},s.a.createElement(h.a,{placement:"top",title:kf("点击修改字段")},s.a.createElement("span",{className:"lakex-form-item-inner-column-content",onClick:e=>f(t,e)},s.a.createElement(m,{type:v}),null==t?void 0:t.field.name,s.a.createElement(YP,{type:"Edit"})))),s.a.createElement("div",{className:"lakex-form-item-inner-type"},s.a.createElement("div",{className:"lakex-form-item-inner-validation"},s.a.createElement(p.a,{defaultChecked:t.required,onChange:e=>l(t,e)},kf("必填"))))),s.a.createElement("div",{className:"lakex-form-item-inner-field-configs"},s.a.createElement(gje,{defaultValue:t.name||t.field.name,onChange:e=>{c(t,e.target.value)},onBlur:e=>{c(t,e.target.value)}}),s.a.createElement(yje,{viewField:t}),s.a.createElement(bje,{viewField:t}),Kh.isSelectLike(v)&&s.a.createElement("div",{className:"lakex-form-item-option-layout"},s.a.createElement("span",{style:{color:"#8c8c8c"}},kf("布局方式"),":"),s.a.createElement(x.a,{defaultValue:t.display_type||"list",bordered:!1,onChange:e=>{d(t,e)},dropdownClassName:"lakex-form-item-dropdown"},s.a.createElement(x.a.Option,{value:"list"},kf("列表")),s.a.createElement(x.a.Option,{value:"dropdown"},kf("下拉")))))),t.required&&""===t.name?s.a.createElement("div",{className:"lakex-form-item-inner-error"},kf("请输入问题")):null),s.a.createElement("div",{className:"lakex-form-item-inner-add"},s.a.createElement(b.a,{onClick:e=>{u(t)},onMouseDown:e=>{e.stopPropagation()}},s.a.createElement(YP,{type:"Add"}),kf("添加"))))},_je=({viewField:e,onClick:t=(()=>{}),index:r})=>{var n;return s.a.createElement("div",{className:"lakex-form-item lakex-form-item-normal",onClick:t},s.a.createElement("div",{className:"lakex-form-item-normal-preview"},s.a.createElement("div",{className:e.required?"lakex-form-item-normal-preview-required":""},`${r+1}. ${e.name||(null==(n=e.field)?void 0:n.name)}`),s.a.createElement("div",{className:"lakex-form-item-normal-comp"},s.a.createElement(yje,{viewField:e}))),e.required&&""===e.name?s.a.createElement("div",{className:"lakex-form-item-error"},kf("请输入问题")):null)},Cje=({index:e,active:t,view:r,viewField:n,viewFields:i,onClick:o=(()=>{})})=>t?s.a.createElement(wje,{view:r,viewField:n,viewFields:i}):s.a.createElement(_je,{onClick:o,index:e,viewField:n}),Eje=({view:e,viewFields:t=[]})=>{const{state:r,forceUpdate:n,setActiveId:i,onCreate:o}=(({view:e,viewFields:t})=>{const[r,n]=Object(a.useState)(),i=zA(Dy),o=zA(Pb),s=cj();return Object(a.useEffect)((()=>{const e=e=>{let t=e.target;if("INPUT"!==t.tagName){for(;t&&t.classList&&t!==document.body;){if(t.classList.contains("lakex-form-item")||t.classList.contains("lakex-form-item-dropdown")||t.classList.contains("lake-table-col-configs")||t.classList.contains("lake-table-colorpicker")||t.classList.contains("lake-table-menu-configs-submenu"))return;t=t.parentNode}n(void 0),s()}};return window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}}),[]),{state:{activeId:r},forceUpdate:s,setActiveId:n,onCreate(){var r;const n=i.getAllFields(),a=Ph(Rh.TEXT,n);null==o||o.execCommand("addField",{viewId:e.uuid,field:{uuid:Io(32),name:a,type:Rh.TEXT},sourceFieldId:null==(r=t[t.length-1])?void 0:r.field_uuid})}}})({view:e,viewFields:t});return s.a.createElement("div",{className:"lakex-form-list"},t.map(((o,a)=>{const l=o.field;return l?s.a.createElement(Cje,{view:e,viewField:o,viewFields:t,index:a,active:o.uuid===r.activeId,key:l.uuid,onClick:()=>{i(o.uuid),n()}}):null})),s.a.createElement("div",{className:"lakex-form-list-footer"},s.a.createElement(b.a,{type:"primary",onClick:e=>{o()}},s.a.createElement(YP,{type:"Add"}),kf("添加"))))},xje=({viewId:e})=>{const t=zA(PSe),r=zA(s_),[n,i]=Object(a.useState)(null==t?void 0:t.getFormEditData(e));return Object(a.useEffect)((()=>{const n=r.onDataChanged((()=>{(()=>{const r=null==t?void 0:t.getFormEditData(e);i(r)})()}));return()=>{n.destroy()}}),[]),{formData:n}},Sje=e=>{var t,r,n,i;const{formData:o}=xje({viewId:e.viewId});return o?s.a.createElement("div",{className:"lakex-form-container"},(null==o?void 0:o.fields)&&s.a.createElement(pje,{view:o.view,fields:o.fields,viewFields:o.viewFields}),s.a.createElement("div",{className:"lakex-form-configs"},s.a.createElement("div",{className:"lakex-form-configs-bg"},0!==(null==(t=o.viewFields)?void 0:t.length)&&s.a.createElement("div",{className:"lakex-form-configs-title"},s.a.createElement(hje,{view:o.view,defaultValue:null==(r=o.view)?void 0:r.name}),s.a.createElement(mje,{view:o.view,defaultValue:null==(n=o.view)?void 0:n.desc})),0===(null==(i=o.viewFields)?void 0:i.length)?s.a.createElement(vje,{view:o.view}):s.a.createElement(Eje,{view:o.view,viewFields:o.viewFields})))):null},kje=s.a.forwardRef(((e,t)=>{const{status:r,onOpenManage:n,viewId:i,canUpdate:o}=(()=>{const e=u0(),t=s0(Nw.TABLE),r=zA(PSe),n=zA(Zj),i=zA(Rf),[o,s]=Object(a.useState)(SSe.PENDING),l=e.view.id,c=e.view.uuid,u=Object(a.useCallback)((e=>{const t=null==r?void 0:r.getShare(e);(null==t?void 0:t.status)===Dh.ACTIVE?s(SSe.COLLECTING):s(SSe.PENDING)}),[c]);return Object(a.useEffect)((()=>{if(l){let e=null==r?void 0:r.getShare(c);e?e.status===Dh.ACTIVE?s(SSe.COLLECTING):s(SSe.PENDING):null==r||r.initForm(c).then((()=>{u(c)})),null==i||i.onChange((({spell:e})=>{"view_share"===e.table&&e.command===Af.UPSERT&&u(c)}))}else s(SSe.PENDING)}),[l,c]),{status:o,viewId:c,canUpdate:t.canUpdate(),onOpenManage(t){var r;n.emitClickEvent({eventName:"clickFormManageButton",data:{target:t.currentTarget,viewId:null==(r=null==e?void 0:e.view)?void 0:r.uuid,status:o}})}}})();if(!o)return s.a.createElement(aj,{type:ij.Unauthorized,desc:kf("查看表单视图需要编辑权限")});let l=kf("开启收集");return r===SSe.COLLECTING&&(l=kf("收集中")),s.a.createElement("div",{className:"lakex-table-form",ref:t,key:i},s.a.createElement(Sje,{viewId:i}),s.a.createElement(b.a,{className:"lakex-table-form-manage",type:"primary",onClick:n},l))}));class Oje extends rV{constructor(){super(...arguments),this.viewType=Wh.FORM,this.title=kf("表单视图"),this.desc=kf("像问卷一样收集信息"),this.icon=e=>s.a.createElement(YP,{type:"FormView",...e}),this.colorCls="yuque-color-orange-5",this.Component=kje}}var Ije=Object.defineProperty,Rje=Object.getOwnPropertyDescriptor;let Tje=class{static pluginModule(){return bo().register(this)}init(){}registerViewer(e){e.registerItem(new Oje({onError:e.onError}))}};Tje.pluginName="render-viewer-form",Tje=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Rje(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ije(t,r,o),o})([eo({contrib:[Nj,Fj]})],Tje);const Aje=[lje,fje,Tje],Nje=(e,t,r)=>{if(t&&t>16383||r&&r>16383)return e;if(function(){if(fA)return pA;const e=document.createElement("canvas");return pA=!(!e.getContext||!e.getContext("2d"))&&(aa.isChrome||aa.isFirefox||0===e.toDataURL("image/webp").indexOf("data:image/webp")),fA=!0,pA}()&&Gt.OssUtil.isURLInOSS(e)){const t=new URL(e);if(!t.pathname)return e;const r=t.pathname.toLowerCase(),n=[".webp",".svg"],i=r.substring(r.lastIndexOf("."));n.includes(i)||(e=Gt.OssUtil.addImageProcess(t,"format","webp"))}return e};const Mje={token:JX,useValue:{registerImage:()=>({getExts:()=>Gt.FileUtils.EXTS.IMAGE_EXT_STR,tryGetWebp:Nje,getThumbnailUrl(e,t,r,n){e=Nje(e,t,r);const i=t||n,o=Gt.DeviceUtil.getDevicePixelRatio();return i<=parseInt(n)*Number(o)?e:function(e,t,r,n){if(!r.width||!r.originWidth||!r.originHeight||!t||!t.startsWith("http")||r.originWidth>3e4||r.originHeight>3e4)return null;let i=parseInt(r.width,10);i>e&&(i=e),i*=Gt.DeviceUtil.getDevicePixelRatio();const o=t.toLowerCase();if(!Gt.OssUtil.isURLInOSS(o))return null;const a=i*(r.originHeight/r.originWidth);return i>0&&i*a<16777216&&i<4096&&a<4096&&i<r.originWidth&&!/^https?:\/\/\w+\.alipayobjects\.com\//i.test(o)&&!o.endsWith(".gif")&&!o.endsWith(".svg")?Gt.OssUtil.addImageProcess(t,"resize",`w_${i}`):null}(n,e,{width:n,originWidth:i,originHeight:r})||e}})}};function Pje(e,t){const r=Gt.FileUtils.getFileExtname(e);return Gt.FileUtils.isFileCanPreview(r,t)?Gt.FileUtils.getPreviewUrl(e):e}const jje={token:zD,useValue:{registerFile:()=>({getExts:()=>Gt.FileUtils.EXTS.FILE_EXT_STR,getFileKey:e=>Gt.FileUtils.getFileKey(e),getPreviewUrl:e=>Gt.FileUtils.getPreviewUrl(e),getPreviewOrDownloadUrl:Pje})}},Dje={token:NS,useValue:{registerTheme:()=>({getThemeManager(){let e=nSe.themeManager;return e||(e=new T.DefaultThemeManager),e}})}};class Fje{static openExternalLink(e){if(!globalThis.openExternalLink)return window.open(e,"_blank","noopener,noreferrer");globalThis.openExternalLink(e,!0)}}class Vje{constructor(e){this.openerName="file-previewer-opener",this.canPreview=e=>!0,"function"==typeof e&&(this.canPreview=e)}open(e,t){const r=Gt.FileUtils.getFileExtname(e);if(!this.canPreview(r))return void v.a.warning(s.a.createElement("span",{},[kf("当前文档中此文件类型不支持预览和下载"),s.a.createElement("a",{style:{marginLeft:5},rel:"noreferrer",href:Gt.disableExtLink,target:"_blank",onClick:e=>{e.preventDefault(),Fje.openExternalLink(Gt.disableExtLink)}},[s.a.createElement(Lt.default)])]));let n=e;Gt.FileUtils.isFileCanPreview(r,t)&&(n=Gt.FileUtils.getPreviewUrl(e)),n&&Fje.openExternalLink(n)}}const Lje=e=>[new Vje(e.canFilePreview)];const $je=[new class{constructor(){this.openerName="image-viewer-opener",this.apps=["image"]}open(e,t={}){var r;let n=t.list,i=t.index||0;n||(i=0,n=[{src:e,msrc:e,width:t.width,height:t.height}]),null==(r=globalThis.NativeBridges)||r.previewImage({images:n.map((e=>({url:e.src,thumbnailUrl:e.msrc||e.src,width:e.width,height:e.height}))),index:i})}}];class Bje{constructor(e){this.openerName="file-previewer-opener",this.apps=["file"],this.canPreview=e=>!0,"function"==typeof e&&(this.canPreview=e)}open(e,t){const r=Gt.FileUtils.getFileExtname(e);if(!this.canPreview(r))return void v.a.warning(s.a.createElement("span",{},[kf("当前文档中此文件类型不支持预览和下载"),s.a.createElement("a",{style:{marginLeft:5},rel:"noreferrer",href:Gt.disableExtLink,target:"_blank",onClick:e=>{e.preventDefault(),window.open(Gt.disableExtLink,"_blank","noopener,noreferrer")}},[s.a.createElement(Lt.default)])]));const n=Pje(e,t.size);!n||window.open(n,"_blank","noopener,noreferrer")}}const zje=e=>({src:e.src,msrc:e.src,w:null==e?void 0:e.width,h:null==e?void 0:e.height});class Uje{constructor(){this.openerName="image-viewer-opener",this.apps=["image"]}open(e,t={}){let r=t.list,n=t.index||0;r||(n=0,r=[{src:e,width:t.width,height:t.height}]),function(e,t){const r=Object(Gt.getImageBrowser)(),n=Array.isArray(e)?e.map((e=>zje(e))):[e].map((e=>zje(e)));r.open(n,t||0)}(r,n)}}const Hje=e=>({token:aD,useValue:{registerOpener(){const t=[new Bje(e.canFilePreview),new Uje];return nSe.isDesktop?[...t,...Lje(e)]:nSe.isYuqueMobileApp?[...t,...$je]:t}}}),Wje=e=>{const t=e["opener.filePreview.canPreview"];return[jje,Mje,Dje,Hje({canFilePreview:t})]},Gje=Fi.defineToken("ViewerFormManageContribution");var Kje=Object.defineProperty,qje=Object.getOwnPropertyDescriptor,Yje=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?qje(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Kje(t,r,o),o};let Xje=class{getProvider(){const e=this.formManageProvider.getContributions();return e[e.length-1].registerFormManage()}enableForm(e,t){return this.getProvider().enableForm(e,t)}};Yje([Eo(Gje)],Xje.prototype,"formManageProvider",2),Xje=Yje([eo()],Xje);var Zje=Object.defineProperty,Jje=Object.getOwnPropertyDescriptor,Qje=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Jje(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Zje(t,r,o),o};let eDe=class{getShare(e){if(e)return this._readService.getViewShare(e)}reOpenModal(){this._modalService.close("form-manange"),setTimeout((()=>{this._modalService.open("form-manage",{position:this._position})}),100)}setModalPosition(e){this._position=e}async createForm(e){this._readService.getView(e)||await this._commandService.execCommand("addView",{uuid:Io(32),type:Wh.FORM,noSwitchView:!0},!0),this._modalService.close("form-create-modal"),this._modalService.open("form-disabled-modal",{position:this._position}),this._modalService.open("form-editor",{position:{left:0,top:0}})}async removeForm(e,t){const r=this._readService.getView(e);!r||(this._commandService.execCommand("removeView",{viewId:r.uuid}),this._modalService.close(t))}async disableForm(e){const t=this._readService.getView(e);!t||(this._commandService.execCommand("upsertViewShare",{viewId:t.uuid,status:Dh.INACTIVE}),this._modalService.close("form-enabled-modal"))}async enableForm(e){const t=this._readService.getView(e);if(!t)return;let r="create";this._readService.getViewShare(t.uuid)&&(r="update");const n=await this._formManageRegistry.enableForm(t.id,r);this._commandService.execCommand("upsertViewShare",{viewId:t.uuid,status:Dh.ACTIVE,src:n.src}),this._modalService.close("form-disabled-modal"),this._modalService.open("form-enabled-modal",{position:this._position})}isEnableManage(){return!this._configuration.getValue("form.manage.disable")}};Qje([to(Dy)],eDe.prototype,"_readService",2),Qje([to(Pb)],eDe.prototype,"_commandService",2),Qje([to(tQ)],eDe.prototype,"_modalService",2),Qje([to(qf)],eDe.prototype,"_configuration",2),Qje([to(Xje)],eDe.prototype,"_formManageRegistry",2),eDe=Qje([eo()],eDe);const tDe=({onCreate:e})=>s.a.createElement("div",{className:"lakex-table-form-create-container"},s.a.createElement("div",null,s.a.createElement("img",{src:"https://gw.alipayobjects.com/mdn/rms_740edc/afts/img/A*fH-gQbQajwgAAAAAAAAAAAAAARQnAQ",width:"142",height:"92"})),s.a.createElement("p",{className:"lakex-table-form-create-add-desc"},kf("可用于问卷调查、活动组织、登记报名等信息收集与整理场景。")),s.a.createElement("div",{className:"lakex-table-form-create-add"},s.a.createElement(b.a,{type:"primary",onClick:e},kf("生成新表单")))),rDe=()=>{const{onCreate:e}=(()=>{const e=l0(),t=zA(eDe);return{onCreate(){t.createForm(e.uuid)}}})();return s.a.createElement("div",{className:"lakex-table-form-modal"},s.a.createElement(tDe,{onCreate:e}))};var nDe={},iDe={},oDe={};let aDe;const sDe=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];oDe.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return 4*e+17},oDe.getSymbolTotalCodewords=function(e){return sDe[e]},oDe.getBCHDigit=function(e){let t=0;for(;0!==e;)t++,e>>>=1;return t},oDe.setToSJISFunction=function(e){if("function"!=typeof e)throw new Error('"toSJISFunc" is not a valid function.');aDe=e},oDe.isKanjiModeEnabled=function(){return typeof aDe<"u"},oDe.toSJIS=function(e){return aDe(e)};var lDe={};function cDe(){this.buffer=[],this.length=0}!function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2},e.isValid=function(e){return e&&typeof e.bit<"u"&&e.bit>=0&&e.bit<4},e.from=function(t,r){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+t)}}(t)}catch{return r}}}(lDe),cDe.prototype={get:function(e){const t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(let r=0;r<t;r++)this.putBit(1==(e>>>t-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var uDe=cDe;function dDe(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}dDe.prototype.set=function(e,t,r,n){const i=e*this.size+t;this.data[i]=r,n&&(this.reservedBit[i]=!0)},dDe.prototype.get=function(e,t){return this.data[e*this.size+t]},dDe.prototype.xor=function(e,t,r){this.data[e*this.size+t]^=r},dDe.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};var fDe=dDe,pDe={};!function(e){const t=oDe.getSymbolSize;e.getRowColCoords=function(e){if(1===e)return[];const r=Math.floor(e/7)+2,n=t(e),i=145===n?26:2*Math.ceil((n-13)/(2*r-2)),o=[n-7];for(let e=1;e<r-1;e++)o[e]=o[e-1]-i;return o.push(6),o.reverse()},e.getPositions=function(t){const r=[],n=e.getRowColCoords(t),i=n.length;for(let e=0;e<i;e++)for(let t=0;t<i;t++)0===e&&0===t||0===e&&t===i-1||e===i-1&&0===t||r.push([n[e],n[t]]);return r}}(pDe);var hDe={};const mDe=oDe.getSymbolSize;hDe.getPositions=function(e){const t=mDe(e);return[[0,0],[t-7,0],[0,t-7]]};var vDe={};!function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t=3,r=3,n=40,i=10;function o(t,r,n){switch(t){case e.Patterns.PATTERN000:return(r+n)%2==0;case e.Patterns.PATTERN001:return r%2==0;case e.Patterns.PATTERN010:return n%3==0;case e.Patterns.PATTERN011:return(r+n)%3==0;case e.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(n/3))%2==0;case e.Patterns.PATTERN101:return r*n%2+r*n%3==0;case e.Patterns.PATTERN110:return(r*n%2+r*n%3)%2==0;case e.Patterns.PATTERN111:return(r*n%3+(r+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}}e.isValid=function(e){return null!=e&&""!==e&&!isNaN(e)&&e>=0&&e<=7},e.from=function(t){return e.isValid(t)?parseInt(t,10):void 0},e.getPenaltyN1=function(e){const r=e.size;let n=0,i=0,o=0,a=null,s=null;for(let l=0;l<r;l++){i=o=0,a=s=null;for(let c=0;c<r;c++){let r=e.get(l,c);r===a?i++:(i>=5&&(n+=t+(i-5)),a=r,i=1),r=e.get(c,l),r===s?o++:(o>=5&&(n+=t+(o-5)),s=r,o=1)}i>=5&&(n+=t+(i-5)),o>=5&&(n+=t+(o-5))}return n},e.getPenaltyN2=function(e){const t=e.size;let n=0;for(let r=0;r<t-1;r++)for(let i=0;i<t-1;i++){const t=e.get(r,i)+e.get(r,i+1)+e.get(r+1,i)+e.get(r+1,i+1);(4===t||0===t)&&n++}return n*r},e.getPenaltyN3=function(e){const t=e.size;let r=0,i=0,o=0;for(let n=0;n<t;n++){i=o=0;for(let a=0;a<t;a++)i=i<<1&2047|e.get(n,a),a>=10&&(1488===i||93===i)&&r++,o=o<<1&2047|e.get(a,n),a>=10&&(1488===o||93===o)&&r++}return r*n},e.getPenaltyN4=function(e){let t=0;const r=e.data.length;for(let n=0;n<r;n++)t+=e.data[n];return Math.abs(Math.ceil(100*t/r/5)-10)*i},e.applyMask=function(e,t){const r=t.size;for(let n=0;n<r;n++)for(let i=0;i<r;i++)t.isReserved(i,n)||t.xor(i,n,o(e,i,n))},e.getBestMask=function(t,r){const n=Object.keys(e.Patterns).length;let i=0,o=1/0;for(let a=0;a<n;a++){r(a),e.applyMask(a,t);const n=e.getPenaltyN1(t)+e.getPenaltyN2(t)+e.getPenaltyN3(t)+e.getPenaltyN4(t);e.applyMask(a,t),n<o&&(o=n,i=a)}return i}}(vDe);var gDe={};const yDe=lDe,bDe=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],wDe=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];gDe.getBlocksCount=function(e,t){switch(t){case yDe.L:return bDe[4*(e-1)+0];case yDe.M:return bDe[4*(e-1)+1];case yDe.Q:return bDe[4*(e-1)+2];case yDe.H:return bDe[4*(e-1)+3];default:return}},gDe.getTotalCodewordsCount=function(e,t){switch(t){case yDe.L:return wDe[4*(e-1)+0];case yDe.M:return wDe[4*(e-1)+1];case yDe.Q:return wDe[4*(e-1)+2];case yDe.H:return wDe[4*(e-1)+3];default:return}};var _De={},CDe={};const EDe=new Uint8Array(512),xDe=new Uint8Array(256);!function(){let e=1;for(let t=0;t<255;t++)EDe[t]=e,xDe[e]=t,e<<=1,256&e&&(e^=285);for(let e=255;e<512;e++)EDe[e]=EDe[e-255]}(),CDe.log=function(e){if(e<1)throw new Error("log("+e+")");return xDe[e]},CDe.exp=function(e){return EDe[e]},CDe.mul=function(e,t){return 0===e||0===t?0:EDe[xDe[e]+xDe[t]]},function(e){const t=CDe;e.mul=function(e,r){const n=new Uint8Array(e.length+r.length-1);for(let i=0;i<e.length;i++)for(let o=0;o<r.length;o++)n[i+o]^=t.mul(e[i],r[o]);return n},e.mod=function(e,r){let n=new Uint8Array(e);for(;n.length-r.length>=0;){const e=n[0];for(let i=0;i<r.length;i++)n[i]^=t.mul(r[i],e);let i=0;for(;i<n.length&&0===n[i];)i++;n=n.slice(i)}return n},e.generateECPolynomial=function(r){let n=new Uint8Array([1]);for(let i=0;i<r;i++)n=e.mul(n,new Uint8Array([1,t.exp(i)]));return n}}(_De);const SDe=_De;function kDe(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}kDe.prototype.initialize=function(e){this.degree=e,this.genPoly=SDe.generateECPolynomial(this.degree)},kDe.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(e.length+this.degree);t.set(e);const r=SDe.mod(t,this.genPoly),n=this.degree-r.length;if(n>0){const e=new Uint8Array(this.degree);return e.set(r,n),e}return r};var ODe=kDe,IDe={},RDe={},TDe={isValid:function(e){return!isNaN(e)&&e>=1&&e<=40}},ADe={};const NDe="[0-9]+";let MDe="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";MDe=MDe.replace(/u/g,"\\u");const PDe="(?:(?![A-Z0-9 $%*+\\-./:]|"+MDe+")(?:.|[\r\n]))+";ADe.KANJI=new RegExp(MDe,"g"),ADe.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),ADe.BYTE=new RegExp(PDe,"g"),ADe.NUMERIC=new RegExp(NDe,"g"),ADe.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const jDe=new RegExp("^"+MDe+"$"),DDe=new RegExp("^"+NDe+"$"),FDe=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");ADe.testKanji=function(e){return jDe.test(e)},ADe.testNumeric=function(e){return DDe.test(e)},ADe.testAlphanumeric=function(e){return FDe.test(e)},function(e){const t=TDe,r=ADe;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(e,r){if(!e.ccBits)throw new Error("Invalid mode: "+e);if(!t.isValid(r))throw new Error("Invalid version: "+r);return r>=1&&r<10?e.ccBits[0]:r<27?e.ccBits[1]:e.ccBits[2]},e.getBestModeForData=function(t){return r.testNumeric(t)?e.NUMERIC:r.testAlphanumeric(t)?e.ALPHANUMERIC:r.testKanji(t)?e.KANJI:e.BYTE},e.toString=function(e){if(e&&e.id)return e.id;throw new Error("Invalid mode")},e.isValid=function(e){return e&&e.bit&&e.ccBits},e.from=function(t,r){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+t)}}(t)}catch{return r}}}(RDe),function(e){const t=oDe,r=gDe,n=lDe,i=RDe,o=TDe,a=t.getBCHDigit(7973);function s(e,t){return i.getCharCountIndicator(e,t)+4}function l(e,t){let r=0;return e.forEach((function(e){const n=s(e.mode,t);r+=n+e.getBitsLength()})),r}e.from=function(e,t){return o.isValid(e)?parseInt(e,10):t},e.getCapacity=function(e,n,a){if(!o.isValid(e))throw new Error("Invalid QR Code version");typeof a>"u"&&(a=i.BYTE);const l=8*(t.getSymbolTotalCodewords(e)-r.getTotalCodewordsCount(e,n));if(a===i.MIXED)return l;const c=l-s(a,e);switch(a){case i.NUMERIC:return Math.floor(c/10*3);case i.ALPHANUMERIC:return Math.floor(c/11*2);case i.KANJI:return Math.floor(c/13);case i.BYTE:default:return Math.floor(c/8)}},e.getBestVersionForData=function(t,r){let o;const a=n.from(r,n.M);if(Array.isArray(t)){if(t.length>1)return function(t,r){for(let n=1;n<=40;n++)if(l(t,n)<=e.getCapacity(n,r,i.MIXED))return n}(t,a);if(0===t.length)return 1;o=t[0]}else o=t;return function(t,r,n){for(let i=1;i<=40;i++)if(r<=e.getCapacity(i,n,t))return i}(o.mode,o.getLength(),a)},e.getEncodedBits=function(e){if(!o.isValid(e)||e<7)throw new Error("Invalid QR Code version");let r=e<<12;for(;t.getBCHDigit(r)-a>=0;)r^=7973<<t.getBCHDigit(r)-a;return e<<12|r}}(IDe);var VDe={};const LDe=oDe,$De=LDe.getBCHDigit(1335);VDe.getEncodedBits=function(e,t){const r=e.bit<<3|t;let n=r<<10;for(;LDe.getBCHDigit(n)-$De>=0;)n^=1335<<LDe.getBCHDigit(n)-$De;return 21522^(r<<10|n)};var BDe={};const zDe=RDe;function UDe(e){this.mode=zDe.NUMERIC,this.data=e.toString()}UDe.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},UDe.prototype.getLength=function(){return this.data.length},UDe.prototype.getBitsLength=function(){return UDe.getBitsLength(this.data.length)},UDe.prototype.write=function(e){let t,r,n;for(t=0;t+3<=this.data.length;t+=3)r=this.data.substr(t,3),n=parseInt(r,10),e.put(n,10);const i=this.data.length-t;i>0&&(r=this.data.substr(t),n=parseInt(r,10),e.put(n,3*i+1))};var HDe=UDe;const WDe=RDe,GDe=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function KDe(e){this.mode=WDe.ALPHANUMERIC,this.data=e}KDe.getBitsLength=function(e){return 11*Math.floor(e/2)+e%2*6},KDe.prototype.getLength=function(){return this.data.length},KDe.prototype.getBitsLength=function(){return KDe.getBitsLength(this.data.length)},KDe.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let r=45*GDe.indexOf(this.data[t]);r+=GDe.indexOf(this.data[t+1]),e.put(r,11)}this.data.length%2&&e.put(GDe.indexOf(this.data[t]),6)};var qDe=KDe;const YDe=function(e){for(var t=[],r=e.length,n=0;n<r;n++){var i=e.charCodeAt(n);if(i>=55296&&i<=56319&&r>n+1){var o=e.charCodeAt(n+1);o>=56320&&o<=57343&&(i=1024*(i-55296)+o-56320+65536,n+=1)}i<128?t.push(i):i<2048?(t.push(i>>6|192),t.push(63&i|128)):i<55296||i>=57344&&i<65536?(t.push(i>>12|224),t.push(i>>6&63|128),t.push(63&i|128)):i>=65536&&i<=1114111?(t.push(i>>18|240),t.push(i>>12&63|128),t.push(i>>6&63|128),t.push(63&i|128)):t.push(239,191,189)}return new Uint8Array(t).buffer},XDe=RDe;function ZDe(e){this.mode=XDe.BYTE,"string"==typeof e&&(e=YDe(e)),this.data=new Uint8Array(e)}ZDe.getBitsLength=function(e){return 8*e},ZDe.prototype.getLength=function(){return this.data.length},ZDe.prototype.getBitsLength=function(){return ZDe.getBitsLength(this.data.length)},ZDe.prototype.write=function(e){for(let t=0,r=this.data.length;t<r;t++)e.put(this.data[t],8)};var JDe=ZDe;const QDe=RDe,eFe=oDe;function tFe(e){this.mode=QDe.KANJI,this.data=e}tFe.getBitsLength=function(e){return 13*e},tFe.prototype.getLength=function(){return this.data.length},tFe.prototype.getBitsLength=function(){return tFe.getBitsLength(this.data.length)},tFe.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let r=eFe.toSJIS(this.data[t]);if(r>=33088&&r<=40956)r-=33088;else{if(!(r>=57408&&r<=60351))throw new Error("Invalid SJIS character: "+this.data[t]+"\nMake sure your charset is UTF-8");r-=49472}r=192*(r>>>8&255)+(255&r),e.put(r,13)}};var rFe=tFe,nFe={exports:{}};!function(e){var t={single_source_shortest_paths:function(e,r,n){var i={},o={};o[r]=0;var a,s,l,c,u,d,f,p=t.PriorityQueue.make();for(p.push(r,0);!p.empty();)for(l in s=(a=p.pop()).value,c=a.cost,u=e[s]||{})u.hasOwnProperty(l)&&(d=c+u[l],f=o[l],(typeof o[l]>"u"||f>d)&&(o[l]=d,p.push(l,d),i[l]=s));if(typeof n<"u"&&typeof o[n]>"u"){var h=["Could not find a path from ",r," to ",n,"."].join("");throw new Error(h)}return i},extract_shortest_path_from_predecessor_list:function(e,t){for(var r=[],n=t;n;)r.push(n),e[n],n=e[n];return r.reverse(),r},find_path:function(e,r,n){var i=t.single_source_shortest_paths(e,r,n);return t.extract_shortest_path_from_predecessor_list(i,n)},PriorityQueue:{make:function(e){var r,n=t.PriorityQueue,i={};for(r in e=e||{},n)n.hasOwnProperty(r)&&(i[r]=n[r]);return i.queue=[],i.sorter=e.sorter||n.default_sorter,i},default_sorter:function(e,t){return e.cost-t.cost},push:function(e,t){var r={value:e,cost:t};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};e.exports=t}(nFe),function(e){const t=RDe,r=HDe,n=qDe,i=JDe,o=rFe,a=ADe,s=oDe,l=nFe.exports;function c(e){return unescape(encodeURIComponent(e)).length}function u(e,t,r){const n=[];let i;for(;null!==(i=e.exec(r));)n.push({data:i[0],index:i.index,mode:t,length:i[0].length});return n}function d(e){const r=u(a.NUMERIC,t.NUMERIC,e),n=u(a.ALPHANUMERIC,t.ALPHANUMERIC,e);let i,o;return s.isKanjiModeEnabled()?(i=u(a.BYTE,t.BYTE,e),o=u(a.KANJI,t.KANJI,e)):(i=u(a.BYTE_KANJI,t.BYTE,e),o=[]),r.concat(n,i,o).sort((function(e,t){return e.index-t.index})).map((function(e){return{data:e.data,mode:e.mode,length:e.length}}))}function f(e,a){switch(a){case t.NUMERIC:return r.getBitsLength(e);case t.ALPHANUMERIC:return n.getBitsLength(e);case t.KANJI:return o.getBitsLength(e);case t.BYTE:return i.getBitsLength(e)}}function p(e,a){let l;const c=t.getBestModeForData(e);if(l=t.from(a,c),l!==t.BYTE&&l.bit<c.bit)throw new Error('"'+e+'" cannot be encoded with mode '+t.toString(l)+".\n Suggested mode is: "+t.toString(c));switch(l===t.KANJI&&!s.isKanjiModeEnabled()&&(l=t.BYTE),l){case t.NUMERIC:return new r(e);case t.ALPHANUMERIC:return new n(e);case t.KANJI:return new o(e);case t.BYTE:return new i(e)}}e.fromArray=function(e){return e.reduce((function(e,t){return"string"==typeof t?e.push(p(t,null)):t.data&&e.push(p(t.data,t.mode)),e}),[])},e.fromString=function(r,n){const i=function(e){const r=[];for(let n=0;n<e.length;n++){const i=e[n];switch(i.mode){case t.NUMERIC:r.push([i,{data:i.data,mode:t.ALPHANUMERIC,length:i.length},{data:i.data,mode:t.BYTE,length:i.length}]);break;case t.ALPHANUMERIC:r.push([i,{data:i.data,mode:t.BYTE,length:i.length}]);break;case t.KANJI:r.push([i,{data:i.data,mode:t.BYTE,length:c(i.data)}]);break;case t.BYTE:r.push([{data:i.data,mode:t.BYTE,length:c(i.data)}])}}return r}(d(r,s.isKanjiModeEnabled())),o=function(e,r){const n={},i={start:{}};let o=["start"];for(let a=0;a<e.length;a++){const s=e[a],l=[];for(let e=0;e<s.length;e++){const c=s[e],u=""+a+e;l.push(u),n[u]={node:c,lastCount:0},i[u]={};for(let e=0;e<o.length;e++){const a=o[e];n[a]&&n[a].node.mode===c.mode?(i[a][u]=f(n[a].lastCount+c.length,c.mode)-f(n[a].lastCount,c.mode),n[a].lastCount+=c.length):(n[a]&&(n[a].lastCount=c.length),i[a][u]=f(c.length,c.mode)+4+t.getCharCountIndicator(c.mode,r))}}o=l}for(let e=0;e<o.length;e++)i[o[e]].end=0;return{map:i,table:n}}(i,n),a=l.find_path(o.map,"start","end"),u=[];for(let e=1;e<a.length-1;e++)u.push(o.table[a[e]].node);return e.fromArray(u.reduce((function(e,t){const r=e.length-1>=0?e[e.length-1]:null;return r&&r.mode===t.mode?(e[e.length-1].data+=t.data,e):(e.push(t),e)}),[]))},e.rawSplit=function(t){return e.fromArray(d(t,s.isKanjiModeEnabled()))}}(BDe);const iFe=oDe,oFe=lDe,aFe=uDe,sFe=fDe,lFe=pDe,cFe=hDe,uFe=vDe,dFe=gDe,fFe=ODe,pFe=IDe,hFe=VDe,mFe=RDe,vFe=BDe;function gFe(e,t,r){const n=e.size,i=hFe.getEncodedBits(t,r);let o,a;for(o=0;o<15;o++)a=1==(i>>o&1),o<6?e.set(o,8,a,!0):o<8?e.set(o+1,8,a,!0):e.set(n-15+o,8,a,!0),o<8?e.set(8,n-o-1,a,!0):o<9?e.set(8,15-o-1+1,a,!0):e.set(8,15-o-1,a,!0);e.set(n-8,8,1,!0)}function yFe(e,t,r){const n=new aFe;r.forEach((function(t){n.put(t.mode.bit,4),n.put(t.getLength(),mFe.getCharCountIndicator(t.mode,e)),t.write(n)}));const i=8*(iFe.getSymbolTotalCodewords(e)-dFe.getTotalCodewordsCount(e,t));for(n.getLengthInBits()+4<=i&&n.put(0,4);n.getLengthInBits()%8!=0;)n.putBit(0);const o=(i-n.getLengthInBits())/8;for(let e=0;e<o;e++)n.put(e%2?17:236,8);return function(e,t,r){const n=iFe.getSymbolTotalCodewords(t),i=dFe.getTotalCodewordsCount(t,r),o=n-i,a=dFe.getBlocksCount(t,r),s=n%a,l=a-s,c=Math.floor(n/a),u=Math.floor(o/a),d=u+1,f=c-u,p=new fFe(f);let h=0;const m=new Array(a),v=new Array(a);let g=0;const y=new Uint8Array(e.buffer);for(let e=0;e<a;e++){const t=e<l?u:d;m[e]=y.slice(h,h+t),v[e]=p.encode(m[e]),h+=t,g=Math.max(g,t)}const b=new Uint8Array(n);let w,_,C=0;for(w=0;w<g;w++)for(_=0;_<a;_++)w<m[_].length&&(b[C++]=m[_][w]);for(w=0;w<f;w++)for(_=0;_<a;_++)b[C++]=v[_][w];return b}(n,e,t)}function bFe(e,t,r,n){let i;if(Array.isArray(e))i=vFe.fromArray(e);else{if("string"!=typeof e)throw new Error("Invalid data");{let n=t;if(!n){const t=vFe.rawSplit(e);n=pFe.getBestVersionForData(t,r)}i=vFe.fromString(e,n||40)}}const o=pFe.getBestVersionForData(i,r);if(!o)throw new Error("The amount of data is too big to be stored in a QR Code");if(t){if(t<o)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+o+".\n")}else t=o;const a=yFe(t,r,i),s=iFe.getSymbolSize(t),l=new sFe(s);return function(e,t){const r=e.size,n=cFe.getPositions(t);for(let t=0;t<n.length;t++){const i=n[t][0],o=n[t][1];for(let t=-1;t<=7;t++)if(!(i+t<=-1||r<=i+t))for(let n=-1;n<=7;n++)o+n<=-1||r<=o+n||(t>=0&&t<=6&&(0===n||6===n)||n>=0&&n<=6&&(0===t||6===t)||t>=2&&t<=4&&n>=2&&n<=4?e.set(i+t,o+n,!0,!0):e.set(i+t,o+n,!1,!0))}}(l,t),function(e){const t=e.size;for(let r=8;r<t-8;r++){const t=r%2==0;e.set(r,6,t,!0),e.set(6,r,t,!0)}}(l),function(e,t){const r=lFe.getPositions(t);for(let t=0;t<r.length;t++){const n=r[t][0],i=r[t][1];for(let t=-2;t<=2;t++)for(let r=-2;r<=2;r++)-2===t||2===t||-2===r||2===r||0===t&&0===r?e.set(n+t,i+r,!0,!0):e.set(n+t,i+r,!1,!0)}}(l,t),gFe(l,r,0),t>=7&&function(e,t){const r=e.size,n=pFe.getEncodedBits(t);let i,o,a;for(let t=0;t<18;t++)i=Math.floor(t/3),o=t%3+r-8-3,a=1==(n>>t&1),e.set(i,o,a,!0),e.set(o,i,a,!0)}(l,t),function(e,t){const r=e.size;let n=-1,i=r-1,o=7,a=0;for(let s=r-1;s>0;s-=2)for(6===s&&s--;;){for(let r=0;r<2;r++)if(!e.isReserved(i,s-r)){let n=!1;a<t.length&&(n=1==(t[a]>>>o&1)),e.set(i,s-r,n),o--,-1===o&&(a++,o=7)}if(i+=n,i<0||r<=i){i-=n,n=-n;break}}}(l,a),isNaN(n)&&(n=uFe.getBestMask(l,gFe.bind(null,l,r))),uFe.applyMask(n,l),gFe(l,r,n),{modules:l,version:t,errorCorrectionLevel:r,maskPattern:n,segments:i}}iDe.create=function(e,t){if(typeof e>"u"||""===e)throw new Error("No input text");let r,n,i=oFe.M;return typeof t<"u"&&(i=oFe.from(t.errorCorrectionLevel,oFe.M),r=pFe.from(t.version),n=uFe.from(t.maskPattern),t.toSJISFunc&&iFe.setToSJISFunction(t.toSJISFunc)),bFe(e,r,i,n)};var wFe={},_Fe={};!function(e){function t(e){if("number"==typeof e&&(e=e.toString()),"string"!=typeof e)throw new Error("Color should be defined as hex string");let t=e.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw new Error("Invalid hex color: "+e);(3===t.length||4===t.length)&&(t=Array.prototype.concat.apply([],t.map((function(e){return[e,e]})))),6===t.length&&t.push("F","F");const r=parseInt(t.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:255&r,hex:"#"+t.slice(0,6).join("")}}e.getOptions=function(e){e||(e={}),e.color||(e.color={});const r=typeof e.margin>"u"||null===e.margin||e.margin<0?4:e.margin,n=e.width&&e.width>=21?e.width:void 0,i=e.scale||4;return{width:n,scale:n?4:i,margin:r,color:{dark:t(e.color.dark||"#000000ff"),light:t(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},e.getScale=function(e,t){return t.width&&t.width>=e+2*t.margin?t.width/(e+2*t.margin):t.scale},e.getImageWidth=function(t,r){const n=e.getScale(t,r);return Math.floor((t+2*r.margin)*n)},e.qrToImageData=function(t,r,n){const i=r.modules.size,o=r.modules.data,a=e.getScale(i,n),s=Math.floor((i+2*n.margin)*a),l=n.margin*a,c=[n.color.light,n.color.dark];for(let e=0;e<s;e++)for(let r=0;r<s;r++){let u=4*(e*s+r),d=n.color.light;if(e>=l&&r>=l&&e<s-l&&r<s-l){d=c[o[Math.floor((e-l)/a)*i+Math.floor((r-l)/a)]?1:0]}t[u++]=d.r,t[u++]=d.g,t[u++]=d.b,t[u]=d.a}}}(_Fe),function(e){const t=_Fe;e.render=function(e,r,n){let i=n,o=r;typeof i>"u"&&(!r||!r.getContext)&&(i=r,r=void 0),r||(o=function(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}()),i=t.getOptions(i);const a=t.getImageWidth(e.modules.size,i),s=o.getContext("2d"),l=s.createImageData(a,a);return t.qrToImageData(l.data,e,i),function(e,t,r){e.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=r,t.width=r,t.style.height=r+"px",t.style.width=r+"px"}(s,o,a),s.putImageData(l,0,0),o},e.renderToDataURL=function(t,r,n){let i=n;typeof i>"u"&&(!r||!r.getContext)&&(i=r,r=void 0),i||(i={});const o=e.render(t,r,i),a=i.type||"image/png",s=i.rendererOpts||{};return o.toDataURL(a,s.quality)}}(wFe);var CFe={};const EFe=_Fe;function xFe(e,t){const r=e.a/255,n=t+'="'+e.hex+'"';return r<1?n+" "+t+'-opacity="'+r.toFixed(2).slice(1)+'"':n}function SFe(e,t,r){let n=e+t;return typeof r<"u"&&(n+=" "+r),n}CFe.render=function(e,t,r){const n=EFe.getOptions(t),i=e.modules.size,o=e.modules.data,a=i+2*n.margin,s=n.color.light.a?"<path "+xFe(n.color.light,"fill")+' d="M0 0h'+a+"v"+a+'H0z"/>':"",l="<path "+xFe(n.color.dark,"stroke")+' d="'+function(e,t,r){let n="",i=0,o=!1,a=0;for(let s=0;s<e.length;s++){const l=Math.floor(s%t),c=Math.floor(s/t);!l&&!o&&(o=!0),e[s]?(a++,s>0&&l>0&&e[s-1]||(n+=o?SFe("M",l+r,.5+c+r):SFe("m",i,0),i=0,o=!1),l+1<t&&e[s+1]||(n+=SFe("h",a),a=0)):i++}return n}(o,i,n.margin)+'"/>',c='viewBox="0 0 '+a+" "+a+'"',u='<svg xmlns="http://www.w3.org/2000/svg" '+(n.width?'width="'+n.width+'" height="'+n.width+'" ':"")+c+' shape-rendering="crispEdges">'+s+l+"</svg>\n";return"function"==typeof r&&r(null,u),u};const kFe=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then},OFe=iDe,IFe=wFe,RFe=CFe;function TFe(e,t,r,n,i){const o=[].slice.call(arguments,1),a=o.length,s="function"==typeof o[a-1];if(!s&&!kFe())throw new Error("Callback required as last argument");if(!s){if(a<1)throw new Error("Too few arguments provided");return 1===a?(r=t,t=n=void 0):2===a&&!t.getContext&&(n=r,r=t,t=void 0),new Promise((function(i,o){try{const o=OFe.create(r,n);i(e(o,t,n))}catch(e){o(e)}}))}if(a<2)throw new Error("Too few arguments provided");2===a?(i=r,r=t,t=n=void 0):3===a&&(t.getContext&&typeof i>"u"?(i=n,n=void 0):(i=n,n=r,r=t,t=void 0));try{const o=OFe.create(r,n);i(null,e(o,t,n))}catch(e){i(e)}}nDe.create=OFe.create,nDe.toCanvas=TFe.bind(null,IFe.render),nDe.toDataURL=TFe.bind(null,IFe.renderToDataURL),nDe.toString=TFe.bind(null,(function(e,t,r){return RFe.render(e,r)}));var AFe=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,r=[],n=0;n<e.rangeCount;n++)r.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||r.forEach((function(t){e.addRange(t)})),t&&t.focus()}},NFe={"text/plain":"Text","text/html":"Url",default:"Text"};var MFe=function(e,t){var r,n,i,o,a,s,l=!1;t||(t={}),r=t.debug||!1;try{if(i=AFe(),o=document.createRange(),a=document.getSelection(),(s=document.createElement("span")).textContent=e,s.ariaHidden="true",s.style.all="unset",s.style.position="fixed",s.style.top=0,s.style.clip="rect(0, 0, 0, 0)",s.style.whiteSpace="pre",s.style.webkitUserSelect="text",s.style.MozUserSelect="text",s.style.msUserSelect="text",s.style.userSelect="text",s.addEventListener("copy",(function(n){if(n.stopPropagation(),t.format)if(n.preventDefault(),typeof n.clipboardData>"u"){r&&console.warn("unable to use e.clipboardData"),r&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var i=NFe[t.format]||NFe.default;window.clipboardData.setData(i,e)}else n.clipboardData.clearData(),n.clipboardData.setData(t.format,e);t.onCopy&&(n.preventDefault(),t.onCopy(n.clipboardData))})),document.body.appendChild(s),o.selectNodeContents(s),a.addRange(o),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");l=!0}catch(i){r&&console.error("unable to copy using execCommand: ",i),r&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),l=!0}catch(i){r&&console.error("unable to copy using clipboardData: ",i),r&&console.error("falling back to prompt"),n=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(n,e)}}finally{a&&("function"==typeof a.removeRange?a.removeRange(o):a.removeAllRanges()),s&&document.body.removeChild(s),i()}return l};const PFe=e=>{const{state:t,shareUrl:r,copyLink:n,canUpdate:i,onDisable:o}=(e=>{var t;const r=s0(Nw.TABLE).canUpdate(),n=zA(eDe),i=null==(t=null==n?void 0:n.getShare(e.form.uuid))?void 0:t.src,[o,s]=Object(a.useState)(),l=`${location.origin}${i}`;return Object(a.useEffect)((()=>{nDe.toDataURL(l,{margin:0},((e,t)=>{s(t)}))}),[]),{state:{qrcode:o},shareUrl:l,copyLink:e=>{e.preventDefault(),MFe(l),v.a.success({content:kf("复制成功"),style:{zIndex:1050}})},canUpdate:r,onDisable(){e.onDisable()}}})(e);return s.a.createElement("div",{className:"lakex-table-form-share-link"},i?s.a.createElement("div",{className:"lakex-table-form-share-link-title"},s.a.createElement("div",null,kf("获得链接的所有人，可填写并提交表单")),s.a.createElement("span",{className:"lakex-table-form-share-link-unlink"},kf("停止收集"),s.a.createElement(S.a,{defaultChecked:!0,onChange:o}))):null,s.a.createElement("div",{className:"lakex-table-form-share-link-content"},s.a.createElement(b.a.Group,null,s.a.createElement(u.a,{value:r,disabled:!0,className:"lakex-table-form-share-link-input"}),s.a.createElement(b.a,{type:"primary",onClick:n,className:"lakex-table-form-share-link-btn"},kf("复制填写链接"))),s.a.createElement("div",{className:"lakex-table-form-share-link-qrcode"},t.qrcode?s.a.createElement("img",{src:t.qrcode}):s.a.createElement("span",null),s.a.createElement("span",null,kf("使用钉钉扫码$1",kf(i?"分享":"打开"))))))},jFe=e=>s.a.createElement("div",{className:"lakex-table-form-enabled-centered"},s.a.createElement(PFe,{form:e.form,onDisable:e.onDisable})),DFe=()=>{const{form:e,onDisable:t,isEnableManage:r}=(()=>{const e=l0(),t=zA(PSe),r=zA(eDe),[n]=Object(a.useState)(null==t?void 0:t.getForm(e.uuid));return{form:n,onDisable(){r.disableForm(e.uuid)},isEnableManage:r.isEnableManage()}})();return s.a.createElement("div",{className:"lakex-table-form-modal"},s.a.createElement("div",{className:"lakex-table-form-model-content"},r&&s.a.createElement(jFe,{form:e,onDisable:t})))},FFe=({onEnable:e})=>s.a.createElement("div",{className:"lakex-table-form-disabled-centered"},s.a.createElement(nj,{src:"https://gw.alipayobjects.com/mdn/rms_740edc/afts/img/A*5bdXSJkjvI0AAAAAAAAAAAAAARQnAQ",darkSrc:"https://gw.alipayobjects.com/mdn/prod_resou/afts/img/A*eBesTrDkSP8AAAAAAAAAAAAAARQnAQ"}),s.a.createElement("div",{className:"lakex-table-form-disabled-title"},kf("表单收集未开启")),s.a.createElement("p",{className:"lakex-table-form-disabled-desc"},kf("点击「开启收集」按钮获得表单填写链接")),s.a.createElement("div",{className:"lakex-table-form-disabled-button"},s.a.createElement(b.a,{onClick:e,type:"primary"},kf("开启收集")))),VFe=()=>{const{form:e,onEnable:t,isEnableManage:r}=(()=>{const e=l0(),t=zA(PSe),r=zA(eDe),[n]=Object(a.useState)(null==t?void 0:t.getForm(e.uuid));return{form:n,onEnable(){r.enableForm(e.uuid)},isEnableManage:r.isEnableManage()}})();return s.a.createElement("div",{className:"lakex-table-form-modal"},s.a.createElement("div",{className:"lakex-table-form-model-content"},r&&s.a.createElement(FFe,{form:e,onEnable:t})))};var LFe=Object.defineProperty,$Fe=Object.getOwnPropertyDescriptor,BFe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?$Fe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&LFe(t,r,o),o};let zFe=class{constructor(){this._toDestroyCollection=new ep}static pluginModule(){return bo().contribution(Gje).register(this).register(eDe).register(Xje)}static registerConfiguration(e){e.registerConfiguration({id:"form",type:"object",properties:{manage:{type:"object",properties:{disable:{type:"boolean"}}}}})}init(){this._toDestroyCollection.push(this._renderService.onClickEvent((e=>{if("clickFormManageButton"===e.eventName){const t=e.data.target,r=e.data.status,n={origin:t,placement:"bottomRight"};if(this._viewerFormManageService.setModalPosition(n),r!==SSe.COLLECTING)return void this._modalService.open("form-disabled-modal",{position:n});this._modalService.open("form-enabled-modal",{position:n})}})))}destroy(){this._toDestroyCollection.destroy()}registerModal(e){e.registerItem({id:"form-create-modal",hasMask:!1,scrollStrategy:"block",zIndex:"modalFromToolbar",RenderComponent:rDe}),e.registerItem({id:"form-enabled-modal",hasMask:!1,scrollStrategy:"block",zIndex:"modalFromToolbar",RenderComponent:DFe}),e.registerItem({id:"form-disabled-modal",hasMask:!1,scrollStrategy:"block",zIndex:"modalFromToolbar",RenderComponent:VFe})}};zFe.pluginName="workbench-viewer-form-manage",BFe([to(Zj)],zFe.prototype,"_renderService",2),BFe([to(tQ)],zFe.prototype,"_modalService",2),BFe([to(eDe)],zFe.prototype,"_viewerFormManageService",2),zFe=BFe([eo({contrib:[PA,IJ,rQ]})],zFe);var UFe=Object.defineProperty,HFe=Object.getOwnPropertyDescriptor,WFe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?HFe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&UFe(t,r,o),o};let GFe=class{static pluginModule(){return bo().register(this)}init(){this._renderService.onClickEvent((e=>{var t;if("fieldConfigClick"===e.eventName){const r=e.data;this._modalService.open("addOrUpdateField",{position:{origin:r.e.target,placement:"bottom"},initialState:{fieldId:r.viewField.field_uuid,showFieldTypes:null==(t=Mh)?void 0:t.filter((e=>!(Kh.isSystemType(e.type)||e.type===r.viewField.field.type))).map((e=>e.type))}})}}))}destroy(){}};GFe.pluginName="workbench-viewer-form",WFe([to(tQ)],GFe.prototype,"_modalService",2),WFe([to(Zj)],GFe.prototype,"_renderService",2),GFe=WFe([eo({contrib:[PA]})],GFe);var KFe=Object.defineProperty,qFe=Object.getOwnPropertyDescriptor,YFe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?qFe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&KFe(t,r,o),o};let XFe=class{static pluginModule(){return bo().register(this).register(Uxe)}init(){}registerToolbar(e){e.registerItem({id:"full-screen",icon:"Fullscreen",tooltip:kf("全屏"),visible:()=>{var e;return!((null==(e=this._readService.getActiveView())?void 0:e.type)===Wh.FORM)&&this._fullScreenService.status!==Lxe.FULL_SCREEN},onClick:()=>{this._fullScreenService.emitStatusChange()}})}};XFe.pluginName="workbench-full-screen",YFe([to(Dy)],XFe.prototype,"_readService",2),YFe([to(Uxe)],XFe.prototype,"_fullScreenService",2),XFe=YFe([eo({contrib:[PA,IJ]})],XFe);const ZFe=()=>{var e;const t=zA(Yxe),r=zA(Dy),[n,i]=Object(a.useState)(t.cardWidthMode),o=n===Hxe.NORMAL,l=(null==(e=r.getActiveView())?void 0:e.type)===Wh.CARD;return Object(a.useEffect)((()=>{const e=t.onModeUIChange((e=>{i(e)}));return()=>{null==e||e.destroy()}}),[]),l?s.a.createElement(h.a,{title:kf(o?"全宽":"标宽")},s.a.createElement("button",{className:"lakex-workbench-toolbar-button",onClick:()=>{const e=n===Hxe.NORMAL?Hxe.CONTAIN:Hxe.NORMAL;i(e),null==t||t.setWidthMode(e)},tabIndex:-1},s.a.createElement(YP,{type:o?"FullWidth":"NormalWidth"}))):null};var JFe=Object.defineProperty,QFe=Object.getOwnPropertyDescriptor;let eVe=class{static pluginModule(){return bo().register(this).register(Yxe)}init(){}destroy(){}registerToolbar(e){e.registerItem({id:"full-width",RenderComponent:ZFe})}};eVe.pluginName="workbench-full-width",eVe=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?QFe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&JFe(t,r,o),o})([eo({contrib:[PA,IJ]})],eVe);const tVe=({originField:e,fieldType:t,onFieldSubmitConfirm:r})=>{var n;const i=!e,o=e&&e.type!==Rh.TEXT,a=i?Io(32):e.uuid,l=zA(tQ),c=zA(qf),u=zA(ENe).getAiWritingConfig(a),f=(null==u?void 0:u.open)?null==(n=ANe.find((e=>e.uuid===(null==u?void 0:u.type))))?void 0:n.name:kf("关闭"),p=!!c.getValue("aiWriting.enable");return t===Rh.TEXT&&p?s.a.createElement(d.a,{className:"lakex-table-ai-writing-config"},s.a.createElement(d.a.Item,{className:"lakex-table-ai-writing-config-item",onClick:()=>{const e=l.getModalProps("addOrUpdateField");null==l||l.open("ai-writing-config-modal",{initialState:{fieldId:a,isCreateNewCol:i,isChangedFieldType:o,onFieldSubmitConfirm:r},position:e.position}),null==l||l.close("addOrUpdateField")}},s.a.createElement($t.default,{className:"tag",width:14,height:14}),kf("AI 智能填写"),s.a.createElement("div",{className:"right"},s.a.createElement("span",{className:"status"},f),s.a.createElement(YP,{type:"ArrowRight",size:14})))):null};var rVe={exports:{}};!function(e){!function(){var t={}.hasOwnProperty;function r(){for(var e=[],n=0;n<arguments.length;n++){var i=arguments[n];if(i){var o=typeof i;if("string"===o||"number"===o)e.push(i);else if(Array.isArray(i)){if(i.length){var a=r.apply(null,i);a&&e.push(a)}}else if("object"===o){if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]")){e.push(i.toString());continue}for(var s in i)t.call(i,s)&&i[s]&&e.push(s)}}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):window.classNames=r}()}(rVe);const nVe=rVe.exports,iVe=({initialState:e})=>{const{fieldId:t,isCreateNewCol:r,isChangedFieldType:n,onFieldSubmitConfirm:i}=e,[o,l]=Object(a.useState)(!1),c=zA(tQ),f=zA(Pb),p=zA(ENe).getAiWritingConfig(t),[h,m]=Object(a.useState)((null==p?void 0:p.open)||!1),[g,y]=Object(a.useState)((null==p?void 0:p.type)||CNe.SUMMARY),[_,C]=Object(a.useState)((null==p?void 0:p.prompt)||""),[E,x]=Object(a.useState)((null==p?void 0:p.auto)||!1),k=Object(a.useMemo)((()=>ANe.find((e=>e.uuid===g))||ANe[0]),[g]),O=Object(a.useCallback)((()=>{const e=c.getModalProps("ai-writing-config-modal");null==c||c.open("addOrUpdateField",{initialState:{fieldId:t},position:e.position}),c.close("ai-writing-config-modal")}),[c]),I=Object(a.useCallback)((e=>{m(e),f.execCommand("updateAiWritingOpen",{fieldId:t,open:e})}),[f,t]),R=Object(a.useCallback)((e=>{y(e),f.execCommand("updateAiWritingType",{fieldId:t,type:e})}),[f,t,h]),T=Object(a.useCallback)((e=>{const t=e.target.value.trim();t.length>255?v.a.error(kf("规则最长支持255字符")):C(t)}),[]);Object(a.useCallback)((e=>{x(e),f.execCommand("updateAiWritingAuto",{fieldId:t,auto:e})}),[f,t]);const A=Object(a.useCallback)((async()=>{g===CNe.SUMMARY||_?(r?await i(t):n&&await i(),await f.execCommand("updateAiWritingPrompt",{fieldId:t,prompt:_}),l(!0),await f.execCommand("startAiWriting",{fieldId:t}),null==c||c.close("ai-writing-config-modal"),v.a.success(kf("正在填写中..."))):v.a.error(kf("规则不能为空"))}),[c,f,t,g,_,r,n]),N=Object(a.useCallback)((()=>{null==c||c.close("ai-writing-config-modal")}),[c]);return s.a.createElement("div",{className:nVe("lakex-table-ai-writing-config-modal",{disabled:!h})},s.a.createElement("div",{className:"lakex-table-ai-writing-config-modal-header"},s.a.createElement("div",{className:"left",onClick:O},s.a.createElement(B.default,{className:"lakex-table-ai-writing-config-modal-back",width:16,height:16}),kf("智能填写"),s.a.createElement(Ft.default,{className:"tag",width:16,height:16})),s.a.createElement("div",{className:"right"},s.a.createElement(S.a,{size:"small",checked:h,onChange:I}))),s.a.createElement("div",{className:"lakex-table-ai-writing-config-modal-content"},s.a.createElement("div",{className:"lakex-table-ai-writing-config-modal-type"},s.a.createElement("span",null,kf("内容规则：")),s.a.createElement(w.a,{trigger:["click"],placement:"bottomRight",disabled:!h,overlay:s.a.createElement(d.a,{className:"lakex-table-ai-writing-config-menu",mode:"vertical",selectedKeys:[`${g}`]},ANe.map(((e,t)=>s.a.createElement(d.a.Item,{key:t,onClick:()=>{R(e.uuid)}},e.name,s.a.createElement(Bt.default,{width:16,height:16,style:{display:g===e.uuid?"inline":"none"}})))))},s.a.createElement("span",{className:nVe("lakex-table-ai-writing-config-modal-select",{disabled:!h})},k.name,s.a.createElement(V.default,{width:14,height:14,style:{marginLeft:"4px"}})))),g===CNe.SUMMARY?s.a.createElement(u.a.TextArea,{disabled:!0,defaultValue:"",autoSize:{minRows:1},placeholder:k.placeholder}):s.a.createElement(u.a.TextArea,{disabled:!h,defaultValue:"",value:_,autoSize:{minRows:3},placeholder:k.placeholder,onChange:T})),s.a.createElement("div",{className:"lakex-table-ai-writing-config-modal-footer"},s.a.createElement("div",{className:"lakex-table-ai-writing-config-buttons"},s.a.createElement(b.a,{className:"lakex-table-ai-writing-config-cancel",disabled:!h,onClick:N},kf("取消")),s.a.createElement(b.a,{className:"lakex-table-ai-writing-config-start",disabled:!h,onClick:A,type:"primary"},kf("开始自动填写"),o&&s.a.createElement(Vt.default,{className:"lakex-table-ai-writing-loading-icon",width:16,height:16})))))},oVe=({initialState:e})=>{const{fieldId:t,recordId:r}=e,[n,i]=Object(a.useState)(!1),o=zA(Pb),l=Object(a.useCallback)((async()=>{i(!0),await o.execCommand("startAiWriting",{recordId:r,fieldId:t}),i(!1),v.a.success(kf("已重新填写"))}),[t,r]);return s.a.createElement("div",{className:"lakex-table-aotufill-cell-modal",onClick:l},s.a.createElement($t.default,{width:16,height:16,style:{marginRight:"6px"}}),kf("重新填写"),n&&s.a.createElement(Vt.default,{className:"lakex-table-ai-writing-loading-icon",width:16,height:16}))},aVe=({fieldType:e,fieldName:t})=>{const r=zA(qf);return(null==r?void 0:r.getValue("aiWriting.enable"))&&e===Rh.TEXT?s.a.createElement("span",null,t,s.a.createElement(Ft.default,{className:"lakex-table-grid-header-ai-writing-icon",width:14,height:14})):s.a.createElement(s.a.Fragment,null,t)},sVe=({cell:e,field:t,children:r})=>{const n=zA(Pb),i=zA(qf),o=(null==i?void 0:i.getValue("aiWriting.enable"))||!1,l=zA(ENe).getAiWritingConfig(t.uuid),[c,u]=Object(a.useState)(!1),d=Object(a.useCallback)((async()=>{u(!0),await n.execCommand("startAiWriting",{recordId:e.recordId,fieldId:e.fieldId}),u(!1),v.a.success(kf("已重新填写"))}),[]);return o&&(null==l?void 0:l.open)?s.a.createElement(f.a,{overlayClassName:"lakex-table-expand-record-ai-writing-popover",content:s.a.createElement("div",{className:"content",onClick:d},s.a.createElement($t.default,{width:16,height:16,style:{marginRight:"6px"}}),kf("重新填写"),c&&s.a.createElement(Vt.default,{className:"lakex-table-ai-writing-loading-icon",width:16,height:16})),placement:"topRight",noArrow:!0,hideWhenInactive:!0},s.a.createElement("div",null,r)):s.a.createElement(s.a.Fragment,null,r)};var lVe=Object.defineProperty,cVe=Object.getOwnPropertyDescriptor,uVe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?cVe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&lVe(t,r,o),o};let dVe=class{constructor(){this._modalId="ai-writing-autofill-cell",this._toDestroyCollection=new ep}static pluginModule(){return bo().register(this)}static registerConfiguration(e){e.registerConfiguration({id:"aiWriting",type:"object",properties:{enable:{type:"boolean",description:"是否允许使用文本 AI 助手"}}}),e.registerDefaultValue({"aiWriting.enable":!1})}get isGridView(){var e;return(null==(e=this._readService.getActiveView())?void 0:e.type)===Wh.GRID}get isReadonly(){return this._abilityService.isReadonly(Nw.TABLE)}get isAiWritingEnable(){return!!this._configurationService.getValue("aiWriting.enable")}showAutofill(){var e;if(!this.isGridView)return;const t=this._selectionService.hasSelection(),r=this._selectionService.isSelectOneCell(),n=this._selectionService.getFieldValue(),i=null==(e=this._aiWritingService.getAiWritingConfig((null==n?void 0:n.fieldId)||""))?void 0:e.open;if(t&&r&&i){const e=this._renderContext.$root.querySelector(`.lakex-viewer-grid-cell[data-field-uuid="${null==n?void 0:n.fieldId}"][data-record-uuid="${null==n?void 0:n.recordId}"]`);e&&this._modalService.open(this._modalId,{position:{origin:e,placement:"top"},initialState:{fieldId:null==n?void 0:n.fieldId,recordId:null==n?void 0:n.recordId}})}else this._modalService.close(this._modalId)}init(){var e;if(this.isReadonly||!this.isAiWritingEnable||!this._selectionService)return;const t=this._selectionService.onChange((()=>{this.showAutofill()})),r=null==(e=this._gridCellEditService)?void 0:e.onEditingChange((({editing:e})=>{e?this._modalService.close(this._modalId):this.showAutofill()}));t&&this._toDestroyCollection.push(t),r&&this._toDestroyCollection.push(r)}destroy(){this._toDestroyCollection.destroy()}getConfigComponent(){return tVe}getColConfigNameComponent(){return aVe}registerContextMenu(e){e.registerItem({key:"autofillField",name:kf("重新填写本列内容"),icon:()=>s.a.createElement($t.default,{width:16,height:16}),hotkey:"",visible:({from:e,fieldId:t})=>{var r;const n=null==(r=this._aiWritingService.getAiWritingConfig(t||""))?void 0:r.open;return!this.isReadonly&&e===nre.HEADER&&this.isAiWritingEnable&&!!n},onClick:async({initialState:e,position:t})=>{const{fieldId:r}=e;!t||(this._modalService.close("context-menu-modal"),await this._commandService.execCommand("startAiWriting",{fieldId:r||""}),v.a.success(kf("正在填写中...")))}})}registerModal(e){e.registerItem({id:"ai-writing-config-modal",hasMask:!1,scrollStrategy:"block",zIndex:"expandRecord",RenderComponent:iVe}),e.registerItem({id:this._modalId,hasMask:!1,scrollStrategy:"close",zIndex:"modalFromRender",disableClickAwayClose:!0,disableEscClose:!0,RenderComponent:oVe})}registerExpandRecord(e){e.registerRecordTooltip(sVe)}};dVe.pluginName="workbench-ai-writing",uVe([to(tQ)],dVe.prototype,"_modalService",2),uVe([to(Hw)],dVe.prototype,"_abilityService",2),uVe([to(qf)],dVe.prototype,"_configurationService",2),uVe([to(ENe)],dVe.prototype,"_aiWritingService",2),uVe([to(Pb)],dVe.prototype,"_commandService",2),uVe([to(Dy)],dVe.prototype,"_readService",2),uVe([to(Uj)],dVe.prototype,"_renderContext",2),uVe([to(e3),Mx()],dVe.prototype,"_selectionService",2),uVe([to(ple),Mx()],dVe.prototype,"_gridCellEditService",2),dVe=uVe([eo({contrib:[PA,rQ,Ese,Fme,Vme,lde]})],dVe);class fVe{constructor(e,t){this._ref=s.a.createRef(),this.el=e,this.options=t,this.render()}setContent(e){var t;null!=(t=this._ref)&&t.current&&this._ref.current.setValue(e.source)}getDefault(){return{format:"plain",source:""}}getContent(){var e,t;return{format:"plain",source:(null==(t=null==(e=this._ref)?void 0:e.current)?void 0:t.getValue())||""}}onFocus(e=(e=>{})){this._focusCallback=e}render(){c.a.render(s.a.createElement(YA,{ref:this._ref,allowEnter:!0,autoFocus:!!this.options.autoFocus,rows:4,defaultValue:this.options.defaultValue,autoComplete:"off",placeholder:this.options.placeholder,onChange:()=>{var e,t;null==(t=(e=this.options).onChange)||t.call(e)},onFocus:()=>{var e;null==(e=this._focusCallback)||e.call(this,!0)},onBlur:()=>{var e;null==(e=this._focusCallback)||e.call(this,!1)}}),this.el,(()=>{var e,t;null==(t=(e=this.options).onLoad)||t.call(e,this)}))}destroy(){c.a.unmountComponentAtNode(this.el)}}class pVe{constructor(e,t){this.el=e,this.options=t,this.render()}setContent(){}render(){c.a.render(s.a.createElement("div",null,this.options.defaultValue),this.el,(()=>{var e,t;null==(t=(e=this.options).onLoad)||t.call(e,this)}))}destroy(){c.a.unmountComponentAtNode(this.el)}}var hVe=Object.defineProperty,mVe=Object.getOwnPropertyDescriptor,vVe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?mVe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&hVe(t,r,o),o};let gVe=class{constructor(){this._editor=new Map,this._viewer=new Map}init(){const e=this.contentEditorProvider.getContributions();for(const t of e){const e=t.registerContentEditor();this._editor.has(e.format)||this._editor.set(e.format,e.Editor)}const t=this.contentViewerProvider.getContributions();for(const e of t){const t=e.registerContentViewer();this._viewer.has(t.format)||this._viewer.set(t.format,t.Viewer)}}getEditor(e){return this._editor.get(e)}getViewer(e){return this._viewer.get(e)}};vVe([Eo(Nxe)],gVe.prototype,"contentEditorProvider",2),vVe([Eo(Mxe)],gVe.prototype,"contentViewerProvider",2),gVe=vVe([eo()],gVe);var yVe=Object.defineProperty,bVe=Object.getOwnPropertyDescriptor,wVe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?bVe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&yVe(t,r,o),o};let _Ve=class{create(e,t){const r=this._configuration.getValue("content.defaultFormat"),n=this._contentRegistry.getEditor(r);return t.currentUser=this._contextService.currentUser,new n(e,t)}};wVe([to(Tv)],_Ve.prototype,"_contextService",2),wVe([to(gVe)],_Ve.prototype,"_contentRegistry",2),wVe([to(qf)],_Ve.prototype,"_configuration",2),_Ve=wVe([eo({token:Fxe})],_Ve);var CVe=Object.defineProperty,EVe=Object.getOwnPropertyDescriptor,xVe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?EVe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&CVe(t,r,o),o};let SVe=class{create(e,t){const r=this._configuration.getValue("content.defaultFormat"),n=this._contentRegistry.getViewer(r);if(n)return new n(e,t)}};xVe([to(gVe)],SVe.prototype,"_contentRegistry",2),xVe([to(qf)],SVe.prototype,"_configuration",2),SVe=xVe([eo({token:Vxe})],SVe);var kVe=Object.defineProperty,OVe=Object.getOwnPropertyDescriptor,IVe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?OVe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&kVe(t,r,o),o};let RVe=class{static pluginModule(){return bo().contribution(Nxe).contribution(Mxe).register(_Ve).register(SVe).register(gVe).register(this)}static registerConfiguration(e){e.registerConfiguration({id:"content",type:"object",properties:{defaultFormat:{type:"string"},disableDatasource:{type:"boolean",description:"禁用 datasource"}}}),e.registerDefaultValue({"content.defaultFormat":"plain","content.disableDatasource":!1})}init(){this._contentRegistry.init()}registerContentEditor(){return{format:"plain",Editor:fVe}}registerContentViewer(){return{format:"plain",Viweer:pVe}}};RVe.pluginName="workbench-content",IVe([to(gVe)],RVe.prototype,"_contentRegistry",2),RVe=IVe([eo({contrib:[PA,Nxe,Mxe]})],RVe);const TVe=({recordId:e,isReadonly:t,isNewRecord:r})=>{const[n,i]=Object(a.useState)(!1),o=Object(a.useRef)(null),l=Object(a.useRef)(!1),c=Object(a.useRef)(),u=Object(a.useRef)(),d=zA(qf),f=zA(Fxe,{optional:!0}),p=zA(Vxe,{optional:!0}),h=zA(Dxe),m=zA(Pb),v=zA(Dy),g=zA(jxe),y=gV((()=>{var t;const r=null==(t=c.current)?void 0:t.getContent();!r||null==m||m.execCommand("updateContent",{recordId:e,content:r})}),1e3),b=Object(a.useCallback)((e=>{var t;null==(t=c.current)||t.setContent(e),setTimeout((()=>{l.current=!0}),100)}),[]),w=Object(a.useCallback)((e=>{!l.current||i(!!e)}),[]);Object(a.useEffect)((()=>{var t;const n=v.getTable();!(null==d?void 0:d.getValue("content.disableDatasource"))&&!r&&(null==(t=null==g?void 0:g.handleGet)||t.call(g,e,n.uuid).then((t=>{if(t){if(h.setContentWithSlient(e,"record",t),u.current)return void u.current.setContent(t);b(t)}})))}),[e]),Object(a.useEffect)((()=>{var n;if(o.current){if(t){const t=null==p?void 0:p.create(o.current,{defaultValue:(null==(n=h.getContent(e,"record"))?void 0:n.source)||""});if(!t)return;return void(u.current=t)}c.current=null==f?void 0:f.create(o.current,{onLoad:()=>{var t,n;null==(t=c.current)||t.onFocus((e=>{w(e)}));try{let t=h.getContent(e,"record");if(!t&&r&&(t=null==(n=c.current)?void 0:n.getDefault()),!t)return;b(t)}catch(e){console.error("set text editor content error",e)}},onChange(){y()}})}return()=>{}}),[]);const _=n?"lakex-table-record-desc-active":"lakex-table-record-desc-noactive";return s.a.createElement("div",{className:`lakex-table-record-desc ${_}`},s.a.createElement("div",{ref:o}))};var AVe=Object.defineProperty,NVe=Object.getOwnPropertyDescriptor;let MVe=class{static pluginModule(){return bo().register(this)}init(){}registerExpandRecord(e){e.registerRecordProvider({RenderComponent:TVe})}};MVe.pluginName="workbench-record-desc",MVe=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?NVe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&AVe(t,r,o),o})([eo({contrib:[PA,lde]})],MVe);const PVe=[XFe,eVe,zFe,GFe,dVe,RVe,MVe],jVe={token:Zxe,useValue:{registerComment(e){e.registerCommentDatasource({fetchComments:async e=>[]})}}},DVe=({webProxy:e})=>({token:Gje,useValue:{registerFormManage:()=>({async enableForm(t,r){let n;const i={scope:0,status:0,target_id:t,target_type:"Skythings.View",type:"form"};return n="create"===r?await e.shares.create(i):await e.shares.update(i),{src:`/forms/share/${n.token}`}}})}}),FVe=({webProxy:e})=>[jVe,DVe({webProxy:e})],VVe=({docId:e,docType:t,webProxy:r,webSdk:n,settings:i})=>({settings:Object.assign({},iSe({webSdk:n}),i),webSdk:n,webProxy:r}),LVe=[],$Ve=XMe.filter((e=>!LVe.includes(e.pluginName))),BVe=[],zVe=Aje.filter((e=>!BVe.includes(e.pluginName))),UVe=["workbench-full-width","workbench-full-screen","workbench-field-group"],HVe=PVe.filter((e=>!UVe.includes(e.pluginName))),WVe=[],GVe=[],KVe=[],qVe=e=>{var t;const r=VVe({docId:e.docId,docType:e.docType,webProxy:e.webProxy,webSdk:e.webSdk,settings:e.settings}),n=null==(t=e.data)?void 0:t.records,i=Dge({...e,...r,workbenchPlugins:HVe,renderPlugins:zVe,kernelPlugins:$Ve,workbenchContribs:[...WVe,...FVe({webProxy:e.webProxy}),...e.workbenchContribs||[]],renderContribs:[...GVe,...Wje(r.settings),...e.renderContribs||[]],kernelContribs:[...KVe,...yPe({docId:e.docId,docType:e.docType,webSdk:e.webSdk,webProxy:e.webProxy,currentUser:e.currentUser}),...e.kernelContribs||[]],onRendered:()=>{e.onSyncChange&&i.getService(MNe).onSyncChange(e.onSyncChange)},onDataLoaded:async t=>{var o,a;if(n)return!1;if("loadedData"===t)try{const t=await e.webSdk.TableRecordController.show({docId:e.docId,docType:e.docType,limit:r.settings["record.maxCount"],offset:0,sheetId:i.tableId});null!=t&&t.users&&i.setUsers(t.users),null!=t&&t.records&&i.setRecords(t.records)}catch{null==(o=e.onRecordLoaded)||o.call(e)}else"loadedRecords"===t&&(null==(a=e.onRecordLoaded)||a.call(e))}});return i},YVe=["kernel-history","kernel-collaboration","kernel-add-record","kernel-add-field","kernel-viewer-form"],XVe=XMe.filter((e=>!YVe.includes(e.pluginName))),ZVe=["render-history","render-refresh","render-upload"],JVe=Aje.filter((e=>!ZVe.includes(e.pluginName))),QVe=["workbench-add-record","workbench-add-field","workbench-viewer-form","workbench-viewer-form-manage","workbench-grid-cell-editor","workbench-full-width","workbench-full-screen","workbench-field-group"],eLe=PVe.filter((e=>!QVe.includes(e.pluginName))),tLe=e=>{var t;const r=VVe({docId:e.docId,docType:e.docType,webProxy:e.webProxy,webSdk:e.webSdk,settings:e.settings}),n=null==(t=e.data)?void 0:t.records,i=(e=>{var t;const r=kge({webSdk:e.webSdk,settings:e.settings||{}});let n;try{n=new WQ({...e,...r,workbenchPlugins:[...zge,...e.workbenchPlugins||[]],renderPlugins:[...$ge,...e.renderPlugins||[]],kernelPlugins:[...Vge,...e.kernelPlugins||[]],workbenchContribs:[...e.workbenchContribs||[]],renderContribs:[...e.renderContribs||[]],kernelContribs:[...e.kernelContribs||[]]})}catch(r){console.error(r),null==(t=e.onError)||t.call(e,r)}return n})({...e,...r,kernelPlugins:XVe,renderPlugins:JVe,workbenchPlugins:eLe,renderContribs:[...Wje(r.settings)],kernelContribs:[...yPe({docId:e.docId,docType:e.docType,webProxy:e.webProxy,webSdk:e.webSdk,currentUser:e.currentUser})],onDataLoaded:async t=>{var o,a;if(!n)if("loadedData"===t)try{const t=await e.webSdk.TableRecordController.show({docId:e.docId,docType:e.docType,limit:r.settings["record.maxCount"],offset:0,sheetId:i.tableId});null!=t&&t.users&&i.setUsers(t.users),null!=t&&t.records&&i.setRecords(t.records)}catch{null==(o=e.onRecordLoaded)||o.call(e)}else"loadedRecords"===t&&(null==(a=e.onRecordLoaded)||a.call(e))}});return i},rLe=["kernel-statistics","kernel-selection","kernel-context-menu","kernel-history","kernel-collaboration","kernel-clipboard","kernel-add-record","kernel-add-field","kernel-viewer-form"],nLe=XMe.filter((e=>!rLe.includes(e.pluginName))),iLe=["render-hotkey","render-selection","render-statistics","render-context-menu","render-history","render-group","render-clipboard","render-refresh","render-upload"],oLe=Aje.filter((e=>!iLe.includes(e.pluginName))),aLe=["workbench-hotkey","workbench-context-menu","workbench-statistics","workbench-add-record","workbench-add-field","workbench-viewer-form","workbench-viewer-form-manage","workbench-grid-cell-editor","workbench-full-width","workbench-full-screen","workbench-field-group"],sLe=PVe.filter((e=>!aLe.includes(e.pluginName))),lLe=[],cLe=[],uLe=[],dLe=e=>{const t=VVe({docId:e.docId,docType:e.docType,webProxy:e.webProxy,webSdk:e.webSdk,settings:{...e.settings,"ability.table.update":!1,"ability.table.delete":!1,"ability.record.create":!1,"ability.record.update":!1,"ability.field.create":!1,"toolbar.mode":TJ.LITE,"toolbar.topLeft":[],"toolbar.left":["view-manage"],"toolbar.right":["kanban-group-setting","view-field-setting","filter","grid-group","sort","grid-record-height","search"],"viewerManage.type":"menu","modal.mode":eQ.DRAWER,"render.mode":Pj.MOBILE,"viewerGrid.stickyColNum":0,"expandRecord.modalDrawerModeViews":[]}}),r=Dge({...e,...t,workbenchPlugins:sLe,renderPlugins:oLe,kernelPlugins:nLe,workbenchContribs:[...lLe,...FVe({webProxy:e.webProxy}),...e.workbenchContribs||[]],renderContribs:[...cLe,...Wje(t.settings),...e.renderContribs||[]],kernelContribs:[...uLe,...yPe({docId:e.docId,docType:e.docType,webSdk:e.webSdk,webProxy:e.webProxy,currentUser:e.currentUser}),...e.kernelContribs||[]],onDataLoaded:async n=>{var i,o;if("loadedData"===n)try{const n=await e.webSdk.TableRecordController.show({docId:e.docId,docType:e.docType,limit:t.settings["record.maxCount"],offset:0,sheetId:r.tableId});null!=n&&n.users&&r.setUsers(n.users),null!=n&&n.records&&r.setRecords(n.records)}catch{null==(i=e.onRecordLoaded)||i.call(e)}else"loadedRecords"===n&&(null==(o=e.onRecordLoaded)||o.call(e))}});return r},fLe=[...KQ.filter((e=>["kernel-field-text","kernel-field-select","kernel-field-multi-select","kernel-field-number","kernel-field-mention","kernel-field-date","kernel-field-checkbox","kernel-field-image","kernel-field-file","kernel-field-link","kernel-field-email","kernel-field-phone","kernel-field-title","kernel-process","kernel-user"].includes(e.pluginName))),VSe],pLe=Fi.defineToken("ViewerFormShareContribution"),hLe=({viewField:e,rules:t,FieldComponent:r,validateTrigger:n=["onBlur","onChange"]})=>{var i,o;const a=`lakex-form-form-viewer-${null==(i=e.field)?void 0:i.type}`;return s.a.createElement("div",{className:`${a} ${oa.isMobile?a+"-h5":""}`},s.a.createElement(_.a.Item,{name:null==(o=e.field)?void 0:o.uuid,rules:t,validateTrigger:n,noStyle:!0},s.a.createElement(r,{viewField:e})))};var mLe=Object.defineProperty,vLe=Object.getOwnPropertyDescriptor,gLe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?vLe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&mLe(t,r,o),o};let yLe=class{getProvider(){const e=this.formManageProvider.getContributions();return e[e.length-1].registerFormShare()}submitForm(e){return this.getProvider().submitForm(e)}};gLe([Eo(pLe)],yLe.prototype,"formManageProvider",2),yLe=gLe([eo()],yLe);var bLe=Object.defineProperty,wLe=Object.getOwnPropertyDescriptor,_Le=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?wLe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&bLe(t,r,o),o};let CLe=class{constructor(){this.getFormComponent=e=>this._fieldService.getFieldFormComponent(e),this.getFormFieldRules=e=>{var t,r;const n=null==(r=(t=this._fieldService).getFieldRules)?void 0:r.call(t,e),i=[];return n&&Array.isArray(n)&&n.forEach((e=>{i.push({validator:Uge(e.validator),message:e.errorMsg})})),i}}async submit(e){const t=e.reduce(((e,t)=>(e[t.fieldId]=this._toProcess.toValue(t),e)),{});await this._viewerFormShareRegistry.getProvider().submitForm(t)}};_Le([to(p_)],CLe.prototype,"_toProcess",2),_Le([to(tD)],CLe.prototype,"_fieldService",2),_Le([to(yLe)],CLe.prototype,"_viewerFormShareRegistry",2),CLe=_Le([eo()],CLe);const ELe=s.a.forwardRef(((e,t)=>{const{state:r,view:n,viewFields:i,handleSubmit:o,getFormComponent:l,getFormFieldRules:c}=(()=>{const e=l0(),t=zA(PSe),r=zA(CLe),n=null==t?void 0:t.getFormEditData(e.uuid),[i]=_.a.useForm(),[o,s]=Object(a.useState)(!1),[l,c]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{function e(e){const t=i.getFieldsValue();Object.values(t).some((e=>void 0!==e))&&!l&&(e.preventDefault(),e.returnValue="")}return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)}),[l]),{state:{loading:o,formState:i},viewFields:(null==n?void 0:n.viewFields)||[],view:null==n?void 0:n.view,handleSubmit:e=>{if(o)return!1;s(!0),c(!0);const t=Object.keys(e),n=[];for(const r of t)n.push({fieldId:r,value:e[r]});null==r||r.submit(n).then((()=>{s(!1)})).catch((e=>{s(!1)}))},getFormComponent:e=>null==r?void 0:r.getFormComponent(e),getFormFieldRules:e=>null==r?void 0:r.getFormFieldRules(e)}})(),u="lakex-viewer-form";return s.a.createElement("div",{ref:t,className:`${u} ${oa.isMobile?u+"-h5":""}`},s.a.createElement("h1",{className:`${u}-title`},null==n?void 0:n.name),s.a.createElement("div",null,s.a.createElement("div",{className:`${u}-desc`},null==n?void 0:n.desc),s.a.createElement("div",{className:`${u}-rule`},s.a.createElement("span",{className:`${u}-required`},"*"),kf("为必填项"))),s.a.createElement(_.a,{form:r.formState,layout:"vertical",className:`${u}-list`,onFinish:o,scrollToFirstError:!0},i.map(((e,t)=>{var r;const n=null==(r=e.field)?void 0:r.type;if(!n)return null;const i=l(n);if(!i)return null;const o=e.required;let a=`${t+1}.${e.name}`;const d=c(n)||[];if(o&&d.push({required:o,message:kf("请输入必填项")}),Kh.isSelectLike(n)){const e=Kh.isSelect(n)?kf("单选"):kf("多选");a=s.a.createElement("span",null,a,s.a.createElement("span",{className:`${u}-lable`},"(",e,")"))}return s.a.createElement(_.a.Item,{key:e.uuid,label:a,required:o},s.a.createElement(hLe,{viewField:e,rules:d,FieldComponent:i}))})),s.a.createElement(_.a.Item,null,s.a.createElement(b.a,{type:"primary",htmlType:"submit",size:"large",disabled:r.loading},kf("提交")))))}));class xLe extends rV{constructor(){super(...arguments),this.viewType=Wh.FORM,this.title=kf("表单视图"),this.desc="",this.icon=e=>s.a.createElement(YP,{type:"FormView",...e}),this.colorCls="yuque-color-orange-5",this.Component=ELe}}var SLe=Object.defineProperty,kLe=Object.getOwnPropertyDescriptor;let OLe=class{static pluginModule(){return bo().contribution(pLe).register(CLe).register(yLe).register(this)}init(){}registerViewer(e){e.registerItem(new xLe({onError:e.onError}))}};OLe.pluginName="render-viewer-form-share",OLe=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?kLe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&SLe(t,r,o),o})([eo({contrib:[Nj,Fj]})],OLe);const ILe=[...Vce.filter((e=>["render-field-text","render-field-select","render-field-multi-select","render-field-number","render-field-mention","render-field-date","render-field-checkbox","render-field-image","render-field-file","render-field-link","render-field-email","render-field-phone","render-field-title","render-opener"].includes(e.pluginName))),OLe,lje],RLe=[zFe],TLe=()=>{var e,t;return{"render.noRecord":!0,"upload.image.url":`/api/tables/upload?type=image&token=${null==(e=Qxe("share"))?void 0:e.token}`,"upload.image.quickUrl":"","upload.file.url":`/api/tables/upload?type=attachment&token=${null==(t=Qxe("share"))?void 0:t.token}`,"upload.file.quickUrl":""}},ALe=({webProxy:e})=>({token:pLe,useValue:{registerFormShare:()=>({async submitForm(t){var r;try{await e.tables.submitRecord({token:null==(r=Qxe("share"))?void 0:r.token,type:"FORM",data:[{data:JSON.stringify(t)}]},{ignoreGlobalMessage:!0}),v.a.success(kf("表单提交成功"),.8),v.a.destroy(),window.location.href+="/success"}catch(e){console.error(e),v.a.error(kf("表单提交失败，请稍后重试"))}}})}}),NLe=e=>{const t=VVe({docId:e.docId,docType:e.docType,webProxy:e.webProxy,webSdk:e.webSdk,settings:{...TLe(),...e.settings,"ability.table.update":!1,"ability.table.delete":!1}});return new WQ({...e,...t,renderPlugins:ILe,kernelPlugins:fLe,workbenchPlugins:RLe,renderContribs:[...Wje(t.settings),ALe({webProxy:e.webProxy})],kernelContribs:[...yPe({docId:e.docId,docType:e.docType,webProxy:e.webProxy,webSdk:e.webSdk,currentUser:nSe.me})]})},MLe=[],PLe=XMe.filter((e=>!MLe.includes(e.pluginName))),jLe=[],DLe=Aje.filter((e=>!jLe.includes(e.pluginName))),FLe=["workbench-field-group"],VLe=PVe.filter((e=>!FLe.includes(e.pluginName))),LLe=[],$Le=[],BLe=[],zLe=e=>{var t;const r=VVe({docId:e.docId,docType:e.docType,webProxy:e.webProxy,webSdk:e.webSdk,settings:{"opener.useHash":!1,"view.useWindowScroll":!0,"toolbar.topLeft":[],"toolbar.left":["view-manage"],"toolbar.right":["kanban-group-setting","view-field-setting","filter","grid-group","sort","grid-record-height","full-width","full-screen","search","|","add-record"],"toolbar.mode":TJ.LITE,"modal.mode":eQ.MODAL,"viewerManage.type":"menu","viewerManage.viewTypes":[Wh.GRID,Wh.CARD,Wh.KANBAN],"expandRecord.modalDrawerModeViews":[],"render.autoActive":!1,...e.settings}}),n=null==(t=e.data)?void 0:t.records,i=Dge({...e,...r,renderPlugins:DLe,kernelPlugins:PLe,workbenchPlugins:VLe,workbenchContribs:[...LLe,...FVe({webProxy:e.webProxy}),...e.workbenchContribs||[]],renderContribs:[...$Le,...Wje(r.settings),...e.renderContribs||[]],kernelContribs:[...BLe,...yPe({docId:e.docId,docType:e.docType,webSdk:e.webSdk,webProxy:e.webProxy,currentUser:e.currentUser}),...e.kernelContribs||[]],onDataLoaded:async t=>{var o,a;if(n)return!1;if("loadedData"===t)try{const t=await e.webSdk.TableRecordController.show({docId:e.docId,docType:e.docType,limit:r.settings["record.maxCount"],offset:0,sheetId:e.data.sheet[0].id});null!=t&&t.users&&i.setUsers(t.users),null!=t&&t.records&&i.setRecords(t.records)}catch{null==(o=e.onRecordLoaded)||o.call(e)}else"loadedRecords"===t&&(null==(a=e.onRecordLoaded)||a.call(e))}});return i},ULe=[],HLe=XMe.filter((e=>!ULe.includes(e.pluginName))),WLe=[],GLe=Aje.filter((e=>!WLe.includes(e.pluginName))),KLe=["workbench-field-group"],qLe=PVe.filter((e=>!KLe.includes(e.pluginName))),YLe=[],XLe=[],ZLe=[],JLe=e=>{var t;const r=VVe({docId:e.docId,docType:e.docType,webProxy:e.webProxy,webSdk:e.webSdk,settings:{...e.settings,"ability.table.create":!1,"ability.table.delete":!1,"ability.table.read":!0,"ability.table.update":!1,"opener.useHash":!1,"view.useWindowScroll":!0,"toolbar.topLeft":[],"toolbar.left":["view-manage"],"toolbar.right":["kanban-group-setting","view-field-setting","filter","grid-group","sort","grid-record-height","search"],"toolbar.mode":TJ.LITE,"modal.mode":eQ.DRAWER,"render.mode":Pj.MOBILE,"viewerManage.type":"menu","viewerManage.viewTypes":[Wh.GRID,Wh.CARD,Wh.KANBAN],"expandRecord.modalDrawerModeViews":[],"render.autoActive":!1,"viewerGrid.stickyColNum":0}}),n=null==(t=e.data)?void 0:t.records,i=Dge({...e,...r,renderPlugins:GLe,kernelPlugins:HLe,workbenchPlugins:qLe,workbenchContribs:[...YLe,...FVe({webProxy:e.webProxy}),...e.workbenchContribs||[]],renderContribs:[...XLe,...Wje(r.settings),...e.renderContribs||[]],kernelContribs:[...ZLe,...yPe({docId:e.docId,docType:e.docType,webSdk:e.webSdk,webProxy:e.webProxy,currentUser:e.currentUser}),...e.kernelContribs||[]],onDataLoaded:async t=>{var o,a;if(n)return!1;if("loadedData"===t)try{const t=await e.webSdk.TableRecordController.show({docId:e.docId,docType:e.docType,limit:r.settings["record.maxCount"],offset:0,sheetId:e.data.sheet[0].id});null!=t&&t.users&&i.setUsers(t.users),null!=t&&t.records&&i.setRecords(t.records)}catch{null==(o=e.onRecordLoaded)||o.call(e)}else"loadedRecords"===t&&(null==(a=e.onRecordLoaded)||a.call(e))}});return i}}.call(this,r(92),r(3701)(e))}}]);